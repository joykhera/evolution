{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5686463098662595, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.192866834501426, "policy_loss": -0.023656168475281448, "vf_loss": 6.212774180869261, "vf_explained_var": 0.024038366290430227, "kl": 0.018744196092267393, "entropy": 1.5908508472144605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.489545474323646, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.840510148598404, "policy_loss": -0.011605126810969696, "vf_loss": 6.849491702185737, "vf_explained_var": -0.023992205959148506, "kl": 0.013117816651648503, "entropy": 1.5963801627436642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 18.431536379019406, "episode_reward_min": -23.858301978386738, "episode_reward_mean": -1.182919777907052, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -18.43153637901945, "predator_policy": -30.136203278966377}, "policy_reward_max": {"prey_policy": 23.858301978386738, "predator_policy": 23.511957731271647}, "policy_reward_mean": {"prey_policy": 1.1829197779070504, "predator_policy": -1.1829197779070508}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.33306909208015, 3.318729886070343, -23.858301978386738, -5.064692563810533, -22.20807515794636, -16.21551087220519, 11.347750456126564, 10.32815623395599, -12.784466790371269, 2.915629891722652, 3.035761425387715, 18.431536379019406, 3.852341339916755, 2.5517756615246423, 4.507101329009007, -4.982686263912454, -6.8454322491074695, 4.044758178599853], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.33306909208015, -3.318729886070343, 23.858301978386738, 5.064692563810536, 22.20807515794636, 16.2155108722052, -11.347750456126562, -10.328156233955992, 12.784466790371267, -2.91562989172265, -3.035761425387709, -18.43153637901945, -3.8523413399167605, -2.5517756615246423, -4.507101329009007, 4.982686263912457, 6.8454322491074695, -4.044758178599853], "policy_predator_policy_reward": [5.0799860900945575, 7.586152094065742, 9.627323800268034, -2.9898640281273474, -17.5804006778071, -30.136203278966377, -7.787258000232114, -2.3421271273889497, -24.899490316234047, -19.516659999658675, -12.666665048194968, -19.764356696215426, -0.8164568190185229, 23.511957731271647, 4.953181301811121, 15.703131166100864, -24.20318947516376, -1.3657441055787736, 3.586407353808201, 2.244852429637099, -8.633189815190532, 14.704712665965957, 18.433204001461213, 18.429868756577676, -0.4513046452557745, 8.155987325089283, 3.6504299254456, 1.4531213976036845, 3.0966964255181573, 5.917506232499857, -5.816793475045003, -4.148579052779912, -2.7970497657413063, -10.893814732473633, 2.4787411754223214, 5.6107751817773845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9132967399510932, "mean_inference_ms": 2.5566835278188638, "mean_action_processing_ms": 0.3942729657660402, "mean_env_wait_ms": 0.24351914032309255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016857518090142146, "StateBufferConnector_ms": 0.004709429211086697, "ViewRequirementAgentConnector_ms": 0.2493951055738661}, "num_episodes": 18, "episode_return_max": 18.431536379019406, "episode_return_min": -23.858301978386738, "episode_return_mean": -1.182919777907052, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.6287121193679, "num_env_steps_trained_throughput_per_sec": 323.6287121193679, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12359.853, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12359.788, "sample_time_ms": 1937.122, "learn_time_ms": 10406.357, "learn_throughput": 384.38, "synch_weights_time_ms": 14.318}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "06536_00000", "date": "2024-08-11_16-34-23", "timestamp": 1723408463, "time_this_iter_s": 12.405030965805054, "time_total_s": 12.405030965805054, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff9cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.405030965805054, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.77777777777778, "ram_util_percent": 83.57777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0850921238772573, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.63298688630263, "policy_loss": -0.010983782125307092, "vf_loss": 6.641860191027323, "vf_explained_var": -0.005410584372778734, "kl": 0.010552511101225815, "entropy": 1.5680523920804261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.529834056688995, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2689354381864035, "policy_loss": -0.013091399211180273, "vf_loss": 7.278567887614013, "vf_explained_var": 0.02075805534761419, "kl": 0.01729472853455455, "entropy": 1.5478491665194274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 26.173954713246506, "episode_reward_min": -23.858301978386738, "episode_reward_mean": 3.1277247106625405, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -26.173954713246502, "predator_policy": -30.136203278966377}, "policy_reward_max": {"prey_policy": 23.858301978386738, "predator_policy": 32.155844615027824}, "policy_reward_mean": {"prey_policy": -3.127724710662541, "predator_policy": 3.127724710662542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.33306909208015, 3.318729886070343, -23.858301978386738, -5.064692563810533, -22.20807515794636, -16.21551087220519, 11.347750456126564, 10.32815623395599, -12.784466790371269, 2.915629891722652, 3.035761425387715, 18.431536379019406, 3.852341339916755, 2.5517756615246423, 4.507101329009007, -4.982686263912454, -6.8454322491074695, 4.044758178599853, -8.024902292691923, 19.99221085320529, 3.1740357445090126, 9.479778532786426, 21.10946233572599, 12.377018919962458, 18.218064733863294, 26.173954713246506, -3.5365606471082423, 11.880483521973035, -2.043353711308065, -4.0363670932112985, 8.665837802651744, -7.850859947490524, -2.7735913487214496, 8.827242280858357, 6.0111324096940235, 16.247058778233768], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.33306909208015, -3.318729886070343, 23.858301978386738, 5.064692563810536, 22.20807515794636, 16.2155108722052, -11.347750456126562, -10.328156233955992, 12.784466790371267, -2.91562989172265, -3.035761425387709, -18.43153637901945, -3.8523413399167605, -2.5517756615246423, -4.507101329009007, 4.982686263912457, 6.8454322491074695, -4.044758178599853, 8.02490229269194, -19.992210853205307, -3.174035744509018, -9.47977853278639, -21.109462335726, -12.377018919962456, -18.218064733863283, -26.173954713246502, 3.5365606471082423, -11.880483521973048, 2.0433537113080624, 4.036367093211284, -8.665837802651744, 7.850859947490536, 2.7735913487214496, -8.827242280858377, -6.011132409694026, -16.247058778233757], "policy_predator_policy_reward": [5.0799860900945575, 7.586152094065742, 9.627323800268034, -2.9898640281273474, -17.5804006778071, -30.136203278966377, -7.787258000232114, -2.3421271273889497, -24.899490316234047, -19.516659999658675, -12.666665048194968, -19.764356696215426, -0.8164568190185229, 23.511957731271647, 4.953181301811121, 15.703131166100864, -24.20318947516376, -1.3657441055787736, 3.586407353808201, 2.244852429637099, -8.633189815190532, 14.704712665965957, 18.433204001461213, 18.429868756577676, -0.4513046452557745, 8.155987325089283, 3.6504299254456, 1.4531213976036845, 3.0966964255181573, 5.917506232499857, -5.816793475045003, -4.148579052779912, -2.7970497657413063, -10.893814732473633, 2.4787411754223214, 5.6107751817773845, -12.266118086579993, -3.7836864988038768, 11.860758415711924, 28.123663290698676, -0.6928662131086547, 7.040937702126698, 6.1810593980346855, 12.778497667538108, 10.063080056424191, 32.155844615027824, 27.758830076810987, -3.0047922368860736, 18.760697072595793, 17.675432395130777, 31.284337522738745, 21.06357190375426, -7.2231393262931505, 0.15001803207666597, 12.523716394153475, 11.237250649792633, -3.3440315501410396, -0.7426758724750835, -5.449883830624298, -2.6228503557982847, 6.881530746049734, 10.450144859253754, -5.775937781731793, -9.925782113249277, -21.622606429349258, 16.07542373190636, 12.727775567899368, 4.926708993817371, 16.919238147851846, -4.896973328463789, 20.339292965871728, 12.154824590595794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8330783008850494, "mean_inference_ms": 2.3205096479736076, "mean_action_processing_ms": 0.35820657345076773, "mean_env_wait_ms": 0.22170747812660505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010787116156684028, "StateBufferConnector_ms": 0.004040201505025228, "ViewRequirementAgentConnector_ms": 0.16079809930589464}, "num_episodes": 18, "episode_return_max": 26.173954713246506, "episode_return_min": -23.858301978386738, "episode_return_mean": 3.1277247106625405, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.8798179837921, "num_env_steps_trained_throughput_per_sec": 341.8798179837921, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12030.017, "restore_workers_time_ms": 0.125, "training_step_time_ms": 12029.733, "sample_time_ms": 1587.935, "learn_time_ms": 10426.826, "learn_throughput": 383.626, "synch_weights_time_ms": 13.492}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 2, "trial_id": "06536_00000", "date": "2024-08-11_16-34-37", "timestamp": 1723408477, "time_this_iter_s": 11.75257396697998, "time_total_s": 24.157604932785034, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.157604932785034, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.42380952380953, "ram_util_percent": 83.2095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8665024042750398, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.907030308743318, "policy_loss": -0.008439814011459627, "vf_loss": 6.913726255297661, "vf_explained_var": -0.1429646736010909, "kl": 0.008719424546343675, "entropy": 1.5382855447630088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6411274563856226, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.015555950447365, "policy_loss": -0.011509641317438788, "vf_loss": 7.023637791537734, "vf_explained_var": 0.060086151405617044, "kl": 0.01713909352533816, "entropy": 1.4820253677469082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 29.074685069236125, "episode_reward_min": -23.858301978386738, "episode_reward_mean": 6.099966948481078, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -29.074685069236196, "predator_policy": -30.136203278966377}, "policy_reward_max": {"prey_policy": 23.858301978386738, "predator_policy": 39.48956643128044}, "policy_reward_mean": {"prey_policy": -6.099966948481078, "predator_policy": 6.099966948481079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.33306909208015, 3.318729886070343, -23.858301978386738, -5.064692563810533, -22.20807515794636, -16.21551087220519, 11.347750456126564, 10.32815623395599, -12.784466790371269, 2.915629891722652, 3.035761425387715, 18.431536379019406, 3.852341339916755, 2.5517756615246423, 4.507101329009007, -4.982686263912454, -6.8454322491074695, 4.044758178599853, -8.024902292691923, 19.99221085320529, 3.1740357445090126, 9.479778532786426, 21.10946233572599, 12.377018919962458, 18.218064733863294, 26.173954713246506, -3.5365606471082423, 11.880483521973035, -2.043353711308065, -4.0363670932112985, 8.665837802651744, -7.850859947490524, -2.7735913487214496, 8.827242280858357, 6.0111324096940235, 16.247058778233768, 5.953609843497446, 10.846656878268968, 15.298423079531785, 24.108115783464534, 12.612598469740005, 11.796689832492921, -3.5790364412553206, 17.65016767351113, 9.492510322785517, 11.899638398626102, 20.738416921324585, -3.0633386593620333, 22.9250366649765, 22.92311955699933, -0.6546803413959652, 29.074685069236125, -4.728572678180292, 13.506085259865367], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.33306909208015, -3.318729886070343, 23.858301978386738, 5.064692563810536, 22.20807515794636, 16.2155108722052, -11.347750456126562, -10.328156233955992, 12.784466790371267, -2.91562989172265, -3.035761425387709, -18.43153637901945, -3.8523413399167605, -2.5517756615246423, -4.507101329009007, 4.982686263912457, 6.8454322491074695, -4.044758178599853, 8.02490229269194, -19.992210853205307, -3.174035744509018, -9.47977853278639, -21.109462335726, -12.377018919962456, -18.218064733863283, -26.173954713246502, 3.5365606471082423, -11.880483521973048, 2.0433537113080624, 4.036367093211284, -8.665837802651744, 7.850859947490536, 2.7735913487214496, -8.827242280858377, -6.011132409694026, -16.247058778233757, -5.953609843497449, -10.846656878268968, -15.298423079531773, -24.108115783464537, -12.61259846974, -11.796689832492913, 3.5790364412553224, -17.650167673511135, -9.492510322785511, -11.899638398626085, -20.738416921324593, 3.063338659362034, -22.925036664976503, -22.923119556999303, 0.6546803413959665, -29.074685069236196, 4.7285726781802975, -13.506085259865369], "policy_predator_policy_reward": [5.0799860900945575, 7.586152094065742, 9.627323800268034, -2.9898640281273474, -17.5804006778071, -30.136203278966377, -7.787258000232114, -2.3421271273889497, -24.899490316234047, -19.516659999658675, -12.666665048194968, -19.764356696215426, -0.8164568190185229, 23.511957731271647, 4.953181301811121, 15.703131166100864, -24.20318947516376, -1.3657441055787736, 3.586407353808201, 2.244852429637099, -8.633189815190532, 14.704712665965957, 18.433204001461213, 18.429868756577676, -0.4513046452557745, 8.155987325089283, 3.6504299254456, 1.4531213976036845, 3.0966964255181573, 5.917506232499857, -5.816793475045003, -4.148579052779912, -2.7970497657413063, -10.893814732473633, 2.4787411754223214, 5.6107751817773845, -12.266118086579993, -3.7836864988038768, 11.860758415711924, 28.123663290698676, -0.6928662131086547, 7.040937702126698, 6.1810593980346855, 12.778497667538108, 10.063080056424191, 32.155844615027824, 27.758830076810987, -3.0047922368860736, 18.760697072595793, 17.675432395130777, 31.284337522738745, 21.06357190375426, -7.2231393262931505, 0.15001803207666597, 12.523716394153475, 11.237250649792633, -3.3440315501410396, -0.7426758724750835, -5.449883830624298, -2.6228503557982847, 6.881530746049734, 10.450144859253754, -5.775937781731793, -9.925782113249277, -21.622606429349258, 16.07542373190636, 12.727775567899368, 4.926708993817371, 16.919238147851846, -4.896973328463789, 20.339292965871728, 12.154824590595794, 5.066017560366142, 6.841202126628751, 1.8320731431399828, 19.861240613397946, 12.061621643524688, 18.53522451553888, 32.440019634630495, 15.776211932298583, 21.377413353314335, 3.8477835861656615, 11.677539687147341, 11.915839977838475, 4.428749295250592, -11.586822177761231, 17.861075019043987, 17.439260327978275, 9.115904934512898, 9.869115711058129, 18.19607007896247, 5.603206718289675, 16.225461696782315, 25.25137214586688, 8.192404789315347, -14.31908210803943, 28.07600250230154, 17.77407082765149, 23.216086996155916, 22.630152117842695, 3.7452346849298683, -5.054595367721802, 39.48956643128044, 18.659803707191916, 4.84544587652988, -14.302591232890475, 1.6205584788561591, 25.391612040874584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7969830762629002, "mean_inference_ms": 2.2168913633325005, "mean_action_processing_ms": 0.34227604621878127, "mean_env_wait_ms": 0.20861529271928209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009689066145155165, "StateBufferConnector_ms": 0.003606301766854745, "ViewRequirementAgentConnector_ms": 0.13813310199313694}, "num_episodes": 18, "episode_return_max": 29.074685069236125, "episode_return_min": -23.858301978386738, "episode_return_mean": 6.099966948481078, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.1634803733629, "num_env_steps_trained_throughput_per_sec": 361.1634803733629, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11711.786, "restore_workers_time_ms": 0.088, "training_step_time_ms": 11711.541, "sample_time_ms": 1526.508, "learn_time_ms": 10169.2, "learn_throughput": 393.345, "synch_weights_time_ms": 14.544}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 3, "trial_id": "06536_00000", "date": "2024-08-11_16-34-49", "timestamp": 1723408489, "time_this_iter_s": 11.107629776000977, "time_total_s": 35.26523470878601, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb0550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.26523470878601, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.95, "ram_util_percent": 81.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.606676487904042, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0873333265384035, "policy_loss": -0.010208791929956836, "vf_loss": 7.095664058625698, "vf_explained_var": -0.17764483174930015, "kl": 0.009390274820991954, "entropy": 1.5083706519256035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.737143177866305, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.904169870558239, "policy_loss": -0.008495367204933059, "vf_loss": 6.91058852180602, "vf_explained_var": 0.051323670874197015, "kl": 0.010383522373563835, "entropy": 1.447923491114662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 39.43360330522508, "episode_reward_min": -23.858301978386738, "episode_reward_mean": 9.3261333457926, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -39.4336033052251, "predator_policy": -30.136203278966377}, "policy_reward_max": {"prey_policy": 23.858301978386738, "predator_policy": 40.19464580347627}, "policy_reward_mean": {"prey_policy": -9.326133345792604, "predator_policy": 9.326133345792604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.33306909208015, 3.318729886070343, -23.858301978386738, -5.064692563810533, -22.20807515794636, -16.21551087220519, 11.347750456126564, 10.32815623395599, -12.784466790371269, 2.915629891722652, 3.035761425387715, 18.431536379019406, 3.852341339916755, 2.5517756615246423, 4.507101329009007, -4.982686263912454, -6.8454322491074695, 4.044758178599853, -8.024902292691923, 19.99221085320529, 3.1740357445090126, 9.479778532786426, 21.10946233572599, 12.377018919962458, 18.218064733863294, 26.173954713246506, -3.5365606471082423, 11.880483521973035, -2.043353711308065, -4.0363670932112985, 8.665837802651744, -7.850859947490524, -2.7735913487214496, 8.827242280858357, 6.0111324096940235, 16.247058778233768, 5.953609843497446, 10.846656878268968, 15.298423079531785, 24.108115783464534, 12.612598469740005, 11.796689832492921, -3.5790364412553206, 17.65016767351113, 9.492510322785517, 11.899638398626102, 20.738416921324585, -3.0633386593620333, 22.9250366649765, 22.92311955699933, -0.6546803413959652, 29.074685069236125, -4.728572678180292, 13.506085259865367, 39.246863373460464, 4.396662337229647, 19.96896083062564, 15.655630442707931, 26.739754391469845, -1.804185433053263, 3.8290038929927386, 16.52998537613847, 10.56565158227107, 28.904690666380805, 39.43360330522508, 25.75234712170191, 17.264246363945304, 26.58916753841997, 19.40585910638471, 30.736421381224964, 9.782176178829472, 9.086547223134282], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.33306909208015, -3.318729886070343, 23.858301978386738, 5.064692563810536, 22.20807515794636, 16.2155108722052, -11.347750456126562, -10.328156233955992, 12.784466790371267, -2.91562989172265, -3.035761425387709, -18.43153637901945, -3.8523413399167605, -2.5517756615246423, -4.507101329009007, 4.982686263912457, 6.8454322491074695, -4.044758178599853, 8.02490229269194, -19.992210853205307, -3.174035744509018, -9.47977853278639, -21.109462335726, -12.377018919962456, -18.218064733863283, -26.173954713246502, 3.5365606471082423, -11.880483521973048, 2.0433537113080624, 4.036367093211284, -8.665837802651744, 7.850859947490536, 2.7735913487214496, -8.827242280858377, -6.011132409694026, -16.247058778233757, -5.953609843497449, -10.846656878268968, -15.298423079531773, -24.108115783464537, -12.61259846974, -11.796689832492913, 3.5790364412553224, -17.650167673511135, -9.492510322785511, -11.899638398626085, -20.738416921324593, 3.063338659362034, -22.925036664976503, -22.923119556999303, 0.6546803413959665, -29.074685069236196, 4.7285726781802975, -13.506085259865369, -39.246863373460464, -4.3966623372296505, -19.968960830625647, -15.655630442707933, -26.739754391469845, 1.804185433053259, -3.8290038929927332, -16.529985376138495, -10.565651582271087, -28.904690666380823, -39.4336033052251, -25.752347121701895, -17.26424636394533, -26.58916753842002, -19.405859106384707, -30.73642138122496, -9.78217617882947, -9.086547223134291], "policy_predator_policy_reward": [5.0799860900945575, 7.586152094065742, 9.627323800268034, -2.9898640281273474, -17.5804006778071, -30.136203278966377, -7.787258000232114, -2.3421271273889497, -24.899490316234047, -19.516659999658675, -12.666665048194968, -19.764356696215426, -0.8164568190185229, 23.511957731271647, 4.953181301811121, 15.703131166100864, -24.20318947516376, -1.3657441055787736, 3.586407353808201, 2.244852429637099, -8.633189815190532, 14.704712665965957, 18.433204001461213, 18.429868756577676, -0.4513046452557745, 8.155987325089283, 3.6504299254456, 1.4531213976036845, 3.0966964255181573, 5.917506232499857, -5.816793475045003, -4.148579052779912, -2.7970497657413063, -10.893814732473633, 2.4787411754223214, 5.6107751817773845, -12.266118086579993, -3.7836864988038768, 11.860758415711924, 28.123663290698676, -0.6928662131086547, 7.040937702126698, 6.1810593980346855, 12.778497667538108, 10.063080056424191, 32.155844615027824, 27.758830076810987, -3.0047922368860736, 18.760697072595793, 17.675432395130777, 31.284337522738745, 21.06357190375426, -7.2231393262931505, 0.15001803207666597, 12.523716394153475, 11.237250649792633, -3.3440315501410396, -0.7426758724750835, -5.449883830624298, -2.6228503557982847, 6.881530746049734, 10.450144859253754, -5.775937781731793, -9.925782113249277, -21.622606429349258, 16.07542373190636, 12.727775567899368, 4.926708993817371, 16.919238147851846, -4.896973328463789, 20.339292965871728, 12.154824590595794, 5.066017560366142, 6.841202126628751, 1.8320731431399828, 19.861240613397946, 12.061621643524688, 18.53522451553888, 32.440019634630495, 15.776211932298583, 21.377413353314335, 3.8477835861656615, 11.677539687147341, 11.915839977838475, 4.428749295250592, -11.586822177761231, 17.861075019043987, 17.439260327978275, 9.115904934512898, 9.869115711058129, 18.19607007896247, 5.603206718289675, 16.225461696782315, 25.25137214586688, 8.192404789315347, -14.31908210803943, 28.07600250230154, 17.77407082765149, 23.216086996155916, 22.630152117842695, 3.7452346849298683, -5.054595367721802, 39.48956643128044, 18.659803707191916, 4.84544587652988, -14.302591232890475, 1.6205584788561591, 25.391612040874584, 40.17636867302733, 38.317358073893594, 20.511972134267346, -11.718647459808043, 22.82191390264658, 17.116007758604745, 24.958169152276657, 6.353091733139208, 25.838170781638386, 27.641338001301325, -3.210673601468736, -0.39769726463778454, -2.177886848923193, 9.83589463490866, 25.26591611742602, 7.794054634850957, -8.184990746098347, 29.316293910640507, 32.658888919458974, 25.150492413302672, 40.19464580347627, 38.672560806973905, 20.852732113317412, 30.65196213008641, 28.49489136522149, 6.033601362669176, 34.790717556362395, 18.38761752047759, 1.6630625985432257, 37.14865561422619, 35.47158793047432, 26.00125483197563, 8.103924233753421, 11.460428123905519, 8.785477333247732, 9.387617113020841]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7657103822948961, "mean_inference_ms": 2.1217105047430156, "mean_action_processing_ms": 0.32765605522637603, "mean_env_wait_ms": 0.19884944089775064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008524126476711698, "StateBufferConnector_ms": 0.0032964679929945204, "ViewRequirementAgentConnector_ms": 0.11906193362341987}, "num_episodes": 18, "episode_return_max": 39.43360330522508, "episode_return_min": -23.858301978386738, "episode_return_mean": 9.3261333457926, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.53998494227, "num_env_steps_trained_throughput_per_sec": 368.53998494227, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11497.256, "restore_workers_time_ms": 0.074, "training_step_time_ms": 11497.051, "sample_time_ms": 1412.576, "learn_time_ms": 10068.657, "learn_throughput": 397.272, "synch_weights_time_ms": 14.683}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 4, "trial_id": "06536_00000", "date": "2024-08-11_16-35-00", "timestamp": 1723408500, "time_this_iter_s": 10.905620813369751, "time_total_s": 46.17085552215576, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb0670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.17085552215576, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.575, "ram_util_percent": 82.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.714036116314431, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.012798051039378, "policy_loss": -0.006262147142357814, "vf_loss": 6.017756511271, "vf_explained_var": 0.023620557536681495, "kl": 0.006518399192327514, "entropy": 1.5236187373598418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9547028768945622, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.960779303596134, "policy_loss": -0.01045768132073578, "vf_loss": 5.96848938730028, "vf_explained_var": 0.07616953127598636, "kl": 0.013738016851486382, "entropy": 1.4205522789526237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 40.45973758046643, "episode_reward_min": -23.858301978386738, "episode_reward_mean": 10.187765068509762, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -40.45973758046631, "predator_policy": -30.136203278966377}, "policy_reward_max": {"prey_policy": 23.858301978386738, "predator_policy": 43.679883905893476}, "policy_reward_mean": {"prey_policy": -10.187765068509762, "predator_policy": 10.187765068509762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.33306909208015, 3.318729886070343, -23.858301978386738, -5.064692563810533, -22.20807515794636, -16.21551087220519, 11.347750456126564, 10.32815623395599, -12.784466790371269, 2.915629891722652, 3.035761425387715, 18.431536379019406, 3.852341339916755, 2.5517756615246423, 4.507101329009007, -4.982686263912454, -6.8454322491074695, 4.044758178599853, -8.024902292691923, 19.99221085320529, 3.1740357445090126, 9.479778532786426, 21.10946233572599, 12.377018919962458, 18.218064733863294, 26.173954713246506, -3.5365606471082423, 11.880483521973035, -2.043353711308065, -4.0363670932112985, 8.665837802651744, -7.850859947490524, -2.7735913487214496, 8.827242280858357, 6.0111324096940235, 16.247058778233768, 5.953609843497446, 10.846656878268968, 15.298423079531785, 24.108115783464534, 12.612598469740005, 11.796689832492921, -3.5790364412553206, 17.65016767351113, 9.492510322785517, 11.899638398626102, 20.738416921324585, -3.0633386593620333, 22.9250366649765, 22.92311955699933, -0.6546803413959652, 29.074685069236125, -4.728572678180292, 13.506085259865367, 39.246863373460464, 4.396662337229647, 19.96896083062564, 15.655630442707931, 26.739754391469845, -1.804185433053263, 3.8290038929927386, 16.52998537613847, 10.56565158227107, 28.904690666380805, 39.43360330522508, 25.75234712170191, 17.264246363945304, 26.58916753841997, 19.40585910638471, 30.736421381224964, 9.782176178829472, 9.086547223134282, 40.45973758046643, 4.660286964959052, 13.183801780757843, 14.575373733717015, 23.590895325605985, 10.625214963594097, -1.5737939393347737, 12.446886581676557, -5.999645316910902, 27.374553094922483, 7.466863525619264, 8.220917662748576, 29.1694568954162, 13.306311492766707, 7.863949238324233, 13.25361642785952, 7.62495469440562, 7.263227431250179, 13.059571361874285, 6.988562267459394, 15.508582054170772, 22.946323903046377, 8.671452217709424, 2.910303459135993, 20.153588075798808, 14.557512766912968, -1.2013633585529604], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.33306909208015, -3.318729886070343, 23.858301978386738, 5.064692563810536, 22.20807515794636, 16.2155108722052, -11.347750456126562, -10.328156233955992, 12.784466790371267, -2.91562989172265, -3.035761425387709, -18.43153637901945, -3.8523413399167605, -2.5517756615246423, -4.507101329009007, 4.982686263912457, 6.8454322491074695, -4.044758178599853, 8.02490229269194, -19.992210853205307, -3.174035744509018, -9.47977853278639, -21.109462335726, -12.377018919962456, -18.218064733863283, -26.173954713246502, 3.5365606471082423, -11.880483521973048, 2.0433537113080624, 4.036367093211284, -8.665837802651744, 7.850859947490536, 2.7735913487214496, -8.827242280858377, -6.011132409694026, -16.247058778233757, -5.953609843497449, -10.846656878268968, -15.298423079531773, -24.108115783464537, -12.61259846974, -11.796689832492913, 3.5790364412553224, -17.650167673511135, -9.492510322785511, -11.899638398626085, -20.738416921324593, 3.063338659362034, -22.925036664976503, -22.923119556999303, 0.6546803413959665, -29.074685069236196, 4.7285726781802975, -13.506085259865369, -39.246863373460464, -4.3966623372296505, -19.968960830625647, -15.655630442707933, -26.739754391469845, 1.804185433053259, -3.8290038929927332, -16.529985376138495, -10.565651582271087, -28.904690666380823, -39.4336033052251, -25.752347121701895, -17.26424636394533, -26.58916753842002, -19.405859106384707, -30.73642138122496, -9.78217617882947, -9.086547223134291, -40.45973758046631, -4.660286964959045, -13.183801780757813, -14.575373733717004, -23.590895325605967, -10.625214963594113, 1.5737939393347737, -12.446886581676567, 5.999645316910904, -27.3745530949225, -7.46686352561927, -8.220917662748576, -29.16945689541621, -13.3063114927667, -7.8639492383242375, -13.25361642785952, -7.624954694405643, -7.2632274312501925, -13.059571361874315, -6.9885622674593915, -15.50858205417077, -22.94632390304638, -8.671452217709401, -2.910303459135995, -20.15358807579881, -14.557512766912975, 1.2013633585529409], "policy_predator_policy_reward": [5.0799860900945575, 7.586152094065742, 9.627323800268034, -2.9898640281273474, -17.5804006778071, -30.136203278966377, -7.787258000232114, -2.3421271273889497, -24.899490316234047, -19.516659999658675, -12.666665048194968, -19.764356696215426, -0.8164568190185229, 23.511957731271647, 4.953181301811121, 15.703131166100864, -24.20318947516376, -1.3657441055787736, 3.586407353808201, 2.244852429637099, -8.633189815190532, 14.704712665965957, 18.433204001461213, 18.429868756577676, -0.4513046452557745, 8.155987325089283, 3.6504299254456, 1.4531213976036845, 3.0966964255181573, 5.917506232499857, -5.816793475045003, -4.148579052779912, -2.7970497657413063, -10.893814732473633, 2.4787411754223214, 5.6107751817773845, -12.266118086579993, -3.7836864988038768, 11.860758415711924, 28.123663290698676, -0.6928662131086547, 7.040937702126698, 6.1810593980346855, 12.778497667538108, 10.063080056424191, 32.155844615027824, 27.758830076810987, -3.0047922368860736, 18.760697072595793, 17.675432395130777, 31.284337522738745, 21.06357190375426, -7.2231393262931505, 0.15001803207666597, 12.523716394153475, 11.237250649792633, -3.3440315501410396, -0.7426758724750835, -5.449883830624298, -2.6228503557982847, 6.881530746049734, 10.450144859253754, -5.775937781731793, -9.925782113249277, -21.622606429349258, 16.07542373190636, 12.727775567899368, 4.926708993817371, 16.919238147851846, -4.896973328463789, 20.339292965871728, 12.154824590595794, 5.066017560366142, 6.841202126628751, 1.8320731431399828, 19.861240613397946, 12.061621643524688, 18.53522451553888, 32.440019634630495, 15.776211932298583, 21.377413353314335, 3.8477835861656615, 11.677539687147341, 11.915839977838475, 4.428749295250592, -11.586822177761231, 17.861075019043987, 17.439260327978275, 9.115904934512898, 9.869115711058129, 18.19607007896247, 5.603206718289675, 16.225461696782315, 25.25137214586688, 8.192404789315347, -14.31908210803943, 28.07600250230154, 17.77407082765149, 23.216086996155916, 22.630152117842695, 3.7452346849298683, -5.054595367721802, 39.48956643128044, 18.659803707191916, 4.84544587652988, -14.302591232890475, 1.6205584788561591, 25.391612040874584, 40.17636867302733, 38.317358073893594, 20.511972134267346, -11.718647459808043, 22.82191390264658, 17.116007758604745, 24.958169152276657, 6.353091733139208, 25.838170781638386, 27.641338001301325, -3.210673601468736, -0.39769726463778454, -2.177886848923193, 9.83589463490866, 25.26591611742602, 7.794054634850957, -8.184990746098347, 29.316293910640507, 32.658888919458974, 25.150492413302672, 40.19464580347627, 38.672560806973905, 20.852732113317412, 30.65196213008641, 28.49489136522149, 6.033601362669176, 34.790717556362395, 18.38761752047759, 1.6630625985432257, 37.14865561422619, 35.47158793047432, 26.00125483197563, 8.103924233753421, 11.460428123905519, 8.785477333247732, 9.387617113020841, 42.64466445564677, 38.274810705285844, 4.667664654505154, 4.65290927541293, 10.801918938060112, 15.565684623455525, 15.24311664801047, 13.907630819423552, 15.687107375128635, 31.494683276083336, 13.395315029103369, 7.855114898084825, 5.48471189559892, -8.632299774268468, 17.901023773501663, 6.992749389851474, -1.7801696281050337, -10.21912100571677, 30.671203881384635, 24.07790230846035, 0.33470148916860154, 14.599025562069903, 13.701423381705137, 2.740411943792007, 36.414904105683235, 21.924009685149187, 2.3909347131749152, 24.2216882723585, 18.22897695042595, -2.501078473777458, 9.818401353019613, 16.68883150269941, 4.650256027636708, 10.599653361174548, 3.7741348932578918, 10.75231996924248, 27.829091325497675, -1.709948601749054, 2.596733471346637, 11.38039106357214, 7.57903561312873, 23.438128495212794, 2.2127639001993025, 43.679883905893476, 8.52466068843765, 8.818243746981146, 7.960280876691247, -2.1396739584192517, -0.04305752857201295, 40.35023368016961, 16.076971295321226, 13.038054238504719, -7.64059820916378, 5.237871492057867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.737784405292765, "mean_inference_ms": 2.030037295217148, "mean_action_processing_ms": 0.31668158482615, "mean_env_wait_ms": 0.18919632711307183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009567328173704821, "StateBufferConnector_ms": 0.003207693196306325, "ViewRequirementAgentConnector_ms": 0.11437625596017549}, "num_episodes": 27, "episode_return_max": 40.45973758046643, "episode_return_min": -23.858301978386738, "episode_return_mean": 10.187765068509762, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.0382696444729, "num_env_steps_trained_throughput_per_sec": 346.0382696444729, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 11509.689, "restore_workers_time_ms": 0.062, "training_step_time_ms": 11509.515, "sample_time_ms": 1391.063, "learn_time_ms": 10103.525, "learn_throughput": 395.901, "synch_weights_time_ms": 13.881}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 5, "trial_id": "06536_00000", "date": "2024-08-11_16-35-11", "timestamp": 1723408511, "time_this_iter_s": 11.590057849884033, "time_total_s": 57.760913372039795, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331615430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.760913372039795, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 50.53125, "ram_util_percent": 82.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4863443419958153, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.327225432296594, "policy_loss": -0.010845997075375636, "vf_loss": 6.336323114236196, "vf_explained_var": -0.11115114167332649, "kl": 0.008741607614288768, "entropy": 1.5345299241443475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8415164563075574, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.03161203646786, "policy_loss": -0.0035400165008410574, "vf_loss": 6.034052361886968, "vf_explained_var": 0.10099431607458327, "kl": 0.0054983549549924345, "entropy": 1.3859125274829764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 40.45973758046643, "episode_reward_min": -8.024902292691923, "episode_reward_mean": 13.236409495181794, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.45973758046631, "predator_policy": -21.622606429349258}, "policy_reward_max": {"prey_policy": 8.02490229269194, "predator_policy": 43.679883905893476}, "policy_reward_mean": {"prey_policy": -13.236409495181793, "predator_policy": 13.236409495181796}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.044758178599853, -8.024902292691923, 19.99221085320529, 3.1740357445090126, 9.479778532786426, 21.10946233572599, 12.377018919962458, 18.218064733863294, 26.173954713246506, -3.5365606471082423, 11.880483521973035, -2.043353711308065, -4.0363670932112985, 8.665837802651744, -7.850859947490524, -2.7735913487214496, 8.827242280858357, 6.0111324096940235, 16.247058778233768, 5.953609843497446, 10.846656878268968, 15.298423079531785, 24.108115783464534, 12.612598469740005, 11.796689832492921, -3.5790364412553206, 17.65016767351113, 9.492510322785517, 11.899638398626102, 20.738416921324585, -3.0633386593620333, 22.9250366649765, 22.92311955699933, -0.6546803413959652, 29.074685069236125, -4.728572678180292, 13.506085259865367, 39.246863373460464, 4.396662337229647, 19.96896083062564, 15.655630442707931, 26.739754391469845, -1.804185433053263, 3.8290038929927386, 16.52998537613847, 10.56565158227107, 28.904690666380805, 39.43360330522508, 25.75234712170191, 17.264246363945304, 26.58916753841997, 19.40585910638471, 30.736421381224964, 9.782176178829472, 9.086547223134282, 40.45973758046643, 4.660286964959052, 13.183801780757843, 14.575373733717015, 23.590895325605985, 10.625214963594097, -1.5737939393347737, 12.446886581676557, -5.999645316910902, 27.374553094922483, 7.466863525619264, 8.220917662748576, 29.1694568954162, 13.306311492766707, 7.863949238324233, 13.25361642785952, 7.62495469440562, 7.263227431250179, 13.059571361874285, 6.988562267459394, 15.508582054170772, 22.946323903046377, 8.671452217709424, 2.910303459135993, 20.153588075798808, 14.557512766912968, -1.2013633585529604, 17.810766866500714, 21.701620974160733, 9.239121696718465, 9.893811983166843, 5.8653563431942555, 8.230206613902336, 31.63490060247247, 13.509785011911804, 3.893643030653968, 7.248018012973125, 17.075411275603138, 21.531075398281942, 18.70960427173221, 14.969964088877612, 26.429832269694142, 17.08736938799087, 19.949541754509994, 24.93486397244172], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.044758178599853, 8.02490229269194, -19.992210853205307, -3.174035744509018, -9.47977853278639, -21.109462335726, -12.377018919962456, -18.218064733863283, -26.173954713246502, 3.5365606471082423, -11.880483521973048, 2.0433537113080624, 4.036367093211284, -8.665837802651744, 7.850859947490536, 2.7735913487214496, -8.827242280858377, -6.011132409694026, -16.247058778233757, -5.953609843497449, -10.846656878268968, -15.298423079531773, -24.108115783464537, -12.61259846974, -11.796689832492913, 3.5790364412553224, -17.650167673511135, -9.492510322785511, -11.899638398626085, -20.738416921324593, 3.063338659362034, -22.925036664976503, -22.923119556999303, 0.6546803413959665, -29.074685069236196, 4.7285726781802975, -13.506085259865369, -39.246863373460464, -4.3966623372296505, -19.968960830625647, -15.655630442707933, -26.739754391469845, 1.804185433053259, -3.8290038929927332, -16.529985376138495, -10.565651582271087, -28.904690666380823, -39.4336033052251, -25.752347121701895, -17.26424636394533, -26.58916753842002, -19.405859106384707, -30.73642138122496, -9.78217617882947, -9.086547223134291, -40.45973758046631, -4.660286964959045, -13.183801780757813, -14.575373733717004, -23.590895325605967, -10.625214963594113, 1.5737939393347737, -12.446886581676567, 5.999645316910904, -27.3745530949225, -7.46686352561927, -8.220917662748576, -29.16945689541621, -13.3063114927667, -7.8639492383242375, -13.25361642785952, -7.624954694405643, -7.2632274312501925, -13.059571361874315, -6.9885622674593915, -15.50858205417077, -22.94632390304638, -8.671452217709401, -2.910303459135995, -20.15358807579881, -14.557512766912975, 1.2013633585529409, -17.810766866500728, -21.701620974160736, -9.239121696718465, -9.89381198316684, -5.865356343194258, -8.230206613902363, -31.63490060247249, -13.509785011911795, -3.8936430306539633, -7.248018012973121, -17.075411275603166, -21.531075398281907, -18.70960427173223, -14.96996408887761, -26.42983226969414, -17.08736938799086, -19.949541754510005, -24.93486397244176], "policy_predator_policy_reward": [2.4787411754223214, 5.6107751817773845, -12.266118086579993, -3.7836864988038768, 11.860758415711924, 28.123663290698676, -0.6928662131086547, 7.040937702126698, 6.1810593980346855, 12.778497667538108, 10.063080056424191, 32.155844615027824, 27.758830076810987, -3.0047922368860736, 18.760697072595793, 17.675432395130777, 31.284337522738745, 21.06357190375426, -7.2231393262931505, 0.15001803207666597, 12.523716394153475, 11.237250649792633, -3.3440315501410396, -0.7426758724750835, -5.449883830624298, -2.6228503557982847, 6.881530746049734, 10.450144859253754, -5.775937781731793, -9.925782113249277, -21.622606429349258, 16.07542373190636, 12.727775567899368, 4.926708993817371, 16.919238147851846, -4.896973328463789, 20.339292965871728, 12.154824590595794, 5.066017560366142, 6.841202126628751, 1.8320731431399828, 19.861240613397946, 12.061621643524688, 18.53522451553888, 32.440019634630495, 15.776211932298583, 21.377413353314335, 3.8477835861656615, 11.677539687147341, 11.915839977838475, 4.428749295250592, -11.586822177761231, 17.861075019043987, 17.439260327978275, 9.115904934512898, 9.869115711058129, 18.19607007896247, 5.603206718289675, 16.225461696782315, 25.25137214586688, 8.192404789315347, -14.31908210803943, 28.07600250230154, 17.77407082765149, 23.216086996155916, 22.630152117842695, 3.7452346849298683, -5.054595367721802, 39.48956643128044, 18.659803707191916, 4.84544587652988, -14.302591232890475, 1.6205584788561591, 25.391612040874584, 40.17636867302733, 38.317358073893594, 20.511972134267346, -11.718647459808043, 22.82191390264658, 17.116007758604745, 24.958169152276657, 6.353091733139208, 25.838170781638386, 27.641338001301325, -3.210673601468736, -0.39769726463778454, -2.177886848923193, 9.83589463490866, 25.26591611742602, 7.794054634850957, -8.184990746098347, 29.316293910640507, 32.658888919458974, 25.150492413302672, 40.19464580347627, 38.672560806973905, 20.852732113317412, 30.65196213008641, 28.49489136522149, 6.033601362669176, 34.790717556362395, 18.38761752047759, 1.6630625985432257, 37.14865561422619, 35.47158793047432, 26.00125483197563, 8.103924233753421, 11.460428123905519, 8.785477333247732, 9.387617113020841, 42.64466445564677, 38.274810705285844, 4.667664654505154, 4.65290927541293, 10.801918938060112, 15.565684623455525, 15.24311664801047, 13.907630819423552, 15.687107375128635, 31.494683276083336, 13.395315029103369, 7.855114898084825, 5.48471189559892, -8.632299774268468, 17.901023773501663, 6.992749389851474, -1.7801696281050337, -10.21912100571677, 30.671203881384635, 24.07790230846035, 0.33470148916860154, 14.599025562069903, 13.701423381705137, 2.740411943792007, 36.414904105683235, 21.924009685149187, 2.3909347131749152, 24.2216882723585, 18.22897695042595, -2.501078473777458, 9.818401353019613, 16.68883150269941, 4.650256027636708, 10.599653361174548, 3.7741348932578918, 10.75231996924248, 27.829091325497675, -1.709948601749054, 2.596733471346637, 11.38039106357214, 7.57903561312873, 23.438128495212794, 2.2127639001993025, 43.679883905893476, 8.52466068843765, 8.818243746981146, 7.960280876691247, -2.1396739584192517, -0.04305752857201295, 40.35023368016961, 16.076971295321226, 13.038054238504719, -7.64059820916378, 5.237871492057867, 15.753998774904847, 19.867534958096613, 32.28143509050216, 11.121806857819292, 8.876970068034538, 9.601273325402396, 16.32354040069908, 3.464083565634595, 1.418351275122057, 10.312361411266448, 28.534647010975046, -12.074233783170355, 42.18303031208845, 21.086770892856542, 13.245382760036556, 13.774187263787036, -5.24090594468034, 13.028192005988295, 5.453825720090688, 9.04221030585556, 32.920229697330974, 1.2305928538753257, 20.49184229377925, 22.570308502784606, 11.993391250318798, 25.425817293145656, 6.480418666476745, 23.45950951127847, 35.682325798492535, 17.1773387408957, 11.05108982674424, 23.123648949237474, 21.110962549134197, 18.788120959885806, 14.600039413684902, 35.26968853119861]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7002572531552914, "mean_inference_ms": 1.9029458301228448, "mean_action_processing_ms": 0.29828190665133186, "mean_env_wait_ms": 0.17473758335904507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008557438850402832, "StateBufferConnector_ms": 0.0035393238067626953, "ViewRequirementAgentConnector_ms": 0.10541033744812012}, "num_episodes": 18, "episode_return_max": 40.45973758046643, "episode_return_min": -8.024902292691923, "episode_return_mean": 13.236409495181794, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.5453914908572, "num_env_steps_trained_throughput_per_sec": 359.5453914908572, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 11445.603, "restore_workers_time_ms": 0.056, "training_step_time_ms": 11445.295, "sample_time_ms": 1413.704, "learn_time_ms": 10006.385, "learn_throughput": 399.745, "synch_weights_time_ms": 23.385}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 6, "trial_id": "06536_00000", "date": "2024-08-11_16-35-22", "timestamp": 1723408522, "time_this_iter_s": 11.274852991104126, "time_total_s": 69.03576636314392, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331615d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.03576636314392, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.10625, "ram_util_percent": 81.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7530533337344727, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.538409318278233, "policy_loss": -0.011710237730585504, "vf_loss": 5.548573137571414, "vf_explained_var": 0.029626251384615897, "kl": 0.0077321937581285635, "entropy": 1.526173512885968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.083033363844352, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.933403658109998, "policy_loss": -0.008956159392332352, "vf_loss": 4.940067966526779, "vf_explained_var": 0.02192788250231869, "kl": 0.011459277377240578, "entropy": 1.3394139122710658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 40.45973758046643, "episode_reward_min": -5.999645316910902, "episode_reward_mean": 15.332378623127601, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.45973758046631, "predator_policy": -14.31908210803943}, "policy_reward_max": {"prey_policy": 5.999645316910904, "predator_policy": 43.679883905893476}, "policy_reward_mean": {"prey_policy": -15.3323786231276, "predator_policy": 15.3323786231276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.247058778233768, 5.953609843497446, 10.846656878268968, 15.298423079531785, 24.108115783464534, 12.612598469740005, 11.796689832492921, -3.5790364412553206, 17.65016767351113, 9.492510322785517, 11.899638398626102, 20.738416921324585, -3.0633386593620333, 22.9250366649765, 22.92311955699933, -0.6546803413959652, 29.074685069236125, -4.728572678180292, 13.506085259865367, 39.246863373460464, 4.396662337229647, 19.96896083062564, 15.655630442707931, 26.739754391469845, -1.804185433053263, 3.8290038929927386, 16.52998537613847, 10.56565158227107, 28.904690666380805, 39.43360330522508, 25.75234712170191, 17.264246363945304, 26.58916753841997, 19.40585910638471, 30.736421381224964, 9.782176178829472, 9.086547223134282, 40.45973758046643, 4.660286964959052, 13.183801780757843, 14.575373733717015, 23.590895325605985, 10.625214963594097, -1.5737939393347737, 12.446886581676557, -5.999645316910902, 27.374553094922483, 7.466863525619264, 8.220917662748576, 29.1694568954162, 13.306311492766707, 7.863949238324233, 13.25361642785952, 7.62495469440562, 7.263227431250179, 13.059571361874285, 6.988562267459394, 15.508582054170772, 22.946323903046377, 8.671452217709424, 2.910303459135993, 20.153588075798808, 14.557512766912968, -1.2013633585529604, 17.810766866500714, 21.701620974160733, 9.239121696718465, 9.893811983166843, 5.8653563431942555, 8.230206613902336, 31.63490060247247, 13.509785011911804, 3.893643030653968, 7.248018012973125, 17.075411275603138, 21.531075398281942, 18.70960427173221, 14.969964088877612, 26.429832269694142, 17.08736938799087, 19.949541754509994, 24.93486397244172, 18.13574254922219, 17.3348996566393, 21.490300888502667, 28.84084623625245, 3.9626173226631325, 18.133987948556918, 31.99990413352036, 10.15138530787355, 27.9207457728984, 20.499939404085353, 6.561660236240867, 16.602979011134366, 16.015141175062595, 11.853149594782055, 24.33687116627775, 13.04695342890628, 14.017601999354673, 30.38053194915209], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.247058778233757, -5.953609843497449, -10.846656878268968, -15.298423079531773, -24.108115783464537, -12.61259846974, -11.796689832492913, 3.5790364412553224, -17.650167673511135, -9.492510322785511, -11.899638398626085, -20.738416921324593, 3.063338659362034, -22.925036664976503, -22.923119556999303, 0.6546803413959665, -29.074685069236196, 4.7285726781802975, -13.506085259865369, -39.246863373460464, -4.3966623372296505, -19.968960830625647, -15.655630442707933, -26.739754391469845, 1.804185433053259, -3.8290038929927332, -16.529985376138495, -10.565651582271087, -28.904690666380823, -39.4336033052251, -25.752347121701895, -17.26424636394533, -26.58916753842002, -19.405859106384707, -30.73642138122496, -9.78217617882947, -9.086547223134291, -40.45973758046631, -4.660286964959045, -13.183801780757813, -14.575373733717004, -23.590895325605967, -10.625214963594113, 1.5737939393347737, -12.446886581676567, 5.999645316910904, -27.3745530949225, -7.46686352561927, -8.220917662748576, -29.16945689541621, -13.3063114927667, -7.8639492383242375, -13.25361642785952, -7.624954694405643, -7.2632274312501925, -13.059571361874315, -6.9885622674593915, -15.50858205417077, -22.94632390304638, -8.671452217709401, -2.910303459135995, -20.15358807579881, -14.557512766912975, 1.2013633585529409, -17.810766866500728, -21.701620974160736, -9.239121696718465, -9.89381198316684, -5.865356343194258, -8.230206613902363, -31.63490060247249, -13.509785011911795, -3.8936430306539633, -7.248018012973121, -17.075411275603166, -21.531075398281907, -18.70960427173223, -14.96996408887761, -26.42983226969414, -17.08736938799086, -19.949541754510005, -24.93486397244176, -18.135742549222147, -17.33489965663929, -21.490300888502645, -28.840846236252453, -3.962617322663138, -18.133987948556943, -31.999904133520374, -10.151385307873529, -27.92074577289842, -20.49993940408534, -6.561660236240875, -16.602979011134366, -16.015141175062592, -11.85314959478207, -24.33687116627774, -13.04695342890632, -14.017601999354685, -30.3805319491521], "policy_predator_policy_reward": [20.339292965871728, 12.154824590595794, 5.066017560366142, 6.841202126628751, 1.8320731431399828, 19.861240613397946, 12.061621643524688, 18.53522451553888, 32.440019634630495, 15.776211932298583, 21.377413353314335, 3.8477835861656615, 11.677539687147341, 11.915839977838475, 4.428749295250592, -11.586822177761231, 17.861075019043987, 17.439260327978275, 9.115904934512898, 9.869115711058129, 18.19607007896247, 5.603206718289675, 16.225461696782315, 25.25137214586688, 8.192404789315347, -14.31908210803943, 28.07600250230154, 17.77407082765149, 23.216086996155916, 22.630152117842695, 3.7452346849298683, -5.054595367721802, 39.48956643128044, 18.659803707191916, 4.84544587652988, -14.302591232890475, 1.6205584788561591, 25.391612040874584, 40.17636867302733, 38.317358073893594, 20.511972134267346, -11.718647459808043, 22.82191390264658, 17.116007758604745, 24.958169152276657, 6.353091733139208, 25.838170781638386, 27.641338001301325, -3.210673601468736, -0.39769726463778454, -2.177886848923193, 9.83589463490866, 25.26591611742602, 7.794054634850957, -8.184990746098347, 29.316293910640507, 32.658888919458974, 25.150492413302672, 40.19464580347627, 38.672560806973905, 20.852732113317412, 30.65196213008641, 28.49489136522149, 6.033601362669176, 34.790717556362395, 18.38761752047759, 1.6630625985432257, 37.14865561422619, 35.47158793047432, 26.00125483197563, 8.103924233753421, 11.460428123905519, 8.785477333247732, 9.387617113020841, 42.64466445564677, 38.274810705285844, 4.667664654505154, 4.65290927541293, 10.801918938060112, 15.565684623455525, 15.24311664801047, 13.907630819423552, 15.687107375128635, 31.494683276083336, 13.395315029103369, 7.855114898084825, 5.48471189559892, -8.632299774268468, 17.901023773501663, 6.992749389851474, -1.7801696281050337, -10.21912100571677, 30.671203881384635, 24.07790230846035, 0.33470148916860154, 14.599025562069903, 13.701423381705137, 2.740411943792007, 36.414904105683235, 21.924009685149187, 2.3909347131749152, 24.2216882723585, 18.22897695042595, -2.501078473777458, 9.818401353019613, 16.68883150269941, 4.650256027636708, 10.599653361174548, 3.7741348932578918, 10.75231996924248, 27.829091325497675, -1.709948601749054, 2.596733471346637, 11.38039106357214, 7.57903561312873, 23.438128495212794, 2.2127639001993025, 43.679883905893476, 8.52466068843765, 8.818243746981146, 7.960280876691247, -2.1396739584192517, -0.04305752857201295, 40.35023368016961, 16.076971295321226, 13.038054238504719, -7.64059820916378, 5.237871492057867, 15.753998774904847, 19.867534958096613, 32.28143509050216, 11.121806857819292, 8.876970068034538, 9.601273325402396, 16.32354040069908, 3.464083565634595, 1.418351275122057, 10.312361411266448, 28.534647010975046, -12.074233783170355, 42.18303031208845, 21.086770892856542, 13.245382760036556, 13.774187263787036, -5.24090594468034, 13.028192005988295, 5.453825720090688, 9.04221030585556, 32.920229697330974, 1.2305928538753257, 20.49184229377925, 22.570308502784606, 11.993391250318798, 25.425817293145656, 6.480418666476745, 23.45950951127847, 35.682325798492535, 17.1773387408957, 11.05108982674424, 23.123648949237474, 21.110962549134197, 18.788120959885806, 14.600039413684902, 35.26968853119861, 24.5270079532858, 11.74447714515851, 4.477937337254202, 30.191861976024406, 6.279832076272298, 36.700769700733005, 33.014488520247866, 24.667203952257044, 2.0973020430921556, 5.827932602234117, 14.529952282243677, 21.738023614870187, 38.62041173528592, 25.379396531754836, 11.771760063386377, 8.531010552360698, 35.82214705648717, 20.019344489309677, 23.780970276962556, 17.21890853120813, 15.337854050998544, -2.21453357851681, -2.5473345721178013, 35.75329259438648, 6.543875609302284, 25.486406740822886, 13.502110304370058, 10.204188885194064, 28.986997946956542, 19.686744385598935, 27.53494022966229, -1.441033371849711, 28.598433510822524, -0.5632295121131952, 30.566918034784695, 30.19414586351948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.685091714193816, "mean_inference_ms": 1.8329061842128807, "mean_action_processing_ms": 0.28980048729285607, "mean_env_wait_ms": 0.16609950972953402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008252382278442383, "StateBufferConnector_ms": 0.0034117698669433594, "ViewRequirementAgentConnector_ms": 0.10601973533630371}, "num_episodes": 18, "episode_return_max": 40.45973758046643, "episode_return_min": -5.999645316910902, "episode_return_mean": 15.332378623127601, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.8487328237336, "num_env_steps_trained_throughput_per_sec": 342.8487328237336, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 11477.228, "restore_workers_time_ms": 0.053, "training_step_time_ms": 11476.953, "sample_time_ms": 1358.278, "learn_time_ms": 10095.334, "learn_throughput": 396.223, "synch_weights_time_ms": 21.671}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 7, "trial_id": "06536_00000", "date": "2024-08-11_16-35-34", "timestamp": 1723408534, "time_this_iter_s": 11.698783874511719, "time_total_s": 80.73455023765564, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310cd8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.73455023765564, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 51.94117647058823, "ram_util_percent": 82.18823529411766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9212417774523298, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.791286392509937, "policy_loss": -0.01198723637474662, "vf_loss": 4.801726973553499, "vf_explained_var": 0.09118430148810149, "kl": 0.007733364681829685, "entropy": 1.5088083550333977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.056186554293153, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9667720823691637, "policy_loss": -0.005579521780015615, "vf_loss": 3.9709712714745256, "vf_explained_var": 0.23279940567950091, "kl": 0.006901670130320363, "entropy": 1.2933356304017325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 40.45973758046643, "episode_reward_min": -5.999645316910902, "episode_reward_mean": 16.509048153786008, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.45973758046631, "predator_policy": -12.074233783170355}, "policy_reward_max": {"prey_policy": 5.999645316910904, "predator_policy": 44.542290209986504}, "policy_reward_mean": {"prey_policy": -16.509048153786008, "predator_policy": 16.509048153786008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.506085259865367, 39.246863373460464, 4.396662337229647, 19.96896083062564, 15.655630442707931, 26.739754391469845, -1.804185433053263, 3.8290038929927386, 16.52998537613847, 10.56565158227107, 28.904690666380805, 39.43360330522508, 25.75234712170191, 17.264246363945304, 26.58916753841997, 19.40585910638471, 30.736421381224964, 9.782176178829472, 9.086547223134282, 40.45973758046643, 4.660286964959052, 13.183801780757843, 14.575373733717015, 23.590895325605985, 10.625214963594097, -1.5737939393347737, 12.446886581676557, -5.999645316910902, 27.374553094922483, 7.466863525619264, 8.220917662748576, 29.1694568954162, 13.306311492766707, 7.863949238324233, 13.25361642785952, 7.62495469440562, 7.263227431250179, 13.059571361874285, 6.988562267459394, 15.508582054170772, 22.946323903046377, 8.671452217709424, 2.910303459135993, 20.153588075798808, 14.557512766912968, -1.2013633585529604, 17.810766866500714, 21.701620974160733, 9.239121696718465, 9.893811983166843, 5.8653563431942555, 8.230206613902336, 31.63490060247247, 13.509785011911804, 3.893643030653968, 7.248018012973125, 17.075411275603138, 21.531075398281942, 18.70960427173221, 14.969964088877612, 26.429832269694142, 17.08736938799087, 19.949541754509994, 24.93486397244172, 18.13574254922219, 17.3348996566393, 21.490300888502667, 28.84084623625245, 3.9626173226631325, 18.133987948556918, 31.99990413352036, 10.15138530787355, 27.9207457728984, 20.499939404085353, 6.561660236240867, 16.602979011134366, 16.015141175062595, 11.853149594782055, 24.33687116627775, 13.04695342890628, 14.017601999354673, 30.38053194915209, 23.55389728291236, 12.865542409803314, 22.63177793663656, 22.161874907431923, 30.404416466033542, 27.96442569271004, 7.148842840827936, 20.173601618211226, 6.981376930444311, 18.805087385219267, 14.438001689116634, 26.662607398656338, 26.811504261354806, 16.9087159125174, 20.956445165422906, 12.493144115289185, 28.123190666033114, -1.876400460285124], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.506085259865369, -39.246863373460464, -4.3966623372296505, -19.968960830625647, -15.655630442707933, -26.739754391469845, 1.804185433053259, -3.8290038929927332, -16.529985376138495, -10.565651582271087, -28.904690666380823, -39.4336033052251, -25.752347121701895, -17.26424636394533, -26.58916753842002, -19.405859106384707, -30.73642138122496, -9.78217617882947, -9.086547223134291, -40.45973758046631, -4.660286964959045, -13.183801780757813, -14.575373733717004, -23.590895325605967, -10.625214963594113, 1.5737939393347737, -12.446886581676567, 5.999645316910904, -27.3745530949225, -7.46686352561927, -8.220917662748576, -29.16945689541621, -13.3063114927667, -7.8639492383242375, -13.25361642785952, -7.624954694405643, -7.2632274312501925, -13.059571361874315, -6.9885622674593915, -15.50858205417077, -22.94632390304638, -8.671452217709401, -2.910303459135995, -20.15358807579881, -14.557512766912975, 1.2013633585529409, -17.810766866500728, -21.701620974160736, -9.239121696718465, -9.89381198316684, -5.865356343194258, -8.230206613902363, -31.63490060247249, -13.509785011911795, -3.8936430306539633, -7.248018012973121, -17.075411275603166, -21.531075398281907, -18.70960427173223, -14.96996408887761, -26.42983226969414, -17.08736938799086, -19.949541754510005, -24.93486397244176, -18.135742549222147, -17.33489965663929, -21.490300888502645, -28.840846236252453, -3.962617322663138, -18.133987948556943, -31.999904133520374, -10.151385307873529, -27.92074577289842, -20.49993940408534, -6.561660236240875, -16.602979011134366, -16.015141175062592, -11.85314959478207, -24.33687116627774, -13.04695342890632, -14.017601999354685, -30.3805319491521, -23.55389728291237, -12.865542409803291, -22.631777936636514, -22.161874907431933, -30.40441646603357, -27.96442569270998, -7.148842840827954, -20.17360161821122, -6.981376930444311, -18.805087385219213, -14.438001689116634, -26.66260739865633, -26.81150426135479, -16.908715912517394, -20.95644516542288, -12.493144115289194, -28.123190666033132, 1.8764004602851236], "policy_predator_policy_reward": [1.6205584788561591, 25.391612040874584, 40.17636867302733, 38.317358073893594, 20.511972134267346, -11.718647459808043, 22.82191390264658, 17.116007758604745, 24.958169152276657, 6.353091733139208, 25.838170781638386, 27.641338001301325, -3.210673601468736, -0.39769726463778454, -2.177886848923193, 9.83589463490866, 25.26591611742602, 7.794054634850957, -8.184990746098347, 29.316293910640507, 32.658888919458974, 25.150492413302672, 40.19464580347627, 38.672560806973905, 20.852732113317412, 30.65196213008641, 28.49489136522149, 6.033601362669176, 34.790717556362395, 18.38761752047759, 1.6630625985432257, 37.14865561422619, 35.47158793047432, 26.00125483197563, 8.103924233753421, 11.460428123905519, 8.785477333247732, 9.387617113020841, 42.64466445564677, 38.274810705285844, 4.667664654505154, 4.65290927541293, 10.801918938060112, 15.565684623455525, 15.24311664801047, 13.907630819423552, 15.687107375128635, 31.494683276083336, 13.395315029103369, 7.855114898084825, 5.48471189559892, -8.632299774268468, 17.901023773501663, 6.992749389851474, -1.7801696281050337, -10.21912100571677, 30.671203881384635, 24.07790230846035, 0.33470148916860154, 14.599025562069903, 13.701423381705137, 2.740411943792007, 36.414904105683235, 21.924009685149187, 2.3909347131749152, 24.2216882723585, 18.22897695042595, -2.501078473777458, 9.818401353019613, 16.68883150269941, 4.650256027636708, 10.599653361174548, 3.7741348932578918, 10.75231996924248, 27.829091325497675, -1.709948601749054, 2.596733471346637, 11.38039106357214, 7.57903561312873, 23.438128495212794, 2.2127639001993025, 43.679883905893476, 8.52466068843765, 8.818243746981146, 7.960280876691247, -2.1396739584192517, -0.04305752857201295, 40.35023368016961, 16.076971295321226, 13.038054238504719, -7.64059820916378, 5.237871492057867, 15.753998774904847, 19.867534958096613, 32.28143509050216, 11.121806857819292, 8.876970068034538, 9.601273325402396, 16.32354040069908, 3.464083565634595, 1.418351275122057, 10.312361411266448, 28.534647010975046, -12.074233783170355, 42.18303031208845, 21.086770892856542, 13.245382760036556, 13.774187263787036, -5.24090594468034, 13.028192005988295, 5.453825720090688, 9.04221030585556, 32.920229697330974, 1.2305928538753257, 20.49184229377925, 22.570308502784606, 11.993391250318798, 25.425817293145656, 6.480418666476745, 23.45950951127847, 35.682325798492535, 17.1773387408957, 11.05108982674424, 23.123648949237474, 21.110962549134197, 18.788120959885806, 14.600039413684902, 35.26968853119861, 24.5270079532858, 11.74447714515851, 4.477937337254202, 30.191861976024406, 6.279832076272298, 36.700769700733005, 33.014488520247866, 24.667203952257044, 2.0973020430921556, 5.827932602234117, 14.529952282243677, 21.738023614870187, 38.62041173528592, 25.379396531754836, 11.771760063386377, 8.531010552360698, 35.82214705648717, 20.019344489309677, 23.780970276962556, 17.21890853120813, 15.337854050998544, -2.21453357851681, -2.5473345721178013, 35.75329259438648, 6.543875609302284, 25.486406740822886, 13.502110304370058, 10.204188885194064, 28.986997946956542, 19.686744385598935, 27.53494022966229, -1.441033371849711, 28.598433510822524, -0.5632295121131952, 30.566918034784695, 30.19414586351948, 20.43934439623638, 26.66845016958836, 12.822486554460781, 12.90859826514581, 13.073194474259289, 32.190361399013696, 36.36496656797077, 7.958783246893117, 33.406591470198684, 27.402241461868428, 37.379024210981854, 18.549827174438114, 9.096265611203401, 5.201420070452487, 37.39016765973058, 2.957035576691891, 8.061897162310647, 5.900856698577972, 20.74728722801619, 16.862887542422275, 22.746028891950186, 6.129974486283082, 8.782924587326157, 44.542290209986504, 36.92173465400298, 16.701273868706572, 4.888356214833039, 28.929075610201743, 15.42242258109831, 26.490467749747474, 7.590628972625042, 17.395659257953326, 28.465260318881548, 27.78112101318471, 1.9266519965711666, -5.6794529171414165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6741126375284117, "mean_inference_ms": 1.7747769217751466, "mean_action_processing_ms": 0.283247256268642, "mean_env_wait_ms": 0.1605124445441967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00768887996673584, "StateBufferConnector_ms": 0.004086017608642578, "ViewRequirementAgentConnector_ms": 0.13993024826049805}, "num_episodes": 18, "episode_return_max": 40.45973758046643, "episode_return_min": -5.999645316910902, "episode_return_mean": 16.509048153786008, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.91486741545975, "num_env_steps_trained_throughput_per_sec": 352.91486741545975, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11459.35, "restore_workers_time_ms": 0.05, "training_step_time_ms": 11459.098, "sample_time_ms": 1331.081, "learn_time_ms": 10106.118, "learn_throughput": 395.8, "synch_weights_time_ms": 20.282}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 8, "trial_id": "06536_00000", "date": "2024-08-11_16-35-46", "timestamp": 1723408546, "time_this_iter_s": 11.37447214126587, "time_total_s": 92.10902237892151, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331618790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.10902237892151, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 48.4625, "ram_util_percent": 82.30625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1568110378459098, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.100079083194335, "policy_loss": -0.009200062455784063, "vf_loss": 4.107705393681924, "vf_explained_var": 0.004175436620910963, "kl": 0.007868710696029553, "entropy": 1.4961555002878109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1660850318335982, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1382189668675577, "policy_loss": -0.0034357971665769736, "vf_loss": 3.140969583344838, "vf_explained_var": 0.3650122034802008, "kl": 0.0034258959889346234, "entropy": 1.2774166766928616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 32.46921819717015, "episode_reward_min": -5.999645316910902, "episode_reward_mean": 16.067352611763642, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -32.469218197170164, "predator_policy": -12.074233783170355}, "policy_reward_max": {"prey_policy": 5.999645316910904, "predator_policy": 44.542290209986504}, "policy_reward_mean": {"prey_policy": -16.067352611763642, "predator_policy": 16.067352611763646}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.575373733717015, 23.590895325605985, 10.625214963594097, -1.5737939393347737, 12.446886581676557, -5.999645316910902, 27.374553094922483, 7.466863525619264, 8.220917662748576, 29.1694568954162, 13.306311492766707, 7.863949238324233, 13.25361642785952, 7.62495469440562, 7.263227431250179, 13.059571361874285, 6.988562267459394, 15.508582054170772, 22.946323903046377, 8.671452217709424, 2.910303459135993, 20.153588075798808, 14.557512766912968, -1.2013633585529604, 17.810766866500714, 21.701620974160733, 9.239121696718465, 9.893811983166843, 5.8653563431942555, 8.230206613902336, 31.63490060247247, 13.509785011911804, 3.893643030653968, 7.248018012973125, 17.075411275603138, 21.531075398281942, 18.70960427173221, 14.969964088877612, 26.429832269694142, 17.08736938799087, 19.949541754509994, 24.93486397244172, 18.13574254922219, 17.3348996566393, 21.490300888502667, 28.84084623625245, 3.9626173226631325, 18.133987948556918, 31.99990413352036, 10.15138530787355, 27.9207457728984, 20.499939404085353, 6.561660236240867, 16.602979011134366, 16.015141175062595, 11.853149594782055, 24.33687116627775, 13.04695342890628, 14.017601999354673, 30.38053194915209, 23.55389728291236, 12.865542409803314, 22.63177793663656, 22.161874907431923, 30.404416466033542, 27.96442569271004, 7.148842840827936, 20.173601618211226, 6.981376930444311, 18.805087385219267, 14.438001689116634, 26.662607398656338, 26.811504261354806, 16.9087159125174, 20.956445165422906, 12.493144115289185, 28.123190666033114, -1.876400460285124, 32.46921819717015, 17.57830725626918, 6.917656894713047, 30.03757021559167, 15.97542548370927, 6.4738738680046835, 14.65103752264313, 24.35430790548083, -2.8290818435753726, 18.413411003676913, 32.00868851300346, 15.992960771760425, 13.109559412521456, 21.581163347544575, 13.699390927516383, 23.7692404575299, 23.45410923246857, 3.228762165316714, 23.873577011174472, 9.553149817097912, 3.528101763338566, 21.883313139945454], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.575373733717004, -23.590895325605967, -10.625214963594113, 1.5737939393347737, -12.446886581676567, 5.999645316910904, -27.3745530949225, -7.46686352561927, -8.220917662748576, -29.16945689541621, -13.3063114927667, -7.8639492383242375, -13.25361642785952, -7.624954694405643, -7.2632274312501925, -13.059571361874315, -6.9885622674593915, -15.50858205417077, -22.94632390304638, -8.671452217709401, -2.910303459135995, -20.15358807579881, -14.557512766912975, 1.2013633585529409, -17.810766866500728, -21.701620974160736, -9.239121696718465, -9.89381198316684, -5.865356343194258, -8.230206613902363, -31.63490060247249, -13.509785011911795, -3.8936430306539633, -7.248018012973121, -17.075411275603166, -21.531075398281907, -18.70960427173223, -14.96996408887761, -26.42983226969414, -17.08736938799086, -19.949541754510005, -24.93486397244176, -18.135742549222147, -17.33489965663929, -21.490300888502645, -28.840846236252453, -3.962617322663138, -18.133987948556943, -31.999904133520374, -10.151385307873529, -27.92074577289842, -20.49993940408534, -6.561660236240875, -16.602979011134366, -16.015141175062592, -11.85314959478207, -24.33687116627774, -13.04695342890632, -14.017601999354685, -30.3805319491521, -23.55389728291237, -12.865542409803291, -22.631777936636514, -22.161874907431933, -30.40441646603357, -27.96442569270998, -7.148842840827954, -20.17360161821122, -6.981376930444311, -18.805087385219213, -14.438001689116634, -26.66260739865633, -26.81150426135479, -16.908715912517394, -20.95644516542288, -12.493144115289194, -28.123190666033132, 1.8764004602851236, -32.469218197170164, -17.578307256269184, -6.917656894713044, -30.037570215591767, -15.97542548370924, -6.473873868004682, -14.651037522643168, -24.35430790548085, 2.8290818435753726, -18.413411003676906, -32.008688513003456, -15.99296077176046, -13.10955941252146, -21.5811633475446, -13.699390927516365, -23.769240457529897, -23.454109232468593, -3.228762165316713, -23.873577011174454, -9.553149817097895, -3.5281017633385665, -21.883313139945436], "policy_predator_policy_reward": [15.24311664801047, 13.907630819423552, 15.687107375128635, 31.494683276083336, 13.395315029103369, 7.855114898084825, 5.48471189559892, -8.632299774268468, 17.901023773501663, 6.992749389851474, -1.7801696281050337, -10.21912100571677, 30.671203881384635, 24.07790230846035, 0.33470148916860154, 14.599025562069903, 13.701423381705137, 2.740411943792007, 36.414904105683235, 21.924009685149187, 2.3909347131749152, 24.2216882723585, 18.22897695042595, -2.501078473777458, 9.818401353019613, 16.68883150269941, 4.650256027636708, 10.599653361174548, 3.7741348932578918, 10.75231996924248, 27.829091325497675, -1.709948601749054, 2.596733471346637, 11.38039106357214, 7.57903561312873, 23.438128495212794, 2.2127639001993025, 43.679883905893476, 8.52466068843765, 8.818243746981146, 7.960280876691247, -2.1396739584192517, -0.04305752857201295, 40.35023368016961, 16.076971295321226, 13.038054238504719, -7.64059820916378, 5.237871492057867, 15.753998774904847, 19.867534958096613, 32.28143509050216, 11.121806857819292, 8.876970068034538, 9.601273325402396, 16.32354040069908, 3.464083565634595, 1.418351275122057, 10.312361411266448, 28.534647010975046, -12.074233783170355, 42.18303031208845, 21.086770892856542, 13.245382760036556, 13.774187263787036, -5.24090594468034, 13.028192005988295, 5.453825720090688, 9.04221030585556, 32.920229697330974, 1.2305928538753257, 20.49184229377925, 22.570308502784606, 11.993391250318798, 25.425817293145656, 6.480418666476745, 23.45950951127847, 35.682325798492535, 17.1773387408957, 11.05108982674424, 23.123648949237474, 21.110962549134197, 18.788120959885806, 14.600039413684902, 35.26968853119861, 24.5270079532858, 11.74447714515851, 4.477937337254202, 30.191861976024406, 6.279832076272298, 36.700769700733005, 33.014488520247866, 24.667203952257044, 2.0973020430921556, 5.827932602234117, 14.529952282243677, 21.738023614870187, 38.62041173528592, 25.379396531754836, 11.771760063386377, 8.531010552360698, 35.82214705648717, 20.019344489309677, 23.780970276962556, 17.21890853120813, 15.337854050998544, -2.21453357851681, -2.5473345721178013, 35.75329259438648, 6.543875609302284, 25.486406740822886, 13.502110304370058, 10.204188885194064, 28.986997946956542, 19.686744385598935, 27.53494022966229, -1.441033371849711, 28.598433510822524, -0.5632295121131952, 30.566918034784695, 30.19414586351948, 20.43934439623638, 26.66845016958836, 12.822486554460781, 12.90859826514581, 13.073194474259289, 32.190361399013696, 36.36496656797077, 7.958783246893117, 33.406591470198684, 27.402241461868428, 37.379024210981854, 18.549827174438114, 9.096265611203401, 5.201420070452487, 37.39016765973058, 2.957035576691891, 8.061897162310647, 5.900856698577972, 20.74728722801619, 16.862887542422275, 22.746028891950186, 6.129974486283082, 8.782924587326157, 44.542290209986504, 36.92173465400298, 16.701273868706572, 4.888356214833039, 28.929075610201743, 15.42242258109831, 26.490467749747474, 7.590628972625042, 17.395659257953326, 28.465260318881548, 27.78112101318471, 1.9266519965711666, -5.6794529171414165, 29.32114541814755, 35.61729097619279, 10.670016140929377, 24.486598371608963, 12.067714106390047, 1.7675996830360579, 29.7486685665847, 30.326471864598744, 4.22927847450457, 27.721572492913918, -1.6202524623771541, 14.568000198386516, 17.877331202644072, 11.42474384264223, 18.75116783779772, 29.957447973163973, -6.958065483654353, 1.299901796503613, 1.745454490216753, 35.08136751713708, 33.011150980638405, 31.006226045368535, 13.392566859163132, 18.593354684357784, 10.08175476517289, 16.13736405987008, 32.95149823120989, 10.210828463879292, 1.8272048810927783, 25.571576973939976, 19.85157167776638, 27.68690923729344, 28.57620986829528, 18.33200859664187, -8.769587036772265, 15.227111367405676, 41.003561654012884, 6.743592368336029, 16.299678361692386, 2.80662127250341, 5.5972001353534955, 1.4590033913236429, 17.80637198688732, 25.960254293003562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6732634357275087, "mean_inference_ms": 1.7506676212339867, "mean_action_processing_ms": 0.2830021288716164, "mean_env_wait_ms": 0.1577868126705749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007323861122131348, "StateBufferConnector_ms": 0.004218578338623047, "ViewRequirementAgentConnector_ms": 0.14417409896850586}, "num_episodes": 22, "episode_return_max": 32.46921819717015, "episode_return_min": -5.999645316910902, "episode_return_mean": 16.067352611763642, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.7737150618814, "num_env_steps_trained_throughput_per_sec": 350.7737150618814, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 11453.13, "restore_workers_time_ms": 0.046, "training_step_time_ms": 11452.896, "sample_time_ms": 1353.296, "learn_time_ms": 10078.828, "learn_throughput": 396.872, "synch_weights_time_ms": 19.263}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 9, "trial_id": "06536_00000", "date": "2024-08-11_16-35-57", "timestamp": 1723408557, "time_this_iter_s": 11.44241714477539, "time_total_s": 103.5514395236969, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316153a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 103.5514395236969, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.98125, "ram_util_percent": 82.33125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1492863637705644, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.104861487199863, "policy_loss": -0.01116031779529294, "vf_loss": 4.114257593825459, "vf_explained_var": 0.20770109730462233, "kl": 0.00882114934964085, "entropy": 1.4529316175729037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5096549765773553, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3467009631414264, "policy_loss": -0.0024839850576229825, "vf_loss": 3.3488187390029744, "vf_explained_var": 0.48030050289693965, "kl": 0.0036621303293512476, "entropy": 1.2258946440207263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 43.477565448387146, "episode_reward_min": -2.8290818435753726, "episode_reward_mean": 18.688213675919204, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.477565448387104, "predator_policy": -12.074233783170355}, "policy_reward_max": {"prey_policy": 2.8290818435753726, "predator_policy": 50.98397964403139}, "policy_reward_mean": {"prey_policy": -18.68821367591921, "predator_policy": 18.688213675919204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.2013633585529604, 17.810766866500714, 21.701620974160733, 9.239121696718465, 9.893811983166843, 5.8653563431942555, 8.230206613902336, 31.63490060247247, 13.509785011911804, 3.893643030653968, 7.248018012973125, 17.075411275603138, 21.531075398281942, 18.70960427173221, 14.969964088877612, 26.429832269694142, 17.08736938799087, 19.949541754509994, 24.93486397244172, 18.13574254922219, 17.3348996566393, 21.490300888502667, 28.84084623625245, 3.9626173226631325, 18.133987948556918, 31.99990413352036, 10.15138530787355, 27.9207457728984, 20.499939404085353, 6.561660236240867, 16.602979011134366, 16.015141175062595, 11.853149594782055, 24.33687116627775, 13.04695342890628, 14.017601999354673, 30.38053194915209, 23.55389728291236, 12.865542409803314, 22.63177793663656, 22.161874907431923, 30.404416466033542, 27.96442569271004, 7.148842840827936, 20.173601618211226, 6.981376930444311, 18.805087385219267, 14.438001689116634, 26.662607398656338, 26.811504261354806, 16.9087159125174, 20.956445165422906, 12.493144115289185, 28.123190666033114, -1.876400460285124, 32.46921819717015, 17.57830725626918, 6.917656894713047, 30.03757021559167, 15.97542548370927, 6.4738738680046835, 14.65103752264313, 24.35430790548083, -2.8290818435753726, 18.413411003676913, 32.00868851300346, 15.992960771760425, 13.109559412521456, 21.581163347544575, 13.699390927516383, 23.7692404575299, 23.45410923246857, 3.228762165316714, 23.873577011174472, 9.553149817097912, 3.528101763338566, 21.883313139945454, 38.42821280411508, 22.44286133555829, 43.477565448387146, 25.177338139065395, 22.263504841720955, 23.505242416827024, 11.489035179797732, 32.805078657011514, 38.07134348064435, 14.654669809712841, 28.09648201712589, 19.879127883418427, 15.246460706439029, 21.148900185436222, 3.560523688430021, 22.995787637310336, 39.98908463654665, 20.585335912910896, 1.4262965601978337, 12.877598533359736, 40.40829561550709, 26.835182217601204, 16.726856626201325], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.2013633585529409, -17.810766866500728, -21.701620974160736, -9.239121696718465, -9.89381198316684, -5.865356343194258, -8.230206613902363, -31.63490060247249, -13.509785011911795, -3.8936430306539633, -7.248018012973121, -17.075411275603166, -21.531075398281907, -18.70960427173223, -14.96996408887761, -26.42983226969414, -17.08736938799086, -19.949541754510005, -24.93486397244176, -18.135742549222147, -17.33489965663929, -21.490300888502645, -28.840846236252453, -3.962617322663138, -18.133987948556943, -31.999904133520374, -10.151385307873529, -27.92074577289842, -20.49993940408534, -6.561660236240875, -16.602979011134366, -16.015141175062592, -11.85314959478207, -24.33687116627774, -13.04695342890632, -14.017601999354685, -30.3805319491521, -23.55389728291237, -12.865542409803291, -22.631777936636514, -22.161874907431933, -30.40441646603357, -27.96442569270998, -7.148842840827954, -20.17360161821122, -6.981376930444311, -18.805087385219213, -14.438001689116634, -26.66260739865633, -26.81150426135479, -16.908715912517394, -20.95644516542288, -12.493144115289194, -28.123190666033132, 1.8764004602851236, -32.469218197170164, -17.578307256269184, -6.917656894713044, -30.037570215591767, -15.97542548370924, -6.473873868004682, -14.651037522643168, -24.35430790548085, 2.8290818435753726, -18.413411003676906, -32.008688513003456, -15.99296077176046, -13.10955941252146, -21.5811633475446, -13.699390927516365, -23.769240457529897, -23.454109232468593, -3.228762165316713, -23.873577011174454, -9.553149817097895, -3.5281017633385665, -21.883313139945436, -38.42821280411511, -22.442861335558305, -43.477565448387104, -25.17733813906539, -22.263504841720973, -23.505242416826967, -11.489035179797751, -32.80507865701145, -38.07134348064445, -14.654669809712825, -28.096482017125936, -19.879127883418445, -15.246460706439043, -21.148900185436204, -3.560523688430028, -22.995787637310393, -39.98908463654659, -20.58533591291087, -1.4262965601978355, -12.877598533359762, -40.40829561550704, -26.835182217601222, -16.726856626201343], "policy_predator_policy_reward": [-7.64059820916378, 5.237871492057867, 15.753998774904847, 19.867534958096613, 32.28143509050216, 11.121806857819292, 8.876970068034538, 9.601273325402396, 16.32354040069908, 3.464083565634595, 1.418351275122057, 10.312361411266448, 28.534647010975046, -12.074233783170355, 42.18303031208845, 21.086770892856542, 13.245382760036556, 13.774187263787036, -5.24090594468034, 13.028192005988295, 5.453825720090688, 9.04221030585556, 32.920229697330974, 1.2305928538753257, 20.49184229377925, 22.570308502784606, 11.993391250318798, 25.425817293145656, 6.480418666476745, 23.45950951127847, 35.682325798492535, 17.1773387408957, 11.05108982674424, 23.123648949237474, 21.110962549134197, 18.788120959885806, 14.600039413684902, 35.26968853119861, 24.5270079532858, 11.74447714515851, 4.477937337254202, 30.191861976024406, 6.279832076272298, 36.700769700733005, 33.014488520247866, 24.667203952257044, 2.0973020430921556, 5.827932602234117, 14.529952282243677, 21.738023614870187, 38.62041173528592, 25.379396531754836, 11.771760063386377, 8.531010552360698, 35.82214705648717, 20.019344489309677, 23.780970276962556, 17.21890853120813, 15.337854050998544, -2.21453357851681, -2.5473345721178013, 35.75329259438648, 6.543875609302284, 25.486406740822886, 13.502110304370058, 10.204188885194064, 28.986997946956542, 19.686744385598935, 27.53494022966229, -1.441033371849711, 28.598433510822524, -0.5632295121131952, 30.566918034784695, 30.19414586351948, 20.43934439623638, 26.66845016958836, 12.822486554460781, 12.90859826514581, 13.073194474259289, 32.190361399013696, 36.36496656797077, 7.958783246893117, 33.406591470198684, 27.402241461868428, 37.379024210981854, 18.549827174438114, 9.096265611203401, 5.201420070452487, 37.39016765973058, 2.957035576691891, 8.061897162310647, 5.900856698577972, 20.74728722801619, 16.862887542422275, 22.746028891950186, 6.129974486283082, 8.782924587326157, 44.542290209986504, 36.92173465400298, 16.701273868706572, 4.888356214833039, 28.929075610201743, 15.42242258109831, 26.490467749747474, 7.590628972625042, 17.395659257953326, 28.465260318881548, 27.78112101318471, 1.9266519965711666, -5.6794529171414165, 29.32114541814755, 35.61729097619279, 10.670016140929377, 24.486598371608963, 12.067714106390047, 1.7675996830360579, 29.7486685665847, 30.326471864598744, 4.22927847450457, 27.721572492913918, -1.6202524623771541, 14.568000198386516, 17.877331202644072, 11.42474384264223, 18.75116783779772, 29.957447973163973, -6.958065483654353, 1.299901796503613, 1.745454490216753, 35.08136751713708, 33.011150980638405, 31.006226045368535, 13.392566859163132, 18.593354684357784, 10.08175476517289, 16.13736405987008, 32.95149823120989, 10.210828463879292, 1.8272048810927783, 25.571576973939976, 19.85157167776638, 27.68690923729344, 28.57620986829528, 18.33200859664187, -8.769587036772265, 15.227111367405676, 41.003561654012884, 6.743592368336029, 16.299678361692386, 2.80662127250341, 5.5972001353534955, 1.4590033913236429, 17.80637198688732, 25.960254293003562, 43.32525302819513, 33.53117258003507, 23.764253410534536, 21.12146926058204, 43.773714214369065, 43.18141668240516, 17.575195885502563, 32.779480392628244, 28.43635048832182, 16.090659195120125, 19.440337417205814, 27.570147416448137, 18.142241290173796, 4.835829069421676, 27.718309301727697, 37.89184801229524, 50.98397964403139, 25.15870731725741, 21.578832345600816, 7.730507273824826, 32.308649547303304, 23.88431448694855, 23.932293295139658, 15.825962471697217, 28.223844179871644, 2.2690772330064597, 10.407586871362422, 31.890213499509976, 1.9422341435855208, 5.178813233274527, 12.356863261635109, 33.63471201298566, 31.816514239422386, 48.16165503367083, 11.44687521009989, 29.72379661572186, 5.915958473494578, -3.0633653530989076, 17.795596408420334, 7.959600658299179, 34.967273088879324, 45.84931814213478, 22.375848339208076, 31.29451609599435, 21.117344322070622, 12.336368930332053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6677828561683624, "mean_inference_ms": 1.7236618306983025, "mean_action_processing_ms": 0.2777571119721587, "mean_env_wait_ms": 0.15577637150607793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005246520042419434, "StateBufferConnector_ms": 0.004280209541320801, "ViewRequirementAgentConnector_ms": 0.1395113468170166}, "num_episodes": 23, "episode_return_max": 43.477565448387146, "episode_return_min": -2.8290818435753726, "episode_return_mean": 18.688213675919204, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.1754856114785, "num_env_steps_trained_throughput_per_sec": 376.1754856114785, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 11371.151, "restore_workers_time_ms": 0.042, "training_step_time_ms": 11370.932, "sample_time_ms": 1299.143, "learn_time_ms": 10051.172, "learn_throughput": 397.964, "synch_weights_time_ms": 19.169}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 10, "trial_id": "06536_00000", "date": "2024-08-11_16-36-08", "timestamp": 1723408568, "time_this_iter_s": 10.674643993377686, "time_total_s": 114.22608351707458, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331615550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.22608351707458, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 46.55333333333333, "ram_util_percent": 82.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3584915225704512, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.358646004771193, "policy_loss": -0.006195751026583215, "vf_loss": 3.3640287965536118, "vf_explained_var": 0.33839337024837735, "kl": 0.004064768844838539, "entropy": 1.4714530357470115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.32748054505656, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9553928093304709, "policy_loss": -0.0051401294191323575, "vf_loss": 1.9601120912839496, "vf_explained_var": 0.7415950896878721, "kl": 0.008417007308396302, "entropy": 1.2205638852068987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": 43.477565448387146, "episode_reward_min": -2.8290818435753726, "episode_reward_mean": 19.516512740837708, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.477565448387104, "predator_policy": -8.769587036772265}, "policy_reward_max": {"prey_policy": 2.8290818435753726, "predator_policy": 50.98397964403139}, "policy_reward_mean": {"prey_policy": -19.516512740837708, "predator_policy": 19.516512740837708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.93486397244172, 18.13574254922219, 17.3348996566393, 21.490300888502667, 28.84084623625245, 3.9626173226631325, 18.133987948556918, 31.99990413352036, 10.15138530787355, 27.9207457728984, 20.499939404085353, 6.561660236240867, 16.602979011134366, 16.015141175062595, 11.853149594782055, 24.33687116627775, 13.04695342890628, 14.017601999354673, 30.38053194915209, 23.55389728291236, 12.865542409803314, 22.63177793663656, 22.161874907431923, 30.404416466033542, 27.96442569271004, 7.148842840827936, 20.173601618211226, 6.981376930444311, 18.805087385219267, 14.438001689116634, 26.662607398656338, 26.811504261354806, 16.9087159125174, 20.956445165422906, 12.493144115289185, 28.123190666033114, -1.876400460285124, 32.46921819717015, 17.57830725626918, 6.917656894713047, 30.03757021559167, 15.97542548370927, 6.4738738680046835, 14.65103752264313, 24.35430790548083, -2.8290818435753726, 18.413411003676913, 32.00868851300346, 15.992960771760425, 13.109559412521456, 21.581163347544575, 13.699390927516383, 23.7692404575299, 23.45410923246857, 3.228762165316714, 23.873577011174472, 9.553149817097912, 3.528101763338566, 21.883313139945454, 38.42821280411508, 22.44286133555829, 43.477565448387146, 25.177338139065395, 22.263504841720955, 23.505242416827024, 11.489035179797732, 32.805078657011514, 38.07134348064435, 14.654669809712841, 28.09648201712589, 19.879127883418427, 15.246460706439029, 21.148900185436222, 3.560523688430021, 22.995787637310336, 39.98908463654665, 20.585335912910896, 1.4262965601978337, 12.877598533359736, 40.40829561550709, 26.835182217601204, 16.726856626201325, 17.836690516263204, 20.44639838746342, 32.254795026520846, 34.46479958882722, 14.924696955553642, 27.657206533702677, 4.338196740922215, 33.31385819557796, 5.816500601670809, 11.795717378249488, 23.292357697897287, 12.79889058117118, 25.252673417358096, 12.23517713952723, 21.68489408834584, 16.263489016813892, 17.687115214312374, 14.345115635464554], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.93486397244176, -18.135742549222147, -17.33489965663929, -21.490300888502645, -28.840846236252453, -3.962617322663138, -18.133987948556943, -31.999904133520374, -10.151385307873529, -27.92074577289842, -20.49993940408534, -6.561660236240875, -16.602979011134366, -16.015141175062592, -11.85314959478207, -24.33687116627774, -13.04695342890632, -14.017601999354685, -30.3805319491521, -23.55389728291237, -12.865542409803291, -22.631777936636514, -22.161874907431933, -30.40441646603357, -27.96442569270998, -7.148842840827954, -20.17360161821122, -6.981376930444311, -18.805087385219213, -14.438001689116634, -26.66260739865633, -26.81150426135479, -16.908715912517394, -20.95644516542288, -12.493144115289194, -28.123190666033132, 1.8764004602851236, -32.469218197170164, -17.578307256269184, -6.917656894713044, -30.037570215591767, -15.97542548370924, -6.473873868004682, -14.651037522643168, -24.35430790548085, 2.8290818435753726, -18.413411003676906, -32.008688513003456, -15.99296077176046, -13.10955941252146, -21.5811633475446, -13.699390927516365, -23.769240457529897, -23.454109232468593, -3.228762165316713, -23.873577011174454, -9.553149817097895, -3.5281017633385665, -21.883313139945436, -38.42821280411511, -22.442861335558305, -43.477565448387104, -25.17733813906539, -22.263504841720973, -23.505242416826967, -11.489035179797751, -32.80507865701145, -38.07134348064445, -14.654669809712825, -28.096482017125936, -19.879127883418445, -15.246460706439043, -21.148900185436204, -3.560523688430028, -22.995787637310393, -39.98908463654659, -20.58533591291087, -1.4262965601978355, -12.877598533359762, -40.40829561550704, -26.835182217601222, -16.726856626201343, -17.83669051626323, -20.44639838746343, -32.25479502652075, -34.46479958882717, -14.924696955553628, -27.65720653370267, -4.338196740922209, -33.313858195578, -5.816500601670785, -11.795717378249469, -23.292357697897287, -12.79889058117119, -25.252673417358125, -12.235177139527218, -21.684894088345843, -16.263489016813875, -17.68711521431239, -14.345115635464534], "policy_predator_policy_reward": [14.600039413684902, 35.26968853119861, 24.5270079532858, 11.74447714515851, 4.477937337254202, 30.191861976024406, 6.279832076272298, 36.700769700733005, 33.014488520247866, 24.667203952257044, 2.0973020430921556, 5.827932602234117, 14.529952282243677, 21.738023614870187, 38.62041173528592, 25.379396531754836, 11.771760063386377, 8.531010552360698, 35.82214705648717, 20.019344489309677, 23.780970276962556, 17.21890853120813, 15.337854050998544, -2.21453357851681, -2.5473345721178013, 35.75329259438648, 6.543875609302284, 25.486406740822886, 13.502110304370058, 10.204188885194064, 28.986997946956542, 19.686744385598935, 27.53494022966229, -1.441033371849711, 28.598433510822524, -0.5632295121131952, 30.566918034784695, 30.19414586351948, 20.43934439623638, 26.66845016958836, 12.822486554460781, 12.90859826514581, 13.073194474259289, 32.190361399013696, 36.36496656797077, 7.958783246893117, 33.406591470198684, 27.402241461868428, 37.379024210981854, 18.549827174438114, 9.096265611203401, 5.201420070452487, 37.39016765973058, 2.957035576691891, 8.061897162310647, 5.900856698577972, 20.74728722801619, 16.862887542422275, 22.746028891950186, 6.129974486283082, 8.782924587326157, 44.542290209986504, 36.92173465400298, 16.701273868706572, 4.888356214833039, 28.929075610201743, 15.42242258109831, 26.490467749747474, 7.590628972625042, 17.395659257953326, 28.465260318881548, 27.78112101318471, 1.9266519965711666, -5.6794529171414165, 29.32114541814755, 35.61729097619279, 10.670016140929377, 24.486598371608963, 12.067714106390047, 1.7675996830360579, 29.7486685665847, 30.326471864598744, 4.22927847450457, 27.721572492913918, -1.6202524623771541, 14.568000198386516, 17.877331202644072, 11.42474384264223, 18.75116783779772, 29.957447973163973, -6.958065483654353, 1.299901796503613, 1.745454490216753, 35.08136751713708, 33.011150980638405, 31.006226045368535, 13.392566859163132, 18.593354684357784, 10.08175476517289, 16.13736405987008, 32.95149823120989, 10.210828463879292, 1.8272048810927783, 25.571576973939976, 19.85157167776638, 27.68690923729344, 28.57620986829528, 18.33200859664187, -8.769587036772265, 15.227111367405676, 41.003561654012884, 6.743592368336029, 16.299678361692386, 2.80662127250341, 5.5972001353534955, 1.4590033913236429, 17.80637198688732, 25.960254293003562, 43.32525302819513, 33.53117258003507, 23.764253410534536, 21.12146926058204, 43.773714214369065, 43.18141668240516, 17.575195885502563, 32.779480392628244, 28.43635048832182, 16.090659195120125, 19.440337417205814, 27.570147416448137, 18.142241290173796, 4.835829069421676, 27.718309301727697, 37.89184801229524, 50.98397964403139, 25.15870731725741, 21.578832345600816, 7.730507273824826, 32.308649547303304, 23.88431448694855, 23.932293295139658, 15.825962471697217, 28.223844179871644, 2.2690772330064597, 10.407586871362422, 31.890213499509976, 1.9422341435855208, 5.178813233274527, 12.356863261635109, 33.63471201298566, 31.816514239422386, 48.16165503367083, 11.44687521009989, 29.72379661572186, 5.915958473494578, -3.0633653530989076, 17.795596408420334, 7.959600658299179, 34.967273088879324, 45.84931814213478, 22.375848339208076, 31.29451609599435, 21.117344322070622, 12.336368930332053, 34.293179450902876, 1.3802015816235533, 18.89610810529563, 21.996688669631254, 32.58767316586998, 31.921916887171637, 37.682882143543125, 31.24671703411121, 16.791402520240673, 13.057991390866567, 24.59994398336637, 30.714469084038967, -6.279202894742996, 14.955596376587405, 46.45906459693458, 20.168651794221354, -1.4680360134757322, 13.10103721681733, 10.207068267059121, 13.38436648943982, 14.883317708791619, 31.701397687002963, 2.210943167664053, 23.386837994678302, 28.509710950371133, 21.995635884345134, 12.538568693124018, 11.931785585930424, 23.36416102634531, 20.005627150346374, 5.414714267284182, 27.112263766343595, 2.360621059076804, 33.01360936954794, 15.304286507762098, 13.38594476316699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6575585268676022, "mean_inference_ms": 1.7017118300934453, "mean_action_processing_ms": 0.27419267772979855, "mean_env_wait_ms": 0.15409315462395362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038666725158691406, "StateBufferConnector_ms": 0.003662705421447754, "ViewRequirementAgentConnector_ms": 0.11868512630462646}, "num_episodes": 18, "episode_return_max": 43.477565448387146, "episode_return_min": -2.8290818435753726, "episode_return_mean": 19.516512740837708, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.93348714081117, "num_env_steps_trained_throughput_per_sec": 328.93348714081117, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 11351.219, "restore_workers_time_ms": 0.044, "training_step_time_ms": 11350.999, "sample_time_ms": 1252.572, "learn_time_ms": 10078.346, "learn_throughput": 396.891, "synch_weights_time_ms": 18.766}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 11, "trial_id": "06536_00000", "date": "2024-08-11_16-36-20", "timestamp": 1723408580, "time_this_iter_s": 12.205480337142944, "time_total_s": 126.43156385421753, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ff9cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.43156385421753, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 51.605555555555554, "ram_util_percent": 82.75555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1353391657893854, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.442064994821946, "policy_loss": -0.006969059985810115, "vf_loss": 3.448502584050099, "vf_explained_var": 0.3386258884022633, "kl": 0.005314688495742275, "entropy": 1.4255173900475104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.631152113594075, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4274743262422147, "policy_loss": -0.005299072309825865, "vf_loss": 2.432360892321067, "vf_explained_var": 0.7102338466064009, "kl": 0.008250221274879664, "entropy": 1.181439815437983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 43.477565448387146, "episode_reward_min": -2.8290818435753726, "episode_reward_mean": 19.919514373650856, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.477565448387104, "predator_policy": -8.769587036772265}, "policy_reward_max": {"prey_policy": 2.8290818435753726, "predator_policy": 50.98397964403139}, "policy_reward_mean": {"prey_policy": -19.919514373650856, "predator_policy": 19.919514373650856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.38053194915209, 23.55389728291236, 12.865542409803314, 22.63177793663656, 22.161874907431923, 30.404416466033542, 27.96442569271004, 7.148842840827936, 20.173601618211226, 6.981376930444311, 18.805087385219267, 14.438001689116634, 26.662607398656338, 26.811504261354806, 16.9087159125174, 20.956445165422906, 12.493144115289185, 28.123190666033114, -1.876400460285124, 32.46921819717015, 17.57830725626918, 6.917656894713047, 30.03757021559167, 15.97542548370927, 6.4738738680046835, 14.65103752264313, 24.35430790548083, -2.8290818435753726, 18.413411003676913, 32.00868851300346, 15.992960771760425, 13.109559412521456, 21.581163347544575, 13.699390927516383, 23.7692404575299, 23.45410923246857, 3.228762165316714, 23.873577011174472, 9.553149817097912, 3.528101763338566, 21.883313139945454, 38.42821280411508, 22.44286133555829, 43.477565448387146, 25.177338139065395, 22.263504841720955, 23.505242416827024, 11.489035179797732, 32.805078657011514, 38.07134348064435, 14.654669809712841, 28.09648201712589, 19.879127883418427, 15.246460706439029, 21.148900185436222, 3.560523688430021, 22.995787637310336, 39.98908463654665, 20.585335912910896, 1.4262965601978337, 12.877598533359736, 40.40829561550709, 26.835182217601204, 16.726856626201325, 17.836690516263204, 20.44639838746342, 32.254795026520846, 34.46479958882722, 14.924696955553642, 27.657206533702677, 4.338196740922215, 33.31385819557796, 5.816500601670809, 11.795717378249488, 23.292357697897287, 12.79889058117118, 25.252673417358096, 12.23517713952723, 21.68489408834584, 16.263489016813892, 17.687115214312374, 14.345115635464554, 31.61073330629532, 33.19496040680699, 13.00500587159723, 27.41631632413227, 21.011738898532805, 22.53943218751145, 19.013523992775482, 22.134137574515734, 14.166311118807705, 24.99135627156253, 14.063320655448681, 11.965591496028026, 21.48887668699414, 29.50661626903391, 27.927162697202753, 11.305620722728708, 11.000958741174, 9.798089864581856], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.3805319491521, -23.55389728291237, -12.865542409803291, -22.631777936636514, -22.161874907431933, -30.40441646603357, -27.96442569270998, -7.148842840827954, -20.17360161821122, -6.981376930444311, -18.805087385219213, -14.438001689116634, -26.66260739865633, -26.81150426135479, -16.908715912517394, -20.95644516542288, -12.493144115289194, -28.123190666033132, 1.8764004602851236, -32.469218197170164, -17.578307256269184, -6.917656894713044, -30.037570215591767, -15.97542548370924, -6.473873868004682, -14.651037522643168, -24.35430790548085, 2.8290818435753726, -18.413411003676906, -32.008688513003456, -15.99296077176046, -13.10955941252146, -21.5811633475446, -13.699390927516365, -23.769240457529897, -23.454109232468593, -3.228762165316713, -23.873577011174454, -9.553149817097895, -3.5281017633385665, -21.883313139945436, -38.42821280411511, -22.442861335558305, -43.477565448387104, -25.17733813906539, -22.263504841720973, -23.505242416826967, -11.489035179797751, -32.80507865701145, -38.07134348064445, -14.654669809712825, -28.096482017125936, -19.879127883418445, -15.246460706439043, -21.148900185436204, -3.560523688430028, -22.995787637310393, -39.98908463654659, -20.58533591291087, -1.4262965601978355, -12.877598533359762, -40.40829561550704, -26.835182217601222, -16.726856626201343, -17.83669051626323, -20.44639838746343, -32.25479502652075, -34.46479958882717, -14.924696955553628, -27.65720653370267, -4.338196740922209, -33.313858195578, -5.816500601670785, -11.795717378249469, -23.292357697897287, -12.79889058117119, -25.252673417358125, -12.235177139527218, -21.684894088345843, -16.263489016813875, -17.68711521431239, -14.345115635464534, -31.61073330629536, -33.19496040680702, -13.005005871597254, -27.416316324132282, -21.01173889853281, -22.539432187511462, -19.013523992775472, -22.134137574515677, -14.166311118807686, -24.991356271562516, -14.063320655448708, -11.965591496028017, -21.488876686994136, -29.506616269033906, -27.927162697202714, -11.30562072272869, -11.000958741173967, -9.798089864581847], "policy_predator_policy_reward": [30.566918034784695, 30.19414586351948, 20.43934439623638, 26.66845016958836, 12.822486554460781, 12.90859826514581, 13.073194474259289, 32.190361399013696, 36.36496656797077, 7.958783246893117, 33.406591470198684, 27.402241461868428, 37.379024210981854, 18.549827174438114, 9.096265611203401, 5.201420070452487, 37.39016765973058, 2.957035576691891, 8.061897162310647, 5.900856698577972, 20.74728722801619, 16.862887542422275, 22.746028891950186, 6.129974486283082, 8.782924587326157, 44.542290209986504, 36.92173465400298, 16.701273868706572, 4.888356214833039, 28.929075610201743, 15.42242258109831, 26.490467749747474, 7.590628972625042, 17.395659257953326, 28.465260318881548, 27.78112101318471, 1.9266519965711666, -5.6794529171414165, 29.32114541814755, 35.61729097619279, 10.670016140929377, 24.486598371608963, 12.067714106390047, 1.7675996830360579, 29.7486685665847, 30.326471864598744, 4.22927847450457, 27.721572492913918, -1.6202524623771541, 14.568000198386516, 17.877331202644072, 11.42474384264223, 18.75116783779772, 29.957447973163973, -6.958065483654353, 1.299901796503613, 1.745454490216753, 35.08136751713708, 33.011150980638405, 31.006226045368535, 13.392566859163132, 18.593354684357784, 10.08175476517289, 16.13736405987008, 32.95149823120989, 10.210828463879292, 1.8272048810927783, 25.571576973939976, 19.85157167776638, 27.68690923729344, 28.57620986829528, 18.33200859664187, -8.769587036772265, 15.227111367405676, 41.003561654012884, 6.743592368336029, 16.299678361692386, 2.80662127250341, 5.5972001353534955, 1.4590033913236429, 17.80637198688732, 25.960254293003562, 43.32525302819513, 33.53117258003507, 23.764253410534536, 21.12146926058204, 43.773714214369065, 43.18141668240516, 17.575195885502563, 32.779480392628244, 28.43635048832182, 16.090659195120125, 19.440337417205814, 27.570147416448137, 18.142241290173796, 4.835829069421676, 27.718309301727697, 37.89184801229524, 50.98397964403139, 25.15870731725741, 21.578832345600816, 7.730507273824826, 32.308649547303304, 23.88431448694855, 23.932293295139658, 15.825962471697217, 28.223844179871644, 2.2690772330064597, 10.407586871362422, 31.890213499509976, 1.9422341435855208, 5.178813233274527, 12.356863261635109, 33.63471201298566, 31.816514239422386, 48.16165503367083, 11.44687521009989, 29.72379661572186, 5.915958473494578, -3.0633653530989076, 17.795596408420334, 7.959600658299179, 34.967273088879324, 45.84931814213478, 22.375848339208076, 31.29451609599435, 21.117344322070622, 12.336368930332053, 34.293179450902876, 1.3802015816235533, 18.89610810529563, 21.996688669631254, 32.58767316586998, 31.921916887171637, 37.682882143543125, 31.24671703411121, 16.791402520240673, 13.057991390866567, 24.59994398336637, 30.714469084038967, -6.279202894742996, 14.955596376587405, 46.45906459693458, 20.168651794221354, -1.4680360134757322, 13.10103721681733, 10.207068267059121, 13.38436648943982, 14.883317708791619, 31.701397687002963, 2.210943167664053, 23.386837994678302, 28.509710950371133, 21.995635884345134, 12.538568693124018, 11.931785585930424, 23.36416102634531, 20.005627150346374, 5.414714267284182, 27.112263766343595, 2.360621059076804, 33.01360936954794, 15.304286507762098, 13.38594476316699, 29.29252470789678, 33.92894190469392, 25.529638981965682, 40.86028183164832, 12.303884905952374, 13.706126837242127, 23.85862236094809, 30.974010287316446, 18.62378040491091, 23.399697392154714, 31.21220385487556, 13.866660520147363, 36.1830703523329, 1.8439776332180262, 19.623312429938316, 24.644962719093066, 15.723182173719401, 12.609440063895983, 21.284288367445626, 28.698424175679442, 4.52777423342331, 23.5988670774741, 14.636624140400617, 9.29455885165541, 5.9697267054910546, 37.008026668497216, 31.26163427516954, 27.751598262898312, 26.925552172949445, 28.92877322145604, 15.2592257974475, 7.352015648009906, 12.461427707992765, 9.540489774355201, 6.5231252425747535, 13.073054486588944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6538845911137825, "mean_inference_ms": 1.696599067804168, "mean_action_processing_ms": 0.27299177283775045, "mean_env_wait_ms": 0.15386346735549772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004059314727783203, "StateBufferConnector_ms": 0.003847837448120117, "ViewRequirementAgentConnector_ms": 0.12283718585968018}, "num_episodes": 18, "episode_return_max": 43.477565448387146, "episode_return_min": -2.8290818435753726, "episode_return_mean": 19.919514373650856, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.5750822372242, "num_env_steps_trained_throughput_per_sec": 349.5750822372242, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11325.448, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11325.274, "sample_time_ms": 1280.913, "learn_time_ms": 10024.471, "learn_throughput": 399.024, "synch_weights_time_ms": 18.609}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 12, "trial_id": "06536_00000", "date": "2024-08-11_16-36-32", "timestamp": 1723408592, "time_this_iter_s": 11.476685047149658, "time_total_s": 137.9082489013672, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331618a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 137.9082489013672, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 47.4375, "ram_util_percent": 82.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3039011059949797, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7542221465458474, "policy_loss": -0.006793578887785164, "vf_loss": 2.760584379484256, "vf_explained_var": 0.6101927218337854, "kl": 0.004313527310196493, "entropy": 1.4605162523686885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4472417846558585, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6054805009453386, "policy_loss": -0.005248038344844072, "vf_loss": 1.6104122930733615, "vf_explained_var": 0.8231928991892982, "kl": 0.006324857004805713, "entropy": 1.2258319460525715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 43.477565448387146, "episode_reward_min": -2.8290818435753726, "episode_reward_mean": 19.73679789877225, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.477565448387104, "predator_policy": -10.648536683993827}, "policy_reward_max": {"prey_policy": 2.8290818435753726, "predator_policy": 51.49409681802535}, "policy_reward_mean": {"prey_policy": -19.736797898772252, "predator_policy": 19.736797898772252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.876400460285124, 32.46921819717015, 17.57830725626918, 6.917656894713047, 30.03757021559167, 15.97542548370927, 6.4738738680046835, 14.65103752264313, 24.35430790548083, -2.8290818435753726, 18.413411003676913, 32.00868851300346, 15.992960771760425, 13.109559412521456, 21.581163347544575, 13.699390927516383, 23.7692404575299, 23.45410923246857, 3.228762165316714, 23.873577011174472, 9.553149817097912, 3.528101763338566, 21.883313139945454, 38.42821280411508, 22.44286133555829, 43.477565448387146, 25.177338139065395, 22.263504841720955, 23.505242416827024, 11.489035179797732, 32.805078657011514, 38.07134348064435, 14.654669809712841, 28.09648201712589, 19.879127883418427, 15.246460706439029, 21.148900185436222, 3.560523688430021, 22.995787637310336, 39.98908463654665, 20.585335912910896, 1.4262965601978337, 12.877598533359736, 40.40829561550709, 26.835182217601204, 16.726856626201325, 17.836690516263204, 20.44639838746342, 32.254795026520846, 34.46479958882722, 14.924696955553642, 27.657206533702677, 4.338196740922215, 33.31385819557796, 5.816500601670809, 11.795717378249488, 23.292357697897287, 12.79889058117118, 25.252673417358096, 12.23517713952723, 21.68489408834584, 16.263489016813892, 17.687115214312374, 14.345115635464554, 31.61073330629532, 33.19496040680699, 13.00500587159723, 27.41631632413227, 21.011738898532805, 22.53943218751145, 19.013523992775482, 22.134137574515734, 14.166311118807705, 24.99135627156253, 14.063320655448681, 11.965591496028026, 21.48887668699414, 29.50661626903391, 27.927162697202753, 11.305620722728708, 11.000958741174, 9.798089864581856, 10.481742183882176, 18.5727842279989, 12.509348698607681, 39.436790240870515, 17.739983886138493, 19.393897528447102, 23.101222341258598, 28.501408931708216, 40.23032578186778, 10.511600057272442, 29.24130018344101, 22.777047913676995, 28.344859530339576, 12.359792116896305, 1.5752489455289043, 17.910382562874588, 4.885693280707141, 13.619908728395924], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.8764004602851236, -32.469218197170164, -17.578307256269184, -6.917656894713044, -30.037570215591767, -15.97542548370924, -6.473873868004682, -14.651037522643168, -24.35430790548085, 2.8290818435753726, -18.413411003676906, -32.008688513003456, -15.99296077176046, -13.10955941252146, -21.5811633475446, -13.699390927516365, -23.769240457529897, -23.454109232468593, -3.228762165316713, -23.873577011174454, -9.553149817097895, -3.5281017633385665, -21.883313139945436, -38.42821280411511, -22.442861335558305, -43.477565448387104, -25.17733813906539, -22.263504841720973, -23.505242416826967, -11.489035179797751, -32.80507865701145, -38.07134348064445, -14.654669809712825, -28.096482017125936, -19.879127883418445, -15.246460706439043, -21.148900185436204, -3.560523688430028, -22.995787637310393, -39.98908463654659, -20.58533591291087, -1.4262965601978355, -12.877598533359762, -40.40829561550704, -26.835182217601222, -16.726856626201343, -17.83669051626323, -20.44639838746343, -32.25479502652075, -34.46479958882717, -14.924696955553628, -27.65720653370267, -4.338196740922209, -33.313858195578, -5.816500601670785, -11.795717378249469, -23.292357697897287, -12.79889058117119, -25.252673417358125, -12.235177139527218, -21.684894088345843, -16.263489016813875, -17.68711521431239, -14.345115635464534, -31.61073330629536, -33.19496040680702, -13.005005871597254, -27.416316324132282, -21.01173889853281, -22.539432187511462, -19.013523992775472, -22.134137574515677, -14.166311118807686, -24.991356271562516, -14.063320655448708, -11.965591496028017, -21.488876686994136, -29.506616269033906, -27.927162697202714, -11.30562072272869, -11.000958741173967, -9.798089864581847, -10.481742183882192, -18.572784227998937, -12.509348698607672, -39.436790240870536, -17.739983886138518, -19.39389752844707, -23.10122234125862, -28.501408931708195, -40.23032578186785, -10.511600057272483, -29.24130018344096, -22.777047913676984, -28.344859530339527, -12.359792116896317, -1.5752489455288976, -17.91038256287458, -4.885693280707131, -13.61990872839589], "policy_predator_policy_reward": [1.9266519965711666, -5.6794529171414165, 29.32114541814755, 35.61729097619279, 10.670016140929377, 24.486598371608963, 12.067714106390047, 1.7675996830360579, 29.7486685665847, 30.326471864598744, 4.22927847450457, 27.721572492913918, -1.6202524623771541, 14.568000198386516, 17.877331202644072, 11.42474384264223, 18.75116783779772, 29.957447973163973, -6.958065483654353, 1.299901796503613, 1.745454490216753, 35.08136751713708, 33.011150980638405, 31.006226045368535, 13.392566859163132, 18.593354684357784, 10.08175476517289, 16.13736405987008, 32.95149823120989, 10.210828463879292, 1.8272048810927783, 25.571576973939976, 19.85157167776638, 27.68690923729344, 28.57620986829528, 18.33200859664187, -8.769587036772265, 15.227111367405676, 41.003561654012884, 6.743592368336029, 16.299678361692386, 2.80662127250341, 5.5972001353534955, 1.4590033913236429, 17.80637198688732, 25.960254293003562, 43.32525302819513, 33.53117258003507, 23.764253410534536, 21.12146926058204, 43.773714214369065, 43.18141668240516, 17.575195885502563, 32.779480392628244, 28.43635048832182, 16.090659195120125, 19.440337417205814, 27.570147416448137, 18.142241290173796, 4.835829069421676, 27.718309301727697, 37.89184801229524, 50.98397964403139, 25.15870731725741, 21.578832345600816, 7.730507273824826, 32.308649547303304, 23.88431448694855, 23.932293295139658, 15.825962471697217, 28.223844179871644, 2.2690772330064597, 10.407586871362422, 31.890213499509976, 1.9422341435855208, 5.178813233274527, 12.356863261635109, 33.63471201298566, 31.816514239422386, 48.16165503367083, 11.44687521009989, 29.72379661572186, 5.915958473494578, -3.0633653530989076, 17.795596408420334, 7.959600658299179, 34.967273088879324, 45.84931814213478, 22.375848339208076, 31.29451609599435, 21.117344322070622, 12.336368930332053, 34.293179450902876, 1.3802015816235533, 18.89610810529563, 21.996688669631254, 32.58767316586998, 31.921916887171637, 37.682882143543125, 31.24671703411121, 16.791402520240673, 13.057991390866567, 24.59994398336637, 30.714469084038967, -6.279202894742996, 14.955596376587405, 46.45906459693458, 20.168651794221354, -1.4680360134757322, 13.10103721681733, 10.207068267059121, 13.38436648943982, 14.883317708791619, 31.701397687002963, 2.210943167664053, 23.386837994678302, 28.509710950371133, 21.995635884345134, 12.538568693124018, 11.931785585930424, 23.36416102634531, 20.005627150346374, 5.414714267284182, 27.112263766343595, 2.360621059076804, 33.01360936954794, 15.304286507762098, 13.38594476316699, 29.29252470789678, 33.92894190469392, 25.529638981965682, 40.86028183164832, 12.303884905952374, 13.706126837242127, 23.85862236094809, 30.974010287316446, 18.62378040491091, 23.399697392154714, 31.21220385487556, 13.866660520147363, 36.1830703523329, 1.8439776332180262, 19.623312429938316, 24.644962719093066, 15.723182173719401, 12.609440063895983, 21.284288367445626, 28.698424175679442, 4.52777423342331, 23.5988670774741, 14.636624140400617, 9.29455885165541, 5.9697267054910546, 37.008026668497216, 31.26163427516954, 27.751598262898312, 26.925552172949445, 28.92877322145604, 15.2592257974475, 7.352015648009906, 12.461427707992765, 9.540489774355201, 6.5231252425747535, 13.073054486588944, -10.648536683993827, 31.61202105175824, 34.06474800512116, 3.0808204508766686, 11.51370409996937, 13.504993297245974, 51.42350492510109, 27.45007555663998, 7.8594685118814205, 27.62049926039558, 26.58947536191383, 12.19831969498032, 23.478506928526762, 22.723937753990477, 15.416529567726668, 41.58628829568971, 33.33966047232752, 47.1209910914081, 15.049136634580883, 5.974063479964104, 36.32308926028761, 22.159511106594348, 15.500375201515574, 30.05372062583838, 51.49409681802535, 5.195622242653713, 11.7319926902642, 12.987591543528438, 6.155821477997228, -3.0053235869394324, 22.100806241962214, 13.719958883786958, 8.430333572908749, 1.3410529885055253, 1.6261242118792523, 25.613693244912582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6487280474179734, "mean_inference_ms": 1.68955655280747, "mean_action_processing_ms": 0.27113029112576137, "mean_env_wait_ms": 0.15314803255843323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003762960433959961, "StateBufferConnector_ms": 0.0030766725540161133, "ViewRequirementAgentConnector_ms": 0.08291351795196533}, "num_episodes": 18, "episode_return_max": 43.477565448387146, "episode_return_min": -2.8290818435753726, "episode_return_mean": 19.73679789877225, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.5338312384434, "num_env_steps_trained_throughput_per_sec": 373.5338312384434, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 11288.771, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11288.604, "sample_time_ms": 1220.508, "learn_time_ms": 10048.146, "learn_throughput": 398.083, "synch_weights_time_ms": 18.67}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 13, "trial_id": "06536_00000", "date": "2024-08-11_16-36-42", "timestamp": 1723408602, "time_this_iter_s": 10.744948148727417, "time_total_s": 148.6531970500946, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331634430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 148.6531970500946, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 48.14, "ram_util_percent": 82.78666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4422339497754972, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5115671955049037, "policy_loss": -0.01726923876364405, "vf_loss": 3.528259559472402, "vf_explained_var": 0.5210998170077801, "kl": 0.011537451031213019, "entropy": 1.42918813812236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.561538189176529, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9310939396499958, "policy_loss": -0.004035672543954754, "vf_loss": 1.9348144857971756, "vf_explained_var": 0.8109168884930787, "kl": 0.006302549964719735, "entropy": 1.096094841868789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 40.40829561550709, "episode_reward_min": 1.4262965601978337, "episode_reward_mean": 19.923389302997716, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.40829561550704, "predator_policy": -16.08009295886589}, "policy_reward_max": {"prey_policy": -1.4262965601978355, "predator_policy": 51.49409681802535}, "policy_reward_mean": {"prey_policy": -19.923389302997716, "predator_policy": 19.923389302997716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.263504841720955, 23.505242416827024, 11.489035179797732, 32.805078657011514, 38.07134348064435, 14.654669809712841, 28.09648201712589, 19.879127883418427, 15.246460706439029, 21.148900185436222, 3.560523688430021, 22.995787637310336, 39.98908463654665, 20.585335912910896, 1.4262965601978337, 12.877598533359736, 40.40829561550709, 26.835182217601204, 16.726856626201325, 17.836690516263204, 20.44639838746342, 32.254795026520846, 34.46479958882722, 14.924696955553642, 27.657206533702677, 4.338196740922215, 33.31385819557796, 5.816500601670809, 11.795717378249488, 23.292357697897287, 12.79889058117118, 25.252673417358096, 12.23517713952723, 21.68489408834584, 16.263489016813892, 17.687115214312374, 14.345115635464554, 31.61073330629532, 33.19496040680699, 13.00500587159723, 27.41631632413227, 21.011738898532805, 22.53943218751145, 19.013523992775482, 22.134137574515734, 14.166311118807705, 24.99135627156253, 14.063320655448681, 11.965591496028026, 21.48887668699414, 29.50661626903391, 27.927162697202753, 11.305620722728708, 11.000958741174, 9.798089864581856, 10.481742183882176, 18.5727842279989, 12.509348698607681, 39.436790240870515, 17.739983886138493, 19.393897528447102, 23.101222341258598, 28.501408931708216, 40.23032578186778, 10.511600057272442, 29.24130018344101, 22.777047913676995, 28.344859530339576, 12.359792116896305, 1.5752489455289043, 17.910382562874588, 4.885693280707141, 13.619908728395924, 10.865870728392178, 5.037223694132881, 19.093768388733416, 14.103526032095099, 13.01181302939284, 20.101892640266694, 8.763029469340905, 26.649676140066035, 18.390301615693335, 25.458354713207427, 12.129570101744248, 13.38563344199218, 18.969675994336082, 22.65696999717905, 32.48984596730385, 19.074646379560583, 29.081000853318944, 20.90214130639653, 7.057430283764408, 24.09788762422328, 14.597902651585416, 15.03480664120853, 23.258836130907632, 23.599537509885543, 26.06058498718305, 22.834512985959257, 29.326021444419176], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.263504841720973, -23.505242416826967, -11.489035179797751, -32.80507865701145, -38.07134348064445, -14.654669809712825, -28.096482017125936, -19.879127883418445, -15.246460706439043, -21.148900185436204, -3.560523688430028, -22.995787637310393, -39.98908463654659, -20.58533591291087, -1.4262965601978355, -12.877598533359762, -40.40829561550704, -26.835182217601222, -16.726856626201343, -17.83669051626323, -20.44639838746343, -32.25479502652075, -34.46479958882717, -14.924696955553628, -27.65720653370267, -4.338196740922209, -33.313858195578, -5.816500601670785, -11.795717378249469, -23.292357697897287, -12.79889058117119, -25.252673417358125, -12.235177139527218, -21.684894088345843, -16.263489016813875, -17.68711521431239, -14.345115635464534, -31.61073330629536, -33.19496040680702, -13.005005871597254, -27.416316324132282, -21.01173889853281, -22.539432187511462, -19.013523992775472, -22.134137574515677, -14.166311118807686, -24.991356271562516, -14.063320655448708, -11.965591496028017, -21.488876686994136, -29.506616269033906, -27.927162697202714, -11.30562072272869, -11.000958741173967, -9.798089864581847, -10.481742183882192, -18.572784227998937, -12.509348698607672, -39.436790240870536, -17.739983886138518, -19.39389752844707, -23.10122234125862, -28.501408931708195, -40.23032578186785, -10.511600057272483, -29.24130018344096, -22.777047913676984, -28.344859530339527, -12.359792116896317, -1.5752489455288976, -17.91038256287458, -4.885693280707131, -13.61990872839589, -10.865870728392187, -5.037223694132886, -19.093768388733412, -14.103526032095077, -13.011813029392838, -20.10189264026667, -8.763029469340914, -26.649676140066028, -18.390301615693275, -25.45835471320742, -12.129570101744251, -13.385633441992184, -18.96967599433606, -22.656969997179072, -32.489845967303815, -19.074646379560583, -29.081000853318947, -20.902141306396608, -7.057430283764421, -24.097887624223258, -14.597902651585443, -15.034806641208586, -23.2588361309076, -23.599537509885558, -26.060584987183052, -22.834512985959275, -29.32602144441922], "policy_predator_policy_reward": [28.43635048832182, 16.090659195120125, 19.440337417205814, 27.570147416448137, 18.142241290173796, 4.835829069421676, 27.718309301727697, 37.89184801229524, 50.98397964403139, 25.15870731725741, 21.578832345600816, 7.730507273824826, 32.308649547303304, 23.88431448694855, 23.932293295139658, 15.825962471697217, 28.223844179871644, 2.2690772330064597, 10.407586871362422, 31.890213499509976, 1.9422341435855208, 5.178813233274527, 12.356863261635109, 33.63471201298566, 31.816514239422386, 48.16165503367083, 11.44687521009989, 29.72379661572186, 5.915958473494578, -3.0633653530989076, 17.795596408420334, 7.959600658299179, 34.967273088879324, 45.84931814213478, 22.375848339208076, 31.29451609599435, 21.117344322070622, 12.336368930332053, 34.293179450902876, 1.3802015816235533, 18.89610810529563, 21.996688669631254, 32.58767316586998, 31.921916887171637, 37.682882143543125, 31.24671703411121, 16.791402520240673, 13.057991390866567, 24.59994398336637, 30.714469084038967, -6.279202894742996, 14.955596376587405, 46.45906459693458, 20.168651794221354, -1.4680360134757322, 13.10103721681733, 10.207068267059121, 13.38436648943982, 14.883317708791619, 31.701397687002963, 2.210943167664053, 23.386837994678302, 28.509710950371133, 21.995635884345134, 12.538568693124018, 11.931785585930424, 23.36416102634531, 20.005627150346374, 5.414714267284182, 27.112263766343595, 2.360621059076804, 33.01360936954794, 15.304286507762098, 13.38594476316699, 29.29252470789678, 33.92894190469392, 25.529638981965682, 40.86028183164832, 12.303884905952374, 13.706126837242127, 23.85862236094809, 30.974010287316446, 18.62378040491091, 23.399697392154714, 31.21220385487556, 13.866660520147363, 36.1830703523329, 1.8439776332180262, 19.623312429938316, 24.644962719093066, 15.723182173719401, 12.609440063895983, 21.284288367445626, 28.698424175679442, 4.52777423342331, 23.5988670774741, 14.636624140400617, 9.29455885165541, 5.9697267054910546, 37.008026668497216, 31.26163427516954, 27.751598262898312, 26.925552172949445, 28.92877322145604, 15.2592257974475, 7.352015648009906, 12.461427707992765, 9.540489774355201, 6.5231252425747535, 13.073054486588944, -10.648536683993827, 31.61202105175824, 34.06474800512116, 3.0808204508766686, 11.51370409996937, 13.504993297245974, 51.42350492510109, 27.45007555663998, 7.8594685118814205, 27.62049926039558, 26.58947536191383, 12.19831969498032, 23.478506928526762, 22.723937753990477, 15.416529567726668, 41.58628829568971, 33.33966047232752, 47.1209910914081, 15.049136634580883, 5.974063479964104, 36.32308926028761, 22.159511106594348, 15.500375201515574, 30.05372062583838, 51.49409681802535, 5.195622242653713, 11.7319926902642, 12.987591543528438, 6.155821477997228, -3.0053235869394324, 22.100806241962214, 13.719958883786958, 8.430333572908749, 1.3410529885055253, 1.6261242118792523, 25.613693244912582, 16.617886317169027, 5.1138551396153655, -16.08009295886589, 26.15454034713167, 33.42575167069505, 4.761785106771772, 10.522519404554526, 17.684532659635675, 15.85511424634575, 10.168511812439933, 12.335070157469156, 27.868715123064195, -1.5957019044264662, 19.121760843108277, 41.318669479398835, 11.980682800733184, 23.131773234071353, 13.648829997315271, 25.409392709691808, 25.507316716723025, 4.163737366767141, 20.095402836721355, 17.78701849573898, 8.984248388245387, 34.35523518741701, 3.5841168012551314, 9.760310241381367, 35.55362975297674, 27.545996074374507, 37.433695860233165, 19.307043614282545, 18.842249144838632, 25.28958602804584, 32.87241567859209, 3.330193748577293, 38.47408886421588, 11.694864198088371, 2.4199963694404634, 36.00043357891341, 12.195341669533107, 18.00576503586799, 11.190040267302908, 11.467007858342367, 18.602605424074756, 11.590078416817851, 34.927593844997375, 25.838236664308003, 21.360838355463116, 29.09824614395434, 23.02292383041178, 34.252805490007574, 11.416220481911026, 32.297539402753884, 26.35450348608447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.642898571208537, "mean_inference_ms": 1.6768023411005526, "mean_action_processing_ms": 0.2685643501452993, "mean_env_wait_ms": 0.15040369591428637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004318594932556152, "StateBufferConnector_ms": 0.0033015012741088867, "ViewRequirementAgentConnector_ms": 0.08989346027374268}, "num_episodes": 27, "episode_return_max": 40.40829561550709, "episode_return_min": 1.4262965601978337, "episode_return_mean": 19.923389302997716, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.04021643820107, "num_env_steps_trained_throughput_per_sec": 353.04021643820107, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 11336.422, "restore_workers_time_ms": 0.021, "training_step_time_ms": 11336.256, "sample_time_ms": 1263.605, "learn_time_ms": 10052.711, "learn_throughput": 397.903, "synch_weights_time_ms": 18.649}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 14, "trial_id": "06536_00000", "date": "2024-08-11_16-36-54", "timestamp": 1723408614, "time_this_iter_s": 11.361752033233643, "time_total_s": 160.01494908332825, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331634ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160.01494908332825, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 47.043749999999996, "ram_util_percent": 82.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.554974187662204, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8175139193733534, "policy_loss": -0.01009313846201015, "vf_loss": 2.827102131396532, "vf_explained_var": 0.6834225048621495, "kl": 0.01009856025808991, "entropy": 1.434649983048439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4673597029592624, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5448872145521577, "policy_loss": -0.004084243092725359, "vf_loss": 1.548661352780761, "vf_explained_var": 0.8816426561307655, "kl": 0.006202074435696852, "entropy": 1.0813083481220973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 40.23032578186778, "episode_reward_min": 1.5752489455289043, "episode_reward_mean": 19.93793618009685, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.23032578186785, "predator_policy": -16.08009295886589}, "policy_reward_max": {"prey_policy": -1.5752489455288976, "predator_policy": 51.49409681802535}, "policy_reward_mean": {"prey_policy": -19.937936180096848, "predator_policy": 19.937936180096848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.726856626201325, 17.836690516263204, 20.44639838746342, 32.254795026520846, 34.46479958882722, 14.924696955553642, 27.657206533702677, 4.338196740922215, 33.31385819557796, 5.816500601670809, 11.795717378249488, 23.292357697897287, 12.79889058117118, 25.252673417358096, 12.23517713952723, 21.68489408834584, 16.263489016813892, 17.687115214312374, 14.345115635464554, 31.61073330629532, 33.19496040680699, 13.00500587159723, 27.41631632413227, 21.011738898532805, 22.53943218751145, 19.013523992775482, 22.134137574515734, 14.166311118807705, 24.99135627156253, 14.063320655448681, 11.965591496028026, 21.48887668699414, 29.50661626903391, 27.927162697202753, 11.305620722728708, 11.000958741174, 9.798089864581856, 10.481742183882176, 18.5727842279989, 12.509348698607681, 39.436790240870515, 17.739983886138493, 19.393897528447102, 23.101222341258598, 28.501408931708216, 40.23032578186778, 10.511600057272442, 29.24130018344101, 22.777047913676995, 28.344859530339576, 12.359792116896305, 1.5752489455289043, 17.910382562874588, 4.885693280707141, 13.619908728395924, 10.865870728392178, 5.037223694132881, 19.093768388733416, 14.103526032095099, 13.01181302939284, 20.101892640266694, 8.763029469340905, 26.649676140066035, 18.390301615693335, 25.458354713207427, 12.129570101744248, 13.38563344199218, 18.969675994336082, 22.65696999717905, 32.48984596730385, 19.074646379560583, 29.081000853318944, 20.90214130639653, 7.057430283764408, 24.09788762422328, 14.597902651585416, 15.03480664120853, 23.258836130907632, 23.599537509885543, 26.06058498718305, 22.834512985959257, 29.326021444419176, 29.5844937349706, 23.3996397226612, 17.283255157659585, 14.652048289873932, 14.50415265380339, 9.874383159316817, 16.75374844943831, 22.300403460215463, 22.954113226374677, 17.112031804992164, 15.294631298904001, 20.989604359898404, 29.495502039557472, 34.73577429233257, 35.89143021184809, 36.49776250881195, 19.100584405272585, 16.869078913980115], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.726856626201343, -17.83669051626323, -20.44639838746343, -32.25479502652075, -34.46479958882717, -14.924696955553628, -27.65720653370267, -4.338196740922209, -33.313858195578, -5.816500601670785, -11.795717378249469, -23.292357697897287, -12.79889058117119, -25.252673417358125, -12.235177139527218, -21.684894088345843, -16.263489016813875, -17.68711521431239, -14.345115635464534, -31.61073330629536, -33.19496040680702, -13.005005871597254, -27.416316324132282, -21.01173889853281, -22.539432187511462, -19.013523992775472, -22.134137574515677, -14.166311118807686, -24.991356271562516, -14.063320655448708, -11.965591496028017, -21.488876686994136, -29.506616269033906, -27.927162697202714, -11.30562072272869, -11.000958741173967, -9.798089864581847, -10.481742183882192, -18.572784227998937, -12.509348698607672, -39.436790240870536, -17.739983886138518, -19.39389752844707, -23.10122234125862, -28.501408931708195, -40.23032578186785, -10.511600057272483, -29.24130018344096, -22.777047913676984, -28.344859530339527, -12.359792116896317, -1.5752489455288976, -17.91038256287458, -4.885693280707131, -13.61990872839589, -10.865870728392187, -5.037223694132886, -19.093768388733412, -14.103526032095077, -13.011813029392838, -20.10189264026667, -8.763029469340914, -26.649676140066028, -18.390301615693275, -25.45835471320742, -12.129570101744251, -13.385633441992184, -18.96967599433606, -22.656969997179072, -32.489845967303815, -19.074646379560583, -29.081000853318947, -20.902141306396608, -7.057430283764421, -24.097887624223258, -14.597902651585443, -15.034806641208586, -23.2588361309076, -23.599537509885558, -26.060584987183052, -22.834512985959275, -29.32602144441922, -29.584493734970554, -23.39963972266119, -17.283255157659596, -14.652048289873898, -14.504152653803377, -9.874383159316807, -16.75374844943834, -22.300403460215467, -22.954113226374712, -17.112031804992164, -15.294631298903994, -20.989604359898376, -29.495502039557447, -34.735774292332565, -35.89143021184815, -36.49776250881193, -19.10058440527254, -16.8690789139801], "policy_predator_policy_reward": [21.117344322070622, 12.336368930332053, 34.293179450902876, 1.3802015816235533, 18.89610810529563, 21.996688669631254, 32.58767316586998, 31.921916887171637, 37.682882143543125, 31.24671703411121, 16.791402520240673, 13.057991390866567, 24.59994398336637, 30.714469084038967, -6.279202894742996, 14.955596376587405, 46.45906459693458, 20.168651794221354, -1.4680360134757322, 13.10103721681733, 10.207068267059121, 13.38436648943982, 14.883317708791619, 31.701397687002963, 2.210943167664053, 23.386837994678302, 28.509710950371133, 21.995635884345134, 12.538568693124018, 11.931785585930424, 23.36416102634531, 20.005627150346374, 5.414714267284182, 27.112263766343595, 2.360621059076804, 33.01360936954794, 15.304286507762098, 13.38594476316699, 29.29252470789678, 33.92894190469392, 25.529638981965682, 40.86028183164832, 12.303884905952374, 13.706126837242127, 23.85862236094809, 30.974010287316446, 18.62378040491091, 23.399697392154714, 31.21220385487556, 13.866660520147363, 36.1830703523329, 1.8439776332180262, 19.623312429938316, 24.644962719093066, 15.723182173719401, 12.609440063895983, 21.284288367445626, 28.698424175679442, 4.52777423342331, 23.5988670774741, 14.636624140400617, 9.29455885165541, 5.9697267054910546, 37.008026668497216, 31.26163427516954, 27.751598262898312, 26.925552172949445, 28.92877322145604, 15.2592257974475, 7.352015648009906, 12.461427707992765, 9.540489774355201, 6.5231252425747535, 13.073054486588944, -10.648536683993827, 31.61202105175824, 34.06474800512116, 3.0808204508766686, 11.51370409996937, 13.504993297245974, 51.42350492510109, 27.45007555663998, 7.8594685118814205, 27.62049926039558, 26.58947536191383, 12.19831969498032, 23.478506928526762, 22.723937753990477, 15.416529567726668, 41.58628829568971, 33.33966047232752, 47.1209910914081, 15.049136634580883, 5.974063479964104, 36.32308926028761, 22.159511106594348, 15.500375201515574, 30.05372062583838, 51.49409681802535, 5.195622242653713, 11.7319926902642, 12.987591543528438, 6.155821477997228, -3.0053235869394324, 22.100806241962214, 13.719958883786958, 8.430333572908749, 1.3410529885055253, 1.6261242118792523, 25.613693244912582, 16.617886317169027, 5.1138551396153655, -16.08009295886589, 26.15454034713167, 33.42575167069505, 4.761785106771772, 10.522519404554526, 17.684532659635675, 15.85511424634575, 10.168511812439933, 12.335070157469156, 27.868715123064195, -1.5957019044264662, 19.121760843108277, 41.318669479398835, 11.980682800733184, 23.131773234071353, 13.648829997315271, 25.409392709691808, 25.507316716723025, 4.163737366767141, 20.095402836721355, 17.78701849573898, 8.984248388245387, 34.35523518741701, 3.5841168012551314, 9.760310241381367, 35.55362975297674, 27.545996074374507, 37.433695860233165, 19.307043614282545, 18.842249144838632, 25.28958602804584, 32.87241567859209, 3.330193748577293, 38.47408886421588, 11.694864198088371, 2.4199963694404634, 36.00043357891341, 12.195341669533107, 18.00576503586799, 11.190040267302908, 11.467007858342367, 18.602605424074756, 11.590078416817851, 34.927593844997375, 25.838236664308003, 21.360838355463116, 29.09824614395434, 23.02292383041178, 34.252805490007574, 11.416220481911026, 32.297539402753884, 26.35450348608447, 34.727084500643784, 24.44190296929734, 36.187193085152316, 10.612086360170057, 22.21284868482008, 12.35366163049909, 14.50904720980608, 14.795049369941742, 10.292624870741292, 18.715680436865455, 10.900931629135846, 8.847834689497782, 13.144237840857258, 20.363259058019395, 15.665024457924527, 28.935782462506417, 34.78716580614272, 11.12106064660667, 27.47294046279966, 6.751123147184671, 28.368446307655958, 2.220816290152017, 26.124501370540628, 15.854707349256122, 13.192851164189268, 45.798152914925595, 37.06837677455147, 32.403171810113626, 44.03506370101703, 27.747796722679222, 35.188418894021304, 37.80710612360255, 36.658506061270025, 1.5426627492750962, 31.217430004373675, 2.5207278235865545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6423267961780713, "mean_inference_ms": 1.6787180848342735, "mean_action_processing_ms": 0.26704362958224004, "mean_env_wait_ms": 0.14975920564614803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004084229469299316, "StateBufferConnector_ms": 0.0031946897506713867, "ViewRequirementAgentConnector_ms": 0.09490013122558594}, "num_episodes": 18, "episode_return_max": 40.23032578186778, "episode_return_min": 1.5752489455289043, "episode_return_mean": 19.93793618009685, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.89606358919855, "num_env_steps_trained_throughput_per_sec": 347.89606358919855, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 11330.25, "restore_workers_time_ms": 0.021, "training_step_time_ms": 11330.084, "sample_time_ms": 1248.777, "learn_time_ms": 10061.3, "learn_throughput": 397.563, "synch_weights_time_ms": 18.713}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 15, "trial_id": "06536_00000", "date": "2024-08-11_16-37-05", "timestamp": 1723408625, "time_this_iter_s": 11.571982860565186, "time_total_s": 171.58693194389343, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331618ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 171.58693194389343, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 53.358823529411765, "ram_util_percent": 83.17647058823528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.334077146835625, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0381203081458805, "policy_loss": -0.016468199381779413, "vf_loss": 2.054061432989935, "vf_explained_var": 0.6254101720328132, "kl": 0.010541446886773937, "entropy": 1.4772853718449672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.170053245639675, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0381675422980041, "policy_loss": -0.0033931080304904194, "vf_loss": 1.0413235448497944, "vf_explained_var": 0.8001207664214744, "kl": 0.004742102520376831, "entropy": 1.0800926102216912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 40.23032578186778, "episode_reward_min": 1.5752489455289043, "episode_reward_mean": 20.2897434282672, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.23032578186785, "predator_policy": -16.08009295886589}, "policy_reward_max": {"prey_policy": -1.5752489455288976, "predator_policy": 51.49409681802535}, "policy_reward_mean": {"prey_policy": -20.2897434282672, "predator_policy": 20.2897434282672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.345115635464554, 31.61073330629532, 33.19496040680699, 13.00500587159723, 27.41631632413227, 21.011738898532805, 22.53943218751145, 19.013523992775482, 22.134137574515734, 14.166311118807705, 24.99135627156253, 14.063320655448681, 11.965591496028026, 21.48887668699414, 29.50661626903391, 27.927162697202753, 11.305620722728708, 11.000958741174, 9.798089864581856, 10.481742183882176, 18.5727842279989, 12.509348698607681, 39.436790240870515, 17.739983886138493, 19.393897528447102, 23.101222341258598, 28.501408931708216, 40.23032578186778, 10.511600057272442, 29.24130018344101, 22.777047913676995, 28.344859530339576, 12.359792116896305, 1.5752489455289043, 17.910382562874588, 4.885693280707141, 13.619908728395924, 10.865870728392178, 5.037223694132881, 19.093768388733416, 14.103526032095099, 13.01181302939284, 20.101892640266694, 8.763029469340905, 26.649676140066035, 18.390301615693335, 25.458354713207427, 12.129570101744248, 13.38563344199218, 18.969675994336082, 22.65696999717905, 32.48984596730385, 19.074646379560583, 29.081000853318944, 20.90214130639653, 7.057430283764408, 24.09788762422328, 14.597902651585416, 15.03480664120853, 23.258836130907632, 23.599537509885543, 26.06058498718305, 22.834512985959257, 29.326021444419176, 29.5844937349706, 23.3996397226612, 17.283255157659585, 14.652048289873932, 14.50415265380339, 9.874383159316817, 16.75374844943831, 22.300403460215463, 22.954113226374677, 17.112031804992164, 15.294631298904001, 20.989604359898404, 29.495502039557472, 34.73577429233257, 35.89143021184809, 36.49776250881195, 19.100584405272585, 16.869078913980115, 38.74787559033421, 21.77861902291267, 20.207934753118412, 24.698482295622007, 15.538553101092928, 12.739457672213614, 15.728535458036472, 4.975265991202989, 36.83965184438449, 28.432337304582855, 18.475651985844486, 19.902126152606204, 35.05857439634206, 27.30774904484252, 31.838312030955922, 6.272506665733056, 9.186404621515475, 16.243000592073493], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.345115635464534, -31.61073330629536, -33.19496040680702, -13.005005871597254, -27.416316324132282, -21.01173889853281, -22.539432187511462, -19.013523992775472, -22.134137574515677, -14.166311118807686, -24.991356271562516, -14.063320655448708, -11.965591496028017, -21.488876686994136, -29.506616269033906, -27.927162697202714, -11.30562072272869, -11.000958741173967, -9.798089864581847, -10.481742183882192, -18.572784227998937, -12.509348698607672, -39.436790240870536, -17.739983886138518, -19.39389752844707, -23.10122234125862, -28.501408931708195, -40.23032578186785, -10.511600057272483, -29.24130018344096, -22.777047913676984, -28.344859530339527, -12.359792116896317, -1.5752489455288976, -17.91038256287458, -4.885693280707131, -13.61990872839589, -10.865870728392187, -5.037223694132886, -19.093768388733412, -14.103526032095077, -13.011813029392838, -20.10189264026667, -8.763029469340914, -26.649676140066028, -18.390301615693275, -25.45835471320742, -12.129570101744251, -13.385633441992184, -18.96967599433606, -22.656969997179072, -32.489845967303815, -19.074646379560583, -29.081000853318947, -20.902141306396608, -7.057430283764421, -24.097887624223258, -14.597902651585443, -15.034806641208586, -23.2588361309076, -23.599537509885558, -26.060584987183052, -22.834512985959275, -29.32602144441922, -29.584493734970554, -23.39963972266119, -17.283255157659596, -14.652048289873898, -14.504152653803377, -9.874383159316807, -16.75374844943834, -22.300403460215467, -22.954113226374712, -17.112031804992164, -15.294631298903994, -20.989604359898376, -29.495502039557447, -34.735774292332565, -35.89143021184815, -36.49776250881193, -19.10058440527254, -16.8690789139801, -38.747875590334125, -21.77861902291262, -20.207934753118423, -24.698482295622064, -15.538553101092937, -12.73945767221362, -15.72853545803646, -4.975265991202984, -36.83965184438445, -28.43233730458289, -18.47565198584452, -19.90212615260623, -35.058574396342074, -27.30774904484248, -31.83831203095592, -6.272506665733057, -9.186404621515456, -16.24300059207348], "policy_predator_policy_reward": [15.304286507762098, 13.38594476316699, 29.29252470789678, 33.92894190469392, 25.529638981965682, 40.86028183164832, 12.303884905952374, 13.706126837242127, 23.85862236094809, 30.974010287316446, 18.62378040491091, 23.399697392154714, 31.21220385487556, 13.866660520147363, 36.1830703523329, 1.8439776332180262, 19.623312429938316, 24.644962719093066, 15.723182173719401, 12.609440063895983, 21.284288367445626, 28.698424175679442, 4.52777423342331, 23.5988670774741, 14.636624140400617, 9.29455885165541, 5.9697267054910546, 37.008026668497216, 31.26163427516954, 27.751598262898312, 26.925552172949445, 28.92877322145604, 15.2592257974475, 7.352015648009906, 12.461427707992765, 9.540489774355201, 6.5231252425747535, 13.073054486588944, -10.648536683993827, 31.61202105175824, 34.06474800512116, 3.0808204508766686, 11.51370409996937, 13.504993297245974, 51.42350492510109, 27.45007555663998, 7.8594685118814205, 27.62049926039558, 26.58947536191383, 12.19831969498032, 23.478506928526762, 22.723937753990477, 15.416529567726668, 41.58628829568971, 33.33966047232752, 47.1209910914081, 15.049136634580883, 5.974063479964104, 36.32308926028761, 22.159511106594348, 15.500375201515574, 30.05372062583838, 51.49409681802535, 5.195622242653713, 11.7319926902642, 12.987591543528438, 6.155821477997228, -3.0053235869394324, 22.100806241962214, 13.719958883786958, 8.430333572908749, 1.3410529885055253, 1.6261242118792523, 25.613693244912582, 16.617886317169027, 5.1138551396153655, -16.08009295886589, 26.15454034713167, 33.42575167069505, 4.761785106771772, 10.522519404554526, 17.684532659635675, 15.85511424634575, 10.168511812439933, 12.335070157469156, 27.868715123064195, -1.5957019044264662, 19.121760843108277, 41.318669479398835, 11.980682800733184, 23.131773234071353, 13.648829997315271, 25.409392709691808, 25.507316716723025, 4.163737366767141, 20.095402836721355, 17.78701849573898, 8.984248388245387, 34.35523518741701, 3.5841168012551314, 9.760310241381367, 35.55362975297674, 27.545996074374507, 37.433695860233165, 19.307043614282545, 18.842249144838632, 25.28958602804584, 32.87241567859209, 3.330193748577293, 38.47408886421588, 11.694864198088371, 2.4199963694404634, 36.00043357891341, 12.195341669533107, 18.00576503586799, 11.190040267302908, 11.467007858342367, 18.602605424074756, 11.590078416817851, 34.927593844997375, 25.838236664308003, 21.360838355463116, 29.09824614395434, 23.02292383041178, 34.252805490007574, 11.416220481911026, 32.297539402753884, 26.35450348608447, 34.727084500643784, 24.44190296929734, 36.187193085152316, 10.612086360170057, 22.21284868482008, 12.35366163049909, 14.50904720980608, 14.795049369941742, 10.292624870741292, 18.715680436865455, 10.900931629135846, 8.847834689497782, 13.144237840857258, 20.363259058019395, 15.665024457924527, 28.935782462506417, 34.78716580614272, 11.12106064660667, 27.47294046279966, 6.751123147184671, 28.368446307655958, 2.220816290152017, 26.124501370540628, 15.854707349256122, 13.192851164189268, 45.798152914925595, 37.06837677455147, 32.403171810113626, 44.03506370101703, 27.747796722679222, 35.188418894021304, 37.80710612360255, 36.658506061270025, 1.5426627492750962, 31.217430004373675, 2.5207278235865545, 45.782932152716306, 31.712819027952037, 21.666777055125905, 21.890460990699363, 9.67304541075266, 30.742824095484167, 13.414962544341273, 35.98200204690285, 20.12972174463569, 10.947384457550156, 15.702266520442105, 9.77664882398512, 23.82969026980169, 7.6273806462712415, 3.561859036275669, 6.388672946130302, 33.46865274567565, 40.210650943093256, 19.572310488984957, 37.29236412018082, 20.258124716811867, 16.693179254877137, 25.849297695514622, 13.954954609697815, 26.24502617647085, 43.87212261621329, 9.294550013761807, 45.320948075923155, 26.245963475723855, 37.43066058618799, 0.18368127907431608, 12.361332052391791, 18.931074606750727, -0.5582653637197956, 21.990451041302606, 10.49555014284435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6408483717033049, "mean_inference_ms": 1.6742583489289686, "mean_action_processing_ms": 0.265480024704586, "mean_env_wait_ms": 0.1487842488417892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006248354911804199, "StateBufferConnector_ms": 0.0033320188522338867, "ViewRequirementAgentConnector_ms": 0.10571956634521484}, "num_episodes": 18, "episode_return_max": 40.23032578186778, "episode_return_min": 1.5752489455289043, "episode_return_mean": 20.2897434282672, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.5337923677802, "num_env_steps_trained_throughput_per_sec": 356.5337923677802, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 11339.646, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11339.574, "sample_time_ms": 1208.09, "learn_time_ms": 10118.014, "learn_throughput": 395.335, "synch_weights_time_ms": 12.685}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 16, "trial_id": "06536_00000", "date": "2024-08-11_16-37-17", "timestamp": 1723408637, "time_this_iter_s": 11.261507034301758, "time_total_s": 182.8484389781952, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331618af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 182.8484389781952, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 50.40625, "ram_util_percent": 83.05624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1080543267230194, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8807484787578383, "policy_loss": -0.01647710244966826, "vf_loss": 1.8969430044293403, "vf_explained_var": 0.6417381262406707, "kl": 0.005651582842101175, "entropy": 1.4123469786097607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3226257309238747, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2032383488284217, "policy_loss": -0.004316050109635821, "vf_loss": 1.2072858231723624, "vf_explained_var": 0.9144925129476679, "kl": 0.010743023112107439, "entropy": 1.0299208497874952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": 56.833847354114205, "episode_reward_min": 1.5752489455289043, "episode_reward_mean": 20.7754991607517, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.833847354114226, "predator_policy": -16.08009295886589}, "policy_reward_max": {"prey_policy": -1.5752489455288976, "predator_policy": 57.067926567737324}, "policy_reward_mean": {"prey_policy": -20.7754991607517, "predator_policy": 20.775499160751696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.798089864581856, 10.481742183882176, 18.5727842279989, 12.509348698607681, 39.436790240870515, 17.739983886138493, 19.393897528447102, 23.101222341258598, 28.501408931708216, 40.23032578186778, 10.511600057272442, 29.24130018344101, 22.777047913676995, 28.344859530339576, 12.359792116896305, 1.5752489455289043, 17.910382562874588, 4.885693280707141, 13.619908728395924, 10.865870728392178, 5.037223694132881, 19.093768388733416, 14.103526032095099, 13.01181302939284, 20.101892640266694, 8.763029469340905, 26.649676140066035, 18.390301615693335, 25.458354713207427, 12.129570101744248, 13.38563344199218, 18.969675994336082, 22.65696999717905, 32.48984596730385, 19.074646379560583, 29.081000853318944, 20.90214130639653, 7.057430283764408, 24.09788762422328, 14.597902651585416, 15.03480664120853, 23.258836130907632, 23.599537509885543, 26.06058498718305, 22.834512985959257, 29.326021444419176, 29.5844937349706, 23.3996397226612, 17.283255157659585, 14.652048289873932, 14.50415265380339, 9.874383159316817, 16.75374844943831, 22.300403460215463, 22.954113226374677, 17.112031804992164, 15.294631298904001, 20.989604359898404, 29.495502039557472, 34.73577429233257, 35.89143021184809, 36.49776250881195, 19.100584405272585, 16.869078913980115, 38.74787559033421, 21.77861902291267, 20.207934753118412, 24.698482295622007, 15.538553101092928, 12.739457672213614, 15.728535458036472, 4.975265991202989, 36.83965184438449, 28.432337304582855, 18.475651985844486, 19.902126152606204, 35.05857439634206, 27.30774904484252, 31.838312030955922, 6.272506665733056, 9.186404621515475, 16.243000592073493, 22.10572171641624, 10.07761622065348, 23.744052737937245, 14.723343937457006, 19.69627560785773, 8.866168828600628, 20.411773106520013, 48.12689616565224, 56.833847354114205, 21.796238029575022, 26.954114565482502, 8.676176936662443, 29.01629183089403, 42.497199229035324, 21.563997811407653, 26.80128703894449, 11.866890683846362, 5.504460304005447], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.798089864581847, -10.481742183882192, -18.572784227998937, -12.509348698607672, -39.436790240870536, -17.739983886138518, -19.39389752844707, -23.10122234125862, -28.501408931708195, -40.23032578186785, -10.511600057272483, -29.24130018344096, -22.777047913676984, -28.344859530339527, -12.359792116896317, -1.5752489455288976, -17.91038256287458, -4.885693280707131, -13.61990872839589, -10.865870728392187, -5.037223694132886, -19.093768388733412, -14.103526032095077, -13.011813029392838, -20.10189264026667, -8.763029469340914, -26.649676140066028, -18.390301615693275, -25.45835471320742, -12.129570101744251, -13.385633441992184, -18.96967599433606, -22.656969997179072, -32.489845967303815, -19.074646379560583, -29.081000853318947, -20.902141306396608, -7.057430283764421, -24.097887624223258, -14.597902651585443, -15.034806641208586, -23.2588361309076, -23.599537509885558, -26.060584987183052, -22.834512985959275, -29.32602144441922, -29.584493734970554, -23.39963972266119, -17.283255157659596, -14.652048289873898, -14.504152653803377, -9.874383159316807, -16.75374844943834, -22.300403460215467, -22.954113226374712, -17.112031804992164, -15.294631298903994, -20.989604359898376, -29.495502039557447, -34.735774292332565, -35.89143021184815, -36.49776250881193, -19.10058440527254, -16.8690789139801, -38.747875590334125, -21.77861902291262, -20.207934753118423, -24.698482295622064, -15.538553101092937, -12.73945767221362, -15.72853545803646, -4.975265991202984, -36.83965184438445, -28.43233730458289, -18.47565198584452, -19.90212615260623, -35.058574396342074, -27.30774904484248, -31.83831203095592, -6.272506665733057, -9.186404621515456, -16.24300059207348, -22.105721716416216, -10.07761622065344, -23.744052737937228, -14.723343937456992, -19.696275607857768, -8.866168828600628, -20.411773106519984, -48.12689616565223, -56.833847354114226, -21.796238029574997, -26.95411456548252, -8.676176936662435, -29.01629183089402, -42.49719922903528, -21.56399781140767, -26.801287038944466, -11.866890683846364, -5.504460304005455], "policy_predator_policy_reward": [6.5231252425747535, 13.073054486588944, -10.648536683993827, 31.61202105175824, 34.06474800512116, 3.0808204508766686, 11.51370409996937, 13.504993297245974, 51.42350492510109, 27.45007555663998, 7.8594685118814205, 27.62049926039558, 26.58947536191383, 12.19831969498032, 23.478506928526762, 22.723937753990477, 15.416529567726668, 41.58628829568971, 33.33966047232752, 47.1209910914081, 15.049136634580883, 5.974063479964104, 36.32308926028761, 22.159511106594348, 15.500375201515574, 30.05372062583838, 51.49409681802535, 5.195622242653713, 11.7319926902642, 12.987591543528438, 6.155821477997228, -3.0053235869394324, 22.100806241962214, 13.719958883786958, 8.430333572908749, 1.3410529885055253, 1.6261242118792523, 25.613693244912582, 16.617886317169027, 5.1138551396153655, -16.08009295886589, 26.15454034713167, 33.42575167069505, 4.761785106771772, 10.522519404554526, 17.684532659635675, 15.85511424634575, 10.168511812439933, 12.335070157469156, 27.868715123064195, -1.5957019044264662, 19.121760843108277, 41.318669479398835, 11.980682800733184, 23.131773234071353, 13.648829997315271, 25.409392709691808, 25.507316716723025, 4.163737366767141, 20.095402836721355, 17.78701849573898, 8.984248388245387, 34.35523518741701, 3.5841168012551314, 9.760310241381367, 35.55362975297674, 27.545996074374507, 37.433695860233165, 19.307043614282545, 18.842249144838632, 25.28958602804584, 32.87241567859209, 3.330193748577293, 38.47408886421588, 11.694864198088371, 2.4199963694404634, 36.00043357891341, 12.195341669533107, 18.00576503586799, 11.190040267302908, 11.467007858342367, 18.602605424074756, 11.590078416817851, 34.927593844997375, 25.838236664308003, 21.360838355463116, 29.09824614395434, 23.02292383041178, 34.252805490007574, 11.416220481911026, 32.297539402753884, 26.35450348608447, 34.727084500643784, 24.44190296929734, 36.187193085152316, 10.612086360170057, 22.21284868482008, 12.35366163049909, 14.50904720980608, 14.795049369941742, 10.292624870741292, 18.715680436865455, 10.900931629135846, 8.847834689497782, 13.144237840857258, 20.363259058019395, 15.665024457924527, 28.935782462506417, 34.78716580614272, 11.12106064660667, 27.47294046279966, 6.751123147184671, 28.368446307655958, 2.220816290152017, 26.124501370540628, 15.854707349256122, 13.192851164189268, 45.798152914925595, 37.06837677455147, 32.403171810113626, 44.03506370101703, 27.747796722679222, 35.188418894021304, 37.80710612360255, 36.658506061270025, 1.5426627492750962, 31.217430004373675, 2.5207278235865545, 45.782932152716306, 31.712819027952037, 21.666777055125905, 21.890460990699363, 9.67304541075266, 30.742824095484167, 13.414962544341273, 35.98200204690285, 20.12972174463569, 10.947384457550156, 15.702266520442105, 9.77664882398512, 23.82969026980169, 7.6273806462712415, 3.561859036275669, 6.388672946130302, 33.46865274567565, 40.210650943093256, 19.572310488984957, 37.29236412018082, 20.258124716811867, 16.693179254877137, 25.849297695514622, 13.954954609697815, 26.24502617647085, 43.87212261621329, 9.294550013761807, 45.320948075923155, 26.245963475723855, 37.43066058618799, 0.18368127907431608, 12.361332052391791, 18.931074606750727, -0.5582653637197956, 21.990451041302606, 10.49555014284435, 12.340211116094338, 31.871232316738084, 6.89207612250703, 13.26315631879986, 27.491034218989995, 19.997071256884432, 8.162119388667849, 21.284568486246148, 25.7561227932621, 13.636428422453443, 10.120121307148224, 7.612216350053025, 9.38271129933779, 31.440834913702187, 45.04891417598999, 51.2048781553145, 56.59976814049114, 57.067926567737324, 17.339073050317573, 26.25340300883243, 37.060423419215255, 16.847805711749764, 4.038306975159111, 13.314046898165753, 17.626459522026657, 40.406124139761395, 37.36394667713346, 47.63045178093719, 11.14575316577772, 31.982242457037604, 30.68656994814449, 22.916004129744458, 7.1015740431437155, 16.632207324549007, -2.4194863287355854, 13.4284069367465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6386283389677065, "mean_inference_ms": 1.6678105011561917, "mean_action_processing_ms": 0.26383891569029205, "mean_env_wait_ms": 0.14792729923901915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006154179573059082, "StateBufferConnector_ms": 0.003583550453186035, "ViewRequirementAgentConnector_ms": 0.10586690902709961}, "num_episodes": 18, "episode_return_max": 56.833847354114205, "episode_return_min": 1.5752489455289043, "episode_return_mean": 20.7754991607517, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.29603622155827, "num_env_steps_trained_throughput_per_sec": 346.29603622155827, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 11328.032, "restore_workers_time_ms": 0.019, "training_step_time_ms": 11327.856, "sample_time_ms": 1258.986, "learn_time_ms": 10050.2, "learn_throughput": 398.002, "synch_weights_time_ms": 14.587}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 17, "trial_id": "06536_00000", "date": "2024-08-11_16-37-28", "timestamp": 1723408648, "time_this_iter_s": 11.590452909469604, "time_total_s": 194.4388918876648, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331615e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 194.4388918876648, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 50.28125, "ram_util_percent": 83.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5833824697261054, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8963603758563599, "policy_loss": -0.014722472534291835, "vf_loss": 1.9105389861389994, "vf_explained_var": 0.821840962767601, "kl": 0.010877250144505956, "entropy": 1.3474220633506775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.713353657722473, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2996325347789381, "policy_loss": -0.002811337215641129, "vf_loss": 1.3022696642333238, "vf_explained_var": 0.9475994236570187, "kl": 0.00696851903200531, "entropy": 0.9676111162654937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 56.833847354114205, "episode_reward_min": 4.975265991202989, "episode_reward_mean": 21.679093387998964, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.833847354114226, "predator_policy": -2.4194863287355854}, "policy_reward_max": {"prey_policy": -4.975265991202984, "predator_policy": 57.067926567737324}, "policy_reward_mean": {"prey_policy": -21.679093387998964, "predator_policy": 21.679093387998964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.103526032095099, 13.01181302939284, 20.101892640266694, 8.763029469340905, 26.649676140066035, 18.390301615693335, 25.458354713207427, 12.129570101744248, 13.38563344199218, 18.969675994336082, 22.65696999717905, 32.48984596730385, 19.074646379560583, 29.081000853318944, 20.90214130639653, 7.057430283764408, 24.09788762422328, 14.597902651585416, 15.03480664120853, 23.258836130907632, 23.599537509885543, 26.06058498718305, 22.834512985959257, 29.326021444419176, 29.5844937349706, 23.3996397226612, 17.283255157659585, 14.652048289873932, 14.50415265380339, 9.874383159316817, 16.75374844943831, 22.300403460215463, 22.954113226374677, 17.112031804992164, 15.294631298904001, 20.989604359898404, 29.495502039557472, 34.73577429233257, 35.89143021184809, 36.49776250881195, 19.100584405272585, 16.869078913980115, 38.74787559033421, 21.77861902291267, 20.207934753118412, 24.698482295622007, 15.538553101092928, 12.739457672213614, 15.728535458036472, 4.975265991202989, 36.83965184438449, 28.432337304582855, 18.475651985844486, 19.902126152606204, 35.05857439634206, 27.30774904484252, 31.838312030955922, 6.272506665733056, 9.186404621515475, 16.243000592073493, 22.10572171641624, 10.07761622065348, 23.744052737937245, 14.723343937457006, 19.69627560785773, 8.866168828600628, 20.411773106520013, 48.12689616565224, 56.833847354114205, 21.796238029575022, 26.954114565482502, 8.676176936662443, 29.01629183089403, 42.497199229035324, 21.563997811407653, 26.80128703894449, 11.866890683846362, 5.504460304005447, 37.66272669602426, 23.68735009168222, 29.591411559185328, 26.319265801234806, 22.57632113916843, 20.714821986831573, 12.946730889525917, 15.139282771718836, 16.44966204169505, 14.485543115492662, 37.673558301635666, 18.595459912311952, 23.420053798497705, 21.140099852357775, 25.1663168579675, 19.585776636693296, 23.01245465359836, 18.775375372186915, 12.230594098301802, 34.76080893654574, 9.9231275946599, 22.4909704331632], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.103526032095077, -13.011813029392838, -20.10189264026667, -8.763029469340914, -26.649676140066028, -18.390301615693275, -25.45835471320742, -12.129570101744251, -13.385633441992184, -18.96967599433606, -22.656969997179072, -32.489845967303815, -19.074646379560583, -29.081000853318947, -20.902141306396608, -7.057430283764421, -24.097887624223258, -14.597902651585443, -15.034806641208586, -23.2588361309076, -23.599537509885558, -26.060584987183052, -22.834512985959275, -29.32602144441922, -29.584493734970554, -23.39963972266119, -17.283255157659596, -14.652048289873898, -14.504152653803377, -9.874383159316807, -16.75374844943834, -22.300403460215467, -22.954113226374712, -17.112031804992164, -15.294631298903994, -20.989604359898376, -29.495502039557447, -34.735774292332565, -35.89143021184815, -36.49776250881193, -19.10058440527254, -16.8690789139801, -38.747875590334125, -21.77861902291262, -20.207934753118423, -24.698482295622064, -15.538553101092937, -12.73945767221362, -15.72853545803646, -4.975265991202984, -36.83965184438445, -28.43233730458289, -18.47565198584452, -19.90212615260623, -35.058574396342074, -27.30774904484248, -31.83831203095592, -6.272506665733057, -9.186404621515456, -16.24300059207348, -22.105721716416216, -10.07761622065344, -23.744052737937228, -14.723343937456992, -19.696275607857768, -8.866168828600628, -20.411773106519984, -48.12689616565223, -56.833847354114226, -21.796238029574997, -26.95411456548252, -8.676176936662435, -29.01629183089402, -42.49719922903528, -21.56399781140767, -26.801287038944466, -11.866890683846364, -5.504460304005455, -37.66272669602428, -23.687350091682255, -29.591411559185392, -26.31926580123478, -22.576321139168403, -20.714821986831527, -12.946730889525913, -15.13928277171882, -16.449662041695046, -14.485543115492643, -37.67355830163572, -18.59545991231193, -23.42005379849773, -21.14009985235778, -25.166316857967534, -19.585776636693318, -23.012454653598333, -18.775375372186915, -12.230594098301813, -34.760808936545715, -9.923127594659906, -22.490970433163202], "policy_predator_policy_reward": [10.522519404554526, 17.684532659635675, 15.85511424634575, 10.168511812439933, 12.335070157469156, 27.868715123064195, -1.5957019044264662, 19.121760843108277, 41.318669479398835, 11.980682800733184, 23.131773234071353, 13.648829997315271, 25.409392709691808, 25.507316716723025, 4.163737366767141, 20.095402836721355, 17.78701849573898, 8.984248388245387, 34.35523518741701, 3.5841168012551314, 9.760310241381367, 35.55362975297674, 27.545996074374507, 37.433695860233165, 19.307043614282545, 18.842249144838632, 25.28958602804584, 32.87241567859209, 3.330193748577293, 38.47408886421588, 11.694864198088371, 2.4199963694404634, 36.00043357891341, 12.195341669533107, 18.00576503586799, 11.190040267302908, 11.467007858342367, 18.602605424074756, 11.590078416817851, 34.927593844997375, 25.838236664308003, 21.360838355463116, 29.09824614395434, 23.02292383041178, 34.252805490007574, 11.416220481911026, 32.297539402753884, 26.35450348608447, 34.727084500643784, 24.44190296929734, 36.187193085152316, 10.612086360170057, 22.21284868482008, 12.35366163049909, 14.50904720980608, 14.795049369941742, 10.292624870741292, 18.715680436865455, 10.900931629135846, 8.847834689497782, 13.144237840857258, 20.363259058019395, 15.665024457924527, 28.935782462506417, 34.78716580614272, 11.12106064660667, 27.47294046279966, 6.751123147184671, 28.368446307655958, 2.220816290152017, 26.124501370540628, 15.854707349256122, 13.192851164189268, 45.798152914925595, 37.06837677455147, 32.403171810113626, 44.03506370101703, 27.747796722679222, 35.188418894021304, 37.80710612360255, 36.658506061270025, 1.5426627492750962, 31.217430004373675, 2.5207278235865545, 45.782932152716306, 31.712819027952037, 21.666777055125905, 21.890460990699363, 9.67304541075266, 30.742824095484167, 13.414962544341273, 35.98200204690285, 20.12972174463569, 10.947384457550156, 15.702266520442105, 9.77664882398512, 23.82969026980169, 7.6273806462712415, 3.561859036275669, 6.388672946130302, 33.46865274567565, 40.210650943093256, 19.572310488984957, 37.29236412018082, 20.258124716811867, 16.693179254877137, 25.849297695514622, 13.954954609697815, 26.24502617647085, 43.87212261621329, 9.294550013761807, 45.320948075923155, 26.245963475723855, 37.43066058618799, 0.18368127907431608, 12.361332052391791, 18.931074606750727, -0.5582653637197956, 21.990451041302606, 10.49555014284435, 12.340211116094338, 31.871232316738084, 6.89207612250703, 13.26315631879986, 27.491034218989995, 19.997071256884432, 8.162119388667849, 21.284568486246148, 25.7561227932621, 13.636428422453443, 10.120121307148224, 7.612216350053025, 9.38271129933779, 31.440834913702187, 45.04891417598999, 51.2048781553145, 56.59976814049114, 57.067926567737324, 17.339073050317573, 26.25340300883243, 37.060423419215255, 16.847805711749764, 4.038306975159111, 13.314046898165753, 17.626459522026657, 40.406124139761395, 37.36394667713346, 47.63045178093719, 11.14575316577772, 31.982242457037604, 30.68656994814449, 22.916004129744458, 7.1015740431437155, 16.632207324549007, -2.4194863287355854, 13.4284069367465, 44.29030764138182, 31.035145750666732, 19.211818398553255, 28.162881784811233, 19.42705932566571, 39.75576379270511, 26.250472925134826, 26.388058677334808, 28.012283480327763, 17.140358798009043, 21.421097803744438, 20.008546169918638, 5.970386405841396, 19.92307537321042, 14.978907257344726, 15.299658286092939, 24.83936325233487, 8.05996083105521, 27.25509894281594, 1.7159872881693632, 46.31447572121246, 29.032640882058914, 11.433509777479026, 25.757410047144845, 30.511684027510796, 16.328423569484617, 8.110303359826247, 34.16989634488925, 33.96231468149036, 16.37031903444466, 20.635866077581024, 18.535687195805576, 35.87079511190411, 10.154114195292573, 22.526161325017746, 15.024589419356095, -0.38493305719926507, 24.846121253802867, 35.83678884805239, 33.68482902503904, 3.5036883045737595, 16.342566884746066, 20.537416158659635, 24.444524707666748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6389646607992183, "mean_inference_ms": 1.6668665864954817, "mean_action_processing_ms": 0.26338490200163495, "mean_env_wait_ms": 0.14777385900381626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006403446197509766, "StateBufferConnector_ms": 0.003741025924682617, "ViewRequirementAgentConnector_ms": 0.10991561412811279}, "num_episodes": 22, "episode_return_max": 56.833847354114205, "episode_return_min": 4.975265991202989, "episode_return_mean": 21.679093387998964, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.906184413797, "num_env_steps_trained_throughput_per_sec": 346.906184413797, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 11347.673, "restore_workers_time_ms": 0.019, "training_step_time_ms": 11347.486, "sample_time_ms": 1276.94, "learn_time_ms": 10051.946, "learn_throughput": 397.933, "synch_weights_time_ms": 14.586}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 18, "trial_id": "06536_00000", "date": "2024-08-11_16-37-40", "timestamp": 1723408660, "time_this_iter_s": 11.57886791229248, "time_total_s": 206.01775979995728, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331608430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.01775979995728, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 54.035294117647055, "ram_util_percent": 83.18235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6636984961107375, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9922799576073884, "policy_loss": -0.014080461182068878, "vf_loss": 2.005768113086621, "vf_explained_var": 0.8329154774546623, "kl": 0.011846196333843258, "entropy": 1.3346817683428527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6643460955884724, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2941899867915603, "policy_loss": -0.002505318429099307, "vf_loss": 1.296589549697896, "vf_explained_var": 0.9448730402207248, "kl": 0.0042302051839604015, "entropy": 0.8821340017217808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 56.833847354114205, "episode_reward_min": 1.2284580891447217, "episode_reward_mean": 22.370119673090997, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.833847354114226, "predator_policy": -2.4194863287355854}, "policy_reward_max": {"prey_policy": -1.2284580891447048, "predator_policy": 57.067926567737324}, "policy_reward_mean": {"prey_policy": -22.370119673090997, "predator_policy": 22.370119673090993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.326021444419176, 29.5844937349706, 23.3996397226612, 17.283255157659585, 14.652048289873932, 14.50415265380339, 9.874383159316817, 16.75374844943831, 22.300403460215463, 22.954113226374677, 17.112031804992164, 15.294631298904001, 20.989604359898404, 29.495502039557472, 34.73577429233257, 35.89143021184809, 36.49776250881195, 19.100584405272585, 16.869078913980115, 38.74787559033421, 21.77861902291267, 20.207934753118412, 24.698482295622007, 15.538553101092928, 12.739457672213614, 15.728535458036472, 4.975265991202989, 36.83965184438449, 28.432337304582855, 18.475651985844486, 19.902126152606204, 35.05857439634206, 27.30774904484252, 31.838312030955922, 6.272506665733056, 9.186404621515475, 16.243000592073493, 22.10572171641624, 10.07761622065348, 23.744052737937245, 14.723343937457006, 19.69627560785773, 8.866168828600628, 20.411773106520013, 48.12689616565224, 56.833847354114205, 21.796238029575022, 26.954114565482502, 8.676176936662443, 29.01629183089403, 42.497199229035324, 21.563997811407653, 26.80128703894449, 11.866890683846362, 5.504460304005447, 37.66272669602426, 23.68735009168222, 29.591411559185328, 26.319265801234806, 22.57632113916843, 20.714821986831573, 12.946730889525917, 15.139282771718836, 16.44966204169505, 14.485543115492662, 37.673558301635666, 18.595459912311952, 23.420053798497705, 21.140099852357775, 25.1663168579675, 19.585776636693296, 23.01245465359836, 18.775375372186915, 12.230594098301802, 34.76080893654574, 9.9231275946599, 22.4909704331632, 24.475431338923542, 29.73473945443246, 32.23935855435356, 16.240170605680312, 18.437971874482223, 24.737203832370653, 18.877483899574116, 20.41789517196679, 31.200008382856982, 3.9509195876916663, 30.73446928137309, 32.79437206175652, 29.53658471262484, 28.45460440129292, 41.87714335017681, 23.016264291669508, 23.61791888276613, 16.47559352851706, 28.675077913437278, 17.42735379377362, 1.2284580891447217, 21.332303499943443, 5.3308784970063], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.32602144441922, -29.584493734970554, -23.39963972266119, -17.283255157659596, -14.652048289873898, -14.504152653803377, -9.874383159316807, -16.75374844943834, -22.300403460215467, -22.954113226374712, -17.112031804992164, -15.294631298903994, -20.989604359898376, -29.495502039557447, -34.735774292332565, -35.89143021184815, -36.49776250881193, -19.10058440527254, -16.8690789139801, -38.747875590334125, -21.77861902291262, -20.207934753118423, -24.698482295622064, -15.538553101092937, -12.73945767221362, -15.72853545803646, -4.975265991202984, -36.83965184438445, -28.43233730458289, -18.47565198584452, -19.90212615260623, -35.058574396342074, -27.30774904484248, -31.83831203095592, -6.272506665733057, -9.186404621515456, -16.24300059207348, -22.105721716416216, -10.07761622065344, -23.744052737937228, -14.723343937456992, -19.696275607857768, -8.866168828600628, -20.411773106519984, -48.12689616565223, -56.833847354114226, -21.796238029574997, -26.95411456548252, -8.676176936662435, -29.01629183089402, -42.49719922903528, -21.56399781140767, -26.801287038944466, -11.866890683846364, -5.504460304005455, -37.66272669602428, -23.687350091682255, -29.591411559185392, -26.31926580123478, -22.576321139168403, -20.714821986831527, -12.946730889525913, -15.13928277171882, -16.449662041695046, -14.485543115492643, -37.67355830163572, -18.59545991231193, -23.42005379849773, -21.14009985235778, -25.166316857967534, -19.585776636693318, -23.012454653598333, -18.775375372186915, -12.230594098301813, -34.760808936545715, -9.923127594659906, -22.490970433163202, -24.475431338923514, -29.734739454432518, -32.23935855435355, -16.240170605680298, -18.43797187448222, -24.73720383237062, -18.877483899574106, -20.417895171966865, -31.20000838285705, -3.950919587691654, -30.734469281373116, -32.794372061756505, -29.53658471262484, -28.45460440129291, -41.87714335017684, -23.016264291669494, -23.61791888276609, -16.475593528517077, -28.675077913437335, -17.427353793773616, -1.2284580891447048, -21.33230349994344, -5.330878497006305], "policy_predator_policy_reward": [32.297539402753884, 26.35450348608447, 34.727084500643784, 24.44190296929734, 36.187193085152316, 10.612086360170057, 22.21284868482008, 12.35366163049909, 14.50904720980608, 14.795049369941742, 10.292624870741292, 18.715680436865455, 10.900931629135846, 8.847834689497782, 13.144237840857258, 20.363259058019395, 15.665024457924527, 28.935782462506417, 34.78716580614272, 11.12106064660667, 27.47294046279966, 6.751123147184671, 28.368446307655958, 2.220816290152017, 26.124501370540628, 15.854707349256122, 13.192851164189268, 45.798152914925595, 37.06837677455147, 32.403171810113626, 44.03506370101703, 27.747796722679222, 35.188418894021304, 37.80710612360255, 36.658506061270025, 1.5426627492750962, 31.217430004373675, 2.5207278235865545, 45.782932152716306, 31.712819027952037, 21.666777055125905, 21.890460990699363, 9.67304541075266, 30.742824095484167, 13.414962544341273, 35.98200204690285, 20.12972174463569, 10.947384457550156, 15.702266520442105, 9.77664882398512, 23.82969026980169, 7.6273806462712415, 3.561859036275669, 6.388672946130302, 33.46865274567565, 40.210650943093256, 19.572310488984957, 37.29236412018082, 20.258124716811867, 16.693179254877137, 25.849297695514622, 13.954954609697815, 26.24502617647085, 43.87212261621329, 9.294550013761807, 45.320948075923155, 26.245963475723855, 37.43066058618799, 0.18368127907431608, 12.361332052391791, 18.931074606750727, -0.5582653637197956, 21.990451041302606, 10.49555014284435, 12.340211116094338, 31.871232316738084, 6.89207612250703, 13.26315631879986, 27.491034218989995, 19.997071256884432, 8.162119388667849, 21.284568486246148, 25.7561227932621, 13.636428422453443, 10.120121307148224, 7.612216350053025, 9.38271129933779, 31.440834913702187, 45.04891417598999, 51.2048781553145, 56.59976814049114, 57.067926567737324, 17.339073050317573, 26.25340300883243, 37.060423419215255, 16.847805711749764, 4.038306975159111, 13.314046898165753, 17.626459522026657, 40.406124139761395, 37.36394667713346, 47.63045178093719, 11.14575316577772, 31.982242457037604, 30.68656994814449, 22.916004129744458, 7.1015740431437155, 16.632207324549007, -2.4194863287355854, 13.4284069367465, 44.29030764138182, 31.035145750666732, 19.211818398553255, 28.162881784811233, 19.42705932566571, 39.75576379270511, 26.250472925134826, 26.388058677334808, 28.012283480327763, 17.140358798009043, 21.421097803744438, 20.008546169918638, 5.970386405841396, 19.92307537321042, 14.978907257344726, 15.299658286092939, 24.83936325233487, 8.05996083105521, 27.25509894281594, 1.7159872881693632, 46.31447572121246, 29.032640882058914, 11.433509777479026, 25.757410047144845, 30.511684027510796, 16.328423569484617, 8.110303359826247, 34.16989634488925, 33.96231468149036, 16.37031903444466, 20.635866077581024, 18.535687195805576, 35.87079511190411, 10.154114195292573, 22.526161325017746, 15.024589419356095, -0.38493305719926507, 24.846121253802867, 35.83678884805239, 33.68482902503904, 3.5036883045737595, 16.342566884746066, 20.537416158659635, 24.444524707666748, 13.735550232300586, 35.21531244554646, 22.388282384458165, 37.08119652440684, 21.98633961250078, 42.49237749620634, 31.85142217628041, 0.6289190350801985, 20.36369855945781, 16.512245189506622, 11.365372552863036, 38.10903511187822, 25.982135442452332, 11.772832356695858, 25.188041749152802, 15.647748594780907, 25.415047272686582, 36.98496949302748, 3.816407403996335, 4.085431771386989, 24.332470178214194, 37.13646838453201, 28.94911997146698, 36.639624152046025, 23.73727192016326, 35.335897505086436, 29.79680837172637, 27.112400430859473, 44.43879908431552, 39.315487616038155, 37.39386918087546, 8.638659402463537, 24.29979616338124, 22.936041602150937, 9.800871085868438, 23.150315971165668, 34.8095410624763, 22.540614764398303, 16.34549341242083, 18.50921417512638, -0.1596436824154095, 2.6165598607048306, 25.367241171177927, 17.297365828708948, 6.169856425031833, 4.491900568980772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6383262057944262, "mean_inference_ms": 1.6626065428218748, "mean_action_processing_ms": 0.26179540343380014, "mean_env_wait_ms": 0.14791525976561715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006185770034790039, "StateBufferConnector_ms": 0.003560304641723633, "ViewRequirementAgentConnector_ms": 0.10525405406951904}, "num_episodes": 23, "episode_return_max": 56.833847354114205, "episode_return_min": 1.2284580891447217, "episode_return_mean": 22.370119673090997, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.21948324226776, "num_env_steps_trained_throughput_per_sec": 377.21948324226776, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 11267.729, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11267.533, "sample_time_ms": 1241.304, "learn_time_ms": 10007.552, "learn_throughput": 399.698, "synch_weights_time_ms": 14.679}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 19, "trial_id": "06536_00000", "date": "2024-08-11_16-37-51", "timestamp": 1723408671, "time_this_iter_s": 10.693089008331299, "time_total_s": 216.71084880828857, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310f09d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 216.71084880828857, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 46.14, "ram_util_percent": 83.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.553590784346064, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6438517258502543, "policy_loss": -0.009434673726354958, "vf_loss": 1.6529162179678678, "vf_explained_var": 0.8177904291078448, "kl": 0.007403583264449054, "entropy": 1.377989822998643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4375195782651344, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0415260903576695, "policy_loss": -0.0023726198533993393, "vf_loss": 1.0438147494086514, "vf_explained_var": 0.9603855004701665, "kl": 0.006716793596130681, "entropy": 0.892860991078079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 56.833847354114205, "episode_reward_min": 1.2284580891447217, "episode_reward_mean": 22.807865422707383, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.833847354114226, "predator_policy": -2.4194863287355854}, "policy_reward_max": {"prey_policy": -1.2284580891447048, "predator_policy": 57.067926567737324}, "policy_reward_mean": {"prey_policy": -22.807865422707383, "predator_policy": 22.807865422707383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.869078913980115, 38.74787559033421, 21.77861902291267, 20.207934753118412, 24.698482295622007, 15.538553101092928, 12.739457672213614, 15.728535458036472, 4.975265991202989, 36.83965184438449, 28.432337304582855, 18.475651985844486, 19.902126152606204, 35.05857439634206, 27.30774904484252, 31.838312030955922, 6.272506665733056, 9.186404621515475, 16.243000592073493, 22.10572171641624, 10.07761622065348, 23.744052737937245, 14.723343937457006, 19.69627560785773, 8.866168828600628, 20.411773106520013, 48.12689616565224, 56.833847354114205, 21.796238029575022, 26.954114565482502, 8.676176936662443, 29.01629183089403, 42.497199229035324, 21.563997811407653, 26.80128703894449, 11.866890683846362, 5.504460304005447, 37.66272669602426, 23.68735009168222, 29.591411559185328, 26.319265801234806, 22.57632113916843, 20.714821986831573, 12.946730889525917, 15.139282771718836, 16.44966204169505, 14.485543115492662, 37.673558301635666, 18.595459912311952, 23.420053798497705, 21.140099852357775, 25.1663168579675, 19.585776636693296, 23.01245465359836, 18.775375372186915, 12.230594098301802, 34.76080893654574, 9.9231275946599, 22.4909704331632, 24.475431338923542, 29.73473945443246, 32.23935855435356, 16.240170605680312, 18.437971874482223, 24.737203832370653, 18.877483899574116, 20.41789517196679, 31.200008382856982, 3.9509195876916663, 30.73446928137309, 32.79437206175652, 29.53658471262484, 28.45460440129292, 41.87714335017681, 23.016264291669508, 23.61791888276613, 16.47559352851706, 28.675077913437278, 17.42735379377362, 1.2284580891447217, 21.332303499943443, 5.3308784970063, 16.22395448002866, 28.75171216980918, 27.374054970524732, 20.240664037045136, 13.71552901042579, 25.652979326780443, 30.537515463409314, 24.288318312569594, 33.05295094730355, 36.4136250395265, 8.49686655570239, 9.302753835303205, 28.214000317487194, 27.917159553973097, 22.919021195952908, 47.80580153977942, 18.664563950572262, 33.952684475795415], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.8690789139801, -38.747875590334125, -21.77861902291262, -20.207934753118423, -24.698482295622064, -15.538553101092937, -12.73945767221362, -15.72853545803646, -4.975265991202984, -36.83965184438445, -28.43233730458289, -18.47565198584452, -19.90212615260623, -35.058574396342074, -27.30774904484248, -31.83831203095592, -6.272506665733057, -9.186404621515456, -16.24300059207348, -22.105721716416216, -10.07761622065344, -23.744052737937228, -14.723343937456992, -19.696275607857768, -8.866168828600628, -20.411773106519984, -48.12689616565223, -56.833847354114226, -21.796238029574997, -26.95411456548252, -8.676176936662435, -29.01629183089402, -42.49719922903528, -21.56399781140767, -26.801287038944466, -11.866890683846364, -5.504460304005455, -37.66272669602428, -23.687350091682255, -29.591411559185392, -26.31926580123478, -22.576321139168403, -20.714821986831527, -12.946730889525913, -15.13928277171882, -16.449662041695046, -14.485543115492643, -37.67355830163572, -18.59545991231193, -23.42005379849773, -21.14009985235778, -25.166316857967534, -19.585776636693318, -23.012454653598333, -18.775375372186915, -12.230594098301813, -34.760808936545715, -9.923127594659906, -22.490970433163202, -24.475431338923514, -29.734739454432518, -32.23935855435355, -16.240170605680298, -18.43797187448222, -24.73720383237062, -18.877483899574106, -20.417895171966865, -31.20000838285705, -3.950919587691654, -30.734469281373116, -32.794372061756505, -29.53658471262484, -28.45460440129291, -41.87714335017684, -23.016264291669494, -23.61791888276609, -16.475593528517077, -28.675077913437335, -17.427353793773616, -1.2284580891447048, -21.33230349994344, -5.330878497006305, -16.22395448002865, -28.751712169809164, -27.374054970524753, -20.24066403704517, -13.715529010425794, -25.652979326780464, -30.53751546340929, -24.288318312569636, -33.052950947303565, -36.413625039526515, -8.496866555702402, -9.3027538353032, -28.214000317487173, -27.917159553973075, -22.919021195952936, -47.80580153977941, -18.664563950572234, -33.9526844757954], "policy_predator_policy_reward": [31.217430004373675, 2.5207278235865545, 45.782932152716306, 31.712819027952037, 21.666777055125905, 21.890460990699363, 9.67304541075266, 30.742824095484167, 13.414962544341273, 35.98200204690285, 20.12972174463569, 10.947384457550156, 15.702266520442105, 9.77664882398512, 23.82969026980169, 7.6273806462712415, 3.561859036275669, 6.388672946130302, 33.46865274567565, 40.210650943093256, 19.572310488984957, 37.29236412018082, 20.258124716811867, 16.693179254877137, 25.849297695514622, 13.954954609697815, 26.24502617647085, 43.87212261621329, 9.294550013761807, 45.320948075923155, 26.245963475723855, 37.43066058618799, 0.18368127907431608, 12.361332052391791, 18.931074606750727, -0.5582653637197956, 21.990451041302606, 10.49555014284435, 12.340211116094338, 31.871232316738084, 6.89207612250703, 13.26315631879986, 27.491034218989995, 19.997071256884432, 8.162119388667849, 21.284568486246148, 25.7561227932621, 13.636428422453443, 10.120121307148224, 7.612216350053025, 9.38271129933779, 31.440834913702187, 45.04891417598999, 51.2048781553145, 56.59976814049114, 57.067926567737324, 17.339073050317573, 26.25340300883243, 37.060423419215255, 16.847805711749764, 4.038306975159111, 13.314046898165753, 17.626459522026657, 40.406124139761395, 37.36394667713346, 47.63045178093719, 11.14575316577772, 31.982242457037604, 30.68656994814449, 22.916004129744458, 7.1015740431437155, 16.632207324549007, -2.4194863287355854, 13.4284069367465, 44.29030764138182, 31.035145750666732, 19.211818398553255, 28.162881784811233, 19.42705932566571, 39.75576379270511, 26.250472925134826, 26.388058677334808, 28.012283480327763, 17.140358798009043, 21.421097803744438, 20.008546169918638, 5.970386405841396, 19.92307537321042, 14.978907257344726, 15.299658286092939, 24.83936325233487, 8.05996083105521, 27.25509894281594, 1.7159872881693632, 46.31447572121246, 29.032640882058914, 11.433509777479026, 25.757410047144845, 30.511684027510796, 16.328423569484617, 8.110303359826247, 34.16989634488925, 33.96231468149036, 16.37031903444466, 20.635866077581024, 18.535687195805576, 35.87079511190411, 10.154114195292573, 22.526161325017746, 15.024589419356095, -0.38493305719926507, 24.846121253802867, 35.83678884805239, 33.68482902503904, 3.5036883045737595, 16.342566884746066, 20.537416158659635, 24.444524707666748, 13.735550232300586, 35.21531244554646, 22.388282384458165, 37.08119652440684, 21.98633961250078, 42.49237749620634, 31.85142217628041, 0.6289190350801985, 20.36369855945781, 16.512245189506622, 11.365372552863036, 38.10903511187822, 25.982135442452332, 11.772832356695858, 25.188041749152802, 15.647748594780907, 25.415047272686582, 36.98496949302748, 3.816407403996335, 4.085431771386989, 24.332470178214194, 37.13646838453201, 28.94911997146698, 36.639624152046025, 23.73727192016326, 35.335897505086436, 29.79680837172637, 27.112400430859473, 44.43879908431552, 39.315487616038155, 37.39386918087546, 8.638659402463537, 24.29979616338124, 22.936041602150937, 9.800871085868438, 23.150315971165668, 34.8095410624763, 22.540614764398303, 16.34549341242083, 18.50921417512638, -0.1596436824154095, 2.6165598607048306, 25.367241171177927, 17.297365828708948, 6.169856425031833, 4.491900568980772, 12.54706793922958, 19.900841020827723, 22.57443046022372, 34.92899387939458, 26.751810565737873, 27.996299375311608, 10.81997957500835, 29.66134849908193, 23.91103298403758, 3.5200250368140056, 36.116683381823485, 15.189275271737444, 24.89544520743611, 36.17958571938247, 10.257208968510579, 38.31942765662869, 28.447740236072086, 37.65816165853505, 42.206875529053754, 30.620374549999212, 8.221337749555955, 8.772395361848838, 12.233538465035224, 6.371969205571189, 21.570229002998175, 34.857771631976135, 22.8108712977429, 33.023447810203265, 31.640133568100946, 14.197908823804966, 54.1005994057982, 41.511003673760655, 15.259416996435927, 22.06971090470854, 33.52298881565798, 34.38238013593285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.637067151139308, "mean_inference_ms": 1.6572250027791176, "mean_action_processing_ms": 0.26052777133100524, "mean_env_wait_ms": 0.1476362785181965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006131887435913086, "StateBufferConnector_ms": 0.003540635108947754, "ViewRequirementAgentConnector_ms": 0.09846484661102295}, "num_episodes": 18, "episode_return_max": 56.833847354114205, "episode_return_min": 1.2284580891447217, "episode_return_mean": 22.807865422707383, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.19413362393453, "num_env_steps_trained_throughput_per_sec": 368.19413362393453, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 11290.779, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11290.538, "sample_time_ms": 1258.45, "learn_time_ms": 10012.22, "learn_throughput": 399.512, "synch_weights_time_ms": 15.274}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 20, "trial_id": "06536_00000", "date": "2024-08-11_16-38-02", "timestamp": 1723408682, "time_this_iter_s": 10.9098219871521, "time_total_s": 227.62067079544067, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c1040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 227.62067079544067, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 50.29333333333333, "ram_util_percent": 83.27333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3141775789981085, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3731880358885973, "policy_loss": -0.007208990004194978, "vf_loss": 1.380138156718264, "vf_explained_var": 0.8701972126339873, "kl": 0.005177444738827989, "entropy": 1.378234139829874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2758930089297116, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9785618806011462, "policy_loss": -0.0037915138062089683, "vf_loss": 0.9822874981574912, "vf_explained_var": 0.9425839426971617, "kl": 0.005271790984711914, "entropy": 0.8792356097508991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": 56.833847354114205, "episode_reward_min": 1.2284580891447217, "episode_reward_mean": 23.188856435639778, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.833847354114226, "predator_policy": -2.4194863287355854}, "policy_reward_max": {"prey_policy": -1.2284580891447048, "predator_policy": 57.067926567737324}, "policy_reward_mean": {"prey_policy": -23.188856435639778, "predator_policy": 23.188856435639774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.243000592073493, 22.10572171641624, 10.07761622065348, 23.744052737937245, 14.723343937457006, 19.69627560785773, 8.866168828600628, 20.411773106520013, 48.12689616565224, 56.833847354114205, 21.796238029575022, 26.954114565482502, 8.676176936662443, 29.01629183089403, 42.497199229035324, 21.563997811407653, 26.80128703894449, 11.866890683846362, 5.504460304005447, 37.66272669602426, 23.68735009168222, 29.591411559185328, 26.319265801234806, 22.57632113916843, 20.714821986831573, 12.946730889525917, 15.139282771718836, 16.44966204169505, 14.485543115492662, 37.673558301635666, 18.595459912311952, 23.420053798497705, 21.140099852357775, 25.1663168579675, 19.585776636693296, 23.01245465359836, 18.775375372186915, 12.230594098301802, 34.76080893654574, 9.9231275946599, 22.4909704331632, 24.475431338923542, 29.73473945443246, 32.23935855435356, 16.240170605680312, 18.437971874482223, 24.737203832370653, 18.877483899574116, 20.41789517196679, 31.200008382856982, 3.9509195876916663, 30.73446928137309, 32.79437206175652, 29.53658471262484, 28.45460440129292, 41.87714335017681, 23.016264291669508, 23.61791888276613, 16.47559352851706, 28.675077913437278, 17.42735379377362, 1.2284580891447217, 21.332303499943443, 5.3308784970063, 16.22395448002866, 28.75171216980918, 27.374054970524732, 20.240664037045136, 13.71552901042579, 25.652979326780443, 30.537515463409314, 24.288318312569594, 33.05295094730355, 36.4136250395265, 8.49686655570239, 9.302753835303205, 28.214000317487194, 27.917159553973097, 22.919021195952908, 47.80580153977942, 18.664563950572262, 33.952684475795415, 12.380246456545132, 22.31106352487476, 21.376194603508992, 41.99149513376323, 26.198534933682676, 26.493034303621137, 29.831547471196163, 29.812242785403534, 31.812530354576317, 9.874784790496362, 3.598277615630704, 20.30285949299874, 23.449563806644868, 28.488019388564997, 31.371891827920958, 22.20405254120062, 8.32928271154782, 32.87059639638249], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.24300059207348, -22.105721716416216, -10.07761622065344, -23.744052737937228, -14.723343937456992, -19.696275607857768, -8.866168828600628, -20.411773106519984, -48.12689616565223, -56.833847354114226, -21.796238029574997, -26.95411456548252, -8.676176936662435, -29.01629183089402, -42.49719922903528, -21.56399781140767, -26.801287038944466, -11.866890683846364, -5.504460304005455, -37.66272669602428, -23.687350091682255, -29.591411559185392, -26.31926580123478, -22.576321139168403, -20.714821986831527, -12.946730889525913, -15.13928277171882, -16.449662041695046, -14.485543115492643, -37.67355830163572, -18.59545991231193, -23.42005379849773, -21.14009985235778, -25.166316857967534, -19.585776636693318, -23.012454653598333, -18.775375372186915, -12.230594098301813, -34.760808936545715, -9.923127594659906, -22.490970433163202, -24.475431338923514, -29.734739454432518, -32.23935855435355, -16.240170605680298, -18.43797187448222, -24.73720383237062, -18.877483899574106, -20.417895171966865, -31.20000838285705, -3.950919587691654, -30.734469281373116, -32.794372061756505, -29.53658471262484, -28.45460440129291, -41.87714335017684, -23.016264291669494, -23.61791888276609, -16.475593528517077, -28.675077913437335, -17.427353793773616, -1.2284580891447048, -21.33230349994344, -5.330878497006305, -16.22395448002865, -28.751712169809164, -27.374054970524753, -20.24066403704517, -13.715529010425794, -25.652979326780464, -30.53751546340929, -24.288318312569636, -33.052950947303565, -36.413625039526515, -8.496866555702402, -9.3027538353032, -28.214000317487173, -27.917159553973075, -22.919021195952936, -47.80580153977941, -18.664563950572234, -33.9526844757954, -12.380246456545091, -22.31106352487471, -21.376194603508967, -41.99149513376327, -26.198534933682645, -26.49303430362117, -29.831547471196167, -29.812242785403527, -31.812530354576314, -9.874784790496363, -3.598277615630697, -20.302859492998717, -23.449563806644854, -28.488019388564982, -31.371891827920884, -22.20405254120059, -8.329282711547833, -32.87059639638246], "policy_predator_policy_reward": [21.990451041302606, 10.49555014284435, 12.340211116094338, 31.871232316738084, 6.89207612250703, 13.26315631879986, 27.491034218989995, 19.997071256884432, 8.162119388667849, 21.284568486246148, 25.7561227932621, 13.636428422453443, 10.120121307148224, 7.612216350053025, 9.38271129933779, 31.440834913702187, 45.04891417598999, 51.2048781553145, 56.59976814049114, 57.067926567737324, 17.339073050317573, 26.25340300883243, 37.060423419215255, 16.847805711749764, 4.038306975159111, 13.314046898165753, 17.626459522026657, 40.406124139761395, 37.36394667713346, 47.63045178093719, 11.14575316577772, 31.982242457037604, 30.68656994814449, 22.916004129744458, 7.1015740431437155, 16.632207324549007, -2.4194863287355854, 13.4284069367465, 44.29030764138182, 31.035145750666732, 19.211818398553255, 28.162881784811233, 19.42705932566571, 39.75576379270511, 26.250472925134826, 26.388058677334808, 28.012283480327763, 17.140358798009043, 21.421097803744438, 20.008546169918638, 5.970386405841396, 19.92307537321042, 14.978907257344726, 15.299658286092939, 24.83936325233487, 8.05996083105521, 27.25509894281594, 1.7159872881693632, 46.31447572121246, 29.032640882058914, 11.433509777479026, 25.757410047144845, 30.511684027510796, 16.328423569484617, 8.110303359826247, 34.16989634488925, 33.96231468149036, 16.37031903444466, 20.635866077581024, 18.535687195805576, 35.87079511190411, 10.154114195292573, 22.526161325017746, 15.024589419356095, -0.38493305719926507, 24.846121253802867, 35.83678884805239, 33.68482902503904, 3.5036883045737595, 16.342566884746066, 20.537416158659635, 24.444524707666748, 13.735550232300586, 35.21531244554646, 22.388282384458165, 37.08119652440684, 21.98633961250078, 42.49237749620634, 31.85142217628041, 0.6289190350801985, 20.36369855945781, 16.512245189506622, 11.365372552863036, 38.10903511187822, 25.982135442452332, 11.772832356695858, 25.188041749152802, 15.647748594780907, 25.415047272686582, 36.98496949302748, 3.816407403996335, 4.085431771386989, 24.332470178214194, 37.13646838453201, 28.94911997146698, 36.639624152046025, 23.73727192016326, 35.335897505086436, 29.79680837172637, 27.112400430859473, 44.43879908431552, 39.315487616038155, 37.39386918087546, 8.638659402463537, 24.29979616338124, 22.936041602150937, 9.800871085868438, 23.150315971165668, 34.8095410624763, 22.540614764398303, 16.34549341242083, 18.50921417512638, -0.1596436824154095, 2.6165598607048306, 25.367241171177927, 17.297365828708948, 6.169856425031833, 4.491900568980772, 12.54706793922958, 19.900841020827723, 22.57443046022372, 34.92899387939458, 26.751810565737873, 27.996299375311608, 10.81997957500835, 29.66134849908193, 23.91103298403758, 3.5200250368140056, 36.116683381823485, 15.189275271737444, 24.89544520743611, 36.17958571938247, 10.257208968510579, 38.31942765662869, 28.447740236072086, 37.65816165853505, 42.206875529053754, 30.620374549999212, 8.221337749555955, 8.772395361848838, 12.233538465035224, 6.371969205571189, 21.570229002998175, 34.857771631976135, 22.8108712977429, 33.023447810203265, 31.640133568100946, 14.197908823804966, 54.1005994057982, 41.511003673760655, 15.259416996435927, 22.06971090470854, 33.52298881565798, 34.38238013593285, 21.72804009382663, 3.032452819263561, 13.365450063492332, 31.25667698625712, 3.550553781045102, 39.2018354259728, 35.46578783477953, 48.51720243274697, 45.458647132610956, 6.938422734754372, 23.647577543431815, 29.338491063810494, 34.75710731430735, 24.90598762808501, 18.676196185676616, 40.94828938513035, 34.18967701353965, 29.43538369561299, 3.0385449757604537, 16.711024605232282, 0.7676837365314562, 6.428871494729933, 11.571364531241311, 29.034354454756123, 30.24480397205814, 16.654323641231578, 14.69412456017078, 42.28191421695916, 30.788404036373393, 31.9553796194684, 24.18212580821788, 20.22597927418333, 9.851870236003034, 6.806695187092622, 18.7755572942163, 46.96563549854867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6369276204807933, "mean_inference_ms": 1.6566735701106508, "mean_action_processing_ms": 0.26003421213710687, "mean_env_wait_ms": 0.14785951692507796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004199504852294922, "StateBufferConnector_ms": 0.0038046836853027344, "ViewRequirementAgentConnector_ms": 0.11172652244567871}, "num_episodes": 18, "episode_return_max": 56.833847354114205, "episode_return_min": 1.2284580891447217, "episode_return_mean": 23.188856435639778, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.11908594575243, "num_env_steps_trained_throughput_per_sec": 356.11908594575243, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 11197.947, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11197.705, "sample_time_ms": 1254.007, "learn_time_ms": 9922.051, "learn_throughput": 403.142, "synch_weights_time_ms": 17.037}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 21, "trial_id": "06536_00000", "date": "2024-08-11_16-38-13", "timestamp": 1723408693, "time_this_iter_s": 11.274446964263916, "time_total_s": 238.8951177597046, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316084c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 238.8951177597046, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 50.418749999999996, "ram_util_percent": 83.03125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2188076404233774, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2322444791129479, "policy_loss": -0.012258302101690788, "vf_loss": 1.2440624016337096, "vf_explained_var": 0.9272726450736324, "kl": 0.008807606815644494, "entropy": 1.370245162397623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.474365299971646, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8966780505167744, "policy_loss": -0.0022627225722230615, "vf_loss": 0.898860311334726, "vf_explained_var": 0.977710190809593, "kl": 0.0064367693353875755, "entropy": 0.8627611909909223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 47.80580153977942, "episode_reward_min": 0.2795497758538332, "episode_reward_mean": 23.258321759112313, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.80580153977941, "predator_policy": -2.4194863287355854}, "policy_reward_max": {"prey_policy": -0.27954977585383567, "predator_policy": 54.1005994057982}, "policy_reward_mean": {"prey_policy": -23.25832175911231, "predator_policy": 23.258321759112313}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.504460304005447, 37.66272669602426, 23.68735009168222, 29.591411559185328, 26.319265801234806, 22.57632113916843, 20.714821986831573, 12.946730889525917, 15.139282771718836, 16.44966204169505, 14.485543115492662, 37.673558301635666, 18.595459912311952, 23.420053798497705, 21.140099852357775, 25.1663168579675, 19.585776636693296, 23.01245465359836, 18.775375372186915, 12.230594098301802, 34.76080893654574, 9.9231275946599, 22.4909704331632, 24.475431338923542, 29.73473945443246, 32.23935855435356, 16.240170605680312, 18.437971874482223, 24.737203832370653, 18.877483899574116, 20.41789517196679, 31.200008382856982, 3.9509195876916663, 30.73446928137309, 32.79437206175652, 29.53658471262484, 28.45460440129292, 41.87714335017681, 23.016264291669508, 23.61791888276613, 16.47559352851706, 28.675077913437278, 17.42735379377362, 1.2284580891447217, 21.332303499943443, 5.3308784970063, 16.22395448002866, 28.75171216980918, 27.374054970524732, 20.240664037045136, 13.71552901042579, 25.652979326780443, 30.537515463409314, 24.288318312569594, 33.05295094730355, 36.4136250395265, 8.49686655570239, 9.302753835303205, 28.214000317487194, 27.917159553973097, 22.919021195952908, 47.80580153977942, 18.664563950572262, 33.952684475795415, 12.380246456545132, 22.31106352487476, 21.376194603508992, 41.99149513376323, 26.198534933682676, 26.493034303621137, 29.831547471196163, 29.812242785403534, 31.812530354576317, 9.874784790496362, 3.598277615630704, 20.30285949299874, 23.449563806644868, 28.488019388564997, 31.371891827920958, 22.20405254120062, 8.32928271154782, 32.87059639638249, 27.07200304450333, 45.546840181868475, 28.992364453743654, 11.12598262860156, 31.266668428423436, 8.30500780129584, 29.236491995038328, 27.00616651932702, 38.1107486581579, 34.6706626598896, 47.313869380265466, 31.37150764439528, 0.2795497758538332, 19.927816172710344, 20.193141010348878, 7.869211014373597, 10.253348229099066, 18.40604514248864], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.504460304005455, -37.66272669602428, -23.687350091682255, -29.591411559185392, -26.31926580123478, -22.576321139168403, -20.714821986831527, -12.946730889525913, -15.13928277171882, -16.449662041695046, -14.485543115492643, -37.67355830163572, -18.59545991231193, -23.42005379849773, -21.14009985235778, -25.166316857967534, -19.585776636693318, -23.012454653598333, -18.775375372186915, -12.230594098301813, -34.760808936545715, -9.923127594659906, -22.490970433163202, -24.475431338923514, -29.734739454432518, -32.23935855435355, -16.240170605680298, -18.43797187448222, -24.73720383237062, -18.877483899574106, -20.417895171966865, -31.20000838285705, -3.950919587691654, -30.734469281373116, -32.794372061756505, -29.53658471262484, -28.45460440129291, -41.87714335017684, -23.016264291669494, -23.61791888276609, -16.475593528517077, -28.675077913437335, -17.427353793773616, -1.2284580891447048, -21.33230349994344, -5.330878497006305, -16.22395448002865, -28.751712169809164, -27.374054970524753, -20.24066403704517, -13.715529010425794, -25.652979326780464, -30.53751546340929, -24.288318312569636, -33.052950947303565, -36.413625039526515, -8.496866555702402, -9.3027538353032, -28.214000317487173, -27.917159553973075, -22.919021195952936, -47.80580153977941, -18.664563950572234, -33.9526844757954, -12.380246456545091, -22.31106352487471, -21.376194603508967, -41.99149513376327, -26.198534933682645, -26.49303430362117, -29.831547471196167, -29.812242785403527, -31.812530354576314, -9.874784790496363, -3.598277615630697, -20.302859492998717, -23.449563806644854, -28.488019388564982, -31.371891827920884, -22.20405254120059, -8.329282711547833, -32.87059639638246, -27.072003044503347, -45.54684018186842, -28.992364453743665, -11.125982628601564, -31.26666842842341, -8.305007801295833, -29.23649199503831, -27.00616651932699, -38.11074865815791, -34.67066265988967, -47.313869380265544, -31.37150764439531, -0.27954977585383567, -19.92781617271036, -20.193141010348857, -7.8692110143735885, -10.253348229099053, -18.406045142488658], "policy_predator_policy_reward": [-2.4194863287355854, 13.4284069367465, 44.29030764138182, 31.035145750666732, 19.211818398553255, 28.162881784811233, 19.42705932566571, 39.75576379270511, 26.250472925134826, 26.388058677334808, 28.012283480327763, 17.140358798009043, 21.421097803744438, 20.008546169918638, 5.970386405841396, 19.92307537321042, 14.978907257344726, 15.299658286092939, 24.83936325233487, 8.05996083105521, 27.25509894281594, 1.7159872881693632, 46.31447572121246, 29.032640882058914, 11.433509777479026, 25.757410047144845, 30.511684027510796, 16.328423569484617, 8.110303359826247, 34.16989634488925, 33.96231468149036, 16.37031903444466, 20.635866077581024, 18.535687195805576, 35.87079511190411, 10.154114195292573, 22.526161325017746, 15.024589419356095, -0.38493305719926507, 24.846121253802867, 35.83678884805239, 33.68482902503904, 3.5036883045737595, 16.342566884746066, 20.537416158659635, 24.444524707666748, 13.735550232300586, 35.21531244554646, 22.388282384458165, 37.08119652440684, 21.98633961250078, 42.49237749620634, 31.85142217628041, 0.6289190350801985, 20.36369855945781, 16.512245189506622, 11.365372552863036, 38.10903511187822, 25.982135442452332, 11.772832356695858, 25.188041749152802, 15.647748594780907, 25.415047272686582, 36.98496949302748, 3.816407403996335, 4.085431771386989, 24.332470178214194, 37.13646838453201, 28.94911997146698, 36.639624152046025, 23.73727192016326, 35.335897505086436, 29.79680837172637, 27.112400430859473, 44.43879908431552, 39.315487616038155, 37.39386918087546, 8.638659402463537, 24.29979616338124, 22.936041602150937, 9.800871085868438, 23.150315971165668, 34.8095410624763, 22.540614764398303, 16.34549341242083, 18.50921417512638, -0.1596436824154095, 2.6165598607048306, 25.367241171177927, 17.297365828708948, 6.169856425031833, 4.491900568980772, 12.54706793922958, 19.900841020827723, 22.57443046022372, 34.92899387939458, 26.751810565737873, 27.996299375311608, 10.81997957500835, 29.66134849908193, 23.91103298403758, 3.5200250368140056, 36.116683381823485, 15.189275271737444, 24.89544520743611, 36.17958571938247, 10.257208968510579, 38.31942765662869, 28.447740236072086, 37.65816165853505, 42.206875529053754, 30.620374549999212, 8.221337749555955, 8.772395361848838, 12.233538465035224, 6.371969205571189, 21.570229002998175, 34.857771631976135, 22.8108712977429, 33.023447810203265, 31.640133568100946, 14.197908823804966, 54.1005994057982, 41.511003673760655, 15.259416996435927, 22.06971090470854, 33.52298881565798, 34.38238013593285, 21.72804009382663, 3.032452819263561, 13.365450063492332, 31.25667698625712, 3.550553781045102, 39.2018354259728, 35.46578783477953, 48.51720243274697, 45.458647132610956, 6.938422734754372, 23.647577543431815, 29.338491063810494, 34.75710731430735, 24.90598762808501, 18.676196185676616, 40.94828938513035, 34.18967701353965, 29.43538369561299, 3.0385449757604537, 16.711024605232282, 0.7676837365314562, 6.428871494729933, 11.571364531241311, 29.034354454756123, 30.24480397205814, 16.654323641231578, 14.69412456017078, 42.28191421695916, 30.788404036373393, 31.9553796194684, 24.18212580821788, 20.22597927418333, 9.851870236003034, 6.806695187092622, 18.7755572942163, 46.96563549854867, 24.141268383736676, 30.002737705270007, 44.93902612734866, 46.154654236388225, 22.482323862867993, 35.50240504461931, 1.3199170909585098, 20.932048166244613, 31.16058626271712, 31.37275059412972, 4.048357156197978, 12.561658446393695, 30.195504040151274, 28.277479949925347, 15.80298424311092, 38.20934879554306, 38.023703084689494, 38.19779423162631, 37.36561524669693, 31.97571007308238, 52.0359671822509, 42.59177157828011, 37.040697305954154, 25.702317982836462, 2.8874820811752997, -2.328382529467627, 7.887136047424868, 31.968496297995834, 32.46501618302119, 7.921265837676525, 17.094631682209453, -1.356209653462256, 15.894444933159873, 4.612251525038237, 9.199203058062118, 27.612887226915188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6350650613602469, "mean_inference_ms": 1.6504158369990443, "mean_action_processing_ms": 0.2589864209681609, "mean_env_wait_ms": 0.14759394055771968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006521463394165039, "StateBufferConnector_ms": 0.003325223922729492, "ViewRequirementAgentConnector_ms": 0.11162519454956055}, "num_episodes": 18, "episode_return_max": 47.80580153977942, "episode_return_min": 0.2795497758538332, "episode_return_mean": 23.258321759112313, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.3853053796202, "num_env_steps_trained_throughput_per_sec": 374.3853053796202, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 11122.12, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11121.874, "sample_time_ms": 1207.266, "learn_time_ms": 9892.844, "learn_throughput": 404.333, "synch_weights_time_ms": 17.113}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 22, "trial_id": "06536_00000", "date": "2024-08-11_16-38-24", "timestamp": 1723408704, "time_this_iter_s": 10.717689037322998, "time_total_s": 249.6128067970276, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331608310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 249.6128067970276, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 49.933333333333344, "ram_util_percent": 82.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0902165892844398, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0846251858087876, "policy_loss": -0.00714857806621391, "vf_loss": 1.0915590378766258, "vf_explained_var": 0.8895385249207417, "kl": 0.004294436671010581, "entropy": 1.3110317938029765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1575134230984583, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8559427517116385, "policy_loss": -0.0014110087196554536, "vf_loss": 0.8573019304445811, "vf_explained_var": 0.9672225735805653, "kl": 0.0041463601533570996, "entropy": 0.8402017842524897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 47.80580153977942, "episode_reward_min": 0.2795497758538332, "episode_reward_mean": 23.528103580312322, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.80580153977941, "predator_policy": -2.4450244710822684}, "policy_reward_max": {"prey_policy": -0.27954977585383567, "predator_policy": 54.1005994057982}, "policy_reward_mean": {"prey_policy": -23.52810358031232, "predator_policy": 23.52810358031232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.437971874482223, 24.737203832370653, 18.877483899574116, 20.41789517196679, 31.200008382856982, 3.9509195876916663, 30.73446928137309, 32.79437206175652, 29.53658471262484, 28.45460440129292, 41.87714335017681, 23.016264291669508, 23.61791888276613, 16.47559352851706, 28.675077913437278, 17.42735379377362, 1.2284580891447217, 21.332303499943443, 5.3308784970063, 16.22395448002866, 28.75171216980918, 27.374054970524732, 20.240664037045136, 13.71552901042579, 25.652979326780443, 30.537515463409314, 24.288318312569594, 33.05295094730355, 36.4136250395265, 8.49686655570239, 9.302753835303205, 28.214000317487194, 27.917159553973097, 22.919021195952908, 47.80580153977942, 18.664563950572262, 33.952684475795415, 12.380246456545132, 22.31106352487476, 21.376194603508992, 41.99149513376323, 26.198534933682676, 26.493034303621137, 29.831547471196163, 29.812242785403534, 31.812530354576317, 9.874784790496362, 3.598277615630704, 20.30285949299874, 23.449563806644868, 28.488019388564997, 31.371891827920958, 22.20405254120062, 8.32928271154782, 32.87059639638249, 27.07200304450333, 45.546840181868475, 28.992364453743654, 11.12598262860156, 31.266668428423436, 8.30500780129584, 29.236491995038328, 27.00616651932702, 38.1107486581579, 34.6706626598896, 47.313869380265466, 31.37150764439528, 0.2795497758538332, 19.927816172710344, 20.193141010348878, 7.869211014373597, 10.253348229099066, 18.40604514248864, 36.275333634801235, 28.56547513525333, 17.36831131227762, 30.155848895454252, 28.120011347123114, 14.170882944795991, 18.388244572045426, 26.676524416027352, 18.555508109433383, 40.97288805864402, 17.650719086142963, 9.58766497966806, 22.491084206663764, 9.391841227925154, 16.223506780476068, 18.8657321422321, 24.084424935894976, 32.94195786619489, 36.25316466216225, 26.539293378391204, 25.52296271437199, 23.31572848314014, 23.373040769967076, 41.456693647704014, 14.563369788726089, 2.2485394402553016, 17.76130238210324], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.43797187448222, -24.73720383237062, -18.877483899574106, -20.417895171966865, -31.20000838285705, -3.950919587691654, -30.734469281373116, -32.794372061756505, -29.53658471262484, -28.45460440129291, -41.87714335017684, -23.016264291669494, -23.61791888276609, -16.475593528517077, -28.675077913437335, -17.427353793773616, -1.2284580891447048, -21.33230349994344, -5.330878497006305, -16.22395448002865, -28.751712169809164, -27.374054970524753, -20.24066403704517, -13.715529010425794, -25.652979326780464, -30.53751546340929, -24.288318312569636, -33.052950947303565, -36.413625039526515, -8.496866555702402, -9.3027538353032, -28.214000317487173, -27.917159553973075, -22.919021195952936, -47.80580153977941, -18.664563950572234, -33.9526844757954, -12.380246456545091, -22.31106352487471, -21.376194603508967, -41.99149513376327, -26.198534933682645, -26.49303430362117, -29.831547471196167, -29.812242785403527, -31.812530354576314, -9.874784790496363, -3.598277615630697, -20.302859492998717, -23.449563806644854, -28.488019388564982, -31.371891827920884, -22.20405254120059, -8.329282711547833, -32.87059639638246, -27.072003044503347, -45.54684018186842, -28.992364453743665, -11.125982628601564, -31.26666842842341, -8.305007801295833, -29.23649199503831, -27.00616651932699, -38.11074865815791, -34.67066265988967, -47.313869380265544, -31.37150764439531, -0.27954977585383567, -19.92781617271036, -20.193141010348857, -7.8692110143735885, -10.253348229099053, -18.406045142488658, -36.275333634801264, -28.565475135253344, -17.3683113122776, -30.155848895454227, -28.1200113471231, -14.170882944795977, -18.388244572045366, -26.67652441602736, -18.55550810943339, -40.97288805864401, -17.65071908614302, -9.587664979668043, -22.49108420666374, -9.391841227925145, -16.223506780476033, -18.86573214223207, -24.08442493589494, -32.941957866194926, -36.25316466216225, -26.539293378391186, -25.522962714372014, -23.315728483140113, -23.373040769967073, -41.45669364770399, -14.5633697887261, -2.24853944025529, -17.761302382103246], "policy_predator_policy_reward": [20.36369855945781, 16.512245189506622, 11.365372552863036, 38.10903511187822, 25.982135442452332, 11.772832356695858, 25.188041749152802, 15.647748594780907, 25.415047272686582, 36.98496949302748, 3.816407403996335, 4.085431771386989, 24.332470178214194, 37.13646838453201, 28.94911997146698, 36.639624152046025, 23.73727192016326, 35.335897505086436, 29.79680837172637, 27.112400430859473, 44.43879908431552, 39.315487616038155, 37.39386918087546, 8.638659402463537, 24.29979616338124, 22.936041602150937, 9.800871085868438, 23.150315971165668, 34.8095410624763, 22.540614764398303, 16.34549341242083, 18.50921417512638, -0.1596436824154095, 2.6165598607048306, 25.367241171177927, 17.297365828708948, 6.169856425031833, 4.491900568980772, 12.54706793922958, 19.900841020827723, 22.57443046022372, 34.92899387939458, 26.751810565737873, 27.996299375311608, 10.81997957500835, 29.66134849908193, 23.91103298403758, 3.5200250368140056, 36.116683381823485, 15.189275271737444, 24.89544520743611, 36.17958571938247, 10.257208968510579, 38.31942765662869, 28.447740236072086, 37.65816165853505, 42.206875529053754, 30.620374549999212, 8.221337749555955, 8.772395361848838, 12.233538465035224, 6.371969205571189, 21.570229002998175, 34.857771631976135, 22.8108712977429, 33.023447810203265, 31.640133568100946, 14.197908823804966, 54.1005994057982, 41.511003673760655, 15.259416996435927, 22.06971090470854, 33.52298881565798, 34.38238013593285, 21.72804009382663, 3.032452819263561, 13.365450063492332, 31.25667698625712, 3.550553781045102, 39.2018354259728, 35.46578783477953, 48.51720243274697, 45.458647132610956, 6.938422734754372, 23.647577543431815, 29.338491063810494, 34.75710731430735, 24.90598762808501, 18.676196185676616, 40.94828938513035, 34.18967701353965, 29.43538369561299, 3.0385449757604537, 16.711024605232282, 0.7676837365314562, 6.428871494729933, 11.571364531241311, 29.034354454756123, 30.24480397205814, 16.654323641231578, 14.69412456017078, 42.28191421695916, 30.788404036373393, 31.9553796194684, 24.18212580821788, 20.22597927418333, 9.851870236003034, 6.806695187092622, 18.7755572942163, 46.96563549854867, 24.141268383736676, 30.002737705270007, 44.93902612734866, 46.154654236388225, 22.482323862867993, 35.50240504461931, 1.3199170909585098, 20.932048166244613, 31.16058626271712, 31.37275059412972, 4.048357156197978, 12.561658446393695, 30.195504040151274, 28.277479949925347, 15.80298424311092, 38.20934879554306, 38.023703084689494, 38.19779423162631, 37.36561524669693, 31.97571007308238, 52.0359671822509, 42.59177157828011, 37.040697305954154, 25.702317982836462, 2.8874820811752997, -2.328382529467627, 7.887136047424868, 31.968496297995834, 32.46501618302119, 7.921265837676525, 17.094631682209453, -1.356209653462256, 15.894444933159873, 4.612251525038237, 9.199203058062118, 27.612887226915188, 32.786253616838096, 39.76441365276446, 15.298578869572307, 41.83237140093441, 32.18047440269224, 2.556148221862971, 33.49752571283743, 26.814172078071042, 21.74566491886715, 34.494357775379044, 22.466062683916096, 5.8757032056758245, 23.462757063742774, 13.313732080348009, 29.950461793330085, 23.402587038724647, 27.8542987427921, 9.256717476074687, 45.39545184998177, 36.55032426730629, 4.611944828940508, 30.689493343345433, 3.0533976101478872, 16.121932349188207, 32.79572739415301, 12.186441019174495, 15.002568103796074, 3.781114352054222, 30.227516646685405, 2.2194969142666796, 17.01832554041408, 20.713138744050084, 25.41857007992039, 22.750279791869527, 32.82567469919874, 33.058241033191116, 34.633199874184314, 37.873129450140205, 20.761096808998996, 32.31748994778334, 6.664253332085161, 44.38167209665889, 42.93214480554703, 3.699312160733222, 30.13694178764771, 16.60913975228638, 37.173480365367816, 45.73990693004022, 4.944365220813894, 24.182374356638313, 6.94210335159284, -2.4450244710822684, 30.2016503525846, 5.3209544116218925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6321537064212365, "mean_inference_ms": 1.6423682599084792, "mean_action_processing_ms": 0.25856624036724085, "mean_env_wait_ms": 0.14684267164824744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007073640823364258, "StateBufferConnector_ms": 0.003481149673461914, "ViewRequirementAgentConnector_ms": 0.13033413887023926}, "num_episodes": 27, "episode_return_max": 47.80580153977942, "episode_return_min": 0.2795497758538332, "episode_return_mean": 23.528103580312322, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.47220396278175, "num_env_steps_trained_throughput_per_sec": 353.47220396278175, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 11182.896, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11182.653, "sample_time_ms": 1255.125, "learn_time_ms": 9904.636, "learn_throughput": 403.851, "synch_weights_time_ms": 18.146}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 23, "trial_id": "06536_00000", "date": "2024-08-11_16-38-35", "timestamp": 1723408715, "time_this_iter_s": 11.417480945587158, "time_total_s": 261.03028774261475, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb0040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 261.03028774261475, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 52.0, "ram_util_percent": 82.29411764705881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2210414581932127, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1889836189957956, "policy_loss": -0.009944160490219171, "vf_loss": 1.1986215628994008, "vf_explained_var": 0.8636223807930946, "kl": 0.012248532328363156, "entropy": 1.2459583397954703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2968232873570984, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8663456988870782, "policy_loss": -0.0020699924235318408, "vf_loss": 0.8683914268458331, "vf_explained_var": 0.9708560453205513, "kl": 0.0038823506284881575, "entropy": 0.7312582474536997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 47.80580153977942, "episode_reward_min": 0.2795497758538332, "episode_reward_mean": 22.988718014615365, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.80580153977941, "predator_policy": -3.7193604996137286}, "policy_reward_max": {"prey_policy": -0.27954977585383567, "predator_policy": 54.1005994057982}, "policy_reward_mean": {"prey_policy": -22.988718014615362, "predator_policy": 22.988718014615362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.3308784970063, 16.22395448002866, 28.75171216980918, 27.374054970524732, 20.240664037045136, 13.71552901042579, 25.652979326780443, 30.537515463409314, 24.288318312569594, 33.05295094730355, 36.4136250395265, 8.49686655570239, 9.302753835303205, 28.214000317487194, 27.917159553973097, 22.919021195952908, 47.80580153977942, 18.664563950572262, 33.952684475795415, 12.380246456545132, 22.31106352487476, 21.376194603508992, 41.99149513376323, 26.198534933682676, 26.493034303621137, 29.831547471196163, 29.812242785403534, 31.812530354576317, 9.874784790496362, 3.598277615630704, 20.30285949299874, 23.449563806644868, 28.488019388564997, 31.371891827920958, 22.20405254120062, 8.32928271154782, 32.87059639638249, 27.07200304450333, 45.546840181868475, 28.992364453743654, 11.12598262860156, 31.266668428423436, 8.30500780129584, 29.236491995038328, 27.00616651932702, 38.1107486581579, 34.6706626598896, 47.313869380265466, 31.37150764439528, 0.2795497758538332, 19.927816172710344, 20.193141010348878, 7.869211014373597, 10.253348229099066, 18.40604514248864, 36.275333634801235, 28.56547513525333, 17.36831131227762, 30.155848895454252, 28.120011347123114, 14.170882944795991, 18.388244572045426, 26.676524416027352, 18.555508109433383, 40.97288805864402, 17.650719086142963, 9.58766497966806, 22.491084206663764, 9.391841227925154, 16.223506780476068, 18.8657321422321, 24.084424935894976, 32.94195786619489, 36.25316466216225, 26.539293378391204, 25.52296271437199, 23.31572848314014, 23.373040769967076, 41.456693647704014, 14.563369788726089, 2.2485394402553016, 17.76130238210324, 9.675490287018931, 36.112391440748766, 22.209445719304764, 15.302380522485873, 35.42095535919604, 27.44160452777952, 33.1023344956495, 11.894562388032686, 12.36804734877784, 27.22182606681169, 12.13749510009619, 29.093307123648405, 16.014213848698557, 10.474285181321129, 9.182109687330996, 18.74305210873215, 4.812804025597366, 27.64676475449239], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.330878497006305, -16.22395448002865, -28.751712169809164, -27.374054970524753, -20.24066403704517, -13.715529010425794, -25.652979326780464, -30.53751546340929, -24.288318312569636, -33.052950947303565, -36.413625039526515, -8.496866555702402, -9.3027538353032, -28.214000317487173, -27.917159553973075, -22.919021195952936, -47.80580153977941, -18.664563950572234, -33.9526844757954, -12.380246456545091, -22.31106352487471, -21.376194603508967, -41.99149513376327, -26.198534933682645, -26.49303430362117, -29.831547471196167, -29.812242785403527, -31.812530354576314, -9.874784790496363, -3.598277615630697, -20.302859492998717, -23.449563806644854, -28.488019388564982, -31.371891827920884, -22.20405254120059, -8.329282711547833, -32.87059639638246, -27.072003044503347, -45.54684018186842, -28.992364453743665, -11.125982628601564, -31.26666842842341, -8.305007801295833, -29.23649199503831, -27.00616651932699, -38.11074865815791, -34.67066265988967, -47.313869380265544, -31.37150764439531, -0.27954977585383567, -19.92781617271036, -20.193141010348857, -7.8692110143735885, -10.253348229099053, -18.406045142488658, -36.275333634801264, -28.565475135253344, -17.3683113122776, -30.155848895454227, -28.1200113471231, -14.170882944795977, -18.388244572045366, -26.67652441602736, -18.55550810943339, -40.97288805864401, -17.65071908614302, -9.587664979668043, -22.49108420666374, -9.391841227925145, -16.223506780476033, -18.86573214223207, -24.08442493589494, -32.941957866194926, -36.25316466216225, -26.539293378391186, -25.522962714372014, -23.315728483140113, -23.373040769967073, -41.45669364770399, -14.5633697887261, -2.24853944025529, -17.761302382103246, -9.675490287018931, -36.11239144074879, -22.209445719304767, -15.302380522485862, -35.420955359196064, -27.44160452777949, -33.102334495649465, -11.89456238803267, -12.368047348777825, -27.221826066811705, -12.137495100096189, -29.09330712364839, -16.014213848698553, -10.474285181321136, -9.182109687331007, -18.743052108732147, -4.81280402559738, -27.646764754492416], "policy_predator_policy_reward": [6.169856425031833, 4.491900568980772, 12.54706793922958, 19.900841020827723, 22.57443046022372, 34.92899387939458, 26.751810565737873, 27.996299375311608, 10.81997957500835, 29.66134849908193, 23.91103298403758, 3.5200250368140056, 36.116683381823485, 15.189275271737444, 24.89544520743611, 36.17958571938247, 10.257208968510579, 38.31942765662869, 28.447740236072086, 37.65816165853505, 42.206875529053754, 30.620374549999212, 8.221337749555955, 8.772395361848838, 12.233538465035224, 6.371969205571189, 21.570229002998175, 34.857771631976135, 22.8108712977429, 33.023447810203265, 31.640133568100946, 14.197908823804966, 54.1005994057982, 41.511003673760655, 15.259416996435927, 22.06971090470854, 33.52298881565798, 34.38238013593285, 21.72804009382663, 3.032452819263561, 13.365450063492332, 31.25667698625712, 3.550553781045102, 39.2018354259728, 35.46578783477953, 48.51720243274697, 45.458647132610956, 6.938422734754372, 23.647577543431815, 29.338491063810494, 34.75710731430735, 24.90598762808501, 18.676196185676616, 40.94828938513035, 34.18967701353965, 29.43538369561299, 3.0385449757604537, 16.711024605232282, 0.7676837365314562, 6.428871494729933, 11.571364531241311, 29.034354454756123, 30.24480397205814, 16.654323641231578, 14.69412456017078, 42.28191421695916, 30.788404036373393, 31.9553796194684, 24.18212580821788, 20.22597927418333, 9.851870236003034, 6.806695187092622, 18.7755572942163, 46.96563549854867, 24.141268383736676, 30.002737705270007, 44.93902612734866, 46.154654236388225, 22.482323862867993, 35.50240504461931, 1.3199170909585098, 20.932048166244613, 31.16058626271712, 31.37275059412972, 4.048357156197978, 12.561658446393695, 30.195504040151274, 28.277479949925347, 15.80298424311092, 38.20934879554306, 38.023703084689494, 38.19779423162631, 37.36561524669693, 31.97571007308238, 52.0359671822509, 42.59177157828011, 37.040697305954154, 25.702317982836462, 2.8874820811752997, -2.328382529467627, 7.887136047424868, 31.968496297995834, 32.46501618302119, 7.921265837676525, 17.094631682209453, -1.356209653462256, 15.894444933159873, 4.612251525038237, 9.199203058062118, 27.612887226915188, 32.786253616838096, 39.76441365276446, 15.298578869572307, 41.83237140093441, 32.18047440269224, 2.556148221862971, 33.49752571283743, 26.814172078071042, 21.74566491886715, 34.494357775379044, 22.466062683916096, 5.8757032056758245, 23.462757063742774, 13.313732080348009, 29.950461793330085, 23.402587038724647, 27.8542987427921, 9.256717476074687, 45.39545184998177, 36.55032426730629, 4.611944828940508, 30.689493343345433, 3.0533976101478872, 16.121932349188207, 32.79572739415301, 12.186441019174495, 15.002568103796074, 3.781114352054222, 30.227516646685405, 2.2194969142666796, 17.01832554041408, 20.713138744050084, 25.41857007992039, 22.750279791869527, 32.82567469919874, 33.058241033191116, 34.633199874184314, 37.873129450140205, 20.761096808998996, 32.31748994778334, 6.664253332085161, 44.38167209665889, 42.93214480554703, 3.699312160733222, 30.13694178764771, 16.60913975228638, 37.173480365367816, 45.73990693004022, 4.944365220813894, 24.182374356638313, 6.94210335159284, -2.4450244710822684, 30.2016503525846, 5.3209544116218925, -0.4662691638583205, 19.817249737896155, 43.20690972678405, 29.017873154713534, 27.108373929206422, 17.3105175094031, 16.109881167064867, 14.494879877906829, 29.865675259798927, 40.97623545859317, 25.69822786827857, 29.18498118728042, 40.192911824136196, 26.011757167162756, 22.957771762651106, 0.8313530134142377, 17.303752880067265, 7.4323418174883855, 39.326774040336424, 15.116878093286985, 12.87427462274242, 11.400715577449976, 42.21189999826907, 15.974714249027716, 23.50056056426439, 8.527867133132663, 15.859471684649787, 5.089098677992487, 2.451624430442255, 15.912594944219752, 20.63165045770529, 16.854453759758997, 13.34496855080848, -3.7193604996137286, 26.06163483748949, 29.231894671495297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6308409761698344, "mean_inference_ms": 1.633468539072049, "mean_action_processing_ms": 0.2569174883036141, "mean_env_wait_ms": 0.14621815867551075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068558454513549805, "StateBufferConnector_ms": 0.0033103227615356445, "ViewRequirementAgentConnector_ms": 0.1248854398727417}, "num_episodes": 18, "episode_return_max": 47.80580153977942, "episode_return_min": 0.2795497758538332, "episode_return_mean": 22.988718014615365, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.6315149670022, "num_env_steps_trained_throughput_per_sec": 393.6315149670022, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 11066.058, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11065.794, "sample_time_ms": 1196.578, "learn_time_ms": 9845.481, "learn_throughput": 406.278, "synch_weights_time_ms": 18.793}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 24, "trial_id": "06536_00000", "date": "2024-08-11_16-38-45", "timestamp": 1723408725, "time_this_iter_s": 10.216612100601196, "time_total_s": 271.24689984321594, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331618a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 271.24689984321594, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 46.66428571428571, "ram_util_percent": 82.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8682859478518368, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4718446507739524, "policy_loss": -0.008352082982795158, "vf_loss": 1.4800101824725667, "vf_explained_var": 0.9272713728869955, "kl": 0.007462061249818074, "entropy": 1.1771391039093335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7250487031129302, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1019292693920237, "policy_loss": -0.004081163266378026, "vf_loss": 1.1059958410326136, "vf_explained_var": 0.9718924515146427, "kl": 0.004669137325087141, "entropy": 0.7241118764435803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 47.313869380265466, "episode_reward_min": 0.2795497758538332, "episode_reward_mean": 22.611392821069554, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.313869380265544, "predator_policy": -3.7193604996137286}, "policy_reward_max": {"prey_policy": -0.27954977585383567, "predator_policy": 52.0359671822509}, "policy_reward_mean": {"prey_policy": -22.611392821069543, "predator_policy": 22.611392821069543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.952684475795415, 12.380246456545132, 22.31106352487476, 21.376194603508992, 41.99149513376323, 26.198534933682676, 26.493034303621137, 29.831547471196163, 29.812242785403534, 31.812530354576317, 9.874784790496362, 3.598277615630704, 20.30285949299874, 23.449563806644868, 28.488019388564997, 31.371891827920958, 22.20405254120062, 8.32928271154782, 32.87059639638249, 27.07200304450333, 45.546840181868475, 28.992364453743654, 11.12598262860156, 31.266668428423436, 8.30500780129584, 29.236491995038328, 27.00616651932702, 38.1107486581579, 34.6706626598896, 47.313869380265466, 31.37150764439528, 0.2795497758538332, 19.927816172710344, 20.193141010348878, 7.869211014373597, 10.253348229099066, 18.40604514248864, 36.275333634801235, 28.56547513525333, 17.36831131227762, 30.155848895454252, 28.120011347123114, 14.170882944795991, 18.388244572045426, 26.676524416027352, 18.555508109433383, 40.97288805864402, 17.650719086142963, 9.58766497966806, 22.491084206663764, 9.391841227925154, 16.223506780476068, 18.8657321422321, 24.084424935894976, 32.94195786619489, 36.25316466216225, 26.539293378391204, 25.52296271437199, 23.31572848314014, 23.373040769967076, 41.456693647704014, 14.563369788726089, 2.2485394402553016, 17.76130238210324, 9.675490287018931, 36.112391440748766, 22.209445719304764, 15.302380522485873, 35.42095535919604, 27.44160452777952, 33.1023344956495, 11.894562388032686, 12.36804734877784, 27.22182606681169, 12.13749510009619, 29.093307123648405, 16.014213848698557, 10.474285181321129, 9.182109687330996, 18.74305210873215, 4.812804025597366, 27.64676475449239, 29.29237906801568, 32.76089606883165, 10.537084826211355, 20.974056692791656, 27.540978749488243, 21.22563347261024, 20.271638025524588, 18.71711098771538, 5.723496465744033, 28.040859406635924, 7.526714393342494, 17.710429023972164, 35.485515204622835, 19.844272607767195, 25.566201373877416, 14.814733866362253, 30.483376062883764, 20.654453552221064], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-33.9526844757954, -12.380246456545091, -22.31106352487471, -21.376194603508967, -41.99149513376327, -26.198534933682645, -26.49303430362117, -29.831547471196167, -29.812242785403527, -31.812530354576314, -9.874784790496363, -3.598277615630697, -20.302859492998717, -23.449563806644854, -28.488019388564982, -31.371891827920884, -22.20405254120059, -8.329282711547833, -32.87059639638246, -27.072003044503347, -45.54684018186842, -28.992364453743665, -11.125982628601564, -31.26666842842341, -8.305007801295833, -29.23649199503831, -27.00616651932699, -38.11074865815791, -34.67066265988967, -47.313869380265544, -31.37150764439531, -0.27954977585383567, -19.92781617271036, -20.193141010348857, -7.8692110143735885, -10.253348229099053, -18.406045142488658, -36.275333634801264, -28.565475135253344, -17.3683113122776, -30.155848895454227, -28.1200113471231, -14.170882944795977, -18.388244572045366, -26.67652441602736, -18.55550810943339, -40.97288805864401, -17.65071908614302, -9.587664979668043, -22.49108420666374, -9.391841227925145, -16.223506780476033, -18.86573214223207, -24.08442493589494, -32.941957866194926, -36.25316466216225, -26.539293378391186, -25.522962714372014, -23.315728483140113, -23.373040769967073, -41.45669364770399, -14.5633697887261, -2.24853944025529, -17.761302382103246, -9.675490287018931, -36.11239144074879, -22.209445719304767, -15.302380522485862, -35.420955359196064, -27.44160452777949, -33.102334495649465, -11.89456238803267, -12.368047348777825, -27.221826066811705, -12.137495100096189, -29.09330712364839, -16.014213848698553, -10.474285181321136, -9.182109687331007, -18.743052108732147, -4.81280402559738, -27.646764754492416, -29.292379068015688, -32.76089606883159, -10.537084826211355, -20.974056692791613, -27.540978749488087, -21.22563347261027, -20.27163802552457, -18.717110987715454, -5.723496465744039, -28.04085940663587, -7.52671439334248, -17.710429023972157, -35.485515204622814, -19.844272607767202, -25.566201373877433, -14.814733866362262, -30.483376062883764, -20.654453552221057], "policy_predator_policy_reward": [33.52298881565798, 34.38238013593285, 21.72804009382663, 3.032452819263561, 13.365450063492332, 31.25667698625712, 3.550553781045102, 39.2018354259728, 35.46578783477953, 48.51720243274697, 45.458647132610956, 6.938422734754372, 23.647577543431815, 29.338491063810494, 34.75710731430735, 24.90598762808501, 18.676196185676616, 40.94828938513035, 34.18967701353965, 29.43538369561299, 3.0385449757604537, 16.711024605232282, 0.7676837365314562, 6.428871494729933, 11.571364531241311, 29.034354454756123, 30.24480397205814, 16.654323641231578, 14.69412456017078, 42.28191421695916, 30.788404036373393, 31.9553796194684, 24.18212580821788, 20.22597927418333, 9.851870236003034, 6.806695187092622, 18.7755572942163, 46.96563549854867, 24.141268383736676, 30.002737705270007, 44.93902612734866, 46.154654236388225, 22.482323862867993, 35.50240504461931, 1.3199170909585098, 20.932048166244613, 31.16058626271712, 31.37275059412972, 4.048357156197978, 12.561658446393695, 30.195504040151274, 28.277479949925347, 15.80298424311092, 38.20934879554306, 38.023703084689494, 38.19779423162631, 37.36561524669693, 31.97571007308238, 52.0359671822509, 42.59177157828011, 37.040697305954154, 25.702317982836462, 2.8874820811752997, -2.328382529467627, 7.887136047424868, 31.968496297995834, 32.46501618302119, 7.921265837676525, 17.094631682209453, -1.356209653462256, 15.894444933159873, 4.612251525038237, 9.199203058062118, 27.612887226915188, 32.786253616838096, 39.76441365276446, 15.298578869572307, 41.83237140093441, 32.18047440269224, 2.556148221862971, 33.49752571283743, 26.814172078071042, 21.74566491886715, 34.494357775379044, 22.466062683916096, 5.8757032056758245, 23.462757063742774, 13.313732080348009, 29.950461793330085, 23.402587038724647, 27.8542987427921, 9.256717476074687, 45.39545184998177, 36.55032426730629, 4.611944828940508, 30.689493343345433, 3.0533976101478872, 16.121932349188207, 32.79572739415301, 12.186441019174495, 15.002568103796074, 3.781114352054222, 30.227516646685405, 2.2194969142666796, 17.01832554041408, 20.713138744050084, 25.41857007992039, 22.750279791869527, 32.82567469919874, 33.058241033191116, 34.633199874184314, 37.873129450140205, 20.761096808998996, 32.31748994778334, 6.664253332085161, 44.38167209665889, 42.93214480554703, 3.699312160733222, 30.13694178764771, 16.60913975228638, 37.173480365367816, 45.73990693004022, 4.944365220813894, 24.182374356638313, 6.94210335159284, -2.4450244710822684, 30.2016503525846, 5.3209544116218925, -0.4662691638583205, 19.817249737896155, 43.20690972678405, 29.017873154713534, 27.108373929206422, 17.3105175094031, 16.109881167064867, 14.494879877906829, 29.865675259798927, 40.97623545859317, 25.69822786827857, 29.18498118728042, 40.192911824136196, 26.011757167162756, 22.957771762651106, 0.8313530134142377, 17.303752880067265, 7.4323418174883855, 39.326774040336424, 15.116878093286985, 12.87427462274242, 11.400715577449976, 42.21189999826907, 15.974714249027716, 23.50056056426439, 8.527867133132663, 15.859471684649787, 5.089098677992487, 2.451624430442255, 15.912594944219752, 20.63165045770529, 16.854453759758997, 13.34496855080848, -3.7193604996137286, 26.06163483748949, 29.231894671495297, 33.008528092594744, 25.576230043436617, 23.511677146260613, 42.010114991402574, 4.483995955358527, 16.590173697064188, 24.91363906824504, 17.034474317338216, 26.107010650796546, 28.974946848179773, 16.75874982649716, 25.692517118723345, 19.844356714385288, 20.698919336663902, 26.71681041578076, 10.717411559650094, 3.220021363950224, 8.226971567537852, 29.787595107800097, 26.29412370547167, -3.3814082987234384, 18.434837085408414, 8.027451374777954, 27.393406673166364, 28.87394456346748, 42.097085845778125, 28.40191047680295, 11.28663473873146, 36.908109385305224, 14.224293362449611, 19.09521534270738, 10.534252390017173, 36.369913460326515, 24.596838665441, 16.99520039279949, 24.313706711642645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6280948673490127, "mean_inference_ms": 1.6239061715234815, "mean_action_processing_ms": 0.2556270755417137, "mean_env_wait_ms": 0.1454133154900408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006918787956237793, "StateBufferConnector_ms": 0.0032089948654174805, "ViewRequirementAgentConnector_ms": 0.12190032005310059}, "num_episodes": 18, "episode_return_max": 47.313869380265466, "episode_return_min": 0.2795497758538332, "episode_return_mean": 22.611392821069554, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.5174285131045, "num_env_steps_trained_throughput_per_sec": 376.5174285131045, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 10978.659, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10978.392, "sample_time_ms": 1159.73, "learn_time_ms": 9794.974, "learn_throughput": 408.373, "synch_weights_time_ms": 18.74}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 25, "trial_id": "06536_00000", "date": "2024-08-11_16-38-56", "timestamp": 1723408736, "time_this_iter_s": 10.666177034378052, "time_total_s": 281.913076877594, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fea8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 281.913076877594, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 49.22666666666667, "ram_util_percent": 82.50666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.015936882421374, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9062211070209742, "policy_loss": -0.005875821182659517, "vf_loss": 1.911904307330648, "vf_explained_var": 0.8443566024303436, "kl": 0.007704826960320844, "entropy": 1.11124246524026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.02812766924737, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.565005657944099, "policy_loss": -0.005186555584986255, "vf_loss": 1.570178494976942, "vf_explained_var": 0.9409795066666982, "kl": 0.008778791602178674, "entropy": 0.6903334956951243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 47.313869380265466, "episode_reward_min": -2.9716542025849932, "episode_reward_mean": 21.980888015677806, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.313869380265544, "predator_policy": -4.322208341735088}, "policy_reward_max": {"prey_policy": 2.9716542025850003, "predator_policy": 52.0359671822509}, "policy_reward_mean": {"prey_policy": -21.98088801567781, "predator_policy": 21.980888015677806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.87059639638249, 27.07200304450333, 45.546840181868475, 28.992364453743654, 11.12598262860156, 31.266668428423436, 8.30500780129584, 29.236491995038328, 27.00616651932702, 38.1107486581579, 34.6706626598896, 47.313869380265466, 31.37150764439528, 0.2795497758538332, 19.927816172710344, 20.193141010348878, 7.869211014373597, 10.253348229099066, 18.40604514248864, 36.275333634801235, 28.56547513525333, 17.36831131227762, 30.155848895454252, 28.120011347123114, 14.170882944795991, 18.388244572045426, 26.676524416027352, 18.555508109433383, 40.97288805864402, 17.650719086142963, 9.58766497966806, 22.491084206663764, 9.391841227925154, 16.223506780476068, 18.8657321422321, 24.084424935894976, 32.94195786619489, 36.25316466216225, 26.539293378391204, 25.52296271437199, 23.31572848314014, 23.373040769967076, 41.456693647704014, 14.563369788726089, 2.2485394402553016, 17.76130238210324, 9.675490287018931, 36.112391440748766, 22.209445719304764, 15.302380522485873, 35.42095535919604, 27.44160452777952, 33.1023344956495, 11.894562388032686, 12.36804734877784, 27.22182606681169, 12.13749510009619, 29.093307123648405, 16.014213848698557, 10.474285181321129, 9.182109687330996, 18.74305210873215, 4.812804025597366, 27.64676475449239, 29.29237906801568, 32.76089606883165, 10.537084826211355, 20.974056692791656, 27.540978749488243, 21.22563347261024, 20.271638025524588, 18.71711098771538, 5.723496465744033, 28.040859406635924, 7.526714393342494, 17.710429023972164, 35.485515204622835, 19.844272607767195, 25.566201373877416, 14.814733866362253, 30.483376062883764, 20.654453552221064, 14.21268416659088, 16.099389945017037, 30.914249779354403, -2.9716542025849932, 15.351689593881233, 20.32541732997398, 39.77040463334739, 16.80660001172174, 15.22942811103411, 36.78511692274104, 27.198612600276256, 15.39779661438693, 27.47108301321261, 18.77330192230361, 25.991037141855895, 20.937613285971306, 17.114005719857253, 5.321049089857569], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.87059639638246, -27.072003044503347, -45.54684018186842, -28.992364453743665, -11.125982628601564, -31.26666842842341, -8.305007801295833, -29.23649199503831, -27.00616651932699, -38.11074865815791, -34.67066265988967, -47.313869380265544, -31.37150764439531, -0.27954977585383567, -19.92781617271036, -20.193141010348857, -7.8692110143735885, -10.253348229099053, -18.406045142488658, -36.275333634801264, -28.565475135253344, -17.3683113122776, -30.155848895454227, -28.1200113471231, -14.170882944795977, -18.388244572045366, -26.67652441602736, -18.55550810943339, -40.97288805864401, -17.65071908614302, -9.587664979668043, -22.49108420666374, -9.391841227925145, -16.223506780476033, -18.86573214223207, -24.08442493589494, -32.941957866194926, -36.25316466216225, -26.539293378391186, -25.522962714372014, -23.315728483140113, -23.373040769967073, -41.45669364770399, -14.5633697887261, -2.24853944025529, -17.761302382103246, -9.675490287018931, -36.11239144074879, -22.209445719304767, -15.302380522485862, -35.420955359196064, -27.44160452777949, -33.102334495649465, -11.89456238803267, -12.368047348777825, -27.221826066811705, -12.137495100096189, -29.09330712364839, -16.014213848698553, -10.474285181321136, -9.182109687331007, -18.743052108732147, -4.81280402559738, -27.646764754492416, -29.292379068015688, -32.76089606883159, -10.537084826211355, -20.974056692791613, -27.540978749488087, -21.22563347261027, -20.27163802552457, -18.717110987715454, -5.723496465744039, -28.04085940663587, -7.52671439334248, -17.710429023972157, -35.485515204622814, -19.844272607767202, -25.566201373877433, -14.814733866362262, -30.483376062883764, -20.654453552221057, -14.212684166590877, -16.099389945017016, -30.914249779354446, 2.9716542025850003, -15.351689593881213, -20.32541732997402, -39.77040463334746, -16.806600011721734, -15.229428111034109, -36.78511692274097, -27.19861260027625, -15.397796614386962, -27.471083013212592, -18.77330192230362, -25.99103714185589, -20.937613285971366, -17.114005719857236, -5.321049089857566], "policy_predator_policy_reward": [18.7755572942163, 46.96563549854867, 24.141268383736676, 30.002737705270007, 44.93902612734866, 46.154654236388225, 22.482323862867993, 35.50240504461931, 1.3199170909585098, 20.932048166244613, 31.16058626271712, 31.37275059412972, 4.048357156197978, 12.561658446393695, 30.195504040151274, 28.277479949925347, 15.80298424311092, 38.20934879554306, 38.023703084689494, 38.19779423162631, 37.36561524669693, 31.97571007308238, 52.0359671822509, 42.59177157828011, 37.040697305954154, 25.702317982836462, 2.8874820811752997, -2.328382529467627, 7.887136047424868, 31.968496297995834, 32.46501618302119, 7.921265837676525, 17.094631682209453, -1.356209653462256, 15.894444933159873, 4.612251525038237, 9.199203058062118, 27.612887226915188, 32.786253616838096, 39.76441365276446, 15.298578869572307, 41.83237140093441, 32.18047440269224, 2.556148221862971, 33.49752571283743, 26.814172078071042, 21.74566491886715, 34.494357775379044, 22.466062683916096, 5.8757032056758245, 23.462757063742774, 13.313732080348009, 29.950461793330085, 23.402587038724647, 27.8542987427921, 9.256717476074687, 45.39545184998177, 36.55032426730629, 4.611944828940508, 30.689493343345433, 3.0533976101478872, 16.121932349188207, 32.79572739415301, 12.186441019174495, 15.002568103796074, 3.781114352054222, 30.227516646685405, 2.2194969142666796, 17.01832554041408, 20.713138744050084, 25.41857007992039, 22.750279791869527, 32.82567469919874, 33.058241033191116, 34.633199874184314, 37.873129450140205, 20.761096808998996, 32.31748994778334, 6.664253332085161, 44.38167209665889, 42.93214480554703, 3.699312160733222, 30.13694178764771, 16.60913975228638, 37.173480365367816, 45.73990693004022, 4.944365220813894, 24.182374356638313, 6.94210335159284, -2.4450244710822684, 30.2016503525846, 5.3209544116218925, -0.4662691638583205, 19.817249737896155, 43.20690972678405, 29.017873154713534, 27.108373929206422, 17.3105175094031, 16.109881167064867, 14.494879877906829, 29.865675259798927, 40.97623545859317, 25.69822786827857, 29.18498118728042, 40.192911824136196, 26.011757167162756, 22.957771762651106, 0.8313530134142377, 17.303752880067265, 7.4323418174883855, 39.326774040336424, 15.116878093286985, 12.87427462274242, 11.400715577449976, 42.21189999826907, 15.974714249027716, 23.50056056426439, 8.527867133132663, 15.859471684649787, 5.089098677992487, 2.451624430442255, 15.912594944219752, 20.63165045770529, 16.854453759758997, 13.34496855080848, -3.7193604996137286, 26.06163483748949, 29.231894671495297, 33.008528092594744, 25.576230043436617, 23.511677146260613, 42.010114991402574, 4.483995955358527, 16.590173697064188, 24.91363906824504, 17.034474317338216, 26.107010650796546, 28.974946848179773, 16.75874982649716, 25.692517118723345, 19.844356714385288, 20.698919336663902, 26.71681041578076, 10.717411559650094, 3.220021363950224, 8.226971567537852, 29.787595107800097, 26.29412370547167, -3.3814082987234384, 18.434837085408414, 8.027451374777954, 27.393406673166364, 28.87394456346748, 42.097085845778125, 28.40191047680295, 11.28663473873146, 36.908109385305224, 14.224293362449611, 19.09521534270738, 10.534252390017173, 36.369913460326515, 24.596838665441, 16.99520039279949, 24.313706711642645, 19.464904370713814, 8.960463962467955, 20.923772846817087, 11.275007043216972, 19.39275444856009, 42.435745110148744, -1.6211000634349038, -4.322208341735088, 25.557040941560565, 5.1463382462018865, 18.947890483481505, 21.702944176466517, 45.496411681979, 34.044397584715895, 25.38393554601425, 8.22926447742919, 15.65036437891681, 14.808491843151405, 36.74094306208953, 36.829290783392466, 28.511747544955078, 25.885477655597438, 16.03173351088536, 14.763859717888518, 28.248688233991306, 26.69347779243389, 16.363893091436296, 21.182710753170905, 24.00409148601275, 27.97798279769903, 29.82047987386626, 12.054746698076432, 10.2920536791815, 23.935957760532986, 4.971770286301979, 5.670327893413155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6248864652695709, "mean_inference_ms": 1.614448877525482, "mean_action_processing_ms": 0.2542217306659857, "mean_env_wait_ms": 0.1443759167517609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006827592849731445, "StateBufferConnector_ms": 0.0027462244033813477, "ViewRequirementAgentConnector_ms": 0.09712350368499756}, "num_episodes": 18, "episode_return_max": 47.313869380265466, "episode_return_min": -2.9716542025849932, "episode_return_mean": 21.980888015677806, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 367.88953588450124, "num_env_steps_trained_throughput_per_sec": 367.88953588450124, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 10944.028, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10943.761, "sample_time_ms": 1191.217, "learn_time_ms": 9728.617, "learn_throughput": 411.158, "synch_weights_time_ms": 18.971}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 26, "trial_id": "06536_00000", "date": "2024-08-11_16-39-07", "timestamp": 1723408747, "time_this_iter_s": 10.920236110687256, "time_total_s": 292.83331298828125, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 292.83331298828125, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 46.78125, "ram_util_percent": 82.62499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2858262694130342, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1319080149134, "policy_loss": -0.010755631506617647, "vf_loss": 2.142364331210653, "vf_explained_var": 0.9354377162953218, "kl": 0.011972490940396815, "entropy": 0.9970628015076121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4933846200900103, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0045360876769616, "policy_loss": -0.004023535582409413, "vf_loss": 2.0085495722356925, "vf_explained_var": 0.9620347406813707, "kl": 0.006433454874618499, "entropy": 0.6191936302595038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": 44.27134326151712, "episode_reward_min": -3.3851015310177353, "episode_reward_mean": 20.531252671658923, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.27134326151714, "predator_policy": -10.403283738107753}, "policy_reward_max": {"prey_policy": 3.3851015310177344, "predator_policy": 46.29198769684227}, "policy_reward_mean": {"prey_policy": -20.53125267165892, "predator_policy": 20.53125267165892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.155848895454252, 28.120011347123114, 14.170882944795991, 18.388244572045426, 26.676524416027352, 18.555508109433383, 40.97288805864402, 17.650719086142963, 9.58766497966806, 22.491084206663764, 9.391841227925154, 16.223506780476068, 18.8657321422321, 24.084424935894976, 32.94195786619489, 36.25316466216225, 26.539293378391204, 25.52296271437199, 23.31572848314014, 23.373040769967076, 41.456693647704014, 14.563369788726089, 2.2485394402553016, 17.76130238210324, 9.675490287018931, 36.112391440748766, 22.209445719304764, 15.302380522485873, 35.42095535919604, 27.44160452777952, 33.1023344956495, 11.894562388032686, 12.36804734877784, 27.22182606681169, 12.13749510009619, 29.093307123648405, 16.014213848698557, 10.474285181321129, 9.182109687330996, 18.74305210873215, 4.812804025597366, 27.64676475449239, 29.29237906801568, 32.76089606883165, 10.537084826211355, 20.974056692791656, 27.540978749488243, 21.22563347261024, 20.271638025524588, 18.71711098771538, 5.723496465744033, 28.040859406635924, 7.526714393342494, 17.710429023972164, 35.485515204622835, 19.844272607767195, 25.566201373877416, 14.814733866362253, 30.483376062883764, 20.654453552221064, 14.21268416659088, 16.099389945017037, 30.914249779354403, -2.9716542025849932, 15.351689593881233, 20.32541732997398, 39.77040463334739, 16.80660001172174, 15.22942811103411, 36.78511692274104, 27.198612600276256, 15.39779661438693, 27.47108301321261, 18.77330192230361, 25.991037141855895, 20.937613285971306, 17.114005719857253, 5.321049089857569, 22.529478232080333, 7.429673562590841, 44.27134326151712, 15.456899589070158, 22.47014474761109, 25.02699659764806, 15.462599462173571, 35.50972310300736, 32.85426722413608, 8.978959883944404, 20.76985438674079, 12.256838391173519, 11.177553777105606, 34.92975388247083, 22.144493252250488, -2.782460542445391, -3.3851015310177353, 25.471290186451355, 11.369212881796363, 0.9265941185590219, 29.096691336268137, 15.098801014078283], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.155848895454227, -28.1200113471231, -14.170882944795977, -18.388244572045366, -26.67652441602736, -18.55550810943339, -40.97288805864401, -17.65071908614302, -9.587664979668043, -22.49108420666374, -9.391841227925145, -16.223506780476033, -18.86573214223207, -24.08442493589494, -32.941957866194926, -36.25316466216225, -26.539293378391186, -25.522962714372014, -23.315728483140113, -23.373040769967073, -41.45669364770399, -14.5633697887261, -2.24853944025529, -17.761302382103246, -9.675490287018931, -36.11239144074879, -22.209445719304767, -15.302380522485862, -35.420955359196064, -27.44160452777949, -33.102334495649465, -11.89456238803267, -12.368047348777825, -27.221826066811705, -12.137495100096189, -29.09330712364839, -16.014213848698553, -10.474285181321136, -9.182109687331007, -18.743052108732147, -4.81280402559738, -27.646764754492416, -29.292379068015688, -32.76089606883159, -10.537084826211355, -20.974056692791613, -27.540978749488087, -21.22563347261027, -20.27163802552457, -18.717110987715454, -5.723496465744039, -28.04085940663587, -7.52671439334248, -17.710429023972157, -35.485515204622814, -19.844272607767202, -25.566201373877433, -14.814733866362262, -30.483376062883764, -20.654453552221057, -14.212684166590877, -16.099389945017016, -30.914249779354446, 2.9716542025850003, -15.351689593881213, -20.32541732997402, -39.77040463334746, -16.806600011721734, -15.229428111034109, -36.78511692274097, -27.19861260027625, -15.397796614386962, -27.471083013212592, -18.77330192230362, -25.99103714185589, -20.937613285971366, -17.114005719857236, -5.321049089857566, -22.529478232080354, -7.42967356259084, -44.27134326151714, -15.456899589070156, -22.47014474761105, -25.026996597648075, -15.462599462173571, -35.50972310300736, -32.85426722413612, -8.978959883944423, -20.769854386740818, -12.256838391173527, -11.177553777105626, -34.92975388247081, -22.144493252250463, 2.7824605424454028, 3.3851015310177344, -25.47129018645136, -11.36921288179638, -0.926594118559021, -29.09669133626814, -15.098801014078244], "policy_predator_policy_reward": [33.49752571283743, 26.814172078071042, 21.74566491886715, 34.494357775379044, 22.466062683916096, 5.8757032056758245, 23.462757063742774, 13.313732080348009, 29.950461793330085, 23.402587038724647, 27.8542987427921, 9.256717476074687, 45.39545184998177, 36.55032426730629, 4.611944828940508, 30.689493343345433, 3.0533976101478872, 16.121932349188207, 32.79572739415301, 12.186441019174495, 15.002568103796074, 3.781114352054222, 30.227516646685405, 2.2194969142666796, 17.01832554041408, 20.713138744050084, 25.41857007992039, 22.750279791869527, 32.82567469919874, 33.058241033191116, 34.633199874184314, 37.873129450140205, 20.761096808998996, 32.31748994778334, 6.664253332085161, 44.38167209665889, 42.93214480554703, 3.699312160733222, 30.13694178764771, 16.60913975228638, 37.173480365367816, 45.73990693004022, 4.944365220813894, 24.182374356638313, 6.94210335159284, -2.4450244710822684, 30.2016503525846, 5.3209544116218925, -0.4662691638583205, 19.817249737896155, 43.20690972678405, 29.017873154713534, 27.108373929206422, 17.3105175094031, 16.109881167064867, 14.494879877906829, 29.865675259798927, 40.97623545859317, 25.69822786827857, 29.18498118728042, 40.192911824136196, 26.011757167162756, 22.957771762651106, 0.8313530134142377, 17.303752880067265, 7.4323418174883855, 39.326774040336424, 15.116878093286985, 12.87427462274242, 11.400715577449976, 42.21189999826907, 15.974714249027716, 23.50056056426439, 8.527867133132663, 15.859471684649787, 5.089098677992487, 2.451624430442255, 15.912594944219752, 20.63165045770529, 16.854453759758997, 13.34496855080848, -3.7193604996137286, 26.06163483748949, 29.231894671495297, 33.008528092594744, 25.576230043436617, 23.511677146260613, 42.010114991402574, 4.483995955358527, 16.590173697064188, 24.91363906824504, 17.034474317338216, 26.107010650796546, 28.974946848179773, 16.75874982649716, 25.692517118723345, 19.844356714385288, 20.698919336663902, 26.71681041578076, 10.717411559650094, 3.220021363950224, 8.226971567537852, 29.787595107800097, 26.29412370547167, -3.3814082987234384, 18.434837085408414, 8.027451374777954, 27.393406673166364, 28.87394456346748, 42.097085845778125, 28.40191047680295, 11.28663473873146, 36.908109385305224, 14.224293362449611, 19.09521534270738, 10.534252390017173, 36.369913460326515, 24.596838665441, 16.99520039279949, 24.313706711642645, 19.464904370713814, 8.960463962467955, 20.923772846817087, 11.275007043216972, 19.39275444856009, 42.435745110148744, -1.6211000634349038, -4.322208341735088, 25.557040941560565, 5.1463382462018865, 18.947890483481505, 21.702944176466517, 45.496411681979, 34.044397584715895, 25.38393554601425, 8.22926447742919, 15.65036437891681, 14.808491843151405, 36.74094306208953, 36.829290783392466, 28.511747544955078, 25.885477655597438, 16.03173351088536, 14.763859717888518, 28.248688233991306, 26.69347779243389, 16.363893091436296, 21.182710753170905, 24.00409148601275, 27.97798279769903, 29.82047987386626, 12.054746698076432, 10.2920536791815, 23.935957760532986, 4.971770286301979, 5.670327893413155, 17.453447396274246, 27.605509067886416, -0.1794809877981809, 15.038828112979873, 46.29198769684227, 42.250698826192, 9.606868351596967, 21.306930826543358, 20.544511044437293, 24.39577845078484, 29.4335955400818, 20.620397655214354, 13.421591994043398, 17.503606930303732, 34.2061060713183, 36.81334013469642, 31.910506213548313, 33.79802823472386, 1.3771264483189816, 16.580793319569864, 26.62417315777221, 14.915535615709388, 6.614684830909999, 17.89899195143706, 6.837811399991346, 15.51729615421987, 28.053129034282982, 41.80637873065857, 13.075830691029529, 31.213155813471417, -0.6606257590130786, -4.904295325877717, -10.403283738107753, 3.6330806760722822, 22.13372266210594, 28.808857710796744, 5.529773345160372, 17.2086524184324, -7.220732542584583, 9.073920779702627, 25.770476521170067, 32.42290615136622, 23.18041271066553, 7.017189317490946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6225322136585861, "mean_inference_ms": 1.608060721729005, "mean_action_processing_ms": 0.2533416990137525, "mean_env_wait_ms": 0.14352607325305328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005465388298034668, "StateBufferConnector_ms": 0.0027523040771484375, "ViewRequirementAgentConnector_ms": 0.09858560562133789}, "num_episodes": 22, "episode_return_max": 44.27134326151712, "episode_return_min": -3.3851015310177353, "episode_return_mean": 20.531252671658923, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.43866392161397, "num_env_steps_trained_throughput_per_sec": 368.43866392161397, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 10874.608, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10874.365, "sample_time_ms": 1184.9, "learn_time_ms": 9669.394, "learn_throughput": 413.676, "synch_weights_time_ms": 18.401}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 27, "trial_id": "06536_00000", "date": "2024-08-11_16-39-18", "timestamp": 1723408758, "time_this_iter_s": 10.90691089630127, "time_total_s": 303.7402238845825, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fea8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 303.7402238845825, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 49.593333333333334, "ram_util_percent": 82.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.098515306847791, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6272782540569704, "policy_loss": -0.009366473533251944, "vf_loss": 1.636433662970861, "vf_explained_var": 0.9160104641069968, "kl": 0.008442387183169024, "entropy": 0.9673464114467303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.107399216688499, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3775255465633656, "policy_loss": -0.00376121512017947, "vf_loss": 1.3812765634564497, "vf_explained_var": 0.9715874262272366, "kl": 0.006525718877000354, "entropy": 0.566899624388054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 44.27134326151712, "episode_reward_min": -3.3851015310177353, "episode_reward_mean": 19.924185714789683, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.27134326151714, "predator_policy": -10.403283738107753}, "policy_reward_max": {"prey_policy": 3.3851015310177344, "predator_policy": 50.44846652038615}, "policy_reward_mean": {"prey_policy": -19.924185714789687, "predator_policy": 19.92418571478968}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.76130238210324, 9.675490287018931, 36.112391440748766, 22.209445719304764, 15.302380522485873, 35.42095535919604, 27.44160452777952, 33.1023344956495, 11.894562388032686, 12.36804734877784, 27.22182606681169, 12.13749510009619, 29.093307123648405, 16.014213848698557, 10.474285181321129, 9.182109687330996, 18.74305210873215, 4.812804025597366, 27.64676475449239, 29.29237906801568, 32.76089606883165, 10.537084826211355, 20.974056692791656, 27.540978749488243, 21.22563347261024, 20.271638025524588, 18.71711098771538, 5.723496465744033, 28.040859406635924, 7.526714393342494, 17.710429023972164, 35.485515204622835, 19.844272607767195, 25.566201373877416, 14.814733866362253, 30.483376062883764, 20.654453552221064, 14.21268416659088, 16.099389945017037, 30.914249779354403, -2.9716542025849932, 15.351689593881233, 20.32541732997398, 39.77040463334739, 16.80660001172174, 15.22942811103411, 36.78511692274104, 27.198612600276256, 15.39779661438693, 27.47108301321261, 18.77330192230361, 25.991037141855895, 20.937613285971306, 17.114005719857253, 5.321049089857569, 22.529478232080333, 7.429673562590841, 44.27134326151712, 15.456899589070158, 22.47014474761109, 25.02699659764806, 15.462599462173571, 35.50972310300736, 32.85426722413608, 8.978959883944404, 20.76985438674079, 12.256838391173519, 11.177553777105606, 34.92975388247083, 22.144493252250488, -2.782460542445391, -3.3851015310177353, 25.471290186451355, 11.369212881796363, 0.9265941185590219, 29.096691336268137, 15.098801014078283, 22.839827144765476, 17.762264718414414, 23.859075942079567, 25.2211125981495, 19.668790530270993, 9.619544882852695, 29.144136554248192, 16.129099917589492, 12.362542831466085, 27.724478783494767, 27.18763458938995, 21.327586161248725, 17.065695789777376, 10.277483279991333, 14.491251310038294, 26.463945563154354, 10.89959549174956, 9.568827301053997, 6.139636478045238, 39.63620463784692, 39.83943695238883, 20.8147251530571, 12.800040155442897], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.761302382103246, -9.675490287018931, -36.11239144074879, -22.209445719304767, -15.302380522485862, -35.420955359196064, -27.44160452777949, -33.102334495649465, -11.89456238803267, -12.368047348777825, -27.221826066811705, -12.137495100096189, -29.09330712364839, -16.014213848698553, -10.474285181321136, -9.182109687331007, -18.743052108732147, -4.81280402559738, -27.646764754492416, -29.292379068015688, -32.76089606883159, -10.537084826211355, -20.974056692791613, -27.540978749488087, -21.22563347261027, -20.27163802552457, -18.717110987715454, -5.723496465744039, -28.04085940663587, -7.52671439334248, -17.710429023972157, -35.485515204622814, -19.844272607767202, -25.566201373877433, -14.814733866362262, -30.483376062883764, -20.654453552221057, -14.212684166590877, -16.099389945017016, -30.914249779354446, 2.9716542025850003, -15.351689593881213, -20.32541732997402, -39.77040463334746, -16.806600011721734, -15.229428111034109, -36.78511692274097, -27.19861260027625, -15.397796614386962, -27.471083013212592, -18.77330192230362, -25.99103714185589, -20.937613285971366, -17.114005719857236, -5.321049089857566, -22.529478232080354, -7.42967356259084, -44.27134326151714, -15.456899589070156, -22.47014474761105, -25.026996597648075, -15.462599462173571, -35.50972310300736, -32.85426722413612, -8.978959883944423, -20.769854386740818, -12.256838391173527, -11.177553777105626, -34.92975388247081, -22.144493252250463, 2.7824605424454028, 3.3851015310177344, -25.47129018645136, -11.36921288179638, -0.926594118559021, -29.09669133626814, -15.098801014078244, -22.839827144765472, -17.762264718414407, -23.859075942079517, -25.22111259814957, -19.668790530270964, -9.619544882852681, -29.144136554248195, -16.12909991758949, -12.362542831466076, -27.72447878349476, -27.187634589389937, -21.327586161248746, -17.065695789777422, -10.277483279991376, -14.491251310038281, -26.463945563154322, -10.899595491749547, -9.568827301053997, -6.139636478045247, -39.63620463784689, -39.83943695238898, -20.814725153057093, -12.800040155442906], "policy_predator_policy_reward": [30.2016503525846, 5.3209544116218925, -0.4662691638583205, 19.817249737896155, 43.20690972678405, 29.017873154713534, 27.108373929206422, 17.3105175094031, 16.109881167064867, 14.494879877906829, 29.865675259798927, 40.97623545859317, 25.69822786827857, 29.18498118728042, 40.192911824136196, 26.011757167162756, 22.957771762651106, 0.8313530134142377, 17.303752880067265, 7.4323418174883855, 39.326774040336424, 15.116878093286985, 12.87427462274242, 11.400715577449976, 42.21189999826907, 15.974714249027716, 23.50056056426439, 8.527867133132663, 15.859471684649787, 5.089098677992487, 2.451624430442255, 15.912594944219752, 20.63165045770529, 16.854453759758997, 13.34496855080848, -3.7193604996137286, 26.06163483748949, 29.231894671495297, 33.008528092594744, 25.576230043436617, 23.511677146260613, 42.010114991402574, 4.483995955358527, 16.590173697064188, 24.91363906824504, 17.034474317338216, 26.107010650796546, 28.974946848179773, 16.75874982649716, 25.692517118723345, 19.844356714385288, 20.698919336663902, 26.71681041578076, 10.717411559650094, 3.220021363950224, 8.226971567537852, 29.787595107800097, 26.29412370547167, -3.3814082987234384, 18.434837085408414, 8.027451374777954, 27.393406673166364, 28.87394456346748, 42.097085845778125, 28.40191047680295, 11.28663473873146, 36.908109385305224, 14.224293362449611, 19.09521534270738, 10.534252390017173, 36.369913460326515, 24.596838665441, 16.99520039279949, 24.313706711642645, 19.464904370713814, 8.960463962467955, 20.923772846817087, 11.275007043216972, 19.39275444856009, 42.435745110148744, -1.6211000634349038, -4.322208341735088, 25.557040941560565, 5.1463382462018865, 18.947890483481505, 21.702944176466517, 45.496411681979, 34.044397584715895, 25.38393554601425, 8.22926447742919, 15.65036437891681, 14.808491843151405, 36.74094306208953, 36.829290783392466, 28.511747544955078, 25.885477655597438, 16.03173351088536, 14.763859717888518, 28.248688233991306, 26.69347779243389, 16.363893091436296, 21.182710753170905, 24.00409148601275, 27.97798279769903, 29.82047987386626, 12.054746698076432, 10.2920536791815, 23.935957760532986, 4.971770286301979, 5.670327893413155, 17.453447396274246, 27.605509067886416, -0.1794809877981809, 15.038828112979873, 46.29198769684227, 42.250698826192, 9.606868351596967, 21.306930826543358, 20.544511044437293, 24.39577845078484, 29.4335955400818, 20.620397655214354, 13.421591994043398, 17.503606930303732, 34.2061060713183, 36.81334013469642, 31.910506213548313, 33.79802823472386, 1.3771264483189816, 16.580793319569864, 26.62417315777221, 14.915535615709388, 6.614684830909999, 17.89899195143706, 6.837811399991346, 15.51729615421987, 28.053129034282982, 41.80637873065857, 13.075830691029529, 31.213155813471417, -0.6606257590130786, -4.904295325877717, -10.403283738107753, 3.6330806760722822, 22.13372266210594, 28.808857710796744, 5.529773345160372, 17.2086524184324, -7.220732542584583, 9.073920779702627, 25.770476521170067, 32.42290615136622, 23.18041271066553, 7.017189317490946, 38.27943615228487, 7.400218137246105, 26.50724118157848, 9.017288255250342, 4.874077411184754, 42.844074472974334, 12.608240521027724, 37.833984675271395, 22.45525394698023, 16.88232711356177, 10.154150232050906, 9.084939533654465, 20.302766199840804, 37.98550690865563, 27.27937475030351, 4.978825084875464, 5.612487486597945, 19.112598176334217, 25.737367454696923, 29.711590112292562, 33.10302967187756, 21.272239506902338, 25.600315238808395, 17.054857083689093, 18.26226953442984, 15.869122045124971, 12.152891845679687, 8.402074714303023, 25.83682479497173, 3.145677825104822, 15.818141979393733, 37.10974914691496, 16.85140075414014, 4.947790229358949, 15.695860662273581, 3.4417939398344135, 6.48829764037138, 5.7909753157191, 30.704261101280665, 48.568148174413146, 50.44846652038615, 29.230407384391707, 24.049478615482652, 17.57997169063158, 16.97869540769303, 8.62138490319279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6194307528646433, "mean_inference_ms": 1.6019963742668697, "mean_action_processing_ms": 0.2519331817433611, "mean_env_wait_ms": 0.14293623097317373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059244632720947266, "StateBufferConnector_ms": 0.0028051137924194336, "ViewRequirementAgentConnector_ms": 0.07987618446350098}, "num_episodes": 23, "episode_return_max": 44.27134326151712, "episode_return_min": -3.3851015310177353, "episode_return_mean": 19.924185714789683, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.88082556389946, "num_env_steps_trained_throughput_per_sec": 335.88082556389946, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 10912.446, "restore_workers_time_ms": 0.026, "training_step_time_ms": 10912.219, "sample_time_ms": 1158.129, "learn_time_ms": 9733.969, "learn_throughput": 410.932, "synch_weights_time_ms": 18.41}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 28, "trial_id": "06536_00000", "date": "2024-08-11_16-39-30", "timestamp": 1723408770, "time_this_iter_s": 11.964075088500977, "time_total_s": 315.7042989730835, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331634820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 315.7042989730835, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 55.21764705882353, "ram_util_percent": 82.66470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.417217934379975, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.755636974858741, "policy_loss": -0.022336958319162173, "vf_loss": 1.7775316734487812, "vf_explained_var": 0.901957773293058, "kl": 0.017690307760762733, "entropy": 0.8831078751633564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1609196708315896, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5374939143026947, "policy_loss": -0.003178700606619555, "vf_loss": 1.5406616702596978, "vf_explained_var": 0.9624112454987077, "kl": 0.007003923183607343, "entropy": 0.5685656551173124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": 44.27134326151712, "episode_reward_min": -3.3851015310177353, "episode_reward_mean": 19.018091794367507, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.27134326151714, "predator_policy": -10.403283738107753}, "policy_reward_max": {"prey_policy": 3.3851015310177344, "predator_policy": 50.44846652038615}, "policy_reward_mean": {"prey_policy": -19.018091794367507, "predator_policy": 19.01809179436751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.64676475449239, 29.29237906801568, 32.76089606883165, 10.537084826211355, 20.974056692791656, 27.540978749488243, 21.22563347261024, 20.271638025524588, 18.71711098771538, 5.723496465744033, 28.040859406635924, 7.526714393342494, 17.710429023972164, 35.485515204622835, 19.844272607767195, 25.566201373877416, 14.814733866362253, 30.483376062883764, 20.654453552221064, 14.21268416659088, 16.099389945017037, 30.914249779354403, -2.9716542025849932, 15.351689593881233, 20.32541732997398, 39.77040463334739, 16.80660001172174, 15.22942811103411, 36.78511692274104, 27.198612600276256, 15.39779661438693, 27.47108301321261, 18.77330192230361, 25.991037141855895, 20.937613285971306, 17.114005719857253, 5.321049089857569, 22.529478232080333, 7.429673562590841, 44.27134326151712, 15.456899589070158, 22.47014474761109, 25.02699659764806, 15.462599462173571, 35.50972310300736, 32.85426722413608, 8.978959883944404, 20.76985438674079, 12.256838391173519, 11.177553777105606, 34.92975388247083, 22.144493252250488, -2.782460542445391, -3.3851015310177353, 25.471290186451355, 11.369212881796363, 0.9265941185590219, 29.096691336268137, 15.098801014078283, 22.839827144765476, 17.762264718414414, 23.859075942079567, 25.2211125981495, 19.668790530270993, 9.619544882852695, 29.144136554248192, 16.129099917589492, 12.362542831466085, 27.724478783494767, 27.18763458938995, 21.327586161248725, 17.065695789777376, 10.277483279991333, 14.491251310038294, 26.463945563154354, 10.89959549174956, 9.568827301053997, 6.139636478045238, 39.63620463784692, 39.83943695238883, 20.8147251530571, 12.800040155442897, 20.796845753499365, 3.818913493443367, 20.182229187922403, 5.959581036015339, 22.512760996200917, 10.481354808883118, 12.741502325449895, 22.67567287262945, 23.998893797141363, 8.328957497826929, 15.642879944804264, 8.938592754324315, 8.56244448502013, 12.637819342556632, 20.684290615939478, 1.8920569986847928, 25.123754129307795, 13.37966553146663], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.646764754492416, -29.292379068015688, -32.76089606883159, -10.537084826211355, -20.974056692791613, -27.540978749488087, -21.22563347261027, -20.27163802552457, -18.717110987715454, -5.723496465744039, -28.04085940663587, -7.52671439334248, -17.710429023972157, -35.485515204622814, -19.844272607767202, -25.566201373877433, -14.814733866362262, -30.483376062883764, -20.654453552221057, -14.212684166590877, -16.099389945017016, -30.914249779354446, 2.9716542025850003, -15.351689593881213, -20.32541732997402, -39.77040463334746, -16.806600011721734, -15.229428111034109, -36.78511692274097, -27.19861260027625, -15.397796614386962, -27.471083013212592, -18.77330192230362, -25.99103714185589, -20.937613285971366, -17.114005719857236, -5.321049089857566, -22.529478232080354, -7.42967356259084, -44.27134326151714, -15.456899589070156, -22.47014474761105, -25.026996597648075, -15.462599462173571, -35.50972310300736, -32.85426722413612, -8.978959883944423, -20.769854386740818, -12.256838391173527, -11.177553777105626, -34.92975388247081, -22.144493252250463, 2.7824605424454028, 3.3851015310177344, -25.47129018645136, -11.36921288179638, -0.926594118559021, -29.09669133626814, -15.098801014078244, -22.839827144765472, -17.762264718414407, -23.859075942079517, -25.22111259814957, -19.668790530270964, -9.619544882852681, -29.144136554248195, -16.12909991758949, -12.362542831466076, -27.72447878349476, -27.187634589389937, -21.327586161248746, -17.065695789777422, -10.277483279991376, -14.491251310038281, -26.463945563154322, -10.899595491749547, -9.568827301053997, -6.139636478045247, -39.63620463784689, -39.83943695238898, -20.814725153057093, -12.800040155442906, -20.796845753499383, -3.81891349344337, -20.18222918792241, -5.959581036015335, -22.512760996200946, -10.481354808883134, -12.741502325449904, -22.675672872629484, -23.99889379714133, -8.328957497826927, -15.642879944804305, -8.938592754324302, -8.562444485020139, -12.637819342556643, -20.684290615939496, -1.8920569986847706, -25.123754129307827, -13.379665531466628], "policy_predator_policy_reward": [26.06163483748949, 29.231894671495297, 33.008528092594744, 25.576230043436617, 23.511677146260613, 42.010114991402574, 4.483995955358527, 16.590173697064188, 24.91363906824504, 17.034474317338216, 26.107010650796546, 28.974946848179773, 16.75874982649716, 25.692517118723345, 19.844356714385288, 20.698919336663902, 26.71681041578076, 10.717411559650094, 3.220021363950224, 8.226971567537852, 29.787595107800097, 26.29412370547167, -3.3814082987234384, 18.434837085408414, 8.027451374777954, 27.393406673166364, 28.87394456346748, 42.097085845778125, 28.40191047680295, 11.28663473873146, 36.908109385305224, 14.224293362449611, 19.09521534270738, 10.534252390017173, 36.369913460326515, 24.596838665441, 16.99520039279949, 24.313706711642645, 19.464904370713814, 8.960463962467955, 20.923772846817087, 11.275007043216972, 19.39275444856009, 42.435745110148744, -1.6211000634349038, -4.322208341735088, 25.557040941560565, 5.1463382462018865, 18.947890483481505, 21.702944176466517, 45.496411681979, 34.044397584715895, 25.38393554601425, 8.22926447742919, 15.65036437891681, 14.808491843151405, 36.74094306208953, 36.829290783392466, 28.511747544955078, 25.885477655597438, 16.03173351088536, 14.763859717888518, 28.248688233991306, 26.69347779243389, 16.363893091436296, 21.182710753170905, 24.00409148601275, 27.97798279769903, 29.82047987386626, 12.054746698076432, 10.2920536791815, 23.935957760532986, 4.971770286301979, 5.670327893413155, 17.453447396274246, 27.605509067886416, -0.1794809877981809, 15.038828112979873, 46.29198769684227, 42.250698826192, 9.606868351596967, 21.306930826543358, 20.544511044437293, 24.39577845078484, 29.4335955400818, 20.620397655214354, 13.421591994043398, 17.503606930303732, 34.2061060713183, 36.81334013469642, 31.910506213548313, 33.79802823472386, 1.3771264483189816, 16.580793319569864, 26.62417315777221, 14.915535615709388, 6.614684830909999, 17.89899195143706, 6.837811399991346, 15.51729615421987, 28.053129034282982, 41.80637873065857, 13.075830691029529, 31.213155813471417, -0.6606257590130786, -4.904295325877717, -10.403283738107753, 3.6330806760722822, 22.13372266210594, 28.808857710796744, 5.529773345160372, 17.2086524184324, -7.220732542584583, 9.073920779702627, 25.770476521170067, 32.42290615136622, 23.18041271066553, 7.017189317490946, 38.27943615228487, 7.400218137246105, 26.50724118157848, 9.017288255250342, 4.874077411184754, 42.844074472974334, 12.608240521027724, 37.833984675271395, 22.45525394698023, 16.88232711356177, 10.154150232050906, 9.084939533654465, 20.302766199840804, 37.98550690865563, 27.27937475030351, 4.978825084875464, 5.612487486597945, 19.112598176334217, 25.737367454696923, 29.711590112292562, 33.10302967187756, 21.272239506902338, 25.600315238808395, 17.054857083689093, 18.26226953442984, 15.869122045124971, 12.152891845679687, 8.402074714303023, 25.83682479497173, 3.145677825104822, 15.818141979393733, 37.10974914691496, 16.85140075414014, 4.947790229358949, 15.695860662273581, 3.4417939398344135, 6.48829764037138, 5.7909753157191, 30.704261101280665, 48.568148174413146, 50.44846652038615, 29.230407384391707, 24.049478615482652, 17.57997169063158, 16.97869540769303, 8.62138490319279, 28.854189272199918, 12.739502234798822, 4.997563611503345, 2.640263375383398, 18.12034591501709, 22.244112460827765, 1.0635166671617906, 10.855645404868895, 26.012497063397298, 19.013024929004565, 31.007321237515743, -10.044611619749498, 7.640588452011273, 17.842416198888543, 21.363245961719315, 23.988099783539607, 42.151244565171204, 5.846543029111456, -5.4180959339660415, 22.07601092961989, 28.02265071937886, 3.263109170229728, 6.5209938252613995, 11.356191683387221, 4.974036189576735, 12.150852780463543, 19.43792055406357, 5.837718131049705, 5.666036322981803, 35.702544908897195, -0.27588003128124505, 4.059994028650799, 12.285658763669192, 37.96184949494645, 5.2388878579304485, 21.520443205002852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6175462098351358, "mean_inference_ms": 1.5975610408151408, "mean_action_processing_ms": 0.25105058143903386, "mean_env_wait_ms": 0.14248620035373427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005730032920837402, "StateBufferConnector_ms": 0.00284576416015625, "ViewRequirementAgentConnector_ms": 0.08097398281097412}, "num_episodes": 18, "episode_return_max": 44.27134326151712, "episode_return_min": -3.3851015310177353, "episode_return_mean": 19.018091794367507, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.22358159992064, "num_env_steps_trained_throughput_per_sec": 361.22358159992064, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 10959.401, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10959.186, "sample_time_ms": 1139.955, "learn_time_ms": 9797.813, "learn_throughput": 408.254, "synch_weights_time_ms": 19.687}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 29, "trial_id": "06536_00000", "date": "2024-08-11_16-39-41", "timestamp": 1723408781, "time_this_iter_s": 11.098934173583984, "time_total_s": 326.8032331466675, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb03a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 326.8032331466675, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 51.96875, "ram_util_percent": 82.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7346784037227434, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.271260961641868, "policy_loss": -0.009901027617161162, "vf_loss": 1.2810279248903196, "vf_explained_var": 0.9359185852731268, "kl": 0.00536265093008376, "entropy": 0.7668933958436052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7196177790089258, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9933677803587031, "policy_loss": -0.0014195462565612855, "vf_loss": 0.9947796047049224, "vf_explained_var": 0.9732080019655682, "kl": 0.004942182835159266, "entropy": 0.4865656674696655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 48.198539784816205, "episode_reward_min": -3.3851015310177353, "episode_reward_mean": 18.418832663809347, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.19853978481611, "predator_policy": -10.403283738107753}, "policy_reward_max": {"prey_policy": 3.3851015310177344, "predator_policy": 50.44846652038615}, "policy_reward_mean": {"prey_policy": -18.418832663809347, "predator_policy": 18.418832663809347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.654453552221064, 14.21268416659088, 16.099389945017037, 30.914249779354403, -2.9716542025849932, 15.351689593881233, 20.32541732997398, 39.77040463334739, 16.80660001172174, 15.22942811103411, 36.78511692274104, 27.198612600276256, 15.39779661438693, 27.47108301321261, 18.77330192230361, 25.991037141855895, 20.937613285971306, 17.114005719857253, 5.321049089857569, 22.529478232080333, 7.429673562590841, 44.27134326151712, 15.456899589070158, 22.47014474761109, 25.02699659764806, 15.462599462173571, 35.50972310300736, 32.85426722413608, 8.978959883944404, 20.76985438674079, 12.256838391173519, 11.177553777105606, 34.92975388247083, 22.144493252250488, -2.782460542445391, -3.3851015310177353, 25.471290186451355, 11.369212881796363, 0.9265941185590219, 29.096691336268137, 15.098801014078283, 22.839827144765476, 17.762264718414414, 23.859075942079567, 25.2211125981495, 19.668790530270993, 9.619544882852695, 29.144136554248192, 16.129099917589492, 12.362542831466085, 27.724478783494767, 27.18763458938995, 21.327586161248725, 17.065695789777376, 10.277483279991333, 14.491251310038294, 26.463945563154354, 10.89959549174956, 9.568827301053997, 6.139636478045238, 39.63620463784692, 39.83943695238883, 20.8147251530571, 12.800040155442897, 20.796845753499365, 3.818913493443367, 20.182229187922403, 5.959581036015339, 22.512760996200917, 10.481354808883118, 12.741502325449895, 22.67567287262945, 23.998893797141363, 8.328957497826929, 15.642879944804264, 8.938592754324315, 8.56244448502013, 12.637819342556632, 20.684290615939478, 1.8920569986847928, 25.123754129307795, 13.37966553146663, 48.198539784816205, 8.450745395380455, 20.035731912340456, 19.05233893645809, 35.240862806815784, 28.874954216462285, 13.338120969710562, 13.35714395711364, 16.375899459344197, 11.286293365335233, 25.741064793791992, 13.189301004278846, 2.555547196958379, 14.77193996856913, 23.53759392762619, 5.5391556919127565, 14.870664552449465, 19.82033005570918], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.654453552221057, -14.212684166590877, -16.099389945017016, -30.914249779354446, 2.9716542025850003, -15.351689593881213, -20.32541732997402, -39.77040463334746, -16.806600011721734, -15.229428111034109, -36.78511692274097, -27.19861260027625, -15.397796614386962, -27.471083013212592, -18.77330192230362, -25.99103714185589, -20.937613285971366, -17.114005719857236, -5.321049089857566, -22.529478232080354, -7.42967356259084, -44.27134326151714, -15.456899589070156, -22.47014474761105, -25.026996597648075, -15.462599462173571, -35.50972310300736, -32.85426722413612, -8.978959883944423, -20.769854386740818, -12.256838391173527, -11.177553777105626, -34.92975388247081, -22.144493252250463, 2.7824605424454028, 3.3851015310177344, -25.47129018645136, -11.36921288179638, -0.926594118559021, -29.09669133626814, -15.098801014078244, -22.839827144765472, -17.762264718414407, -23.859075942079517, -25.22111259814957, -19.668790530270964, -9.619544882852681, -29.144136554248195, -16.12909991758949, -12.362542831466076, -27.72447878349476, -27.187634589389937, -21.327586161248746, -17.065695789777422, -10.277483279991376, -14.491251310038281, -26.463945563154322, -10.899595491749547, -9.568827301053997, -6.139636478045247, -39.63620463784689, -39.83943695238898, -20.814725153057093, -12.800040155442906, -20.796845753499383, -3.81891349344337, -20.18222918792241, -5.959581036015335, -22.512760996200946, -10.481354808883134, -12.741502325449904, -22.675672872629484, -23.99889379714133, -8.328957497826927, -15.642879944804305, -8.938592754324302, -8.562444485020139, -12.637819342556643, -20.684290615939496, -1.8920569986847706, -25.123754129307827, -13.379665531466628, -48.19853978481611, -8.45074539538045, -20.035731912340434, -19.052338936458057, -35.24086280681584, -28.87495421646227, -13.338120969710562, -13.35714395711365, -16.375899459344215, -11.286293365335228, -25.74106479379199, -13.189301004278887, -2.5555471969583845, -14.771939968569178, -23.537593927626194, -5.539155691912766, -14.87066455244944, -19.820330055709192], "policy_predator_policy_reward": [16.99520039279949, 24.313706711642645, 19.464904370713814, 8.960463962467955, 20.923772846817087, 11.275007043216972, 19.39275444856009, 42.435745110148744, -1.6211000634349038, -4.322208341735088, 25.557040941560565, 5.1463382462018865, 18.947890483481505, 21.702944176466517, 45.496411681979, 34.044397584715895, 25.38393554601425, 8.22926447742919, 15.65036437891681, 14.808491843151405, 36.74094306208953, 36.829290783392466, 28.511747544955078, 25.885477655597438, 16.03173351088536, 14.763859717888518, 28.248688233991306, 26.69347779243389, 16.363893091436296, 21.182710753170905, 24.00409148601275, 27.97798279769903, 29.82047987386626, 12.054746698076432, 10.2920536791815, 23.935957760532986, 4.971770286301979, 5.670327893413155, 17.453447396274246, 27.605509067886416, -0.1794809877981809, 15.038828112979873, 46.29198769684227, 42.250698826192, 9.606868351596967, 21.306930826543358, 20.544511044437293, 24.39577845078484, 29.4335955400818, 20.620397655214354, 13.421591994043398, 17.503606930303732, 34.2061060713183, 36.81334013469642, 31.910506213548313, 33.79802823472386, 1.3771264483189816, 16.580793319569864, 26.62417315777221, 14.915535615709388, 6.614684830909999, 17.89899195143706, 6.837811399991346, 15.51729615421987, 28.053129034282982, 41.80637873065857, 13.075830691029529, 31.213155813471417, -0.6606257590130786, -4.904295325877717, -10.403283738107753, 3.6330806760722822, 22.13372266210594, 28.808857710796744, 5.529773345160372, 17.2086524184324, -7.220732542584583, 9.073920779702627, 25.770476521170067, 32.42290615136622, 23.18041271066553, 7.017189317490946, 38.27943615228487, 7.400218137246105, 26.50724118157848, 9.017288255250342, 4.874077411184754, 42.844074472974334, 12.608240521027724, 37.833984675271395, 22.45525394698023, 16.88232711356177, 10.154150232050906, 9.084939533654465, 20.302766199840804, 37.98550690865563, 27.27937475030351, 4.978825084875464, 5.612487486597945, 19.112598176334217, 25.737367454696923, 29.711590112292562, 33.10302967187756, 21.272239506902338, 25.600315238808395, 17.054857083689093, 18.26226953442984, 15.869122045124971, 12.152891845679687, 8.402074714303023, 25.83682479497173, 3.145677825104822, 15.818141979393733, 37.10974914691496, 16.85140075414014, 4.947790229358949, 15.695860662273581, 3.4417939398344135, 6.48829764037138, 5.7909753157191, 30.704261101280665, 48.568148174413146, 50.44846652038615, 29.230407384391707, 24.049478615482652, 17.57997169063158, 16.97869540769303, 8.62138490319279, 28.854189272199918, 12.739502234798822, 4.997563611503345, 2.640263375383398, 18.12034591501709, 22.244112460827765, 1.0635166671617906, 10.855645404868895, 26.012497063397298, 19.013024929004565, 31.007321237515743, -10.044611619749498, 7.640588452011273, 17.842416198888543, 21.363245961719315, 23.988099783539607, 42.151244565171204, 5.846543029111456, -5.4180959339660415, 22.07601092961989, 28.02265071937886, 3.263109170229728, 6.5209938252613995, 11.356191683387221, 4.974036189576735, 12.150852780463543, 19.43792055406357, 5.837718131049705, 5.666036322981803, 35.702544908897195, -0.27588003128124505, 4.059994028650799, 12.285658763669192, 37.96184949494645, 5.2388878579304485, 21.520443205002852, 47.07327431126146, 49.32380525837083, 6.018155618248104, 10.883335172512787, 0.81333720836881, 39.25812661631207, 19.406855179245568, 18.697822693670552, 30.93328323011643, 39.54844238351525, 23.139491674056572, 34.61041675886796, 5.6885539726580205, 20.987687966763094, 1.6650528776784288, 25.049235036548865, 25.099752885747748, 7.6520460329406825, 3.7472735494970246, 18.82531318117344, 15.422348286624054, 36.05978130095996, 29.687622838174953, -3.3090208296171624, -4.648099837611493, 9.75919423152826, 17.320932130651418, 12.22294780648692, 29.818492469747667, 17.2566953855047, -0.023818056085420203, 11.10212943991095, -5.932047981143258, 35.67337708604214, 22.374460990634233, 17.26619912078417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6182790597291438, "mean_inference_ms": 1.6016684717674865, "mean_action_processing_ms": 0.25149765743940455, "mean_env_wait_ms": 0.14312388619538952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00568079948425293, "StateBufferConnector_ms": 0.00302886962890625, "ViewRequirementAgentConnector_ms": 0.08687257766723633}, "num_episodes": 18, "episode_return_max": 48.198539784816205, "episode_return_min": -3.3851015310177353, "episode_return_mean": 18.418832663809347, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.3813336180898, "num_env_steps_trained_throughput_per_sec": 323.3813336180898, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 11109.948, "restore_workers_time_ms": 0.019, "training_step_time_ms": 11109.782, "sample_time_ms": 1210.671, "learn_time_ms": 9878.504, "learn_throughput": 404.92, "synch_weights_time_ms": 18.747}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 30, "trial_id": "06536_00000", "date": "2024-08-11_16-39-54", "timestamp": 1723408794, "time_this_iter_s": 12.426403999328613, "time_total_s": 339.2296371459961, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331608790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 339.2296371459961, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 55.272222222222226, "ram_util_percent": 83.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6715389152988793, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0492904763823996, "policy_loss": -0.008574589716105644, "vf_loss": 1.0576745092558364, "vf_explained_var": 0.9538085053985318, "kl": 0.00762219059282927, "entropy": 0.7007714121292035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7522014617604555, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9691689363547734, "policy_loss": -0.00510265565324555, "vf_loss": 0.9742665106972689, "vf_explained_var": 0.9737955294588886, "kl": 0.006503548690367049, "entropy": 0.5046292353244055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": 48.198539784816205, "episode_reward_min": -3.3851015310177353, "episode_reward_mean": 18.056983810744445, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.19853978481611, "predator_policy": -10.403283738107753}, "policy_reward_max": {"prey_policy": 3.3851015310177344, "predator_policy": 50.44846652038615}, "policy_reward_mean": {"prey_policy": -18.05698381074445, "predator_policy": 18.056983810744452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.321049089857569, 22.529478232080333, 7.429673562590841, 44.27134326151712, 15.456899589070158, 22.47014474761109, 25.02699659764806, 15.462599462173571, 35.50972310300736, 32.85426722413608, 8.978959883944404, 20.76985438674079, 12.256838391173519, 11.177553777105606, 34.92975388247083, 22.144493252250488, -2.782460542445391, -3.3851015310177353, 25.471290186451355, 11.369212881796363, 0.9265941185590219, 29.096691336268137, 15.098801014078283, 22.839827144765476, 17.762264718414414, 23.859075942079567, 25.2211125981495, 19.668790530270993, 9.619544882852695, 29.144136554248192, 16.129099917589492, 12.362542831466085, 27.724478783494767, 27.18763458938995, 21.327586161248725, 17.065695789777376, 10.277483279991333, 14.491251310038294, 26.463945563154354, 10.89959549174956, 9.568827301053997, 6.139636478045238, 39.63620463784692, 39.83943695238883, 20.8147251530571, 12.800040155442897, 20.796845753499365, 3.818913493443367, 20.182229187922403, 5.959581036015339, 22.512760996200917, 10.481354808883118, 12.741502325449895, 22.67567287262945, 23.998893797141363, 8.328957497826929, 15.642879944804264, 8.938592754324315, 8.56244448502013, 12.637819342556632, 20.684290615939478, 1.8920569986847928, 25.123754129307795, 13.37966553146663, 48.198539784816205, 8.450745395380455, 20.035731912340456, 19.05233893645809, 35.240862806815784, 28.874954216462285, 13.338120969710562, 13.35714395711364, 16.375899459344197, 11.286293365335233, 25.741064793791992, 13.189301004278846, 2.555547196958379, 14.77193996856913, 23.53759392762619, 5.5391556919127565, 14.870664552449465, 19.82033005570918, 27.960507168410658, 22.829194536295518, 16.894137597396508, 24.262519231757736, 0.5045978390052159, 13.41571877186191, 24.14960596768654, 9.342926541915965, 20.689377404967775, 32.5001339652069, 19.15509590272149, 28.177074573366117, 22.944161325847396, 18.93114733668606, 6.6088118513322875, 10.891864602931301, 26.558038066324958, 14.061432150957327], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.321049089857566, -22.529478232080354, -7.42967356259084, -44.27134326151714, -15.456899589070156, -22.47014474761105, -25.026996597648075, -15.462599462173571, -35.50972310300736, -32.85426722413612, -8.978959883944423, -20.769854386740818, -12.256838391173527, -11.177553777105626, -34.92975388247081, -22.144493252250463, 2.7824605424454028, 3.3851015310177344, -25.47129018645136, -11.36921288179638, -0.926594118559021, -29.09669133626814, -15.098801014078244, -22.839827144765472, -17.762264718414407, -23.859075942079517, -25.22111259814957, -19.668790530270964, -9.619544882852681, -29.144136554248195, -16.12909991758949, -12.362542831466076, -27.72447878349476, -27.187634589389937, -21.327586161248746, -17.065695789777422, -10.277483279991376, -14.491251310038281, -26.463945563154322, -10.899595491749547, -9.568827301053997, -6.139636478045247, -39.63620463784689, -39.83943695238898, -20.814725153057093, -12.800040155442906, -20.796845753499383, -3.81891349344337, -20.18222918792241, -5.959581036015335, -22.512760996200946, -10.481354808883134, -12.741502325449904, -22.675672872629484, -23.99889379714133, -8.328957497826927, -15.642879944804305, -8.938592754324302, -8.562444485020139, -12.637819342556643, -20.684290615939496, -1.8920569986847706, -25.123754129307827, -13.379665531466628, -48.19853978481611, -8.45074539538045, -20.035731912340434, -19.052338936458057, -35.24086280681584, -28.87495421646227, -13.338120969710562, -13.35714395711365, -16.375899459344215, -11.286293365335228, -25.74106479379199, -13.189301004278887, -2.5555471969583845, -14.771939968569178, -23.537593927626194, -5.539155691912766, -14.87066455244944, -19.820330055709192, -27.960507168410636, -22.829194536295493, -16.8941375973965, -24.262519231757757, -0.5045978390052115, -13.415718771861933, -24.149605967686533, -9.342926541915986, -20.689377404967786, -32.50013396520694, -19.15509590272151, -28.177074573366113, -22.944161325847443, -18.93114733668612, -6.608811851332274, -10.8918646029313, -26.558038066324958, -14.061432150957298], "policy_predator_policy_reward": [4.971770286301979, 5.670327893413155, 17.453447396274246, 27.605509067886416, -0.1794809877981809, 15.038828112979873, 46.29198769684227, 42.250698826192, 9.606868351596967, 21.306930826543358, 20.544511044437293, 24.39577845078484, 29.4335955400818, 20.620397655214354, 13.421591994043398, 17.503606930303732, 34.2061060713183, 36.81334013469642, 31.910506213548313, 33.79802823472386, 1.3771264483189816, 16.580793319569864, 26.62417315777221, 14.915535615709388, 6.614684830909999, 17.89899195143706, 6.837811399991346, 15.51729615421987, 28.053129034282982, 41.80637873065857, 13.075830691029529, 31.213155813471417, -0.6606257590130786, -4.904295325877717, -10.403283738107753, 3.6330806760722822, 22.13372266210594, 28.808857710796744, 5.529773345160372, 17.2086524184324, -7.220732542584583, 9.073920779702627, 25.770476521170067, 32.42290615136622, 23.18041271066553, 7.017189317490946, 38.27943615228487, 7.400218137246105, 26.50724118157848, 9.017288255250342, 4.874077411184754, 42.844074472974334, 12.608240521027724, 37.833984675271395, 22.45525394698023, 16.88232711356177, 10.154150232050906, 9.084939533654465, 20.302766199840804, 37.98550690865563, 27.27937475030351, 4.978825084875464, 5.612487486597945, 19.112598176334217, 25.737367454696923, 29.711590112292562, 33.10302967187756, 21.272239506902338, 25.600315238808395, 17.054857083689093, 18.26226953442984, 15.869122045124971, 12.152891845679687, 8.402074714303023, 25.83682479497173, 3.145677825104822, 15.818141979393733, 37.10974914691496, 16.85140075414014, 4.947790229358949, 15.695860662273581, 3.4417939398344135, 6.48829764037138, 5.7909753157191, 30.704261101280665, 48.568148174413146, 50.44846652038615, 29.230407384391707, 24.049478615482652, 17.57997169063158, 16.97869540769303, 8.62138490319279, 28.854189272199918, 12.739502234798822, 4.997563611503345, 2.640263375383398, 18.12034591501709, 22.244112460827765, 1.0635166671617906, 10.855645404868895, 26.012497063397298, 19.013024929004565, 31.007321237515743, -10.044611619749498, 7.640588452011273, 17.842416198888543, 21.363245961719315, 23.988099783539607, 42.151244565171204, 5.846543029111456, -5.4180959339660415, 22.07601092961989, 28.02265071937886, 3.263109170229728, 6.5209938252613995, 11.356191683387221, 4.974036189576735, 12.150852780463543, 19.43792055406357, 5.837718131049705, 5.666036322981803, 35.702544908897195, -0.27588003128124505, 4.059994028650799, 12.285658763669192, 37.96184949494645, 5.2388878579304485, 21.520443205002852, 47.07327431126146, 49.32380525837083, 6.018155618248104, 10.883335172512787, 0.81333720836881, 39.25812661631207, 19.406855179245568, 18.697822693670552, 30.93328323011643, 39.54844238351525, 23.139491674056572, 34.61041675886796, 5.6885539726580205, 20.987687966763094, 1.6650528776784288, 25.049235036548865, 25.099752885747748, 7.6520460329406825, 3.7472735494970246, 18.82531318117344, 15.422348286624054, 36.05978130095996, 29.687622838174953, -3.3090208296171624, -4.648099837611493, 9.75919423152826, 17.320932130651418, 12.22294780648692, 29.818492469747667, 17.2566953855047, -0.023818056085420203, 11.10212943991095, -5.932047981143258, 35.67337708604214, 22.374460990634233, 17.26619912078417, 7.5728332649583505, 48.34818107186297, 22.930509977902787, 22.72787909468824, 16.492311996138728, 17.295963198654295, 35.75765404657622, 12.767384416939292, -3.4773656630633614, 4.486561341073804, 23.937738327132394, 2.893699216591475, 4.869569730672607, 43.42964220470052, 8.556760876444189, 10.12909220738777, 19.52137315142208, 21.857381658513454, 46.82013151568381, 18.180136414730057, 9.943821703744751, 28.366370101698244, 29.13502149399125, 27.219127652740973, 27.654340789076233, 18.233981862618613, 19.241252411655687, 18.621042261716497, 3.510017040936747, 9.7076066617278, 2.3619517269489023, 19.421777478913697, 40.43576762374083, 12.68030850890909, 5.408917047090643, 22.71394725482396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6184631096701755, "mean_inference_ms": 1.60451701885656, "mean_action_processing_ms": 0.25183081063523916, "mean_env_wait_ms": 0.14367659162375052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005637764930725098, "StateBufferConnector_ms": 0.0035402774810791016, "ViewRequirementAgentConnector_ms": 0.09766650199890137}, "num_episodes": 18, "episode_return_max": 48.198539784816205, "episode_return_min": -3.3851015310177353, "episode_return_mean": 18.056983810744445, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.8907967131211, "num_env_steps_trained_throughput_per_sec": 340.8907967131211, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 11160.123, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11159.957, "sample_time_ms": 1194.081, "learn_time_ms": 9942.676, "learn_throughput": 402.306, "synch_weights_time_ms": 21.335}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 31, "trial_id": "06536_00000", "date": "2024-08-11_16-40-05", "timestamp": 1723408805, "time_this_iter_s": 11.784081220626831, "time_total_s": 351.0137183666229, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310ed310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 351.0137183666229, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 54.71764705882353, "ram_util_percent": 82.91176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8825272137920064, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5590543928556144, "policy_loss": -0.010030435569448552, "vf_loss": 1.5688401157657306, "vf_explained_var": 0.9503526031970978, "kl": 0.009788323918791563, "entropy": 0.6736583311110735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.890790833304168, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3579992530207154, "policy_loss": -0.0019418332400539565, "vf_loss": 1.3599362515898608, "vf_explained_var": 0.9709071277625977, "kl": 0.006182814186606962, "entropy": 0.46746198935483496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 48.198539784816205, "episode_reward_min": 0.5045978390052159, "episode_reward_mean": 17.679240264523102, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.19853978481611, "predator_policy": -10.044611619749498}, "policy_reward_max": {"prey_policy": -0.5045978390052115, "predator_policy": 50.44846652038615}, "policy_reward_mean": {"prey_policy": -17.679240264523106, "predator_policy": 17.67924026452311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.668790530270993, 9.619544882852695, 29.144136554248192, 16.129099917589492, 12.362542831466085, 27.724478783494767, 27.18763458938995, 21.327586161248725, 17.065695789777376, 10.277483279991333, 14.491251310038294, 26.463945563154354, 10.89959549174956, 9.568827301053997, 6.139636478045238, 39.63620463784692, 39.83943695238883, 20.8147251530571, 12.800040155442897, 20.796845753499365, 3.818913493443367, 20.182229187922403, 5.959581036015339, 22.512760996200917, 10.481354808883118, 12.741502325449895, 22.67567287262945, 23.998893797141363, 8.328957497826929, 15.642879944804264, 8.938592754324315, 8.56244448502013, 12.637819342556632, 20.684290615939478, 1.8920569986847928, 25.123754129307795, 13.37966553146663, 48.198539784816205, 8.450745395380455, 20.035731912340456, 19.05233893645809, 35.240862806815784, 28.874954216462285, 13.338120969710562, 13.35714395711364, 16.375899459344197, 11.286293365335233, 25.741064793791992, 13.189301004278846, 2.555547196958379, 14.77193996856913, 23.53759392762619, 5.5391556919127565, 14.870664552449465, 19.82033005570918, 27.960507168410658, 22.829194536295518, 16.894137597396508, 24.262519231757736, 0.5045978390052159, 13.41571877186191, 24.14960596768654, 9.342926541915965, 20.689377404967775, 32.5001339652069, 19.15509590272149, 28.177074573366117, 22.944161325847396, 18.93114733668606, 6.6088118513322875, 10.891864602931301, 26.558038066324958, 14.061432150957327, 15.230803660333605, 5.803438526162078, 20.595334679872273, 18.162881997299372, 8.575449718618868, 29.382447758989045, 19.28683811000102, 24.621067986367503, 23.417983148238065, 16.52853575585957, 1.5856432917142662, 33.89042245495685, 6.884086525111487, 18.392759199959208, 16.50987247197802, 21.216072711734128, 20.47655590185535, 11.759303470279479, 20.763839679002032, 21.03553215410559, 28.57439876841523, 11.464402670950973, 21.315188562733127, 6.472436966489373, 18.21455458828193, 18.092604850408005, 6.040126078626485], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.668790530270964, -9.619544882852681, -29.144136554248195, -16.12909991758949, -12.362542831466076, -27.72447878349476, -27.187634589389937, -21.327586161248746, -17.065695789777422, -10.277483279991376, -14.491251310038281, -26.463945563154322, -10.899595491749547, -9.568827301053997, -6.139636478045247, -39.63620463784689, -39.83943695238898, -20.814725153057093, -12.800040155442906, -20.796845753499383, -3.81891349344337, -20.18222918792241, -5.959581036015335, -22.512760996200946, -10.481354808883134, -12.741502325449904, -22.675672872629484, -23.99889379714133, -8.328957497826927, -15.642879944804305, -8.938592754324302, -8.562444485020139, -12.637819342556643, -20.684290615939496, -1.8920569986847706, -25.123754129307827, -13.379665531466628, -48.19853978481611, -8.45074539538045, -20.035731912340434, -19.052338936458057, -35.24086280681584, -28.87495421646227, -13.338120969710562, -13.35714395711365, -16.375899459344215, -11.286293365335228, -25.74106479379199, -13.189301004278887, -2.5555471969583845, -14.771939968569178, -23.537593927626194, -5.539155691912766, -14.87066455244944, -19.820330055709192, -27.960507168410636, -22.829194536295493, -16.8941375973965, -24.262519231757757, -0.5045978390052115, -13.415718771861933, -24.149605967686533, -9.342926541915986, -20.689377404967786, -32.50013396520694, -19.15509590272151, -28.177074573366113, -22.944161325847443, -18.93114733668612, -6.608811851332274, -10.8918646029313, -26.558038066324958, -14.061432150957298, -15.230803660333642, -5.803438526162054, -20.595334679872273, -18.162881997299372, -8.575449718618875, -29.382447758989017, -19.286838110000982, -24.62106798636755, -23.41798314823802, -16.528535755859544, -1.5856432917142653, -33.89042245495685, -6.884086525111492, -18.392759199959222, -16.509872471978, -21.216072711734135, -20.476555901855342, -11.759303470279463, -20.763839679002015, -21.035532154105557, -28.574398768415225, -11.464402670950967, -21.315188562733123, -6.472436966489367, -18.214554588281956, -18.092604850407962, -6.04012607862649], "policy_predator_policy_reward": [22.45525394698023, 16.88232711356177, 10.154150232050906, 9.084939533654465, 20.302766199840804, 37.98550690865563, 27.27937475030351, 4.978825084875464, 5.612487486597945, 19.112598176334217, 25.737367454696923, 29.711590112292562, 33.10302967187756, 21.272239506902338, 25.600315238808395, 17.054857083689093, 18.26226953442984, 15.869122045124971, 12.152891845679687, 8.402074714303023, 25.83682479497173, 3.145677825104822, 15.818141979393733, 37.10974914691496, 16.85140075414014, 4.947790229358949, 15.695860662273581, 3.4417939398344135, 6.48829764037138, 5.7909753157191, 30.704261101280665, 48.568148174413146, 50.44846652038615, 29.230407384391707, 24.049478615482652, 17.57997169063158, 16.97869540769303, 8.62138490319279, 28.854189272199918, 12.739502234798822, 4.997563611503345, 2.640263375383398, 18.12034591501709, 22.244112460827765, 1.0635166671617906, 10.855645404868895, 26.012497063397298, 19.013024929004565, 31.007321237515743, -10.044611619749498, 7.640588452011273, 17.842416198888543, 21.363245961719315, 23.988099783539607, 42.151244565171204, 5.846543029111456, -5.4180959339660415, 22.07601092961989, 28.02265071937886, 3.263109170229728, 6.5209938252613995, 11.356191683387221, 4.974036189576735, 12.150852780463543, 19.43792055406357, 5.837718131049705, 5.666036322981803, 35.702544908897195, -0.27588003128124505, 4.059994028650799, 12.285658763669192, 37.96184949494645, 5.2388878579304485, 21.520443205002852, 47.07327431126146, 49.32380525837083, 6.018155618248104, 10.883335172512787, 0.81333720836881, 39.25812661631207, 19.406855179245568, 18.697822693670552, 30.93328323011643, 39.54844238351525, 23.139491674056572, 34.61041675886796, 5.6885539726580205, 20.987687966763094, 1.6650528776784288, 25.049235036548865, 25.099752885747748, 7.6520460329406825, 3.7472735494970246, 18.82531318117344, 15.422348286624054, 36.05978130095996, 29.687622838174953, -3.3090208296171624, -4.648099837611493, 9.75919423152826, 17.320932130651418, 12.22294780648692, 29.818492469747667, 17.2566953855047, -0.023818056085420203, 11.10212943991095, -5.932047981143258, 35.67337708604214, 22.374460990634233, 17.26619912078417, 7.5728332649583505, 48.34818107186297, 22.930509977902787, 22.72787909468824, 16.492311996138728, 17.295963198654295, 35.75765404657622, 12.767384416939292, -3.4773656630633614, 4.486561341073804, 23.937738327132394, 2.893699216591475, 4.869569730672607, 43.42964220470052, 8.556760876444189, 10.12909220738777, 19.52137315142208, 21.857381658513454, 46.82013151568381, 18.180136414730057, 9.943821703744751, 28.366370101698244, 29.13502149399125, 27.219127652740973, 27.654340789076233, 18.233981862618613, 19.241252411655687, 18.621042261716497, 3.510017040936747, 9.7076066617278, 2.3619517269489023, 19.421777478913697, 40.43576762374083, 12.68030850890909, 5.408917047090643, 22.71394725482396, 32.687603207419976, -2.225995886752717, 5.03071606644696, 6.576160985877198, 21.28185554126975, 19.908813818474787, 17.510097995501287, 18.815665999097487, 14.527844380139392, 2.623055057098364, 27.377682081352077, 31.387213436625956, 21.149984207279783, 17.42369201272222, 37.80210688119393, 11.440029091541147, 26.205541146202755, 20.630425150273346, 15.60103613211793, 17.456035379601193, 3.4754516436691825, -0.30416506024065537, 23.082614222965738, 44.69823068694793, 7.3560552248784425, 6.412117825344536, 13.939389062879943, 22.846129337038505, 27.51259492030914, 5.507150023646868, 16.407186333144487, 26.024959090323776, 17.178599113835546, 23.774512689875145, 13.908941983548644, 9.609664957010311, 27.855473446515894, 13.672205911488154, 19.00367539113791, 23.06738891707326, 25.17831110190692, 31.97048643492351, 20.75166765036197, 2.1771376915399543, 21.96436829174149, 20.66600883372476, 6.967887644490654, 5.976986288488086, 7.149422180922884, 29.279686995641022, 11.145549174136125, 25.039660526679828, 14.898798385508073, -2.8185462282550895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6178047254205868, "mean_inference_ms": 1.608670411708905, "mean_action_processing_ms": 0.25259832718501485, "mean_env_wait_ms": 0.1442039841649525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052950382232666016, "StateBufferConnector_ms": 0.005209684371948242, "ViewRequirementAgentConnector_ms": 0.12037646770477295}, "num_episodes": 27, "episode_return_max": 48.198539784816205, "episode_return_min": 0.5045978390052159, "episode_return_mean": 17.679240264523102, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.62747233063516, "num_env_steps_trained_throughput_per_sec": 348.62747233063516, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 11239.062, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11238.896, "sample_time_ms": 1233.438, "learn_time_ms": 9982.31, "learn_throughput": 400.709, "synch_weights_time_ms": 21.302}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 32, "trial_id": "06536_00000", "date": "2024-08-11_16-40-17", "timestamp": 1723408817, "time_this_iter_s": 11.523305892944336, "time_total_s": 362.53702425956726, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310edca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 362.53702425956726, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 53.09375, "ram_util_percent": 82.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.917350417561829, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.425841305280725, "policy_loss": -0.006706442928892405, "vf_loss": 1.432453140616417, "vf_explained_var": 0.936285491536061, "kl": 0.0037842610004713813, "entropy": 0.6440239577243726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7946778751870314, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1778636813321441, "policy_loss": -0.001931794017316803, "vf_loss": 1.1797921589758031, "vf_explained_var": 0.9713126390383988, "kl": 0.004246639146956964, "entropy": 0.4088173936599146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": 48.198539784816205, "episode_reward_min": 0.5045978390052159, "episode_reward_mean": 17.636717388534144, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.19853978481611, "predator_policy": -10.044611619749498}, "policy_reward_max": {"prey_policy": -0.5045978390052115, "predator_policy": 49.32380525837083}, "policy_reward_mean": {"prey_policy": -17.636717388534144, "predator_policy": 17.636717388534144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.800040155442897, 20.796845753499365, 3.818913493443367, 20.182229187922403, 5.959581036015339, 22.512760996200917, 10.481354808883118, 12.741502325449895, 22.67567287262945, 23.998893797141363, 8.328957497826929, 15.642879944804264, 8.938592754324315, 8.56244448502013, 12.637819342556632, 20.684290615939478, 1.8920569986847928, 25.123754129307795, 13.37966553146663, 48.198539784816205, 8.450745395380455, 20.035731912340456, 19.05233893645809, 35.240862806815784, 28.874954216462285, 13.338120969710562, 13.35714395711364, 16.375899459344197, 11.286293365335233, 25.741064793791992, 13.189301004278846, 2.555547196958379, 14.77193996856913, 23.53759392762619, 5.5391556919127565, 14.870664552449465, 19.82033005570918, 27.960507168410658, 22.829194536295518, 16.894137597396508, 24.262519231757736, 0.5045978390052159, 13.41571877186191, 24.14960596768654, 9.342926541915965, 20.689377404967775, 32.5001339652069, 19.15509590272149, 28.177074573366117, 22.944161325847396, 18.93114733668606, 6.6088118513322875, 10.891864602931301, 26.558038066324958, 14.061432150957327, 15.230803660333605, 5.803438526162078, 20.595334679872273, 18.162881997299372, 8.575449718618868, 29.382447758989045, 19.28683811000102, 24.621067986367503, 23.417983148238065, 16.52853575585957, 1.5856432917142662, 33.89042245495685, 6.884086525111487, 18.392759199959208, 16.50987247197802, 21.216072711734128, 20.47655590185535, 11.759303470279479, 20.763839679002032, 21.03553215410559, 28.57439876841523, 11.464402670950973, 21.315188562733127, 6.472436966489373, 18.21455458828193, 18.092604850408005, 6.040126078626485, 19.462936006736157, 11.232527548111277, 35.80129128665124, 31.467705427947294, 8.693285040340603, 8.982016817857499, 18.268784623275995, 23.987051037792135, 8.315944231473415, 11.00679701820318, 31.08430607473087, 25.236901277179008, 8.752992471692988, 33.21131173009081, 12.863968594249203, 34.35110596514311, 21.579158656791773, 9.810244800501213], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.800040155442906, -20.796845753499383, -3.81891349344337, -20.18222918792241, -5.959581036015335, -22.512760996200946, -10.481354808883134, -12.741502325449904, -22.675672872629484, -23.99889379714133, -8.328957497826927, -15.642879944804305, -8.938592754324302, -8.562444485020139, -12.637819342556643, -20.684290615939496, -1.8920569986847706, -25.123754129307827, -13.379665531466628, -48.19853978481611, -8.45074539538045, -20.035731912340434, -19.052338936458057, -35.24086280681584, -28.87495421646227, -13.338120969710562, -13.35714395711365, -16.375899459344215, -11.286293365335228, -25.74106479379199, -13.189301004278887, -2.5555471969583845, -14.771939968569178, -23.537593927626194, -5.539155691912766, -14.87066455244944, -19.820330055709192, -27.960507168410636, -22.829194536295493, -16.8941375973965, -24.262519231757757, -0.5045978390052115, -13.415718771861933, -24.149605967686533, -9.342926541915986, -20.689377404967786, -32.50013396520694, -19.15509590272151, -28.177074573366113, -22.944161325847443, -18.93114733668612, -6.608811851332274, -10.8918646029313, -26.558038066324958, -14.061432150957298, -15.230803660333642, -5.803438526162054, -20.595334679872273, -18.162881997299372, -8.575449718618875, -29.382447758989017, -19.286838110000982, -24.62106798636755, -23.41798314823802, -16.528535755859544, -1.5856432917142653, -33.89042245495685, -6.884086525111492, -18.392759199959222, -16.509872471978, -21.216072711734135, -20.476555901855342, -11.759303470279463, -20.763839679002015, -21.035532154105557, -28.574398768415225, -11.464402670950967, -21.315188562733123, -6.472436966489367, -18.214554588281956, -18.092604850407962, -6.04012607862649, -19.46293600673618, -11.232527548111277, -35.80129128665123, -31.467705427947294, -8.693285040340605, -8.982016817857504, -18.268784623275987, -23.98705103779212, -8.315944231473418, -11.006797018203155, -31.08430607473095, -25.236901277178934, -8.752992471693, -33.21131173009077, -12.86396859424918, -34.35110596514315, -21.57915865679176, -9.81024480050122], "policy_predator_policy_reward": [16.97869540769303, 8.62138490319279, 28.854189272199918, 12.739502234798822, 4.997563611503345, 2.640263375383398, 18.12034591501709, 22.244112460827765, 1.0635166671617906, 10.855645404868895, 26.012497063397298, 19.013024929004565, 31.007321237515743, -10.044611619749498, 7.640588452011273, 17.842416198888543, 21.363245961719315, 23.988099783539607, 42.151244565171204, 5.846543029111456, -5.4180959339660415, 22.07601092961989, 28.02265071937886, 3.263109170229728, 6.5209938252613995, 11.356191683387221, 4.974036189576735, 12.150852780463543, 19.43792055406357, 5.837718131049705, 5.666036322981803, 35.702544908897195, -0.27588003128124505, 4.059994028650799, 12.285658763669192, 37.96184949494645, 5.2388878579304485, 21.520443205002852, 47.07327431126146, 49.32380525837083, 6.018155618248104, 10.883335172512787, 0.81333720836881, 39.25812661631207, 19.406855179245568, 18.697822693670552, 30.93328323011643, 39.54844238351525, 23.139491674056572, 34.61041675886796, 5.6885539726580205, 20.987687966763094, 1.6650528776784288, 25.049235036548865, 25.099752885747748, 7.6520460329406825, 3.7472735494970246, 18.82531318117344, 15.422348286624054, 36.05978130095996, 29.687622838174953, -3.3090208296171624, -4.648099837611493, 9.75919423152826, 17.320932130651418, 12.22294780648692, 29.818492469747667, 17.2566953855047, -0.023818056085420203, 11.10212943991095, -5.932047981143258, 35.67337708604214, 22.374460990634233, 17.26619912078417, 7.5728332649583505, 48.34818107186297, 22.930509977902787, 22.72787909468824, 16.492311996138728, 17.295963198654295, 35.75765404657622, 12.767384416939292, -3.4773656630633614, 4.486561341073804, 23.937738327132394, 2.893699216591475, 4.869569730672607, 43.42964220470052, 8.556760876444189, 10.12909220738777, 19.52137315142208, 21.857381658513454, 46.82013151568381, 18.180136414730057, 9.943821703744751, 28.366370101698244, 29.13502149399125, 27.219127652740973, 27.654340789076233, 18.233981862618613, 19.241252411655687, 18.621042261716497, 3.510017040936747, 9.7076066617278, 2.3619517269489023, 19.421777478913697, 40.43576762374083, 12.68030850890909, 5.408917047090643, 22.71394725482396, 32.687603207419976, -2.225995886752717, 5.03071606644696, 6.576160985877198, 21.28185554126975, 19.908813818474787, 17.510097995501287, 18.815665999097487, 14.527844380139392, 2.623055057098364, 27.377682081352077, 31.387213436625956, 21.149984207279783, 17.42369201272222, 37.80210688119393, 11.440029091541147, 26.205541146202755, 20.630425150273346, 15.60103613211793, 17.456035379601193, 3.4754516436691825, -0.30416506024065537, 23.082614222965738, 44.69823068694793, 7.3560552248784425, 6.412117825344536, 13.939389062879943, 22.846129337038505, 27.51259492030914, 5.507150023646868, 16.407186333144487, 26.024959090323776, 17.178599113835546, 23.774512689875145, 13.908941983548644, 9.609664957010311, 27.855473446515894, 13.672205911488154, 19.00367539113791, 23.06738891707326, 25.17831110190692, 31.97048643492351, 20.75166765036197, 2.1771376915399543, 21.96436829174149, 20.66600883372476, 6.967887644490654, 5.976986288488086, 7.149422180922884, 29.279686995641022, 11.145549174136125, 25.039660526679828, 14.898798385508073, -2.8185462282550895, 18.93601462946272, 19.989857384009632, 7.34947628091333, 15.115578815309206, 29.802057508674608, 41.800525064627855, 30.413614790013348, 32.52179606588122, 3.680341209725354, 13.706228870955876, 7.46587680438849, 10.49815683132654, 11.473226047653792, 25.064343198898218, 21.49752726382828, 26.476574811755953, 8.66613194784939, 7.965756515097452, 2.522168613321587, 19.491425423084717, 20.114321238142487, 42.05429091131938, 24.44986167865829, 26.023940875699587, -0.33161472728674113, 17.837599670672734, 28.736423224156994, 37.686200236024526, 13.147470819853536, 12.58046636864484, 42.22681142003465, 26.475400510251568, 19.99010196921816, 23.16821534436537, 14.174675240463705, 5.4458143605387335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6197684698024135, "mean_inference_ms": 1.612678096329031, "mean_action_processing_ms": 0.2532205707140998, "mean_env_wait_ms": 0.14485622400815734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005948424339294434, "StateBufferConnector_ms": 0.004977583885192871, "ViewRequirementAgentConnector_ms": 0.12281966209411621}, "num_episodes": 18, "episode_return_max": 48.198539784816205, "episode_return_min": 0.5045978390052159, "episode_return_mean": 17.636717388534144, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.87603044394075, "num_env_steps_trained_throughput_per_sec": 343.87603044394075, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 11270.641, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11270.477, "sample_time_ms": 1253.488, "learn_time_ms": 9995.518, "learn_throughput": 400.179, "synch_weights_time_ms": 19.756}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 33, "trial_id": "06536_00000", "date": "2024-08-11_16-40-29", "timestamp": 1723408829, "time_this_iter_s": 11.674133062362671, "time_total_s": 374.21115732192993, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310f00d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 374.21115732192993, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 52.417647058823526, "ram_util_percent": 82.38235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0807782494152587, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3422544369163611, "policy_loss": -0.008295855388375155, "vf_loss": 1.3504531782741347, "vf_explained_var": 0.957194828055799, "kl": 0.007769166457560583, "entropy": 0.6840810364112258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1440596562844734, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3767731104578291, "policy_loss": -0.0028123437085745746, "vf_loss": 1.3795834828936864, "vf_explained_var": 0.9736567685213039, "kl": 0.005050273754476338, "entropy": 0.41680955472131254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 48.198539784816205, "episode_reward_min": -3.8415285330897184, "episode_reward_mean": 18.11245508684234, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -48.19853978481611, "predator_policy": -7.893852062488499}, "policy_reward_max": {"prey_policy": 3.8415285330897238, "predator_policy": 49.32380525837083}, "policy_reward_mean": {"prey_policy": -18.112455086842335, "predator_policy": 18.11245508684234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.37966553146663, 48.198539784816205, 8.450745395380455, 20.035731912340456, 19.05233893645809, 35.240862806815784, 28.874954216462285, 13.338120969710562, 13.35714395711364, 16.375899459344197, 11.286293365335233, 25.741064793791992, 13.189301004278846, 2.555547196958379, 14.77193996856913, 23.53759392762619, 5.5391556919127565, 14.870664552449465, 19.82033005570918, 27.960507168410658, 22.829194536295518, 16.894137597396508, 24.262519231757736, 0.5045978390052159, 13.41571877186191, 24.14960596768654, 9.342926541915965, 20.689377404967775, 32.5001339652069, 19.15509590272149, 28.177074573366117, 22.944161325847396, 18.93114733668606, 6.6088118513322875, 10.891864602931301, 26.558038066324958, 14.061432150957327, 15.230803660333605, 5.803438526162078, 20.595334679872273, 18.162881997299372, 8.575449718618868, 29.382447758989045, 19.28683811000102, 24.621067986367503, 23.417983148238065, 16.52853575585957, 1.5856432917142662, 33.89042245495685, 6.884086525111487, 18.392759199959208, 16.50987247197802, 21.216072711734128, 20.47655590185535, 11.759303470279479, 20.763839679002032, 21.03553215410559, 28.57439876841523, 11.464402670950973, 21.315188562733127, 6.472436966489373, 18.21455458828193, 18.092604850408005, 6.040126078626485, 19.462936006736157, 11.232527548111277, 35.80129128665124, 31.467705427947294, 8.693285040340603, 8.982016817857499, 18.268784623275995, 23.987051037792135, 8.315944231473415, 11.00679701820318, 31.08430607473087, 25.236901277179008, 8.752992471692988, 33.21131173009081, 12.863968594249203, 34.35110596514311, 21.579158656791773, 9.810244800501213, 25.32972315186878, 3.7722781109909715, 15.023056277940483, 13.28321102472687, 14.264582630541888, 26.065488778627216, -2.2163877657375606, 22.47898578985626, 24.15955229418854, 22.720640084497646, 14.709702768033624, 30.14496141206679, -3.8415285330897184, 11.036562745595342, 29.729723017894603, 32.46192023299809, 3.033872702581246, 23.196015302330682], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.379665531466628, -48.19853978481611, -8.45074539538045, -20.035731912340434, -19.052338936458057, -35.24086280681584, -28.87495421646227, -13.338120969710562, -13.35714395711365, -16.375899459344215, -11.286293365335228, -25.74106479379199, -13.189301004278887, -2.5555471969583845, -14.771939968569178, -23.537593927626194, -5.539155691912766, -14.87066455244944, -19.820330055709192, -27.960507168410636, -22.829194536295493, -16.8941375973965, -24.262519231757757, -0.5045978390052115, -13.415718771861933, -24.149605967686533, -9.342926541915986, -20.689377404967786, -32.50013396520694, -19.15509590272151, -28.177074573366113, -22.944161325847443, -18.93114733668612, -6.608811851332274, -10.8918646029313, -26.558038066324958, -14.061432150957298, -15.230803660333642, -5.803438526162054, -20.595334679872273, -18.162881997299372, -8.575449718618875, -29.382447758989017, -19.286838110000982, -24.62106798636755, -23.41798314823802, -16.528535755859544, -1.5856432917142653, -33.89042245495685, -6.884086525111492, -18.392759199959222, -16.509872471978, -21.216072711734135, -20.476555901855342, -11.759303470279463, -20.763839679002015, -21.035532154105557, -28.574398768415225, -11.464402670950967, -21.315188562733123, -6.472436966489367, -18.214554588281956, -18.092604850407962, -6.04012607862649, -19.46293600673618, -11.232527548111277, -35.80129128665123, -31.467705427947294, -8.693285040340605, -8.982016817857504, -18.268784623275987, -23.98705103779212, -8.315944231473418, -11.006797018203155, -31.08430607473095, -25.236901277178934, -8.752992471693, -33.21131173009077, -12.86396859424918, -34.35110596514315, -21.57915865679176, -9.81024480050122, -25.32972315186878, -3.772278110990968, -15.023056277940498, -13.283211024726953, -14.264582630541875, -26.065488778627188, 2.2163877657375584, -22.478985789856274, -24.15955229418855, -22.72064008449768, -14.709702768033633, -30.144961412066774, 3.8415285330897238, -11.03656274559534, -29.72972301789457, -32.461920232998175, -3.033872702581246, -23.196015302330657], "policy_predator_policy_reward": [5.2388878579304485, 21.520443205002852, 47.07327431126146, 49.32380525837083, 6.018155618248104, 10.883335172512787, 0.81333720836881, 39.25812661631207, 19.406855179245568, 18.697822693670552, 30.93328323011643, 39.54844238351525, 23.139491674056572, 34.61041675886796, 5.6885539726580205, 20.987687966763094, 1.6650528776784288, 25.049235036548865, 25.099752885747748, 7.6520460329406825, 3.7472735494970246, 18.82531318117344, 15.422348286624054, 36.05978130095996, 29.687622838174953, -3.3090208296171624, -4.648099837611493, 9.75919423152826, 17.320932130651418, 12.22294780648692, 29.818492469747667, 17.2566953855047, -0.023818056085420203, 11.10212943991095, -5.932047981143258, 35.67337708604214, 22.374460990634233, 17.26619912078417, 7.5728332649583505, 48.34818107186297, 22.930509977902787, 22.72787909468824, 16.492311996138728, 17.295963198654295, 35.75765404657622, 12.767384416939292, -3.4773656630633614, 4.486561341073804, 23.937738327132394, 2.893699216591475, 4.869569730672607, 43.42964220470052, 8.556760876444189, 10.12909220738777, 19.52137315142208, 21.857381658513454, 46.82013151568381, 18.180136414730057, 9.943821703744751, 28.366370101698244, 29.13502149399125, 27.219127652740973, 27.654340789076233, 18.233981862618613, 19.241252411655687, 18.621042261716497, 3.510017040936747, 9.7076066617278, 2.3619517269489023, 19.421777478913697, 40.43576762374083, 12.68030850890909, 5.408917047090643, 22.71394725482396, 32.687603207419976, -2.225995886752717, 5.03071606644696, 6.576160985877198, 21.28185554126975, 19.908813818474787, 17.510097995501287, 18.815665999097487, 14.527844380139392, 2.623055057098364, 27.377682081352077, 31.387213436625956, 21.149984207279783, 17.42369201272222, 37.80210688119393, 11.440029091541147, 26.205541146202755, 20.630425150273346, 15.60103613211793, 17.456035379601193, 3.4754516436691825, -0.30416506024065537, 23.082614222965738, 44.69823068694793, 7.3560552248784425, 6.412117825344536, 13.939389062879943, 22.846129337038505, 27.51259492030914, 5.507150023646868, 16.407186333144487, 26.024959090323776, 17.178599113835546, 23.774512689875145, 13.908941983548644, 9.609664957010311, 27.855473446515894, 13.672205911488154, 19.00367539113791, 23.06738891707326, 25.17831110190692, 31.97048643492351, 20.75166765036197, 2.1771376915399543, 21.96436829174149, 20.66600883372476, 6.967887644490654, 5.976986288488086, 7.149422180922884, 29.279686995641022, 11.145549174136125, 25.039660526679828, 14.898798385508073, -2.8185462282550895, 18.93601462946272, 19.989857384009632, 7.34947628091333, 15.115578815309206, 29.802057508674608, 41.800525064627855, 30.413614790013348, 32.52179606588122, 3.680341209725354, 13.706228870955876, 7.46587680438849, 10.49815683132654, 11.473226047653792, 25.064343198898218, 21.49752726382828, 26.476574811755953, 8.66613194784939, 7.965756515097452, 2.522168613321587, 19.491425423084717, 20.114321238142487, 42.05429091131938, 24.44986167865829, 26.023940875699587, -0.33161472728674113, 17.837599670672734, 28.736423224156994, 37.686200236024526, 13.147470819853536, 12.58046636864484, 42.22681142003465, 26.475400510251568, 19.99010196921816, 23.16821534436537, 14.174675240463705, 5.4458143605387335, 30.568818537741482, 20.090627765996103, 7.475691969297145, 0.06886425268479801, 23.186271429540792, 6.8598411263402035, 0.434924987249671, 26.1314970622042, 13.493186522296304, 15.035978738787454, 20.340066069722877, 31.790911487531513, -1.7615812073535384, -2.6711943241215836, 27.32077562373798, 17.63719595597454, 37.28787940082965, 11.031225187547495, 35.63457337818498, 9.80670679081038, 13.729503219935879, 15.689902316131379, 13.618002135338608, 46.67192068879492, -0.7326210938120878, -6.950435972367355, 17.01821717473416, 5.0549083164564985, 33.55065395760704, 25.908792078182167, 45.94633885728574, 18.977501608710515, 13.96159746765099, -7.893852062488499, 18.858038192815044, 27.5339924118463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6206380692060727, "mean_inference_ms": 1.617571520211403, "mean_action_processing_ms": 0.25409654486457867, "mean_env_wait_ms": 0.14541567904106145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005945682525634766, "StateBufferConnector_ms": 0.004968881607055664, "ViewRequirementAgentConnector_ms": 0.12236905097961426}, "num_episodes": 18, "episode_return_max": 48.198539784816205, "episode_return_min": -3.8415285330897184, "episode_return_mean": 18.11245508684234, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.72609169072865, "num_env_steps_trained_throughput_per_sec": 345.72609169072865, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 11411.448, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11411.264, "sample_time_ms": 1259.215, "learn_time_ms": 10130.073, "learn_throughput": 394.864, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 34, "trial_id": "06536_00000", "date": "2024-08-11_16-40-40", "timestamp": 1723408840, "time_this_iter_s": 11.638540029525757, "time_total_s": 385.8496973514557, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331608430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 385.8496973514557, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 54.09375, "ram_util_percent": 83.03125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0247537075852353, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.713247930817306, "policy_loss": -0.009845656847270826, "vf_loss": 1.7229296702270707, "vf_explained_var": 0.9510921504969398, "kl": 0.01311320589556818, "entropy": 0.7069419965147972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0440691653382843, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7487394955423143, "policy_loss": -0.002805521918174924, "vf_loss": 1.7515432822641241, "vf_explained_var": 0.9662289203474761, "kl": 0.004444646701107384, "entropy": 0.45485534336831834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": 51.674926655476035, "episode_reward_min": -3.8415285330897184, "episode_reward_mean": 19.243581823398404, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.67492665547603, "predator_policy": -7.893852062488499}, "policy_reward_max": {"prey_policy": 3.8415285330897238, "predator_policy": 51.958543372597}, "policy_reward_mean": {"prey_policy": -19.243581823398404, "predator_policy": 19.243581823398404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.82033005570918, 27.960507168410658, 22.829194536295518, 16.894137597396508, 24.262519231757736, 0.5045978390052159, 13.41571877186191, 24.14960596768654, 9.342926541915965, 20.689377404967775, 32.5001339652069, 19.15509590272149, 28.177074573366117, 22.944161325847396, 18.93114733668606, 6.6088118513322875, 10.891864602931301, 26.558038066324958, 14.061432150957327, 15.230803660333605, 5.803438526162078, 20.595334679872273, 18.162881997299372, 8.575449718618868, 29.382447758989045, 19.28683811000102, 24.621067986367503, 23.417983148238065, 16.52853575585957, 1.5856432917142662, 33.89042245495685, 6.884086525111487, 18.392759199959208, 16.50987247197802, 21.216072711734128, 20.47655590185535, 11.759303470279479, 20.763839679002032, 21.03553215410559, 28.57439876841523, 11.464402670950973, 21.315188562733127, 6.472436966489373, 18.21455458828193, 18.092604850408005, 6.040126078626485, 19.462936006736157, 11.232527548111277, 35.80129128665124, 31.467705427947294, 8.693285040340603, 8.982016817857499, 18.268784623275995, 23.987051037792135, 8.315944231473415, 11.00679701820318, 31.08430607473087, 25.236901277179008, 8.752992471692988, 33.21131173009081, 12.863968594249203, 34.35110596514311, 21.579158656791773, 9.810244800501213, 25.32972315186878, 3.7722781109909715, 15.023056277940483, 13.28321102472687, 14.264582630541888, 26.065488778627216, -2.2163877657375606, 22.47898578985626, 24.15955229418854, 22.720640084497646, 14.709702768033624, 30.14496141206679, -3.8415285330897184, 11.036562745595342, 29.729723017894603, 32.46192023299809, 3.033872702581246, 23.196015302330682, 23.965371143228907, 18.89480401078503, 25.340868478025513, 16.21981030517518, 33.275224539055486, 10.260629071046587, 28.19527580020828, 17.841504706795195, 8.256787256154759, 51.674926655476035, 31.06233014139012, 22.15484167923426, 27.893637722437106, 43.025374960222265, 8.030515537947707, 29.633989515977863, 15.768805472150818, 29.413540131125647], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.820330055709192, -27.960507168410636, -22.829194536295493, -16.8941375973965, -24.262519231757757, -0.5045978390052115, -13.415718771861933, -24.149605967686533, -9.342926541915986, -20.689377404967786, -32.50013396520694, -19.15509590272151, -28.177074573366113, -22.944161325847443, -18.93114733668612, -6.608811851332274, -10.8918646029313, -26.558038066324958, -14.061432150957298, -15.230803660333642, -5.803438526162054, -20.595334679872273, -18.162881997299372, -8.575449718618875, -29.382447758989017, -19.286838110000982, -24.62106798636755, -23.41798314823802, -16.528535755859544, -1.5856432917142653, -33.89042245495685, -6.884086525111492, -18.392759199959222, -16.509872471978, -21.216072711734135, -20.476555901855342, -11.759303470279463, -20.763839679002015, -21.035532154105557, -28.574398768415225, -11.464402670950967, -21.315188562733123, -6.472436966489367, -18.214554588281956, -18.092604850407962, -6.04012607862649, -19.46293600673618, -11.232527548111277, -35.80129128665123, -31.467705427947294, -8.693285040340605, -8.982016817857504, -18.268784623275987, -23.98705103779212, -8.315944231473418, -11.006797018203155, -31.08430607473095, -25.236901277178934, -8.752992471693, -33.21131173009077, -12.86396859424918, -34.35110596514315, -21.57915865679176, -9.81024480050122, -25.32972315186878, -3.772278110990968, -15.023056277940498, -13.283211024726953, -14.264582630541875, -26.065488778627188, 2.2163877657375584, -22.478985789856274, -24.15955229418855, -22.72064008449768, -14.709702768033633, -30.144961412066774, 3.8415285330897238, -11.03656274559534, -29.72972301789457, -32.461920232998175, -3.033872702581246, -23.196015302330657, -23.965371143228904, -18.89480401078499, -25.340868478025552, -16.21981030517517, -33.27522453905548, -10.26062907104662, -28.19527580020825, -17.84150470679526, -8.256787256154766, -51.67492665547603, -31.06233014139007, -22.154841679234305, -27.89363772243714, -43.025374960222315, -8.030515537947675, -29.633989515977806, -15.76880547215082, -29.413540131125693], "policy_predator_policy_reward": [22.374460990634233, 17.26619912078417, 7.5728332649583505, 48.34818107186297, 22.930509977902787, 22.72787909468824, 16.492311996138728, 17.295963198654295, 35.75765404657622, 12.767384416939292, -3.4773656630633614, 4.486561341073804, 23.937738327132394, 2.893699216591475, 4.869569730672607, 43.42964220470052, 8.556760876444189, 10.12909220738777, 19.52137315142208, 21.857381658513454, 46.82013151568381, 18.180136414730057, 9.943821703744751, 28.366370101698244, 29.13502149399125, 27.219127652740973, 27.654340789076233, 18.233981862618613, 19.241252411655687, 18.621042261716497, 3.510017040936747, 9.7076066617278, 2.3619517269489023, 19.421777478913697, 40.43576762374083, 12.68030850890909, 5.408917047090643, 22.71394725482396, 32.687603207419976, -2.225995886752717, 5.03071606644696, 6.576160985877198, 21.28185554126975, 19.908813818474787, 17.510097995501287, 18.815665999097487, 14.527844380139392, 2.623055057098364, 27.377682081352077, 31.387213436625956, 21.149984207279783, 17.42369201272222, 37.80210688119393, 11.440029091541147, 26.205541146202755, 20.630425150273346, 15.60103613211793, 17.456035379601193, 3.4754516436691825, -0.30416506024065537, 23.082614222965738, 44.69823068694793, 7.3560552248784425, 6.412117825344536, 13.939389062879943, 22.846129337038505, 27.51259492030914, 5.507150023646868, 16.407186333144487, 26.024959090323776, 17.178599113835546, 23.774512689875145, 13.908941983548644, 9.609664957010311, 27.855473446515894, 13.672205911488154, 19.00367539113791, 23.06738891707326, 25.17831110190692, 31.97048643492351, 20.75166765036197, 2.1771376915399543, 21.96436829174149, 20.66600883372476, 6.967887644490654, 5.976986288488086, 7.149422180922884, 29.279686995641022, 11.145549174136125, 25.039660526679828, 14.898798385508073, -2.8185462282550895, 18.93601462946272, 19.989857384009632, 7.34947628091333, 15.115578815309206, 29.802057508674608, 41.800525064627855, 30.413614790013348, 32.52179606588122, 3.680341209725354, 13.706228870955876, 7.46587680438849, 10.49815683132654, 11.473226047653792, 25.064343198898218, 21.49752726382828, 26.476574811755953, 8.66613194784939, 7.965756515097452, 2.522168613321587, 19.491425423084717, 20.114321238142487, 42.05429091131938, 24.44986167865829, 26.023940875699587, -0.33161472728674113, 17.837599670672734, 28.736423224156994, 37.686200236024526, 13.147470819853536, 12.58046636864484, 42.22681142003465, 26.475400510251568, 19.99010196921816, 23.16821534436537, 14.174675240463705, 5.4458143605387335, 30.568818537741482, 20.090627765996103, 7.475691969297145, 0.06886425268479801, 23.186271429540792, 6.8598411263402035, 0.434924987249671, 26.1314970622042, 13.493186522296304, 15.035978738787454, 20.340066069722877, 31.790911487531513, -1.7615812073535384, -2.6711943241215836, 27.32077562373798, 17.63719595597454, 37.28787940082965, 11.031225187547495, 35.63457337818498, 9.80670679081038, 13.729503219935879, 15.689902316131379, 13.618002135338608, 46.67192068879492, -0.7326210938120878, -6.950435972367355, 17.01821717473416, 5.0549083164564985, 33.55065395760704, 25.908792078182167, 45.94633885728574, 18.977501608710515, 13.96159746765099, -7.893852062488499, 18.858038192815044, 27.5339924118463, 28.789353942765672, 19.141388343692157, 3.3060276790207244, 34.483580342549324, 14.496412171645668, 36.18532478440538, 6.53399706644519, 25.90562354390515, 40.710910661098204, 25.839538417012765, 21.416817608542644, -0.8955594664494173, 26.265110391710422, 30.12544120870612, 1.1712387113728728, 34.511770702217596, 16.233088128775357, 0.28048638353418376, 51.958543372597, 51.391309938355064, 21.51263086439579, 40.61202941838437, 30.154155122178867, 14.155528236289742, 11.739811514885805, 44.04746392998846, 47.098651302204004, 38.95209861824058, 7.509991713983936, 8.551039361911425, 27.698006326923693, 31.56997270503197, 9.28595272738519, 22.251658216916404, 21.277708106524962, 37.54937215572639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6203791795521912, "mean_inference_ms": 1.618347661100537, "mean_action_processing_ms": 0.254253999723185, "mean_env_wait_ms": 0.1452486361750476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067789554595947266, "StateBufferConnector_ms": 0.0048667192459106445, "ViewRequirementAgentConnector_ms": 0.12008333206176758}, "num_episodes": 18, "episode_return_max": 51.674926655476035, "episode_return_min": -3.8415285330897184, "episode_return_mean": 19.243581823398404, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.71352411725985, "num_env_steps_trained_throughput_per_sec": 364.71352411725985, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 11445.831, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11445.648, "sample_time_ms": 1293.177, "learn_time_ms": 10130.619, "learn_throughput": 394.843, "synch_weights_time_ms": 20.286}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 35, "trial_id": "06536_00000", "date": "2024-08-11_16-40-51", "timestamp": 1723408851, "time_this_iter_s": 11.006068229675293, "time_total_s": 396.855765581131, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb0430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 396.855765581131, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 51.6375, "ram_util_percent": 82.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1876038489863276, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.574190470793595, "policy_loss": -0.005445103487484933, "vf_loss": 1.5795604105728367, "vf_explained_var": 0.9617046561092139, "kl": 0.0060129410603243505, "entropy": 0.6704672796030839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.294696543992512, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7622513211908795, "policy_loss": -0.003523829958781048, "vf_loss": 1.765774086101976, "vf_explained_var": 0.9661061566973489, "kl": 0.0054619331395876535, "entropy": 0.4547936421380472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 51.674926655476035, "episode_reward_min": -4.564627755872639, "episode_reward_mean": 19.89300675413607, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.67492665547603, "predator_policy": -9.494518118894646}, "policy_reward_max": {"prey_policy": 4.564627755872642, "predator_policy": 54.869311967950466}, "policy_reward_mean": {"prey_policy": -19.893006754136067, "predator_policy": 19.893006754136067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.162881997299372, 8.575449718618868, 29.382447758989045, 19.28683811000102, 24.621067986367503, 23.417983148238065, 16.52853575585957, 1.5856432917142662, 33.89042245495685, 6.884086525111487, 18.392759199959208, 16.50987247197802, 21.216072711734128, 20.47655590185535, 11.759303470279479, 20.763839679002032, 21.03553215410559, 28.57439876841523, 11.464402670950973, 21.315188562733127, 6.472436966489373, 18.21455458828193, 18.092604850408005, 6.040126078626485, 19.462936006736157, 11.232527548111277, 35.80129128665124, 31.467705427947294, 8.693285040340603, 8.982016817857499, 18.268784623275995, 23.987051037792135, 8.315944231473415, 11.00679701820318, 31.08430607473087, 25.236901277179008, 8.752992471692988, 33.21131173009081, 12.863968594249203, 34.35110596514311, 21.579158656791773, 9.810244800501213, 25.32972315186878, 3.7722781109909715, 15.023056277940483, 13.28321102472687, 14.264582630541888, 26.065488778627216, -2.2163877657375606, 22.47898578985626, 24.15955229418854, 22.720640084497646, 14.709702768033624, 30.14496141206679, -3.8415285330897184, 11.036562745595342, 29.729723017894603, 32.46192023299809, 3.033872702581246, 23.196015302330682, 23.965371143228907, 18.89480401078503, 25.340868478025513, 16.21981030517518, 33.275224539055486, 10.260629071046587, 28.19527580020828, 17.841504706795195, 8.256787256154759, 51.674926655476035, 31.06233014139012, 22.15484167923426, 27.893637722437106, 43.025374960222265, 8.030515537947707, 29.633989515977863, 15.768805472150818, 29.413540131125647, 27.31835084034912, 13.36222521677986, 27.256403126832044, 11.15898506453274, 20.895543489659403, 17.79272783117207, 4.467717815750781, 30.40878625241656, 24.691193551334383, 31.14251486771643, 35.984814661972464, 27.315055496948997, 10.774632738855766, 14.91150205643855, 38.0182266477513, 37.93100271074775, 31.52875249329733, 16.93272977928622, 14.891860041700124, 17.85655454119172, 16.193793361654567, -4.564627755872639], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.162881997299372, -8.575449718618875, -29.382447758989017, -19.286838110000982, -24.62106798636755, -23.41798314823802, -16.528535755859544, -1.5856432917142653, -33.89042245495685, -6.884086525111492, -18.392759199959222, -16.509872471978, -21.216072711734135, -20.476555901855342, -11.759303470279463, -20.763839679002015, -21.035532154105557, -28.574398768415225, -11.464402670950967, -21.315188562733123, -6.472436966489367, -18.214554588281956, -18.092604850407962, -6.04012607862649, -19.46293600673618, -11.232527548111277, -35.80129128665123, -31.467705427947294, -8.693285040340605, -8.982016817857504, -18.268784623275987, -23.98705103779212, -8.315944231473418, -11.006797018203155, -31.08430607473095, -25.236901277178934, -8.752992471693, -33.21131173009077, -12.86396859424918, -34.35110596514315, -21.57915865679176, -9.81024480050122, -25.32972315186878, -3.772278110990968, -15.023056277940498, -13.283211024726953, -14.264582630541875, -26.065488778627188, 2.2163877657375584, -22.478985789856274, -24.15955229418855, -22.72064008449768, -14.709702768033633, -30.144961412066774, 3.8415285330897238, -11.03656274559534, -29.72972301789457, -32.461920232998175, -3.033872702581246, -23.196015302330657, -23.965371143228904, -18.89480401078499, -25.340868478025552, -16.21981030517517, -33.27522453905548, -10.26062907104662, -28.19527580020825, -17.84150470679526, -8.256787256154766, -51.67492665547603, -31.06233014139007, -22.154841679234305, -27.89363772243714, -43.025374960222315, -8.030515537947675, -29.633989515977806, -15.76880547215082, -29.413540131125693, -27.318350840349076, -13.362225216779887, -27.25640312683204, -11.158985064532741, -20.895543489659403, -17.792727831172066, -4.467717815750786, -30.408786252416597, -24.69119355133435, -31.1425148677165, -35.98481466197245, -27.31505549694899, -10.77463273885574, -14.911502056438554, -38.01822664775128, -37.93100271074765, -31.528752493297336, -16.932729779286205, -14.891860041700102, -17.856554541191727, -16.193793361654556, 4.564627755872642], "policy_predator_policy_reward": [17.510097995501287, 18.815665999097487, 14.527844380139392, 2.623055057098364, 27.377682081352077, 31.387213436625956, 21.149984207279783, 17.42369201272222, 37.80210688119393, 11.440029091541147, 26.205541146202755, 20.630425150273346, 15.60103613211793, 17.456035379601193, 3.4754516436691825, -0.30416506024065537, 23.082614222965738, 44.69823068694793, 7.3560552248784425, 6.412117825344536, 13.939389062879943, 22.846129337038505, 27.51259492030914, 5.507150023646868, 16.407186333144487, 26.024959090323776, 17.178599113835546, 23.774512689875145, 13.908941983548644, 9.609664957010311, 27.855473446515894, 13.672205911488154, 19.00367539113791, 23.06738891707326, 25.17831110190692, 31.97048643492351, 20.75166765036197, 2.1771376915399543, 21.96436829174149, 20.66600883372476, 6.967887644490654, 5.976986288488086, 7.149422180922884, 29.279686995641022, 11.145549174136125, 25.039660526679828, 14.898798385508073, -2.8185462282550895, 18.93601462946272, 19.989857384009632, 7.34947628091333, 15.115578815309206, 29.802057508674608, 41.800525064627855, 30.413614790013348, 32.52179606588122, 3.680341209725354, 13.706228870955876, 7.46587680438849, 10.49815683132654, 11.473226047653792, 25.064343198898218, 21.49752726382828, 26.476574811755953, 8.66613194784939, 7.965756515097452, 2.522168613321587, 19.491425423084717, 20.114321238142487, 42.05429091131938, 24.44986167865829, 26.023940875699587, -0.33161472728674113, 17.837599670672734, 28.736423224156994, 37.686200236024526, 13.147470819853536, 12.58046636864484, 42.22681142003465, 26.475400510251568, 19.99010196921816, 23.16821534436537, 14.174675240463705, 5.4458143605387335, 30.568818537741482, 20.090627765996103, 7.475691969297145, 0.06886425268479801, 23.186271429540792, 6.8598411263402035, 0.434924987249671, 26.1314970622042, 13.493186522296304, 15.035978738787454, 20.340066069722877, 31.790911487531513, -1.7615812073535384, -2.6711943241215836, 27.32077562373798, 17.63719595597454, 37.28787940082965, 11.031225187547495, 35.63457337818498, 9.80670679081038, 13.729503219935879, 15.689902316131379, 13.618002135338608, 46.67192068879492, -0.7326210938120878, -6.950435972367355, 17.01821717473416, 5.0549083164564985, 33.55065395760704, 25.908792078182167, 45.94633885728574, 18.977501608710515, 13.96159746765099, -7.893852062488499, 18.858038192815044, 27.5339924118463, 28.789353942765672, 19.141388343692157, 3.3060276790207244, 34.483580342549324, 14.496412171645668, 36.18532478440538, 6.53399706644519, 25.90562354390515, 40.710910661098204, 25.839538417012765, 21.416817608542644, -0.8955594664494173, 26.265110391710422, 30.12544120870612, 1.1712387113728728, 34.511770702217596, 16.233088128775357, 0.28048638353418376, 51.958543372597, 51.391309938355064, 21.51263086439579, 40.61202941838437, 30.154155122178867, 14.155528236289742, 11.739811514885805, 44.04746392998846, 47.098651302204004, 38.95209861824058, 7.509991713983936, 8.551039361911425, 27.698006326923693, 31.56997270503197, 9.28595272738519, 22.251658216916404, 21.277708106524962, 37.54937215572639, 13.284642475206606, 41.352059205491564, 3.5051902608773338, 23.219260172682425, 15.184455301921837, 39.32835095174225, 1.4731389744264707, 20.84483115463903, 15.331273980947104, 26.45981299837171, 39.021143183334075, -3.435687520989968, 8.78506395174427, 0.15037167975729915, 12.199348482724776, 48.618224022108414, 33.14393696103803, 16.238450141630693, 54.869311967950466, 7.415717767482501, 31.02359383783144, 40.946035486113466, 46.08502284402541, 8.545088149872562, 5.191933334698861, 16.35733214301267, 16.824484947545436, 12.998519165331665, 35.162536813771, 40.87391648173154, 31.764493526595178, 44.09751189490021, 26.584090504800308, 36.47341448179436, 21.18534141853614, 12.680118140036287, 6.0646112966214165, 23.71910878677879, 30.016366068789054, 5.696743013594412, 20.582941415445532, 11.804645307863595, -9.494518118894646, 0.3652626071493694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6198327195129218, "mean_inference_ms": 1.6174272862157266, "mean_action_processing_ms": 0.25428532038720014, "mean_env_wait_ms": 0.14496951767210928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552696228027344, "StateBufferConnector_ms": 0.004353642463684082, "ViewRequirementAgentConnector_ms": 0.10692167282104492}, "num_episodes": 22, "episode_return_max": 51.674926655476035, "episode_return_min": -4.564627755872639, "episode_return_mean": 19.89300675413607, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.1023116941092, "num_env_steps_trained_throughput_per_sec": 381.1023116941092, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 11408.135, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11407.952, "sample_time_ms": 1275.372, "learn_time_ms": 10110.68, "learn_throughput": 395.621, "synch_weights_time_ms": 20.285}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 36, "trial_id": "06536_00000", "date": "2024-08-11_16-41-02", "timestamp": 1723408862, "time_this_iter_s": 10.533198118209839, "time_total_s": 407.3889636993408, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fea8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 407.3889636993408, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 46.24, "ram_util_percent": 82.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.14425860196352, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7200170315181216, "policy_loss": -0.005526870365914268, "vf_loss": 1.7254573575531442, "vf_explained_var": 0.9315458344295621, "kl": 0.006923834500164905, "entropy": 0.5500552013826867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.174006955270414, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.761959567114159, "policy_loss": -0.0033114260220259584, "vf_loss": 1.7652701009833625, "vf_explained_var": 0.9530525584069509, "kl": 0.004590824606058541, "entropy": 0.39192075338313187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "env_runners": {"episode_reward_max": 51.674926655476035, "episode_reward_min": -4.564627755872639, "episode_reward_mean": 18.941548740295016, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.67492665547603, "predator_policy": -10.914794827420996}, "policy_reward_max": {"prey_policy": 4.564627755872642, "predator_policy": 54.869311967950466}, "policy_reward_mean": {"prey_policy": -18.941548740295016, "predator_policy": 18.941548740295016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.040126078626485, 19.462936006736157, 11.232527548111277, 35.80129128665124, 31.467705427947294, 8.693285040340603, 8.982016817857499, 18.268784623275995, 23.987051037792135, 8.315944231473415, 11.00679701820318, 31.08430607473087, 25.236901277179008, 8.752992471692988, 33.21131173009081, 12.863968594249203, 34.35110596514311, 21.579158656791773, 9.810244800501213, 25.32972315186878, 3.7722781109909715, 15.023056277940483, 13.28321102472687, 14.264582630541888, 26.065488778627216, -2.2163877657375606, 22.47898578985626, 24.15955229418854, 22.720640084497646, 14.709702768033624, 30.14496141206679, -3.8415285330897184, 11.036562745595342, 29.729723017894603, 32.46192023299809, 3.033872702581246, 23.196015302330682, 23.965371143228907, 18.89480401078503, 25.340868478025513, 16.21981030517518, 33.275224539055486, 10.260629071046587, 28.19527580020828, 17.841504706795195, 8.256787256154759, 51.674926655476035, 31.06233014139012, 22.15484167923426, 27.893637722437106, 43.025374960222265, 8.030515537947707, 29.633989515977863, 15.768805472150818, 29.413540131125647, 27.31835084034912, 13.36222521677986, 27.256403126832044, 11.15898506453274, 20.895543489659403, 17.79272783117207, 4.467717815750781, 30.40878625241656, 24.691193551334383, 31.14251486771643, 35.984814661972464, 27.315055496948997, 10.774632738855766, 14.91150205643855, 38.0182266477513, 37.93100271074775, 31.52875249329733, 16.93272977928622, 14.891860041700124, 17.85655454119172, 16.193793361654567, -4.564627755872639, 4.621081044205978, 15.825424920188649, 12.570150900631006, 17.94306092575403, 17.237987380974793, 15.856775355658865, 4.0866535381348195, 12.58538096317072, 27.69454246741904, 15.164916644284375, 10.423295108786037, 11.14209461036777, 21.797236984765778, 0.8701988382491526, 31.295662931539336, 10.512530637578335, 9.151429474580116, 12.435078019048364, 5.517386491049785, 17.867318214291053, 21.65807497772687, 9.415033417222519, 15.805763513615867], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.04012607862649, -19.46293600673618, -11.232527548111277, -35.80129128665123, -31.467705427947294, -8.693285040340605, -8.982016817857504, -18.268784623275987, -23.98705103779212, -8.315944231473418, -11.006797018203155, -31.08430607473095, -25.236901277178934, -8.752992471693, -33.21131173009077, -12.86396859424918, -34.35110596514315, -21.57915865679176, -9.81024480050122, -25.32972315186878, -3.772278110990968, -15.023056277940498, -13.283211024726953, -14.264582630541875, -26.065488778627188, 2.2163877657375584, -22.478985789856274, -24.15955229418855, -22.72064008449768, -14.709702768033633, -30.144961412066774, 3.8415285330897238, -11.03656274559534, -29.72972301789457, -32.461920232998175, -3.033872702581246, -23.196015302330657, -23.965371143228904, -18.89480401078499, -25.340868478025552, -16.21981030517517, -33.27522453905548, -10.26062907104662, -28.19527580020825, -17.84150470679526, -8.256787256154766, -51.67492665547603, -31.06233014139007, -22.154841679234305, -27.89363772243714, -43.025374960222315, -8.030515537947675, -29.633989515977806, -15.76880547215082, -29.413540131125693, -27.318350840349076, -13.362225216779887, -27.25640312683204, -11.158985064532741, -20.895543489659403, -17.792727831172066, -4.467717815750786, -30.408786252416597, -24.69119355133435, -31.1425148677165, -35.98481466197245, -27.31505549694899, -10.77463273885574, -14.911502056438554, -38.01822664775128, -37.93100271074765, -31.528752493297336, -16.932729779286205, -14.891860041700102, -17.856554541191727, -16.193793361654556, 4.564627755872642, -4.621081044205987, -15.825424920188649, -12.570150900630997, -17.943060925754054, -17.2379873809748, -15.856775355658867, -4.086653538134839, -12.58538096317072, -27.694542467419037, -15.164916644284382, -10.423295108786046, -11.142094610367776, -21.79723698476574, -0.870198838249159, -31.29566293153931, -10.512530637578386, -9.151429474580112, -12.435078019048351, -5.517386491049782, -17.86731821429105, -21.658074977726844, -9.415033417222528, -15.80576351361586], "policy_predator_policy_reward": [14.898798385508073, -2.8185462282550895, 18.93601462946272, 19.989857384009632, 7.34947628091333, 15.115578815309206, 29.802057508674608, 41.800525064627855, 30.413614790013348, 32.52179606588122, 3.680341209725354, 13.706228870955876, 7.46587680438849, 10.49815683132654, 11.473226047653792, 25.064343198898218, 21.49752726382828, 26.476574811755953, 8.66613194784939, 7.965756515097452, 2.522168613321587, 19.491425423084717, 20.114321238142487, 42.05429091131938, 24.44986167865829, 26.023940875699587, -0.33161472728674113, 17.837599670672734, 28.736423224156994, 37.686200236024526, 13.147470819853536, 12.58046636864484, 42.22681142003465, 26.475400510251568, 19.99010196921816, 23.16821534436537, 14.174675240463705, 5.4458143605387335, 30.568818537741482, 20.090627765996103, 7.475691969297145, 0.06886425268479801, 23.186271429540792, 6.8598411263402035, 0.434924987249671, 26.1314970622042, 13.493186522296304, 15.035978738787454, 20.340066069722877, 31.790911487531513, -1.7615812073535384, -2.6711943241215836, 27.32077562373798, 17.63719595597454, 37.28787940082965, 11.031225187547495, 35.63457337818498, 9.80670679081038, 13.729503219935879, 15.689902316131379, 13.618002135338608, 46.67192068879492, -0.7326210938120878, -6.950435972367355, 17.01821717473416, 5.0549083164564985, 33.55065395760704, 25.908792078182167, 45.94633885728574, 18.977501608710515, 13.96159746765099, -7.893852062488499, 18.858038192815044, 27.5339924118463, 28.789353942765672, 19.141388343692157, 3.3060276790207244, 34.483580342549324, 14.496412171645668, 36.18532478440538, 6.53399706644519, 25.90562354390515, 40.710910661098204, 25.839538417012765, 21.416817608542644, -0.8955594664494173, 26.265110391710422, 30.12544120870612, 1.1712387113728728, 34.511770702217596, 16.233088128775357, 0.28048638353418376, 51.958543372597, 51.391309938355064, 21.51263086439579, 40.61202941838437, 30.154155122178867, 14.155528236289742, 11.739811514885805, 44.04746392998846, 47.098651302204004, 38.95209861824058, 7.509991713983936, 8.551039361911425, 27.698006326923693, 31.56997270503197, 9.28595272738519, 22.251658216916404, 21.277708106524962, 37.54937215572639, 13.284642475206606, 41.352059205491564, 3.5051902608773338, 23.219260172682425, 15.184455301921837, 39.32835095174225, 1.4731389744264707, 20.84483115463903, 15.331273980947104, 26.45981299837171, 39.021143183334075, -3.435687520989968, 8.78506395174427, 0.15037167975729915, 12.199348482724776, 48.618224022108414, 33.14393696103803, 16.238450141630693, 54.869311967950466, 7.415717767482501, 31.02359383783144, 40.946035486113466, 46.08502284402541, 8.545088149872562, 5.191933334698861, 16.35733214301267, 16.824484947545436, 12.998519165331665, 35.162536813771, 40.87391648173154, 31.764493526595178, 44.09751189490021, 26.584090504800308, 36.47341448179436, 21.18534141853614, 12.680118140036287, 6.0646112966214165, 23.71910878677879, 30.016366068789054, 5.696743013594412, 20.582941415445532, 11.804645307863595, -9.494518118894646, 0.3652626071493694, -10.914794827420996, 20.15695691583298, 18.251912060961704, 13.398937779415595, 5.449554529982755, 19.690747271279257, 20.840978022095264, 15.045143829412826, 9.811498893221083, 24.66447586872853, 9.094943723981118, 22.618606987336612, 5.465818156189869, 2.7074889200798182, 9.431764033030948, 15.738997893310518, 43.80426333098894, 11.584821603849106, 8.644011350057431, 21.68582193851132, 23.03625419451603, -2.189663976943933, 24.072400165110356, -1.788210944374799, 12.774076056637586, 30.82039791289386, 3.262929955227175, -1.522532278728855, 37.28087147731756, 25.310454385761094, -0.38242925110540593, 21.407490526262166, 13.74495389634643, 4.557905052813796, 17.37980589515176, 7.4903501429449495, -2.009855184342719, 13.044628166442289, 17.121056293902086, 18.613580134680035, 26.432315173187636, 16.883834782266035, 5.616625970102815, 13.213440864342232, 8.819164927372366, 22.79236209985935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6190606204452529, "mean_inference_ms": 1.6251063873238767, "mean_action_processing_ms": 0.25392227526013594, "mean_env_wait_ms": 0.1448547935731815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006129026412963867, "StateBufferConnector_ms": 0.003093719482421875, "ViewRequirementAgentConnector_ms": 0.09191417694091797}, "num_episodes": 23, "episode_return_max": 51.674926655476035, "episode_return_min": -4.564627755872639, "episode_return_mean": 18.941548740295016, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.7481374976402, "num_env_steps_trained_throughput_per_sec": 347.7481374976402, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 11472.73, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11472.629, "sample_time_ms": 1317.838, "learn_time_ms": 10134.362, "learn_throughput": 394.697, "synch_weights_time_ms": 18.85}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "training_iteration": 37, "trial_id": "06536_00000", "date": "2024-08-11_16-41-13", "timestamp": 1723408873, "time_this_iter_s": 11.514498949050903, "time_total_s": 418.9034626483917, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331109820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 418.9034626483917, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 49.63125, "ram_util_percent": 81.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.21951301228255, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6981366932392121, "policy_loss": -0.01028013755712891, "vf_loss": 1.7082897638902068, "vf_explained_var": 0.9500527050967018, "kl": 0.010165444787681447, "entropy": 0.5860296412991981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.192161369197583, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6726617708092644, "policy_loss": -0.0009778954558044908, "vf_loss": 1.673639339618582, "vf_explained_var": 0.9636356725579216, "kl": 0.0033755614264480965, "entropy": 0.38571322913523076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 51.674926655476035, "episode_reward_min": -4.564627755872639, "episode_reward_mean": 19.02638305090055, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.67492665547603, "predator_policy": -10.914794827420996}, "policy_reward_max": {"prey_policy": 4.564627755872642, "predator_policy": 54.869311967950466}, "policy_reward_mean": {"prey_policy": -19.026383050900552, "predator_policy": 19.02638305090055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.810244800501213, 25.32972315186878, 3.7722781109909715, 15.023056277940483, 13.28321102472687, 14.264582630541888, 26.065488778627216, -2.2163877657375606, 22.47898578985626, 24.15955229418854, 22.720640084497646, 14.709702768033624, 30.14496141206679, -3.8415285330897184, 11.036562745595342, 29.729723017894603, 32.46192023299809, 3.033872702581246, 23.196015302330682, 23.965371143228907, 18.89480401078503, 25.340868478025513, 16.21981030517518, 33.275224539055486, 10.260629071046587, 28.19527580020828, 17.841504706795195, 8.256787256154759, 51.674926655476035, 31.06233014139012, 22.15484167923426, 27.893637722437106, 43.025374960222265, 8.030515537947707, 29.633989515977863, 15.768805472150818, 29.413540131125647, 27.31835084034912, 13.36222521677986, 27.256403126832044, 11.15898506453274, 20.895543489659403, 17.79272783117207, 4.467717815750781, 30.40878625241656, 24.691193551334383, 31.14251486771643, 35.984814661972464, 27.315055496948997, 10.774632738855766, 14.91150205643855, 38.0182266477513, 37.93100271074775, 31.52875249329733, 16.93272977928622, 14.891860041700124, 17.85655454119172, 16.193793361654567, -4.564627755872639, 4.621081044205978, 15.825424920188649, 12.570150900631006, 17.94306092575403, 17.237987380974793, 15.856775355658865, 4.0866535381348195, 12.58538096317072, 27.69454246741904, 15.164916644284375, 10.423295108786037, 11.14209461036777, 21.797236984765778, 0.8701988382491526, 31.295662931539336, 10.512530637578335, 9.151429474580116, 12.435078019048364, 5.517386491049785, 17.867318214291053, 21.65807497772687, 9.415033417222519, 15.805763513615867, 25.370285331873262, 9.539405107699398, 28.744801391514525, 13.038763711057381, 20.867327089222858, 18.179768619788028, 10.97764745566169, 24.783556633418808, 35.893741695991544, 25.187521580766923, 6.224239928125316, 24.53927075170222, 6.13358505036815, 37.57193757962822, 23.63792431031637, 29.430865063152588, 7.856545907724067, 10.84445373943479], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.81024480050122, -25.32972315186878, -3.772278110990968, -15.023056277940498, -13.283211024726953, -14.264582630541875, -26.065488778627188, 2.2163877657375584, -22.478985789856274, -24.15955229418855, -22.72064008449768, -14.709702768033633, -30.144961412066774, 3.8415285330897238, -11.03656274559534, -29.72972301789457, -32.461920232998175, -3.033872702581246, -23.196015302330657, -23.965371143228904, -18.89480401078499, -25.340868478025552, -16.21981030517517, -33.27522453905548, -10.26062907104662, -28.19527580020825, -17.84150470679526, -8.256787256154766, -51.67492665547603, -31.06233014139007, -22.154841679234305, -27.89363772243714, -43.025374960222315, -8.030515537947675, -29.633989515977806, -15.76880547215082, -29.413540131125693, -27.318350840349076, -13.362225216779887, -27.25640312683204, -11.158985064532741, -20.895543489659403, -17.792727831172066, -4.467717815750786, -30.408786252416597, -24.69119355133435, -31.1425148677165, -35.98481466197245, -27.31505549694899, -10.77463273885574, -14.911502056438554, -38.01822664775128, -37.93100271074765, -31.528752493297336, -16.932729779286205, -14.891860041700102, -17.856554541191727, -16.193793361654556, 4.564627755872642, -4.621081044205987, -15.825424920188649, -12.570150900630997, -17.943060925754054, -17.2379873809748, -15.856775355658867, -4.086653538134839, -12.58538096317072, -27.694542467419037, -15.164916644284382, -10.423295108786046, -11.142094610367776, -21.79723698476574, -0.870198838249159, -31.29566293153931, -10.512530637578386, -9.151429474580112, -12.435078019048351, -5.517386491049782, -17.86731821429105, -21.658074977726844, -9.415033417222528, -15.80576351361586, -25.37028533187321, -9.5394051076994, -28.744801391514557, -13.038763711057367, -20.867327089222883, -18.179768619788, -10.977647455661707, -24.783556633418833, -35.89374169599151, -25.187521580766944, -6.22423992812532, -24.53927075170224, -6.13358505036817, -37.57193757962827, -23.63792431031641, -29.430865063152595, -7.856545907724086, -10.844453739434796], "policy_predator_policy_reward": [14.174675240463705, 5.4458143605387335, 30.568818537741482, 20.090627765996103, 7.475691969297145, 0.06886425268479801, 23.186271429540792, 6.8598411263402035, 0.434924987249671, 26.1314970622042, 13.493186522296304, 15.035978738787454, 20.340066069722877, 31.790911487531513, -1.7615812073535384, -2.6711943241215836, 27.32077562373798, 17.63719595597454, 37.28787940082965, 11.031225187547495, 35.63457337818498, 9.80670679081038, 13.729503219935879, 15.689902316131379, 13.618002135338608, 46.67192068879492, -0.7326210938120878, -6.950435972367355, 17.01821717473416, 5.0549083164564985, 33.55065395760704, 25.908792078182167, 45.94633885728574, 18.977501608710515, 13.96159746765099, -7.893852062488499, 18.858038192815044, 27.5339924118463, 28.789353942765672, 19.141388343692157, 3.3060276790207244, 34.483580342549324, 14.496412171645668, 36.18532478440538, 6.53399706644519, 25.90562354390515, 40.710910661098204, 25.839538417012765, 21.416817608542644, -0.8955594664494173, 26.265110391710422, 30.12544120870612, 1.1712387113728728, 34.511770702217596, 16.233088128775357, 0.28048638353418376, 51.958543372597, 51.391309938355064, 21.51263086439579, 40.61202941838437, 30.154155122178867, 14.155528236289742, 11.739811514885805, 44.04746392998846, 47.098651302204004, 38.95209861824058, 7.509991713983936, 8.551039361911425, 27.698006326923693, 31.56997270503197, 9.28595272738519, 22.251658216916404, 21.277708106524962, 37.54937215572639, 13.284642475206606, 41.352059205491564, 3.5051902608773338, 23.219260172682425, 15.184455301921837, 39.32835095174225, 1.4731389744264707, 20.84483115463903, 15.331273980947104, 26.45981299837171, 39.021143183334075, -3.435687520989968, 8.78506395174427, 0.15037167975729915, 12.199348482724776, 48.618224022108414, 33.14393696103803, 16.238450141630693, 54.869311967950466, 7.415717767482501, 31.02359383783144, 40.946035486113466, 46.08502284402541, 8.545088149872562, 5.191933334698861, 16.35733214301267, 16.824484947545436, 12.998519165331665, 35.162536813771, 40.87391648173154, 31.764493526595178, 44.09751189490021, 26.584090504800308, 36.47341448179436, 21.18534141853614, 12.680118140036287, 6.0646112966214165, 23.71910878677879, 30.016366068789054, 5.696743013594412, 20.582941415445532, 11.804645307863595, -9.494518118894646, 0.3652626071493694, -10.914794827420996, 20.15695691583298, 18.251912060961704, 13.398937779415595, 5.449554529982755, 19.690747271279257, 20.840978022095264, 15.045143829412826, 9.811498893221083, 24.66447586872853, 9.094943723981118, 22.618606987336612, 5.465818156189869, 2.7074889200798182, 9.431764033030948, 15.738997893310518, 43.80426333098894, 11.584821603849106, 8.644011350057431, 21.68582193851132, 23.03625419451603, -2.189663976943933, 24.072400165110356, -1.788210944374799, 12.774076056637586, 30.82039791289386, 3.262929955227175, -1.522532278728855, 37.28087147731756, 25.310454385761094, -0.38242925110540593, 21.407490526262166, 13.74495389634643, 4.557905052813796, 17.37980589515176, 7.4903501429449495, -2.009855184342719, 13.044628166442289, 17.121056293902086, 18.613580134680035, 26.432315173187636, 16.883834782266035, 5.616625970102815, 13.213440864342232, 8.819164927372366, 22.79236209985935, 29.671863742075058, 21.068706921671428, 17.871657829688765, 1.2071523857100903, 27.04083558912459, 30.44876719390448, 3.533507110125244, 22.54402031198949, 15.790403614815888, 25.94425056362989, 21.7365641583821, 14.622973081193905, 22.579618594391352, -0.6243236830679182, 28.485112898749158, 21.082000368088462, 33.91252270121052, 37.87496069077252, 28.27667236467242, 22.098370796861488, 1.6197199898181829, 10.828759866432454, 28.18163351704723, 20.896907986357242, 2.83254572046698, 9.434624380269346, 32.38704906150821, 42.75682609774822, 25.639574393036774, 21.63627422759601, 41.6942776127868, 17.167452513518377, -5.475891660039074, 21.188983475487213, 8.657547538483193, 13.03135994038639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6174321022022312, "mean_inference_ms": 1.628053114274244, "mean_action_processing_ms": 0.25311681950710535, "mean_env_wait_ms": 0.14437564123206775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00460970401763916, "StateBufferConnector_ms": 0.0031737089157104492, "ViewRequirementAgentConnector_ms": 0.09083724021911621}, "num_episodes": 18, "episode_return_max": 51.674926655476035, "episode_return_min": -4.564627755872639, "episode_return_mean": 19.02638305090055, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.8918860480495, "num_env_steps_trained_throughput_per_sec": 384.8918860480495, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 11321.084, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11320.978, "sample_time_ms": 1317.251, "learn_time_ms": 9982.634, "learn_throughput": 400.696, "synch_weights_time_ms": 19.52}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 38, "trial_id": "06536_00000", "date": "2024-08-11_16-41-24", "timestamp": 1723408884, "time_this_iter_s": 10.429873943328857, "time_total_s": 429.3333365917206, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331109ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 429.3333365917206, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 47.13333333333333, "ram_util_percent": 81.89333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9063065255681675, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7477286427592238, "policy_loss": -0.0061553978807448095, "vf_loss": 1.753801363768677, "vf_explained_var": 0.9411474971100688, "kl": 0.00661385012496339, "entropy": 0.5570116024153928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.95380713576993, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5274435253370375, "policy_loss": -0.0029314155712546336, "vf_loss": 1.5303747472939668, "vf_explained_var": 0.9705276793273038, "kl": 0.00390765470484925, "entropy": 0.3879406147375309, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "env_runners": {"episode_reward_max": 51.674926655476035, "episode_reward_min": -4.564627755872639, "episode_reward_mean": 19.632130974302743, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.67492665547603, "predator_policy": -10.914794827420996}, "policy_reward_max": {"prey_policy": 4.564627755872642, "predator_policy": 54.869311967950466}, "policy_reward_mean": {"prey_policy": -19.63213097430274, "predator_policy": 19.63213097430274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.196015302330682, 23.965371143228907, 18.89480401078503, 25.340868478025513, 16.21981030517518, 33.275224539055486, 10.260629071046587, 28.19527580020828, 17.841504706795195, 8.256787256154759, 51.674926655476035, 31.06233014139012, 22.15484167923426, 27.893637722437106, 43.025374960222265, 8.030515537947707, 29.633989515977863, 15.768805472150818, 29.413540131125647, 27.31835084034912, 13.36222521677986, 27.256403126832044, 11.15898506453274, 20.895543489659403, 17.79272783117207, 4.467717815750781, 30.40878625241656, 24.691193551334383, 31.14251486771643, 35.984814661972464, 27.315055496948997, 10.774632738855766, 14.91150205643855, 38.0182266477513, 37.93100271074775, 31.52875249329733, 16.93272977928622, 14.891860041700124, 17.85655454119172, 16.193793361654567, -4.564627755872639, 4.621081044205978, 15.825424920188649, 12.570150900631006, 17.94306092575403, 17.237987380974793, 15.856775355658865, 4.0866535381348195, 12.58538096317072, 27.69454246741904, 15.164916644284375, 10.423295108786037, 11.14209461036777, 21.797236984765778, 0.8701988382491526, 31.295662931539336, 10.512530637578335, 9.151429474580116, 12.435078019048364, 5.517386491049785, 17.867318214291053, 21.65807497772687, 9.415033417222519, 15.805763513615867, 25.370285331873262, 9.539405107699398, 28.744801391514525, 13.038763711057381, 20.867327089222858, 18.179768619788028, 10.97764745566169, 24.783556633418808, 35.893741695991544, 25.187521580766923, 6.224239928125316, 24.53927075170222, 6.13358505036815, 37.57193757962822, 23.63792431031637, 29.430865063152588, 7.856545907724067, 10.84445373943479, 18.347394298696404, 24.366804816494874, 25.322209310422863, 38.02499920510035, 7.348022183306748, 26.34472063111576, 19.202538744394683, 16.087799343119947, 20.588659377070236, 7.464194346589565, 16.180416878099138, 8.576804253462445, 29.356696024857204, 18.02578083860073, 11.068317470687404, 24.55727250460989, 6.159195788256919, 35.51955584941646], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.196015302330657, -23.965371143228904, -18.89480401078499, -25.340868478025552, -16.21981030517517, -33.27522453905548, -10.26062907104662, -28.19527580020825, -17.84150470679526, -8.256787256154766, -51.67492665547603, -31.06233014139007, -22.154841679234305, -27.89363772243714, -43.025374960222315, -8.030515537947675, -29.633989515977806, -15.76880547215082, -29.413540131125693, -27.318350840349076, -13.362225216779887, -27.25640312683204, -11.158985064532741, -20.895543489659403, -17.792727831172066, -4.467717815750786, -30.408786252416597, -24.69119355133435, -31.1425148677165, -35.98481466197245, -27.31505549694899, -10.77463273885574, -14.911502056438554, -38.01822664775128, -37.93100271074765, -31.528752493297336, -16.932729779286205, -14.891860041700102, -17.856554541191727, -16.193793361654556, 4.564627755872642, -4.621081044205987, -15.825424920188649, -12.570150900630997, -17.943060925754054, -17.2379873809748, -15.856775355658867, -4.086653538134839, -12.58538096317072, -27.694542467419037, -15.164916644284382, -10.423295108786046, -11.142094610367776, -21.79723698476574, -0.870198838249159, -31.29566293153931, -10.512530637578386, -9.151429474580112, -12.435078019048351, -5.517386491049782, -17.86731821429105, -21.658074977726844, -9.415033417222528, -15.80576351361586, -25.37028533187321, -9.5394051076994, -28.744801391514557, -13.038763711057367, -20.867327089222883, -18.179768619788, -10.977647455661707, -24.783556633418833, -35.89374169599151, -25.187521580766944, -6.22423992812532, -24.53927075170224, -6.13358505036817, -37.57193757962827, -23.63792431031641, -29.430865063152595, -7.856545907724086, -10.844453739434796, -18.347394298696422, -24.36680481649484, -25.322209310422835, -38.02499920510032, -7.348022183306738, -26.344720631115724, -19.202538744394698, -16.087799343119922, -20.588659377070247, -7.464194346589553, -16.180416878099145, -8.576804253462456, -29.356696024857225, -18.02578083860074, -11.068317470687404, -24.55727250460991, -6.15919578825691, -35.51955584941647], "policy_predator_policy_reward": [18.858038192815044, 27.5339924118463, 28.789353942765672, 19.141388343692157, 3.3060276790207244, 34.483580342549324, 14.496412171645668, 36.18532478440538, 6.53399706644519, 25.90562354390515, 40.710910661098204, 25.839538417012765, 21.416817608542644, -0.8955594664494173, 26.265110391710422, 30.12544120870612, 1.1712387113728728, 34.511770702217596, 16.233088128775357, 0.28048638353418376, 51.958543372597, 51.391309938355064, 21.51263086439579, 40.61202941838437, 30.154155122178867, 14.155528236289742, 11.739811514885805, 44.04746392998846, 47.098651302204004, 38.95209861824058, 7.509991713983936, 8.551039361911425, 27.698006326923693, 31.56997270503197, 9.28595272738519, 22.251658216916404, 21.277708106524962, 37.54937215572639, 13.284642475206606, 41.352059205491564, 3.5051902608773338, 23.219260172682425, 15.184455301921837, 39.32835095174225, 1.4731389744264707, 20.84483115463903, 15.331273980947104, 26.45981299837171, 39.021143183334075, -3.435687520989968, 8.78506395174427, 0.15037167975729915, 12.199348482724776, 48.618224022108414, 33.14393696103803, 16.238450141630693, 54.869311967950466, 7.415717767482501, 31.02359383783144, 40.946035486113466, 46.08502284402541, 8.545088149872562, 5.191933334698861, 16.35733214301267, 16.824484947545436, 12.998519165331665, 35.162536813771, 40.87391648173154, 31.764493526595178, 44.09751189490021, 26.584090504800308, 36.47341448179436, 21.18534141853614, 12.680118140036287, 6.0646112966214165, 23.71910878677879, 30.016366068789054, 5.696743013594412, 20.582941415445532, 11.804645307863595, -9.494518118894646, 0.3652626071493694, -10.914794827420996, 20.15695691583298, 18.251912060961704, 13.398937779415595, 5.449554529982755, 19.690747271279257, 20.840978022095264, 15.045143829412826, 9.811498893221083, 24.66447586872853, 9.094943723981118, 22.618606987336612, 5.465818156189869, 2.7074889200798182, 9.431764033030948, 15.738997893310518, 43.80426333098894, 11.584821603849106, 8.644011350057431, 21.68582193851132, 23.03625419451603, -2.189663976943933, 24.072400165110356, -1.788210944374799, 12.774076056637586, 30.82039791289386, 3.262929955227175, -1.522532278728855, 37.28087147731756, 25.310454385761094, -0.38242925110540593, 21.407490526262166, 13.74495389634643, 4.557905052813796, 17.37980589515176, 7.4903501429449495, -2.009855184342719, 13.044628166442289, 17.121056293902086, 18.613580134680035, 26.432315173187636, 16.883834782266035, 5.616625970102815, 13.213440864342232, 8.819164927372366, 22.79236209985935, 29.671863742075058, 21.068706921671428, 17.871657829688765, 1.2071523857100903, 27.04083558912459, 30.44876719390448, 3.533507110125244, 22.54402031198949, 15.790403614815888, 25.94425056362989, 21.7365641583821, 14.622973081193905, 22.579618594391352, -0.6243236830679182, 28.485112898749158, 21.082000368088462, 33.91252270121052, 37.87496069077252, 28.27667236467242, 22.098370796861488, 1.6197199898181829, 10.828759866432454, 28.18163351704723, 20.896907986357242, 2.83254572046698, 9.434624380269346, 32.38704906150821, 42.75682609774822, 25.639574393036774, 21.63627422759601, 41.6942776127868, 17.167452513518377, -5.475891660039074, 21.188983475487213, 8.657547538483193, 13.03135994038639, 16.80390487646409, 19.89088372092875, 28.02131774307337, 20.712291889916322, 40.82442444097101, 9.819994179874659, 34.39495391739223, 41.65504449280841, 3.694646930529125, 11.001397436084366, 35.28500203268647, 17.404439229544955, 25.63153948503536, 12.773538003754044, 26.101149806491154, 6.074448879748705, 14.138460485874065, 27.03885826826643, 13.634600556103496, 1.2937881370756052, 6.9312146353326405, 25.429619120865656, 12.451761414492761, 4.701847092432146, 15.282896257424532, 43.430495792289875, 16.983448066566883, 19.06811361063457, 8.98823463542144, 13.148400305953366, 20.84851702021666, 28.266027989003124, -1.2752669425250058, 13.593658519038843, 48.55013299164319, 22.488978707189787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6187582588669414, "mean_inference_ms": 1.6373294199476913, "mean_action_processing_ms": 0.2534098314054885, "mean_env_wait_ms": 0.1444476503274733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005693912506103516, "StateBufferConnector_ms": 0.003319978713989258, "ViewRequirementAgentConnector_ms": 0.10922873020172119}, "num_episodes": 18, "episode_return_max": 51.674926655476035, "episode_return_min": -4.564627755872639, "episode_return_mean": 19.632130974302743, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.8146148858006, "num_env_steps_trained_throughput_per_sec": 324.8146148858006, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 11445.21, "restore_workers_time_ms": 0.019, "training_step_time_ms": 11445.101, "sample_time_ms": 1418.253, "learn_time_ms": 10007.013, "learn_throughput": 399.72, "synch_weights_time_ms": 18.223}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "training_iteration": 39, "trial_id": "06536_00000", "date": "2024-08-11_16-41-36", "timestamp": 1723408896, "time_this_iter_s": 12.359217882156372, "time_total_s": 441.69255447387695, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c1430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 441.69255447387695, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 56.422222222222224, "ram_util_percent": 83.00555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.473297467455268, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0992901515215636, "policy_loss": -0.0063389725764864124, "vf_loss": 2.1055282089859246, "vf_explained_var": 0.9425258008142312, "kl": 0.00807295442349802, "entropy": 0.6212104628483455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.483102949807253, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.079406077079672, "policy_loss": -0.0025785449278792217, "vf_loss": 2.081984555468988, "vf_explained_var": 0.9604279541780079, "kl": 0.004078705429743701, "entropy": 0.36801622670794293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 43.71096306784879, "episode_reward_min": -4.564627755872639, "episode_reward_mean": 18.697675185420007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.71096306784878, "predator_policy": -10.914794827420996}, "policy_reward_max": {"prey_policy": 4.564627755872642, "predator_policy": 54.869311967950466}, "policy_reward_mean": {"prey_policy": -18.697675185420007, "predator_policy": 18.697675185420007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.15898506453274, 20.895543489659403, 17.79272783117207, 4.467717815750781, 30.40878625241656, 24.691193551334383, 31.14251486771643, 35.984814661972464, 27.315055496948997, 10.774632738855766, 14.91150205643855, 38.0182266477513, 37.93100271074775, 31.52875249329733, 16.93272977928622, 14.891860041700124, 17.85655454119172, 16.193793361654567, -4.564627755872639, 4.621081044205978, 15.825424920188649, 12.570150900631006, 17.94306092575403, 17.237987380974793, 15.856775355658865, 4.0866535381348195, 12.58538096317072, 27.69454246741904, 15.164916644284375, 10.423295108786037, 11.14209461036777, 21.797236984765778, 0.8701988382491526, 31.295662931539336, 10.512530637578335, 9.151429474580116, 12.435078019048364, 5.517386491049785, 17.867318214291053, 21.65807497772687, 9.415033417222519, 15.805763513615867, 25.370285331873262, 9.539405107699398, 28.744801391514525, 13.038763711057381, 20.867327089222858, 18.179768619788028, 10.97764745566169, 24.783556633418808, 35.893741695991544, 25.187521580766923, 6.224239928125316, 24.53927075170222, 6.13358505036815, 37.57193757962822, 23.63792431031637, 29.430865063152588, 7.856545907724067, 10.84445373943479, 18.347394298696404, 24.366804816494874, 25.322209310422863, 38.02499920510035, 7.348022183306748, 26.34472063111576, 19.202538744394683, 16.087799343119947, 20.588659377070236, 7.464194346589565, 16.180416878099138, 8.576804253462445, 29.356696024857204, 18.02578083860073, 11.068317470687404, 24.55727250460989, 6.159195788256919, 35.51955584941646, 36.71049674673679, 8.807037563749402, 31.027698056088873, 35.532922627123824, 31.42159972648662, 1.7717294004423039, 22.137604107041607, 4.81876071644851, 32.70192033619889, 1.5648839477974201, 11.531634298971547, 18.59164538699872, 43.71096306784879, 17.48027012784111, 12.952397875591485, 7.933482611770702, 18.020687109747993, 8.439271528410934, 15.830233619291194, 11.599281665439616, 34.63436930077809, 31.37676290365082], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.158985064532741, -20.895543489659403, -17.792727831172066, -4.467717815750786, -30.408786252416597, -24.69119355133435, -31.1425148677165, -35.98481466197245, -27.31505549694899, -10.77463273885574, -14.911502056438554, -38.01822664775128, -37.93100271074765, -31.528752493297336, -16.932729779286205, -14.891860041700102, -17.856554541191727, -16.193793361654556, 4.564627755872642, -4.621081044205987, -15.825424920188649, -12.570150900630997, -17.943060925754054, -17.2379873809748, -15.856775355658867, -4.086653538134839, -12.58538096317072, -27.694542467419037, -15.164916644284382, -10.423295108786046, -11.142094610367776, -21.79723698476574, -0.870198838249159, -31.29566293153931, -10.512530637578386, -9.151429474580112, -12.435078019048351, -5.517386491049782, -17.86731821429105, -21.658074977726844, -9.415033417222528, -15.80576351361586, -25.37028533187321, -9.5394051076994, -28.744801391514557, -13.038763711057367, -20.867327089222883, -18.179768619788, -10.977647455661707, -24.783556633418833, -35.89374169599151, -25.187521580766944, -6.22423992812532, -24.53927075170224, -6.13358505036817, -37.57193757962827, -23.63792431031641, -29.430865063152595, -7.856545907724086, -10.844453739434796, -18.347394298696422, -24.36680481649484, -25.322209310422835, -38.02499920510032, -7.348022183306738, -26.344720631115724, -19.202538744394698, -16.087799343119922, -20.588659377070247, -7.464194346589553, -16.180416878099145, -8.576804253462456, -29.356696024857225, -18.02578083860074, -11.068317470687404, -24.55727250460991, -6.15919578825691, -35.51955584941647, -36.71049674673675, -8.807037563749411, -31.027698056088845, -35.53292262712389, -31.421599726486633, -1.7717294004422977, -22.137604107041607, -4.818760716448502, -32.70192033619894, -1.5648839477974037, -11.531634298971559, -18.591645386998735, -43.71096306784878, -17.48027012784113, -12.952397875591483, -7.933482611770714, -18.020687109747985, -8.439271528410913, -15.830233619291207, -11.599281665439596, -34.63436930077807, -31.376762903650782], "policy_predator_policy_reward": [1.4731389744264707, 20.84483115463903, 15.331273980947104, 26.45981299837171, 39.021143183334075, -3.435687520989968, 8.78506395174427, 0.15037167975729915, 12.199348482724776, 48.618224022108414, 33.14393696103803, 16.238450141630693, 54.869311967950466, 7.415717767482501, 31.02359383783144, 40.946035486113466, 46.08502284402541, 8.545088149872562, 5.191933334698861, 16.35733214301267, 16.824484947545436, 12.998519165331665, 35.162536813771, 40.87391648173154, 31.764493526595178, 44.09751189490021, 26.584090504800308, 36.47341448179436, 21.18534141853614, 12.680118140036287, 6.0646112966214165, 23.71910878677879, 30.016366068789054, 5.696743013594412, 20.582941415445532, 11.804645307863595, -9.494518118894646, 0.3652626071493694, -10.914794827420996, 20.15695691583298, 18.251912060961704, 13.398937779415595, 5.449554529982755, 19.690747271279257, 20.840978022095264, 15.045143829412826, 9.811498893221083, 24.66447586872853, 9.094943723981118, 22.618606987336612, 5.465818156189869, 2.7074889200798182, 9.431764033030948, 15.738997893310518, 43.80426333098894, 11.584821603849106, 8.644011350057431, 21.68582193851132, 23.03625419451603, -2.189663976943933, 24.072400165110356, -1.788210944374799, 12.774076056637586, 30.82039791289386, 3.262929955227175, -1.522532278728855, 37.28087147731756, 25.310454385761094, -0.38242925110540593, 21.407490526262166, 13.74495389634643, 4.557905052813796, 17.37980589515176, 7.4903501429449495, -2.009855184342719, 13.044628166442289, 17.121056293902086, 18.613580134680035, 26.432315173187636, 16.883834782266035, 5.616625970102815, 13.213440864342232, 8.819164927372366, 22.79236209985935, 29.671863742075058, 21.068706921671428, 17.871657829688765, 1.2071523857100903, 27.04083558912459, 30.44876719390448, 3.533507110125244, 22.54402031198949, 15.790403614815888, 25.94425056362989, 21.7365641583821, 14.622973081193905, 22.579618594391352, -0.6243236830679182, 28.485112898749158, 21.082000368088462, 33.91252270121052, 37.87496069077252, 28.27667236467242, 22.098370796861488, 1.6197199898181829, 10.828759866432454, 28.18163351704723, 20.896907986357242, 2.83254572046698, 9.434624380269346, 32.38704906150821, 42.75682609774822, 25.639574393036774, 21.63627422759601, 41.6942776127868, 17.167452513518377, -5.475891660039074, 21.188983475487213, 8.657547538483193, 13.03135994038639, 16.80390487646409, 19.89088372092875, 28.02131774307337, 20.712291889916322, 40.82442444097101, 9.819994179874659, 34.39495391739223, 41.65504449280841, 3.694646930529125, 11.001397436084366, 35.28500203268647, 17.404439229544955, 25.63153948503536, 12.773538003754044, 26.101149806491154, 6.074448879748705, 14.138460485874065, 27.03885826826643, 13.634600556103496, 1.2937881370756052, 6.9312146353326405, 25.429619120865656, 12.451761414492761, 4.701847092432146, 15.282896257424532, 43.430495792289875, 16.983448066566883, 19.06811361063457, 8.98823463542144, 13.148400305953366, 20.84851702021666, 28.266027989003124, -1.2752669425250058, 13.593658519038843, 48.55013299164319, 22.488978707189787, 34.07210111524096, 39.34889237823249, 4.959689299626783, 12.654385827872037, 10.19271028781049, 51.86268582436723, 35.50936184832831, 35.5564834059194, 43.042321168673965, 19.800878284299273, 13.826796279308248, -10.283337478423638, 13.243736453661173, 31.031471760422026, -0.7961625880345027, 10.433684020931528, 34.011331432639494, 31.392509239758336, 2.28650886931964, 0.8432590262751818, 5.786659183868941, 17.276609414074183, 6.736753185591624, 30.446537588405793, 51.06823853144274, 36.35368760425483, 26.94891826896287, 8.0116219867194, 15.250154308274796, 10.65464144290817, 14.26750971883828, 1.599455504703144, 29.104825176746957, 6.936549042748979, 11.631519670517937, 5.247023386303905, 16.02478945289615, 15.63567778568623, 12.296739100348551, 10.901824230530657, 34.31851929815329, 34.95021930340282, 39.175111483117085, 23.57841432418448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6222458606613149, "mean_inference_ms": 1.6520952664469568, "mean_action_processing_ms": 0.25475309350956027, "mean_env_wait_ms": 0.1448223664187183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005243778228759766, "StateBufferConnector_ms": 0.0034655332565307617, "ViewRequirementAgentConnector_ms": 0.13128089904785156}, "num_episodes": 22, "episode_return_max": 43.71096306784879, "episode_return_min": -4.564627755872639, "episode_return_mean": 18.697675185420007, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.58974884090895, "num_env_steps_trained_throughput_per_sec": 343.58974884090895, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 11372.459, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11372.327, "sample_time_ms": 1425.145, "learn_time_ms": 9928.27, "learn_throughput": 402.89, "synch_weights_time_ms": 17.947}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 40, "trial_id": "06536_00000", "date": "2024-08-11_16-41-48", "timestamp": 1723408908, "time_this_iter_s": 11.674755811691284, "time_total_s": 453.36731028556824, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 453.36731028556824, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 53.40625, "ram_util_percent": 82.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2688075934847194, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.709128462150693, "policy_loss": -0.017824690838945875, "vf_loss": 1.7267883609980346, "vf_explained_var": 0.9504429959381621, "kl": 0.013183320186938192, "entropy": 0.6724455608054996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.444813969147899, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8707739274653177, "policy_loss": -0.004041370286276101, "vf_loss": 1.8748151292245854, "vf_explained_var": 0.9633011900243305, "kl": 0.015159048217048166, "entropy": 0.41372695727638464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "env_runners": {"episode_reward_max": 43.71096306784879, "episode_reward_min": 0.8701988382491526, "episode_reward_mean": 19.12123156968052, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.71096306784878, "predator_policy": -10.283337478423638}, "policy_reward_max": {"prey_policy": -0.870198838249159, "predator_policy": 53.098849011137425}, "policy_reward_mean": {"prey_policy": -19.121231569680518, "predator_policy": 19.121231569680518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.237987380974793, 15.856775355658865, 4.0866535381348195, 12.58538096317072, 27.69454246741904, 15.164916644284375, 10.423295108786037, 11.14209461036777, 21.797236984765778, 0.8701988382491526, 31.295662931539336, 10.512530637578335, 9.151429474580116, 12.435078019048364, 5.517386491049785, 17.867318214291053, 21.65807497772687, 9.415033417222519, 15.805763513615867, 25.370285331873262, 9.539405107699398, 28.744801391514525, 13.038763711057381, 20.867327089222858, 18.179768619788028, 10.97764745566169, 24.783556633418808, 35.893741695991544, 25.187521580766923, 6.224239928125316, 24.53927075170222, 6.13358505036815, 37.57193757962822, 23.63792431031637, 29.430865063152588, 7.856545907724067, 10.84445373943479, 18.347394298696404, 24.366804816494874, 25.322209310422863, 38.02499920510035, 7.348022183306748, 26.34472063111576, 19.202538744394683, 16.087799343119947, 20.588659377070236, 7.464194346589565, 16.180416878099138, 8.576804253462445, 29.356696024857204, 18.02578083860073, 11.068317470687404, 24.55727250460989, 6.159195788256919, 35.51955584941646, 36.71049674673679, 8.807037563749402, 31.027698056088873, 35.532922627123824, 31.42159972648662, 1.7717294004423039, 22.137604107041607, 4.81876071644851, 32.70192033619889, 1.5648839477974201, 11.531634298971547, 18.59164538699872, 43.71096306784879, 17.48027012784111, 12.952397875591485, 7.933482611770702, 18.020687109747993, 8.439271528410934, 15.830233619291194, 11.599281665439616, 34.63436930077809, 31.37676290365082, 33.22553361315448, 20.850013053556435, 12.629841499629382, 25.073465461512843, 6.168953595713212, 24.82739877761402, 26.5940683270155, 16.125233047387887, 37.202607442495804, 4.981884941414411, 16.352714450908756, 11.537419407038424, 19.832384906280033, 36.90916849183202, 25.065264671666725, 28.978946306804062, 16.952307207929664, 26.46477581753207, 34.06607353943473, 24.283402000634066, 19.25256493727454, 3.744117376752441, 20.528982989804042], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.2379873809748, -15.856775355658867, -4.086653538134839, -12.58538096317072, -27.694542467419037, -15.164916644284382, -10.423295108786046, -11.142094610367776, -21.79723698476574, -0.870198838249159, -31.29566293153931, -10.512530637578386, -9.151429474580112, -12.435078019048351, -5.517386491049782, -17.86731821429105, -21.658074977726844, -9.415033417222528, -15.80576351361586, -25.37028533187321, -9.5394051076994, -28.744801391514557, -13.038763711057367, -20.867327089222883, -18.179768619788, -10.977647455661707, -24.783556633418833, -35.89374169599151, -25.187521580766944, -6.22423992812532, -24.53927075170224, -6.13358505036817, -37.57193757962827, -23.63792431031641, -29.430865063152595, -7.856545907724086, -10.844453739434796, -18.347394298696422, -24.36680481649484, -25.322209310422835, -38.02499920510032, -7.348022183306738, -26.344720631115724, -19.202538744394698, -16.087799343119922, -20.588659377070247, -7.464194346589553, -16.180416878099145, -8.576804253462456, -29.356696024857225, -18.02578083860074, -11.068317470687404, -24.55727250460991, -6.15919578825691, -35.51955584941647, -36.71049674673675, -8.807037563749411, -31.027698056088845, -35.53292262712389, -31.421599726486633, -1.7717294004422977, -22.137604107041607, -4.818760716448502, -32.70192033619894, -1.5648839477974037, -11.531634298971559, -18.591645386998735, -43.71096306784878, -17.48027012784113, -12.952397875591483, -7.933482611770714, -18.020687109747985, -8.439271528410913, -15.830233619291207, -11.599281665439596, -34.63436930077807, -31.376762903650782, -33.22553361315454, -20.85001305355646, -12.62984149962938, -25.07346546151282, -6.168953595713228, -24.82739877761401, -26.594068327015478, -16.125233047387905, -37.20260744249576, -4.9818849414143695, -16.35271445090876, -11.537419407038378, -19.832384906280026, -36.90916849183201, -25.0652646716667, -28.978946306804087, -16.95230720792963, -26.464775817532022, -34.0660735394347, -24.283402000634048, -19.25256493727452, -3.744117376752444, -20.528982989804046], "policy_predator_policy_reward": [9.811498893221083, 24.66447586872853, 9.094943723981118, 22.618606987336612, 5.465818156189869, 2.7074889200798182, 9.431764033030948, 15.738997893310518, 43.80426333098894, 11.584821603849106, 8.644011350057431, 21.68582193851132, 23.03625419451603, -2.189663976943933, 24.072400165110356, -1.788210944374799, 12.774076056637586, 30.82039791289386, 3.262929955227175, -1.522532278728855, 37.28087147731756, 25.310454385761094, -0.38242925110540593, 21.407490526262166, 13.74495389634643, 4.557905052813796, 17.37980589515176, 7.4903501429449495, -2.009855184342719, 13.044628166442289, 17.121056293902086, 18.613580134680035, 26.432315173187636, 16.883834782266035, 5.616625970102815, 13.213440864342232, 8.819164927372366, 22.79236209985935, 29.671863742075058, 21.068706921671428, 17.871657829688765, 1.2071523857100903, 27.04083558912459, 30.44876719390448, 3.533507110125244, 22.54402031198949, 15.790403614815888, 25.94425056362989, 21.7365641583821, 14.622973081193905, 22.579618594391352, -0.6243236830679182, 28.485112898749158, 21.082000368088462, 33.91252270121052, 37.87496069077252, 28.27667236467242, 22.098370796861488, 1.6197199898181829, 10.828759866432454, 28.18163351704723, 20.896907986357242, 2.83254572046698, 9.434624380269346, 32.38704906150821, 42.75682609774822, 25.639574393036774, 21.63627422759601, 41.6942776127868, 17.167452513518377, -5.475891660039074, 21.188983475487213, 8.657547538483193, 13.03135994038639, 16.80390487646409, 19.89088372092875, 28.02131774307337, 20.712291889916322, 40.82442444097101, 9.819994179874659, 34.39495391739223, 41.65504449280841, 3.694646930529125, 11.001397436084366, 35.28500203268647, 17.404439229544955, 25.63153948503536, 12.773538003754044, 26.101149806491154, 6.074448879748705, 14.138460485874065, 27.03885826826643, 13.634600556103496, 1.2937881370756052, 6.9312146353326405, 25.429619120865656, 12.451761414492761, 4.701847092432146, 15.282896257424532, 43.430495792289875, 16.983448066566883, 19.06811361063457, 8.98823463542144, 13.148400305953366, 20.84851702021666, 28.266027989003124, -1.2752669425250058, 13.593658519038843, 48.55013299164319, 22.488978707189787, 34.07210111524096, 39.34889237823249, 4.959689299626783, 12.654385827872037, 10.19271028781049, 51.86268582436723, 35.50936184832831, 35.5564834059194, 43.042321168673965, 19.800878284299273, 13.826796279308248, -10.283337478423638, 13.243736453661173, 31.031471760422026, -0.7961625880345027, 10.433684020931528, 34.011331432639494, 31.392509239758336, 2.28650886931964, 0.8432590262751818, 5.786659183868941, 17.276609414074183, 6.736753185591624, 30.446537588405793, 51.06823853144274, 36.35368760425483, 26.94891826896287, 8.0116219867194, 15.250154308274796, 10.65464144290817, 14.26750971883828, 1.599455504703144, 29.104825176746957, 6.936549042748979, 11.631519670517937, 5.247023386303905, 16.02478945289615, 15.63567778568623, 12.296739100348551, 10.901824230530657, 34.31851929815329, 34.95021930340282, 39.175111483117085, 23.57841432418448, 23.69597342278866, 42.75509380352038, 27.888809008985245, 13.811217098127681, 7.593712052806785, 17.665970946451985, 26.229015744289082, 23.917915178736582, 4.059328711741318, 8.278578479685128, 17.690692379228025, 31.964105176, 33.23615595031881, 19.951980703712174, 21.15344523386304, 11.097020860912759, 50.64746074430665, 23.75775414068489, 12.61033569149113, -2.6465658086623733, 22.767135397535117, 9.938293504282404, 14.085275491224278, 8.989563322852508, 1.783472379561954, 37.88129743299808, 39.31268155602818, 34.50565542763586, 43.00100405748363, 7.12952528584978, 30.186361892323312, 27.771530721284844, 9.269411963266903, 24.635202452592402, 32.39389671510152, 20.53565491996255, 15.033298067732003, 53.098849011137425, 16.476733604148915, 32.09007039711921, 11.532034169865824, 26.973095704683242, 1.986918091581133, 5.501316661923736, 18.701834788622527, 22.3561311909856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6248129747747195, "mean_inference_ms": 1.6678687450748626, "mean_action_processing_ms": 0.2562393723045236, "mean_env_wait_ms": 0.1454428988431892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005210161209106445, "StateBufferConnector_ms": 0.0034412145614624023, "ViewRequirementAgentConnector_ms": 0.13404476642608643}, "num_episodes": 23, "episode_return_max": 43.71096306784879, "episode_return_min": 0.8701988382491526, "episode_return_mean": 19.12123156968052, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.335492174579, "num_env_steps_trained_throughput_per_sec": 366.335492174579, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 11290.958, "restore_workers_time_ms": 0.019, "training_step_time_ms": 11290.825, "sample_time_ms": 1438.146, "learn_time_ms": 9836.987, "learn_throughput": 406.629, "synch_weights_time_ms": 14.704}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "training_iteration": 41, "trial_id": "06536_00000", "date": "2024-08-11_16-41-59", "timestamp": 1723408919, "time_this_iter_s": 10.986651182174683, "time_total_s": 464.3539614677429, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31ffb0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 464.3539614677429, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 47.568749999999994, "ram_util_percent": 82.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2059903108204404, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1295060414820908, "policy_loss": -0.00456874327986346, "vf_loss": 3.1340156437208253, "vf_explained_var": 0.7271994068597754, "kl": 0.00473143473088631, "entropy": 0.6314103204136093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.414106837939964, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.72257329597675, "policy_loss": -0.0034589934638312096, "vf_loss": 3.726032252917214, "vf_explained_var": 0.7706042825544953, "kl": 0.007854881911839584, "entropy": 0.5422539151061779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 43.71096306784879, "episode_reward_min": -23.60302899712747, "episode_reward_mean": 19.215755607564454, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.71096306784878, "predator_policy": -32.29827100607803}, "policy_reward_max": {"prey_policy": 23.603028997127478, "predator_policy": 53.098849011137425}, "policy_reward_mean": {"prey_policy": -19.215755607564457, "predator_policy": 19.21575560756445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.805763513615867, 25.370285331873262, 9.539405107699398, 28.744801391514525, 13.038763711057381, 20.867327089222858, 18.179768619788028, 10.97764745566169, 24.783556633418808, 35.893741695991544, 25.187521580766923, 6.224239928125316, 24.53927075170222, 6.13358505036815, 37.57193757962822, 23.63792431031637, 29.430865063152588, 7.856545907724067, 10.84445373943479, 18.347394298696404, 24.366804816494874, 25.322209310422863, 38.02499920510035, 7.348022183306748, 26.34472063111576, 19.202538744394683, 16.087799343119947, 20.588659377070236, 7.464194346589565, 16.180416878099138, 8.576804253462445, 29.356696024857204, 18.02578083860073, 11.068317470687404, 24.55727250460989, 6.159195788256919, 35.51955584941646, 36.71049674673679, 8.807037563749402, 31.027698056088873, 35.532922627123824, 31.42159972648662, 1.7717294004423039, 22.137604107041607, 4.81876071644851, 32.70192033619889, 1.5648839477974201, 11.531634298971547, 18.59164538699872, 43.71096306784879, 17.48027012784111, 12.952397875591485, 7.933482611770702, 18.020687109747993, 8.439271528410934, 15.830233619291194, 11.599281665439616, 34.63436930077809, 31.37676290365082, 33.22553361315448, 20.850013053556435, 12.629841499629382, 25.073465461512843, 6.168953595713212, 24.82739877761402, 26.5940683270155, 16.125233047387887, 37.202607442495804, 4.981884941414411, 16.352714450908756, 11.537419407038424, 19.832384906280033, 36.90916849183202, 25.065264671666725, 28.978946306804062, 16.952307207929664, 26.46477581753207, 34.06607353943473, 24.283402000634066, 19.25256493727454, 3.744117376752441, 20.528982989804042, 26.362852801506996, 22.317634524482774, 12.928791809078785, 18.21100815733926, 13.091849510311663, 28.302943336272875, 29.672464225359633, 17.894463809004513, 26.39246684418898, 17.87431641843146, 12.18702032170491, 16.026254549053686, -23.60302899712747, 19.22739580400652, -13.806535072254448, 11.01276475813409, 13.994511479673976, 16.07682556407272], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.80576351361586, -25.37028533187321, -9.5394051076994, -28.744801391514557, -13.038763711057367, -20.867327089222883, -18.179768619788, -10.977647455661707, -24.783556633418833, -35.89374169599151, -25.187521580766944, -6.22423992812532, -24.53927075170224, -6.13358505036817, -37.57193757962827, -23.63792431031641, -29.430865063152595, -7.856545907724086, -10.844453739434796, -18.347394298696422, -24.36680481649484, -25.322209310422835, -38.02499920510032, -7.348022183306738, -26.344720631115724, -19.202538744394698, -16.087799343119922, -20.588659377070247, -7.464194346589553, -16.180416878099145, -8.576804253462456, -29.356696024857225, -18.02578083860074, -11.068317470687404, -24.55727250460991, -6.15919578825691, -35.51955584941647, -36.71049674673675, -8.807037563749411, -31.027698056088845, -35.53292262712389, -31.421599726486633, -1.7717294004422977, -22.137604107041607, -4.818760716448502, -32.70192033619894, -1.5648839477974037, -11.531634298971559, -18.591645386998735, -43.71096306784878, -17.48027012784113, -12.952397875591483, -7.933482611770714, -18.020687109747985, -8.439271528410913, -15.830233619291207, -11.599281665439596, -34.63436930077807, -31.376762903650782, -33.22553361315454, -20.85001305355646, -12.62984149962938, -25.07346546151282, -6.168953595713228, -24.82739877761401, -26.594068327015478, -16.125233047387905, -37.20260744249576, -4.9818849414143695, -16.35271445090876, -11.537419407038378, -19.832384906280026, -36.90916849183201, -25.0652646716667, -28.978946306804087, -16.95230720792963, -26.464775817532022, -34.0660735394347, -24.283402000634048, -19.25256493727452, -3.744117376752444, -20.528982989804046, -26.36285280150697, -22.31763452448276, -12.928791809078794, -18.211008157339272, -13.09184951031165, -28.302943336272854, -29.67246422535967, -17.894463809004517, -26.392466844188988, -17.874316418431462, -12.187020321704981, -16.026254549053665, 23.603028997127478, -19.227395804006544, 13.806535072254444, -11.012764758134102, -13.994511479673978, -16.076825564072735], "policy_predator_policy_reward": [8.819164927372366, 22.79236209985935, 29.671863742075058, 21.068706921671428, 17.871657829688765, 1.2071523857100903, 27.04083558912459, 30.44876719390448, 3.533507110125244, 22.54402031198949, 15.790403614815888, 25.94425056362989, 21.7365641583821, 14.622973081193905, 22.579618594391352, -0.6243236830679182, 28.485112898749158, 21.082000368088462, 33.91252270121052, 37.87496069077252, 28.27667236467242, 22.098370796861488, 1.6197199898181829, 10.828759866432454, 28.18163351704723, 20.896907986357242, 2.83254572046698, 9.434624380269346, 32.38704906150821, 42.75682609774822, 25.639574393036774, 21.63627422759601, 41.6942776127868, 17.167452513518377, -5.475891660039074, 21.188983475487213, 8.657547538483193, 13.03135994038639, 16.80390487646409, 19.89088372092875, 28.02131774307337, 20.712291889916322, 40.82442444097101, 9.819994179874659, 34.39495391739223, 41.65504449280841, 3.694646930529125, 11.001397436084366, 35.28500203268647, 17.404439229544955, 25.63153948503536, 12.773538003754044, 26.101149806491154, 6.074448879748705, 14.138460485874065, 27.03885826826643, 13.634600556103496, 1.2937881370756052, 6.9312146353326405, 25.429619120865656, 12.451761414492761, 4.701847092432146, 15.282896257424532, 43.430495792289875, 16.983448066566883, 19.06811361063457, 8.98823463542144, 13.148400305953366, 20.84851702021666, 28.266027989003124, -1.2752669425250058, 13.593658519038843, 48.55013299164319, 22.488978707189787, 34.07210111524096, 39.34889237823249, 4.959689299626783, 12.654385827872037, 10.19271028781049, 51.86268582436723, 35.50936184832831, 35.5564834059194, 43.042321168673965, 19.800878284299273, 13.826796279308248, -10.283337478423638, 13.243736453661173, 31.031471760422026, -0.7961625880345027, 10.433684020931528, 34.011331432639494, 31.392509239758336, 2.28650886931964, 0.8432590262751818, 5.786659183868941, 17.276609414074183, 6.736753185591624, 30.446537588405793, 51.06823853144274, 36.35368760425483, 26.94891826896287, 8.0116219867194, 15.250154308274796, 10.65464144290817, 14.26750971883828, 1.599455504703144, 29.104825176746957, 6.936549042748979, 11.631519670517937, 5.247023386303905, 16.02478945289615, 15.63567778568623, 12.296739100348551, 10.901824230530657, 34.31851929815329, 34.95021930340282, 39.175111483117085, 23.57841432418448, 23.69597342278866, 42.75509380352038, 27.888809008985245, 13.811217098127681, 7.593712052806785, 17.665970946451985, 26.229015744289082, 23.917915178736582, 4.059328711741318, 8.278578479685128, 17.690692379228025, 31.964105176, 33.23615595031881, 19.951980703712174, 21.15344523386304, 11.097020860912759, 50.64746074430665, 23.75775414068489, 12.61033569149113, -2.6465658086623733, 22.767135397535117, 9.938293504282404, 14.085275491224278, 8.989563322852508, 1.783472379561954, 37.88129743299808, 39.31268155602818, 34.50565542763586, 43.00100405748363, 7.12952528584978, 30.186361892323312, 27.771530721284844, 9.269411963266903, 24.635202452592402, 32.39389671510152, 20.53565491996255, 15.033298067732003, 53.098849011137425, 16.476733604148915, 32.09007039711921, 11.532034169865824, 26.973095704683242, 1.986918091581133, 5.501316661923736, 18.701834788622527, 22.3561311909856, 41.91676530834994, 10.808940294664001, 29.372066459057265, 15.263202589908289, 3.9401748516409985, 21.917408766516576, 11.26410077533221, 25.15791553934635, 24.696074921671308, 1.4876240989520229, 37.765659305699394, 18.84022736684631, 42.88371171860627, 16.46121673211308, 24.052713456156326, 11.736214161852711, 19.024519653347937, 33.760414035029974, 10.801346507212411, 24.94728632965051, 11.03107628833591, 13.342964355073981, 6.120087392867098, 25.93242170524021, -32.29827100607803, -14.907786988176923, 17.676863492138736, 20.777928115874342, -21.351973950862416, -6.261096193646466, 0.016699538827250393, 22.00882997744095, 19.47197026027483, 8.517052699073123, 9.268051392950985, 22.885599735194486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6278103925376974, "mean_inference_ms": 1.673568151642325, "mean_action_processing_ms": 0.25726088121984036, "mean_env_wait_ms": 0.14604985549052382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005347609519958496, "StateBufferConnector_ms": 0.003979802131652832, "ViewRequirementAgentConnector_ms": 0.1266559362411499}, "num_episodes": 18, "episode_return_max": 43.71096306784879, "episode_return_min": -23.60302899712747, "episode_return_mean": 19.215755607564454, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.5600465941486, "num_env_steps_trained_throughput_per_sec": 355.5600465941486, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 11268.588, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11268.447, "sample_time_ms": 1433.197, "learn_time_ms": 9819.712, "learn_throughput": 407.344, "synch_weights_time_ms": 14.577}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 42, "trial_id": "06536_00000", "date": "2024-08-11_16-42-10", "timestamp": 1723408930, "time_this_iter_s": 11.298630237579346, "time_total_s": 475.65259170532227, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310ed0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 475.65259170532227, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 50.5625, "ram_util_percent": 82.60624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5483892381191255, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.795296024531126, "policy_loss": -0.007809885975439102, "vf_loss": 2.80305617240568, "vf_explained_var": 0.8689343610157569, "kl": 0.007957525042090137, "entropy": 0.6900010604411364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6355387798692815, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7776762318989587, "policy_loss": -0.0031618643857578123, "vf_loss": 2.780838056342312, "vf_explained_var": 0.8799905228867102, "kl": 0.007490638642885186, "entropy": 0.595366071645545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "env_runners": {"episode_reward_max": 43.71096306784879, "episode_reward_min": -23.60302899712747, "episode_reward_mean": 17.930790988734223, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.71096306784878, "predator_policy": -32.29827100607803}, "policy_reward_max": {"prey_policy": 23.603028997127478, "predator_policy": 53.098849011137425}, "policy_reward_mean": {"prey_policy": -17.93079098873423, "predator_policy": 17.930790988734223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.84445373943479, 18.347394298696404, 24.366804816494874, 25.322209310422863, 38.02499920510035, 7.348022183306748, 26.34472063111576, 19.202538744394683, 16.087799343119947, 20.588659377070236, 7.464194346589565, 16.180416878099138, 8.576804253462445, 29.356696024857204, 18.02578083860073, 11.068317470687404, 24.55727250460989, 6.159195788256919, 35.51955584941646, 36.71049674673679, 8.807037563749402, 31.027698056088873, 35.532922627123824, 31.42159972648662, 1.7717294004423039, 22.137604107041607, 4.81876071644851, 32.70192033619889, 1.5648839477974201, 11.531634298971547, 18.59164538699872, 43.71096306784879, 17.48027012784111, 12.952397875591485, 7.933482611770702, 18.020687109747993, 8.439271528410934, 15.830233619291194, 11.599281665439616, 34.63436930077809, 31.37676290365082, 33.22553361315448, 20.850013053556435, 12.629841499629382, 25.073465461512843, 6.168953595713212, 24.82739877761402, 26.5940683270155, 16.125233047387887, 37.202607442495804, 4.981884941414411, 16.352714450908756, 11.537419407038424, 19.832384906280033, 36.90916849183202, 25.065264671666725, 28.978946306804062, 16.952307207929664, 26.46477581753207, 34.06607353943473, 24.283402000634066, 19.25256493727454, 3.744117376752441, 20.528982989804042, 26.362852801506996, 22.317634524482774, 12.928791809078785, 18.21100815733926, 13.091849510311663, 28.302943336272875, 29.672464225359633, 17.894463809004513, 26.39246684418898, 17.87431641843146, 12.18702032170491, 16.026254549053686, -23.60302899712747, 19.22739580400652, -13.806535072254448, 11.01276475813409, 13.994511479673976, 16.07682556407272, 29.012543080718388, 16.043859985335807, -3.3328898585880236, 21.138587887656303, 23.659611669356813, 6.793621832470949, 17.521420483573372, 11.338461967953139, 11.055397748229158, 9.574087479830332, 1.290994901130925, 15.129859609778562, 18.752787331249145, 0.4581399007711977, 18.413846219821494, 9.038659588931415, 7.130358657848239, 22.267140352537094], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.844453739434796, -18.347394298696422, -24.36680481649484, -25.322209310422835, -38.02499920510032, -7.348022183306738, -26.344720631115724, -19.202538744394698, -16.087799343119922, -20.588659377070247, -7.464194346589553, -16.180416878099145, -8.576804253462456, -29.356696024857225, -18.02578083860074, -11.068317470687404, -24.55727250460991, -6.15919578825691, -35.51955584941647, -36.71049674673675, -8.807037563749411, -31.027698056088845, -35.53292262712389, -31.421599726486633, -1.7717294004422977, -22.137604107041607, -4.818760716448502, -32.70192033619894, -1.5648839477974037, -11.531634298971559, -18.591645386998735, -43.71096306784878, -17.48027012784113, -12.952397875591483, -7.933482611770714, -18.020687109747985, -8.439271528410913, -15.830233619291207, -11.599281665439596, -34.63436930077807, -31.376762903650782, -33.22553361315454, -20.85001305355646, -12.62984149962938, -25.07346546151282, -6.168953595713228, -24.82739877761401, -26.594068327015478, -16.125233047387905, -37.20260744249576, -4.9818849414143695, -16.35271445090876, -11.537419407038378, -19.832384906280026, -36.90916849183201, -25.0652646716667, -28.978946306804087, -16.95230720792963, -26.464775817532022, -34.0660735394347, -24.283402000634048, -19.25256493727452, -3.744117376752444, -20.528982989804046, -26.36285280150697, -22.31763452448276, -12.928791809078794, -18.211008157339272, -13.09184951031165, -28.302943336272854, -29.67246422535967, -17.894463809004517, -26.392466844188988, -17.874316418431462, -12.187020321704981, -16.026254549053665, 23.603028997127478, -19.227395804006544, 13.806535072254444, -11.012764758134102, -13.994511479673978, -16.076825564072735, -29.012543080718455, -16.043859985335846, 3.3328898585880236, -21.13858788765637, -23.659611669356835, -6.793621832470956, -17.521420483573383, -11.338461967953151, -11.055397748229169, -9.57408747983031, -1.2909949011309418, -15.129859609778542, -18.752787331249152, -0.45813990077120037, -18.41384621982153, -9.038659588931411, -7.130358657848258, -22.267140352537087], "policy_predator_policy_reward": [8.657547538483193, 13.03135994038639, 16.80390487646409, 19.89088372092875, 28.02131774307337, 20.712291889916322, 40.82442444097101, 9.819994179874659, 34.39495391739223, 41.65504449280841, 3.694646930529125, 11.001397436084366, 35.28500203268647, 17.404439229544955, 25.63153948503536, 12.773538003754044, 26.101149806491154, 6.074448879748705, 14.138460485874065, 27.03885826826643, 13.634600556103496, 1.2937881370756052, 6.9312146353326405, 25.429619120865656, 12.451761414492761, 4.701847092432146, 15.282896257424532, 43.430495792289875, 16.983448066566883, 19.06811361063457, 8.98823463542144, 13.148400305953366, 20.84851702021666, 28.266027989003124, -1.2752669425250058, 13.593658519038843, 48.55013299164319, 22.488978707189787, 34.07210111524096, 39.34889237823249, 4.959689299626783, 12.654385827872037, 10.19271028781049, 51.86268582436723, 35.50936184832831, 35.5564834059194, 43.042321168673965, 19.800878284299273, 13.826796279308248, -10.283337478423638, 13.243736453661173, 31.031471760422026, -0.7961625880345027, 10.433684020931528, 34.011331432639494, 31.392509239758336, 2.28650886931964, 0.8432590262751818, 5.786659183868941, 17.276609414074183, 6.736753185591624, 30.446537588405793, 51.06823853144274, 36.35368760425483, 26.94891826896287, 8.0116219867194, 15.250154308274796, 10.65464144290817, 14.26750971883828, 1.599455504703144, 29.104825176746957, 6.936549042748979, 11.631519670517937, 5.247023386303905, 16.02478945289615, 15.63567778568623, 12.296739100348551, 10.901824230530657, 34.31851929815329, 34.95021930340282, 39.175111483117085, 23.57841432418448, 23.69597342278866, 42.75509380352038, 27.888809008985245, 13.811217098127681, 7.593712052806785, 17.665970946451985, 26.229015744289082, 23.917915178736582, 4.059328711741318, 8.278578479685128, 17.690692379228025, 31.964105176, 33.23615595031881, 19.951980703712174, 21.15344523386304, 11.097020860912759, 50.64746074430665, 23.75775414068489, 12.61033569149113, -2.6465658086623733, 22.767135397535117, 9.938293504282404, 14.085275491224278, 8.989563322852508, 1.783472379561954, 37.88129743299808, 39.31268155602818, 34.50565542763586, 43.00100405748363, 7.12952528584978, 30.186361892323312, 27.771530721284844, 9.269411963266903, 24.635202452592402, 32.39389671510152, 20.53565491996255, 15.033298067732003, 53.098849011137425, 16.476733604148915, 32.09007039711921, 11.532034169865824, 26.973095704683242, 1.986918091581133, 5.501316661923736, 18.701834788622527, 22.3561311909856, 41.91676530834994, 10.808940294664001, 29.372066459057265, 15.263202589908289, 3.9401748516409985, 21.917408766516576, 11.26410077533221, 25.15791553934635, 24.696074921671308, 1.4876240989520229, 37.765659305699394, 18.84022736684631, 42.88371171860627, 16.46121673211308, 24.052713456156326, 11.736214161852711, 19.024519653347937, 33.760414035029974, 10.801346507212411, 24.94728632965051, 11.03107628833591, 13.342964355073981, 6.120087392867098, 25.93242170524021, -32.29827100607803, -14.907786988176923, 17.676863492138736, 20.777928115874342, -21.351973950862416, -6.261096193646466, 0.016699538827250393, 22.00882997744095, 19.47197026027483, 8.517052699073123, 9.268051392950985, 22.885599735194486, 30.58030657253486, 27.444779588901994, 8.46677925534633, 23.620940715325382, -3.576026660793204, -3.0897530563828433, 13.296214516582946, 28.98096125872978, 32.90930988925351, 14.409913449460124, 8.470234702875416, 5.117008962066491, 20.31201788370194, 14.730823083444825, -0.31439772166873503, 22.991321657575007, 1.9603530552883672, 20.150442441169954, 2.5391652144112413, 16.609009745249384, 5.538967223951479, -2.956977421689616, 11.45750364556084, 18.80221557399629, 36.521815686471626, 0.9837589760266583, 5.021811795338878, -4.105531993796488, 24.86029112960295, 11.967401310040087, 3.6151813717670436, 14.462137806095782, -4.799408118070808, 19.06012543376732, 30.029470759340718, 14.50480994573348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6305807716192448, "mean_inference_ms": 1.6802418101920813, "mean_action_processing_ms": 0.2585193313741749, "mean_env_wait_ms": 0.14672393673016032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00817108154296875, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.12613177299499512}, "num_episodes": 18, "episode_return_max": 43.71096306784879, "episode_return_min": -23.60302899712747, "episode_return_mean": 17.930790988734223, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.045412394654, "num_env_steps_trained_throughput_per_sec": 361.045412394654, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 11213.272, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11213.13, "sample_time_ms": 1403.254, "learn_time_ms": 9794.309, "learn_throughput": 408.4, "synch_weights_time_ms": 14.451}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "training_iteration": 43, "trial_id": "06536_00000", "date": "2024-08-11_16-42-22", "timestamp": 1723408942, "time_this_iter_s": 11.125798225402832, "time_total_s": 486.7783899307251, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33162d280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 486.7783899307251, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 49.36875, "ram_util_percent": 82.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.386398912097017, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9629638457049925, "policy_loss": -0.009309850511150823, "vf_loss": 2.972225081672271, "vf_explained_var": 0.8656215007727345, "kl": 0.007778926631741308, "entropy": 0.6027768954013785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.619062540203175, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.328211199669611, "policy_loss": -0.00544436127711186, "vf_loss": 3.333655431913951, "vf_explained_var": 0.8450428693382829, "kl": 0.009958131606605237, "entropy": 0.5910289935807072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 43.71096306784879, "episode_reward_min": -23.60302899712747, "episode_reward_mean": 16.65409112925316, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.71096306784878, "predator_policy": -32.29827100607803}, "policy_reward_max": {"prey_policy": 23.603028997127478, "predator_policy": 53.098849011137425}, "policy_reward_mean": {"prey_policy": -16.65409112925316, "predator_policy": 16.654091129253157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.51955584941646, 36.71049674673679, 8.807037563749402, 31.027698056088873, 35.532922627123824, 31.42159972648662, 1.7717294004423039, 22.137604107041607, 4.81876071644851, 32.70192033619889, 1.5648839477974201, 11.531634298971547, 18.59164538699872, 43.71096306784879, 17.48027012784111, 12.952397875591485, 7.933482611770702, 18.020687109747993, 8.439271528410934, 15.830233619291194, 11.599281665439616, 34.63436930077809, 31.37676290365082, 33.22553361315448, 20.850013053556435, 12.629841499629382, 25.073465461512843, 6.168953595713212, 24.82739877761402, 26.5940683270155, 16.125233047387887, 37.202607442495804, 4.981884941414411, 16.352714450908756, 11.537419407038424, 19.832384906280033, 36.90916849183202, 25.065264671666725, 28.978946306804062, 16.952307207929664, 26.46477581753207, 34.06607353943473, 24.283402000634066, 19.25256493727454, 3.744117376752441, 20.528982989804042, 26.362852801506996, 22.317634524482774, 12.928791809078785, 18.21100815733926, 13.091849510311663, 28.302943336272875, 29.672464225359633, 17.894463809004513, 26.39246684418898, 17.87431641843146, 12.18702032170491, 16.026254549053686, -23.60302899712747, 19.22739580400652, -13.806535072254448, 11.01276475813409, 13.994511479673976, 16.07682556407272, 29.012543080718388, 16.043859985335807, -3.3328898585880236, 21.138587887656303, 23.659611669356813, 6.793621832470949, 17.521420483573372, 11.338461967953139, 11.055397748229158, 9.574087479830332, 1.290994901130925, 15.129859609778562, 18.752787331249145, 0.4581399007711977, 18.413846219821494, 9.038659588931415, 7.130358657848239, 22.267140352537094, -6.177333095342894, 2.5682486303961998, -9.93349503591817, 31.95457729420272, 12.421127658567881, 5.292270254375341, 7.516545268924714, 5.921502886472264, 18.07839749183364, 5.178545867202083, 11.719204566547816, 18.17992930761745, 15.978369352497575, 16.885860773929306, 18.343403600500256, -0.8328275126817353, 24.496463734808724, 22.605502762280064], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.51955584941647, -36.71049674673675, -8.807037563749411, -31.027698056088845, -35.53292262712389, -31.421599726486633, -1.7717294004422977, -22.137604107041607, -4.818760716448502, -32.70192033619894, -1.5648839477974037, -11.531634298971559, -18.591645386998735, -43.71096306784878, -17.48027012784113, -12.952397875591483, -7.933482611770714, -18.020687109747985, -8.439271528410913, -15.830233619291207, -11.599281665439596, -34.63436930077807, -31.376762903650782, -33.22553361315454, -20.85001305355646, -12.62984149962938, -25.07346546151282, -6.168953595713228, -24.82739877761401, -26.594068327015478, -16.125233047387905, -37.20260744249576, -4.9818849414143695, -16.35271445090876, -11.537419407038378, -19.832384906280026, -36.90916849183201, -25.0652646716667, -28.978946306804087, -16.95230720792963, -26.464775817532022, -34.0660735394347, -24.283402000634048, -19.25256493727452, -3.744117376752444, -20.528982989804046, -26.36285280150697, -22.31763452448276, -12.928791809078794, -18.211008157339272, -13.09184951031165, -28.302943336272854, -29.67246422535967, -17.894463809004517, -26.392466844188988, -17.874316418431462, -12.187020321704981, -16.026254549053665, 23.603028997127478, -19.227395804006544, 13.806535072254444, -11.012764758134102, -13.994511479673978, -16.076825564072735, -29.012543080718455, -16.043859985335846, 3.3328898585880236, -21.13858788765637, -23.659611669356835, -6.793621832470956, -17.521420483573383, -11.338461967953151, -11.055397748229169, -9.57408747983031, -1.2909949011309418, -15.129859609778542, -18.752787331249152, -0.45813990077120037, -18.41384621982153, -9.038659588931411, -7.130358657848258, -22.267140352537087, 6.177333095342895, -2.5682486303962344, 9.933495035918183, -31.954577294202718, -12.421127658567862, -5.292270254375378, -7.516545268924725, -5.921502886472281, -18.078397491833638, -5.178545867202109, -11.719204566547814, -18.179929307617446, -15.978369352497545, -16.885860773929295, -18.343403600500253, 0.8328275126817335, -24.496463734808756, -22.605502762280025], "policy_predator_policy_reward": [48.55013299164319, 22.488978707189787, 34.07210111524096, 39.34889237823249, 4.959689299626783, 12.654385827872037, 10.19271028781049, 51.86268582436723, 35.50936184832831, 35.5564834059194, 43.042321168673965, 19.800878284299273, 13.826796279308248, -10.283337478423638, 13.243736453661173, 31.031471760422026, -0.7961625880345027, 10.433684020931528, 34.011331432639494, 31.392509239758336, 2.28650886931964, 0.8432590262751818, 5.786659183868941, 17.276609414074183, 6.736753185591624, 30.446537588405793, 51.06823853144274, 36.35368760425483, 26.94891826896287, 8.0116219867194, 15.250154308274796, 10.65464144290817, 14.26750971883828, 1.599455504703144, 29.104825176746957, 6.936549042748979, 11.631519670517937, 5.247023386303905, 16.02478945289615, 15.63567778568623, 12.296739100348551, 10.901824230530657, 34.31851929815329, 34.95021930340282, 39.175111483117085, 23.57841432418448, 23.69597342278866, 42.75509380352038, 27.888809008985245, 13.811217098127681, 7.593712052806785, 17.665970946451985, 26.229015744289082, 23.917915178736582, 4.059328711741318, 8.278578479685128, 17.690692379228025, 31.964105176, 33.23615595031881, 19.951980703712174, 21.15344523386304, 11.097020860912759, 50.64746074430665, 23.75775414068489, 12.61033569149113, -2.6465658086623733, 22.767135397535117, 9.938293504282404, 14.085275491224278, 8.989563322852508, 1.783472379561954, 37.88129743299808, 39.31268155602818, 34.50565542763586, 43.00100405748363, 7.12952528584978, 30.186361892323312, 27.771530721284844, 9.269411963266903, 24.635202452592402, 32.39389671510152, 20.53565491996255, 15.033298067732003, 53.098849011137425, 16.476733604148915, 32.09007039711921, 11.532034169865824, 26.973095704683242, 1.986918091581133, 5.501316661923736, 18.701834788622527, 22.3561311909856, 41.91676530834994, 10.808940294664001, 29.372066459057265, 15.263202589908289, 3.9401748516409985, 21.917408766516576, 11.26410077533221, 25.15791553934635, 24.696074921671308, 1.4876240989520229, 37.765659305699394, 18.84022736684631, 42.88371171860627, 16.46121673211308, 24.052713456156326, 11.736214161852711, 19.024519653347937, 33.760414035029974, 10.801346507212411, 24.94728632965051, 11.03107628833591, 13.342964355073981, 6.120087392867098, 25.93242170524021, -32.29827100607803, -14.907786988176923, 17.676863492138736, 20.777928115874342, -21.351973950862416, -6.261096193646466, 0.016699538827250393, 22.00882997744095, 19.47197026027483, 8.517052699073123, 9.268051392950985, 22.885599735194486, 30.58030657253486, 27.444779588901994, 8.46677925534633, 23.620940715325382, -3.576026660793204, -3.0897530563828433, 13.296214516582946, 28.98096125872978, 32.90930988925351, 14.409913449460124, 8.470234702875416, 5.117008962066491, 20.31201788370194, 14.730823083444825, -0.31439772166873503, 22.991321657575007, 1.9603530552883672, 20.150442441169954, 2.5391652144112413, 16.609009745249384, 5.538967223951479, -2.956977421689616, 11.45750364556084, 18.80221557399629, 36.521815686471626, 0.9837589760266583, 5.021811795338878, -4.105531993796488, 24.86029112960295, 11.967401310040087, 3.6151813717670436, 14.462137806095782, -4.799408118070808, 19.06012543376732, 30.029470759340718, 14.50480994573348, -15.646598881446696, 3.2919326907609037, -1.314846009321899, 6.451343270114348, 2.8543538029648268, -22.721343874801203, 33.227203086404614, 30.681951502000828, 11.806713092499438, 13.035542224636313, -3.6496360947279705, 14.234176603478709, 3.3276805701769874, 11.705409967672459, 11.130429066049041, 0.7125767068954962, 9.941042485763893, 26.215752497903402, 0.6465357816550137, 9.710555952749186, 15.251258599633857, 8.187150533461768, 20.52442691255858, 15.83543170267632, 1.5457196472693813, 30.41101905772571, 18.146570706558563, 15.625150841300037, 9.287215157014728, 27.39959204398579, -17.7683769061029, 16.102721880739384, 18.329715611259036, 30.663211858358476, 25.38780980769147, 19.82319571686862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6313796966725856, "mean_inference_ms": 1.6832964724450097, "mean_action_processing_ms": 0.2590472661308135, "mean_env_wait_ms": 0.14701620709401708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00849759578704834, "StateBufferConnector_ms": 0.003938078880310059, "ViewRequirementAgentConnector_ms": 0.11545050144195557}, "num_episodes": 18, "episode_return_max": 43.71096306784879, "episode_return_min": -23.60302899712747, "episode_return_mean": 16.65409112925316, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.68250088644396, "num_env_steps_trained_throughput_per_sec": 328.68250088644396, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 11273.267, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11273.169, "sample_time_ms": 1439.808, "learn_time_ms": 9818.355, "learn_throughput": 407.4, "synch_weights_time_ms": 13.748}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 44, "trial_id": "06536_00000", "date": "2024-08-11_16-42-34", "timestamp": 1723408954, "time_this_iter_s": 12.224284887313843, "time_total_s": 499.00267481803894, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33162ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 499.00267481803894, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 55.07058823529411, "ram_util_percent": 82.84705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.435394684225321, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.339613702148199, "policy_loss": -0.00909939205739647, "vf_loss": 3.3486222992340724, "vf_explained_var": 0.8173808665325244, "kl": 0.01452756397622091, "entropy": 0.6408927381659547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5683460648728427, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.680150301242001, "policy_loss": -0.002816752692383946, "vf_loss": 3.682966993977784, "vf_explained_var": 0.8237226542026278, "kl": 0.00836682088606818, "entropy": 0.5893358120369533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": 37.202607442495804, "episode_reward_min": -23.60302899712747, "episode_reward_mean": 15.347917314331903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -37.20260744249576, "predator_policy": -32.29827100607803}, "policy_reward_max": {"prey_policy": 23.603028997127478, "predator_policy": 53.098849011137425}, "policy_reward_mean": {"prey_policy": -15.347917314331905, "predator_policy": 15.347917314331903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.37676290365082, 33.22553361315448, 20.850013053556435, 12.629841499629382, 25.073465461512843, 6.168953595713212, 24.82739877761402, 26.5940683270155, 16.125233047387887, 37.202607442495804, 4.981884941414411, 16.352714450908756, 11.537419407038424, 19.832384906280033, 36.90916849183202, 25.065264671666725, 28.978946306804062, 16.952307207929664, 26.46477581753207, 34.06607353943473, 24.283402000634066, 19.25256493727454, 3.744117376752441, 20.528982989804042, 26.362852801506996, 22.317634524482774, 12.928791809078785, 18.21100815733926, 13.091849510311663, 28.302943336272875, 29.672464225359633, 17.894463809004513, 26.39246684418898, 17.87431641843146, 12.18702032170491, 16.026254549053686, -23.60302899712747, 19.22739580400652, -13.806535072254448, 11.01276475813409, 13.994511479673976, 16.07682556407272, 29.012543080718388, 16.043859985335807, -3.3328898585880236, 21.138587887656303, 23.659611669356813, 6.793621832470949, 17.521420483573372, 11.338461967953139, 11.055397748229158, 9.574087479830332, 1.290994901130925, 15.129859609778562, 18.752787331249145, 0.4581399007711977, 18.413846219821494, 9.038659588931415, 7.130358657848239, 22.267140352537094, -6.177333095342894, 2.5682486303961998, -9.93349503591817, 31.95457729420272, 12.421127658567881, 5.292270254375341, 7.516545268924714, 5.921502886472264, 18.07839749183364, 5.178545867202083, 11.719204566547816, 18.17992930761745, 15.978369352497575, 16.885860773929306, 18.343403600500256, -0.8328275126817353, 24.496463734808724, 22.605502762280064, 18.241532118742377, 7.483768227779274, 21.043849699749114, 14.566835565523688, -2.199211189287256, 13.001151903790339, 20.6569847085626, 30.092969913877564, 20.51129877692815, 1.1032679424203682, -4.33268724884852, 22.16546600268624, 1.9466742937171464, 2.320447563826818, 27.98107512132041, 12.153203595516041, 9.011554057146135, 21.51367123097532, 12.263764879820819, 28.024032191366384, 10.184268661068373, 24.38714616141401], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.376762903650782, -33.22553361315454, -20.85001305355646, -12.62984149962938, -25.07346546151282, -6.168953595713228, -24.82739877761401, -26.594068327015478, -16.125233047387905, -37.20260744249576, -4.9818849414143695, -16.35271445090876, -11.537419407038378, -19.832384906280026, -36.90916849183201, -25.0652646716667, -28.978946306804087, -16.95230720792963, -26.464775817532022, -34.0660735394347, -24.283402000634048, -19.25256493727452, -3.744117376752444, -20.528982989804046, -26.36285280150697, -22.31763452448276, -12.928791809078794, -18.211008157339272, -13.09184951031165, -28.302943336272854, -29.67246422535967, -17.894463809004517, -26.392466844188988, -17.874316418431462, -12.187020321704981, -16.026254549053665, 23.603028997127478, -19.227395804006544, 13.806535072254444, -11.012764758134102, -13.994511479673978, -16.076825564072735, -29.012543080718455, -16.043859985335846, 3.3328898585880236, -21.13858788765637, -23.659611669356835, -6.793621832470956, -17.521420483573383, -11.338461967953151, -11.055397748229169, -9.57408747983031, -1.2909949011309418, -15.129859609778542, -18.752787331249152, -0.45813990077120037, -18.41384621982153, -9.038659588931411, -7.130358657848258, -22.267140352537087, 6.177333095342895, -2.5682486303962344, 9.933495035918183, -31.954577294202718, -12.421127658567862, -5.292270254375378, -7.516545268924725, -5.921502886472281, -18.078397491833638, -5.178545867202109, -11.719204566547814, -18.179929307617446, -15.978369352497545, -16.885860773929295, -18.343403600500253, 0.8328275126817335, -24.496463734808756, -22.605502762280025, -18.241532118742388, -7.483768227779271, -21.043849699749124, -14.566835565523741, 2.199211189287251, -13.001151903790335, -20.656984708562607, -30.092969913877567, -20.511298776928165, -1.10326794242037, 4.3326872488485275, -22.16546600268625, -1.9466742937171562, -2.3204475638268622, -27.9810751213204, -12.153203595516024, -9.011554057146133, -21.513671230975316, -12.263764879820803, -28.024032191366384, -10.184268661068375, -24.38714616141399], "policy_predator_policy_reward": [39.175111483117085, 23.57841432418448, 23.69597342278866, 42.75509380352038, 27.888809008985245, 13.811217098127681, 7.593712052806785, 17.665970946451985, 26.229015744289082, 23.917915178736582, 4.059328711741318, 8.278578479685128, 17.690692379228025, 31.964105176, 33.23615595031881, 19.951980703712174, 21.15344523386304, 11.097020860912759, 50.64746074430665, 23.75775414068489, 12.61033569149113, -2.6465658086623733, 22.767135397535117, 9.938293504282404, 14.085275491224278, 8.989563322852508, 1.783472379561954, 37.88129743299808, 39.31268155602818, 34.50565542763586, 43.00100405748363, 7.12952528584978, 30.186361892323312, 27.771530721284844, 9.269411963266903, 24.635202452592402, 32.39389671510152, 20.53565491996255, 15.033298067732003, 53.098849011137425, 16.476733604148915, 32.09007039711921, 11.532034169865824, 26.973095704683242, 1.986918091581133, 5.501316661923736, 18.701834788622527, 22.3561311909856, 41.91676530834994, 10.808940294664001, 29.372066459057265, 15.263202589908289, 3.9401748516409985, 21.917408766516576, 11.26410077533221, 25.15791553934635, 24.696074921671308, 1.4876240989520229, 37.765659305699394, 18.84022736684631, 42.88371171860627, 16.46121673211308, 24.052713456156326, 11.736214161852711, 19.024519653347937, 33.760414035029974, 10.801346507212411, 24.94728632965051, 11.03107628833591, 13.342964355073981, 6.120087392867098, 25.93242170524021, -32.29827100607803, -14.907786988176923, 17.676863492138736, 20.777928115874342, -21.351973950862416, -6.261096193646466, 0.016699538827250393, 22.00882997744095, 19.47197026027483, 8.517052699073123, 9.268051392950985, 22.885599735194486, 30.58030657253486, 27.444779588901994, 8.46677925534633, 23.620940715325382, -3.576026660793204, -3.0897530563828433, 13.296214516582946, 28.98096125872978, 32.90930988925351, 14.409913449460124, 8.470234702875416, 5.117008962066491, 20.31201788370194, 14.730823083444825, -0.31439772166873503, 22.991321657575007, 1.9603530552883672, 20.150442441169954, 2.5391652144112413, 16.609009745249384, 5.538967223951479, -2.956977421689616, 11.45750364556084, 18.80221557399629, 36.521815686471626, 0.9837589760266583, 5.021811795338878, -4.105531993796488, 24.86029112960295, 11.967401310040087, 3.6151813717670436, 14.462137806095782, -4.799408118070808, 19.06012543376732, 30.029470759340718, 14.50480994573348, -15.646598881446696, 3.2919326907609037, -1.314846009321899, 6.451343270114348, 2.8543538029648268, -22.721343874801203, 33.227203086404614, 30.681951502000828, 11.806713092499438, 13.035542224636313, -3.6496360947279705, 14.234176603478709, 3.3276805701769874, 11.705409967672459, 11.130429066049041, 0.7125767068954962, 9.941042485763893, 26.215752497903402, 0.6465357816550137, 9.710555952749186, 15.251258599633857, 8.187150533461768, 20.52442691255858, 15.83543170267632, 1.5457196472693813, 30.41101905772571, 18.146570706558563, 15.625150841300037, 9.287215157014728, 27.39959204398579, -17.7683769061029, 16.102721880739384, 18.329715611259036, 30.663211858358476, 25.38780980769147, 19.82319571686862, 25.678458793909442, 10.804605443575339, 1.980377960467762, 12.987158495090789, 23.09918715948016, 18.988512240018085, -2.9061520665294536, 32.039823197576865, -2.140474715452733, -2.257947663121765, 17.02420442386841, 8.978099383712266, 27.02682236379645, 14.28714705332875, 21.456431582781196, 38.72950824497393, 19.813164973855976, 21.209432580000342, 11.606588073388206, -9.400052188547441, -6.896663298170012, -1.7687111995270328, 14.569745399206656, 29.76118660616582, 0.142200360953197, 3.75114822648111, -5.98799966719978, 10.628894794853434, 23.216705459157016, 32.7454447834838, 16.204594151376835, 8.101813039655221, 11.784596911338332, 6.238511202953941, 30.191216301748383, 12.836126160202312, 3.7177508289961683, 20.80977893064546, 42.01322321526863, 14.03484116746417, 4.280076355196268, 16.088460966940506, 29.383826021582244, 19.390466301245752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6305991912732951, "mean_inference_ms": 1.683989178125762, "mean_action_processing_ms": 0.25887311449709144, "mean_env_wait_ms": 0.14721326990980457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008232355117797852, "StateBufferConnector_ms": 0.004197359085083008, "ViewRequirementAgentConnector_ms": 0.09816205501556396}, "num_episodes": 22, "episode_return_max": 37.202607442495804, "episode_return_min": -23.60302899712747, "episode_return_mean": 15.347917314331903, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.7042495044639, "num_env_steps_trained_throughput_per_sec": 335.7042495044639, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 11368.04, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11367.938, "sample_time_ms": 1455.073, "learn_time_ms": 9894.291, "learn_throughput": 404.274, "synch_weights_time_ms": 17.051}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 45, "trial_id": "06536_00000", "date": "2024-08-11_16-42-46", "timestamp": 1723408966, "time_this_iter_s": 11.980093002319336, "time_total_s": 510.9827678203583, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310ed670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 510.9827678203583, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.252941176470586, "ram_util_percent": 83.2529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.690335674708088, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.535627065598965, "policy_loss": -0.010052096039241102, "vf_loss": 3.545571442693472, "vf_explained_var": 0.8902998309582472, "kl": 0.017234281569841532, "entropy": 0.7176124665265282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8120583454137127, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6567125476857343, "policy_loss": -0.0034132963850867573, "vf_loss": 3.6601256746463675, "vf_explained_var": 0.9038899867307573, "kl": 0.011296321119326788, "entropy": 0.6390702093089068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 38.00049884123401, "episode_reward_min": -23.60302899712747, "episode_reward_mean": 13.340651608077286, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -38.000498841234, "predator_policy": -32.29827100607803}, "policy_reward_max": {"prey_policy": 23.603028997127478, "predator_policy": 56.93891310356449}, "policy_reward_mean": {"prey_policy": -13.340651608077287, "predator_policy": 13.34065160807729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.528982989804042, 26.362852801506996, 22.317634524482774, 12.928791809078785, 18.21100815733926, 13.091849510311663, 28.302943336272875, 29.672464225359633, 17.894463809004513, 26.39246684418898, 17.87431641843146, 12.18702032170491, 16.026254549053686, -23.60302899712747, 19.22739580400652, -13.806535072254448, 11.01276475813409, 13.994511479673976, 16.07682556407272, 29.012543080718388, 16.043859985335807, -3.3328898585880236, 21.138587887656303, 23.659611669356813, 6.793621832470949, 17.521420483573372, 11.338461967953139, 11.055397748229158, 9.574087479830332, 1.290994901130925, 15.129859609778562, 18.752787331249145, 0.4581399007711977, 18.413846219821494, 9.038659588931415, 7.130358657848239, 22.267140352537094, -6.177333095342894, 2.5682486303961998, -9.93349503591817, 31.95457729420272, 12.421127658567881, 5.292270254375341, 7.516545268924714, 5.921502886472264, 18.07839749183364, 5.178545867202083, 11.719204566547816, 18.17992930761745, 15.978369352497575, 16.885860773929306, 18.343403600500256, -0.8328275126817353, 24.496463734808724, 22.605502762280064, 18.241532118742377, 7.483768227779274, 21.043849699749114, 14.566835565523688, -2.199211189287256, 13.001151903790339, 20.6569847085626, 30.092969913877564, 20.51129877692815, 1.1032679424203682, -4.33268724884852, 22.16546600268624, 1.9466742937171464, 2.320447563826818, 27.98107512132041, 12.153203595516041, 9.011554057146135, 21.51367123097532, 12.263764879820819, 28.024032191366384, 10.184268661068373, 24.38714616141401, 19.30057852017979, 11.16810019004969, 9.693083849876297, 11.261901276082046, -5.1255163424423005, 18.866955506771085, 18.138815864923288, 9.446103118053141, 12.482874659857062, 7.3329056471385865, 14.542564717507684, 22.005332364560264, 21.16504626976214, 27.31243266632227, -7.392155776228032, 38.00049884123401, 18.086462595934325, 15.353332973115496, 7.812485323893675, -1.2032493231198522, 22.821135939232814, 7.5566808357887085, 3.1419614332785724], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.528982989804046, -26.36285280150697, -22.31763452448276, -12.928791809078794, -18.211008157339272, -13.09184951031165, -28.302943336272854, -29.67246422535967, -17.894463809004517, -26.392466844188988, -17.874316418431462, -12.187020321704981, -16.026254549053665, 23.603028997127478, -19.227395804006544, 13.806535072254444, -11.012764758134102, -13.994511479673978, -16.076825564072735, -29.012543080718455, -16.043859985335846, 3.3328898585880236, -21.13858788765637, -23.659611669356835, -6.793621832470956, -17.521420483573383, -11.338461967953151, -11.055397748229169, -9.57408747983031, -1.2909949011309418, -15.129859609778542, -18.752787331249152, -0.45813990077120037, -18.41384621982153, -9.038659588931411, -7.130358657848258, -22.267140352537087, 6.177333095342895, -2.5682486303962344, 9.933495035918183, -31.954577294202718, -12.421127658567862, -5.292270254375378, -7.516545268924725, -5.921502886472281, -18.078397491833638, -5.178545867202109, -11.719204566547814, -18.179929307617446, -15.978369352497545, -16.885860773929295, -18.343403600500253, 0.8328275126817335, -24.496463734808756, -22.605502762280025, -18.241532118742388, -7.483768227779271, -21.043849699749124, -14.566835565523741, 2.199211189287251, -13.001151903790335, -20.656984708562607, -30.092969913877567, -20.511298776928165, -1.10326794242037, 4.3326872488485275, -22.16546600268625, -1.9466742937171562, -2.3204475638268622, -27.9810751213204, -12.153203595516024, -9.011554057146133, -21.513671230975316, -12.263764879820803, -28.024032191366384, -10.184268661068375, -24.38714616141399, -19.30057852017978, -11.168100190049675, -9.693083849876302, -11.261901276082035, 5.125516342442296, -18.866955506771067, -18.13881586492331, -9.446103118053129, -12.482874659857089, -7.332905647138514, -14.542564717507643, -22.00533236456028, -21.165046269762158, -27.312432666322273, 7.392155776228034, -38.000498841234, -18.086462595934307, -15.353332973115497, -7.812485323893638, 1.2032493231198487, -22.82113593923281, -7.556680835788719, -3.141961433278567], "policy_predator_policy_reward": [18.701834788622527, 22.3561311909856, 41.91676530834994, 10.808940294664001, 29.372066459057265, 15.263202589908289, 3.9401748516409985, 21.917408766516576, 11.26410077533221, 25.15791553934635, 24.696074921671308, 1.4876240989520229, 37.765659305699394, 18.84022736684631, 42.88371171860627, 16.46121673211308, 24.052713456156326, 11.736214161852711, 19.024519653347937, 33.760414035029974, 10.801346507212411, 24.94728632965051, 11.03107628833591, 13.342964355073981, 6.120087392867098, 25.93242170524021, -32.29827100607803, -14.907786988176923, 17.676863492138736, 20.777928115874342, -21.351973950862416, -6.261096193646466, 0.016699538827250393, 22.00882997744095, 19.47197026027483, 8.517052699073123, 9.268051392950985, 22.885599735194486, 30.58030657253486, 27.444779588901994, 8.46677925534633, 23.620940715325382, -3.576026660793204, -3.0897530563828433, 13.296214516582946, 28.98096125872978, 32.90930988925351, 14.409913449460124, 8.470234702875416, 5.117008962066491, 20.31201788370194, 14.730823083444825, -0.31439772166873503, 22.991321657575007, 1.9603530552883672, 20.150442441169954, 2.5391652144112413, 16.609009745249384, 5.538967223951479, -2.956977421689616, 11.45750364556084, 18.80221557399629, 36.521815686471626, 0.9837589760266583, 5.021811795338878, -4.105531993796488, 24.86029112960295, 11.967401310040087, 3.6151813717670436, 14.462137806095782, -4.799408118070808, 19.06012543376732, 30.029470759340718, 14.50480994573348, -15.646598881446696, 3.2919326907609037, -1.314846009321899, 6.451343270114348, 2.8543538029648268, -22.721343874801203, 33.227203086404614, 30.681951502000828, 11.806713092499438, 13.035542224636313, -3.6496360947279705, 14.234176603478709, 3.3276805701769874, 11.705409967672459, 11.130429066049041, 0.7125767068954962, 9.941042485763893, 26.215752497903402, 0.6465357816550137, 9.710555952749186, 15.251258599633857, 8.187150533461768, 20.52442691255858, 15.83543170267632, 1.5457196472693813, 30.41101905772571, 18.146570706558563, 15.625150841300037, 9.287215157014728, 27.39959204398579, -17.7683769061029, 16.102721880739384, 18.329715611259036, 30.663211858358476, 25.38780980769147, 19.82319571686862, 25.678458793909442, 10.804605443575339, 1.980377960467762, 12.987158495090789, 23.09918715948016, 18.988512240018085, -2.9061520665294536, 32.039823197576865, -2.140474715452733, -2.257947663121765, 17.02420442386841, 8.978099383712266, 27.02682236379645, 14.28714705332875, 21.456431582781196, 38.72950824497393, 19.813164973855976, 21.209432580000342, 11.606588073388206, -9.400052188547441, -6.896663298170012, -1.7687111995270328, 14.569745399206656, 29.76118660616582, 0.142200360953197, 3.75114822648111, -5.98799966719978, 10.628894794853434, 23.216705459157016, 32.7454447834838, 16.204594151376835, 8.101813039655221, 11.784596911338332, 6.238511202953941, 30.191216301748383, 12.836126160202312, 3.7177508289961683, 20.80977893064546, 42.01322321526863, 14.03484116746417, 4.280076355196268, 16.088460966940506, 29.383826021582244, 19.390466301245752, 22.560733583657807, 16.040423456701784, 13.02170511064038, 9.314495269458979, -4.026388388979452, 23.41255608873203, 9.885201317610736, 12.638601234553342, -14.212513364305822, 3.9614806794212356, 14.448351814398748, 23.285559199143428, 9.534444366739406, 26.743187363107182, 20.970631205243514, -2.078424969137256, 13.438111870352824, 11.527637449361338, 17.393919087879947, -2.728107793602872, 12.922336620206178, 16.162792814809148, 31.65177170633241, 12.358893022788152, 22.130536958840633, 20.19955558068369, 17.506068495327824, 37.11879683731671, -2.646764109409194, -12.137547443046873, 56.93891310356449, 19.062084578903487, 6.510848905933877, 29.66207628593475, 18.809543191521048, 11.897122754709924, 0.505544064490314, 15.119426583296992, 7.265537048852092, -9.672035695091791, 30.840721763963405, 14.801550114502191, -3.1668710235543234, 18.28023269513174, 14.947470281818536, -8.66354741526138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6299353047175619, "mean_inference_ms": 1.6845106466609452, "mean_action_processing_ms": 0.25876833921368114, "mean_env_wait_ms": 0.1473666285564838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00881040096282959, "StateBufferConnector_ms": 0.004375815391540527, "ViewRequirementAgentConnector_ms": 0.10372865200042725}, "num_episodes": 23, "episode_return_max": 38.00049884123401, "episode_return_min": -23.60302899712747, "episode_return_mean": 13.340651608077286, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.95545509363023, "num_env_steps_trained_throughput_per_sec": 359.95545509363023, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 11429.703, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11429.598, "sample_time_ms": 1453.305, "learn_time_ms": 9957.778, "learn_throughput": 401.696, "synch_weights_time_ms": 17.039}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 46, "trial_id": "06536_00000", "date": "2024-08-11_16-42-57", "timestamp": 1723408977, "time_this_iter_s": 11.12580418586731, "time_total_s": 522.1085720062256, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310ede50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 522.1085720062256, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 52.506249999999994, "ram_util_percent": 82.60625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0281285885721445, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.291437059144179, "policy_loss": -0.0070873542933744225, "vf_loss": 3.2984511122107505, "vf_explained_var": 0.9237090012058615, "kl": 0.011729022802483828, "entropy": 0.6867817426721256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.973042464382434, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2453441843784674, "policy_loss": -0.006480598221311257, "vf_loss": 3.25182468638849, "vf_explained_var": 0.9271197672243472, "kl": 0.009016786071952483, "entropy": 0.5965187798889856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "env_runners": {"episode_reward_max": 41.12804618000072, "episode_reward_min": -9.93349503591817, "episode_reward_mean": 13.602516273779422, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.12804618000072, "predator_policy": -22.721343874801203}, "policy_reward_max": {"prey_policy": 9.933495035918183, "predator_policy": 56.93891310356449}, "policy_reward_mean": {"prey_policy": -13.602516273779422, "predator_policy": 13.602516273779422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.07682556407272, 29.012543080718388, 16.043859985335807, -3.3328898585880236, 21.138587887656303, 23.659611669356813, 6.793621832470949, 17.521420483573372, 11.338461967953139, 11.055397748229158, 9.574087479830332, 1.290994901130925, 15.129859609778562, 18.752787331249145, 0.4581399007711977, 18.413846219821494, 9.038659588931415, 7.130358657848239, 22.267140352537094, -6.177333095342894, 2.5682486303961998, -9.93349503591817, 31.95457729420272, 12.421127658567881, 5.292270254375341, 7.516545268924714, 5.921502886472264, 18.07839749183364, 5.178545867202083, 11.719204566547816, 18.17992930761745, 15.978369352497575, 16.885860773929306, 18.343403600500256, -0.8328275126817353, 24.496463734808724, 22.605502762280064, 18.241532118742377, 7.483768227779274, 21.043849699749114, 14.566835565523688, -2.199211189287256, 13.001151903790339, 20.6569847085626, 30.092969913877564, 20.51129877692815, 1.1032679424203682, -4.33268724884852, 22.16546600268624, 1.9466742937171464, 2.320447563826818, 27.98107512132041, 12.153203595516041, 9.011554057146135, 21.51367123097532, 12.263764879820819, 28.024032191366384, 10.184268661068373, 24.38714616141401, 19.30057852017979, 11.16810019004969, 9.693083849876297, 11.261901276082046, -5.1255163424423005, 18.866955506771085, 18.138815864923288, 9.446103118053141, 12.482874659857062, 7.3329056471385865, 14.542564717507684, 22.005332364560264, 21.16504626976214, 27.31243266632227, -7.392155776228032, 38.00049884123401, 18.086462595934325, 15.353332973115496, 7.812485323893675, -1.2032493231198522, 22.821135939232814, 7.5566808357887085, 3.1419614332785724, 29.00447762132948, 31.896491799117946, 19.616645252768983, 6.643710618300746, -1.847171633050051, 15.67700124989351, -5.1672580633292, 7.253736879134753, 12.900550023800646, 17.01983474262195, 17.06234298936767, 9.514698416041705, 41.12804618000072, 22.55664740475117, 17.82816700986812, 13.814153312661192, 15.855322669160905, 24.04522736674549], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.076825564072735, -29.012543080718455, -16.043859985335846, 3.3328898585880236, -21.13858788765637, -23.659611669356835, -6.793621832470956, -17.521420483573383, -11.338461967953151, -11.055397748229169, -9.57408747983031, -1.2909949011309418, -15.129859609778542, -18.752787331249152, -0.45813990077120037, -18.41384621982153, -9.038659588931411, -7.130358657848258, -22.267140352537087, 6.177333095342895, -2.5682486303962344, 9.933495035918183, -31.954577294202718, -12.421127658567862, -5.292270254375378, -7.516545268924725, -5.921502886472281, -18.078397491833638, -5.178545867202109, -11.719204566547814, -18.179929307617446, -15.978369352497545, -16.885860773929295, -18.343403600500253, 0.8328275126817335, -24.496463734808756, -22.605502762280025, -18.241532118742388, -7.483768227779271, -21.043849699749124, -14.566835565523741, 2.199211189287251, -13.001151903790335, -20.656984708562607, -30.092969913877567, -20.511298776928165, -1.10326794242037, 4.3326872488485275, -22.16546600268625, -1.9466742937171562, -2.3204475638268622, -27.9810751213204, -12.153203595516024, -9.011554057146133, -21.513671230975316, -12.263764879820803, -28.024032191366384, -10.184268661068375, -24.38714616141399, -19.30057852017978, -11.168100190049675, -9.693083849876302, -11.261901276082035, 5.125516342442296, -18.866955506771067, -18.13881586492331, -9.446103118053129, -12.482874659857089, -7.332905647138514, -14.542564717507643, -22.00533236456028, -21.165046269762158, -27.312432666322273, 7.392155776228034, -38.000498841234, -18.086462595934307, -15.353332973115497, -7.812485323893638, 1.2032493231198487, -22.82113593923281, -7.556680835788719, -3.141961433278567, -29.004477621329553, -31.896491799117953, -19.616645252768997, -6.643710618300737, 1.8471716330500545, -15.677001249893511, 5.167258063329202, -7.25373687913477, -12.900550023800637, -17.01983474262193, -17.06234298936768, -9.51469841604168, -41.12804618000072, -22.556647404751185, -17.82816700986812, -13.814153312661194, -15.855322669160838, -24.04522736674544], "policy_predator_policy_reward": [9.268051392950985, 22.885599735194486, 30.58030657253486, 27.444779588901994, 8.46677925534633, 23.620940715325382, -3.576026660793204, -3.0897530563828433, 13.296214516582946, 28.98096125872978, 32.90930988925351, 14.409913449460124, 8.470234702875416, 5.117008962066491, 20.31201788370194, 14.730823083444825, -0.31439772166873503, 22.991321657575007, 1.9603530552883672, 20.150442441169954, 2.5391652144112413, 16.609009745249384, 5.538967223951479, -2.956977421689616, 11.45750364556084, 18.80221557399629, 36.521815686471626, 0.9837589760266583, 5.021811795338878, -4.105531993796488, 24.86029112960295, 11.967401310040087, 3.6151813717670436, 14.462137806095782, -4.799408118070808, 19.06012543376732, 30.029470759340718, 14.50480994573348, -15.646598881446696, 3.2919326907609037, -1.314846009321899, 6.451343270114348, 2.8543538029648268, -22.721343874801203, 33.227203086404614, 30.681951502000828, 11.806713092499438, 13.035542224636313, -3.6496360947279705, 14.234176603478709, 3.3276805701769874, 11.705409967672459, 11.130429066049041, 0.7125767068954962, 9.941042485763893, 26.215752497903402, 0.6465357816550137, 9.710555952749186, 15.251258599633857, 8.187150533461768, 20.52442691255858, 15.83543170267632, 1.5457196472693813, 30.41101905772571, 18.146570706558563, 15.625150841300037, 9.287215157014728, 27.39959204398579, -17.7683769061029, 16.102721880739384, 18.329715611259036, 30.663211858358476, 25.38780980769147, 19.82319571686862, 25.678458793909442, 10.804605443575339, 1.980377960467762, 12.987158495090789, 23.09918715948016, 18.988512240018085, -2.9061520665294536, 32.039823197576865, -2.140474715452733, -2.257947663121765, 17.02420442386841, 8.978099383712266, 27.02682236379645, 14.28714705332875, 21.456431582781196, 38.72950824497393, 19.813164973855976, 21.209432580000342, 11.606588073388206, -9.400052188547441, -6.896663298170012, -1.7687111995270328, 14.569745399206656, 29.76118660616582, 0.142200360953197, 3.75114822648111, -5.98799966719978, 10.628894794853434, 23.216705459157016, 32.7454447834838, 16.204594151376835, 8.101813039655221, 11.784596911338332, 6.238511202953941, 30.191216301748383, 12.836126160202312, 3.7177508289961683, 20.80977893064546, 42.01322321526863, 14.03484116746417, 4.280076355196268, 16.088460966940506, 29.383826021582244, 19.390466301245752, 22.560733583657807, 16.040423456701784, 13.02170511064038, 9.314495269458979, -4.026388388979452, 23.41255608873203, 9.885201317610736, 12.638601234553342, -14.212513364305822, 3.9614806794212356, 14.448351814398748, 23.285559199143428, 9.534444366739406, 26.743187363107182, 20.970631205243514, -2.078424969137256, 13.438111870352824, 11.527637449361338, 17.393919087879947, -2.728107793602872, 12.922336620206178, 16.162792814809148, 31.65177170633241, 12.358893022788152, 22.130536958840633, 20.19955558068369, 17.506068495327824, 37.11879683731671, -2.646764109409194, -12.137547443046873, 56.93891310356449, 19.062084578903487, 6.510848905933877, 29.66207628593475, 18.809543191521048, 11.897122754709924, 0.505544064490314, 15.119426583296992, 7.265537048852092, -9.672035695091791, 30.840721763963405, 14.801550114502191, -3.1668710235543234, 18.28023269513174, 14.947470281818536, -8.66354741526138, 19.104503443570835, 38.90445179908817, 29.62359192805918, 34.16939167017671, 14.576870014809048, 24.65642049072893, 20.556153738115672, -7.268732501514206, -22.039647059844718, 18.345303793744588, 6.397429468545193, 24.95657303124183, -4.642222953394324, -5.692293173264082, 6.24723691340144, 8.260236844868091, -6.250200477331601, 32.051300524932884, 33.92559931959155, 0.11407016565230244, 23.150050508269405, 10.974635470465934, 13.28107359463629, 5.748323237447119, 38.12014306911509, 44.13594929088635, 15.19632616229995, 29.91696864720239, 22.111225574489595, 13.545108445246607, 24.60603275773817, 3.0222738675842162, 18.3000013507962, 13.410643987525543, 24.336318306657667, 23.754136426833263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6287489883595692, "mean_inference_ms": 1.6826400940963668, "mean_action_processing_ms": 0.2583892007710917, "mean_env_wait_ms": 0.14728047352308063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008745074272155762, "StateBufferConnector_ms": 0.0036301612854003906, "ViewRequirementAgentConnector_ms": 0.10230362415313721}, "num_episodes": 18, "episode_return_max": 41.12804618000072, "episode_return_min": -9.93349503591817, "episode_return_mean": 13.602516273779422, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.46820131494206, "num_env_steps_trained_throughput_per_sec": 359.46820131494206, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 11392.201, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11392.094, "sample_time_ms": 1371.896, "learn_time_ms": 10000.856, "learn_throughput": 399.966, "synch_weights_time_ms": 17.851}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "training_iteration": 47, "trial_id": "06536_00000", "date": "2024-08-11_16-43-08", "timestamp": 1723408988, "time_this_iter_s": 11.166146039962769, "time_total_s": 533.2747180461884, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331615790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 533.2747180461884, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 50.71875, "ram_util_percent": 82.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0916711686799925, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0443056794504324, "policy_loss": -0.008688218740038186, "vf_loss": 3.052915667121609, "vf_explained_var": 0.9204708973566691, "kl": 0.012518303795554193, "entropy": 0.6915004191920161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9705818149147842, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.161277209261738, "policy_loss": -0.008607622063423078, "vf_loss": 3.169884793342106, "vf_explained_var": 0.9321431441912575, "kl": 0.00827456173517254, "entropy": 0.5829661871390368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 41.12804618000072, "episode_reward_min": -9.93349503591817, "episode_reward_mean": 14.125679699490822, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.12804618000072, "predator_policy": -24.947657335412558}, "policy_reward_max": {"prey_policy": 9.933495035918183, "predator_policy": 56.93891310356449}, "policy_reward_mean": {"prey_policy": -14.12567969949082, "predator_policy": 14.12567969949082}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.267140352537094, -6.177333095342894, 2.5682486303961998, -9.93349503591817, 31.95457729420272, 12.421127658567881, 5.292270254375341, 7.516545268924714, 5.921502886472264, 18.07839749183364, 5.178545867202083, 11.719204566547816, 18.17992930761745, 15.978369352497575, 16.885860773929306, 18.343403600500256, -0.8328275126817353, 24.496463734808724, 22.605502762280064, 18.241532118742377, 7.483768227779274, 21.043849699749114, 14.566835565523688, -2.199211189287256, 13.001151903790339, 20.6569847085626, 30.092969913877564, 20.51129877692815, 1.1032679424203682, -4.33268724884852, 22.16546600268624, 1.9466742937171464, 2.320447563826818, 27.98107512132041, 12.153203595516041, 9.011554057146135, 21.51367123097532, 12.263764879820819, 28.024032191366384, 10.184268661068373, 24.38714616141401, 19.30057852017979, 11.16810019004969, 9.693083849876297, 11.261901276082046, -5.1255163424423005, 18.866955506771085, 18.138815864923288, 9.446103118053141, 12.482874659857062, 7.3329056471385865, 14.542564717507684, 22.005332364560264, 21.16504626976214, 27.31243266632227, -7.392155776228032, 38.00049884123401, 18.086462595934325, 15.353332973115496, 7.812485323893675, -1.2032493231198522, 22.821135939232814, 7.5566808357887085, 3.1419614332785724, 29.00447762132948, 31.896491799117946, 19.616645252768983, 6.643710618300746, -1.847171633050051, 15.67700124989351, -5.1672580633292, 7.253736879134753, 12.900550023800646, 17.01983474262195, 17.06234298936767, 9.514698416041705, 41.12804618000072, 22.55664740475117, 17.82816700986812, 13.814153312661192, 15.855322669160905, 24.04522736674549, 7.341643513709581, 22.956292749632233, 20.177995739385835, 12.47408743312346, 7.982222766740454, 28.440584129309833, 23.186523701696487, 7.490715432011253, 24.06416287368765, 23.18687801934033, 2.5538143929755392, 29.04681790282318, 22.63913743137426, 32.76771663483385, -4.303363990085537, -7.89453740969326, 12.445840704663338, 16.85598459575128], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.267140352537087, 6.177333095342895, -2.5682486303962344, 9.933495035918183, -31.954577294202718, -12.421127658567862, -5.292270254375378, -7.516545268924725, -5.921502886472281, -18.078397491833638, -5.178545867202109, -11.719204566547814, -18.179929307617446, -15.978369352497545, -16.885860773929295, -18.343403600500253, 0.8328275126817335, -24.496463734808756, -22.605502762280025, -18.241532118742388, -7.483768227779271, -21.043849699749124, -14.566835565523741, 2.199211189287251, -13.001151903790335, -20.656984708562607, -30.092969913877567, -20.511298776928165, -1.10326794242037, 4.3326872488485275, -22.16546600268625, -1.9466742937171562, -2.3204475638268622, -27.9810751213204, -12.153203595516024, -9.011554057146133, -21.513671230975316, -12.263764879820803, -28.024032191366384, -10.184268661068375, -24.38714616141399, -19.30057852017978, -11.168100190049675, -9.693083849876302, -11.261901276082035, 5.125516342442296, -18.866955506771067, -18.13881586492331, -9.446103118053129, -12.482874659857089, -7.332905647138514, -14.542564717507643, -22.00533236456028, -21.165046269762158, -27.312432666322273, 7.392155776228034, -38.000498841234, -18.086462595934307, -15.353332973115497, -7.812485323893638, 1.2032493231198487, -22.82113593923281, -7.556680835788719, -3.141961433278567, -29.004477621329553, -31.896491799117953, -19.616645252768997, -6.643710618300737, 1.8471716330500545, -15.677001249893511, 5.167258063329202, -7.25373687913477, -12.900550023800637, -17.01983474262193, -17.06234298936768, -9.51469841604168, -41.12804618000072, -22.556647404751185, -17.82816700986812, -13.814153312661194, -15.855322669160838, -24.04522736674544, -7.341643513709569, -22.956292749632205, -20.1779957393858, -12.474087433123442, -7.982222766740463, -28.440584129309826, -23.186523701696483, -7.490715432011248, -24.064162873687643, -23.186878019340366, -2.5538143929755455, -29.04681790282316, -22.639137431374262, -32.76771663483386, 4.30336399008554, 7.894537409693246, -12.445840704663324, -16.855984595751266], "policy_predator_policy_reward": [30.029470759340718, 14.50480994573348, -15.646598881446696, 3.2919326907609037, -1.314846009321899, 6.451343270114348, 2.8543538029648268, -22.721343874801203, 33.227203086404614, 30.681951502000828, 11.806713092499438, 13.035542224636313, -3.6496360947279705, 14.234176603478709, 3.3276805701769874, 11.705409967672459, 11.130429066049041, 0.7125767068954962, 9.941042485763893, 26.215752497903402, 0.6465357816550137, 9.710555952749186, 15.251258599633857, 8.187150533461768, 20.52442691255858, 15.83543170267632, 1.5457196472693813, 30.41101905772571, 18.146570706558563, 15.625150841300037, 9.287215157014728, 27.39959204398579, -17.7683769061029, 16.102721880739384, 18.329715611259036, 30.663211858358476, 25.38780980769147, 19.82319571686862, 25.678458793909442, 10.804605443575339, 1.980377960467762, 12.987158495090789, 23.09918715948016, 18.988512240018085, -2.9061520665294536, 32.039823197576865, -2.140474715452733, -2.257947663121765, 17.02420442386841, 8.978099383712266, 27.02682236379645, 14.28714705332875, 21.456431582781196, 38.72950824497393, 19.813164973855976, 21.209432580000342, 11.606588073388206, -9.400052188547441, -6.896663298170012, -1.7687111995270328, 14.569745399206656, 29.76118660616582, 0.142200360953197, 3.75114822648111, -5.98799966719978, 10.628894794853434, 23.216705459157016, 32.7454447834838, 16.204594151376835, 8.101813039655221, 11.784596911338332, 6.238511202953941, 30.191216301748383, 12.836126160202312, 3.7177508289961683, 20.80977893064546, 42.01322321526863, 14.03484116746417, 4.280076355196268, 16.088460966940506, 29.383826021582244, 19.390466301245752, 22.560733583657807, 16.040423456701784, 13.02170511064038, 9.314495269458979, -4.026388388979452, 23.41255608873203, 9.885201317610736, 12.638601234553342, -14.212513364305822, 3.9614806794212356, 14.448351814398748, 23.285559199143428, 9.534444366739406, 26.743187363107182, 20.970631205243514, -2.078424969137256, 13.438111870352824, 11.527637449361338, 17.393919087879947, -2.728107793602872, 12.922336620206178, 16.162792814809148, 31.65177170633241, 12.358893022788152, 22.130536958840633, 20.19955558068369, 17.506068495327824, 37.11879683731671, -2.646764109409194, -12.137547443046873, 56.93891310356449, 19.062084578903487, 6.510848905933877, 29.66207628593475, 18.809543191521048, 11.897122754709924, 0.505544064490314, 15.119426583296992, 7.265537048852092, -9.672035695091791, 30.840721763963405, 14.801550114502191, -3.1668710235543234, 18.28023269513174, 14.947470281818536, -8.66354741526138, 19.104503443570835, 38.90445179908817, 29.62359192805918, 34.16939167017671, 14.576870014809048, 24.65642049072893, 20.556153738115672, -7.268732501514206, -22.039647059844718, 18.345303793744588, 6.397429468545193, 24.95657303124183, -4.642222953394324, -5.692293173264082, 6.24723691340144, 8.260236844868091, -6.250200477331601, 32.051300524932884, 33.92559931959155, 0.11407016565230244, 23.150050508269405, 10.974635470465934, 13.28107359463629, 5.748323237447119, 38.12014306911509, 44.13594929088635, 15.19632616229995, 29.91696864720239, 22.111225574489595, 13.545108445246607, 24.60603275773817, 3.0222738675842162, 18.3000013507962, 13.410643987525543, 24.336318306657667, 23.754136426833263, 4.0310521553905385, 10.652234872028599, 29.94635955224698, 15.966225947017422, 16.837071841095618, 23.518919637676007, 24.847278428681193, 0.10089643756566247, 13.244030207879206, 2.720415325601719, 15.731902271443046, 41.149265987176626, 27.894318792470628, 18.478728610922378, 22.048948703331845, -7.0675178393093265, 20.843149764981234, 27.28517598239403, 21.086246494731128, 25.287509543949575, -6.814746277313175, 11.922375063264258, 28.251157150756324, 29.84247865489002, 22.961131978415626, 22.317142884332902, 28.99832111518533, 36.53711215448237, -7.161372356433507, -1.4453556237375658, -24.947657335412558, 9.158582516026062, 10.288360147583866, 14.603321261742785, 30.49360363789517, 3.2183655536073807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6278811965155665, "mean_inference_ms": 1.6825552250225322, "mean_action_processing_ms": 0.2583442191716325, "mean_env_wait_ms": 0.1471855889468519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006332516670227051, "StateBufferConnector_ms": 0.0035979747772216797, "ViewRequirementAgentConnector_ms": 0.1014329195022583}, "num_episodes": 18, "episode_return_max": 41.12804618000072, "episode_return_min": -9.93349503591817, "episode_return_mean": 14.125679699490822, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.46211709244346, "num_env_steps_trained_throughput_per_sec": 349.46211709244346, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 11497.564, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11497.463, "sample_time_ms": 1411.935, "learn_time_ms": 10066.692, "learn_throughput": 397.35, "synch_weights_time_ms": 17.348}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 48, "trial_id": "06536_00000", "date": "2024-08-11_16-43-20", "timestamp": 1723409000, "time_this_iter_s": 11.50474214553833, "time_total_s": 544.7794601917267, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c1430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 544.7794601917267, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 50.96875, "ram_util_percent": 82.13125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8982180287440618, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.742833143969377, "policy_loss": -0.008355268744344358, "vf_loss": 2.7511019562681516, "vf_explained_var": 0.9171609966705243, "kl": 0.013832931667910808, "entropy": 0.7039796374738216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9259761208579653, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.707021775762871, "policy_loss": -0.003828757721437979, "vf_loss": 2.710850381725049, "vf_explained_var": 0.9404219575029201, "kl": 0.01021279464720761, "entropy": 0.6076461187430791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "env_runners": {"episode_reward_max": 41.5189136141189, "episode_reward_min": -9.300951206479189, "episode_reward_mean": 14.606178216696874, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.51891361411888, "predator_policy": -24.947657335412558}, "policy_reward_max": {"prey_policy": 9.300951206479198, "predator_policy": 56.93891310356449}, "policy_reward_mean": {"prey_policy": -14.606178216696875, "predator_policy": 14.606178216696872}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.566835565523688, -2.199211189287256, 13.001151903790339, 20.6569847085626, 30.092969913877564, 20.51129877692815, 1.1032679424203682, -4.33268724884852, 22.16546600268624, 1.9466742937171464, 2.320447563826818, 27.98107512132041, 12.153203595516041, 9.011554057146135, 21.51367123097532, 12.263764879820819, 28.024032191366384, 10.184268661068373, 24.38714616141401, 19.30057852017979, 11.16810019004969, 9.693083849876297, 11.261901276082046, -5.1255163424423005, 18.866955506771085, 18.138815864923288, 9.446103118053141, 12.482874659857062, 7.3329056471385865, 14.542564717507684, 22.005332364560264, 21.16504626976214, 27.31243266632227, -7.392155776228032, 38.00049884123401, 18.086462595934325, 15.353332973115496, 7.812485323893675, -1.2032493231198522, 22.821135939232814, 7.5566808357887085, 3.1419614332785724, 29.00447762132948, 31.896491799117946, 19.616645252768983, 6.643710618300746, -1.847171633050051, 15.67700124989351, -5.1672580633292, 7.253736879134753, 12.900550023800646, 17.01983474262195, 17.06234298936767, 9.514698416041705, 41.12804618000072, 22.55664740475117, 17.82816700986812, 13.814153312661192, 15.855322669160905, 24.04522736674549, 7.341643513709581, 22.956292749632233, 20.177995739385835, 12.47408743312346, 7.982222766740454, 28.440584129309833, 23.186523701696487, 7.490715432011253, 24.06416287368765, 23.18687801934033, 2.5538143929755392, 29.04681790282318, 22.63913743137426, 32.76771663483385, -4.303363990085537, -7.89453740969326, 12.445840704663338, 16.85598459575128, 10.656887057734076, 1.2181340272868484, 5.55687516397216, 15.925816072847045, 14.239073041172471, 10.83072038846256, 2.37475356271894, -9.300951206479189, 26.782066357089356, 13.635644695741965, 15.414218088382176, 17.29176059231422, 12.848100010960492, 24.463648958125756, 14.06192553216256, 16.482616699691746, 41.5189136141189, 21.473516801160986, 12.07723439967631, 9.830829381031759, 33.99384343831703, 5.906809249138331], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.566835565523741, 2.199211189287251, -13.001151903790335, -20.656984708562607, -30.092969913877567, -20.511298776928165, -1.10326794242037, 4.3326872488485275, -22.16546600268625, -1.9466742937171562, -2.3204475638268622, -27.9810751213204, -12.153203595516024, -9.011554057146133, -21.513671230975316, -12.263764879820803, -28.024032191366384, -10.184268661068375, -24.38714616141399, -19.30057852017978, -11.168100190049675, -9.693083849876302, -11.261901276082035, 5.125516342442296, -18.866955506771067, -18.13881586492331, -9.446103118053129, -12.482874659857089, -7.332905647138514, -14.542564717507643, -22.00533236456028, -21.165046269762158, -27.312432666322273, 7.392155776228034, -38.000498841234, -18.086462595934307, -15.353332973115497, -7.812485323893638, 1.2032493231198487, -22.82113593923281, -7.556680835788719, -3.141961433278567, -29.004477621329553, -31.896491799117953, -19.616645252768997, -6.643710618300737, 1.8471716330500545, -15.677001249893511, 5.167258063329202, -7.25373687913477, -12.900550023800637, -17.01983474262193, -17.06234298936768, -9.51469841604168, -41.12804618000072, -22.556647404751185, -17.82816700986812, -13.814153312661194, -15.855322669160838, -24.04522736674544, -7.341643513709569, -22.956292749632205, -20.1779957393858, -12.474087433123442, -7.982222766740463, -28.440584129309826, -23.186523701696483, -7.490715432011248, -24.064162873687643, -23.186878019340366, -2.5538143929755455, -29.04681790282316, -22.639137431374262, -32.76771663483386, 4.30336399008554, 7.894537409693246, -12.445840704663324, -16.855984595751266, -10.656887057734078, -1.218134027286875, -5.556875163972176, -15.92581607284706, -14.239073041172466, -10.830720388462579, -2.3747535627189453, 9.300951206479198, -26.782066357089374, -13.635644695741966, -15.414218088382182, -17.291760592314233, -12.848100010960486, -24.46364895812572, -14.061925532162558, -16.482616699691757, -41.51891361411888, -21.473516801160955, -12.077234399676307, -9.830829381031783, -33.993843438317064, -5.906809249138301], "policy_predator_policy_reward": [-2.9061520665294536, 32.039823197576865, -2.140474715452733, -2.257947663121765, 17.02420442386841, 8.978099383712266, 27.02682236379645, 14.28714705332875, 21.456431582781196, 38.72950824497393, 19.813164973855976, 21.209432580000342, 11.606588073388206, -9.400052188547441, -6.896663298170012, -1.7687111995270328, 14.569745399206656, 29.76118660616582, 0.142200360953197, 3.75114822648111, -5.98799966719978, 10.628894794853434, 23.216705459157016, 32.7454447834838, 16.204594151376835, 8.101813039655221, 11.784596911338332, 6.238511202953941, 30.191216301748383, 12.836126160202312, 3.7177508289961683, 20.80977893064546, 42.01322321526863, 14.03484116746417, 4.280076355196268, 16.088460966940506, 29.383826021582244, 19.390466301245752, 22.560733583657807, 16.040423456701784, 13.02170511064038, 9.314495269458979, -4.026388388979452, 23.41255608873203, 9.885201317610736, 12.638601234553342, -14.212513364305822, 3.9614806794212356, 14.448351814398748, 23.285559199143428, 9.534444366739406, 26.743187363107182, 20.970631205243514, -2.078424969137256, 13.438111870352824, 11.527637449361338, 17.393919087879947, -2.728107793602872, 12.922336620206178, 16.162792814809148, 31.65177170633241, 12.358893022788152, 22.130536958840633, 20.19955558068369, 17.506068495327824, 37.11879683731671, -2.646764109409194, -12.137547443046873, 56.93891310356449, 19.062084578903487, 6.510848905933877, 29.66207628593475, 18.809543191521048, 11.897122754709924, 0.505544064490314, 15.119426583296992, 7.265537048852092, -9.672035695091791, 30.840721763963405, 14.801550114502191, -3.1668710235543234, 18.28023269513174, 14.947470281818536, -8.66354741526138, 19.104503443570835, 38.90445179908817, 29.62359192805918, 34.16939167017671, 14.576870014809048, 24.65642049072893, 20.556153738115672, -7.268732501514206, -22.039647059844718, 18.345303793744588, 6.397429468545193, 24.95657303124183, -4.642222953394324, -5.692293173264082, 6.24723691340144, 8.260236844868091, -6.250200477331601, 32.051300524932884, 33.92559931959155, 0.11407016565230244, 23.150050508269405, 10.974635470465934, 13.28107359463629, 5.748323237447119, 38.12014306911509, 44.13594929088635, 15.19632616229995, 29.91696864720239, 22.111225574489595, 13.545108445246607, 24.60603275773817, 3.0222738675842162, 18.3000013507962, 13.410643987525543, 24.336318306657667, 23.754136426833263, 4.0310521553905385, 10.652234872028599, 29.94635955224698, 15.966225947017422, 16.837071841095618, 23.518919637676007, 24.847278428681193, 0.10089643756566247, 13.244030207879206, 2.720415325601719, 15.731902271443046, 41.149265987176626, 27.894318792470628, 18.478728610922378, 22.048948703331845, -7.0675178393093265, 20.843149764981234, 27.28517598239403, 21.086246494731128, 25.287509543949575, -6.814746277313175, 11.922375063264258, 28.251157150756324, 29.84247865489002, 22.961131978415626, 22.317142884332902, 28.99832111518533, 36.53711215448237, -7.161372356433507, -1.4453556237375658, -24.947657335412558, 9.158582516026062, 10.288360147583866, 14.603321261742785, 30.49360363789517, 3.2183655536073807, 15.989593757018884, 5.324180358449276, -12.176752355139644, 14.613020409713386, 20.911525882883815, -9.797775554939477, 14.647435660415471, 17.204196485278654, 11.85650638559925, 16.62163969674568, 2.2547849259378445, 19.406655850987335, 12.386048425655868, -7.636541300218001, -12.942942657858268, -5.658959755100113, 30.888301376330727, 22.675831337848017, 14.583789856467517, 12.687499535016414, 13.556521347878263, 17.2719148288861, 12.52026537080179, 22.063255813826643, 14.35901699550098, 11.337183026420012, 44.12341727211893, 4.8038806441325566, 8.048203021141607, 20.07564804318351, 5.398715250280919, 27.566518149102595, 35.29427371298459, 47.74355351525322, 16.736246803799773, 26.210786798522186, 4.192600744858236, 19.961868054494385, 1.5060670369818983, 18.155591725081646, 43.15094545704108, 24.836741419593043, 9.276014524211869, 2.5376039740647425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6282832024943812, "mean_inference_ms": 1.6834127075447487, "mean_action_processing_ms": 0.25871513218374426, "mean_env_wait_ms": 0.1470603614070025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006657123565673828, "StateBufferConnector_ms": 0.0037376880645751953, "ViewRequirementAgentConnector_ms": 0.12541329860687256}, "num_episodes": 22, "episode_return_max": 41.5189136141189, "episode_return_min": -9.300951206479189, "episode_return_mean": 14.606178216696874, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.46244298311717, "num_env_steps_trained_throughput_per_sec": 340.46244298311717, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 11440.964, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11440.792, "sample_time_ms": 1370.853, "learn_time_ms": 10050.379, "learn_throughput": 397.995, "synch_weights_time_ms": 17.955}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "training_iteration": 49, "trial_id": "06536_00000", "date": "2024-08-11_16-43-32", "timestamp": 1723409012, "time_this_iter_s": 11.854381084442139, "time_total_s": 556.6338412761688, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 556.6338412761688, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 53.370588235294115, "ram_util_percent": 82.28823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9613673883179823, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1374677104254562, "policy_loss": -0.008277368017782767, "vf_loss": 2.145680774996678, "vf_explained_var": 0.9456325623517235, "kl": 0.010287874869242541, "entropy": 0.680355310626328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9012425384193503, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.223768447946619, "policy_loss": -0.00371896262870727, "vf_loss": 2.2274873424459387, "vf_explained_var": 0.9633042623126318, "kl": 0.00824841492112971, "entropy": 0.56880603866287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 41.5189136141189, "episode_reward_min": -9.300951206479189, "episode_reward_mean": 15.40899341356506, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.51891361411888, "predator_policy": -24.947657335412558}, "policy_reward_max": {"prey_policy": 9.300951206479198, "predator_policy": 56.93891310356449}, "policy_reward_mean": {"prey_policy": -15.408993413565065, "predator_policy": 15.408993413565064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.1255163424423005, 18.866955506771085, 18.138815864923288, 9.446103118053141, 12.482874659857062, 7.3329056471385865, 14.542564717507684, 22.005332364560264, 21.16504626976214, 27.31243266632227, -7.392155776228032, 38.00049884123401, 18.086462595934325, 15.353332973115496, 7.812485323893675, -1.2032493231198522, 22.821135939232814, 7.5566808357887085, 3.1419614332785724, 29.00447762132948, 31.896491799117946, 19.616645252768983, 6.643710618300746, -1.847171633050051, 15.67700124989351, -5.1672580633292, 7.253736879134753, 12.900550023800646, 17.01983474262195, 17.06234298936767, 9.514698416041705, 41.12804618000072, 22.55664740475117, 17.82816700986812, 13.814153312661192, 15.855322669160905, 24.04522736674549, 7.341643513709581, 22.956292749632233, 20.177995739385835, 12.47408743312346, 7.982222766740454, 28.440584129309833, 23.186523701696487, 7.490715432011253, 24.06416287368765, 23.18687801934033, 2.5538143929755392, 29.04681790282318, 22.63913743137426, 32.76771663483385, -4.303363990085537, -7.89453740969326, 12.445840704663338, 16.85598459575128, 10.656887057734076, 1.2181340272868484, 5.55687516397216, 15.925816072847045, 14.239073041172471, 10.83072038846256, 2.37475356271894, -9.300951206479189, 26.782066357089356, 13.635644695741965, 15.414218088382176, 17.29176059231422, 12.848100010960492, 24.463648958125756, 14.06192553216256, 16.482616699691746, 41.5189136141189, 21.473516801160986, 12.07723439967631, 9.830829381031759, 33.99384343831703, 5.906809249138331, 29.50056388741838, 6.301584696354127, 19.22987170718118, 21.44287759312554, 20.79270417019991, 20.94208547488018, 16.497919761232097, 12.336107663322212, 18.21995186983117, 20.74328755209841, 10.90828032068371, 0.9276315489841895, 8.497514744345088, 12.29255548528756, 13.750569695317505, 16.580736188579927, 10.367343807407233, 17.582738167189465, 36.23223284237611, 34.1382029557047, 4.51061280337181, 27.60563485448251, 17.65608986545841], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.125516342442296, -18.866955506771067, -18.13881586492331, -9.446103118053129, -12.482874659857089, -7.332905647138514, -14.542564717507643, -22.00533236456028, -21.165046269762158, -27.312432666322273, 7.392155776228034, -38.000498841234, -18.086462595934307, -15.353332973115497, -7.812485323893638, 1.2032493231198487, -22.82113593923281, -7.556680835788719, -3.141961433278567, -29.004477621329553, -31.896491799117953, -19.616645252768997, -6.643710618300737, 1.8471716330500545, -15.677001249893511, 5.167258063329202, -7.25373687913477, -12.900550023800637, -17.01983474262193, -17.06234298936768, -9.51469841604168, -41.12804618000072, -22.556647404751185, -17.82816700986812, -13.814153312661194, -15.855322669160838, -24.04522736674544, -7.341643513709569, -22.956292749632205, -20.1779957393858, -12.474087433123442, -7.982222766740463, -28.440584129309826, -23.186523701696483, -7.490715432011248, -24.064162873687643, -23.186878019340366, -2.5538143929755455, -29.04681790282316, -22.639137431374262, -32.76771663483386, 4.30336399008554, 7.894537409693246, -12.445840704663324, -16.855984595751266, -10.656887057734078, -1.218134027286875, -5.556875163972176, -15.92581607284706, -14.239073041172466, -10.830720388462579, -2.3747535627189453, 9.300951206479198, -26.782066357089374, -13.635644695741966, -15.414218088382182, -17.291760592314233, -12.848100010960486, -24.46364895812572, -14.061925532162558, -16.482616699691757, -41.51891361411888, -21.473516801160955, -12.077234399676307, -9.830829381031783, -33.993843438317064, -5.906809249138301, -29.500563887418373, -6.301584696354133, -19.22987170718119, -21.44287759312556, -20.792704170199887, -20.942085474880184, -16.49791976123212, -12.336107663322206, -18.21995186983119, -20.74328755209837, -10.908280320683694, -0.9276315489841829, -8.497514744345072, -12.292555485287568, -13.750569695317504, -16.580736188579927, -10.367343807407234, -17.582738167189486, -36.23223284237617, -34.13820295570477, -4.51061280337184, -27.60563485448248, -17.656089865458384], "policy_predator_policy_reward": [-14.212513364305822, 3.9614806794212356, 14.448351814398748, 23.285559199143428, 9.534444366739406, 26.743187363107182, 20.970631205243514, -2.078424969137256, 13.438111870352824, 11.527637449361338, 17.393919087879947, -2.728107793602872, 12.922336620206178, 16.162792814809148, 31.65177170633241, 12.358893022788152, 22.130536958840633, 20.19955558068369, 17.506068495327824, 37.11879683731671, -2.646764109409194, -12.137547443046873, 56.93891310356449, 19.062084578903487, 6.510848905933877, 29.66207628593475, 18.809543191521048, 11.897122754709924, 0.505544064490314, 15.119426583296992, 7.265537048852092, -9.672035695091791, 30.840721763963405, 14.801550114502191, -3.1668710235543234, 18.28023269513174, 14.947470281818536, -8.66354741526138, 19.104503443570835, 38.90445179908817, 29.62359192805918, 34.16939167017671, 14.576870014809048, 24.65642049072893, 20.556153738115672, -7.268732501514206, -22.039647059844718, 18.345303793744588, 6.397429468545193, 24.95657303124183, -4.642222953394324, -5.692293173264082, 6.24723691340144, 8.260236844868091, -6.250200477331601, 32.051300524932884, 33.92559931959155, 0.11407016565230244, 23.150050508269405, 10.974635470465934, 13.28107359463629, 5.748323237447119, 38.12014306911509, 44.13594929088635, 15.19632616229995, 29.91696864720239, 22.111225574489595, 13.545108445246607, 24.60603275773817, 3.0222738675842162, 18.3000013507962, 13.410643987525543, 24.336318306657667, 23.754136426833263, 4.0310521553905385, 10.652234872028599, 29.94635955224698, 15.966225947017422, 16.837071841095618, 23.518919637676007, 24.847278428681193, 0.10089643756566247, 13.244030207879206, 2.720415325601719, 15.731902271443046, 41.149265987176626, 27.894318792470628, 18.478728610922378, 22.048948703331845, -7.0675178393093265, 20.843149764981234, 27.28517598239403, 21.086246494731128, 25.287509543949575, -6.814746277313175, 11.922375063264258, 28.251157150756324, 29.84247865489002, 22.961131978415626, 22.317142884332902, 28.99832111518533, 36.53711215448237, -7.161372356433507, -1.4453556237375658, -24.947657335412558, 9.158582516026062, 10.288360147583866, 14.603321261742785, 30.49360363789517, 3.2183655536073807, 15.989593757018884, 5.324180358449276, -12.176752355139644, 14.613020409713386, 20.911525882883815, -9.797775554939477, 14.647435660415471, 17.204196485278654, 11.85650638559925, 16.62163969674568, 2.2547849259378445, 19.406655850987335, 12.386048425655868, -7.636541300218001, -12.942942657858268, -5.658959755100113, 30.888301376330727, 22.675831337848017, 14.583789856467517, 12.687499535016414, 13.556521347878263, 17.2719148288861, 12.52026537080179, 22.063255813826643, 14.35901699550098, 11.337183026420012, 44.12341727211893, 4.8038806441325566, 8.048203021141607, 20.07564804318351, 5.398715250280919, 27.566518149102595, 35.29427371298459, 47.74355351525322, 16.736246803799773, 26.210786798522186, 4.192600744858236, 19.961868054494385, 1.5060670369818983, 18.155591725081646, 43.15094545704108, 24.836741419593043, 9.276014524211869, 2.5376039740647425, 23.380199313154765, 35.62092846168204, 20.81772067517599, -8.214551282467745, 34.29804914786007, 4.16169426650227, 22.24119268852609, 20.64456249772501, 30.96526771487323, 10.620140625526556, 32.013367939564176, 9.870803010196186, 21.357665377028937, 11.638174145435272, 18.66352401692843, 6.008691309715976, 18.16023531131419, 18.279668428348153, 5.844120708595176, 35.642454395601604, 19.751473552245585, 2.0650870891218327, -2.236187982856294, 4.091451080824669, 10.646934683338374, 6.348094805351782, 25.786025126735687, -1.200914156160593, 7.027926782408561, 20.473212608226447, 11.175604773372234, 21.985867603787632, -3.9409847041351935, 24.675672318949708, 32.27854942344353, 2.886926910935432, 35.95320200507792, 36.511263679674386, 33.68582516674074, 34.59058074466873, -5.0702507853870875, 14.091476392130751, 32.28801655546978, 22.92325315349521, 30.350158633927606, 4.962021096989199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6290334996275603, "mean_inference_ms": 1.6875214336810742, "mean_action_processing_ms": 0.2592842641755741, "mean_env_wait_ms": 0.1470827980536947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011076688766479492, "StateBufferConnector_ms": 0.0040514469146728516, "ViewRequirementAgentConnector_ms": 0.12184309959411621}, "num_episodes": 23, "episode_return_max": 41.5189136141189, "episode_return_min": -9.300951206479189, "episode_return_mean": 15.40899341356506, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.9082689138442, "num_env_steps_trained_throughput_per_sec": 334.9082689138442, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 11471.143, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11470.992, "sample_time_ms": 1358.586, "learn_time_ms": 10092.981, "learn_throughput": 396.315, "synch_weights_time_ms": 17.897}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 50, "trial_id": "06536_00000", "date": "2024-08-11_16-43-44", "timestamp": 1723409024, "time_this_iter_s": 11.99876618385315, "time_total_s": 568.632607460022, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 568.632607460022, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 53.741176470588236, "ram_util_percent": 82.19411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.705399710002045, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1718847755342723, "policy_loss": -0.01368073907700212, "vf_loss": 2.1854784360776347, "vf_explained_var": 0.9472106238827109, "kl": 0.013932252853014561, "entropy": 0.7108003572250406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6597186753989526, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.183124912163568, "policy_loss": -0.005078890617744672, "vf_loss": 2.188203763898718, "vf_explained_var": 0.9595310241457016, "kl": 0.006694095901144393, "entropy": 0.4926961826899695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "env_runners": {"episode_reward_max": 41.5189136141189, "episode_reward_min": -9.300951206479189, "episode_reward_mean": 15.84993836084089, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.51891361411888, "predator_policy": -24.947657335412558}, "policy_reward_max": {"prey_policy": 9.300951206479198, "predator_policy": 47.74355351525322}, "policy_reward_mean": {"prey_policy": -15.84993836084089, "predator_policy": 15.849938360840888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.1419614332785724, 29.00447762132948, 31.896491799117946, 19.616645252768983, 6.643710618300746, -1.847171633050051, 15.67700124989351, -5.1672580633292, 7.253736879134753, 12.900550023800646, 17.01983474262195, 17.06234298936767, 9.514698416041705, 41.12804618000072, 22.55664740475117, 17.82816700986812, 13.814153312661192, 15.855322669160905, 24.04522736674549, 7.341643513709581, 22.956292749632233, 20.177995739385835, 12.47408743312346, 7.982222766740454, 28.440584129309833, 23.186523701696487, 7.490715432011253, 24.06416287368765, 23.18687801934033, 2.5538143929755392, 29.04681790282318, 22.63913743137426, 32.76771663483385, -4.303363990085537, -7.89453740969326, 12.445840704663338, 16.85598459575128, 10.656887057734076, 1.2181340272868484, 5.55687516397216, 15.925816072847045, 14.239073041172471, 10.83072038846256, 2.37475356271894, -9.300951206479189, 26.782066357089356, 13.635644695741965, 15.414218088382176, 17.29176059231422, 12.848100010960492, 24.463648958125756, 14.06192553216256, 16.482616699691746, 41.5189136141189, 21.473516801160986, 12.07723439967631, 9.830829381031759, 33.99384343831703, 5.906809249138331, 29.50056388741838, 6.301584696354127, 19.22987170718118, 21.44287759312554, 20.79270417019991, 20.94208547488018, 16.497919761232097, 12.336107663322212, 18.21995186983117, 20.74328755209841, 10.90828032068371, 0.9276315489841895, 8.497514744345088, 12.29255548528756, 13.750569695317505, 16.580736188579927, 10.367343807407233, 17.582738167189465, 36.23223284237611, 34.1382029557047, 4.51061280337181, 27.60563485448251, 17.65608986545841, 2.345198203826186, 31.506156859400093, 24.169855144696275, 13.915811429714427, 22.497075462351646, 10.860030861471405, 3.005356113290164, 23.237642040640644, 26.829193044621015, -2.7451731786063993, 28.445778143559462, 12.630000229065384, 19.703063522803312, 5.236940988390733, 16.200158628375842, 32.371167982460946, -0.8451673566492657, 21.934112490475066], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.141961433278567, -29.004477621329553, -31.896491799117953, -19.616645252768997, -6.643710618300737, 1.8471716330500545, -15.677001249893511, 5.167258063329202, -7.25373687913477, -12.900550023800637, -17.01983474262193, -17.06234298936768, -9.51469841604168, -41.12804618000072, -22.556647404751185, -17.82816700986812, -13.814153312661194, -15.855322669160838, -24.04522736674544, -7.341643513709569, -22.956292749632205, -20.1779957393858, -12.474087433123442, -7.982222766740463, -28.440584129309826, -23.186523701696483, -7.490715432011248, -24.064162873687643, -23.186878019340366, -2.5538143929755455, -29.04681790282316, -22.639137431374262, -32.76771663483386, 4.30336399008554, 7.894537409693246, -12.445840704663324, -16.855984595751266, -10.656887057734078, -1.218134027286875, -5.556875163972176, -15.92581607284706, -14.239073041172466, -10.830720388462579, -2.3747535627189453, 9.300951206479198, -26.782066357089374, -13.635644695741966, -15.414218088382182, -17.291760592314233, -12.848100010960486, -24.46364895812572, -14.061925532162558, -16.482616699691757, -41.51891361411888, -21.473516801160955, -12.077234399676307, -9.830829381031783, -33.993843438317064, -5.906809249138301, -29.500563887418373, -6.301584696354133, -19.22987170718119, -21.44287759312556, -20.792704170199887, -20.942085474880184, -16.49791976123212, -12.336107663322206, -18.21995186983119, -20.74328755209837, -10.908280320683694, -0.9276315489841829, -8.497514744345072, -12.292555485287568, -13.750569695317504, -16.580736188579927, -10.367343807407234, -17.582738167189486, -36.23223284237617, -34.13820295570477, -4.51061280337184, -27.60563485448248, -17.656089865458384, -2.3451982038262127, -31.50615685940017, -24.16985514469627, -13.915811429714411, -22.49707546235167, -10.860030861471422, -3.0053561132901523, -23.237642040640655, -26.82919304462104, 2.7451731786063984, -28.445778143559544, -12.630000229065374, -19.703063522803287, -5.236940988390735, -16.20015862837581, -32.371167982460946, 0.8451673566492701, -21.93411249047505], "policy_predator_policy_reward": [14.947470281818536, -8.66354741526138, 19.104503443570835, 38.90445179908817, 29.62359192805918, 34.16939167017671, 14.576870014809048, 24.65642049072893, 20.556153738115672, -7.268732501514206, -22.039647059844718, 18.345303793744588, 6.397429468545193, 24.95657303124183, -4.642222953394324, -5.692293173264082, 6.24723691340144, 8.260236844868091, -6.250200477331601, 32.051300524932884, 33.92559931959155, 0.11407016565230244, 23.150050508269405, 10.974635470465934, 13.28107359463629, 5.748323237447119, 38.12014306911509, 44.13594929088635, 15.19632616229995, 29.91696864720239, 22.111225574489595, 13.545108445246607, 24.60603275773817, 3.0222738675842162, 18.3000013507962, 13.410643987525543, 24.336318306657667, 23.754136426833263, 4.0310521553905385, 10.652234872028599, 29.94635955224698, 15.966225947017422, 16.837071841095618, 23.518919637676007, 24.847278428681193, 0.10089643756566247, 13.244030207879206, 2.720415325601719, 15.731902271443046, 41.149265987176626, 27.894318792470628, 18.478728610922378, 22.048948703331845, -7.0675178393093265, 20.843149764981234, 27.28517598239403, 21.086246494731128, 25.287509543949575, -6.814746277313175, 11.922375063264258, 28.251157150756324, 29.84247865489002, 22.961131978415626, 22.317142884332902, 28.99832111518533, 36.53711215448237, -7.161372356433507, -1.4453556237375658, -24.947657335412558, 9.158582516026062, 10.288360147583866, 14.603321261742785, 30.49360363789517, 3.2183655536073807, 15.989593757018884, 5.324180358449276, -12.176752355139644, 14.613020409713386, 20.911525882883815, -9.797775554939477, 14.647435660415471, 17.204196485278654, 11.85650638559925, 16.62163969674568, 2.2547849259378445, 19.406655850987335, 12.386048425655868, -7.636541300218001, -12.942942657858268, -5.658959755100113, 30.888301376330727, 22.675831337848017, 14.583789856467517, 12.687499535016414, 13.556521347878263, 17.2719148288861, 12.52026537080179, 22.063255813826643, 14.35901699550098, 11.337183026420012, 44.12341727211893, 4.8038806441325566, 8.048203021141607, 20.07564804318351, 5.398715250280919, 27.566518149102595, 35.29427371298459, 47.74355351525322, 16.736246803799773, 26.210786798522186, 4.192600744858236, 19.961868054494385, 1.5060670369818983, 18.155591725081646, 43.15094545704108, 24.836741419593043, 9.276014524211869, 2.5376039740647425, 23.380199313154765, 35.62092846168204, 20.81772067517599, -8.214551282467745, 34.29804914786007, 4.16169426650227, 22.24119268852609, 20.64456249772501, 30.96526771487323, 10.620140625526556, 32.013367939564176, 9.870803010196186, 21.357665377028937, 11.638174145435272, 18.66352401692843, 6.008691309715976, 18.16023531131419, 18.279668428348153, 5.844120708595176, 35.642454395601604, 19.751473552245585, 2.0650870891218327, -2.236187982856294, 4.091451080824669, 10.646934683338374, 6.348094805351782, 25.786025126735687, -1.200914156160593, 7.027926782408561, 20.473212608226447, 11.175604773372234, 21.985867603787632, -3.9409847041351935, 24.675672318949708, 32.27854942344353, 2.886926910935432, 35.95320200507792, 36.511263679674386, 33.68582516674074, 34.59058074466873, -5.0702507853870875, 14.091476392130751, 32.28801655546978, 22.92325315349521, 30.350158633927606, 4.962021096989199, 24.066826000815112, -19.376429593162747, 37.67702885042783, 25.33528486837244, 33.19142739654578, 15.148282892846767, 17.724315161929884, 10.107307697498918, 27.50220423932648, 17.49194668537681, 13.794185000014409, 7.9258767229284315, 12.488365287568216, -6.477653060987896, 15.07566912482402, 31.39961495645731, 38.28807100151435, 15.370315087727654, 2.4327392293939205, -7.9230855866067245, 34.113443929091794, 22.778112358027258, 5.924456571545409, 19.335543886585363, 5.750297911035458, 33.6558291345711, 1.0440645229794505, 9.429817453802023, 15.232582650658312, 17.16773460609331, 36.670316898992, 28.072019065929855, -6.856817908434179, 5.1664831951356405, 9.37043062797586, 34.49779435297425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6320489582356251, "mean_inference_ms": 1.691274573104318, "mean_action_processing_ms": 0.259726411101471, "mean_env_wait_ms": 0.1472313104469236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010760784149169922, "StateBufferConnector_ms": 0.00397944450378418, "ViewRequirementAgentConnector_ms": 0.15063107013702393}, "num_episodes": 18, "episode_return_max": 41.5189136141189, "episode_return_min": -9.300951206479189, "episode_return_mean": 15.84993836084089, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.45939345762446, "num_env_steps_trained_throughput_per_sec": 304.45939345762446, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 11693.052, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11692.906, "sample_time_ms": 1393.156, "learn_time_ms": 10280.876, "learn_throughput": 389.072, "synch_weights_time_ms": 17.398}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "training_iteration": 51, "trial_id": "06536_00000", "date": "2024-08-11_16-43-57", "timestamp": 1723409037, "time_this_iter_s": 13.152734994888306, "time_total_s": 581.7853424549103, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3311098b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 581.7853424549103, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 55.98947368421052, "ram_util_percent": 83.04736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.454508874565363, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2028429781397185, "policy_loss": -0.005781679554881218, "vf_loss": 2.208587278239429, "vf_explained_var": 0.9320574548095465, "kl": 0.005981371045306557, "entropy": 0.6479315770789981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4965796093461377, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3257270095209597, "policy_loss": -0.0032411732922786127, "vf_loss": 2.3289681560778743, "vf_explained_var": 0.9512163582302275, "kl": 0.0065430704836364284, "entropy": 0.5465511583619648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 41.5189136141189, "episode_reward_min": -9.300951206479189, "episode_reward_mean": 16.825588756644695, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.51891361411888, "predator_policy": -24.947657335412558}, "policy_reward_max": {"prey_policy": 9.300951206479198, "predator_policy": 52.065034331271306}, "policy_reward_mean": {"prey_policy": -16.825588756644695, "predator_policy": 16.82558875664469}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.04522736674549, 7.341643513709581, 22.956292749632233, 20.177995739385835, 12.47408743312346, 7.982222766740454, 28.440584129309833, 23.186523701696487, 7.490715432011253, 24.06416287368765, 23.18687801934033, 2.5538143929755392, 29.04681790282318, 22.63913743137426, 32.76771663483385, -4.303363990085537, -7.89453740969326, 12.445840704663338, 16.85598459575128, 10.656887057734076, 1.2181340272868484, 5.55687516397216, 15.925816072847045, 14.239073041172471, 10.83072038846256, 2.37475356271894, -9.300951206479189, 26.782066357089356, 13.635644695741965, 15.414218088382176, 17.29176059231422, 12.848100010960492, 24.463648958125756, 14.06192553216256, 16.482616699691746, 41.5189136141189, 21.473516801160986, 12.07723439967631, 9.830829381031759, 33.99384343831703, 5.906809249138331, 29.50056388741838, 6.301584696354127, 19.22987170718118, 21.44287759312554, 20.79270417019991, 20.94208547488018, 16.497919761232097, 12.336107663322212, 18.21995186983117, 20.74328755209841, 10.90828032068371, 0.9276315489841895, 8.497514744345088, 12.29255548528756, 13.750569695317505, 16.580736188579927, 10.367343807407233, 17.582738167189465, 36.23223284237611, 34.1382029557047, 4.51061280337181, 27.60563485448251, 17.65608986545841, 2.345198203826186, 31.506156859400093, 24.169855144696275, 13.915811429714427, 22.497075462351646, 10.860030861471405, 3.005356113290164, 23.237642040640644, 26.829193044621015, -2.7451731786063993, 28.445778143559462, 12.630000229065384, 19.703063522803312, 5.236940988390733, 16.200158628375842, 32.371167982460946, -0.8451673566492657, 21.934112490475066, 18.248249560042282, 10.545381452230902, 16.424080151600634, 28.21042164925126, 20.729315065602147, 12.1116829046067, 27.35218017900809, 33.396687517824645, 14.73443169367289, 31.704206276506866, 18.194997451087108, 22.209326593198497, 40.460858005914844, 33.48447244989337, 6.355547888034413, 7.837908075451874, 6.249731414256946, 23.214919157915816], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.04522736674544, -7.341643513709569, -22.956292749632205, -20.1779957393858, -12.474087433123442, -7.982222766740463, -28.440584129309826, -23.186523701696483, -7.490715432011248, -24.064162873687643, -23.186878019340366, -2.5538143929755455, -29.04681790282316, -22.639137431374262, -32.76771663483386, 4.30336399008554, 7.894537409693246, -12.445840704663324, -16.855984595751266, -10.656887057734078, -1.218134027286875, -5.556875163972176, -15.92581607284706, -14.239073041172466, -10.830720388462579, -2.3747535627189453, 9.300951206479198, -26.782066357089374, -13.635644695741966, -15.414218088382182, -17.291760592314233, -12.848100010960486, -24.46364895812572, -14.061925532162558, -16.482616699691757, -41.51891361411888, -21.473516801160955, -12.077234399676307, -9.830829381031783, -33.993843438317064, -5.906809249138301, -29.500563887418373, -6.301584696354133, -19.22987170718119, -21.44287759312556, -20.792704170199887, -20.942085474880184, -16.49791976123212, -12.336107663322206, -18.21995186983119, -20.74328755209837, -10.908280320683694, -0.9276315489841829, -8.497514744345072, -12.292555485287568, -13.750569695317504, -16.580736188579927, -10.367343807407234, -17.582738167189486, -36.23223284237617, -34.13820295570477, -4.51061280337184, -27.60563485448248, -17.656089865458384, -2.3451982038262127, -31.50615685940017, -24.16985514469627, -13.915811429714411, -22.49707546235167, -10.860030861471422, -3.0053561132901523, -23.237642040640655, -26.82919304462104, 2.7451731786063984, -28.445778143559544, -12.630000229065374, -19.703063522803287, -5.236940988390735, -16.20015862837581, -32.371167982460946, 0.8451673566492701, -21.93411249047505, -18.248249560042268, -10.5453814522309, -16.424080151600645, -28.21042164925122, -20.72931506560214, -12.111682904606726, -27.352180179008084, -33.39668751782463, -14.734431693672873, -31.704206276506827, -18.194997451087115, -22.209326593198504, -40.46085800591486, -33.48447244989338, -6.355547888034415, -7.837908075451876, -6.249731414256955, -23.21491915791577], "policy_predator_policy_reward": [24.336318306657667, 23.754136426833263, 4.0310521553905385, 10.652234872028599, 29.94635955224698, 15.966225947017422, 16.837071841095618, 23.518919637676007, 24.847278428681193, 0.10089643756566247, 13.244030207879206, 2.720415325601719, 15.731902271443046, 41.149265987176626, 27.894318792470628, 18.478728610922378, 22.048948703331845, -7.0675178393093265, 20.843149764981234, 27.28517598239403, 21.086246494731128, 25.287509543949575, -6.814746277313175, 11.922375063264258, 28.251157150756324, 29.84247865489002, 22.961131978415626, 22.317142884332902, 28.99832111518533, 36.53711215448237, -7.161372356433507, -1.4453556237375658, -24.947657335412558, 9.158582516026062, 10.288360147583866, 14.603321261742785, 30.49360363789517, 3.2183655536073807, 15.989593757018884, 5.324180358449276, -12.176752355139644, 14.613020409713386, 20.911525882883815, -9.797775554939477, 14.647435660415471, 17.204196485278654, 11.85650638559925, 16.62163969674568, 2.2547849259378445, 19.406655850987335, 12.386048425655868, -7.636541300218001, -12.942942657858268, -5.658959755100113, 30.888301376330727, 22.675831337848017, 14.583789856467517, 12.687499535016414, 13.556521347878263, 17.2719148288861, 12.52026537080179, 22.063255813826643, 14.35901699550098, 11.337183026420012, 44.12341727211893, 4.8038806441325566, 8.048203021141607, 20.07564804318351, 5.398715250280919, 27.566518149102595, 35.29427371298459, 47.74355351525322, 16.736246803799773, 26.210786798522186, 4.192600744858236, 19.961868054494385, 1.5060670369818983, 18.155591725081646, 43.15094545704108, 24.836741419593043, 9.276014524211869, 2.5376039740647425, 23.380199313154765, 35.62092846168204, 20.81772067517599, -8.214551282467745, 34.29804914786007, 4.16169426650227, 22.24119268852609, 20.64456249772501, 30.96526771487323, 10.620140625526556, 32.013367939564176, 9.870803010196186, 21.357665377028937, 11.638174145435272, 18.66352401692843, 6.008691309715976, 18.16023531131419, 18.279668428348153, 5.844120708595176, 35.642454395601604, 19.751473552245585, 2.0650870891218327, -2.236187982856294, 4.091451080824669, 10.646934683338374, 6.348094805351782, 25.786025126735687, -1.200914156160593, 7.027926782408561, 20.473212608226447, 11.175604773372234, 21.985867603787632, -3.9409847041351935, 24.675672318949708, 32.27854942344353, 2.886926910935432, 35.95320200507792, 36.511263679674386, 33.68582516674074, 34.59058074466873, -5.0702507853870875, 14.091476392130751, 32.28801655546978, 22.92325315349521, 30.350158633927606, 4.962021096989199, 24.066826000815112, -19.376429593162747, 37.67702885042783, 25.33528486837244, 33.19142739654578, 15.148282892846767, 17.724315161929884, 10.107307697498918, 27.50220423932648, 17.49194668537681, 13.794185000014409, 7.9258767229284315, 12.488365287568216, -6.477653060987896, 15.07566912482402, 31.39961495645731, 38.28807100151435, 15.370315087727654, 2.4327392293939205, -7.9230855866067245, 34.113443929091794, 22.778112358027258, 5.924456571545409, 19.335543886585363, 5.750297911035458, 33.6558291345711, 1.0440645229794505, 9.429817453802023, 15.232582650658312, 17.16773460609331, 36.670316898992, 28.072019065929855, -6.856817908434179, 5.1664831951356405, 9.37043062797586, 34.49779435297425, 22.10783320916415, 14.388665910920386, 16.743368455382697, 4.347394449079106, 28.14983870720718, 4.698321595994104, 28.778164856532687, 27.642678441969807, 19.574833459138308, 21.883796672065987, 21.130515655183686, 3.092850154029759, 28.87200742139124, 25.832352936624943, 44.456929965549875, 22.336445070099415, 0.5291089395313193, 28.939754447814416, 52.065034331271306, 11.343378221742313, 32.88726855302267, 3.502726349151562, 29.217711341410777, 15.20094184498621, 41.234275474488285, 39.68744053734136, 36.12338171827255, 30.8455631815142, 7.56044115552512, 5.150654620543709, 13.566996393863395, 2.1088197570403544, 25.594543227734185, -13.09508039922027, 7.781218013746583, 38.64862030208499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6344617926785012, "mean_inference_ms": 1.6964017977834027, "mean_action_processing_ms": 0.26049616720603525, "mean_env_wait_ms": 0.14746565786648108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010370254516601562, "StateBufferConnector_ms": 0.003855466842651367, "ViewRequirementAgentConnector_ms": 0.14749479293823242}, "num_episodes": 18, "episode_return_max": 41.5189136141189, "episode_return_min": -9.300951206479189, "episode_return_mean": 16.825588756644695, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.48063427357954, "num_env_steps_trained_throughput_per_sec": 316.48063427357954, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 11831.967, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11831.809, "sample_time_ms": 1369.178, "learn_time_ms": 10440.493, "learn_throughput": 383.124, "synch_weights_time_ms": 20.497}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 52, "trial_id": "06536_00000", "date": "2024-08-11_16-44-10", "timestamp": 1723409050, "time_this_iter_s": 12.663620948791504, "time_total_s": 594.4489634037018, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331109940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 594.4489634037018, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 54.055555555555564, "ram_util_percent": 82.6888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7216722114632526, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.926723155627648, "policy_loss": -0.006696696950045104, "vf_loss": 1.9333700551340978, "vf_explained_var": 0.9617016099393367, "kl": 0.007967096946863365, "entropy": 0.6543099419524272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7426767737146407, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.964408867762833, "policy_loss": -0.005003246632601731, "vf_loss": 1.9694120448102397, "vf_explained_var": 0.965976047736627, "kl": 0.006686769460379288, "entropy": 0.5306285825040605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "env_runners": {"episode_reward_max": 41.5189136141189, "episode_reward_min": -9.300951206479189, "episode_reward_mean": 16.922763553360852, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.51891361411888, "predator_policy": -19.376429593162747}, "policy_reward_max": {"prey_policy": 9.300951206479198, "predator_policy": 52.065034331271306}, "policy_reward_mean": {"prey_policy": -16.92276355336086, "predator_policy": 16.922763553360852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.85598459575128, 10.656887057734076, 1.2181340272868484, 5.55687516397216, 15.925816072847045, 14.239073041172471, 10.83072038846256, 2.37475356271894, -9.300951206479189, 26.782066357089356, 13.635644695741965, 15.414218088382176, 17.29176059231422, 12.848100010960492, 24.463648958125756, 14.06192553216256, 16.482616699691746, 41.5189136141189, 21.473516801160986, 12.07723439967631, 9.830829381031759, 33.99384343831703, 5.906809249138331, 29.50056388741838, 6.301584696354127, 19.22987170718118, 21.44287759312554, 20.79270417019991, 20.94208547488018, 16.497919761232097, 12.336107663322212, 18.21995186983117, 20.74328755209841, 10.90828032068371, 0.9276315489841895, 8.497514744345088, 12.29255548528756, 13.750569695317505, 16.580736188579927, 10.367343807407233, 17.582738167189465, 36.23223284237611, 34.1382029557047, 4.51061280337181, 27.60563485448251, 17.65608986545841, 2.345198203826186, 31.506156859400093, 24.169855144696275, 13.915811429714427, 22.497075462351646, 10.860030861471405, 3.005356113290164, 23.237642040640644, 26.829193044621015, -2.7451731786063993, 28.445778143559462, 12.630000229065384, 19.703063522803312, 5.236940988390733, 16.200158628375842, 32.371167982460946, -0.8451673566492657, 21.934112490475066, 18.248249560042282, 10.545381452230902, 16.424080151600634, 28.21042164925126, 20.729315065602147, 12.1116829046067, 27.35218017900809, 33.396687517824645, 14.73443169367289, 31.704206276506866, 18.194997451087108, 22.209326593198497, 40.460858005914844, 33.48447244989337, 6.355547888034413, 7.837908075451874, 6.249731414256946, 23.214919157915816, 10.889261316670108, 20.691549483207112, 22.007316225204367, -2.4297515166319505, 10.4073371587445, 2.2094614025927095, 7.028539545187851, 4.386875193728686, 31.816274395079986, 30.55192783795655, 35.87969722616598, 16.066237327810885, 15.481986327071944, 13.43316910168024, 16.918705928414063, 23.344774510749712, 8.670678749380501, 30.965198850876654], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.855984595751266, -10.656887057734078, -1.218134027286875, -5.556875163972176, -15.92581607284706, -14.239073041172466, -10.830720388462579, -2.3747535627189453, 9.300951206479198, -26.782066357089374, -13.635644695741966, -15.414218088382182, -17.291760592314233, -12.848100010960486, -24.46364895812572, -14.061925532162558, -16.482616699691757, -41.51891361411888, -21.473516801160955, -12.077234399676307, -9.830829381031783, -33.993843438317064, -5.906809249138301, -29.500563887418373, -6.301584696354133, -19.22987170718119, -21.44287759312556, -20.792704170199887, -20.942085474880184, -16.49791976123212, -12.336107663322206, -18.21995186983119, -20.74328755209837, -10.908280320683694, -0.9276315489841829, -8.497514744345072, -12.292555485287568, -13.750569695317504, -16.580736188579927, -10.367343807407234, -17.582738167189486, -36.23223284237617, -34.13820295570477, -4.51061280337184, -27.60563485448248, -17.656089865458384, -2.3451982038262127, -31.50615685940017, -24.16985514469627, -13.915811429714411, -22.49707546235167, -10.860030861471422, -3.0053561132901523, -23.237642040640655, -26.82919304462104, 2.7451731786063984, -28.445778143559544, -12.630000229065374, -19.703063522803287, -5.236940988390735, -16.20015862837581, -32.371167982460946, 0.8451673566492701, -21.93411249047505, -18.248249560042268, -10.5453814522309, -16.424080151600645, -28.21042164925122, -20.72931506560214, -12.111682904606726, -27.352180179008084, -33.39668751782463, -14.734431693672873, -31.704206276506827, -18.194997451087115, -22.209326593198504, -40.46085800591486, -33.48447244989338, -6.355547888034415, -7.837908075451876, -6.249731414256955, -23.21491915791577, -10.889261316670122, -20.69154948320713, -22.007316225204406, 2.4297515166319505, -10.407337158744511, -2.209461402592705, -7.0285395451878765, -4.386875193728682, -31.816274395079976, -30.551927837956548, -35.8796972261659, -16.066237327810885, -15.481986327071901, -13.433169101680253, -16.91870592841405, -23.34477451074971, -8.670678749380524, -30.96519885087665], "policy_predator_policy_reward": [30.49360363789517, 3.2183655536073807, 15.989593757018884, 5.324180358449276, -12.176752355139644, 14.613020409713386, 20.911525882883815, -9.797775554939477, 14.647435660415471, 17.204196485278654, 11.85650638559925, 16.62163969674568, 2.2547849259378445, 19.406655850987335, 12.386048425655868, -7.636541300218001, -12.942942657858268, -5.658959755100113, 30.888301376330727, 22.675831337848017, 14.583789856467517, 12.687499535016414, 13.556521347878263, 17.2719148288861, 12.52026537080179, 22.063255813826643, 14.35901699550098, 11.337183026420012, 44.12341727211893, 4.8038806441325566, 8.048203021141607, 20.07564804318351, 5.398715250280919, 27.566518149102595, 35.29427371298459, 47.74355351525322, 16.736246803799773, 26.210786798522186, 4.192600744858236, 19.961868054494385, 1.5060670369818983, 18.155591725081646, 43.15094545704108, 24.836741419593043, 9.276014524211869, 2.5376039740647425, 23.380199313154765, 35.62092846168204, 20.81772067517599, -8.214551282467745, 34.29804914786007, 4.16169426650227, 22.24119268852609, 20.64456249772501, 30.96526771487323, 10.620140625526556, 32.013367939564176, 9.870803010196186, 21.357665377028937, 11.638174145435272, 18.66352401692843, 6.008691309715976, 18.16023531131419, 18.279668428348153, 5.844120708595176, 35.642454395601604, 19.751473552245585, 2.0650870891218327, -2.236187982856294, 4.091451080824669, 10.646934683338374, 6.348094805351782, 25.786025126735687, -1.200914156160593, 7.027926782408561, 20.473212608226447, 11.175604773372234, 21.985867603787632, -3.9409847041351935, 24.675672318949708, 32.27854942344353, 2.886926910935432, 35.95320200507792, 36.511263679674386, 33.68582516674074, 34.59058074466873, -5.0702507853870875, 14.091476392130751, 32.28801655546978, 22.92325315349521, 30.350158633927606, 4.962021096989199, 24.066826000815112, -19.376429593162747, 37.67702885042783, 25.33528486837244, 33.19142739654578, 15.148282892846767, 17.724315161929884, 10.107307697498918, 27.50220423932648, 17.49194668537681, 13.794185000014409, 7.9258767229284315, 12.488365287568216, -6.477653060987896, 15.07566912482402, 31.39961495645731, 38.28807100151435, 15.370315087727654, 2.4327392293939205, -7.9230855866067245, 34.113443929091794, 22.778112358027258, 5.924456571545409, 19.335543886585363, 5.750297911035458, 33.6558291345711, 1.0440645229794505, 9.429817453802023, 15.232582650658312, 17.16773460609331, 36.670316898992, 28.072019065929855, -6.856817908434179, 5.1664831951356405, 9.37043062797586, 34.49779435297425, 22.10783320916415, 14.388665910920386, 16.743368455382697, 4.347394449079106, 28.14983870720718, 4.698321595994104, 28.778164856532687, 27.642678441969807, 19.574833459138308, 21.883796672065987, 21.130515655183686, 3.092850154029759, 28.87200742139124, 25.832352936624943, 44.456929965549875, 22.336445070099415, 0.5291089395313193, 28.939754447814416, 52.065034331271306, 11.343378221742313, 32.88726855302267, 3.502726349151562, 29.217711341410777, 15.20094184498621, 41.234275474488285, 39.68744053734136, 36.12338171827255, 30.8455631815142, 7.56044115552512, 5.150654620543709, 13.566996393863395, 2.1088197570403544, 25.594543227734185, -13.09508039922027, 7.781218013746583, 38.64862030208499, 22.02466265568563, -0.24614002234537757, 14.926004868203638, 26.457094098210597, 14.472564485644012, 29.542067964764733, 5.7666372218693045, -10.626140255133196, 18.73849618675112, 2.0761781307379037, 2.072510867203057, 2.3464119379823583, 15.538116519260559, -1.481037428884843, 0.5274614305556147, 8.246288956901761, 32.22674612107101, 31.405802669088928, 24.08294142838982, 37.020914247523244, 36.818803060210975, 34.9405913921209, 19.84384747729105, 12.288627178330714, 15.844700707638378, 15.119271946505453, 17.161030486472242, 9.705307716888257, 19.78839569669051, 14.04901616013759, 14.177974968514565, 32.51157405298487, 4.79534014821826, 12.546017350542758, 36.183817099006916, 25.746580602746405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6361854051350924, "mean_inference_ms": 1.6990449818974207, "mean_action_processing_ms": 0.2608919505955848, "mean_env_wait_ms": 0.14757801021504097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009964942932128906, "StateBufferConnector_ms": 0.0038640499114990234, "ViewRequirementAgentConnector_ms": 0.1458374261856079}, "num_episodes": 18, "episode_return_max": 41.5189136141189, "episode_return_min": -9.300951206479189, "episode_return_mean": 16.922763553360852, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.59006962334166, "num_env_steps_trained_throughput_per_sec": 357.59006962334166, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 11842.676, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11842.51, "sample_time_ms": 1344.915, "learn_time_ms": 10475.181, "learn_throughput": 381.855, "synch_weights_time_ms": 20.918}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "training_iteration": 53, "trial_id": "06536_00000", "date": "2024-08-11_16-44-21", "timestamp": 1723409061, "time_this_iter_s": 11.211087942123413, "time_total_s": 605.6600513458252, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310edca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 605.6600513458252, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 45.98125, "ram_util_percent": 82.00625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.152581454999745, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4487145634988945, "policy_loss": -0.009401462991324177, "vf_loss": 2.4580321134378513, "vf_explained_var": 0.951958191767335, "kl": 0.013425331237115756, "entropy": 0.6675331675757964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9923256785781294, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5107012852789863, "policy_loss": -0.004678542718104033, "vf_loss": 2.515379772930549, "vf_explained_var": 0.9564032450870231, "kl": 0.008353683723585408, "entropy": 0.5746262088023796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 52.132889331079326, "episode_reward_min": -2.7451731786063993, "episode_reward_mean": 18.395275493260247, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.1328893310793, "predator_policy": -19.376429593162747}, "policy_reward_max": {"prey_policy": 2.7451731786063984, "predator_policy": 57.48592361250259}, "policy_reward_mean": {"prey_policy": -18.39527549326025, "predator_policy": 18.395275493260243}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.906809249138331, 29.50056388741838, 6.301584696354127, 19.22987170718118, 21.44287759312554, 20.79270417019991, 20.94208547488018, 16.497919761232097, 12.336107663322212, 18.21995186983117, 20.74328755209841, 10.90828032068371, 0.9276315489841895, 8.497514744345088, 12.29255548528756, 13.750569695317505, 16.580736188579927, 10.367343807407233, 17.582738167189465, 36.23223284237611, 34.1382029557047, 4.51061280337181, 27.60563485448251, 17.65608986545841, 2.345198203826186, 31.506156859400093, 24.169855144696275, 13.915811429714427, 22.497075462351646, 10.860030861471405, 3.005356113290164, 23.237642040640644, 26.829193044621015, -2.7451731786063993, 28.445778143559462, 12.630000229065384, 19.703063522803312, 5.236940988390733, 16.200158628375842, 32.371167982460946, -0.8451673566492657, 21.934112490475066, 18.248249560042282, 10.545381452230902, 16.424080151600634, 28.21042164925126, 20.729315065602147, 12.1116829046067, 27.35218017900809, 33.396687517824645, 14.73443169367289, 31.704206276506866, 18.194997451087108, 22.209326593198497, 40.460858005914844, 33.48447244989337, 6.355547888034413, 7.837908075451874, 6.249731414256946, 23.214919157915816, 10.889261316670108, 20.691549483207112, 22.007316225204367, -2.4297515166319505, 10.4073371587445, 2.2094614025927095, 7.028539545187851, 4.386875193728686, 31.816274395079986, 30.55192783795655, 35.87969722616598, 16.066237327810885, 15.481986327071944, 13.43316910168024, 16.918705928414063, 23.344774510749712, 8.670678749380501, 30.965198850876654, 11.321012234900941, 11.611358511680976, 5.989773303772122, 26.92388581596834, 14.082110505610396, 31.732607879884434, 11.566535836658153, 25.064120078055435, 27.96534417040981, 22.63318076500756, 7.604918667060629, 52.132889331079326, 17.884132301907595, 27.491145609376176, 31.161016493025375, 20.88395348481671, 35.12999864406478, 18.208470797834263, 24.85895415848021, 0.1154328036116139, 26.881557451315523, 24.240406417658487], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.906809249138301, -29.500563887418373, -6.301584696354133, -19.22987170718119, -21.44287759312556, -20.792704170199887, -20.942085474880184, -16.49791976123212, -12.336107663322206, -18.21995186983119, -20.74328755209837, -10.908280320683694, -0.9276315489841829, -8.497514744345072, -12.292555485287568, -13.750569695317504, -16.580736188579927, -10.367343807407234, -17.582738167189486, -36.23223284237617, -34.13820295570477, -4.51061280337184, -27.60563485448248, -17.656089865458384, -2.3451982038262127, -31.50615685940017, -24.16985514469627, -13.915811429714411, -22.49707546235167, -10.860030861471422, -3.0053561132901523, -23.237642040640655, -26.82919304462104, 2.7451731786063984, -28.445778143559544, -12.630000229065374, -19.703063522803287, -5.236940988390735, -16.20015862837581, -32.371167982460946, 0.8451673566492701, -21.93411249047505, -18.248249560042268, -10.5453814522309, -16.424080151600645, -28.21042164925122, -20.72931506560214, -12.111682904606726, -27.352180179008084, -33.39668751782463, -14.734431693672873, -31.704206276506827, -18.194997451087115, -22.209326593198504, -40.46085800591486, -33.48447244989338, -6.355547888034415, -7.837908075451876, -6.249731414256955, -23.21491915791577, -10.889261316670122, -20.69154948320713, -22.007316225204406, 2.4297515166319505, -10.407337158744511, -2.209461402592705, -7.0285395451878765, -4.386875193728682, -31.816274395079976, -30.551927837956548, -35.8796972261659, -16.066237327810885, -15.481986327071901, -13.433169101680253, -16.91870592841405, -23.34477451074971, -8.670678749380524, -30.96519885087665, -11.321012234900959, -11.61135851168098, -5.989773303772122, -26.923885815968323, -14.08211050561041, -31.732607879884416, -11.56653583665813, -25.064120078055414, -27.965344170409793, -22.633180765007587, -7.604918667060634, -52.1328893310793, -17.884132301907595, -27.491145609376144, -31.16101649302537, -20.883953484816715, -35.12999864406483, -18.20847079783425, -24.858954158480188, -0.11543280361159347, -26.881557451315512, -24.240406417658487], "policy_predator_policy_reward": [9.276014524211869, 2.5376039740647425, 23.380199313154765, 35.62092846168204, 20.81772067517599, -8.214551282467745, 34.29804914786007, 4.16169426650227, 22.24119268852609, 20.64456249772501, 30.96526771487323, 10.620140625526556, 32.013367939564176, 9.870803010196186, 21.357665377028937, 11.638174145435272, 18.66352401692843, 6.008691309715976, 18.16023531131419, 18.279668428348153, 5.844120708595176, 35.642454395601604, 19.751473552245585, 2.0650870891218327, -2.236187982856294, 4.091451080824669, 10.646934683338374, 6.348094805351782, 25.786025126735687, -1.200914156160593, 7.027926782408561, 20.473212608226447, 11.175604773372234, 21.985867603787632, -3.9409847041351935, 24.675672318949708, 32.27854942344353, 2.886926910935432, 35.95320200507792, 36.511263679674386, 33.68582516674074, 34.59058074466873, -5.0702507853870875, 14.091476392130751, 32.28801655546978, 22.92325315349521, 30.350158633927606, 4.962021096989199, 24.066826000815112, -19.376429593162747, 37.67702885042783, 25.33528486837244, 33.19142739654578, 15.148282892846767, 17.724315161929884, 10.107307697498918, 27.50220423932648, 17.49194668537681, 13.794185000014409, 7.9258767229284315, 12.488365287568216, -6.477653060987896, 15.07566912482402, 31.39961495645731, 38.28807100151435, 15.370315087727654, 2.4327392293939205, -7.9230855866067245, 34.113443929091794, 22.778112358027258, 5.924456571545409, 19.335543886585363, 5.750297911035458, 33.6558291345711, 1.0440645229794505, 9.429817453802023, 15.232582650658312, 17.16773460609331, 36.670316898992, 28.072019065929855, -6.856817908434179, 5.1664831951356405, 9.37043062797586, 34.49779435297425, 22.10783320916415, 14.388665910920386, 16.743368455382697, 4.347394449079106, 28.14983870720718, 4.698321595994104, 28.778164856532687, 27.642678441969807, 19.574833459138308, 21.883796672065987, 21.130515655183686, 3.092850154029759, 28.87200742139124, 25.832352936624943, 44.456929965549875, 22.336445070099415, 0.5291089395313193, 28.939754447814416, 52.065034331271306, 11.343378221742313, 32.88726855302267, 3.502726349151562, 29.217711341410777, 15.20094184498621, 41.234275474488285, 39.68744053734136, 36.12338171827255, 30.8455631815142, 7.56044115552512, 5.150654620543709, 13.566996393863395, 2.1088197570403544, 25.594543227734185, -13.09508039922027, 7.781218013746583, 38.64862030208499, 22.02466265568563, -0.24614002234537757, 14.926004868203638, 26.457094098210597, 14.472564485644012, 29.542067964764733, 5.7666372218693045, -10.626140255133196, 18.73849618675112, 2.0761781307379037, 2.072510867203057, 2.3464119379823583, 15.538116519260559, -1.481037428884843, 0.5274614305556147, 8.246288956901761, 32.22674612107101, 31.405802669088928, 24.08294142838982, 37.020914247523244, 36.818803060210975, 34.9405913921209, 19.84384747729105, 12.288627178330714, 15.844700707638378, 15.119271946505453, 17.161030486472242, 9.705307716888257, 19.78839569669051, 14.04901616013759, 14.177974968514565, 32.51157405298487, 4.79534014821826, 12.546017350542758, 36.183817099006916, 25.746580602746405, 14.86709953841551, 7.774924931386425, 13.416984178676067, 9.805732844685883, 8.501213130878337, 3.478333476665915, 29.875102634199273, 23.972668997737347, 20.730864820953023, 7.433356190267771, 34.05342044006857, 29.411795319700257, -5.810901572449742, 28.943973245765985, 22.020343909228725, 28.10789624688213, 12.53401477331552, 43.396673567504095, 26.864364921628464, 18.401996608386675, 13.876949032121747, 1.3328883019995192, 46.779855049656064, 57.48592361250259, 10.862096673395945, 24.90616793041927, 22.67275180036837, 32.30953941838392, 38.1014661968709, 24.220566789179866, 20.00722152530141, 21.760685444332005, 27.875652090219898, 42.38434519790975, 17.54437802021088, 18.872563575457608, 25.396506793277997, 24.321401523682393, 5.081947254319427, -4.8510816470962235, 27.344923139714737, 26.41819176291633, 40.8647963706174, 7.6160164646995945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6372369052092814, "mean_inference_ms": 1.7007719226657878, "mean_action_processing_ms": 0.2612499045923062, "mean_env_wait_ms": 0.14766211304542431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00857234001159668, "StateBufferConnector_ms": 0.004122614860534668, "ViewRequirementAgentConnector_ms": 0.1346832513809204}, "num_episodes": 22, "episode_return_max": 52.132889331079326, "episode_return_min": -2.7451731786063993, "episode_return_mean": 18.395275493260247, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.60693586222203, "num_env_steps_trained_throughput_per_sec": 342.60693586222203, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 11793.215, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11793.047, "sample_time_ms": 1346.791, "learn_time_ms": 10424.459, "learn_throughput": 383.713, "synch_weights_time_ms": 20.434}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 54, "trial_id": "06536_00000", "date": "2024-08-11_16-44-33", "timestamp": 1723409073, "time_this_iter_s": 11.724645853042603, "time_total_s": 617.3846971988678, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310ed550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 617.3846971988678, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 49.30625, "ram_util_percent": 81.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.698056612101694, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9847196963926157, "policy_loss": -0.007277946880882761, "vf_loss": 1.9919305805116891, "vf_explained_var": 0.9500361376752456, "kl": 0.010731290588778152, "entropy": 0.6583457044015328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.804341524902475, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.108934766779501, "policy_loss": -0.0024417463649389526, "vf_loss": 2.11137649842671, "vf_explained_var": 0.9584621838160924, "kl": 0.004221852814818812, "entropy": 0.5244525555738065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": 52.132889331079326, "episode_reward_min": -2.7451731786063993, "episode_reward_mean": 18.85336964337451, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.1328893310793, "predator_policy": -19.376429593162747}, "policy_reward_max": {"prey_policy": 2.7451731786063984, "predator_policy": 57.48592361250259}, "policy_reward_mean": {"prey_policy": -18.85336964337451, "predator_policy": 18.853369643374513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.65608986545841, 2.345198203826186, 31.506156859400093, 24.169855144696275, 13.915811429714427, 22.497075462351646, 10.860030861471405, 3.005356113290164, 23.237642040640644, 26.829193044621015, -2.7451731786063993, 28.445778143559462, 12.630000229065384, 19.703063522803312, 5.236940988390733, 16.200158628375842, 32.371167982460946, -0.8451673566492657, 21.934112490475066, 18.248249560042282, 10.545381452230902, 16.424080151600634, 28.21042164925126, 20.729315065602147, 12.1116829046067, 27.35218017900809, 33.396687517824645, 14.73443169367289, 31.704206276506866, 18.194997451087108, 22.209326593198497, 40.460858005914844, 33.48447244989337, 6.355547888034413, 7.837908075451874, 6.249731414256946, 23.214919157915816, 10.889261316670108, 20.691549483207112, 22.007316225204367, -2.4297515166319505, 10.4073371587445, 2.2094614025927095, 7.028539545187851, 4.386875193728686, 31.816274395079986, 30.55192783795655, 35.87969722616598, 16.066237327810885, 15.481986327071944, 13.43316910168024, 16.918705928414063, 23.344774510749712, 8.670678749380501, 30.965198850876654, 11.321012234900941, 11.611358511680976, 5.989773303772122, 26.92388581596834, 14.082110505610396, 31.732607879884434, 11.566535836658153, 25.064120078055435, 27.96534417040981, 22.63318076500756, 7.604918667060629, 52.132889331079326, 17.884132301907595, 27.491145609376176, 31.161016493025375, 20.88395348481671, 35.12999864406478, 18.208470797834263, 24.85895415848021, 0.1154328036116139, 26.881557451315523, 24.240406417658487, 13.757544006007754, 20.66110962121972, 11.32366697268914, -0.6068361446513215, 26.41442499674177, 1.213402353750749, 28.10895068037573, 8.620673569395866, 21.839971909394972, 4.147780824326622, 15.306417903807052, 31.739627194013146, 7.515423650239621, 27.382629768992253, 24.968125339359258, 21.88758802681743, 25.227715797499236, 39.55807688546404, 11.477697787355165, 18.59533358294641, 24.89800778749356, 29.592196578778438, 17.487702957921307], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.656089865458384, -2.3451982038262127, -31.50615685940017, -24.16985514469627, -13.915811429714411, -22.49707546235167, -10.860030861471422, -3.0053561132901523, -23.237642040640655, -26.82919304462104, 2.7451731786063984, -28.445778143559544, -12.630000229065374, -19.703063522803287, -5.236940988390735, -16.20015862837581, -32.371167982460946, 0.8451673566492701, -21.93411249047505, -18.248249560042268, -10.5453814522309, -16.424080151600645, -28.21042164925122, -20.72931506560214, -12.111682904606726, -27.352180179008084, -33.39668751782463, -14.734431693672873, -31.704206276506827, -18.194997451087115, -22.209326593198504, -40.46085800591486, -33.48447244989338, -6.355547888034415, -7.837908075451876, -6.249731414256955, -23.21491915791577, -10.889261316670122, -20.69154948320713, -22.007316225204406, 2.4297515166319505, -10.407337158744511, -2.209461402592705, -7.0285395451878765, -4.386875193728682, -31.816274395079976, -30.551927837956548, -35.8796972261659, -16.066237327810885, -15.481986327071901, -13.433169101680253, -16.91870592841405, -23.34477451074971, -8.670678749380524, -30.96519885087665, -11.321012234900959, -11.61135851168098, -5.989773303772122, -26.923885815968323, -14.08211050561041, -31.732607879884416, -11.56653583665813, -25.064120078055414, -27.965344170409793, -22.633180765007587, -7.604918667060634, -52.1328893310793, -17.884132301907595, -27.491145609376144, -31.16101649302537, -20.883953484816715, -35.12999864406483, -18.20847079783425, -24.858954158480188, -0.11543280361159347, -26.881557451315512, -24.240406417658487, -13.75754400600775, -20.661109621219733, -11.323666972689091, 0.606836144651326, -26.414424996741783, -1.2134023537507366, -28.108950680375738, -8.620673569395821, -21.83997190939498, -4.147780824326639, -15.306417903807038, -31.739627194013128, -7.515423650239665, -27.382629768992256, -24.968125339359254, -21.88758802681741, -25.227715797499283, -39.55807688546405, -11.477697787355174, -18.5953335829464, -24.898007787493587, -29.592196578778463, -17.487702957921307], "policy_predator_policy_reward": [30.350158633927606, 4.962021096989199, 24.066826000815112, -19.376429593162747, 37.67702885042783, 25.33528486837244, 33.19142739654578, 15.148282892846767, 17.724315161929884, 10.107307697498918, 27.50220423932648, 17.49194668537681, 13.794185000014409, 7.9258767229284315, 12.488365287568216, -6.477653060987896, 15.07566912482402, 31.39961495645731, 38.28807100151435, 15.370315087727654, 2.4327392293939205, -7.9230855866067245, 34.113443929091794, 22.778112358027258, 5.924456571545409, 19.335543886585363, 5.750297911035458, 33.6558291345711, 1.0440645229794505, 9.429817453802023, 15.232582650658312, 17.16773460609331, 36.670316898992, 28.072019065929855, -6.856817908434179, 5.1664831951356405, 9.37043062797586, 34.49779435297425, 22.10783320916415, 14.388665910920386, 16.743368455382697, 4.347394449079106, 28.14983870720718, 4.698321595994104, 28.778164856532687, 27.642678441969807, 19.574833459138308, 21.883796672065987, 21.130515655183686, 3.092850154029759, 28.87200742139124, 25.832352936624943, 44.456929965549875, 22.336445070099415, 0.5291089395313193, 28.939754447814416, 52.065034331271306, 11.343378221742313, 32.88726855302267, 3.502726349151562, 29.217711341410777, 15.20094184498621, 41.234275474488285, 39.68744053734136, 36.12338171827255, 30.8455631815142, 7.56044115552512, 5.150654620543709, 13.566996393863395, 2.1088197570403544, 25.594543227734185, -13.09508039922027, 7.781218013746583, 38.64862030208499, 22.02466265568563, -0.24614002234537757, 14.926004868203638, 26.457094098210597, 14.472564485644012, 29.542067964764733, 5.7666372218693045, -10.626140255133196, 18.73849618675112, 2.0761781307379037, 2.072510867203057, 2.3464119379823583, 15.538116519260559, -1.481037428884843, 0.5274614305556147, 8.246288956901761, 32.22674612107101, 31.405802669088928, 24.08294142838982, 37.020914247523244, 36.818803060210975, 34.9405913921209, 19.84384747729105, 12.288627178330714, 15.844700707638378, 15.119271946505453, 17.161030486472242, 9.705307716888257, 19.78839569669051, 14.04901616013759, 14.177974968514565, 32.51157405298487, 4.79534014821826, 12.546017350542758, 36.183817099006916, 25.746580602746405, 14.86709953841551, 7.774924931386425, 13.416984178676067, 9.805732844685883, 8.501213130878337, 3.478333476665915, 29.875102634199273, 23.972668997737347, 20.730864820953023, 7.433356190267771, 34.05342044006857, 29.411795319700257, -5.810901572449742, 28.943973245765985, 22.020343909228725, 28.10789624688213, 12.53401477331552, 43.396673567504095, 26.864364921628464, 18.401996608386675, 13.876949032121747, 1.3328883019995192, 46.779855049656064, 57.48592361250259, 10.862096673395945, 24.90616793041927, 22.67275180036837, 32.30953941838392, 38.1014661968709, 24.220566789179866, 20.00722152530141, 21.760685444332005, 27.875652090219898, 42.38434519790975, 17.54437802021088, 18.872563575457608, 25.396506793277997, 24.321401523682393, 5.081947254319427, -4.8510816470962235, 27.344923139714737, 26.41819176291633, 40.8647963706174, 7.6160164646995945, 10.179905268529895, 17.335182743485603, 24.591126556578573, 16.731092685860894, -4.177748211841978, 26.82508215722016, 2.2375478371964643, -3.451220126499104, 37.60816442550256, 15.220685567981029, -4.463440897851172, 6.89024560535263, 27.16899176155502, 29.048909599196424, 16.237010351565495, 1.0043367872261673, 27.938133958378693, 15.741809860411266, 14.10832469228789, -5.812763043634624, 9.42915443614002, 21.183681371474055, 34.95779102633571, 28.521463361690547, 18.26274572544445, -3.231898424965128, 36.79500307734047, 17.970256460644062, 24.20842386522861, 25.72782681348988, 41.677383087777194, 2.0977929658576397, 27.692805394546458, 22.762626200452083, 37.20213429343887, 41.91401947748927, 23.697037363177053, -0.7416417884667066, 16.102325866900067, 21.08834129899272, 19.333178916480982, 30.462836658506205, 36.5394031073097, 22.644990050247205, 32.82233528965235, 2.153070626190271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6380407393174479, "mean_inference_ms": 1.7026922585959585, "mean_action_processing_ms": 0.2615624786605995, "mean_env_wait_ms": 0.14795777696677684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026174545288086, "StateBufferConnector_ms": 0.0034264326095581055, "ViewRequirementAgentConnector_ms": 0.1365748643875122}, "num_episodes": 23, "episode_return_max": 52.132889331079326, "episode_return_min": -2.7451731786063993, "episode_return_mean": 18.85336964337451, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.70435562042405, "num_env_steps_trained_throughput_per_sec": 332.70435562042405, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 11803.958, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11803.796, "sample_time_ms": 1381.93, "learn_time_ms": 10403.557, "learn_throughput": 384.484, "synch_weights_time_ms": 17.218}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 55, "trial_id": "06536_00000", "date": "2024-08-11_16-44-45", "timestamp": 1723409085, "time_this_iter_s": 12.073657274246216, "time_total_s": 629.458354473114, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33162d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 629.458354473114, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 49.00555555555556, "ram_util_percent": 81.74444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7947450209409, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.301106488207976, "policy_loss": -0.01332715673003501, "vf_loss": 2.314357573787371, "vf_explained_var": 0.9489109275862575, "kl": 0.012171817488352114, "entropy": 0.6963957517097393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.041058478878919, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6979164833744997, "policy_loss": -0.004637023195545509, "vf_loss": 2.702553510539746, "vf_explained_var": 0.9559734475044978, "kl": 0.006452892944271392, "entropy": 0.4699965367083827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 52.132889331079326, "episode_reward_min": -9.036167512920898, "episode_reward_mean": 18.65711845964988, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.1328893310793, "predator_policy": -17.998353083225226}, "policy_reward_max": {"prey_policy": 9.03616751292091, "predator_policy": 57.48592361250259}, "policy_reward_mean": {"prey_policy": -18.65711845964988, "predator_policy": 18.65711845964988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.934112490475066, 18.248249560042282, 10.545381452230902, 16.424080151600634, 28.21042164925126, 20.729315065602147, 12.1116829046067, 27.35218017900809, 33.396687517824645, 14.73443169367289, 31.704206276506866, 18.194997451087108, 22.209326593198497, 40.460858005914844, 33.48447244989337, 6.355547888034413, 7.837908075451874, 6.249731414256946, 23.214919157915816, 10.889261316670108, 20.691549483207112, 22.007316225204367, -2.4297515166319505, 10.4073371587445, 2.2094614025927095, 7.028539545187851, 4.386875193728686, 31.816274395079986, 30.55192783795655, 35.87969722616598, 16.066237327810885, 15.481986327071944, 13.43316910168024, 16.918705928414063, 23.344774510749712, 8.670678749380501, 30.965198850876654, 11.321012234900941, 11.611358511680976, 5.989773303772122, 26.92388581596834, 14.082110505610396, 31.732607879884434, 11.566535836658153, 25.064120078055435, 27.96534417040981, 22.63318076500756, 7.604918667060629, 52.132889331079326, 17.884132301907595, 27.491145609376176, 31.161016493025375, 20.88395348481671, 35.12999864406478, 18.208470797834263, 24.85895415848021, 0.1154328036116139, 26.881557451315523, 24.240406417658487, 13.757544006007754, 20.66110962121972, 11.32366697268914, -0.6068361446513215, 26.41442499674177, 1.213402353750749, 28.10895068037573, 8.620673569395866, 21.839971909394972, 4.147780824326622, 15.306417903807052, 31.739627194013146, 7.515423650239621, 27.382629768992253, 24.968125339359258, 21.88758802681743, 25.227715797499236, 39.55807688546404, 11.477697787355165, 18.59533358294641, 24.89800778749356, 29.592196578778438, 17.487702957921307, -2.2075889702778975, 34.78760064444253, 14.361793450016613, 38.93137455955205, 21.815327604564125, 26.76788521465216, -9.036167512920898, 8.068542868198703, -4.013609871551805, 9.323210990688802, 13.270174349520879, 44.87337623007728, -7.870803983031285, 3.7918215032104783, 30.161088240346665, 20.720557437646004, 3.672787799720698, 19.97668905755181], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.93411249047505, -18.248249560042268, -10.5453814522309, -16.424080151600645, -28.21042164925122, -20.72931506560214, -12.111682904606726, -27.352180179008084, -33.39668751782463, -14.734431693672873, -31.704206276506827, -18.194997451087115, -22.209326593198504, -40.46085800591486, -33.48447244989338, -6.355547888034415, -7.837908075451876, -6.249731414256955, -23.21491915791577, -10.889261316670122, -20.69154948320713, -22.007316225204406, 2.4297515166319505, -10.407337158744511, -2.209461402592705, -7.0285395451878765, -4.386875193728682, -31.816274395079976, -30.551927837956548, -35.8796972261659, -16.066237327810885, -15.481986327071901, -13.433169101680253, -16.91870592841405, -23.34477451074971, -8.670678749380524, -30.96519885087665, -11.321012234900959, -11.61135851168098, -5.989773303772122, -26.923885815968323, -14.08211050561041, -31.732607879884416, -11.56653583665813, -25.064120078055414, -27.965344170409793, -22.633180765007587, -7.604918667060634, -52.1328893310793, -17.884132301907595, -27.491145609376144, -31.16101649302537, -20.883953484816715, -35.12999864406483, -18.20847079783425, -24.858954158480188, -0.11543280361159347, -26.881557451315512, -24.240406417658487, -13.75754400600775, -20.661109621219733, -11.323666972689091, 0.606836144651326, -26.414424996741783, -1.2134023537507366, -28.108950680375738, -8.620673569395821, -21.83997190939498, -4.147780824326639, -15.306417903807038, -31.739627194013128, -7.515423650239665, -27.382629768992256, -24.968125339359254, -21.88758802681741, -25.227715797499283, -39.55807688546405, -11.477697787355174, -18.5953335829464, -24.898007787493587, -29.592196578778463, -17.487702957921307, 2.207588970277895, -34.7876006444425, -14.361793450016616, -38.931374559552026, -21.815327604564146, -26.767885214652186, 9.03616751292091, -8.068542868198712, 4.013609871551808, -9.3232109906888, -13.270174349520884, -44.87337623007739, 7.870803983031285, -3.791821503210496, -30.16108824034666, -20.72055743764599, -3.672787799720693, -19.976689057551802], "policy_predator_policy_reward": [9.37043062797586, 34.49779435297425, 22.10783320916415, 14.388665910920386, 16.743368455382697, 4.347394449079106, 28.14983870720718, 4.698321595994104, 28.778164856532687, 27.642678441969807, 19.574833459138308, 21.883796672065987, 21.130515655183686, 3.092850154029759, 28.87200742139124, 25.832352936624943, 44.456929965549875, 22.336445070099415, 0.5291089395313193, 28.939754447814416, 52.065034331271306, 11.343378221742313, 32.88726855302267, 3.502726349151562, 29.217711341410777, 15.20094184498621, 41.234275474488285, 39.68744053734136, 36.12338171827255, 30.8455631815142, 7.56044115552512, 5.150654620543709, 13.566996393863395, 2.1088197570403544, 25.594543227734185, -13.09508039922027, 7.781218013746583, 38.64862030208499, 22.02466265568563, -0.24614002234537757, 14.926004868203638, 26.457094098210597, 14.472564485644012, 29.542067964764733, 5.7666372218693045, -10.626140255133196, 18.73849618675112, 2.0761781307379037, 2.072510867203057, 2.3464119379823583, 15.538116519260559, -1.481037428884843, 0.5274614305556147, 8.246288956901761, 32.22674612107101, 31.405802669088928, 24.08294142838982, 37.020914247523244, 36.818803060210975, 34.9405913921209, 19.84384747729105, 12.288627178330714, 15.844700707638378, 15.119271946505453, 17.161030486472242, 9.705307716888257, 19.78839569669051, 14.04901616013759, 14.177974968514565, 32.51157405298487, 4.79534014821826, 12.546017350542758, 36.183817099006916, 25.746580602746405, 14.86709953841551, 7.774924931386425, 13.416984178676067, 9.805732844685883, 8.501213130878337, 3.478333476665915, 29.875102634199273, 23.972668997737347, 20.730864820953023, 7.433356190267771, 34.05342044006857, 29.411795319700257, -5.810901572449742, 28.943973245765985, 22.020343909228725, 28.10789624688213, 12.53401477331552, 43.396673567504095, 26.864364921628464, 18.401996608386675, 13.876949032121747, 1.3328883019995192, 46.779855049656064, 57.48592361250259, 10.862096673395945, 24.90616793041927, 22.67275180036837, 32.30953941838392, 38.1014661968709, 24.220566789179866, 20.00722152530141, 21.760685444332005, 27.875652090219898, 42.38434519790975, 17.54437802021088, 18.872563575457608, 25.396506793277997, 24.321401523682393, 5.081947254319427, -4.8510816470962235, 27.344923139714737, 26.41819176291633, 40.8647963706174, 7.6160164646995945, 10.179905268529895, 17.335182743485603, 24.591126556578573, 16.731092685860894, -4.177748211841978, 26.82508215722016, 2.2375478371964643, -3.451220126499104, 37.60816442550256, 15.220685567981029, -4.463440897851172, 6.89024560535263, 27.16899176155502, 29.048909599196424, 16.237010351565495, 1.0043367872261673, 27.938133958378693, 15.741809860411266, 14.10832469228789, -5.812763043634624, 9.42915443614002, 21.183681371474055, 34.95779102633571, 28.521463361690547, 18.26274572544445, -3.231898424965128, 36.79500307734047, 17.970256460644062, 24.20842386522861, 25.72782681348988, 41.677383087777194, 2.0977929658576397, 27.692805394546458, 22.762626200452083, 37.20213429343887, 41.91401947748927, 23.697037363177053, -0.7416417884667066, 16.102325866900067, 21.08834129899272, 19.333178916480982, 30.462836658506205, 36.5394031073097, 22.644990050247205, 32.82233528965235, 2.153070626190271, -2.3660465278462963, -2.0491314127094915, 31.518178123654746, 38.0570231652303, 9.102808744794732, 19.62077815523849, 37.34072007547037, 40.522029043633694, 22.74249275264308, 20.888162456485205, 28.4685263726629, 25.067244056641446, -17.998353083225226, -0.07398194261659263, 13.021530737350938, 3.115554999046477, 2.397929362564472, -10.42514910566809, 26.08958949780329, -7.4431675164256985, 16.943122655638398, 9.597226043403385, 46.489867201207026, 43.25688525894772, -12.741459525536861, -3.000148440525715, 4.445559896773865, 3.1380831096471136, 37.22221969750488, 23.099956783188425, 0.9734332335210993, 40.467681641770916, 6.999572583020727, 0.34600301642067066, 27.434133439278217, 12.519244675825384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6383843572935892, "mean_inference_ms": 1.7029952228699097, "mean_action_processing_ms": 0.26177720036379354, "mean_env_wait_ms": 0.1480714163187609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041141510009765625, "StateBufferConnector_ms": 0.006190180778503418, "ViewRequirementAgentConnector_ms": 0.12121689319610596}, "num_episodes": 18, "episode_return_max": 52.132889331079326, "episode_return_min": -9.036167512920898, "episode_return_mean": 18.65711845964988, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.7455395874073, "num_env_steps_trained_throughput_per_sec": 354.7455395874073, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 11820.277, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11820.115, "sample_time_ms": 1410.055, "learn_time_ms": 10386.781, "learn_throughput": 385.105, "synch_weights_time_ms": 19.644}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 56, "trial_id": "06536_00000", "date": "2024-08-11_16-44-56", "timestamp": 1723409096, "time_this_iter_s": 11.325109004974365, "time_total_s": 640.7834634780884, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317129d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 640.7834634780884, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 47.900000000000006, "ram_util_percent": 81.61874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9230532166858514, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.507016695663333, "policy_loss": -0.015218455397310511, "vf_loss": 2.5221262836207945, "vf_explained_var": 0.9465648269280791, "kl": 0.01741902553048181, "entropy": 0.6719157516956329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.135335578174187, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5681826594645383, "policy_loss": -0.0021305785080782636, "vf_loss": 2.570313237836121, "vf_explained_var": 0.9544208602615134, "kl": 0.0054497716055640355, "entropy": 0.43399198717541165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "env_runners": {"episode_reward_max": 52.132889331079326, "episode_reward_min": -9.036167512920898, "episode_reward_mean": 18.671798508203832, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.1328893310793, "predator_policy": -17.998353083225226}, "policy_reward_max": {"prey_policy": 9.03616751292091, "predator_policy": 57.48592361250259}, "policy_reward_mean": {"prey_policy": -18.671798508203832, "predator_policy": 18.671798508203832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.214919157915816, 10.889261316670108, 20.691549483207112, 22.007316225204367, -2.4297515166319505, 10.4073371587445, 2.2094614025927095, 7.028539545187851, 4.386875193728686, 31.816274395079986, 30.55192783795655, 35.87969722616598, 16.066237327810885, 15.481986327071944, 13.43316910168024, 16.918705928414063, 23.344774510749712, 8.670678749380501, 30.965198850876654, 11.321012234900941, 11.611358511680976, 5.989773303772122, 26.92388581596834, 14.082110505610396, 31.732607879884434, 11.566535836658153, 25.064120078055435, 27.96534417040981, 22.63318076500756, 7.604918667060629, 52.132889331079326, 17.884132301907595, 27.491145609376176, 31.161016493025375, 20.88395348481671, 35.12999864406478, 18.208470797834263, 24.85895415848021, 0.1154328036116139, 26.881557451315523, 24.240406417658487, 13.757544006007754, 20.66110962121972, 11.32366697268914, -0.6068361446513215, 26.41442499674177, 1.213402353750749, 28.10895068037573, 8.620673569395866, 21.839971909394972, 4.147780824326622, 15.306417903807052, 31.739627194013146, 7.515423650239621, 27.382629768992253, 24.968125339359258, 21.88758802681743, 25.227715797499236, 39.55807688546404, 11.477697787355165, 18.59533358294641, 24.89800778749356, 29.592196578778438, 17.487702957921307, -2.2075889702778975, 34.78760064444253, 14.361793450016613, 38.93137455955205, 21.815327604564125, 26.76788521465216, -9.036167512920898, 8.068542868198703, -4.013609871551805, 9.323210990688802, 13.270174349520879, 44.87337623007728, -7.870803983031285, 3.7918215032104783, 30.161088240346665, 20.720557437646004, 3.672787799720698, 19.97668905755181, 23.05236466755282, -4.823655041775236, 22.116795874904973, 40.727993715657156, 11.586207129730301, 37.32495583216953, 33.58389739887165, 23.784533098325245, 29.99184066534138, 17.126322606833, 29.337000914718715, 27.328276515640198, 16.780518324680052, -1.26256354892117, 18.349868591553996, 21.455387620768924, 8.531553879757107, 16.66029742824505], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.21491915791577, -10.889261316670122, -20.69154948320713, -22.007316225204406, 2.4297515166319505, -10.407337158744511, -2.209461402592705, -7.0285395451878765, -4.386875193728682, -31.816274395079976, -30.551927837956548, -35.8796972261659, -16.066237327810885, -15.481986327071901, -13.433169101680253, -16.91870592841405, -23.34477451074971, -8.670678749380524, -30.96519885087665, -11.321012234900959, -11.61135851168098, -5.989773303772122, -26.923885815968323, -14.08211050561041, -31.732607879884416, -11.56653583665813, -25.064120078055414, -27.965344170409793, -22.633180765007587, -7.604918667060634, -52.1328893310793, -17.884132301907595, -27.491145609376144, -31.16101649302537, -20.883953484816715, -35.12999864406483, -18.20847079783425, -24.858954158480188, -0.11543280361159347, -26.881557451315512, -24.240406417658487, -13.75754400600775, -20.661109621219733, -11.323666972689091, 0.606836144651326, -26.414424996741783, -1.2134023537507366, -28.108950680375738, -8.620673569395821, -21.83997190939498, -4.147780824326639, -15.306417903807038, -31.739627194013128, -7.515423650239665, -27.382629768992256, -24.968125339359254, -21.88758802681741, -25.227715797499283, -39.55807688546405, -11.477697787355174, -18.5953335829464, -24.898007787493587, -29.592196578778463, -17.487702957921307, 2.207588970277895, -34.7876006444425, -14.361793450016616, -38.931374559552026, -21.815327604564146, -26.767885214652186, 9.03616751292091, -8.068542868198712, 4.013609871551808, -9.3232109906888, -13.270174349520884, -44.87337623007739, 7.870803983031285, -3.791821503210496, -30.16108824034666, -20.72055743764599, -3.672787799720693, -19.976689057551802, -23.0523646675528, 4.823655041775236, -22.116795874904973, -40.72799371565728, -11.58620712973032, -37.3249558321696, -33.58389739887163, -23.784533098325223, -29.991840665341385, -17.12632260683298, -29.337000914718722, -27.328276515640248, -16.78051832468006, 1.2625635489211797, -18.349868591554014, -21.45538762076889, -8.531553879757102, -16.660297428245087], "policy_predator_policy_reward": [7.781218013746583, 38.64862030208499, 22.02466265568563, -0.24614002234537757, 14.926004868203638, 26.457094098210597, 14.472564485644012, 29.542067964764733, 5.7666372218693045, -10.626140255133196, 18.73849618675112, 2.0761781307379037, 2.072510867203057, 2.3464119379823583, 15.538116519260559, -1.481037428884843, 0.5274614305556147, 8.246288956901761, 32.22674612107101, 31.405802669088928, 24.08294142838982, 37.020914247523244, 36.818803060210975, 34.9405913921209, 19.84384747729105, 12.288627178330714, 15.844700707638378, 15.119271946505453, 17.161030486472242, 9.705307716888257, 19.78839569669051, 14.04901616013759, 14.177974968514565, 32.51157405298487, 4.79534014821826, 12.546017350542758, 36.183817099006916, 25.746580602746405, 14.86709953841551, 7.774924931386425, 13.416984178676067, 9.805732844685883, 8.501213130878337, 3.478333476665915, 29.875102634199273, 23.972668997737347, 20.730864820953023, 7.433356190267771, 34.05342044006857, 29.411795319700257, -5.810901572449742, 28.943973245765985, 22.020343909228725, 28.10789624688213, 12.53401477331552, 43.396673567504095, 26.864364921628464, 18.401996608386675, 13.876949032121747, 1.3328883019995192, 46.779855049656064, 57.48592361250259, 10.862096673395945, 24.90616793041927, 22.67275180036837, 32.30953941838392, 38.1014661968709, 24.220566789179866, 20.00722152530141, 21.760685444332005, 27.875652090219898, 42.38434519790975, 17.54437802021088, 18.872563575457608, 25.396506793277997, 24.321401523682393, 5.081947254319427, -4.8510816470962235, 27.344923139714737, 26.41819176291633, 40.8647963706174, 7.6160164646995945, 10.179905268529895, 17.335182743485603, 24.591126556578573, 16.731092685860894, -4.177748211841978, 26.82508215722016, 2.2375478371964643, -3.451220126499104, 37.60816442550256, 15.220685567981029, -4.463440897851172, 6.89024560535263, 27.16899176155502, 29.048909599196424, 16.237010351565495, 1.0043367872261673, 27.938133958378693, 15.741809860411266, 14.10832469228789, -5.812763043634624, 9.42915443614002, 21.183681371474055, 34.95779102633571, 28.521463361690547, 18.26274572544445, -3.231898424965128, 36.79500307734047, 17.970256460644062, 24.20842386522861, 25.72782681348988, 41.677383087777194, 2.0977929658576397, 27.692805394546458, 22.762626200452083, 37.20213429343887, 41.91401947748927, 23.697037363177053, -0.7416417884667066, 16.102325866900067, 21.08834129899272, 19.333178916480982, 30.462836658506205, 36.5394031073097, 22.644990050247205, 32.82233528965235, 2.153070626190271, -2.3660465278462963, -2.0491314127094915, 31.518178123654746, 38.0570231652303, 9.102808744794732, 19.62077815523849, 37.34072007547037, 40.522029043633694, 22.74249275264308, 20.888162456485205, 28.4685263726629, 25.067244056641446, -17.998353083225226, -0.07398194261659263, 13.021530737350938, 3.115554999046477, 2.397929362564472, -10.42514910566809, 26.08958949780329, -7.4431675164256985, 16.943122655638398, 9.597226043403385, 46.489867201207026, 43.25688525894772, -12.741459525536861, -3.000148440525715, 4.445559896773865, 3.1380831096471136, 37.22221969750488, 23.099956783188425, 0.9734332335210993, 40.467681641770916, 6.999572583020727, 0.34600301642067066, 27.434133439278217, 12.519244675825384, 24.857069975038932, 21.24765936006669, -6.3246114805106135, -3.3226986030398553, 8.535066727127148, 35.69852502268278, 38.80439891935307, 42.65158851196142, 23.857657020763888, -0.6852427613032566, 43.82293296795727, 30.82697869638182, 26.31660859532519, 40.85118620241806, 13.551245985660277, 34.017820210990166, 21.58863312220426, 38.39504820847853, 6.95564611219184, 27.296999101474114, 11.838505342192324, 46.835496487245116, 22.85850700919117, 31.798046022089295, 22.882537076313326, 10.67849957304678, 4.602610266591768, -7.127737364434121, 13.3854534736982, 23.31428370940983, 24.23787184901311, 18.672903392524674, 4.8910575466437045, 12.172050212870502, 8.106699770657022, 25.21389508583307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6381677824696478, "mean_inference_ms": 1.7017298812466253, "mean_action_processing_ms": 0.26173962510310816, "mean_env_wait_ms": 0.14800644711805896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026174545288086, "StateBufferConnector_ms": 0.006046414375305176, "ViewRequirementAgentConnector_ms": 0.11154317855834961}, "num_episodes": 18, "episode_return_max": 52.132889331079326, "episode_return_min": -9.036167512920898, "episode_return_mean": 18.671798508203832, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.54650109892196, "num_env_steps_trained_throughput_per_sec": 341.54650109892196, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 11878.667, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11878.502, "sample_time_ms": 1388.8, "learn_time_ms": 10467.232, "learn_throughput": 382.145, "synch_weights_time_ms": 18.8}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "training_iteration": 57, "trial_id": "06536_00000", "date": "2024-08-11_16-45-08", "timestamp": 1723409108, "time_this_iter_s": 11.907938003540039, "time_total_s": 652.6914014816284, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33162dc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 652.6914014816284, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 50.74117647058823, "ram_util_percent": 81.82941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6878514263778923, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9646274174253147, "policy_loss": -0.012552472655564391, "vf_loss": 1.977119763319691, "vf_explained_var": 0.9655892953897516, "kl": 0.009621471996209862, "entropy": 0.6388083036368092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.696488886630094, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0260543928575263, "policy_loss": -0.0025604616786555324, "vf_loss": 2.028614856515612, "vf_explained_var": 0.97125130040305, "kl": 0.004443685087072317, "entropy": 0.42596908057177507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 52.132889331079326, "episode_reward_min": -9.036167512920898, "episode_reward_mean": 19.930460128619735, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.1328893310793, "predator_policy": -17.998353083225226}, "policy_reward_max": {"prey_policy": 9.03616751292091, "predator_policy": 60.00486156637194}, "policy_reward_mean": {"prey_policy": -19.930460128619735, "predator_policy": 19.930460128619735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.92388581596834, 14.082110505610396, 31.732607879884434, 11.566535836658153, 25.064120078055435, 27.96534417040981, 22.63318076500756, 7.604918667060629, 52.132889331079326, 17.884132301907595, 27.491145609376176, 31.161016493025375, 20.88395348481671, 35.12999864406478, 18.208470797834263, 24.85895415848021, 0.1154328036116139, 26.881557451315523, 24.240406417658487, 13.757544006007754, 20.66110962121972, 11.32366697268914, -0.6068361446513215, 26.41442499674177, 1.213402353750749, 28.10895068037573, 8.620673569395866, 21.839971909394972, 4.147780824326622, 15.306417903807052, 31.739627194013146, 7.515423650239621, 27.382629768992253, 24.968125339359258, 21.88758802681743, 25.227715797499236, 39.55807688546404, 11.477697787355165, 18.59533358294641, 24.89800778749356, 29.592196578778438, 17.487702957921307, -2.2075889702778975, 34.78760064444253, 14.361793450016613, 38.93137455955205, 21.815327604564125, 26.76788521465216, -9.036167512920898, 8.068542868198703, -4.013609871551805, 9.323210990688802, 13.270174349520879, 44.87337623007728, -7.870803983031285, 3.7918215032104783, 30.161088240346665, 20.720557437646004, 3.672787799720698, 19.97668905755181, 23.05236466755282, -4.823655041775236, 22.116795874904973, 40.727993715657156, 11.586207129730301, 37.32495583216953, 33.58389739887165, 23.784533098325245, 29.99184066534138, 17.126322606833, 29.337000914718715, 27.328276515640198, 16.780518324680052, -1.26256354892117, 18.349868591553996, 21.455387620768924, 8.531553879757107, 16.66029742824505, 43.93776476685754, 22.507876197250468, 31.681568910792535, 16.509207128867864, 4.9762561210431056, -3.690819840212387, 22.3238618090569, 12.341278893672392, 26.872401255400437, 27.186525074170774, 21.723604375867318, 16.736889903007274, 8.811703748187233, 37.744982616697406, 10.729090097357375, 25.574451864880505, 11.55812884618864, 37.829010817338016, 8.791173981163432, 45.85165608418123, 22.011063850863277, 24.314787811118585], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.923885815968323, -14.08211050561041, -31.732607879884416, -11.56653583665813, -25.064120078055414, -27.965344170409793, -22.633180765007587, -7.604918667060634, -52.1328893310793, -17.884132301907595, -27.491145609376144, -31.16101649302537, -20.883953484816715, -35.12999864406483, -18.20847079783425, -24.858954158480188, -0.11543280361159347, -26.881557451315512, -24.240406417658487, -13.75754400600775, -20.661109621219733, -11.323666972689091, 0.606836144651326, -26.414424996741783, -1.2134023537507366, -28.108950680375738, -8.620673569395821, -21.83997190939498, -4.147780824326639, -15.306417903807038, -31.739627194013128, -7.515423650239665, -27.382629768992256, -24.968125339359254, -21.88758802681741, -25.227715797499283, -39.55807688546405, -11.477697787355174, -18.5953335829464, -24.898007787493587, -29.592196578778463, -17.487702957921307, 2.207588970277895, -34.7876006444425, -14.361793450016616, -38.931374559552026, -21.815327604564146, -26.767885214652186, 9.03616751292091, -8.068542868198712, 4.013609871551808, -9.3232109906888, -13.270174349520884, -44.87337623007739, 7.870803983031285, -3.791821503210496, -30.16108824034666, -20.72055743764599, -3.672787799720693, -19.976689057551802, -23.0523646675528, 4.823655041775236, -22.116795874904973, -40.72799371565728, -11.58620712973032, -37.3249558321696, -33.58389739887163, -23.784533098325223, -29.991840665341385, -17.12632260683298, -29.337000914718722, -27.328276515640248, -16.78051832468006, 1.2625635489211797, -18.349868591554014, -21.45538762076889, -8.531553879757102, -16.660297428245087, -43.93776476685746, -22.507876197250507, -31.68156891079256, -16.50920712886785, -4.9762561210431, 3.690819840212389, -22.323861809056922, -12.341278893672392, -26.872401255400472, -27.186525074170742, -21.723604375867303, -16.736889903007263, -8.811703748187236, -37.74498261669743, -10.72909009735737, -25.574451864880526, -11.558128846188623, -37.82901081733803, -8.791173981163425, -45.85165608418129, -22.011063850863295, -24.314787811118556], "policy_predator_policy_reward": [29.875102634199273, 23.972668997737347, 20.730864820953023, 7.433356190267771, 34.05342044006857, 29.411795319700257, -5.810901572449742, 28.943973245765985, 22.020343909228725, 28.10789624688213, 12.53401477331552, 43.396673567504095, 26.864364921628464, 18.401996608386675, 13.876949032121747, 1.3328883019995192, 46.779855049656064, 57.48592361250259, 10.862096673395945, 24.90616793041927, 22.67275180036837, 32.30953941838392, 38.1014661968709, 24.220566789179866, 20.00722152530141, 21.760685444332005, 27.875652090219898, 42.38434519790975, 17.54437802021088, 18.872563575457608, 25.396506793277997, 24.321401523682393, 5.081947254319427, -4.8510816470962235, 27.344923139714737, 26.41819176291633, 40.8647963706174, 7.6160164646995945, 10.179905268529895, 17.335182743485603, 24.591126556578573, 16.731092685860894, -4.177748211841978, 26.82508215722016, 2.2375478371964643, -3.451220126499104, 37.60816442550256, 15.220685567981029, -4.463440897851172, 6.89024560535263, 27.16899176155502, 29.048909599196424, 16.237010351565495, 1.0043367872261673, 27.938133958378693, 15.741809860411266, 14.10832469228789, -5.812763043634624, 9.42915443614002, 21.183681371474055, 34.95779102633571, 28.521463361690547, 18.26274572544445, -3.231898424965128, 36.79500307734047, 17.970256460644062, 24.20842386522861, 25.72782681348988, 41.677383087777194, 2.0977929658576397, 27.692805394546458, 22.762626200452083, 37.20213429343887, 41.91401947748927, 23.697037363177053, -0.7416417884667066, 16.102325866900067, 21.08834129899272, 19.333178916480982, 30.462836658506205, 36.5394031073097, 22.644990050247205, 32.82233528965235, 2.153070626190271, -2.3660465278462963, -2.0491314127094915, 31.518178123654746, 38.0570231652303, 9.102808744794732, 19.62077815523849, 37.34072007547037, 40.522029043633694, 22.74249275264308, 20.888162456485205, 28.4685263726629, 25.067244056641446, -17.998353083225226, -0.07398194261659263, 13.021530737350938, 3.115554999046477, 2.397929362564472, -10.42514910566809, 26.08958949780329, -7.4431675164256985, 16.943122655638398, 9.597226043403385, 46.489867201207026, 43.25688525894772, -12.741459525536861, -3.000148440525715, 4.445559896773865, 3.1380831096471136, 37.22221969750488, 23.099956783188425, 0.9734332335210993, 40.467681641770916, 6.999572583020727, 0.34600301642067066, 27.434133439278217, 12.519244675825384, 24.857069975038932, 21.24765936006669, -6.3246114805106135, -3.3226986030398553, 8.535066727127148, 35.69852502268278, 38.80439891935307, 42.65158851196142, 23.857657020763888, -0.6852427613032566, 43.82293296795727, 30.82697869638182, 26.31660859532519, 40.85118620241806, 13.551245985660277, 34.017820210990166, 21.58863312220426, 38.39504820847853, 6.95564611219184, 27.296999101474114, 11.838505342192324, 46.835496487245116, 22.85850700919117, 31.798046022089295, 22.882537076313326, 10.67849957304678, 4.602610266591768, -7.127737364434121, 13.3854534736982, 23.31428370940983, 24.23787184901311, 18.672903392524674, 4.8910575466437045, 12.172050212870502, 8.106699770657022, 25.21389508583307, 27.870667967343003, 60.00486156637194, 7.005314034317031, 38.010438360184004, 16.384797169090053, 46.97834065249501, 13.745296118543592, 19.27311813919213, 5.997751606766132, 3.9547606353200937, 4.914860326549965, -12.296500006974748, 18.71629142073096, 25.93143219738291, 8.336368804513182, 16.346188982831602, 39.935939844542034, 13.808862666258886, 20.306742921431216, 34.0663072269103, 24.58212281884798, 18.865085932886625, 22.404231785599343, 11.069548020415182, 7.168916255078111, 10.454491241296354, 29.824116835726038, 45.66584839766883, 6.966488062542906, 14.491692132171833, 39.90715686322876, 11.241746866532278, 1.4056667141047523, 21.710590978272513, 29.347952001923595, 46.310069632752416, 1.5329135194167414, 16.04943444291009, 43.33190233384083, 48.371409834521664, 23.235058632546433, 20.787069069180113, 16.75003611334517, 31.879539508891977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6394205761270504, "mean_inference_ms": 1.7045334241575694, "mean_action_processing_ms": 0.2626348394564269, "mean_env_wait_ms": 0.14838747749106065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004087209701538086, "StateBufferConnector_ms": 0.006151676177978516, "ViewRequirementAgentConnector_ms": 0.12617945671081543}, "num_episodes": 22, "episode_return_max": 52.132889331079326, "episode_return_min": -9.036167512920898, "episode_return_mean": 19.930460128619735, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.35855285949316, "num_env_steps_trained_throughput_per_sec": 322.35855285949316, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 11974.905, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11974.739, "sample_time_ms": 1425.073, "learn_time_ms": 10527.168, "learn_throughput": 379.969, "synch_weights_time_ms": 18.84}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 58, "trial_id": "06536_00000", "date": "2024-08-11_16-45-21", "timestamp": 1723409121, "time_this_iter_s": 12.439038038253784, "time_total_s": 665.1304395198822, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33162db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 665.1304395198822, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 52.14705882352941, "ram_util_percent": 81.90588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.478443763280908, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9101577502985796, "policy_loss": -0.013383151379336293, "vf_loss": 1.9234738702575365, "vf_explained_var": 0.9577831805994114, "kl": 0.010724650797362682, "entropy": 0.6480865472927689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5233152883393424, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8125426788809438, "policy_loss": -0.0028526327330077057, "vf_loss": 1.8153953147312951, "vf_explained_var": 0.9706726486720736, "kl": 0.00404949282963365, "entropy": 0.44296045192965755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "env_runners": {"episode_reward_max": 50.58919329151828, "episode_reward_min": -9.036167512920898, "episode_reward_mean": 19.061093104399006, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58919329151824, "predator_policy": -17.998353083225226}, "policy_reward_max": {"prey_policy": 9.03616751292091, "predator_policy": 60.00486156637194}, "policy_reward_mean": {"prey_policy": -19.061093104399006, "predator_policy": 19.061093104399006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.240406417658487, 13.757544006007754, 20.66110962121972, 11.32366697268914, -0.6068361446513215, 26.41442499674177, 1.213402353750749, 28.10895068037573, 8.620673569395866, 21.839971909394972, 4.147780824326622, 15.306417903807052, 31.739627194013146, 7.515423650239621, 27.382629768992253, 24.968125339359258, 21.88758802681743, 25.227715797499236, 39.55807688546404, 11.477697787355165, 18.59533358294641, 24.89800778749356, 29.592196578778438, 17.487702957921307, -2.2075889702778975, 34.78760064444253, 14.361793450016613, 38.93137455955205, 21.815327604564125, 26.76788521465216, -9.036167512920898, 8.068542868198703, -4.013609871551805, 9.323210990688802, 13.270174349520879, 44.87337623007728, -7.870803983031285, 3.7918215032104783, 30.161088240346665, 20.720557437646004, 3.672787799720698, 19.97668905755181, 23.05236466755282, -4.823655041775236, 22.116795874904973, 40.727993715657156, 11.586207129730301, 37.32495583216953, 33.58389739887165, 23.784533098325245, 29.99184066534138, 17.126322606833, 29.337000914718715, 27.328276515640198, 16.780518324680052, -1.26256354892117, 18.349868591553996, 21.455387620768924, 8.531553879757107, 16.66029742824505, 43.93776476685754, 22.507876197250468, 31.681568910792535, 16.509207128867864, 4.9762561210431056, -3.690819840212387, 22.3238618090569, 12.341278893672392, 26.872401255400437, 27.186525074170774, 21.723604375867318, 16.736889903007274, 8.811703748187233, 37.744982616697406, 10.729090097357375, 25.574451864880505, 11.55812884618864, 37.829010817338016, 8.791173981163432, 45.85165608418123, 22.011063850863277, 24.314787811118585, -1.678524279207565, 12.939084707901314, 28.400426427201086, 29.739874738390938, 31.59521110154507, -3.0906575884509238, 7.8588796685025955, -2.763161013835412, 37.433872808834536, 4.802700573313505, 27.63802560858474, 20.899989059199026, 14.738402553563274, 17.427433443323245, 31.577445451931208, 50.58919329151828, 13.770287690720329, 13.50506812905813], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.240406417658487, -13.75754400600775, -20.661109621219733, -11.323666972689091, 0.606836144651326, -26.414424996741783, -1.2134023537507366, -28.108950680375738, -8.620673569395821, -21.83997190939498, -4.147780824326639, -15.306417903807038, -31.739627194013128, -7.515423650239665, -27.382629768992256, -24.968125339359254, -21.88758802681741, -25.227715797499283, -39.55807688546405, -11.477697787355174, -18.5953335829464, -24.898007787493587, -29.592196578778463, -17.487702957921307, 2.207588970277895, -34.7876006444425, -14.361793450016616, -38.931374559552026, -21.815327604564146, -26.767885214652186, 9.03616751292091, -8.068542868198712, 4.013609871551808, -9.3232109906888, -13.270174349520884, -44.87337623007739, 7.870803983031285, -3.791821503210496, -30.16108824034666, -20.72055743764599, -3.672787799720693, -19.976689057551802, -23.0523646675528, 4.823655041775236, -22.116795874904973, -40.72799371565728, -11.58620712973032, -37.3249558321696, -33.58389739887163, -23.784533098325223, -29.991840665341385, -17.12632260683298, -29.337000914718722, -27.328276515640248, -16.78051832468006, 1.2625635489211797, -18.349868591554014, -21.45538762076889, -8.531553879757102, -16.660297428245087, -43.93776476685746, -22.507876197250507, -31.68156891079256, -16.50920712886785, -4.9762561210431, 3.690819840212389, -22.323861809056922, -12.341278893672392, -26.872401255400472, -27.186525074170742, -21.723604375867303, -16.736889903007263, -8.811703748187236, -37.74498261669743, -10.72909009735737, -25.574451864880526, -11.558128846188623, -37.82901081733803, -8.791173981163425, -45.85165608418129, -22.011063850863295, -24.314787811118556, 1.6785242792075765, -12.93908470790132, -28.400426427201047, -29.739874738390927, -31.59521110154511, 3.09065758845092, -7.858879668502593, 2.7631610138354166, -37.433872808834494, -4.802700573313508, -27.638025608584744, -20.899989059199, -14.738402553563272, -17.427433443323242, -31.577445451931275, -50.58919329151824, -13.770287690720338, -13.505068129058149], "policy_predator_policy_reward": [40.8647963706174, 7.6160164646995945, 10.179905268529895, 17.335182743485603, 24.591126556578573, 16.731092685860894, -4.177748211841978, 26.82508215722016, 2.2375478371964643, -3.451220126499104, 37.60816442550256, 15.220685567981029, -4.463440897851172, 6.89024560535263, 27.16899176155502, 29.048909599196424, 16.237010351565495, 1.0043367872261673, 27.938133958378693, 15.741809860411266, 14.10832469228789, -5.812763043634624, 9.42915443614002, 21.183681371474055, 34.95779102633571, 28.521463361690547, 18.26274572544445, -3.231898424965128, 36.79500307734047, 17.970256460644062, 24.20842386522861, 25.72782681348988, 41.677383087777194, 2.0977929658576397, 27.692805394546458, 22.762626200452083, 37.20213429343887, 41.91401947748927, 23.697037363177053, -0.7416417884667066, 16.102325866900067, 21.08834129899272, 19.333178916480982, 30.462836658506205, 36.5394031073097, 22.644990050247205, 32.82233528965235, 2.153070626190271, -2.3660465278462963, -2.0491314127094915, 31.518178123654746, 38.0570231652303, 9.102808744794732, 19.62077815523849, 37.34072007547037, 40.522029043633694, 22.74249275264308, 20.888162456485205, 28.4685263726629, 25.067244056641446, -17.998353083225226, -0.07398194261659263, 13.021530737350938, 3.115554999046477, 2.397929362564472, -10.42514910566809, 26.08958949780329, -7.4431675164256985, 16.943122655638398, 9.597226043403385, 46.489867201207026, 43.25688525894772, -12.741459525536861, -3.000148440525715, 4.445559896773865, 3.1380831096471136, 37.22221969750488, 23.099956783188425, 0.9734332335210993, 40.467681641770916, 6.999572583020727, 0.34600301642067066, 27.434133439278217, 12.519244675825384, 24.857069975038932, 21.24765936006669, -6.3246114805106135, -3.3226986030398553, 8.535066727127148, 35.69852502268278, 38.80439891935307, 42.65158851196142, 23.857657020763888, -0.6852427613032566, 43.82293296795727, 30.82697869638182, 26.31660859532519, 40.85118620241806, 13.551245985660277, 34.017820210990166, 21.58863312220426, 38.39504820847853, 6.95564611219184, 27.296999101474114, 11.838505342192324, 46.835496487245116, 22.85850700919117, 31.798046022089295, 22.882537076313326, 10.67849957304678, 4.602610266591768, -7.127737364434121, 13.3854534736982, 23.31428370940983, 24.23787184901311, 18.672903392524674, 4.8910575466437045, 12.172050212870502, 8.106699770657022, 25.21389508583307, 27.870667967343003, 60.00486156637194, 7.005314034317031, 38.010438360184004, 16.384797169090053, 46.97834065249501, 13.745296118543592, 19.27311813919213, 5.997751606766132, 3.9547606353200937, 4.914860326549965, -12.296500006974748, 18.71629142073096, 25.93143219738291, 8.336368804513182, 16.346188982831602, 39.935939844542034, 13.808862666258886, 20.306742921431216, 34.0663072269103, 24.58212281884798, 18.865085932886625, 22.404231785599343, 11.069548020415182, 7.168916255078111, 10.454491241296354, 29.824116835726038, 45.66584839766883, 6.966488062542906, 14.491692132171833, 39.90715686322876, 11.241746866532278, 1.4056667141047523, 21.710590978272513, 29.347952001923595, 46.310069632752416, 1.5329135194167414, 16.04943444291009, 43.33190233384083, 48.371409834521664, 23.235058632546433, 20.787069069180113, 16.75003611334517, 31.879539508891977, -1.0716398654205301, -2.2854086929946185, 21.073374504912042, 4.804794910890596, 26.95017715360537, 29.850675700796746, 28.712208737356235, 30.767540739425584, 27.952772445854144, 35.23764975723604, -6.738327506842452, 0.5570123299406031, -11.338261944641172, 27.056021281646387, 6.133320561686141, -11.65964258935696, 42.24699203272414, 32.62075358494489, 1.6931191596640107, 7.912281986963007, 29.275620896912606, 26.00043032025689, 32.91678661520649, 8.88319150319152, 35.95617286400657, -6.4793677568800145, 4.014313723612894, 30.84055316303359, 38.798734711735214, 24.356156192127298, 52.45751942871503, 48.72086715432149, 8.402700649488123, 19.137874731952543, 26.04718511452922, 0.9629511435870697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6392708819615224, "mean_inference_ms": 1.7053900312219117, "mean_action_processing_ms": 0.26283849970796536, "mean_env_wait_ms": 0.14856895943890067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036830902099609375, "StateBufferConnector_ms": 0.005605220794677734, "ViewRequirementAgentConnector_ms": 0.11388778686523438}, "num_episodes": 18, "episode_return_max": 50.58919329151828, "episode_return_min": -9.036167512920898, "episode_return_mean": 19.061093104399006, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.668498675035, "num_env_steps_trained_throughput_per_sec": 352.668498675035, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 11934.242, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11934.144, "sample_time_ms": 1349.193, "learn_time_ms": 10561.758, "learn_throughput": 378.725, "synch_weights_time_ms": 19.609}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "training_iteration": 59, "trial_id": "06536_00000", "date": "2024-08-11_16-45-32", "timestamp": 1723409132, "time_this_iter_s": 11.376668930053711, "time_total_s": 676.5071084499359, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331109ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 676.5071084499359, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 47.42941176470588, "ram_util_percent": 81.82941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.880547592913111, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.00263554751873, "policy_loss": -0.006110887963344188, "vf_loss": 2.008699626351396, "vf_explained_var": 0.9579443253576756, "kl": 0.0074900527345352205, "entropy": 0.6534695582464337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.854201312859853, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0495664602864987, "policy_loss": -0.001963097198309485, "vf_loss": 2.051529558688875, "vf_explained_var": 0.9625752950156177, "kl": 0.004061286243157621, "entropy": 0.40177468394160903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 50.58919329151828, "episode_reward_min": -9.036167512920898, "episode_reward_mean": 18.286317481139054, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58919329151824, "predator_policy": -17.998353083225226}, "policy_reward_max": {"prey_policy": 9.03616751292091, "predator_policy": 60.00486156637194}, "policy_reward_mean": {"prey_policy": -18.286317481139054, "predator_policy": 18.286317481139054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.487702957921307, -2.2075889702778975, 34.78760064444253, 14.361793450016613, 38.93137455955205, 21.815327604564125, 26.76788521465216, -9.036167512920898, 8.068542868198703, -4.013609871551805, 9.323210990688802, 13.270174349520879, 44.87337623007728, -7.870803983031285, 3.7918215032104783, 30.161088240346665, 20.720557437646004, 3.672787799720698, 19.97668905755181, 23.05236466755282, -4.823655041775236, 22.116795874904973, 40.727993715657156, 11.586207129730301, 37.32495583216953, 33.58389739887165, 23.784533098325245, 29.99184066534138, 17.126322606833, 29.337000914718715, 27.328276515640198, 16.780518324680052, -1.26256354892117, 18.349868591553996, 21.455387620768924, 8.531553879757107, 16.66029742824505, 43.93776476685754, 22.507876197250468, 31.681568910792535, 16.509207128867864, 4.9762561210431056, -3.690819840212387, 22.3238618090569, 12.341278893672392, 26.872401255400437, 27.186525074170774, 21.723604375867318, 16.736889903007274, 8.811703748187233, 37.744982616697406, 10.729090097357375, 25.574451864880505, 11.55812884618864, 37.829010817338016, 8.791173981163432, 45.85165608418123, 22.011063850863277, 24.314787811118585, -1.678524279207565, 12.939084707901314, 28.400426427201086, 29.739874738390938, 31.59521110154507, -3.0906575884509238, 7.8588796685025955, -2.763161013835412, 37.433872808834536, 4.802700573313505, 27.63802560858474, 20.899989059199026, 14.738402553563274, 17.427433443323245, 31.577445451931208, 50.58919329151828, 13.770287690720329, 13.50506812905813, 18.535708087493756, 19.93497715295847, 48.21328674577597, -2.5523015837838425, 47.991778889282976, 24.484434898570647, 41.46201504685505, 13.130866308829347, 22.76482271472363, 15.31537225993656, 5.8824340474343195, -8.263913142929976, -5.9980612415836525, 12.143643240399877, 15.97074378579478, 20.3458356441929, 26.043195764166406, 15.252041642868296, -1.7454583129140673, 9.566723414262292, 11.30943124289087, -1.8209552125855604, 12.425751791041176], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.487702957921307, 2.207588970277895, -34.7876006444425, -14.361793450016616, -38.931374559552026, -21.815327604564146, -26.767885214652186, 9.03616751292091, -8.068542868198712, 4.013609871551808, -9.3232109906888, -13.270174349520884, -44.87337623007739, 7.870803983031285, -3.791821503210496, -30.16108824034666, -20.72055743764599, -3.672787799720693, -19.976689057551802, -23.0523646675528, 4.823655041775236, -22.116795874904973, -40.72799371565728, -11.58620712973032, -37.3249558321696, -33.58389739887163, -23.784533098325223, -29.991840665341385, -17.12632260683298, -29.337000914718722, -27.328276515640248, -16.78051832468006, 1.2625635489211797, -18.349868591554014, -21.45538762076889, -8.531553879757102, -16.660297428245087, -43.93776476685746, -22.507876197250507, -31.68156891079256, -16.50920712886785, -4.9762561210431, 3.690819840212389, -22.323861809056922, -12.341278893672392, -26.872401255400472, -27.186525074170742, -21.723604375867303, -16.736889903007263, -8.811703748187236, -37.74498261669743, -10.72909009735737, -25.574451864880526, -11.558128846188623, -37.82901081733803, -8.791173981163425, -45.85165608418129, -22.011063850863295, -24.314787811118556, 1.6785242792075765, -12.93908470790132, -28.400426427201047, -29.739874738390927, -31.59521110154511, 3.09065758845092, -7.858879668502593, 2.7631610138354166, -37.433872808834494, -4.802700573313508, -27.638025608584744, -20.899989059199, -14.738402553563272, -17.427433443323242, -31.577445451931275, -50.58919329151824, -13.770287690720338, -13.505068129058149, -18.535708087493767, -19.934977152958496, -48.21328674577591, 2.552301583783864, -47.991778889282905, -24.484434898570647, -41.46201504685502, -13.130866308829383, -22.764822714723657, -15.31537225993653, -5.882434047434321, 8.263913142929974, 5.99806124158366, -12.14364324039985, -15.970743785794783, -20.345835644192928, -26.043195764166423, -15.2520416428683, 1.7454583129140575, -9.566723414262244, -11.309431242890863, 1.8209552125855568, -12.425751791041185], "policy_predator_policy_reward": [32.82233528965235, 2.153070626190271, -2.3660465278462963, -2.0491314127094915, 31.518178123654746, 38.0570231652303, 9.102808744794732, 19.62077815523849, 37.34072007547037, 40.522029043633694, 22.74249275264308, 20.888162456485205, 28.4685263726629, 25.067244056641446, -17.998353083225226, -0.07398194261659263, 13.021530737350938, 3.115554999046477, 2.397929362564472, -10.42514910566809, 26.08958949780329, -7.4431675164256985, 16.943122655638398, 9.597226043403385, 46.489867201207026, 43.25688525894772, -12.741459525536861, -3.000148440525715, 4.445559896773865, 3.1380831096471136, 37.22221969750488, 23.099956783188425, 0.9734332335210993, 40.467681641770916, 6.999572583020727, 0.34600301642067066, 27.434133439278217, 12.519244675825384, 24.857069975038932, 21.24765936006669, -6.3246114805106135, -3.3226986030398553, 8.535066727127148, 35.69852502268278, 38.80439891935307, 42.65158851196142, 23.857657020763888, -0.6852427613032566, 43.82293296795727, 30.82697869638182, 26.31660859532519, 40.85118620241806, 13.551245985660277, 34.017820210990166, 21.58863312220426, 38.39504820847853, 6.95564611219184, 27.296999101474114, 11.838505342192324, 46.835496487245116, 22.85850700919117, 31.798046022089295, 22.882537076313326, 10.67849957304678, 4.602610266591768, -7.127737364434121, 13.3854534736982, 23.31428370940983, 24.23787184901311, 18.672903392524674, 4.8910575466437045, 12.172050212870502, 8.106699770657022, 25.21389508583307, 27.870667967343003, 60.00486156637194, 7.005314034317031, 38.010438360184004, 16.384797169090053, 46.97834065249501, 13.745296118543592, 19.27311813919213, 5.997751606766132, 3.9547606353200937, 4.914860326549965, -12.296500006974748, 18.71629142073096, 25.93143219738291, 8.336368804513182, 16.346188982831602, 39.935939844542034, 13.808862666258886, 20.306742921431216, 34.0663072269103, 24.58212281884798, 18.865085932886625, 22.404231785599343, 11.069548020415182, 7.168916255078111, 10.454491241296354, 29.824116835726038, 45.66584839766883, 6.966488062542906, 14.491692132171833, 39.90715686322876, 11.241746866532278, 1.4056667141047523, 21.710590978272513, 29.347952001923595, 46.310069632752416, 1.5329135194167414, 16.04943444291009, 43.33190233384083, 48.371409834521664, 23.235058632546433, 20.787069069180113, 16.75003611334517, 31.879539508891977, -1.0716398654205301, -2.2854086929946185, 21.073374504912042, 4.804794910890596, 26.95017715360537, 29.850675700796746, 28.712208737356235, 30.767540739425584, 27.952772445854144, 35.23764975723604, -6.738327506842452, 0.5570123299406031, -11.338261944641172, 27.056021281646387, 6.133320561686141, -11.65964258935696, 42.24699203272414, 32.62075358494489, 1.6931191596640107, 7.912281986963007, 29.275620896912606, 26.00043032025689, 32.91678661520649, 8.88319150319152, 35.95617286400657, -6.4793677568800145, 4.014313723612894, 30.84055316303359, 38.798734711735214, 24.356156192127298, 52.45751942871503, 48.72086715432149, 8.402700649488123, 19.137874731952543, 26.04718511452922, 0.9629511435870697, 20.72444544123401, 16.34697073375349, -0.10993966706851799, 39.97989397298551, 59.96598002426669, 36.46059346728514, -12.507903557782925, 7.403300390215225, 51.192987902690554, 44.79056987587537, 23.27842074474759, 25.690449052393667, 47.984187802968854, 34.93984229074117, 24.445528675193682, 1.8162039424651049, 17.983442936911267, 27.546202492536008, 20.485061830440223, 10.145682689432846, -3.8394281759212934, 15.60429627078994, -12.964217253256734, -3.5636090326032193, -14.643134754382242, 2.6470122712149387, 23.463542939716753, 0.8237435410829939, 19.766935744141918, 12.174551827447651, 19.873616030277823, 20.818055258107997, 28.988316014189152, 23.098075514143666, 3.8964028739596626, 26.607680411776915, -7.4607800320077375, 3.9698634061796163, -2.7031671686466323, 21.83661399717109, 2.505468863123177, 20.113393622658545, -5.133817619186241, 1.4919071940151225, 16.766674477303482, 8.084829104778873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6387714993867656, "mean_inference_ms": 1.7034364169370004, "mean_action_processing_ms": 0.26291165465151334, "mean_env_wait_ms": 0.14850770898623858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009883880615234375, "StateBufferConnector_ms": 0.006053566932678223, "ViewRequirementAgentConnector_ms": 0.13418304920196533}, "num_episodes": 23, "episode_return_max": 50.58919329151828, "episode_return_min": -9.036167512920898, "episode_return_mean": 18.286317481139054, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.6138133063651, "num_env_steps_trained_throughput_per_sec": 317.6138133063651, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 11999.277, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11999.138, "sample_time_ms": 1306.382, "learn_time_ms": 10664.22, "learn_throughput": 375.086, "synch_weights_time_ms": 24.447}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 60, "trial_id": "06536_00000", "date": "2024-08-11_16-45-45", "timestamp": 1723409145, "time_this_iter_s": 12.674499034881592, "time_total_s": 689.1816074848175, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 689.1816074848175, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 53.394444444444446, "ram_util_percent": 82.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8542850485692424, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.456010481591026, "policy_loss": -0.008734601355536142, "vf_loss": 2.464679388081034, "vf_explained_var": 0.9446382421379288, "kl": 0.010511335484150305, "entropy": 0.6257958454390367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8891318569107662, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.507395740917751, "policy_loss": -0.0017336355544449319, "vf_loss": 2.5091293749355135, "vf_explained_var": 0.9507542485913272, "kl": 0.004981426411954529, "entropy": 0.4679171134870519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "env_runners": {"episode_reward_max": 50.58919329151828, "episode_reward_min": -8.263913142929976, "episode_reward_mean": 19.46878749995761, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58919329151824, "predator_policy": -14.643134754382242}, "policy_reward_max": {"prey_policy": 8.263913142929974, "predator_policy": 60.00486156637194}, "policy_reward_mean": {"prey_policy": -19.468787499957614, "predator_policy": 19.468787499957614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.97668905755181, 23.05236466755282, -4.823655041775236, 22.116795874904973, 40.727993715657156, 11.586207129730301, 37.32495583216953, 33.58389739887165, 23.784533098325245, 29.99184066534138, 17.126322606833, 29.337000914718715, 27.328276515640198, 16.780518324680052, -1.26256354892117, 18.349868591553996, 21.455387620768924, 8.531553879757107, 16.66029742824505, 43.93776476685754, 22.507876197250468, 31.681568910792535, 16.509207128867864, 4.9762561210431056, -3.690819840212387, 22.3238618090569, 12.341278893672392, 26.872401255400437, 27.186525074170774, 21.723604375867318, 16.736889903007274, 8.811703748187233, 37.744982616697406, 10.729090097357375, 25.574451864880505, 11.55812884618864, 37.829010817338016, 8.791173981163432, 45.85165608418123, 22.011063850863277, 24.314787811118585, -1.678524279207565, 12.939084707901314, 28.400426427201086, 29.739874738390938, 31.59521110154507, -3.0906575884509238, 7.8588796685025955, -2.763161013835412, 37.433872808834536, 4.802700573313505, 27.63802560858474, 20.899989059199026, 14.738402553563274, 17.427433443323245, 31.577445451931208, 50.58919329151828, 13.770287690720329, 13.50506812905813, 18.535708087493756, 19.93497715295847, 48.21328674577597, -2.5523015837838425, 47.991778889282976, 24.484434898570647, 41.46201504685505, 13.130866308829347, 22.76482271472363, 15.31537225993656, 5.8824340474343195, -8.263913142929976, -5.9980612415836525, 12.143643240399877, 15.97074378579478, 20.3458356441929, 26.043195764166406, 15.252041642868296, -1.7454583129140673, 9.566723414262292, 11.30943124289087, -1.8209552125855604, 12.425751791041176, 27.174228197235873, 26.685795369221157, 9.943154174418156, 32.34794550870108, 29.05136912826326, 31.870719152475875, 21.095281605245134, 4.613807752240754, 28.52775025169236, 22.262757631553974, 36.144829843282, 19.853125111396245, 31.320336176712605, 22.50953337957667, 25.922364252298248, -6.082576819149756, 1.194398824101647, 18.717255855367142], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.976689057551802, -23.0523646675528, 4.823655041775236, -22.116795874904973, -40.72799371565728, -11.58620712973032, -37.3249558321696, -33.58389739887163, -23.784533098325223, -29.991840665341385, -17.12632260683298, -29.337000914718722, -27.328276515640248, -16.78051832468006, 1.2625635489211797, -18.349868591554014, -21.45538762076889, -8.531553879757102, -16.660297428245087, -43.93776476685746, -22.507876197250507, -31.68156891079256, -16.50920712886785, -4.9762561210431, 3.690819840212389, -22.323861809056922, -12.341278893672392, -26.872401255400472, -27.186525074170742, -21.723604375867303, -16.736889903007263, -8.811703748187236, -37.74498261669743, -10.72909009735737, -25.574451864880526, -11.558128846188623, -37.82901081733803, -8.791173981163425, -45.85165608418129, -22.011063850863295, -24.314787811118556, 1.6785242792075765, -12.93908470790132, -28.400426427201047, -29.739874738390927, -31.59521110154511, 3.09065758845092, -7.858879668502593, 2.7631610138354166, -37.433872808834494, -4.802700573313508, -27.638025608584744, -20.899989059199, -14.738402553563272, -17.427433443323242, -31.577445451931275, -50.58919329151824, -13.770287690720338, -13.505068129058149, -18.535708087493767, -19.934977152958496, -48.21328674577591, 2.552301583783864, -47.991778889282905, -24.484434898570647, -41.46201504685502, -13.130866308829383, -22.764822714723657, -15.31537225993653, -5.882434047434321, 8.263913142929974, 5.99806124158366, -12.14364324039985, -15.970743785794783, -20.345835644192928, -26.043195764166423, -15.2520416428683, 1.7454583129140575, -9.566723414262244, -11.309431242890863, 1.8209552125855568, -12.425751791041185, -27.174228197235824, -26.685795369221157, -9.943154174418144, -32.3479455087011, -29.051369128263246, -31.870719152475893, -21.095281605245127, -4.613807752240754, -28.527750251692364, -22.262757631553942, -36.14482984328199, -19.853125111396228, -31.32033617671259, -22.509533379576673, -25.922364252298284, 6.082576819149754, -1.1943988241016381, -18.717255855367124], "policy_predator_policy_reward": [27.434133439278217, 12.519244675825384, 24.857069975038932, 21.24765936006669, -6.3246114805106135, -3.3226986030398553, 8.535066727127148, 35.69852502268278, 38.80439891935307, 42.65158851196142, 23.857657020763888, -0.6852427613032566, 43.82293296795727, 30.82697869638182, 26.31660859532519, 40.85118620241806, 13.551245985660277, 34.017820210990166, 21.58863312220426, 38.39504820847853, 6.95564611219184, 27.296999101474114, 11.838505342192324, 46.835496487245116, 22.85850700919117, 31.798046022089295, 22.882537076313326, 10.67849957304678, 4.602610266591768, -7.127737364434121, 13.3854534736982, 23.31428370940983, 24.23787184901311, 18.672903392524674, 4.8910575466437045, 12.172050212870502, 8.106699770657022, 25.21389508583307, 27.870667967343003, 60.00486156637194, 7.005314034317031, 38.010438360184004, 16.384797169090053, 46.97834065249501, 13.745296118543592, 19.27311813919213, 5.997751606766132, 3.9547606353200937, 4.914860326549965, -12.296500006974748, 18.71629142073096, 25.93143219738291, 8.336368804513182, 16.346188982831602, 39.935939844542034, 13.808862666258886, 20.306742921431216, 34.0663072269103, 24.58212281884798, 18.865085932886625, 22.404231785599343, 11.069548020415182, 7.168916255078111, 10.454491241296354, 29.824116835726038, 45.66584839766883, 6.966488062542906, 14.491692132171833, 39.90715686322876, 11.241746866532278, 1.4056667141047523, 21.710590978272513, 29.347952001923595, 46.310069632752416, 1.5329135194167414, 16.04943444291009, 43.33190233384083, 48.371409834521664, 23.235058632546433, 20.787069069180113, 16.75003611334517, 31.879539508891977, -1.0716398654205301, -2.2854086929946185, 21.073374504912042, 4.804794910890596, 26.95017715360537, 29.850675700796746, 28.712208737356235, 30.767540739425584, 27.952772445854144, 35.23764975723604, -6.738327506842452, 0.5570123299406031, -11.338261944641172, 27.056021281646387, 6.133320561686141, -11.65964258935696, 42.24699203272414, 32.62075358494489, 1.6931191596640107, 7.912281986963007, 29.275620896912606, 26.00043032025689, 32.91678661520649, 8.88319150319152, 35.95617286400657, -6.4793677568800145, 4.014313723612894, 30.84055316303359, 38.798734711735214, 24.356156192127298, 52.45751942871503, 48.72086715432149, 8.402700649488123, 19.137874731952543, 26.04718511452922, 0.9629511435870697, 20.72444544123401, 16.34697073375349, -0.10993966706851799, 39.97989397298551, 59.96598002426669, 36.46059346728514, -12.507903557782925, 7.403300390215225, 51.192987902690554, 44.79056987587537, 23.27842074474759, 25.690449052393667, 47.984187802968854, 34.93984229074117, 24.445528675193682, 1.8162039424651049, 17.983442936911267, 27.546202492536008, 20.485061830440223, 10.145682689432846, -3.8394281759212934, 15.60429627078994, -12.964217253256734, -3.5636090326032193, -14.643134754382242, 2.6470122712149387, 23.463542939716753, 0.8237435410829939, 19.766935744141918, 12.174551827447651, 19.873616030277823, 20.818055258107997, 28.988316014189152, 23.098075514143666, 3.8964028739596626, 26.607680411776915, -7.4607800320077375, 3.9698634061796163, -2.7031671686466323, 21.83661399717109, 2.505468863123177, 20.113393622658545, -5.133817619186241, 1.4919071940151225, 16.766674477303482, 8.084829104778873, 17.676200996030975, 36.67225539844071, 37.08157015111652, 16.290020587325767, 12.559729979465157, 7.326578369371143, 34.40894814885947, 30.286942868542766, 26.95378385710568, 31.14895439942083, 23.159762756577237, 40.581675548374555, 16.236222538568214, 25.95434067192206, 15.976544057543652, -6.748928553062157, 35.012175386132746, 22.043325117252003, 23.345256131389018, 21.18025913171892, 44.0651925751103, 28.224467111453702, 22.215467507188706, 17.490782715603782, 29.962182381116843, 32.6784899723084, 28.90549713910086, 16.113569620052502, 26.64467459555379, 25.200053909042722, 2.400497961788183, -14.565651600087708, 0.6608808584184871, 1.727916789784807, 30.08149006864322, 7.353021642091033]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6372650183206118, "mean_inference_ms": 1.700264437638817, "mean_action_processing_ms": 0.26265436340902704, "mean_env_wait_ms": 0.14828586411189915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009766697883605957, "StateBufferConnector_ms": 0.0032619237899780273, "ViewRequirementAgentConnector_ms": 0.1292034387588501}, "num_episodes": 18, "episode_return_max": 50.58919329151828, "episode_return_min": -8.263913142929976, "episode_return_mean": 19.46878749995761, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.4005048077839, "num_env_steps_trained_throughput_per_sec": 267.4005048077839, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 12181.359, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12181.213, "sample_time_ms": 1235.674, "learn_time_ms": 10917.424, "learn_throughput": 366.387, "synch_weights_time_ms": 24.01}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "training_iteration": 61, "trial_id": "06536_00000", "date": "2024-08-11_16-46-00", "timestamp": 1723409160, "time_this_iter_s": 14.994592905044556, "time_total_s": 704.1762003898621, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33171f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 704.1762003898621, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.39047619047618, "ram_util_percent": 82.71904761904761}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.027185964335998, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.401764176537593, "policy_loss": -0.008318374821101315, "vf_loss": 2.4100216791033744, "vf_explained_var": 0.9487624722843369, "kl": 0.009739029692821078, "entropy": 0.6323216548810403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7651881820310362, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4696339952882638, "policy_loss": -0.0022821632123961257, "vf_loss": 2.471916155651133, "vf_explained_var": 0.9535025825891545, "kl": 0.0042960386763517535, "entropy": 0.35760218333945704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 50.58919329151828, "episode_reward_min": -12.473354224103337, "episode_reward_mean": 18.50010012530974, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58919329151824, "predator_policy": -14.643134754382242}, "policy_reward_max": {"prey_policy": 12.473354224103332, "predator_policy": 60.00486156637194}, "policy_reward_mean": {"prey_policy": -18.50010012530974, "predator_policy": 18.50010012530974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.66029742824505, 43.93776476685754, 22.507876197250468, 31.681568910792535, 16.509207128867864, 4.9762561210431056, -3.690819840212387, 22.3238618090569, 12.341278893672392, 26.872401255400437, 27.186525074170774, 21.723604375867318, 16.736889903007274, 8.811703748187233, 37.744982616697406, 10.729090097357375, 25.574451864880505, 11.55812884618864, 37.829010817338016, 8.791173981163432, 45.85165608418123, 22.011063850863277, 24.314787811118585, -1.678524279207565, 12.939084707901314, 28.400426427201086, 29.739874738390938, 31.59521110154507, -3.0906575884509238, 7.8588796685025955, -2.763161013835412, 37.433872808834536, 4.802700573313505, 27.63802560858474, 20.899989059199026, 14.738402553563274, 17.427433443323245, 31.577445451931208, 50.58919329151828, 13.770287690720329, 13.50506812905813, 18.535708087493756, 19.93497715295847, 48.21328674577597, -2.5523015837838425, 47.991778889282976, 24.484434898570647, 41.46201504685505, 13.130866308829347, 22.76482271472363, 15.31537225993656, 5.8824340474343195, -8.263913142929976, -5.9980612415836525, 12.143643240399877, 15.97074378579478, 20.3458356441929, 26.043195764166406, 15.252041642868296, -1.7454583129140673, 9.566723414262292, 11.30943124289087, -1.8209552125855604, 12.425751791041176, 27.174228197235873, 26.685795369221157, 9.943154174418156, 32.34794550870108, 29.05136912826326, 31.870719152475875, 21.095281605245134, 4.613807752240754, 28.52775025169236, 22.262757631553974, 36.144829843282, 19.853125111396245, 31.320336176712605, 22.50953337957667, 25.922364252298248, -6.082576819149756, 1.194398824101647, 18.717255855367142, 12.845675356744136, 23.260777040961667, 5.875614222521741, 30.20095393253886, 7.525646878152111, 16.37589883404327, 26.72132236123203, -12.473354224103337, 39.391816985421066, 7.720569542036163, -9.711577126488574, 27.311633704516147, 37.41006968918726, -5.412327981576825, 13.572734559151645, 6.101755670113029, 30.33365090592485, 21.048389488197614], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.660297428245087, -43.93776476685746, -22.507876197250507, -31.68156891079256, -16.50920712886785, -4.9762561210431, 3.690819840212389, -22.323861809056922, -12.341278893672392, -26.872401255400472, -27.186525074170742, -21.723604375867303, -16.736889903007263, -8.811703748187236, -37.74498261669743, -10.72909009735737, -25.574451864880526, -11.558128846188623, -37.82901081733803, -8.791173981163425, -45.85165608418129, -22.011063850863295, -24.314787811118556, 1.6785242792075765, -12.93908470790132, -28.400426427201047, -29.739874738390927, -31.59521110154511, 3.09065758845092, -7.858879668502593, 2.7631610138354166, -37.433872808834494, -4.802700573313508, -27.638025608584744, -20.899989059199, -14.738402553563272, -17.427433443323242, -31.577445451931275, -50.58919329151824, -13.770287690720338, -13.505068129058149, -18.535708087493767, -19.934977152958496, -48.21328674577591, 2.552301583783864, -47.991778889282905, -24.484434898570647, -41.46201504685502, -13.130866308829383, -22.764822714723657, -15.31537225993653, -5.882434047434321, 8.263913142929974, 5.99806124158366, -12.14364324039985, -15.970743785794783, -20.345835644192928, -26.043195764166423, -15.2520416428683, 1.7454583129140575, -9.566723414262244, -11.309431242890863, 1.8209552125855568, -12.425751791041185, -27.174228197235824, -26.685795369221157, -9.943154174418144, -32.3479455087011, -29.051369128263246, -31.870719152475893, -21.095281605245127, -4.613807752240754, -28.527750251692364, -22.262757631553942, -36.14482984328199, -19.853125111396228, -31.32033617671259, -22.509533379576673, -25.922364252298284, 6.082576819149754, -1.1943988241016381, -18.717255855367124, -12.845675356744124, -23.260777040961642, -5.87561422252174, -30.200953932538855, -7.525646878152105, -16.37589883404327, -26.721322361231994, 12.473354224103332, -39.391816985421144, -7.720569542036163, 9.711577126488573, -27.311633704516165, -37.41006968918731, 5.412327981576833, -13.572734559151678, -6.101755670113024, -30.333650905924834, -21.048389488197607], "policy_predator_policy_reward": [8.106699770657022, 25.21389508583307, 27.870667967343003, 60.00486156637194, 7.005314034317031, 38.010438360184004, 16.384797169090053, 46.97834065249501, 13.745296118543592, 19.27311813919213, 5.997751606766132, 3.9547606353200937, 4.914860326549965, -12.296500006974748, 18.71629142073096, 25.93143219738291, 8.336368804513182, 16.346188982831602, 39.935939844542034, 13.808862666258886, 20.306742921431216, 34.0663072269103, 24.58212281884798, 18.865085932886625, 22.404231785599343, 11.069548020415182, 7.168916255078111, 10.454491241296354, 29.824116835726038, 45.66584839766883, 6.966488062542906, 14.491692132171833, 39.90715686322876, 11.241746866532278, 1.4056667141047523, 21.710590978272513, 29.347952001923595, 46.310069632752416, 1.5329135194167414, 16.04943444291009, 43.33190233384083, 48.371409834521664, 23.235058632546433, 20.787069069180113, 16.75003611334517, 31.879539508891977, -1.0716398654205301, -2.2854086929946185, 21.073374504912042, 4.804794910890596, 26.95017715360537, 29.850675700796746, 28.712208737356235, 30.767540739425584, 27.952772445854144, 35.23764975723604, -6.738327506842452, 0.5570123299406031, -11.338261944641172, 27.056021281646387, 6.133320561686141, -11.65964258935696, 42.24699203272414, 32.62075358494489, 1.6931191596640107, 7.912281986963007, 29.275620896912606, 26.00043032025689, 32.91678661520649, 8.88319150319152, 35.95617286400657, -6.4793677568800145, 4.014313723612894, 30.84055316303359, 38.798734711735214, 24.356156192127298, 52.45751942871503, 48.72086715432149, 8.402700649488123, 19.137874731952543, 26.04718511452922, 0.9629511435870697, 20.72444544123401, 16.34697073375349, -0.10993966706851799, 39.97989397298551, 59.96598002426669, 36.46059346728514, -12.507903557782925, 7.403300390215225, 51.192987902690554, 44.79056987587537, 23.27842074474759, 25.690449052393667, 47.984187802968854, 34.93984229074117, 24.445528675193682, 1.8162039424651049, 17.983442936911267, 27.546202492536008, 20.485061830440223, 10.145682689432846, -3.8394281759212934, 15.60429627078994, -12.964217253256734, -3.5636090326032193, -14.643134754382242, 2.6470122712149387, 23.463542939716753, 0.8237435410829939, 19.766935744141918, 12.174551827447651, 19.873616030277823, 20.818055258107997, 28.988316014189152, 23.098075514143666, 3.8964028739596626, 26.607680411776915, -7.4607800320077375, 3.9698634061796163, -2.7031671686466323, 21.83661399717109, 2.505468863123177, 20.113393622658545, -5.133817619186241, 1.4919071940151225, 16.766674477303482, 8.084829104778873, 17.676200996030975, 36.67225539844071, 37.08157015111652, 16.290020587325767, 12.559729979465157, 7.326578369371143, 34.40894814885947, 30.286942868542766, 26.95378385710568, 31.14895439942083, 23.159762756577237, 40.581675548374555, 16.236222538568214, 25.95434067192206, 15.976544057543652, -6.748928553062157, 35.012175386132746, 22.043325117252003, 23.345256131389018, 21.18025913171892, 44.0651925751103, 28.224467111453702, 22.215467507188706, 17.490782715603782, 29.962182381116843, 32.6784899723084, 28.90549713910086, 16.113569620052502, 26.64467459555379, 25.200053909042722, 2.400497961788183, -14.565651600087708, 0.6608808584184871, 1.727916789784807, 30.08149006864322, 7.353021642091033, 13.174235447072219, 12.517115266416035, 27.790468888987125, 18.731085192936177, 12.111411651903966, -0.36018320686048777, 31.918154466735544, 28.48375339834216, -7.5657087093848485, 22.617002465689062, 29.065783848535325, 3.6860138195512135, 41.40926064474813, 12.033384077715894, -13.35506889227235, -11.591639555934314, 29.801863080930573, 48.98177088991169, 2.6726988619853635, 12.768440222086957, -9.993413701116921, -9.429740551860238, 30.796918892274984, 23.826348516757353, 40.852671207263406, 33.96746817111117, -9.48680139463412, -1.337854568519548, 7.528663588152815, 19.616805530150504, -9.368335467258143, 21.571846807484185, 29.547981340250416, 31.119320471599288, 23.701713313553824, 18.395065662841397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6369883293348593, "mean_inference_ms": 1.7015536412840435, "mean_action_processing_ms": 0.26309629049232197, "mean_env_wait_ms": 0.1483495764417255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010069727897644043, "StateBufferConnector_ms": 0.0033063888549804688, "ViewRequirementAgentConnector_ms": 0.13248014450073242}, "num_episodes": 18, "episode_return_max": 50.58919329151828, "episode_return_min": -12.473354224103337, "episode_return_mean": 18.50010012530974, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.4283273486109, "num_env_steps_trained_throughput_per_sec": 279.4283273486109, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 12348.95, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12348.828, "sample_time_ms": 1309.177, "learn_time_ms": 11014.462, "learn_throughput": 363.159, "synch_weights_time_ms": 21.191}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 62, "trial_id": "06536_00000", "date": "2024-08-11_16-46-14", "timestamp": 1723409174, "time_this_iter_s": 14.821855068206787, "time_total_s": 718.9980554580688, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33175d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 718.9980554580688, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 59.64761904761905, "ram_util_percent": 82.26190476190474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9739467908938724, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4675607002029816, "policy_loss": -0.009294093939630935, "vf_loss": 2.4767907071858644, "vf_explained_var": 0.9460337679833174, "kl": 0.010253397073917647, "entropy": 0.6046819265931844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.975913622707286, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5204907552275078, "policy_loss": -0.0008162479657955744, "vf_loss": 2.521307000659761, "vf_explained_var": 0.9579363551404741, "kl": 0.003838372756076825, "entropy": 0.3584134171248744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "env_runners": {"episode_reward_max": 50.58919329151828, "episode_reward_min": -12.473354224103337, "episode_reward_mean": 18.13028929111587, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58919329151824, "predator_policy": -15.642297400994146}, "policy_reward_max": {"prey_policy": 12.473354224103332, "predator_policy": 63.08737610233001}, "policy_reward_mean": {"prey_policy": -18.13028929111587, "predator_policy": 18.130289291115872}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.314787811118585, -1.678524279207565, 12.939084707901314, 28.400426427201086, 29.739874738390938, 31.59521110154507, -3.0906575884509238, 7.8588796685025955, -2.763161013835412, 37.433872808834536, 4.802700573313505, 27.63802560858474, 20.899989059199026, 14.738402553563274, 17.427433443323245, 31.577445451931208, 50.58919329151828, 13.770287690720329, 13.50506812905813, 18.535708087493756, 19.93497715295847, 48.21328674577597, -2.5523015837838425, 47.991778889282976, 24.484434898570647, 41.46201504685505, 13.130866308829347, 22.76482271472363, 15.31537225993656, 5.8824340474343195, -8.263913142929976, -5.9980612415836525, 12.143643240399877, 15.97074378579478, 20.3458356441929, 26.043195764166406, 15.252041642868296, -1.7454583129140673, 9.566723414262292, 11.30943124289087, -1.8209552125855604, 12.425751791041176, 27.174228197235873, 26.685795369221157, 9.943154174418156, 32.34794550870108, 29.05136912826326, 31.870719152475875, 21.095281605245134, 4.613807752240754, 28.52775025169236, 22.262757631553974, 36.144829843282, 19.853125111396245, 31.320336176712605, 22.50953337957667, 25.922364252298248, -6.082576819149756, 1.194398824101647, 18.717255855367142, 12.845675356744136, 23.260777040961667, 5.875614222521741, 30.20095393253886, 7.525646878152111, 16.37589883404327, 26.72132236123203, -12.473354224103337, 39.391816985421066, 7.720569542036163, -9.711577126488574, 27.311633704516147, 37.41006968918726, -5.412327981576825, 13.572734559151645, 6.101755670113029, 30.33365090592485, 21.048389488197614, 15.999810344158217, 5.708177984092348, 20.199550517116734, 14.814388124695094, -1.488122727272433, 27.965838932783598, 18.285664388338656, 30.525452532615468, 21.821808478132382, 8.811562753349648, 2.997081072652704, 16.61668665301024, 18.86955608718387, 38.213289322259165, 40.376121355236755, 27.93610810826599, 22.335614902057586, 8.292802841232067, 19.547325814891515, 38.40175866318804, 30.034969470303356, 5.421444893198531], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.314787811118556, 1.6785242792075765, -12.93908470790132, -28.400426427201047, -29.739874738390927, -31.59521110154511, 3.09065758845092, -7.858879668502593, 2.7631610138354166, -37.433872808834494, -4.802700573313508, -27.638025608584744, -20.899989059199, -14.738402553563272, -17.427433443323242, -31.577445451931275, -50.58919329151824, -13.770287690720338, -13.505068129058149, -18.535708087493767, -19.934977152958496, -48.21328674577591, 2.552301583783864, -47.991778889282905, -24.484434898570647, -41.46201504685502, -13.130866308829383, -22.764822714723657, -15.31537225993653, -5.882434047434321, 8.263913142929974, 5.99806124158366, -12.14364324039985, -15.970743785794783, -20.345835644192928, -26.043195764166423, -15.2520416428683, 1.7454583129140575, -9.566723414262244, -11.309431242890863, 1.8209552125855568, -12.425751791041185, -27.174228197235824, -26.685795369221157, -9.943154174418144, -32.3479455087011, -29.051369128263246, -31.870719152475893, -21.095281605245127, -4.613807752240754, -28.527750251692364, -22.262757631553942, -36.14482984328199, -19.853125111396228, -31.32033617671259, -22.509533379576673, -25.922364252298284, 6.082576819149754, -1.1943988241016381, -18.717255855367124, -12.845675356744124, -23.260777040961642, -5.87561422252174, -30.200953932538855, -7.525646878152105, -16.37589883404327, -26.721322361231994, 12.473354224103332, -39.391816985421144, -7.720569542036163, 9.711577126488573, -27.311633704516165, -37.41006968918731, 5.412327981576833, -13.572734559151678, -6.101755670113024, -30.333650905924834, -21.048389488197607, -15.999810344158242, -5.7081779840923605, -20.199550517116748, -14.814388124695125, 1.4881227272724598, -27.965838932783672, -18.28566438833869, -30.52545253261544, -21.821808478132397, -8.811562753349644, -2.997081072652695, -16.61668665301025, -18.8695560871839, -38.21328932225914, -40.37612135523674, -27.936108108265945, -22.33561490205758, -8.292802841232069, -19.547325814891508, -38.401758663188076, -30.034969470303384, -5.42144489319853], "policy_predator_policy_reward": [16.75003611334517, 31.879539508891977, -1.0716398654205301, -2.2854086929946185, 21.073374504912042, 4.804794910890596, 26.95017715360537, 29.850675700796746, 28.712208737356235, 30.767540739425584, 27.952772445854144, 35.23764975723604, -6.738327506842452, 0.5570123299406031, -11.338261944641172, 27.056021281646387, 6.133320561686141, -11.65964258935696, 42.24699203272414, 32.62075358494489, 1.6931191596640107, 7.912281986963007, 29.275620896912606, 26.00043032025689, 32.91678661520649, 8.88319150319152, 35.95617286400657, -6.4793677568800145, 4.014313723612894, 30.84055316303359, 38.798734711735214, 24.356156192127298, 52.45751942871503, 48.72086715432149, 8.402700649488123, 19.137874731952543, 26.04718511452922, 0.9629511435870697, 20.72444544123401, 16.34697073375349, -0.10993966706851799, 39.97989397298551, 59.96598002426669, 36.46059346728514, -12.507903557782925, 7.403300390215225, 51.192987902690554, 44.79056987587537, 23.27842074474759, 25.690449052393667, 47.984187802968854, 34.93984229074117, 24.445528675193682, 1.8162039424651049, 17.983442936911267, 27.546202492536008, 20.485061830440223, 10.145682689432846, -3.8394281759212934, 15.60429627078994, -12.964217253256734, -3.5636090326032193, -14.643134754382242, 2.6470122712149387, 23.463542939716753, 0.8237435410829939, 19.766935744141918, 12.174551827447651, 19.873616030277823, 20.818055258107997, 28.988316014189152, 23.098075514143666, 3.8964028739596626, 26.607680411776915, -7.4607800320077375, 3.9698634061796163, -2.7031671686466323, 21.83661399717109, 2.505468863123177, 20.113393622658545, -5.133817619186241, 1.4919071940151225, 16.766674477303482, 8.084829104778873, 17.676200996030975, 36.67225539844071, 37.08157015111652, 16.290020587325767, 12.559729979465157, 7.326578369371143, 34.40894814885947, 30.286942868542766, 26.95378385710568, 31.14895439942083, 23.159762756577237, 40.581675548374555, 16.236222538568214, 25.95434067192206, 15.976544057543652, -6.748928553062157, 35.012175386132746, 22.043325117252003, 23.345256131389018, 21.18025913171892, 44.0651925751103, 28.224467111453702, 22.215467507188706, 17.490782715603782, 29.962182381116843, 32.6784899723084, 28.90549713910086, 16.113569620052502, 26.64467459555379, 25.200053909042722, 2.400497961788183, -14.565651600087708, 0.6608808584184871, 1.727916789784807, 30.08149006864322, 7.353021642091033, 13.174235447072219, 12.517115266416035, 27.790468888987125, 18.731085192936177, 12.111411651903966, -0.36018320686048777, 31.918154466735544, 28.48375339834216, -7.5657087093848485, 22.617002465689062, 29.065783848535325, 3.6860138195512135, 41.40926064474813, 12.033384077715894, -13.35506889227235, -11.591639555934314, 29.801863080930573, 48.98177088991169, 2.6726988619853635, 12.768440222086957, -9.993413701116921, -9.429740551860238, 30.796918892274984, 23.826348516757353, 40.852671207263406, 33.96746817111117, -9.48680139463412, -1.337854568519548, 7.528663588152815, 19.616805530150504, -9.368335467258143, 21.571846807484185, 29.547981340250416, 31.119320471599288, 23.701713313553824, 18.395065662841397, 12.334058120712708, 19.66556256760377, 6.93383148153405, 4.482524486650668, 28.57208482284117, 11.82701621139232, 5.212787597303539, 24.415988652086725, -1.996428380058994, -0.979817074485906, 19.08443433691933, 36.84724352864798, 19.35737193880388, 17.213956837873464, 27.208068405809307, 33.842836659421614, 12.46659720184875, 31.177019754416015, 0.08247090461202333, 17.540654602087265, -15.642297400994146, 21.63645954629954, 12.554210667275354, 20.679162638745147, 23.26716010793713, 14.471952066430665, 13.339202542188291, 63.08737610233001, 39.40742430905251, 41.34481840142098, 14.69424487643549, 41.17797134009646, 19.794308119221036, 24.876921684894132, -0.49204297760779525, 17.077648660071926, 10.873372840913234, 28.221278788869796, 37.84909878935904, 38.95441853701708, 25.4186455755181, 34.65129336508862, 1.732565854240212, 9.110323932156835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6393936964696328, "mean_inference_ms": 1.709220066584864, "mean_action_processing_ms": 0.26411515615845593, "mean_env_wait_ms": 0.14865087109279407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03152346611022949, "StateBufferConnector_ms": 0.00533449649810791, "ViewRequirementAgentConnector_ms": 0.2314445972442627}, "num_episodes": 22, "episode_return_max": 50.58919329151828, "episode_return_min": -12.473354224103337, "episode_return_mean": 18.13028929111587, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.7460960460638564, "num_env_steps_trained_throughput_per_sec": 3.7460960460638564, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 118008.234, "restore_workers_time_ms": 0.108, "training_step_time_ms": 118007.857, "sample_time_ms": 1525.137, "learn_time_ms": 116451.486, "learn_throughput": 34.349, "synch_weights_time_ms": 26.678}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "training_iteration": 63, "trial_id": "06536_00000", "date": "2024-08-11_17-04-03", "timestamp": 1723410243, "time_this_iter_s": 1067.8609471321106, "time_total_s": 1786.8590025901794, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1786.8590025901794, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 83.20357142857142, "ram_util_percent": 83.85714285714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4588738179455203, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.640974245282511, "policy_loss": -0.008516546127551313, "vf_loss": 1.6494486841683587, "vf_explained_var": 0.9608075325066845, "kl": 0.0067364721124256914, "entropy": 0.5829888669153055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6700136045930245, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.925600810025735, "policy_loss": -0.0018942239404798895, "vf_loss": 1.9274950389508847, "vf_explained_var": 0.9682183775321517, "kl": 0.004341112729725044, "entropy": 0.3825104272397107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 49.85956070317718, "episode_reward_min": -12.473354224103337, "episode_reward_mean": 17.710627815559903, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.85956070317724, "predator_policy": -15.642297400994146}, "policy_reward_max": {"prey_policy": 12.473354224103332, "predator_policy": 63.08737610233001}, "policy_reward_mean": {"prey_policy": -17.7106278155599, "predator_policy": 17.7106278155599}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.991778889282976, 24.484434898570647, 41.46201504685505, 13.130866308829347, 22.76482271472363, 15.31537225993656, 5.8824340474343195, -8.263913142929976, -5.9980612415836525, 12.143643240399877, 15.97074378579478, 20.3458356441929, 26.043195764166406, 15.252041642868296, -1.7454583129140673, 9.566723414262292, 11.30943124289087, -1.8209552125855604, 12.425751791041176, 27.174228197235873, 26.685795369221157, 9.943154174418156, 32.34794550870108, 29.05136912826326, 31.870719152475875, 21.095281605245134, 4.613807752240754, 28.52775025169236, 22.262757631553974, 36.144829843282, 19.853125111396245, 31.320336176712605, 22.50953337957667, 25.922364252298248, -6.082576819149756, 1.194398824101647, 18.717255855367142, 12.845675356744136, 23.260777040961667, 5.875614222521741, 30.20095393253886, 7.525646878152111, 16.37589883404327, 26.72132236123203, -12.473354224103337, 39.391816985421066, 7.720569542036163, -9.711577126488574, 27.311633704516147, 37.41006968918726, -5.412327981576825, 13.572734559151645, 6.101755670113029, 30.33365090592485, 21.048389488197614, 15.999810344158217, 5.708177984092348, 20.199550517116734, 14.814388124695094, -1.488122727272433, 27.965838932783598, 18.285664388338656, 30.525452532615468, 21.821808478132382, 8.811562753349648, 2.997081072652704, 16.61668665301024, 18.86955608718387, 38.213289322259165, 40.376121355236755, 27.93610810826599, 22.335614902057586, 8.292802841232067, 19.547325814891515, 38.40175866318804, 30.034969470303356, 5.421444893198531, 1.0314534440662246, 23.8640547491781, 11.382674184665262, 5.727702289411452, 22.321340698538428, 31.15718272097597, 49.85956070317718, 31.906393292460614, 14.090809181113501, 14.854630425501885, 28.352871456058537, 19.99738664616757, 15.306528235011704, 3.989504268597285, 7.127666435374458, 25.269793748881263, 1.9462119457017142, 15.934925820669186, 15.679975698867485, 25.084770540736898, 7.676910808978354, 25.08690012272508, 4.214615613201097], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-47.991778889282905, -24.484434898570647, -41.46201504685502, -13.130866308829383, -22.764822714723657, -15.31537225993653, -5.882434047434321, 8.263913142929974, 5.99806124158366, -12.14364324039985, -15.970743785794783, -20.345835644192928, -26.043195764166423, -15.2520416428683, 1.7454583129140575, -9.566723414262244, -11.309431242890863, 1.8209552125855568, -12.425751791041185, -27.174228197235824, -26.685795369221157, -9.943154174418144, -32.3479455087011, -29.051369128263246, -31.870719152475893, -21.095281605245127, -4.613807752240754, -28.527750251692364, -22.262757631553942, -36.14482984328199, -19.853125111396228, -31.32033617671259, -22.509533379576673, -25.922364252298284, 6.082576819149754, -1.1943988241016381, -18.717255855367124, -12.845675356744124, -23.260777040961642, -5.87561422252174, -30.200953932538855, -7.525646878152105, -16.37589883404327, -26.721322361231994, 12.473354224103332, -39.391816985421144, -7.720569542036163, 9.711577126488573, -27.311633704516165, -37.41006968918731, 5.412327981576833, -13.572734559151678, -6.101755670113024, -30.333650905924834, -21.048389488197607, -15.999810344158242, -5.7081779840923605, -20.199550517116748, -14.814388124695125, 1.4881227272724598, -27.965838932783672, -18.28566438833869, -30.52545253261544, -21.821808478132397, -8.811562753349644, -2.997081072652695, -16.61668665301025, -18.8695560871839, -38.21328932225914, -40.37612135523674, -27.936108108265945, -22.33561490205758, -8.292802841232069, -19.547325814891508, -38.401758663188076, -30.034969470303384, -5.42144489319853, -1.0314534440662069, -23.864054749178116, -11.3826741846653, -5.727702289411495, -22.32134069853845, -31.157182720975968, -49.85956070317724, -31.9063932924606, -14.090809181113507, -14.854630425501888, -28.3528714560585, -19.997386646167566, -15.306528235011701, -3.9895042685972903, -7.127666435374466, -25.26979374888123, -1.946211945701723, -15.934925820669205, -15.679975698867475, -25.084770540736898, -7.676910808978364, -25.086900122725055, -4.214615613201131], "policy_predator_policy_reward": [51.192987902690554, 44.79056987587537, 23.27842074474759, 25.690449052393667, 47.984187802968854, 34.93984229074117, 24.445528675193682, 1.8162039424651049, 17.983442936911267, 27.546202492536008, 20.485061830440223, 10.145682689432846, -3.8394281759212934, 15.60429627078994, -12.964217253256734, -3.5636090326032193, -14.643134754382242, 2.6470122712149387, 23.463542939716753, 0.8237435410829939, 19.766935744141918, 12.174551827447651, 19.873616030277823, 20.818055258107997, 28.988316014189152, 23.098075514143666, 3.8964028739596626, 26.607680411776915, -7.4607800320077375, 3.9698634061796163, -2.7031671686466323, 21.83661399717109, 2.505468863123177, 20.113393622658545, -5.133817619186241, 1.4919071940151225, 16.766674477303482, 8.084829104778873, 17.676200996030975, 36.67225539844071, 37.08157015111652, 16.290020587325767, 12.559729979465157, 7.326578369371143, 34.40894814885947, 30.286942868542766, 26.95378385710568, 31.14895439942083, 23.159762756577237, 40.581675548374555, 16.236222538568214, 25.95434067192206, 15.976544057543652, -6.748928553062157, 35.012175386132746, 22.043325117252003, 23.345256131389018, 21.18025913171892, 44.0651925751103, 28.224467111453702, 22.215467507188706, 17.490782715603782, 29.962182381116843, 32.6784899723084, 28.90549713910086, 16.113569620052502, 26.64467459555379, 25.200053909042722, 2.400497961788183, -14.565651600087708, 0.6608808584184871, 1.727916789784807, 30.08149006864322, 7.353021642091033, 13.174235447072219, 12.517115266416035, 27.790468888987125, 18.731085192936177, 12.111411651903966, -0.36018320686048777, 31.918154466735544, 28.48375339834216, -7.5657087093848485, 22.617002465689062, 29.065783848535325, 3.6860138195512135, 41.40926064474813, 12.033384077715894, -13.35506889227235, -11.591639555934314, 29.801863080930573, 48.98177088991169, 2.6726988619853635, 12.768440222086957, -9.993413701116921, -9.429740551860238, 30.796918892274984, 23.826348516757353, 40.852671207263406, 33.96746817111117, -9.48680139463412, -1.337854568519548, 7.528663588152815, 19.616805530150504, -9.368335467258143, 21.571846807484185, 29.547981340250416, 31.119320471599288, 23.701713313553824, 18.395065662841397, 12.334058120712708, 19.66556256760377, 6.93383148153405, 4.482524486650668, 28.57208482284117, 11.82701621139232, 5.212787597303539, 24.415988652086725, -1.996428380058994, -0.979817074485906, 19.08443433691933, 36.84724352864798, 19.35737193880388, 17.213956837873464, 27.208068405809307, 33.842836659421614, 12.46659720184875, 31.177019754416015, 0.08247090461202333, 17.540654602087265, -15.642297400994146, 21.63645954629954, 12.554210667275354, 20.679162638745147, 23.26716010793713, 14.471952066430665, 13.339202542188291, 63.08737610233001, 39.40742430905251, 41.34481840142098, 14.69424487643549, 41.17797134009646, 19.794308119221036, 24.876921684894132, -0.49204297760779525, 17.077648660071926, 10.873372840913234, 28.221278788869796, 37.84909878935904, 38.95441853701708, 25.4186455755181, 34.65129336508862, 1.732565854240212, 9.110323932156835, -9.051924204902967, 11.11483109303538, 29.06245948489199, 18.66565001346414, 18.807860216732983, 3.957488152597584, 16.12421658693078, -4.668812008107814, 24.108615061868257, 20.534066335208628, 41.29458933169667, 21.01977611025525, 55.04945015383451, 44.66967125251988, 39.35352720832338, 24.45925937659784, 10.493210008279362, 17.688408353947647, 17.310155774980544, 12.399105076023224, 40.35933791466383, 16.346404997453142, 10.083630697046196, 29.911142595288958, 9.659720178686742, 20.953336291336676, 16.874167962598417, -8.895159425403811, 8.522159355248151, 5.733173515500777, 16.277278980109408, 34.26230851765307, 4.864976095379351, -0.9725522039759174, 7.595957829769381, 24.273893811568996, 18.069192082324946, 13.290759315410012, 32.631196226009564, 17.53834485546419, 24.0644144854, -8.71059286744326, 17.933871497989795, 32.23992874746029, -4.746244957996936, 13.17547618439917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6425098735089384, "mean_inference_ms": 1.7202513547493405, "mean_action_processing_ms": 0.2656439721592598, "mean_env_wait_ms": 0.1492760036359603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031564950942993164, "StateBufferConnector_ms": 0.005358576774597168, "ViewRequirementAgentConnector_ms": 0.23978805541992188}, "num_episodes": 23, "episode_return_max": 49.85956070317718, "episode_return_min": -12.473354224103337, "episode_return_mean": 17.710627815559903, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.3425641473092, "num_env_steps_trained_throughput_per_sec": 416.3425641473092, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 117801.464, "restore_workers_time_ms": 0.13, "training_step_time_ms": 117801.068, "sample_time_ms": 1526.103, "learn_time_ms": 116244.31, "learn_throughput": 34.41, "synch_weights_time_ms": 26.195}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 64, "trial_id": "06536_00000", "date": "2024-08-11_17-04-13", "timestamp": 1723410253, "time_this_iter_s": 9.658497095108032, "time_total_s": 1796.5174996852875, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1796.5174996852875, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 43.01538461538462, "ram_util_percent": 83.63846153846156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5634745160738626, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1674670493230224, "policy_loss": -0.01044760749064153, "vf_loss": 2.1778481766581534, "vf_explained_var": 0.9397377310320735, "kl": 0.01063675546317073, "entropy": 0.6063541959350308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7380519627263307, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.095847509020851, "policy_loss": -0.0007256724309944917, "vf_loss": 2.096573187245263, "vf_explained_var": 0.9597273013579152, "kl": 0.003014698080528295, "entropy": 0.35508367898602966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": 49.85956070317718, "episode_reward_min": -12.473354224103337, "episode_reward_mean": 18.006353294670973, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.85956070317724, "predator_policy": -15.642297400994146}, "policy_reward_max": {"prey_policy": 12.473354224103332, "predator_policy": 63.08737610233001}, "policy_reward_mean": {"prey_policy": -18.006353294670973, "predator_policy": 18.006353294670973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.425751791041176, 27.174228197235873, 26.685795369221157, 9.943154174418156, 32.34794550870108, 29.05136912826326, 31.870719152475875, 21.095281605245134, 4.613807752240754, 28.52775025169236, 22.262757631553974, 36.144829843282, 19.853125111396245, 31.320336176712605, 22.50953337957667, 25.922364252298248, -6.082576819149756, 1.194398824101647, 18.717255855367142, 12.845675356744136, 23.260777040961667, 5.875614222521741, 30.20095393253886, 7.525646878152111, 16.37589883404327, 26.72132236123203, -12.473354224103337, 39.391816985421066, 7.720569542036163, -9.711577126488574, 27.311633704516147, 37.41006968918726, -5.412327981576825, 13.572734559151645, 6.101755670113029, 30.33365090592485, 21.048389488197614, 15.999810344158217, 5.708177984092348, 20.199550517116734, 14.814388124695094, -1.488122727272433, 27.965838932783598, 18.285664388338656, 30.525452532615468, 21.821808478132382, 8.811562753349648, 2.997081072652704, 16.61668665301024, 18.86955608718387, 38.213289322259165, 40.376121355236755, 27.93610810826599, 22.335614902057586, 8.292802841232067, 19.547325814891515, 38.40175866318804, 30.034969470303356, 5.421444893198531, 1.0314534440662246, 23.8640547491781, 11.382674184665262, 5.727702289411452, 22.321340698538428, 31.15718272097597, 49.85956070317718, 31.906393292460614, 14.090809181113501, 14.854630425501885, 28.352871456058537, 19.99738664616757, 15.306528235011704, 3.989504268597285, 7.127666435374458, 25.269793748881263, 1.9462119457017142, 15.934925820669186, 15.679975698867485, 25.084770540736898, 7.676910808978354, 25.08690012272508, 4.214615613201097, 15.734575212125915, -0.3160240406982524, 14.604025993936768, -2.5212199429841564, 34.73540699443338, 10.152342439222883, 25.459365950816917, 23.057450753901293, 16.031826419508526, 23.953186035254575, 28.256669926105328, 22.372622199997423, 5.887962701228139, 39.115571100591126, 2.434360664440182, 21.635209667370837, 15.040261342077358, -2.2260945160264773], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.425751791041185, -27.174228197235824, -26.685795369221157, -9.943154174418144, -32.3479455087011, -29.051369128263246, -31.870719152475893, -21.095281605245127, -4.613807752240754, -28.527750251692364, -22.262757631553942, -36.14482984328199, -19.853125111396228, -31.32033617671259, -22.509533379576673, -25.922364252298284, 6.082576819149754, -1.1943988241016381, -18.717255855367124, -12.845675356744124, -23.260777040961642, -5.87561422252174, -30.200953932538855, -7.525646878152105, -16.37589883404327, -26.721322361231994, 12.473354224103332, -39.391816985421144, -7.720569542036163, 9.711577126488573, -27.311633704516165, -37.41006968918731, 5.412327981576833, -13.572734559151678, -6.101755670113024, -30.333650905924834, -21.048389488197607, -15.999810344158242, -5.7081779840923605, -20.199550517116748, -14.814388124695125, 1.4881227272724598, -27.965838932783672, -18.28566438833869, -30.52545253261544, -21.821808478132397, -8.811562753349644, -2.997081072652695, -16.61668665301025, -18.8695560871839, -38.21328932225914, -40.37612135523674, -27.936108108265945, -22.33561490205758, -8.292802841232069, -19.547325814891508, -38.401758663188076, -30.034969470303384, -5.42144489319853, -1.0314534440662069, -23.864054749178116, -11.3826741846653, -5.727702289411495, -22.32134069853845, -31.157182720975968, -49.85956070317724, -31.9063932924606, -14.090809181113507, -14.854630425501888, -28.3528714560585, -19.997386646167566, -15.306528235011701, -3.9895042685972903, -7.127666435374466, -25.26979374888123, -1.946211945701723, -15.934925820669205, -15.679975698867475, -25.084770540736898, -7.676910808978364, -25.086900122725055, -4.214615613201131, -15.734575212125932, 0.31602404069825374, -14.604025993936792, 2.5212199429841573, -34.73540699443333, -10.15234243922291, -25.459365950816906, -23.05745075390127, -16.03182641950851, -23.953186035254586, -28.25666992610532, -22.372622199997423, -5.887962701228119, -39.11557110059111, -2.434360664440172, -21.635209667370855, -15.040261342077407, 2.226094516026471], "policy_predator_policy_reward": [16.766674477303482, 8.084829104778873, 17.676200996030975, 36.67225539844071, 37.08157015111652, 16.290020587325767, 12.559729979465157, 7.326578369371143, 34.40894814885947, 30.286942868542766, 26.95378385710568, 31.14895439942083, 23.159762756577237, 40.581675548374555, 16.236222538568214, 25.95434067192206, 15.976544057543652, -6.748928553062157, 35.012175386132746, 22.043325117252003, 23.345256131389018, 21.18025913171892, 44.0651925751103, 28.224467111453702, 22.215467507188706, 17.490782715603782, 29.962182381116843, 32.6784899723084, 28.90549713910086, 16.113569620052502, 26.64467459555379, 25.200053909042722, 2.400497961788183, -14.565651600087708, 0.6608808584184871, 1.727916789784807, 30.08149006864322, 7.353021642091033, 13.174235447072219, 12.517115266416035, 27.790468888987125, 18.731085192936177, 12.111411651903966, -0.36018320686048777, 31.918154466735544, 28.48375339834216, -7.5657087093848485, 22.617002465689062, 29.065783848535325, 3.6860138195512135, 41.40926064474813, 12.033384077715894, -13.35506889227235, -11.591639555934314, 29.801863080930573, 48.98177088991169, 2.6726988619853635, 12.768440222086957, -9.993413701116921, -9.429740551860238, 30.796918892274984, 23.826348516757353, 40.852671207263406, 33.96746817111117, -9.48680139463412, -1.337854568519548, 7.528663588152815, 19.616805530150504, -9.368335467258143, 21.571846807484185, 29.547981340250416, 31.119320471599288, 23.701713313553824, 18.395065662841397, 12.334058120712708, 19.66556256760377, 6.93383148153405, 4.482524486650668, 28.57208482284117, 11.82701621139232, 5.212787597303539, 24.415988652086725, -1.996428380058994, -0.979817074485906, 19.08443433691933, 36.84724352864798, 19.35737193880388, 17.213956837873464, 27.208068405809307, 33.842836659421614, 12.46659720184875, 31.177019754416015, 0.08247090461202333, 17.540654602087265, -15.642297400994146, 21.63645954629954, 12.554210667275354, 20.679162638745147, 23.26716010793713, 14.471952066430665, 13.339202542188291, 63.08737610233001, 39.40742430905251, 41.34481840142098, 14.69424487643549, 41.17797134009646, 19.794308119221036, 24.876921684894132, -0.49204297760779525, 17.077648660071926, 10.873372840913234, 28.221278788869796, 37.84909878935904, 38.95441853701708, 25.4186455755181, 34.65129336508862, 1.732565854240212, 9.110323932156835, -9.051924204902967, 11.11483109303538, 29.06245948489199, 18.66565001346414, 18.807860216732983, 3.957488152597584, 16.12421658693078, -4.668812008107814, 24.108615061868257, 20.534066335208628, 41.29458933169667, 21.01977611025525, 55.04945015383451, 44.66967125251988, 39.35352720832338, 24.45925937659784, 10.493210008279362, 17.688408353947647, 17.310155774980544, 12.399105076023224, 40.35933791466383, 16.346404997453142, 10.083630697046196, 29.911142595288958, 9.659720178686742, 20.953336291336676, 16.874167962598417, -8.895159425403811, 8.522159355248151, 5.733173515500777, 16.277278980109408, 34.26230851765307, 4.864976095379351, -0.9725522039759174, 7.595957829769381, 24.273893811568996, 18.069192082324946, 13.290759315410012, 32.631196226009564, 17.53834485546419, 24.0644144854, -8.71059286744326, 17.933871497989795, 32.23992874746029, -4.746244957996936, 13.17547618439917, 11.470303193882545, 19.99884723036932, 3.4667266265963814, -4.0987747079928845, 12.97315021656584, 16.234901771307726, 5.877339422755567, -10.919779308723882, 35.91608789504829, 33.55472609381842, 6.449511656171538, 13.855173222274262, 42.21016343121867, 8.708568470415152, 26.918700278173702, 19.196201229628898, 32.08882734468315, -0.02517450566615942, 20.440465499792495, 27.465906570716655, 14.252968641405763, 42.260371210804884, 12.702187411844974, 32.04305698814987, -8.558302126352178, 20.33422752880845, 36.73694417092153, 41.49419803026069, -14.83102509880186, 19.69974642768221, 28.97332699335729, 14.297092341384399, 10.628846204107054, 19.451676480047713, -11.667176628804334, 7.2149875967513815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6450755455886168, "mean_inference_ms": 1.7264065018858665, "mean_action_processing_ms": 0.2663631460358259, "mean_env_wait_ms": 0.14947941815167437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02513885498046875, "StateBufferConnector_ms": 0.004860877990722656, "ViewRequirementAgentConnector_ms": 0.21076250076293945}, "num_episodes": 18, "episode_return_max": 49.85956070317718, "episode_return_min": -12.473354224103337, "episode_return_mean": 18.006353294670973, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.7440810329669, "num_env_steps_trained_throughput_per_sec": 435.7440810329669, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 117517.166, "restore_workers_time_ms": 0.13, "training_step_time_ms": 117516.769, "sample_time_ms": 1437.889, "learn_time_ms": 116048.167, "learn_throughput": 34.468, "synch_weights_time_ms": 26.135}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 65, "trial_id": "06536_00000", "date": "2024-08-11_17-04-22", "timestamp": 1723410262, "time_this_iter_s": 9.205610036849976, "time_total_s": 1805.7231097221375, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1805.7231097221375, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 32.300000000000004, "ram_util_percent": 83.48461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5363881815224887, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.862673802115023, "policy_loss": -0.004650850876835951, "vf_loss": 1.8672979897509019, "vf_explained_var": 0.9658471091339985, "kl": 0.004266532576395256, "entropy": 0.6375423398489753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7571897887679, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9969506743723753, "policy_loss": -0.0021543803008854706, "vf_loss": 1.9991050511440902, "vf_explained_var": 0.9691869644260911, "kl": 0.0032208781957945368, "entropy": 0.38457455012218034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 49.85956070317718, "episode_reward_min": -12.473354224103337, "episode_reward_mean": 17.246989190544525, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.85956070317724, "predator_policy": -15.642297400994146}, "policy_reward_max": {"prey_policy": 12.473354224103332, "predator_policy": 63.08737610233001}, "policy_reward_mean": {"prey_policy": -17.246989190544525, "predator_policy": 17.246989190544525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.717255855367142, 12.845675356744136, 23.260777040961667, 5.875614222521741, 30.20095393253886, 7.525646878152111, 16.37589883404327, 26.72132236123203, -12.473354224103337, 39.391816985421066, 7.720569542036163, -9.711577126488574, 27.311633704516147, 37.41006968918726, -5.412327981576825, 13.572734559151645, 6.101755670113029, 30.33365090592485, 21.048389488197614, 15.999810344158217, 5.708177984092348, 20.199550517116734, 14.814388124695094, -1.488122727272433, 27.965838932783598, 18.285664388338656, 30.525452532615468, 21.821808478132382, 8.811562753349648, 2.997081072652704, 16.61668665301024, 18.86955608718387, 38.213289322259165, 40.376121355236755, 27.93610810826599, 22.335614902057586, 8.292802841232067, 19.547325814891515, 38.40175866318804, 30.034969470303356, 5.421444893198531, 1.0314534440662246, 23.8640547491781, 11.382674184665262, 5.727702289411452, 22.321340698538428, 31.15718272097597, 49.85956070317718, 31.906393292460614, 14.090809181113501, 14.854630425501885, 28.352871456058537, 19.99738664616757, 15.306528235011704, 3.989504268597285, 7.127666435374458, 25.269793748881263, 1.9462119457017142, 15.934925820669186, 15.679975698867485, 25.084770540736898, 7.676910808978354, 25.08690012272508, 4.214615613201097, 15.734575212125915, -0.3160240406982524, 14.604025993936768, -2.5212199429841564, 34.73540699443338, 10.152342439222883, 25.459365950816917, 23.057450753901293, 16.031826419508526, 23.953186035254575, 28.256669926105328, 22.372622199997423, 5.887962701228139, 39.115571100591126, 2.434360664440182, 21.635209667370837, 15.040261342077358, -2.2260945160264773, 15.909660333630102, 17.244127467217833, 32.10544341635823, 3.4780403366459325, 33.72514231744596, 16.05044219724415, 10.199717011437615, 28.504329897036627, 5.733139579788596, 23.24885484716154, 1.1801896200234676, -2.6229290803265233, 11.141231657178597, 42.032340768768805, -0.7794889103457399, 20.390776655670898, 25.66248250731854, 17.7206602954072], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.717255855367124, -12.845675356744124, -23.260777040961642, -5.87561422252174, -30.200953932538855, -7.525646878152105, -16.37589883404327, -26.721322361231994, 12.473354224103332, -39.391816985421144, -7.720569542036163, 9.711577126488573, -27.311633704516165, -37.41006968918731, 5.412327981576833, -13.572734559151678, -6.101755670113024, -30.333650905924834, -21.048389488197607, -15.999810344158242, -5.7081779840923605, -20.199550517116748, -14.814388124695125, 1.4881227272724598, -27.965838932783672, -18.28566438833869, -30.52545253261544, -21.821808478132397, -8.811562753349644, -2.997081072652695, -16.61668665301025, -18.8695560871839, -38.21328932225914, -40.37612135523674, -27.936108108265945, -22.33561490205758, -8.292802841232069, -19.547325814891508, -38.401758663188076, -30.034969470303384, -5.42144489319853, -1.0314534440662069, -23.864054749178116, -11.3826741846653, -5.727702289411495, -22.32134069853845, -31.157182720975968, -49.85956070317724, -31.9063932924606, -14.090809181113507, -14.854630425501888, -28.3528714560585, -19.997386646167566, -15.306528235011701, -3.9895042685972903, -7.127666435374466, -25.26979374888123, -1.946211945701723, -15.934925820669205, -15.679975698867475, -25.084770540736898, -7.676910808978364, -25.086900122725055, -4.214615613201131, -15.734575212125932, 0.31602404069825374, -14.604025993936792, 2.5212199429841573, -34.73540699443333, -10.15234243922291, -25.459365950816906, -23.05745075390127, -16.03182641950851, -23.953186035254586, -28.25666992610532, -22.372622199997423, -5.887962701228119, -39.11557110059111, -2.434360664440172, -21.635209667370855, -15.040261342077407, 2.226094516026471, -15.90966033363006, -17.24412746721783, -32.10544341635817, -3.478040336645913, -33.725142317446, -16.05044219724414, -10.199717011437613, -28.504329897036605, -5.733139579788615, -23.24885484716154, -1.1801896200234658, 2.6229290803265233, -11.141231657178594, -42.03234076876879, 0.779488910345731, -20.39077665567091, -25.662482507318504, -17.7206602954072], "policy_predator_policy_reward": [30.08149006864322, 7.353021642091033, 13.174235447072219, 12.517115266416035, 27.790468888987125, 18.731085192936177, 12.111411651903966, -0.36018320686048777, 31.918154466735544, 28.48375339834216, -7.5657087093848485, 22.617002465689062, 29.065783848535325, 3.6860138195512135, 41.40926064474813, 12.033384077715894, -13.35506889227235, -11.591639555934314, 29.801863080930573, 48.98177088991169, 2.6726988619853635, 12.768440222086957, -9.993413701116921, -9.429740551860238, 30.796918892274984, 23.826348516757353, 40.852671207263406, 33.96746817111117, -9.48680139463412, -1.337854568519548, 7.528663588152815, 19.616805530150504, -9.368335467258143, 21.571846807484185, 29.547981340250416, 31.119320471599288, 23.701713313553824, 18.395065662841397, 12.334058120712708, 19.66556256760377, 6.93383148153405, 4.482524486650668, 28.57208482284117, 11.82701621139232, 5.212787597303539, 24.415988652086725, -1.996428380058994, -0.979817074485906, 19.08443433691933, 36.84724352864798, 19.35737193880388, 17.213956837873464, 27.208068405809307, 33.842836659421614, 12.46659720184875, 31.177019754416015, 0.08247090461202333, 17.540654602087265, -15.642297400994146, 21.63645954629954, 12.554210667275354, 20.679162638745147, 23.26716010793713, 14.471952066430665, 13.339202542188291, 63.08737610233001, 39.40742430905251, 41.34481840142098, 14.69424487643549, 41.17797134009646, 19.794308119221036, 24.876921684894132, -0.49204297760779525, 17.077648660071926, 10.873372840913234, 28.221278788869796, 37.84909878935904, 38.95441853701708, 25.4186455755181, 34.65129336508862, 1.732565854240212, 9.110323932156835, -9.051924204902967, 11.11483109303538, 29.06245948489199, 18.66565001346414, 18.807860216732983, 3.957488152597584, 16.12421658693078, -4.668812008107814, 24.108615061868257, 20.534066335208628, 41.29458933169667, 21.01977611025525, 55.04945015383451, 44.66967125251988, 39.35352720832338, 24.45925937659784, 10.493210008279362, 17.688408353947647, 17.310155774980544, 12.399105076023224, 40.35933791466383, 16.346404997453142, 10.083630697046196, 29.911142595288958, 9.659720178686742, 20.953336291336676, 16.874167962598417, -8.895159425403811, 8.522159355248151, 5.733173515500777, 16.277278980109408, 34.26230851765307, 4.864976095379351, -0.9725522039759174, 7.595957829769381, 24.273893811568996, 18.069192082324946, 13.290759315410012, 32.631196226009564, 17.53834485546419, 24.0644144854, -8.71059286744326, 17.933871497989795, 32.23992874746029, -4.746244957996936, 13.17547618439917, 11.470303193882545, 19.99884723036932, 3.4667266265963814, -4.0987747079928845, 12.97315021656584, 16.234901771307726, 5.877339422755567, -10.919779308723882, 35.91608789504829, 33.55472609381842, 6.449511656171538, 13.855173222274262, 42.21016343121867, 8.708568470415152, 26.918700278173702, 19.196201229628898, 32.08882734468315, -0.02517450566615942, 20.440465499792495, 27.465906570716655, 14.252968641405763, 42.260371210804884, 12.702187411844974, 32.04305698814987, -8.558302126352178, 20.33422752880845, 36.73694417092153, 41.49419803026069, -14.83102509880186, 19.69974642768221, 28.97332699335729, 14.297092341384399, 10.628846204107054, 19.451676480047713, -11.667176628804334, 7.2149875967513815, 12.087850980364564, 19.731469686895565, 22.325032215472618, 12.163222718963048, 37.50721750950953, 26.70366932320687, -0.5703523935062016, 7.5264330667980435, 15.63264664156274, 51.817637993329264, 15.917750321258445, 16.18313407322984, 9.958543090083914, 10.440890932791305, 27.990445376322686, 29.018214417750517, -5.586854777710857, 17.053133937288067, 40.39283282845097, 6.10487686587215, -0.0782164091878812, 2.4385956492348058, -13.02590378594275, 7.780045625289704, -0.9822335092207122, 23.264696823577893, 52.22586715532497, 31.83881438221264, -7.545492946541325, 5.98651512584987, 28.71663709981944, 12.064916211522418, 30.60114134304118, 20.723823671595863, 3.252688307998947, 32.188632282815455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6471073393936634, "mean_inference_ms": 1.7317929305001518, "mean_action_processing_ms": 0.2670767925702733, "mean_env_wait_ms": 0.14966634257253333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02510237693786621, "StateBufferConnector_ms": 0.0048531293869018555, "ViewRequirementAgentConnector_ms": 0.20540297031402588}, "num_episodes": 18, "episode_return_max": 49.85956070317718, "episode_return_min": -12.473354224103337, "episode_return_mean": 17.246989190544525, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.1441614927871, "num_env_steps_trained_throughput_per_sec": 438.1441614927871, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 117302.538, "restore_workers_time_ms": 0.13, "training_step_time_ms": 117302.136, "sample_time_ms": 1366.798, "learn_time_ms": 115909.416, "learn_throughput": 34.51, "synch_weights_time_ms": 23.598}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 66, "trial_id": "06536_00000", "date": "2024-08-11_17-04-31", "timestamp": 1723410271, "time_this_iter_s": 9.189108848571777, "time_total_s": 1814.9122185707092, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33162ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1814.9122185707092, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 41.96923076923077, "ram_util_percent": 83.28461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8894129895915586, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7486591059714556, "policy_loss": -0.0095275201650414, "vf_loss": 2.758159387980898, "vf_explained_var": 0.9282808129986128, "kl": 0.008713385375074188, "entropy": 0.6534838400781154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9965167945654936, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.643693231527137, "policy_loss": -0.002604523617601781, "vf_loss": 2.64629776124601, "vf_explained_var": 0.9476360667319524, "kl": 0.004652956185833222, "entropy": 0.37590825739045625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "env_runners": {"episode_reward_max": 50.58544524004384, "episode_reward_min": -3.9428495704202255, "episode_reward_mean": 18.054957331289707, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58544524004386, "predator_policy": -15.642297400994146}, "policy_reward_max": {"prey_policy": 3.942849570420215, "predator_policy": 63.08737610233001}, "policy_reward_mean": {"prey_policy": -18.054957331289703, "predator_policy": 18.054957331289707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.814388124695094, -1.488122727272433, 27.965838932783598, 18.285664388338656, 30.525452532615468, 21.821808478132382, 8.811562753349648, 2.997081072652704, 16.61668665301024, 18.86955608718387, 38.213289322259165, 40.376121355236755, 27.93610810826599, 22.335614902057586, 8.292802841232067, 19.547325814891515, 38.40175866318804, 30.034969470303356, 5.421444893198531, 1.0314534440662246, 23.8640547491781, 11.382674184665262, 5.727702289411452, 22.321340698538428, 31.15718272097597, 49.85956070317718, 31.906393292460614, 14.090809181113501, 14.854630425501885, 28.352871456058537, 19.99738664616757, 15.306528235011704, 3.989504268597285, 7.127666435374458, 25.269793748881263, 1.9462119457017142, 15.934925820669186, 15.679975698867485, 25.084770540736898, 7.676910808978354, 25.08690012272508, 4.214615613201097, 15.734575212125915, -0.3160240406982524, 14.604025993936768, -2.5212199429841564, 34.73540699443338, 10.152342439222883, 25.459365950816917, 23.057450753901293, 16.031826419508526, 23.953186035254575, 28.256669926105328, 22.372622199997423, 5.887962701228139, 39.115571100591126, 2.434360664440182, 21.635209667370837, 15.040261342077358, -2.2260945160264773, 15.909660333630102, 17.244127467217833, 32.10544341635823, 3.4780403366459325, 33.72514231744596, 16.05044219724415, 10.199717011437615, 28.504329897036627, 5.733139579788596, 23.24885484716154, 1.1801896200234676, -2.6229290803265233, 11.141231657178597, 42.032340768768805, -0.7794889103457399, 20.390776655670898, 25.66248250731854, 17.7206602954072, -3.9428495704202255, 9.981870635930447, 33.35096304209417, 27.960450796386706, 7.721862817107057, 20.289685089817837, 5.6714835191478965, 0.3827130293325878, 38.24277817909911, 50.58544524004384, 14.17059625903685, 31.790862296946383, 28.1113881555113, 0.8946017781333877, 31.983802053579147, 26.396199351071726, -0.8251482182655803, 11.250525733366054, 31.67884658032376, 7.9270766596908135, 17.936384311885472, 27.96132087400686], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.814388124695125, 1.4881227272724598, -27.965838932783672, -18.28566438833869, -30.52545253261544, -21.821808478132397, -8.811562753349644, -2.997081072652695, -16.61668665301025, -18.8695560871839, -38.21328932225914, -40.37612135523674, -27.936108108265945, -22.33561490205758, -8.292802841232069, -19.547325814891508, -38.401758663188076, -30.034969470303384, -5.42144489319853, -1.0314534440662069, -23.864054749178116, -11.3826741846653, -5.727702289411495, -22.32134069853845, -31.157182720975968, -49.85956070317724, -31.9063932924606, -14.090809181113507, -14.854630425501888, -28.3528714560585, -19.997386646167566, -15.306528235011701, -3.9895042685972903, -7.127666435374466, -25.26979374888123, -1.946211945701723, -15.934925820669205, -15.679975698867475, -25.084770540736898, -7.676910808978364, -25.086900122725055, -4.214615613201131, -15.734575212125932, 0.31602404069825374, -14.604025993936792, 2.5212199429841573, -34.73540699443333, -10.15234243922291, -25.459365950816906, -23.05745075390127, -16.03182641950851, -23.953186035254586, -28.25666992610532, -22.372622199997423, -5.887962701228119, -39.11557110059111, -2.434360664440172, -21.635209667370855, -15.040261342077407, 2.226094516026471, -15.90966033363006, -17.24412746721783, -32.10544341635817, -3.478040336645913, -33.725142317446, -16.05044219724414, -10.199717011437613, -28.504329897036605, -5.733139579788615, -23.24885484716154, -1.1801896200234658, 2.6229290803265233, -11.141231657178594, -42.03234076876879, 0.779488910345731, -20.39077665567091, -25.662482507318504, -17.7206602954072, 3.942849570420215, -9.98187063593043, -33.35096304209423, -27.960450796386628, -7.721862817107037, -20.289685089817837, -5.671483519147905, -0.3827130293325949, -38.24277817909913, -50.58544524004386, -14.17059625903686, -31.79086229694628, -28.11138815551128, -0.8946017781333513, -31.983802053579133, -26.396199351071715, 0.8251482182655918, -11.25052573336607, -31.678846580323732, -7.927076659690806, -17.93638431188549, -27.96132087400686], "policy_predator_policy_reward": [5.212787597303539, 24.415988652086725, -1.996428380058994, -0.979817074485906, 19.08443433691933, 36.84724352864798, 19.35737193880388, 17.213956837873464, 27.208068405809307, 33.842836659421614, 12.46659720184875, 31.177019754416015, 0.08247090461202333, 17.540654602087265, -15.642297400994146, 21.63645954629954, 12.554210667275354, 20.679162638745147, 23.26716010793713, 14.471952066430665, 13.339202542188291, 63.08737610233001, 39.40742430905251, 41.34481840142098, 14.69424487643549, 41.17797134009646, 19.794308119221036, 24.876921684894132, -0.49204297760779525, 17.077648660071926, 10.873372840913234, 28.221278788869796, 37.84909878935904, 38.95441853701708, 25.4186455755181, 34.65129336508862, 1.732565854240212, 9.110323932156835, -9.051924204902967, 11.11483109303538, 29.06245948489199, 18.66565001346414, 18.807860216732983, 3.957488152597584, 16.12421658693078, -4.668812008107814, 24.108615061868257, 20.534066335208628, 41.29458933169667, 21.01977611025525, 55.04945015383451, 44.66967125251988, 39.35352720832338, 24.45925937659784, 10.493210008279362, 17.688408353947647, 17.310155774980544, 12.399105076023224, 40.35933791466383, 16.346404997453142, 10.083630697046196, 29.911142595288958, 9.659720178686742, 20.953336291336676, 16.874167962598417, -8.895159425403811, 8.522159355248151, 5.733173515500777, 16.277278980109408, 34.26230851765307, 4.864976095379351, -0.9725522039759174, 7.595957829769381, 24.273893811568996, 18.069192082324946, 13.290759315410012, 32.631196226009564, 17.53834485546419, 24.0644144854, -8.71059286744326, 17.933871497989795, 32.23992874746029, -4.746244957996936, 13.17547618439917, 11.470303193882545, 19.99884723036932, 3.4667266265963814, -4.0987747079928845, 12.97315021656584, 16.234901771307726, 5.877339422755567, -10.919779308723882, 35.91608789504829, 33.55472609381842, 6.449511656171538, 13.855173222274262, 42.21016343121867, 8.708568470415152, 26.918700278173702, 19.196201229628898, 32.08882734468315, -0.02517450566615942, 20.440465499792495, 27.465906570716655, 14.252968641405763, 42.260371210804884, 12.702187411844974, 32.04305698814987, -8.558302126352178, 20.33422752880845, 36.73694417092153, 41.49419803026069, -14.83102509880186, 19.69974642768221, 28.97332699335729, 14.297092341384399, 10.628846204107054, 19.451676480047713, -11.667176628804334, 7.2149875967513815, 12.087850980364564, 19.731469686895565, 22.325032215472618, 12.163222718963048, 37.50721750950953, 26.70366932320687, -0.5703523935062016, 7.5264330667980435, 15.63264664156274, 51.817637993329264, 15.917750321258445, 16.18313407322984, 9.958543090083914, 10.440890932791305, 27.990445376322686, 29.018214417750517, -5.586854777710857, 17.053133937288067, 40.39283282845097, 6.10487686587215, -0.0782164091878812, 2.4385956492348058, -13.02590378594275, 7.780045625289704, -0.9822335092207122, 23.264696823577893, 52.22586715532497, 31.83881438221264, -7.545492946541325, 5.98651512584987, 28.71663709981944, 12.064916211522418, 30.60114134304118, 20.723823671595863, 3.252688307998947, 32.188632282815455, -0.4744718439916227, -7.411227296848818, 12.966247324169256, 6.997493947691616, 48.02253867658986, 18.679387407598533, 41.541904957399396, 14.378996635373877, 11.559776822612823, 3.8839488116012744, 33.281744496824594, 7.297625682811066, -0.9114563175755368, 12.254423355871358, 2.650855494477696, -1.8854294358125028, 29.518534936975307, 46.96702142122292, 49.17116944053242, 51.99972103955526, 0.05789314090111297, 28.283299377172575, 22.114178180520053, 41.4675464133726, 32.94920740046393, 23.27356891055866, -7.095781861389568, 8.884985417656281, 15.888231466322626, 48.07937264083567, 29.31764435020819, 23.474754351935232, -14.590988141576524, 12.940691705045346, 5.977736317253694, 16.523315149478446, 29.541956594934106, 33.81573656571341, 9.397213681297327, 6.456939638084291, 23.59047098397825, 12.282297639792704, 45.39619417994328, 10.526447568070397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6480477272108162, "mean_inference_ms": 1.7318046679949963, "mean_action_processing_ms": 0.2671084248349832, "mean_env_wait_ms": 0.14950584237337594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02496802806854248, "StateBufferConnector_ms": 0.004090785980224609, "ViewRequirementAgentConnector_ms": 0.18178188800811768}, "num_episodes": 22, "episode_return_max": 50.58544524004384, "episode_return_min": -3.9428495704202255, "episode_return_mean": 18.054957331289707, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.6408945680627, "num_env_steps_trained_throughput_per_sec": 470.6408945680627, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 116981.297, "restore_workers_time_ms": 0.128, "training_step_time_ms": 116980.901, "sample_time_ms": 1364.012, "learn_time_ms": 115591.026, "learn_throughput": 34.605, "synch_weights_time_ms": 23.599}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "training_iteration": 67, "trial_id": "06536_00000", "date": "2024-08-11_17-04-40", "timestamp": 1723410280, "time_this_iter_s": 8.501942157745361, "time_total_s": 1823.4141607284546, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1823.4141607284546, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 32.925000000000004, "ram_util_percent": 83.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.00883619133383, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.878570634747545, "policy_loss": -0.007462509580606517, "vf_loss": 2.886011060823997, "vf_explained_var": 0.9272907481218378, "kl": 0.007065928833038379, "entropy": 0.6083573559299111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.904394261199961, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.987874684636555, "policy_loss": -0.002336326678451052, "vf_loss": 2.990211014015965, "vf_explained_var": 0.9314455167957084, "kl": 0.005027354987900457, "entropy": 0.3257849188472228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 50.58544524004384, "episode_reward_min": -16.121825940899942, "episode_reward_mean": 16.169600282485632, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58544524004386, "predator_policy": -17.49348138956201}, "policy_reward_max": {"prey_policy": 16.121825940899946, "predator_policy": 55.04945015383451}, "policy_reward_mean": {"prey_policy": -16.169600282485632, "predator_policy": 16.169600282485632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.421444893198531, 1.0314534440662246, 23.8640547491781, 11.382674184665262, 5.727702289411452, 22.321340698538428, 31.15718272097597, 49.85956070317718, 31.906393292460614, 14.090809181113501, 14.854630425501885, 28.352871456058537, 19.99738664616757, 15.306528235011704, 3.989504268597285, 7.127666435374458, 25.269793748881263, 1.9462119457017142, 15.934925820669186, 15.679975698867485, 25.084770540736898, 7.676910808978354, 25.08690012272508, 4.214615613201097, 15.734575212125915, -0.3160240406982524, 14.604025993936768, -2.5212199429841564, 34.73540699443338, 10.152342439222883, 25.459365950816917, 23.057450753901293, 16.031826419508526, 23.953186035254575, 28.256669926105328, 22.372622199997423, 5.887962701228139, 39.115571100591126, 2.434360664440182, 21.635209667370837, 15.040261342077358, -2.2260945160264773, 15.909660333630102, 17.244127467217833, 32.10544341635823, 3.4780403366459325, 33.72514231744596, 16.05044219724415, 10.199717011437615, 28.504329897036627, 5.733139579788596, 23.24885484716154, 1.1801896200234676, -2.6229290803265233, 11.141231657178597, 42.032340768768805, -0.7794889103457399, 20.390776655670898, 25.66248250731854, 17.7206602954072, -3.9428495704202255, 9.981870635930447, 33.35096304209417, 27.960450796386706, 7.721862817107057, 20.289685089817837, 5.6714835191478965, 0.3827130293325878, 38.24277817909911, 50.58544524004384, 14.17059625903685, 31.790862296946383, 28.1113881555113, 0.8946017781333877, 31.983802053579147, 26.396199351071726, -0.8251482182655803, 11.250525733366054, 31.67884658032376, 7.9270766596908135, 17.936384311885472, 27.96132087400686, 16.654296112446655, 5.411957926700129, 2.222865108835844, 24.702162829142658, 22.607693037838846, 11.987967273211133, 11.503500668912567, -2.959113021119541, 28.494987879449152, 6.725170150028537, 13.241858304028208, -16.121825940899942, 14.689063188091014, 9.038003546782948, 13.671037570206943, 2.455039031596576, 8.39688561530258, 23.100652611962058], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.42144489319853, -1.0314534440662069, -23.864054749178116, -11.3826741846653, -5.727702289411495, -22.32134069853845, -31.157182720975968, -49.85956070317724, -31.9063932924606, -14.090809181113507, -14.854630425501888, -28.3528714560585, -19.997386646167566, -15.306528235011701, -3.9895042685972903, -7.127666435374466, -25.26979374888123, -1.946211945701723, -15.934925820669205, -15.679975698867475, -25.084770540736898, -7.676910808978364, -25.086900122725055, -4.214615613201131, -15.734575212125932, 0.31602404069825374, -14.604025993936792, 2.5212199429841573, -34.73540699443333, -10.15234243922291, -25.459365950816906, -23.05745075390127, -16.03182641950851, -23.953186035254586, -28.25666992610532, -22.372622199997423, -5.887962701228119, -39.11557110059111, -2.434360664440172, -21.635209667370855, -15.040261342077407, 2.226094516026471, -15.90966033363006, -17.24412746721783, -32.10544341635817, -3.478040336645913, -33.725142317446, -16.05044219724414, -10.199717011437613, -28.504329897036605, -5.733139579788615, -23.24885484716154, -1.1801896200234658, 2.6229290803265233, -11.141231657178594, -42.03234076876879, 0.779488910345731, -20.39077665567091, -25.662482507318504, -17.7206602954072, 3.942849570420215, -9.98187063593043, -33.35096304209423, -27.960450796386628, -7.721862817107037, -20.289685089817837, -5.671483519147905, -0.3827130293325949, -38.24277817909913, -50.58544524004386, -14.17059625903686, -31.79086229694628, -28.11138815551128, -0.8946017781333513, -31.983802053579133, -26.396199351071715, 0.8251482182655918, -11.25052573336607, -31.678846580323732, -7.927076659690806, -17.93638431188549, -27.96132087400686, -16.654296112446637, -5.411957926700133, -2.222865108835843, -24.702162829142644, -22.607693037838807, -11.987967273211146, -11.503500668912562, 2.9591130211195456, -28.494987879449155, -6.725170150028487, -13.24185830402822, 16.121825940899946, -14.689063188091009, -9.03800354678297, -13.671037570207002, -2.455039031596576, -8.39688561530258, -23.10065261196208], "policy_predator_policy_reward": [1.732565854240212, 9.110323932156835, -9.051924204902967, 11.11483109303538, 29.06245948489199, 18.66565001346414, 18.807860216732983, 3.957488152597584, 16.12421658693078, -4.668812008107814, 24.108615061868257, 20.534066335208628, 41.29458933169667, 21.01977611025525, 55.04945015383451, 44.66967125251988, 39.35352720832338, 24.45925937659784, 10.493210008279362, 17.688408353947647, 17.310155774980544, 12.399105076023224, 40.35933791466383, 16.346404997453142, 10.083630697046196, 29.911142595288958, 9.659720178686742, 20.953336291336676, 16.874167962598417, -8.895159425403811, 8.522159355248151, 5.733173515500777, 16.277278980109408, 34.26230851765307, 4.864976095379351, -0.9725522039759174, 7.595957829769381, 24.273893811568996, 18.069192082324946, 13.290759315410012, 32.631196226009564, 17.53834485546419, 24.0644144854, -8.71059286744326, 17.933871497989795, 32.23992874746029, -4.746244957996936, 13.17547618439917, 11.470303193882545, 19.99884723036932, 3.4667266265963814, -4.0987747079928845, 12.97315021656584, 16.234901771307726, 5.877339422755567, -10.919779308723882, 35.91608789504829, 33.55472609381842, 6.449511656171538, 13.855173222274262, 42.21016343121867, 8.708568470415152, 26.918700278173702, 19.196201229628898, 32.08882734468315, -0.02517450566615942, 20.440465499792495, 27.465906570716655, 14.252968641405763, 42.260371210804884, 12.702187411844974, 32.04305698814987, -8.558302126352178, 20.33422752880845, 36.73694417092153, 41.49419803026069, -14.83102509880186, 19.69974642768221, 28.97332699335729, 14.297092341384399, 10.628846204107054, 19.451676480047713, -11.667176628804334, 7.2149875967513815, 12.087850980364564, 19.731469686895565, 22.325032215472618, 12.163222718963048, 37.50721750950953, 26.70366932320687, -0.5703523935062016, 7.5264330667980435, 15.63264664156274, 51.817637993329264, 15.917750321258445, 16.18313407322984, 9.958543090083914, 10.440890932791305, 27.990445376322686, 29.018214417750517, -5.586854777710857, 17.053133937288067, 40.39283282845097, 6.10487686587215, -0.0782164091878812, 2.4385956492348058, -13.02590378594275, 7.780045625289704, -0.9822335092207122, 23.264696823577893, 52.22586715532497, 31.83881438221264, -7.545492946541325, 5.98651512584987, 28.71663709981944, 12.064916211522418, 30.60114134304118, 20.723823671595863, 3.252688307998947, 32.188632282815455, -0.4744718439916227, -7.411227296848818, 12.966247324169256, 6.997493947691616, 48.02253867658986, 18.679387407598533, 41.541904957399396, 14.378996635373877, 11.559776822612823, 3.8839488116012744, 33.281744496824594, 7.297625682811066, -0.9114563175755368, 12.254423355871358, 2.650855494477696, -1.8854294358125028, 29.518534936975307, 46.96702142122292, 49.17116944053242, 51.99972103955526, 0.05789314090111297, 28.283299377172575, 22.114178180520053, 41.4675464133726, 32.94920740046393, 23.27356891055866, -7.095781861389568, 8.884985417656281, 15.888231466322626, 48.07937264083567, 29.31764435020819, 23.474754351935232, -14.590988141576524, 12.940691705045346, 5.977736317253694, 16.523315149478446, 29.541956594934106, 33.81573656571341, 9.397213681297327, 6.456939638084291, 23.59047098397825, 12.282297639792704, 45.39619417994328, 10.526447568070397, 18.07827990517078, 15.230312319722533, 3.4541894915450726, 7.369726361855202, -2.2600084431539322, 6.705738660825606, 22.595746875376385, 26.80857878290891, 17.665077006106024, 27.55030906957161, 1.8721407106150263, 22.10379383580724, 13.754724675224768, 9.252276662600345, 11.062733866924427, -16.980959909163538, 35.94976362411582, 21.040212134782525, 1.3268979704244988, 12.123442329632518, 8.869383419000387, 17.61433318905606, -14.750170492237878, -17.49348138956201, 16.682474546980448, 12.69565182920152, 20.98858020637119, -2.912573112805285, 14.508450536612116, 12.833624603801805, -9.36337470546045, 14.273452768653652, 5.3897185741321, 11.404052656473048, 23.872563339131528, 22.328741884792638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6454303614694363, "mean_inference_ms": 1.7247689844812109, "mean_action_processing_ms": 0.2660344428843329, "mean_env_wait_ms": 0.14885315971471313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038220882415771484, "StateBufferConnector_ms": 0.002611517906188965, "ViewRequirementAgentConnector_ms": 0.07735669612884521}, "num_episodes": 18, "episode_return_max": 50.58544524004384, "episode_return_min": -16.121825940899942, "episode_return_mean": 16.169600282485632, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.7079169207683464, "num_env_steps_trained_throughput_per_sec": 3.7079169207683464, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 223617.725, "restore_workers_time_ms": 0.127, "training_step_time_ms": 223617.331, "sample_time_ms": 1269.453, "learn_time_ms": 222321.39, "learn_throughput": 17.992, "synch_weights_time_ms": 24.129}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 68, "trial_id": "06536_00000", "date": "2024-08-11_17-22-39", "timestamp": 1723411359, "time_this_iter_s": 1078.828102350235, "time_total_s": 2902.2422630786896, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33175dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2902.2422630786896, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 51.79375, "ram_util_percent": 83.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7667432708044846, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2698752361039323, "policy_loss": -0.0076072661242506, "vf_loss": 2.2774449879924457, "vf_explained_var": 0.9393993908539414, "kl": 0.01200611375175546, "entropy": 0.6645112917448084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8648112437712454, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.360400095124724, "policy_loss": -0.0016558859276797169, "vf_loss": 2.362055977248641, "vf_explained_var": 0.9518674493782104, "kl": 0.0029748104550905707, "entropy": 0.3994745131838259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "env_runners": {"episode_reward_max": 50.58544524004384, "episode_reward_min": -16.121825940899942, "episode_reward_mean": 15.325270002134332, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58544524004386, "predator_policy": -17.49348138956201}, "policy_reward_max": {"prey_policy": 16.121825940899946, "predator_policy": 52.22586715532497}, "policy_reward_mean": {"prey_policy": -15.325270002134335, "predator_policy": 15.325270002134332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.214615613201097, 15.734575212125915, -0.3160240406982524, 14.604025993936768, -2.5212199429841564, 34.73540699443338, 10.152342439222883, 25.459365950816917, 23.057450753901293, 16.031826419508526, 23.953186035254575, 28.256669926105328, 22.372622199997423, 5.887962701228139, 39.115571100591126, 2.434360664440182, 21.635209667370837, 15.040261342077358, -2.2260945160264773, 15.909660333630102, 17.244127467217833, 32.10544341635823, 3.4780403366459325, 33.72514231744596, 16.05044219724415, 10.199717011437615, 28.504329897036627, 5.733139579788596, 23.24885484716154, 1.1801896200234676, -2.6229290803265233, 11.141231657178597, 42.032340768768805, -0.7794889103457399, 20.390776655670898, 25.66248250731854, 17.7206602954072, -3.9428495704202255, 9.981870635930447, 33.35096304209417, 27.960450796386706, 7.721862817107057, 20.289685089817837, 5.6714835191478965, 0.3827130293325878, 38.24277817909911, 50.58544524004384, 14.17059625903685, 31.790862296946383, 28.1113881555113, 0.8946017781333877, 31.983802053579147, 26.396199351071726, -0.8251482182655803, 11.250525733366054, 31.67884658032376, 7.9270766596908135, 17.936384311885472, 27.96132087400686, 16.654296112446655, 5.411957926700129, 2.222865108835844, 24.702162829142658, 22.607693037838846, 11.987967273211133, 11.503500668912567, -2.959113021119541, 28.494987879449152, 6.725170150028537, 13.241858304028208, -16.121825940899942, 14.689063188091014, 9.038003546782948, 13.671037570206943, 2.455039031596576, 8.39688561530258, 23.100652611962058, 5.720387634149434, 17.695025688064106, 24.253691463703586, 21.47503654233178, -1.5970700181784165, 4.7830172214389615, 29.534853000057282, -0.710326172650932, 14.721866478777617, 24.597806813641835, 21.230410866522345, 5.862907076892769, 1.2216327071191921, 29.93051017064611, 10.699312209970007, 22.49567770011619, 10.263848657459594, 17.75009853660656, 5.446313747730916, 13.470935963433815, 25.267138849194644, 0.18139120665917652, 14.343197931240084], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.214615613201131, -15.734575212125932, 0.31602404069825374, -14.604025993936792, 2.5212199429841573, -34.73540699443333, -10.15234243922291, -25.459365950816906, -23.05745075390127, -16.03182641950851, -23.953186035254586, -28.25666992610532, -22.372622199997423, -5.887962701228119, -39.11557110059111, -2.434360664440172, -21.635209667370855, -15.040261342077407, 2.226094516026471, -15.90966033363006, -17.24412746721783, -32.10544341635817, -3.478040336645913, -33.725142317446, -16.05044219724414, -10.199717011437613, -28.504329897036605, -5.733139579788615, -23.24885484716154, -1.1801896200234658, 2.6229290803265233, -11.141231657178594, -42.03234076876879, 0.779488910345731, -20.39077665567091, -25.662482507318504, -17.7206602954072, 3.942849570420215, -9.98187063593043, -33.35096304209423, -27.960450796386628, -7.721862817107037, -20.289685089817837, -5.671483519147905, -0.3827130293325949, -38.24277817909913, -50.58544524004386, -14.17059625903686, -31.79086229694628, -28.11138815551128, -0.8946017781333513, -31.983802053579133, -26.396199351071715, 0.8251482182655918, -11.25052573336607, -31.678846580323732, -7.927076659690806, -17.93638431188549, -27.96132087400686, -16.654296112446637, -5.411957926700133, -2.222865108835843, -24.702162829142644, -22.607693037838807, -11.987967273211146, -11.503500668912562, 2.9591130211195456, -28.494987879449155, -6.725170150028487, -13.24185830402822, 16.121825940899946, -14.689063188091009, -9.03800354678297, -13.671037570207002, -2.455039031596576, -8.39688561530258, -23.10065261196208, -5.720387634149436, -17.695025688064128, -24.253691463703614, -21.475036542331804, 1.5970700181784152, -4.783017221438977, -29.534853000057307, 0.7103261726509418, -14.721866478777619, -24.59780681364185, -21.23041086652231, -5.8629070768927605, -1.221632707119178, -29.930510170646144, -10.699312209970008, -22.495677700116186, -10.263848657459594, -17.75009853660653, -5.4463137477309145, -13.47093596343383, -25.267138849194684, -0.1813912066591783, -14.343197931240132], "policy_predator_policy_reward": [-4.746244957996936, 13.17547618439917, 11.470303193882545, 19.99884723036932, 3.4667266265963814, -4.0987747079928845, 12.97315021656584, 16.234901771307726, 5.877339422755567, -10.919779308723882, 35.91608789504829, 33.55472609381842, 6.449511656171538, 13.855173222274262, 42.21016343121867, 8.708568470415152, 26.918700278173702, 19.196201229628898, 32.08882734468315, -0.02517450566615942, 20.440465499792495, 27.465906570716655, 14.252968641405763, 42.260371210804884, 12.702187411844974, 32.04305698814987, -8.558302126352178, 20.33422752880845, 36.73694417092153, 41.49419803026069, -14.83102509880186, 19.69974642768221, 28.97332699335729, 14.297092341384399, 10.628846204107054, 19.451676480047713, -11.667176628804334, 7.2149875967513815, 12.087850980364564, 19.731469686895565, 22.325032215472618, 12.163222718963048, 37.50721750950953, 26.70366932320687, -0.5703523935062016, 7.5264330667980435, 15.63264664156274, 51.817637993329264, 15.917750321258445, 16.18313407322984, 9.958543090083914, 10.440890932791305, 27.990445376322686, 29.018214417750517, -5.586854777710857, 17.053133937288067, 40.39283282845097, 6.10487686587215, -0.0782164091878812, 2.4385956492348058, -13.02590378594275, 7.780045625289704, -0.9822335092207122, 23.264696823577893, 52.22586715532497, 31.83881438221264, -7.545492946541325, 5.98651512584987, 28.71663709981944, 12.064916211522418, 30.60114134304118, 20.723823671595863, 3.252688307998947, 32.188632282815455, -0.4744718439916227, -7.411227296848818, 12.966247324169256, 6.997493947691616, 48.02253867658986, 18.679387407598533, 41.541904957399396, 14.378996635373877, 11.559776822612823, 3.8839488116012744, 33.281744496824594, 7.297625682811066, -0.9114563175755368, 12.254423355871358, 2.650855494477696, -1.8854294358125028, 29.518534936975307, 46.96702142122292, 49.17116944053242, 51.99972103955526, 0.05789314090111297, 28.283299377172575, 22.114178180520053, 41.4675464133726, 32.94920740046393, 23.27356891055866, -7.095781861389568, 8.884985417656281, 15.888231466322626, 48.07937264083567, 29.31764435020819, 23.474754351935232, -14.590988141576524, 12.940691705045346, 5.977736317253694, 16.523315149478446, 29.541956594934106, 33.81573656571341, 9.397213681297327, 6.456939638084291, 23.59047098397825, 12.282297639792704, 45.39619417994328, 10.526447568070397, 18.07827990517078, 15.230312319722533, 3.4541894915450726, 7.369726361855202, -2.2600084431539322, 6.705738660825606, 22.595746875376385, 26.80857878290891, 17.665077006106024, 27.55030906957161, 1.8721407106150263, 22.10379383580724, 13.754724675224768, 9.252276662600345, 11.062733866924427, -16.980959909163538, 35.94976362411582, 21.040212134782525, 1.3268979704244988, 12.123442329632518, 8.869383419000387, 17.61433318905606, -14.750170492237878, -17.49348138956201, 16.682474546980448, 12.69565182920152, 20.98858020637119, -2.912573112805285, 14.508450536612116, 12.833624603801805, -9.36337470546045, 14.273452768653652, 5.3897185741321, 11.404052656473048, 23.872563339131528, 22.328741884792638, -3.91267269667264, 15.353447964971497, 23.456872811594387, 11.933178564533847, 30.589140750749017, 17.91824217665816, 14.737222850731687, 28.212850233931896, -4.062604513835076, 0.8684644774782493, 3.6546330943693004, 5.9114013485086385, 43.42257541987044, 15.64713058024416, -2.34487735390163, 0.9242250085997572, 6.2445961377970285, 23.19913681975823, 36.55319285363454, 12.64242077364913, 3.3439571110602238, 39.1168646219844, 8.865303364970094, 2.8605107888154375, 6.380561305415345, -3.9372958911769773, 28.368622396536914, 31.492397944755353, 12.541944946546032, 8.85667947339399, 11.19440149172674, 33.79695390850566, 17.089410222420874, 3.4382870924983138, 20.54852851221675, 14.951668560996351, 1.868145025307352, 9.024482470154489, 12.976032378885721, 13.96583954798193, 33.09934980982034, 17.43492788856902, 3.004421849123826, -2.641639435805473, 11.48424558174625, 17.202150280733928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6419705002644701, "mean_inference_ms": 1.713744917306704, "mean_action_processing_ms": 0.2645314250931414, "mean_env_wait_ms": 0.1479063623105736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009694457054138184, "StateBufferConnector_ms": 0.003737330436706543, "ViewRequirementAgentConnector_ms": 0.1028667688369751}, "num_episodes": 23, "episode_return_max": 50.58544524004384, "episode_return_min": -16.121825940899942, "episode_return_mean": 15.325270002134332, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.422781555499, "num_env_steps_trained_throughput_per_sec": 421.422781555499, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 223432.681, "restore_workers_time_ms": 0.127, "training_step_time_ms": 223432.292, "sample_time_ms": 1284.0, "learn_time_ms": 222123.019, "learn_throughput": 18.008, "synch_weights_time_ms": 22.901}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "training_iteration": 69, "trial_id": "06536_00000", "date": "2024-08-11_17-22-48", "timestamp": 1723411368, "time_this_iter_s": 9.544113874435425, "time_total_s": 2911.786376953125, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2911.786376953125, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 37.738461538461536, "ram_util_percent": 81.11538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0450114945570625, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.032232631991307, "policy_loss": -0.009630895926966332, "vf_loss": 3.041837993140022, "vf_explained_var": 0.9176502265036106, "kl": 0.008173605890640808, "entropy": 0.6377171063174804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9378174789052793, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.073427004915066, "policy_loss": -0.0019545070521494066, "vf_loss": 3.0753815092106978, "vf_explained_var": 0.9353986510208675, "kl": 0.0036972804796989683, "entropy": 0.34299039181578095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 50.58544524004384, "episode_reward_min": -16.121825940899942, "episode_reward_mean": 15.8048018300565, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58544524004386, "predator_policy": -17.49348138956201}, "policy_reward_max": {"prey_policy": 16.121825940899946, "predator_policy": 52.22586715532497}, "policy_reward_mean": {"prey_policy": -15.804801830056498, "predator_policy": 15.8048018300565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2260945160264773, 15.909660333630102, 17.244127467217833, 32.10544341635823, 3.4780403366459325, 33.72514231744596, 16.05044219724415, 10.199717011437615, 28.504329897036627, 5.733139579788596, 23.24885484716154, 1.1801896200234676, -2.6229290803265233, 11.141231657178597, 42.032340768768805, -0.7794889103457399, 20.390776655670898, 25.66248250731854, 17.7206602954072, -3.9428495704202255, 9.981870635930447, 33.35096304209417, 27.960450796386706, 7.721862817107057, 20.289685089817837, 5.6714835191478965, 0.3827130293325878, 38.24277817909911, 50.58544524004384, 14.17059625903685, 31.790862296946383, 28.1113881555113, 0.8946017781333877, 31.983802053579147, 26.396199351071726, -0.8251482182655803, 11.250525733366054, 31.67884658032376, 7.9270766596908135, 17.936384311885472, 27.96132087400686, 16.654296112446655, 5.411957926700129, 2.222865108835844, 24.702162829142658, 22.607693037838846, 11.987967273211133, 11.503500668912567, -2.959113021119541, 28.494987879449152, 6.725170150028537, 13.241858304028208, -16.121825940899942, 14.689063188091014, 9.038003546782948, 13.671037570206943, 2.455039031596576, 8.39688561530258, 23.100652611962058, 5.720387634149434, 17.695025688064106, 24.253691463703586, 21.47503654233178, -1.5970700181784165, 4.7830172214389615, 29.534853000057282, -0.710326172650932, 14.721866478777617, 24.597806813641835, 21.230410866522345, 5.862907076892769, 1.2216327071191921, 29.93051017064611, 10.699312209970007, 22.49567770011619, 10.263848657459594, 17.75009853660656, 5.446313747730916, 13.470935963433815, 25.267138849194644, 0.18139120665917652, 14.343197931240084, 8.768831710066774, 36.42615414324183, 4.759057778255453, 17.574477263060377, 14.879335223849923, 44.42679407869568, 27.93513405785759, 0.6614747030789268, 3.548978422593075, 27.818675967280416, 19.529946042299912, 33.65280803188479, 26.097069146356297, 29.440653080969263, 5.8392978847478325, 15.100749016935751, 12.391665687073774, 18.95028958449844], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.226094516026471, -15.90966033363006, -17.24412746721783, -32.10544341635817, -3.478040336645913, -33.725142317446, -16.05044219724414, -10.199717011437613, -28.504329897036605, -5.733139579788615, -23.24885484716154, -1.1801896200234658, 2.6229290803265233, -11.141231657178594, -42.03234076876879, 0.779488910345731, -20.39077665567091, -25.662482507318504, -17.7206602954072, 3.942849570420215, -9.98187063593043, -33.35096304209423, -27.960450796386628, -7.721862817107037, -20.289685089817837, -5.671483519147905, -0.3827130293325949, -38.24277817909913, -50.58544524004386, -14.17059625903686, -31.79086229694628, -28.11138815551128, -0.8946017781333513, -31.983802053579133, -26.396199351071715, 0.8251482182655918, -11.25052573336607, -31.678846580323732, -7.927076659690806, -17.93638431188549, -27.96132087400686, -16.654296112446637, -5.411957926700133, -2.222865108835843, -24.702162829142644, -22.607693037838807, -11.987967273211146, -11.503500668912562, 2.9591130211195456, -28.494987879449155, -6.725170150028487, -13.24185830402822, 16.121825940899946, -14.689063188091009, -9.03800354678297, -13.671037570207002, -2.455039031596576, -8.39688561530258, -23.10065261196208, -5.720387634149436, -17.695025688064128, -24.253691463703614, -21.475036542331804, 1.5970700181784152, -4.783017221438977, -29.534853000057307, 0.7103261726509418, -14.721866478777619, -24.59780681364185, -21.23041086652231, -5.8629070768927605, -1.221632707119178, -29.930510170646144, -10.699312209970008, -22.495677700116186, -10.263848657459594, -17.75009853660653, -5.4463137477309145, -13.47093596343383, -25.267138849194684, -0.1813912066591783, -14.343197931240132, -8.768831710066772, -36.42615414324183, -4.759057778255462, -17.574477263060373, -14.879335223849926, -44.42679407869572, -27.935134057857567, -0.6614747030789272, -3.548978422593084, -27.81867596728043, -19.529946042299922, -33.65280803188477, -26.097069146356247, -29.440653080969224, -5.839297884747847, -15.100749016935719, -12.3916656870738, -18.950289584498442], "policy_predator_policy_reward": [-11.667176628804334, 7.2149875967513815, 12.087850980364564, 19.731469686895565, 22.325032215472618, 12.163222718963048, 37.50721750950953, 26.70366932320687, -0.5703523935062016, 7.5264330667980435, 15.63264664156274, 51.817637993329264, 15.917750321258445, 16.18313407322984, 9.958543090083914, 10.440890932791305, 27.990445376322686, 29.018214417750517, -5.586854777710857, 17.053133937288067, 40.39283282845097, 6.10487686587215, -0.0782164091878812, 2.4385956492348058, -13.02590378594275, 7.780045625289704, -0.9822335092207122, 23.264696823577893, 52.22586715532497, 31.83881438221264, -7.545492946541325, 5.98651512584987, 28.71663709981944, 12.064916211522418, 30.60114134304118, 20.723823671595863, 3.252688307998947, 32.188632282815455, -0.4744718439916227, -7.411227296848818, 12.966247324169256, 6.997493947691616, 48.02253867658986, 18.679387407598533, 41.541904957399396, 14.378996635373877, 11.559776822612823, 3.8839488116012744, 33.281744496824594, 7.297625682811066, -0.9114563175755368, 12.254423355871358, 2.650855494477696, -1.8854294358125028, 29.518534936975307, 46.96702142122292, 49.17116944053242, 51.99972103955526, 0.05789314090111297, 28.283299377172575, 22.114178180520053, 41.4675464133726, 32.94920740046393, 23.27356891055866, -7.095781861389568, 8.884985417656281, 15.888231466322626, 48.07937264083567, 29.31764435020819, 23.474754351935232, -14.590988141576524, 12.940691705045346, 5.977736317253694, 16.523315149478446, 29.541956594934106, 33.81573656571341, 9.397213681297327, 6.456939638084291, 23.59047098397825, 12.282297639792704, 45.39619417994328, 10.526447568070397, 18.07827990517078, 15.230312319722533, 3.4541894915450726, 7.369726361855202, -2.2600084431539322, 6.705738660825606, 22.595746875376385, 26.80857878290891, 17.665077006106024, 27.55030906957161, 1.8721407106150263, 22.10379383580724, 13.754724675224768, 9.252276662600345, 11.062733866924427, -16.980959909163538, 35.94976362411582, 21.040212134782525, 1.3268979704244988, 12.123442329632518, 8.869383419000387, 17.61433318905606, -14.750170492237878, -17.49348138956201, 16.682474546980448, 12.69565182920152, 20.98858020637119, -2.912573112805285, 14.508450536612116, 12.833624603801805, -9.36337470546045, 14.273452768653652, 5.3897185741321, 11.404052656473048, 23.872563339131528, 22.328741884792638, -3.91267269667264, 15.353447964971497, 23.456872811594387, 11.933178564533847, 30.589140750749017, 17.91824217665816, 14.737222850731687, 28.212850233931896, -4.062604513835076, 0.8684644774782493, 3.6546330943693004, 5.9114013485086385, 43.42257541987044, 15.64713058024416, -2.34487735390163, 0.9242250085997572, 6.2445961377970285, 23.19913681975823, 36.55319285363454, 12.64242077364913, 3.3439571110602238, 39.1168646219844, 8.865303364970094, 2.8605107888154375, 6.380561305415345, -3.9372958911769773, 28.368622396536914, 31.492397944755353, 12.541944946546032, 8.85667947339399, 11.19440149172674, 33.79695390850566, 17.089410222420874, 3.4382870924983138, 20.54852851221675, 14.951668560996351, 1.868145025307352, 9.024482470154489, 12.976032378885721, 13.96583954798193, 33.09934980982034, 17.43492788856902, 3.004421849123826, -2.641639435805473, 11.48424558174625, 17.202150280733928, 10.13867121038872, 7.398992209744826, 30.653859125136496, 42.19844916134714, 9.716563492882822, -0.19844793637190605, 16.58559671494135, 18.56335781117941, 18.449194562267046, 11.30947588543281, 49.77959051175541, 39.07399764563605, 32.64849243784292, 23.221775677872248, 3.4660750923026242, -2.143125686144769, -12.3474724826461, 19.445429327832294, 17.521056735357227, 38.116295199203634, 42.26596850021169, -3.206076415611801, 39.91596301696632, 27.389653046803204, 28.180709832372514, 24.01342846034001, 47.85873330068307, 11.022572861255373, -7.1357728650970635, 18.814368634592743, 17.669324737711623, 12.532173296159836, 11.426702798484623, 13.356628575662945, 19.31488618702215, 18.585692981974734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6396134626437012, "mean_inference_ms": 1.7063156910690076, "mean_action_processing_ms": 0.2634778466404172, "mean_env_wait_ms": 0.14725713464229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009970545768737793, "StateBufferConnector_ms": 0.00393831729888916, "ViewRequirementAgentConnector_ms": 0.10542440414428711}, "num_episodes": 18, "episode_return_max": 50.58544524004384, "episode_return_min": -16.121825940899942, "episode_return_mean": 15.8048018300565, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.77269344182923, "num_env_steps_trained_throughput_per_sec": 426.77269344182923, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 223110.556, "restore_workers_time_ms": 0.128, "training_step_time_ms": 223110.056, "sample_time_ms": 1268.447, "learn_time_ms": 221820.65, "learn_throughput": 18.033, "synch_weights_time_ms": 18.772}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 70, "trial_id": "06536_00000", "date": "2024-08-11_17-22-58", "timestamp": 1723411378, "time_this_iter_s": 9.421305894851685, "time_total_s": 2921.2076828479767, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33175df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2921.2076828479767, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 44.73571428571428, "ram_util_percent": 82.19285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4319465164095164, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8628947839140892, "policy_loss": -0.006020622316767307, "vf_loss": 1.8688841423640647, "vf_explained_var": 0.9498609153553843, "kl": 0.010003937646490293, "entropy": 0.6311476045598586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6989952189581734, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.083443756772097, "policy_loss": -0.002701890047161628, "vf_loss": 2.0861456477452838, "vf_explained_var": 0.9546625195041535, "kl": 0.003932384009745296, "entropy": 0.36696065505030295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "env_runners": {"episode_reward_max": 50.58544524004384, "episode_reward_min": -16.121825940899942, "episode_reward_mean": 15.11586452866236, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.58544524004386, "predator_policy": -17.49348138956201}, "policy_reward_max": {"prey_policy": 16.121825940899946, "predator_policy": 51.99972103955526}, "policy_reward_mean": {"prey_policy": -15.115864528662357, "predator_policy": 15.11586452866236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.7206602954072, -3.9428495704202255, 9.981870635930447, 33.35096304209417, 27.960450796386706, 7.721862817107057, 20.289685089817837, 5.6714835191478965, 0.3827130293325878, 38.24277817909911, 50.58544524004384, 14.17059625903685, 31.790862296946383, 28.1113881555113, 0.8946017781333877, 31.983802053579147, 26.396199351071726, -0.8251482182655803, 11.250525733366054, 31.67884658032376, 7.9270766596908135, 17.936384311885472, 27.96132087400686, 16.654296112446655, 5.411957926700129, 2.222865108835844, 24.702162829142658, 22.607693037838846, 11.987967273211133, 11.503500668912567, -2.959113021119541, 28.494987879449152, 6.725170150028537, 13.241858304028208, -16.121825940899942, 14.689063188091014, 9.038003546782948, 13.671037570206943, 2.455039031596576, 8.39688561530258, 23.100652611962058, 5.720387634149434, 17.695025688064106, 24.253691463703586, 21.47503654233178, -1.5970700181784165, 4.7830172214389615, 29.534853000057282, -0.710326172650932, 14.721866478777617, 24.597806813641835, 21.230410866522345, 5.862907076892769, 1.2216327071191921, 29.93051017064611, 10.699312209970007, 22.49567770011619, 10.263848657459594, 17.75009853660656, 5.446313747730916, 13.470935963433815, 25.267138849194644, 0.18139120665917652, 14.343197931240084, 8.768831710066774, 36.42615414324183, 4.759057778255453, 17.574477263060377, 14.879335223849923, 44.42679407869568, 27.93513405785759, 0.6614747030789268, 3.548978422593075, 27.818675967280416, 19.529946042299912, 33.65280803188479, 26.097069146356297, 29.440653080969263, 5.8392978847478325, 15.100749016935751, 12.391665687073774, 18.95028958449844, 16.52951506062397, 16.197425027325536, 13.32896707686252, 1.4259453981311436, 12.162531390365197, -5.599169290892348, 14.647364839897001, 26.28820931708214, 27.46280903448062, 22.352884757875838, 7.189920775412882, 7.96832273306687, 7.826581048735013, 2.102050725910365, 8.139107552600816, 5.266901363308342, 5.934591816471323, 22.859717339556862], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.7206602954072, 3.942849570420215, -9.98187063593043, -33.35096304209423, -27.960450796386628, -7.721862817107037, -20.289685089817837, -5.671483519147905, -0.3827130293325949, -38.24277817909913, -50.58544524004386, -14.17059625903686, -31.79086229694628, -28.11138815551128, -0.8946017781333513, -31.983802053579133, -26.396199351071715, 0.8251482182655918, -11.25052573336607, -31.678846580323732, -7.927076659690806, -17.93638431188549, -27.96132087400686, -16.654296112446637, -5.411957926700133, -2.222865108835843, -24.702162829142644, -22.607693037838807, -11.987967273211146, -11.503500668912562, 2.9591130211195456, -28.494987879449155, -6.725170150028487, -13.24185830402822, 16.121825940899946, -14.689063188091009, -9.03800354678297, -13.671037570207002, -2.455039031596576, -8.39688561530258, -23.10065261196208, -5.720387634149436, -17.695025688064128, -24.253691463703614, -21.475036542331804, 1.5970700181784152, -4.783017221438977, -29.534853000057307, 0.7103261726509418, -14.721866478777619, -24.59780681364185, -21.23041086652231, -5.8629070768927605, -1.221632707119178, -29.930510170646144, -10.699312209970008, -22.495677700116186, -10.263848657459594, -17.75009853660653, -5.4463137477309145, -13.47093596343383, -25.267138849194684, -0.1813912066591783, -14.343197931240132, -8.768831710066772, -36.42615414324183, -4.759057778255462, -17.574477263060373, -14.879335223849926, -44.42679407869572, -27.935134057857567, -0.6614747030789272, -3.548978422593084, -27.81867596728043, -19.529946042299922, -33.65280803188477, -26.097069146356247, -29.440653080969224, -5.839297884747847, -15.100749016935719, -12.3916656870738, -18.950289584498442, -16.529515060623947, -16.19742502732555, -13.32896707686251, -1.4259453981311134, -12.162531390365189, 5.59916929089235, -14.647364839896998, -26.288209317082117, -27.462809034480642, -22.352884757875827, -7.189920775412863, -7.968322733066871, -7.826581048735047, -2.102050725910348, -8.139107552600823, -5.266901363308346, -5.9345918164713165, -22.859717339556855], "policy_predator_policy_reward": [3.252688307998947, 32.188632282815455, -0.4744718439916227, -7.411227296848818, 12.966247324169256, 6.997493947691616, 48.02253867658986, 18.679387407598533, 41.541904957399396, 14.378996635373877, 11.559776822612823, 3.8839488116012744, 33.281744496824594, 7.297625682811066, -0.9114563175755368, 12.254423355871358, 2.650855494477696, -1.8854294358125028, 29.518534936975307, 46.96702142122292, 49.17116944053242, 51.99972103955526, 0.05789314090111297, 28.283299377172575, 22.114178180520053, 41.4675464133726, 32.94920740046393, 23.27356891055866, -7.095781861389568, 8.884985417656281, 15.888231466322626, 48.07937264083567, 29.31764435020819, 23.474754351935232, -14.590988141576524, 12.940691705045346, 5.977736317253694, 16.523315149478446, 29.541956594934106, 33.81573656571341, 9.397213681297327, 6.456939638084291, 23.59047098397825, 12.282297639792704, 45.39619417994328, 10.526447568070397, 18.07827990517078, 15.230312319722533, 3.4541894915450726, 7.369726361855202, -2.2600084431539322, 6.705738660825606, 22.595746875376385, 26.80857878290891, 17.665077006106024, 27.55030906957161, 1.8721407106150263, 22.10379383580724, 13.754724675224768, 9.252276662600345, 11.062733866924427, -16.980959909163538, 35.94976362411582, 21.040212134782525, 1.3268979704244988, 12.123442329632518, 8.869383419000387, 17.61433318905606, -14.750170492237878, -17.49348138956201, 16.682474546980448, 12.69565182920152, 20.98858020637119, -2.912573112805285, 14.508450536612116, 12.833624603801805, -9.36337470546045, 14.273452768653652, 5.3897185741321, 11.404052656473048, 23.872563339131528, 22.328741884792638, -3.91267269667264, 15.353447964971497, 23.456872811594387, 11.933178564533847, 30.589140750749017, 17.91824217665816, 14.737222850731687, 28.212850233931896, -4.062604513835076, 0.8684644774782493, 3.6546330943693004, 5.9114013485086385, 43.42257541987044, 15.64713058024416, -2.34487735390163, 0.9242250085997572, 6.2445961377970285, 23.19913681975823, 36.55319285363454, 12.64242077364913, 3.3439571110602238, 39.1168646219844, 8.865303364970094, 2.8605107888154375, 6.380561305415345, -3.9372958911769773, 28.368622396536914, 31.492397944755353, 12.541944946546032, 8.85667947339399, 11.19440149172674, 33.79695390850566, 17.089410222420874, 3.4382870924983138, 20.54852851221675, 14.951668560996351, 1.868145025307352, 9.024482470154489, 12.976032378885721, 13.96583954798193, 33.09934980982034, 17.43492788856902, 3.004421849123826, -2.641639435805473, 11.48424558174625, 17.202150280733928, 10.13867121038872, 7.398992209744826, 30.653859125136496, 42.19844916134714, 9.716563492882822, -0.19844793637190605, 16.58559671494135, 18.56335781117941, 18.449194562267046, 11.30947588543281, 49.77959051175541, 39.07399764563605, 32.64849243784292, 23.221775677872248, 3.4660750923026242, -2.143125686144769, -12.3474724826461, 19.445429327832294, 17.521056735357227, 38.116295199203634, 42.26596850021169, -3.206076415611801, 39.91596301696632, 27.389653046803204, 28.180709832372514, 24.01342846034001, 47.85873330068307, 11.022572861255373, -7.1357728650970635, 18.814368634592743, 17.669324737711623, 12.532173296159836, 11.426702798484623, 13.356628575662945, 19.31488618702215, 18.585692981974734, 26.427014337071412, 6.632015784176502, 1.304390870705813, 31.09045918394526, 15.967380154224948, 10.690553999500116, 3.4657127689147913, -0.6138219726525662, 19.910800589127795, 4.414262191602589, -8.816986784016237, -2.3813517977684633, 2.052772425795961, 27.241957253998038, 39.37421914815188, 13.202199486012308, 37.70296957869552, 17.222648490265712, 31.85726720176571, 12.848502313985955, 6.566725151083519, 7.813116399742219, 19.79469193366227, -3.8580464675285473, 1.9350847386437575, 13.71807735882631, 7.848335055063934, -3.6442336032432063, 9.57772383471095, 6.700491270490692, 13.642494396923205, -3.1086916703064738, 13.741772284241218, -1.8725886512985888, 34.58571170553837, 11.133722973575322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6373463204362485, "mean_inference_ms": 1.6992075036324257, "mean_action_processing_ms": 0.2624643456265359, "mean_env_wait_ms": 0.146639015346253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010330557823181152, "StateBufferConnector_ms": 0.0039435625076293945, "ViewRequirementAgentConnector_ms": 0.10665082931518555}, "num_episodes": 18, "episode_return_max": 50.58544524004384, "episode_return_min": -16.121825940899942, "episode_return_mean": 15.11586452866236, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.73435144199823, "num_env_steps_trained_throughput_per_sec": 450.73435144199823, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 222502.112, "restore_workers_time_ms": 0.126, "training_step_time_ms": 222501.617, "sample_time_ms": 1248.469, "learn_time_ms": 221232.191, "learn_throughput": 18.081, "synch_weights_time_ms": 18.793}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "training_iteration": 71, "trial_id": "06536_00000", "date": "2024-08-11_17-23-07", "timestamp": 1723411387, "time_this_iter_s": 8.878628730773926, "time_total_s": 2930.0863115787506, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310edd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2930.0863115787506, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 34.00833333333333, "ram_util_percent": 82.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.857260886828105, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2371942948549988, "policy_loss": -0.008113366312560781, "vf_loss": 2.2452798270930847, "vf_explained_var": 0.9480729722728332, "kl": 0.008904582924349806, "entropy": 0.5813821835443378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7321005502075115, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.235188920851107, "policy_loss": -0.000962401378318352, "vf_loss": 2.236151320530624, "vf_explained_var": 0.9587553801044585, "kl": 0.0032671860251820527, "entropy": 0.31935239695998097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 44.42679407869568, "episode_reward_min": -16.121825940899942, "episode_reward_mean": 14.432334012837073, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.42679407869572, "predator_policy": -17.49348138956201}, "policy_reward_max": {"prey_policy": 16.121825940899946, "predator_policy": 49.77959051175541}, "policy_reward_mean": {"prey_policy": -14.432334012837078, "predator_policy": 14.432334012837078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.96132087400686, 16.654296112446655, 5.411957926700129, 2.222865108835844, 24.702162829142658, 22.607693037838846, 11.987967273211133, 11.503500668912567, -2.959113021119541, 28.494987879449152, 6.725170150028537, 13.241858304028208, -16.121825940899942, 14.689063188091014, 9.038003546782948, 13.671037570206943, 2.455039031596576, 8.39688561530258, 23.100652611962058, 5.720387634149434, 17.695025688064106, 24.253691463703586, 21.47503654233178, -1.5970700181784165, 4.7830172214389615, 29.534853000057282, -0.710326172650932, 14.721866478777617, 24.597806813641835, 21.230410866522345, 5.862907076892769, 1.2216327071191921, 29.93051017064611, 10.699312209970007, 22.49567770011619, 10.263848657459594, 17.75009853660656, 5.446313747730916, 13.470935963433815, 25.267138849194644, 0.18139120665917652, 14.343197931240084, 8.768831710066774, 36.42615414324183, 4.759057778255453, 17.574477263060377, 14.879335223849923, 44.42679407869568, 27.93513405785759, 0.6614747030789268, 3.548978422593075, 27.818675967280416, 19.529946042299912, 33.65280803188479, 26.097069146356297, 29.440653080969263, 5.8392978847478325, 15.100749016935751, 12.391665687073774, 18.95028958449844, 16.52951506062397, 16.197425027325536, 13.32896707686252, 1.4259453981311436, 12.162531390365197, -5.599169290892348, 14.647364839897001, 26.28820931708214, 27.46280903448062, 22.352884757875838, 7.189920775412882, 7.96832273306687, 7.826581048735013, 2.102050725910365, 8.139107552600816, 5.266901363308342, 5.934591816471323, 22.859717339556862, 40.19941091498166, 22.524962693179017, 2.5202446212745624, 12.13953922909819, 14.920810240862965, 16.725901584773574, 4.755016475331177, 20.925026030966354, -2.388427562612013, 8.960613036223117, 26.60104689590017, 26.95040546621818, 0.9684677978865519, 23.892878676097478, 19.16588160250677, 12.097941240872265, 14.196248549756778, 22.198279209898526, 23.161039408790028, 9.853829581317417, 8.941550245658492, 11.616480513716393], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.96132087400686, -16.654296112446637, -5.411957926700133, -2.222865108835843, -24.702162829142644, -22.607693037838807, -11.987967273211146, -11.503500668912562, 2.9591130211195456, -28.494987879449155, -6.725170150028487, -13.24185830402822, 16.121825940899946, -14.689063188091009, -9.03800354678297, -13.671037570207002, -2.455039031596576, -8.39688561530258, -23.10065261196208, -5.720387634149436, -17.695025688064128, -24.253691463703614, -21.475036542331804, 1.5970700181784152, -4.783017221438977, -29.534853000057307, 0.7103261726509418, -14.721866478777619, -24.59780681364185, -21.23041086652231, -5.8629070768927605, -1.221632707119178, -29.930510170646144, -10.699312209970008, -22.495677700116186, -10.263848657459594, -17.75009853660653, -5.4463137477309145, -13.47093596343383, -25.267138849194684, -0.1813912066591783, -14.343197931240132, -8.768831710066772, -36.42615414324183, -4.759057778255462, -17.574477263060373, -14.879335223849926, -44.42679407869572, -27.935134057857567, -0.6614747030789272, -3.548978422593084, -27.81867596728043, -19.529946042299922, -33.65280803188477, -26.097069146356247, -29.440653080969224, -5.839297884747847, -15.100749016935719, -12.3916656870738, -18.950289584498442, -16.529515060623947, -16.19742502732555, -13.32896707686251, -1.4259453981311134, -12.162531390365189, 5.59916929089235, -14.647364839896998, -26.288209317082117, -27.462809034480642, -22.352884757875827, -7.189920775412863, -7.968322733066871, -7.826581048735047, -2.102050725910348, -8.139107552600823, -5.266901363308346, -5.9345918164713165, -22.859717339556855, -40.199410914981584, -22.524962693179063, -2.5202446212745633, -12.139539229098206, -14.920810240862977, -16.725901584773524, -4.755016475331208, -20.925026030966357, 2.388427562612013, -8.960613036223155, -26.601046895900176, -26.950405466218164, -0.9684677978865857, -23.892878676097467, -19.165881602506765, -12.097941240872299, -14.196248549756781, -22.198279209898566, -23.16103940879005, -9.853829581317418, -8.941550245658483, -11.61648051371634], "policy_predator_policy_reward": [45.39619417994328, 10.526447568070397, 18.07827990517078, 15.230312319722533, 3.4541894915450726, 7.369726361855202, -2.2600084431539322, 6.705738660825606, 22.595746875376385, 26.80857878290891, 17.665077006106024, 27.55030906957161, 1.8721407106150263, 22.10379383580724, 13.754724675224768, 9.252276662600345, 11.062733866924427, -16.980959909163538, 35.94976362411582, 21.040212134782525, 1.3268979704244988, 12.123442329632518, 8.869383419000387, 17.61433318905606, -14.750170492237878, -17.49348138956201, 16.682474546980448, 12.69565182920152, 20.98858020637119, -2.912573112805285, 14.508450536612116, 12.833624603801805, -9.36337470546045, 14.273452768653652, 5.3897185741321, 11.404052656473048, 23.872563339131528, 22.328741884792638, -3.91267269667264, 15.353447964971497, 23.456872811594387, 11.933178564533847, 30.589140750749017, 17.91824217665816, 14.737222850731687, 28.212850233931896, -4.062604513835076, 0.8684644774782493, 3.6546330943693004, 5.9114013485086385, 43.42257541987044, 15.64713058024416, -2.34487735390163, 0.9242250085997572, 6.2445961377970285, 23.19913681975823, 36.55319285363454, 12.64242077364913, 3.3439571110602238, 39.1168646219844, 8.865303364970094, 2.8605107888154375, 6.380561305415345, -3.9372958911769773, 28.368622396536914, 31.492397944755353, 12.541944946546032, 8.85667947339399, 11.19440149172674, 33.79695390850566, 17.089410222420874, 3.4382870924983138, 20.54852851221675, 14.951668560996351, 1.868145025307352, 9.024482470154489, 12.976032378885721, 13.96583954798193, 33.09934980982034, 17.43492788856902, 3.004421849123826, -2.641639435805473, 11.48424558174625, 17.202150280733928, 10.13867121038872, 7.398992209744826, 30.653859125136496, 42.19844916134714, 9.716563492882822, -0.19844793637190605, 16.58559671494135, 18.56335781117941, 18.449194562267046, 11.30947588543281, 49.77959051175541, 39.07399764563605, 32.64849243784292, 23.221775677872248, 3.4660750923026242, -2.143125686144769, -12.3474724826461, 19.445429327832294, 17.521056735357227, 38.116295199203634, 42.26596850021169, -3.206076415611801, 39.91596301696632, 27.389653046803204, 28.180709832372514, 24.01342846034001, 47.85873330068307, 11.022572861255373, -7.1357728650970635, 18.814368634592743, 17.669324737711623, 12.532173296159836, 11.426702798484623, 13.356628575662945, 19.31488618702215, 18.585692981974734, 26.427014337071412, 6.632015784176502, 1.304390870705813, 31.09045918394526, 15.967380154224948, 10.690553999500116, 3.4657127689147913, -0.6138219726525662, 19.910800589127795, 4.414262191602589, -8.816986784016237, -2.3813517977684633, 2.052772425795961, 27.241957253998038, 39.37421914815188, 13.202199486012308, 37.70296957869552, 17.222648490265712, 31.85726720176571, 12.848502313985955, 6.566725151083519, 7.813116399742219, 19.79469193366227, -3.8580464675285473, 1.9350847386437575, 13.71807735882631, 7.848335055063934, -3.6442336032432063, 9.57772383471095, 6.700491270490692, 13.642494396923205, -3.1086916703064738, 13.741772284241218, -1.8725886512985888, 34.58571170553837, 11.133722973575322, 44.442015539810804, 35.956806290152485, 12.748602248934818, 32.301323137423246, 5.722687574124205, -0.682198331575055, 9.268878713778951, 15.010199744417452, 13.04261644432983, 16.799004037396106, 3.2692431887468434, 30.18255998080025, -2.389520361257796, 11.899553311920208, 17.946464382238844, 23.903587679693857, -5.030169745048777, 0.2533146198247511, 8.242216871419844, 9.67900920102644, 16.78582186612146, 36.416271925678956, 33.43923283676065, 20.461578095675698, 11.89858649990213, -9.96165090412902, 21.1074034165326, 26.678353935662383, 18.041664131618226, 20.290099073395353, 8.09434931331329, 16.101533168431295, 18.196957993791294, 10.195539105722258, 21.96953835497404, 22.42702006482303, 16.430401601235413, 29.891677216344668, 16.72582042472142, 2.9818387379134563, 8.046468236734075, 9.836632254582899, 18.997545961691088, 4.235415065741616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6345003518333583, "mean_inference_ms": 1.6904458457825564, "mean_action_processing_ms": 0.26123327926926526, "mean_env_wait_ms": 0.14587621382130617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986623764038086, "StateBufferConnector_ms": 0.0038830041885375977, "ViewRequirementAgentConnector_ms": 0.10226213932037354}, "num_episodes": 22, "episode_return_max": 44.42679407869568, "episode_return_min": -16.121825940899942, "episode_return_mean": 14.432334012837073, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.38124644922783, "num_env_steps_trained_throughput_per_sec": 473.38124644922783, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 221915.603, "restore_workers_time_ms": 0.126, "training_step_time_ms": 221915.109, "sample_time_ms": 1137.345, "learn_time_ms": 220757.219, "learn_throughput": 18.119, "synch_weights_time_ms": 18.451}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 72, "trial_id": "06536_00000", "date": "2024-08-11_17-23-15", "timestamp": 1723411395, "time_this_iter_s": 8.452632188796997, "time_total_s": 2938.5389437675476, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2938.5389437675476, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 28.125000000000004, "ram_util_percent": 82.15833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5842680828024944, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.560412819807728, "policy_loss": -0.007507599905026533, "vf_loss": 1.5678921521330873, "vf_explained_var": 0.9614910385881861, "kl": 0.009044595131967193, "entropy": 0.6361616314078371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5988752569471085, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7313743120148068, "policy_loss": -0.0025330929780408504, "vf_loss": 1.7339074045892746, "vf_explained_var": 0.9633101838291007, "kl": 0.004026077561120037, "entropy": 0.3123802470388236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "env_runners": {"episode_reward_max": 44.42679407869568, "episode_reward_min": -5.849446383074039, "episode_reward_mean": 15.246184294513252, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.42679407869572, "predator_policy": -15.046649198151787}, "policy_reward_max": {"prey_policy": 5.849446383074034, "predator_policy": 49.77959051175541}, "policy_reward_mean": {"prey_policy": -15.246184294513254, "predator_policy": 15.246184294513254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5970700181784165, 4.7830172214389615, 29.534853000057282, -0.710326172650932, 14.721866478777617, 24.597806813641835, 21.230410866522345, 5.862907076892769, 1.2216327071191921, 29.93051017064611, 10.699312209970007, 22.49567770011619, 10.263848657459594, 17.75009853660656, 5.446313747730916, 13.470935963433815, 25.267138849194644, 0.18139120665917652, 14.343197931240084, 8.768831710066774, 36.42615414324183, 4.759057778255453, 17.574477263060377, 14.879335223849923, 44.42679407869568, 27.93513405785759, 0.6614747030789268, 3.548978422593075, 27.818675967280416, 19.529946042299912, 33.65280803188479, 26.097069146356297, 29.440653080969263, 5.8392978847478325, 15.100749016935751, 12.391665687073774, 18.95028958449844, 16.52951506062397, 16.197425027325536, 13.32896707686252, 1.4259453981311436, 12.162531390365197, -5.599169290892348, 14.647364839897001, 26.28820931708214, 27.46280903448062, 22.352884757875838, 7.189920775412882, 7.96832273306687, 7.826581048735013, 2.102050725910365, 8.139107552600816, 5.266901363308342, 5.934591816471323, 22.859717339556862, 40.19941091498166, 22.524962693179017, 2.5202446212745624, 12.13953922909819, 14.920810240862965, 16.725901584773574, 4.755016475331177, 20.925026030966354, -2.388427562612013, 8.960613036223117, 26.60104689590017, 26.95040546621818, 0.9684677978865519, 23.892878676097478, 19.16588160250677, 12.097941240872265, 14.196248549756778, 22.198279209898526, 23.161039408790028, 9.853829581317417, 8.941550245658492, 11.616480513716393, 23.814032153323545, -4.486698701149917, 39.56563071747245, 18.6550338070069, 6.263033233121293, 10.627565584883463, 32.58114000643688, 11.65871213919765, -5.849446383074039, 17.015655937978, 11.076588524323817, 9.148314249834618, 13.728523712181856, 39.834835871958326, 8.911055402987083, 17.35726626457654, 30.821567705006895, 23.698304217724772, 21.727413138414644, 14.836724618831063, 22.33297672944005, 4.082429076305876, 6.912034255607725], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.5970700181784152, -4.783017221438977, -29.534853000057307, 0.7103261726509418, -14.721866478777619, -24.59780681364185, -21.23041086652231, -5.8629070768927605, -1.221632707119178, -29.930510170646144, -10.699312209970008, -22.495677700116186, -10.263848657459594, -17.75009853660653, -5.4463137477309145, -13.47093596343383, -25.267138849194684, -0.1813912066591783, -14.343197931240132, -8.768831710066772, -36.42615414324183, -4.759057778255462, -17.574477263060373, -14.879335223849926, -44.42679407869572, -27.935134057857567, -0.6614747030789272, -3.548978422593084, -27.81867596728043, -19.529946042299922, -33.65280803188477, -26.097069146356247, -29.440653080969224, -5.839297884747847, -15.100749016935719, -12.3916656870738, -18.950289584498442, -16.529515060623947, -16.19742502732555, -13.32896707686251, -1.4259453981311134, -12.162531390365189, 5.59916929089235, -14.647364839896998, -26.288209317082117, -27.462809034480642, -22.352884757875827, -7.189920775412863, -7.968322733066871, -7.826581048735047, -2.102050725910348, -8.139107552600823, -5.266901363308346, -5.9345918164713165, -22.859717339556855, -40.199410914981584, -22.524962693179063, -2.5202446212745633, -12.139539229098206, -14.920810240862977, -16.725901584773524, -4.755016475331208, -20.925026030966357, 2.388427562612013, -8.960613036223155, -26.601046895900176, -26.950405466218164, -0.9684677978865857, -23.892878676097467, -19.165881602506765, -12.097941240872299, -14.196248549756781, -22.198279209898566, -23.16103940879005, -9.853829581317418, -8.941550245658483, -11.61648051371634, -23.81403215332355, 4.48669870114992, -39.565630717472466, -18.65503380700693, -6.2630332331212735, -10.627565584883452, -32.581140006436875, -11.658712139197634, 5.849446383074034, -17.01565593797806, -11.076588524323801, -9.148314249834606, -13.728523712181854, -39.83483587195839, -8.911055402987092, -17.357266264576577, -30.821567705006892, -23.698304217724754, -21.72741313841465, -14.836724618831083, -22.33297672944007, -4.08242907630586, -6.912034255607735], "policy_predator_policy_reward": [-4.062604513835076, 0.8684644774782493, 3.6546330943693004, 5.9114013485086385, 43.42257541987044, 15.64713058024416, -2.34487735390163, 0.9242250085997572, 6.2445961377970285, 23.19913681975823, 36.55319285363454, 12.64242077364913, 3.3439571110602238, 39.1168646219844, 8.865303364970094, 2.8605107888154375, 6.380561305415345, -3.9372958911769773, 28.368622396536914, 31.492397944755353, 12.541944946546032, 8.85667947339399, 11.19440149172674, 33.79695390850566, 17.089410222420874, 3.4382870924983138, 20.54852851221675, 14.951668560996351, 1.868145025307352, 9.024482470154489, 12.976032378885721, 13.96583954798193, 33.09934980982034, 17.43492788856902, 3.004421849123826, -2.641639435805473, 11.48424558174625, 17.202150280733928, 10.13867121038872, 7.398992209744826, 30.653859125136496, 42.19844916134714, 9.716563492882822, -0.19844793637190605, 16.58559671494135, 18.56335781117941, 18.449194562267046, 11.30947588543281, 49.77959051175541, 39.07399764563605, 32.64849243784292, 23.221775677872248, 3.4660750923026242, -2.143125686144769, -12.3474724826461, 19.445429327832294, 17.521056735357227, 38.116295199203634, 42.26596850021169, -3.206076415611801, 39.91596301696632, 27.389653046803204, 28.180709832372514, 24.01342846034001, 47.85873330068307, 11.022572861255373, -7.1357728650970635, 18.814368634592743, 17.669324737711623, 12.532173296159836, 11.426702798484623, 13.356628575662945, 19.31488618702215, 18.585692981974734, 26.427014337071412, 6.632015784176502, 1.304390870705813, 31.09045918394526, 15.967380154224948, 10.690553999500116, 3.4657127689147913, -0.6138219726525662, 19.910800589127795, 4.414262191602589, -8.816986784016237, -2.3813517977684633, 2.052772425795961, 27.241957253998038, 39.37421914815188, 13.202199486012308, 37.70296957869552, 17.222648490265712, 31.85726720176571, 12.848502313985955, 6.566725151083519, 7.813116399742219, 19.79469193366227, -3.8580464675285473, 1.9350847386437575, 13.71807735882631, 7.848335055063934, -3.6442336032432063, 9.57772383471095, 6.700491270490692, 13.642494396923205, -3.1086916703064738, 13.741772284241218, -1.8725886512985888, 34.58571170553837, 11.133722973575322, 44.442015539810804, 35.956806290152485, 12.748602248934818, 32.301323137423246, 5.722687574124205, -0.682198331575055, 9.268878713778951, 15.010199744417452, 13.04261644432983, 16.799004037396106, 3.2692431887468434, 30.18255998080025, -2.389520361257796, 11.899553311920208, 17.946464382238844, 23.903587679693857, -5.030169745048777, 0.2533146198247511, 8.242216871419844, 9.67900920102644, 16.78582186612146, 36.416271925678956, 33.43923283676065, 20.461578095675698, 11.89858649990213, -9.96165090412902, 21.1074034165326, 26.678353935662383, 18.041664131618226, 20.290099073395353, 8.09434931331329, 16.101533168431295, 18.196957993791294, 10.195539105722258, 21.96953835497404, 22.42702006482303, 16.430401601235413, 29.891677216344668, 16.72582042472142, 2.9818387379134563, 8.046468236734075, 9.836632254582899, 18.997545961691088, 4.235415065741616, 42.802654166819615, 4.825410139827419, -3.3479867005081623, -5.625410701791668, 40.71589835284704, 38.41536308209784, 22.269653405190553, 15.040414208823291, -6.546573789515666, 19.07264025575823, 4.916554761422653, 16.33857640834424, 26.550292335273028, 38.611987677600744, -2.6590584438620644, 25.97648272225736, 3.347756432003706, -15.046649198151787, 27.32397677818061, 6.707335097775406, 10.114292513264239, 12.038884535383374, -0.8178603692671409, 19.114488868936366, 13.945567095527155, 13.51148032883659, 45.02810538416235, 34.641566359754364, 18.987811482758417, -1.1657006767842253, 20.730253152836596, 13.984279376316518, 26.722690403357973, 34.92044500665584, 24.932806150856806, 22.463802284592727, 21.57434220036011, 21.880484076469205, 19.763710192784007, 9.909739044878183, 32.12458567748829, 12.541367781391838, -11.149046035269926, 19.313904187881658, 0.355784262436881, 13.468284248778593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6311969965424189, "mean_inference_ms": 1.6824972389586181, "mean_action_processing_ms": 0.260073912390907, "mean_env_wait_ms": 0.14528913016596745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009990453720092773, "StateBufferConnector_ms": 0.004528403282165527, "ViewRequirementAgentConnector_ms": 0.09693896770477295}, "num_episodes": 23, "episode_return_max": 44.42679407869568, "episode_return_min": -5.849446383074039, "episode_return_mean": 15.246184294513252, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 17.025152461057917, "num_env_steps_trained_throughput_per_sec": 17.025152461057917, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 138632.365, "restore_workers_time_ms": 0.038, "training_step_time_ms": 138632.135, "sample_time_ms": 916.044, "learn_time_ms": 137700.958, "learn_throughput": 29.048, "synch_weights_time_ms": 13.335}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "training_iteration": 73, "trial_id": "06536_00000", "date": "2024-08-11_17-27-10", "timestamp": 1723411630, "time_this_iter_s": 234.99504327774048, "time_total_s": 3173.533987045288, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3173.533987045288, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 34.82857142857143, "ram_util_percent": 82.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4634593511621157, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6806017301976681, "policy_loss": -0.011291065058564224, "vf_loss": 1.6918697742124398, "vf_explained_var": 0.9424110658466816, "kl": 0.007368370160905239, "entropy": 0.6283792856459817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4622081817773283, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6208192983001628, "policy_loss": -0.0014889082928045243, "vf_loss": 1.6223082023953634, "vf_explained_var": 0.9637820902324858, "kl": 0.003110276606759458, "entropy": 0.34212278469845103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 44.42679407869568, "episode_reward_min": -5.849446383074039, "episode_reward_mean": 15.451290840376858, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.42679407869572, "predator_policy": -15.046649198151787}, "policy_reward_max": {"prey_policy": 5.849446383074034, "predator_policy": 49.77959051175541}, "policy_reward_mean": {"prey_policy": -15.451290840376858, "predator_policy": 15.451290840376858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.343197931240084, 8.768831710066774, 36.42615414324183, 4.759057778255453, 17.574477263060377, 14.879335223849923, 44.42679407869568, 27.93513405785759, 0.6614747030789268, 3.548978422593075, 27.818675967280416, 19.529946042299912, 33.65280803188479, 26.097069146356297, 29.440653080969263, 5.8392978847478325, 15.100749016935751, 12.391665687073774, 18.95028958449844, 16.52951506062397, 16.197425027325536, 13.32896707686252, 1.4259453981311436, 12.162531390365197, -5.599169290892348, 14.647364839897001, 26.28820931708214, 27.46280903448062, 22.352884757875838, 7.189920775412882, 7.96832273306687, 7.826581048735013, 2.102050725910365, 8.139107552600816, 5.266901363308342, 5.934591816471323, 22.859717339556862, 40.19941091498166, 22.524962693179017, 2.5202446212745624, 12.13953922909819, 14.920810240862965, 16.725901584773574, 4.755016475331177, 20.925026030966354, -2.388427562612013, 8.960613036223117, 26.60104689590017, 26.95040546621818, 0.9684677978865519, 23.892878676097478, 19.16588160250677, 12.097941240872265, 14.196248549756778, 22.198279209898526, 23.161039408790028, 9.853829581317417, 8.941550245658492, 11.616480513716393, 23.814032153323545, -4.486698701149917, 39.56563071747245, 18.6550338070069, 6.263033233121293, 10.627565584883463, 32.58114000643688, 11.65871213919765, -5.849446383074039, 17.015655937978, 11.076588524323817, 9.148314249834618, 13.728523712181856, 39.834835871958326, 8.911055402987083, 17.35726626457654, 30.821567705006895, 23.698304217724772, 21.727413138414644, 14.836724618831063, 22.33297672944005, 4.082429076305876, 6.912034255607725, 2.038872932077637, 18.386154026209354, 18.7041422792038, 2.015878105502881, 25.940811364699606, 6.039734812848536, 16.6492953505318, 12.476210840026075, 8.734747626105229, 13.71170063135095, 24.12360194860591, 17.10425293764377, 4.3070786689880665, 17.722237039022303, 14.032374902294551, 30.010988310868935, 10.055934897013815, 13.60696292880503], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.343197931240132, -8.768831710066772, -36.42615414324183, -4.759057778255462, -17.574477263060373, -14.879335223849926, -44.42679407869572, -27.935134057857567, -0.6614747030789272, -3.548978422593084, -27.81867596728043, -19.529946042299922, -33.65280803188477, -26.097069146356247, -29.440653080969224, -5.839297884747847, -15.100749016935719, -12.3916656870738, -18.950289584498442, -16.529515060623947, -16.19742502732555, -13.32896707686251, -1.4259453981311134, -12.162531390365189, 5.59916929089235, -14.647364839896998, -26.288209317082117, -27.462809034480642, -22.352884757875827, -7.189920775412863, -7.968322733066871, -7.826581048735047, -2.102050725910348, -8.139107552600823, -5.266901363308346, -5.9345918164713165, -22.859717339556855, -40.199410914981584, -22.524962693179063, -2.5202446212745633, -12.139539229098206, -14.920810240862977, -16.725901584773524, -4.755016475331208, -20.925026030966357, 2.388427562612013, -8.960613036223155, -26.601046895900176, -26.950405466218164, -0.9684677978865857, -23.892878676097467, -19.165881602506765, -12.097941240872299, -14.196248549756781, -22.198279209898566, -23.16103940879005, -9.853829581317418, -8.941550245658483, -11.61648051371634, -23.81403215332355, 4.48669870114992, -39.565630717472466, -18.65503380700693, -6.2630332331212735, -10.627565584883452, -32.581140006436875, -11.658712139197634, 5.849446383074034, -17.01565593797806, -11.076588524323801, -9.148314249834606, -13.728523712181854, -39.83483587195839, -8.911055402987092, -17.357266264576577, -30.821567705006892, -23.698304217724754, -21.72741313841465, -14.836724618831083, -22.33297672944007, -4.08242907630586, -6.912034255607735, -2.0388729320776244, -18.386154026209333, -18.70414227920376, -2.015878105502881, -25.94081136469958, -6.039734812848527, -16.649295350531826, -12.476210840026088, -8.734747626105229, -13.711700631350936, -24.123601948605934, -17.104252937643782, -4.307078668988073, -17.722237039022325, -14.032374902294569, -30.0109883108689, -10.055934897013824, -13.60696292880504], "policy_predator_policy_reward": [11.48424558174625, 17.202150280733928, 10.13867121038872, 7.398992209744826, 30.653859125136496, 42.19844916134714, 9.716563492882822, -0.19844793637190605, 16.58559671494135, 18.56335781117941, 18.449194562267046, 11.30947588543281, 49.77959051175541, 39.07399764563605, 32.64849243784292, 23.221775677872248, 3.4660750923026242, -2.143125686144769, -12.3474724826461, 19.445429327832294, 17.521056735357227, 38.116295199203634, 42.26596850021169, -3.206076415611801, 39.91596301696632, 27.389653046803204, 28.180709832372514, 24.01342846034001, 47.85873330068307, 11.022572861255373, -7.1357728650970635, 18.814368634592743, 17.669324737711623, 12.532173296159836, 11.426702798484623, 13.356628575662945, 19.31488618702215, 18.585692981974734, 26.427014337071412, 6.632015784176502, 1.304390870705813, 31.09045918394526, 15.967380154224948, 10.690553999500116, 3.4657127689147913, -0.6138219726525662, 19.910800589127795, 4.414262191602589, -8.816986784016237, -2.3813517977684633, 2.052772425795961, 27.241957253998038, 39.37421914815188, 13.202199486012308, 37.70296957869552, 17.222648490265712, 31.85726720176571, 12.848502313985955, 6.566725151083519, 7.813116399742219, 19.79469193366227, -3.8580464675285473, 1.9350847386437575, 13.71807735882631, 7.848335055063934, -3.6442336032432063, 9.57772383471095, 6.700491270490692, 13.642494396923205, -3.1086916703064738, 13.741772284241218, -1.8725886512985888, 34.58571170553837, 11.133722973575322, 44.442015539810804, 35.956806290152485, 12.748602248934818, 32.301323137423246, 5.722687574124205, -0.682198331575055, 9.268878713778951, 15.010199744417452, 13.04261644432983, 16.799004037396106, 3.2692431887468434, 30.18255998080025, -2.389520361257796, 11.899553311920208, 17.946464382238844, 23.903587679693857, -5.030169745048777, 0.2533146198247511, 8.242216871419844, 9.67900920102644, 16.78582186612146, 36.416271925678956, 33.43923283676065, 20.461578095675698, 11.89858649990213, -9.96165090412902, 21.1074034165326, 26.678353935662383, 18.041664131618226, 20.290099073395353, 8.09434931331329, 16.101533168431295, 18.196957993791294, 10.195539105722258, 21.96953835497404, 22.42702006482303, 16.430401601235413, 29.891677216344668, 16.72582042472142, 2.9818387379134563, 8.046468236734075, 9.836632254582899, 18.997545961691088, 4.235415065741616, 42.802654166819615, 4.825410139827419, -3.3479867005081623, -5.625410701791668, 40.71589835284704, 38.41536308209784, 22.269653405190553, 15.040414208823291, -6.546573789515666, 19.07264025575823, 4.916554761422653, 16.33857640834424, 26.550292335273028, 38.611987677600744, -2.6590584438620644, 25.97648272225736, 3.347756432003706, -15.046649198151787, 27.32397677818061, 6.707335097775406, 10.114292513264239, 12.038884535383374, -0.8178603692671409, 19.114488868936366, 13.945567095527155, 13.51148032883659, 45.02810538416235, 34.641566359754364, 18.987811482758417, -1.1657006767842253, 20.730253152836596, 13.984279376316518, 26.722690403357973, 34.92044500665584, 24.932806150856806, 22.463802284592727, 21.57434220036011, 21.880484076469205, 19.763710192784007, 9.909739044878183, 32.12458567748829, 12.541367781391838, -11.149046035269926, 19.313904187881658, 0.355784262436881, 13.468284248778593, 4.107959838958507, -0.030213974803267263, 10.918890837876843, 25.853417214541814, 4.76133756149142, 32.646946996916135, 4.956706476641913, -0.9249502656361539, 16.889655705574324, 34.99196702382482, 12.507584899064163, -0.4281152733670981, 20.194843291966396, 13.103747409097252, 0.9005898948639324, 24.051831785188206, 12.973427246784432, 4.496068005426018, 11.395947216588082, 16.027454046113807, 29.07876956209111, 19.168434335120747, 12.694486292240756, 21.514019583046803, 10.694585265332552, -2.080427927356415, 19.79683922579901, 15.647634852245615, 13.044962848507721, 15.019786956081404, 38.04349165941201, 21.97848496232578, 27.77456118591457, -7.662691391886952, 17.357980427313844, 9.855945430296222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6304130116131131, "mean_inference_ms": 1.677824323108134, "mean_action_processing_ms": 0.2594822667471155, "mean_env_wait_ms": 0.14481877345940936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004424452781677246, "StateBufferConnector_ms": 0.003764629364013672, "ViewRequirementAgentConnector_ms": 0.07199275493621826}, "num_episodes": 18, "episode_return_max": 44.42679407869568, "episode_return_min": -5.849446383074039, "episode_return_mean": 15.451290840376858, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.39324352636197, "num_env_steps_trained_throughput_per_sec": 382.39324352636197, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 138717.66, "restore_workers_time_ms": 0.016, "training_step_time_ms": 138717.447, "sample_time_ms": 958.297, "learn_time_ms": 137738.462, "learn_throughput": 29.041, "synch_weights_time_ms": 18.772}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 74, "trial_id": "06536_00000", "date": "2024-08-11_17-27-21", "timestamp": 1723411641, "time_this_iter_s": 10.48747205734253, "time_total_s": 3184.0214591026306, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe7d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3184.0214591026306, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 49.306666666666665, "ram_util_percent": 82.85333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.780771036570271, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1085282704482475, "policy_loss": -0.0066469808982219545, "vf_loss": 2.1151436161249877, "vf_explained_var": 0.9478775180876255, "kl": 0.01012360612408965, "entropy": 0.5948031784345706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8162197025680036, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.376653969350946, "policy_loss": -0.002292993930340917, "vf_loss": 2.3789469614861503, "vf_explained_var": 0.9454815533110704, "kl": 0.003980947216071102, "entropy": 0.32045339590342586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": 40.19941091498166, "episode_reward_min": -5.849446383074039, "episode_reward_mean": 14.012020252344087, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.199410914981584, "predator_policy": -17.05572313999253}, "policy_reward_max": {"prey_policy": 5.849446383074034, "predator_policy": 47.119110868710976}, "policy_reward_mean": {"prey_policy": -14.012020252344087, "predator_policy": 14.012020252344087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.95028958449844, 16.52951506062397, 16.197425027325536, 13.32896707686252, 1.4259453981311436, 12.162531390365197, -5.599169290892348, 14.647364839897001, 26.28820931708214, 27.46280903448062, 22.352884757875838, 7.189920775412882, 7.96832273306687, 7.826581048735013, 2.102050725910365, 8.139107552600816, 5.266901363308342, 5.934591816471323, 22.859717339556862, 40.19941091498166, 22.524962693179017, 2.5202446212745624, 12.13953922909819, 14.920810240862965, 16.725901584773574, 4.755016475331177, 20.925026030966354, -2.388427562612013, 8.960613036223117, 26.60104689590017, 26.95040546621818, 0.9684677978865519, 23.892878676097478, 19.16588160250677, 12.097941240872265, 14.196248549756778, 22.198279209898526, 23.161039408790028, 9.853829581317417, 8.941550245658492, 11.616480513716393, 23.814032153323545, -4.486698701149917, 39.56563071747245, 18.6550338070069, 6.263033233121293, 10.627565584883463, 32.58114000643688, 11.65871213919765, -5.849446383074039, 17.015655937978, 11.076588524323817, 9.148314249834618, 13.728523712181856, 39.834835871958326, 8.911055402987083, 17.35726626457654, 30.821567705006895, 23.698304217724772, 21.727413138414644, 14.836724618831063, 22.33297672944005, 4.082429076305876, 6.912034255607725, 2.038872932077637, 18.386154026209354, 18.7041422792038, 2.015878105502881, 25.940811364699606, 6.039734812848536, 16.6492953505318, 12.476210840026075, 8.734747626105229, 13.71170063135095, 24.12360194860591, 17.10425293764377, 4.3070786689880665, 17.722237039022303, 14.032374902294551, 30.010988310868935, 10.055934897013815, 13.60696292880503, 12.904647457030025, 9.714489474340432, -4.082160474212304, 28.65208449731575, 5.069851623095733, 15.017750722834874, 4.068985156394386, 13.20976733143642, 26.00628248712617, 0.9358374858321188, 7.826956088098166, 37.22314079681544, 13.59512618381297, -2.4118506074960235, 4.5786786812360685, -5.202670032094525, 10.00000688111433, 22.160317613530687], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.950289584498442, -16.529515060623947, -16.19742502732555, -13.32896707686251, -1.4259453981311134, -12.162531390365189, 5.59916929089235, -14.647364839896998, -26.288209317082117, -27.462809034480642, -22.352884757875827, -7.189920775412863, -7.968322733066871, -7.826581048735047, -2.102050725910348, -8.139107552600823, -5.266901363308346, -5.9345918164713165, -22.859717339556855, -40.199410914981584, -22.524962693179063, -2.5202446212745633, -12.139539229098206, -14.920810240862977, -16.725901584773524, -4.755016475331208, -20.925026030966357, 2.388427562612013, -8.960613036223155, -26.601046895900176, -26.950405466218164, -0.9684677978865857, -23.892878676097467, -19.165881602506765, -12.097941240872299, -14.196248549756781, -22.198279209898566, -23.16103940879005, -9.853829581317418, -8.941550245658483, -11.61648051371634, -23.81403215332355, 4.48669870114992, -39.565630717472466, -18.65503380700693, -6.2630332331212735, -10.627565584883452, -32.581140006436875, -11.658712139197634, 5.849446383074034, -17.01565593797806, -11.076588524323801, -9.148314249834606, -13.728523712181854, -39.83483587195839, -8.911055402987092, -17.357266264576577, -30.821567705006892, -23.698304217724754, -21.72741313841465, -14.836724618831083, -22.33297672944007, -4.08242907630586, -6.912034255607735, -2.0388729320776244, -18.386154026209333, -18.70414227920376, -2.015878105502881, -25.94081136469958, -6.039734812848527, -16.649295350531826, -12.476210840026088, -8.734747626105229, -13.711700631350936, -24.123601948605934, -17.104252937643782, -4.307078668988073, -17.722237039022325, -14.032374902294569, -30.0109883108689, -10.055934897013824, -13.60696292880504, -12.904647457030034, -9.714489474340416, 4.08216047421232, -28.652084497315776, -5.069851623095792, -15.017750722834801, -4.068985156394376, -13.209767331436462, -26.006282487126107, -0.9358374858321321, -7.826956088098156, -37.2231407968155, -13.59512618381298, 2.4118506074960377, -4.578678681236077, 5.202670032094525, -10.000006881114341, -22.16031761353068], "policy_predator_policy_reward": [19.31488618702215, 18.585692981974734, 26.427014337071412, 6.632015784176502, 1.304390870705813, 31.09045918394526, 15.967380154224948, 10.690553999500116, 3.4657127689147913, -0.6138219726525662, 19.910800589127795, 4.414262191602589, -8.816986784016237, -2.3813517977684633, 2.052772425795961, 27.241957253998038, 39.37421914815188, 13.202199486012308, 37.70296957869552, 17.222648490265712, 31.85726720176571, 12.848502313985955, 6.566725151083519, 7.813116399742219, 19.79469193366227, -3.8580464675285473, 1.9350847386437575, 13.71807735882631, 7.848335055063934, -3.6442336032432063, 9.57772383471095, 6.700491270490692, 13.642494396923205, -3.1086916703064738, 13.741772284241218, -1.8725886512985888, 34.58571170553837, 11.133722973575322, 44.442015539810804, 35.956806290152485, 12.748602248934818, 32.301323137423246, 5.722687574124205, -0.682198331575055, 9.268878713778951, 15.010199744417452, 13.04261644432983, 16.799004037396106, 3.2692431887468434, 30.18255998080025, -2.389520361257796, 11.899553311920208, 17.946464382238844, 23.903587679693857, -5.030169745048777, 0.2533146198247511, 8.242216871419844, 9.67900920102644, 16.78582186612146, 36.416271925678956, 33.43923283676065, 20.461578095675698, 11.89858649990213, -9.96165090412902, 21.1074034165326, 26.678353935662383, 18.041664131618226, 20.290099073395353, 8.09434931331329, 16.101533168431295, 18.196957993791294, 10.195539105722258, 21.96953835497404, 22.42702006482303, 16.430401601235413, 29.891677216344668, 16.72582042472142, 2.9818387379134563, 8.046468236734075, 9.836632254582899, 18.997545961691088, 4.235415065741616, 42.802654166819615, 4.825410139827419, -3.3479867005081623, -5.625410701791668, 40.71589835284704, 38.41536308209784, 22.269653405190553, 15.040414208823291, -6.546573789515666, 19.07264025575823, 4.916554761422653, 16.33857640834424, 26.550292335273028, 38.611987677600744, -2.6590584438620644, 25.97648272225736, 3.347756432003706, -15.046649198151787, 27.32397677818061, 6.707335097775406, 10.114292513264239, 12.038884535383374, -0.8178603692671409, 19.114488868936366, 13.945567095527155, 13.51148032883659, 45.02810538416235, 34.641566359754364, 18.987811482758417, -1.1657006767842253, 20.730253152836596, 13.984279376316518, 26.722690403357973, 34.92044500665584, 24.932806150856806, 22.463802284592727, 21.57434220036011, 21.880484076469205, 19.763710192784007, 9.909739044878183, 32.12458567748829, 12.541367781391838, -11.149046035269926, 19.313904187881658, 0.355784262436881, 13.468284248778593, 4.107959838958507, -0.030213974803267263, 10.918890837876843, 25.853417214541814, 4.76133756149142, 32.646946996916135, 4.956706476641913, -0.9249502656361539, 16.889655705574324, 34.99196702382482, 12.507584899064163, -0.4281152733670981, 20.194843291966396, 13.103747409097252, 0.9005898948639324, 24.051831785188206, 12.973427246784432, 4.496068005426018, 11.395947216588082, 16.027454046113807, 29.07876956209111, 19.168434335120747, 12.694486292240756, 21.514019583046803, 10.694585265332552, -2.080427927356415, 19.79683922579901, 15.647634852245615, 13.044962848507721, 15.019786956081404, 38.04349165941201, 21.97848496232578, 27.77456118591457, -7.662691391886952, 17.357980427313844, 9.855945430296222, 20.23562632247743, 5.573668591582633, 13.504001037864072, 5.924977910816763, 8.891402191567899, -17.05572313999253, 14.564055161630403, 42.74011383300109, 7.268063353722299, 2.8716398924692506, 6.2527538833826934, 23.782747562286975, -1.0813648473565962, 9.219335160145356, 19.133173414030992, 7.286361248841942, 25.324117490540353, 26.688447483711894, -1.9064228168503696, 3.7780977885146205, 8.696767066309881, 6.957145109886442, 47.119110868710976, 27.327170724920023, 14.087158547788812, 13.103093819837166, -4.18978811152566, -0.6339131034664138, -1.7063729606241065, 10.863730323096224, -5.169307670913408, -5.236032393275645, 15.62923985373247, 4.370773908496222, 29.731589781238085, 14.589045445823272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6293603435367878, "mean_inference_ms": 1.6746503267708404, "mean_action_processing_ms": 0.2590542827511123, "mean_env_wait_ms": 0.14455257440875796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004318356513977051, "StateBufferConnector_ms": 0.003920078277587891, "ViewRequirementAgentConnector_ms": 0.0790250301361084}, "num_episodes": 18, "episode_return_max": 40.19941091498166, "episode_return_min": -5.849446383074039, "episode_return_mean": 14.012020252344087, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 401.277268450845, "num_env_steps_trained_throughput_per_sec": 401.277268450845, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 138796.509, "restore_workers_time_ms": 0.018, "training_step_time_ms": 138796.292, "sample_time_ms": 1011.305, "learn_time_ms": 137764.289, "learn_throughput": 29.035, "synch_weights_time_ms": 18.873}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 75, "trial_id": "06536_00000", "date": "2024-08-11_17-27-31", "timestamp": 1723411651, "time_this_iter_s": 10.029791116714478, "time_total_s": 3194.051250219345, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fe7d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3194.051250219345, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 41.33571428571428, "ram_util_percent": 80.19285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5902100075036287, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8066749011476835, "policy_loss": -0.00901420362109396, "vf_loss": 1.815663355278472, "vf_explained_var": 0.9525703155746063, "kl": 0.008239858213434969, "entropy": 0.5874674904160202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5422654448362887, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9345586597604096, "policy_loss": -0.0021813883152962837, "vf_loss": 1.9367400488525472, "vf_explained_var": 0.9605776453775073, "kl": 0.0045375257900360545, "entropy": 0.2955890421514158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 39.834835871958326, "episode_reward_min": -5.849446383074039, "episode_reward_mean": 14.337420859023469, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -39.83483587195839, "predator_policy": -17.05572313999253}, "policy_reward_max": {"prey_policy": 5.849446383074034, "predator_policy": 47.119110868710976}, "policy_reward_mean": {"prey_policy": -14.337420859023469, "predator_policy": 14.337420859023469}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.13953922909819, 14.920810240862965, 16.725901584773574, 4.755016475331177, 20.925026030966354, -2.388427562612013, 8.960613036223117, 26.60104689590017, 26.95040546621818, 0.9684677978865519, 23.892878676097478, 19.16588160250677, 12.097941240872265, 14.196248549756778, 22.198279209898526, 23.161039408790028, 9.853829581317417, 8.941550245658492, 11.616480513716393, 23.814032153323545, -4.486698701149917, 39.56563071747245, 18.6550338070069, 6.263033233121293, 10.627565584883463, 32.58114000643688, 11.65871213919765, -5.849446383074039, 17.015655937978, 11.076588524323817, 9.148314249834618, 13.728523712181856, 39.834835871958326, 8.911055402987083, 17.35726626457654, 30.821567705006895, 23.698304217724772, 21.727413138414644, 14.836724618831063, 22.33297672944005, 4.082429076305876, 6.912034255607725, 2.038872932077637, 18.386154026209354, 18.7041422792038, 2.015878105502881, 25.940811364699606, 6.039734812848536, 16.6492953505318, 12.476210840026075, 8.734747626105229, 13.71170063135095, 24.12360194860591, 17.10425293764377, 4.3070786689880665, 17.722237039022303, 14.032374902294551, 30.010988310868935, 10.055934897013815, 13.60696292880503, 12.904647457030025, 9.714489474340432, -4.082160474212304, 28.65208449731575, 5.069851623095733, 15.017750722834874, 4.068985156394386, 13.20976733143642, 26.00628248712617, 0.9358374858321188, 7.826956088098166, 37.22314079681544, 13.59512618381297, -2.4118506074960235, 4.5786786812360685, -5.202670032094525, 10.00000688111433, 22.160317613530687, 7.7262077129345865, 2.721253313680844, 27.495601584536853, 19.023868081692235, 19.99865497329475, 14.287340303254284, 12.416838807902081, 9.07537118906102, 1.6377481593314691, 3.1218561785357615, 29.412284661729622, 8.33671690360444, 19.281497171358296, 2.1986262315599285, 18.010745430598853, 8.417011616006546, 12.561466936218961, 37.05361089496093, 14.303892351711209, 25.54975666054022, 15.290824822596798, 20.897470463576123], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.139539229098206, -14.920810240862977, -16.725901584773524, -4.755016475331208, -20.925026030966357, 2.388427562612013, -8.960613036223155, -26.601046895900176, -26.950405466218164, -0.9684677978865857, -23.892878676097467, -19.165881602506765, -12.097941240872299, -14.196248549756781, -22.198279209898566, -23.16103940879005, -9.853829581317418, -8.941550245658483, -11.61648051371634, -23.81403215332355, 4.48669870114992, -39.565630717472466, -18.65503380700693, -6.2630332331212735, -10.627565584883452, -32.581140006436875, -11.658712139197634, 5.849446383074034, -17.01565593797806, -11.076588524323801, -9.148314249834606, -13.728523712181854, -39.83483587195839, -8.911055402987092, -17.357266264576577, -30.821567705006892, -23.698304217724754, -21.72741313841465, -14.836724618831083, -22.33297672944007, -4.08242907630586, -6.912034255607735, -2.0388729320776244, -18.386154026209333, -18.70414227920376, -2.015878105502881, -25.94081136469958, -6.039734812848527, -16.649295350531826, -12.476210840026088, -8.734747626105229, -13.711700631350936, -24.123601948605934, -17.104252937643782, -4.307078668988073, -17.722237039022325, -14.032374902294569, -30.0109883108689, -10.055934897013824, -13.60696292880504, -12.904647457030034, -9.714489474340416, 4.08216047421232, -28.652084497315776, -5.069851623095792, -15.017750722834801, -4.068985156394376, -13.209767331436462, -26.006282487126107, -0.9358374858321321, -7.826956088098156, -37.2231407968155, -13.59512618381298, 2.4118506074960377, -4.578678681236077, 5.202670032094525, -10.000006881114341, -22.16031761353068, -7.726207712934568, -2.7212533136808474, -27.495601584536804, -19.023868081692243, -19.998654973294734, -14.287340303254268, -12.416838807902064, -9.075371189061023, -1.637748159331477, -3.1218561785357535, -29.412284661729583, -8.336716903604446, -19.28149717135833, -2.1986262315599205, -18.010745430598785, -8.417011616006526, -12.561466936218961, -37.053610894960954, -14.303892351711216, -25.549756660540258, -15.290824822596818, -20.8974704635761], "policy_predator_policy_reward": [9.268878713778951, 15.010199744417452, 13.04261644432983, 16.799004037396106, 3.2692431887468434, 30.18255998080025, -2.389520361257796, 11.899553311920208, 17.946464382238844, 23.903587679693857, -5.030169745048777, 0.2533146198247511, 8.242216871419844, 9.67900920102644, 16.78582186612146, 36.416271925678956, 33.43923283676065, 20.461578095675698, 11.89858649990213, -9.96165090412902, 21.1074034165326, 26.678353935662383, 18.041664131618226, 20.290099073395353, 8.09434931331329, 16.101533168431295, 18.196957993791294, 10.195539105722258, 21.96953835497404, 22.42702006482303, 16.430401601235413, 29.891677216344668, 16.72582042472142, 2.9818387379134563, 8.046468236734075, 9.836632254582899, 18.997545961691088, 4.235415065741616, 42.802654166819615, 4.825410139827419, -3.3479867005081623, -5.625410701791668, 40.71589835284704, 38.41536308209784, 22.269653405190553, 15.040414208823291, -6.546573789515666, 19.07264025575823, 4.916554761422653, 16.33857640834424, 26.550292335273028, 38.611987677600744, -2.6590584438620644, 25.97648272225736, 3.347756432003706, -15.046649198151787, 27.32397677818061, 6.707335097775406, 10.114292513264239, 12.038884535383374, -0.8178603692671409, 19.114488868936366, 13.945567095527155, 13.51148032883659, 45.02810538416235, 34.641566359754364, 18.987811482758417, -1.1657006767842253, 20.730253152836596, 13.984279376316518, 26.722690403357973, 34.92044500665584, 24.932806150856806, 22.463802284592727, 21.57434220036011, 21.880484076469205, 19.763710192784007, 9.909739044878183, 32.12458567748829, 12.541367781391838, -11.149046035269926, 19.313904187881658, 0.355784262436881, 13.468284248778593, 4.107959838958507, -0.030213974803267263, 10.918890837876843, 25.853417214541814, 4.76133756149142, 32.646946996916135, 4.956706476641913, -0.9249502656361539, 16.889655705574324, 34.99196702382482, 12.507584899064163, -0.4281152733670981, 20.194843291966396, 13.103747409097252, 0.9005898948639324, 24.051831785188206, 12.973427246784432, 4.496068005426018, 11.395947216588082, 16.027454046113807, 29.07876956209111, 19.168434335120747, 12.694486292240756, 21.514019583046803, 10.694585265332552, -2.080427927356415, 19.79683922579901, 15.647634852245615, 13.044962848507721, 15.019786956081404, 38.04349165941201, 21.97848496232578, 27.77456118591457, -7.662691391886952, 17.357980427313844, 9.855945430296222, 20.23562632247743, 5.573668591582633, 13.504001037864072, 5.924977910816763, 8.891402191567899, -17.05572313999253, 14.564055161630403, 42.74011383300109, 7.268063353722299, 2.8716398924692506, 6.2527538833826934, 23.782747562286975, -1.0813648473565962, 9.219335160145356, 19.133173414030992, 7.286361248841942, 25.324117490540353, 26.688447483711894, -1.9064228168503696, 3.7780977885146205, 8.696767066309881, 6.957145109886442, 47.119110868710976, 27.327170724920023, 14.087158547788812, 13.103093819837166, -4.18978811152566, -0.6339131034664138, -1.7063729606241065, 10.863730323096224, -5.169307670913408, -5.236032393275645, 15.62923985373247, 4.370773908496222, 29.731589781238085, 14.589045445823272, 0.756644715317556, 14.695770710551583, 5.011482052288795, 0.4310245750729056, 26.353934221020637, 28.637268948053023, 5.872137109795057, 32.17559905358944, 2.8523431942562194, 37.14496675233322, 18.322344970828684, 10.252335635679854, 2.24216818978618, 22.591509426017964, 0.09698491195570469, 18.053757466166342, 10.036079095839959, -6.760582777177023, 4.56851795443772, 1.6751944026337906, 17.460470287970058, 41.364099035489104, 12.301985190330244, 4.371448616878645, 18.406382571711845, 20.15661177100479, 3.1447010467918, 1.2525514163280382, 19.129105151278, 16.892385709919623, 18.970470385031167, -2.1364471530180715, 21.793073899952596, 3.329859972485309, 31.89369415006234, 42.21352763985956, 23.09475553776383, 5.5130291656585975, 28.09413960256435, 23.00537371851614, 18.094951736845967, 12.486697908347642, 37.60393001464468, 4.1910109125075214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6287800973179933, "mean_inference_ms": 1.6714742058019334, "mean_action_processing_ms": 0.25881228172214576, "mean_env_wait_ms": 0.144307633337845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039408206939697266, "StateBufferConnector_ms": 0.003952503204345703, "ViewRequirementAgentConnector_ms": 0.07831025123596191}, "num_episodes": 22, "episode_return_max": 39.834835871958326, "episode_return_min": -5.849446383074039, "episode_return_mean": 14.337420859023469, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.72615110583195, "num_env_steps_trained_throughput_per_sec": 424.72615110583195, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 138825.351, "restore_workers_time_ms": 0.019, "training_step_time_ms": 138825.143, "sample_time_ms": 1032.857, "learn_time_ms": 137771.081, "learn_throughput": 29.034, "synch_weights_time_ms": 19.577}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 76, "trial_id": "06536_00000", "date": "2024-08-11_17-27-40", "timestamp": 1723411660, "time_this_iter_s": 9.440805196762085, "time_total_s": 3203.492055416107, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fea8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3203.492055416107, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 40.13076923076923, "ram_util_percent": 81.1923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5830086952075364, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8582072481513023, "policy_loss": -0.007313325026431509, "vf_loss": 1.8655052793522675, "vf_explained_var": 0.9652848331257701, "kl": 0.004893677734560859, "entropy": 0.5464377832288544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6004370598565965, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0214188200456125, "policy_loss": -0.002975505564199199, "vf_loss": 2.024394324216893, "vf_explained_var": 0.9627989561154098, "kl": 0.004585292238879353, "entropy": 0.31025120068794837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "env_runners": {"episode_reward_max": 44.12196211712951, "episode_reward_min": -10.138127475874676, "episode_reward_mean": 13.789502686447335, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.121962117129534, "predator_policy": -17.05572313999253}, "policy_reward_max": {"prey_policy": 10.138127475874677, "predator_policy": 47.119110868710976}, "policy_reward_mean": {"prey_policy": -13.789502686447335, "predator_policy": 13.789502686447335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.616480513716393, 23.814032153323545, -4.486698701149917, 39.56563071747245, 18.6550338070069, 6.263033233121293, 10.627565584883463, 32.58114000643688, 11.65871213919765, -5.849446383074039, 17.015655937978, 11.076588524323817, 9.148314249834618, 13.728523712181856, 39.834835871958326, 8.911055402987083, 17.35726626457654, 30.821567705006895, 23.698304217724772, 21.727413138414644, 14.836724618831063, 22.33297672944005, 4.082429076305876, 6.912034255607725, 2.038872932077637, 18.386154026209354, 18.7041422792038, 2.015878105502881, 25.940811364699606, 6.039734812848536, 16.6492953505318, 12.476210840026075, 8.734747626105229, 13.71170063135095, 24.12360194860591, 17.10425293764377, 4.3070786689880665, 17.722237039022303, 14.032374902294551, 30.010988310868935, 10.055934897013815, 13.60696292880503, 12.904647457030025, 9.714489474340432, -4.082160474212304, 28.65208449731575, 5.069851623095733, 15.017750722834874, 4.068985156394386, 13.20976733143642, 26.00628248712617, 0.9358374858321188, 7.826956088098166, 37.22314079681544, 13.59512618381297, -2.4118506074960235, 4.5786786812360685, -5.202670032094525, 10.00000688111433, 22.160317613530687, 7.7262077129345865, 2.721253313680844, 27.495601584536853, 19.023868081692235, 19.99865497329475, 14.287340303254284, 12.416838807902081, 9.07537118906102, 1.6377481593314691, 3.1218561785357615, 29.412284661729622, 8.33671690360444, 19.281497171358296, 2.1986262315599285, 18.010745430598853, 8.417011616006546, 12.561466936218961, 37.05361089496093, 14.303892351711209, 25.54975666054022, 15.290824822596798, 20.897470463576123, -6.874692653956826, -1.751355812063685, -3.1981266959935315, -10.138127475874676, 14.431436292505545, 9.76161407893275, 3.330225420057067, 13.405696099789736, 13.28193982416069, 6.719643385104799, 15.427066333009272, 26.622340366512283, 17.725314850920945, 28.23877936153618, 26.669527498492982, -3.9878230326208506, 15.488810494290803, 44.12196211712951], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.61648051371634, -23.81403215332355, 4.48669870114992, -39.565630717472466, -18.65503380700693, -6.2630332331212735, -10.627565584883452, -32.581140006436875, -11.658712139197634, 5.849446383074034, -17.01565593797806, -11.076588524323801, -9.148314249834606, -13.728523712181854, -39.83483587195839, -8.911055402987092, -17.357266264576577, -30.821567705006892, -23.698304217724754, -21.72741313841465, -14.836724618831083, -22.33297672944007, -4.08242907630586, -6.912034255607735, -2.0388729320776244, -18.386154026209333, -18.70414227920376, -2.015878105502881, -25.94081136469958, -6.039734812848527, -16.649295350531826, -12.476210840026088, -8.734747626105229, -13.711700631350936, -24.123601948605934, -17.104252937643782, -4.307078668988073, -17.722237039022325, -14.032374902294569, -30.0109883108689, -10.055934897013824, -13.60696292880504, -12.904647457030034, -9.714489474340416, 4.08216047421232, -28.652084497315776, -5.069851623095792, -15.017750722834801, -4.068985156394376, -13.209767331436462, -26.006282487126107, -0.9358374858321321, -7.826956088098156, -37.2231407968155, -13.59512618381298, 2.4118506074960377, -4.578678681236077, 5.202670032094525, -10.000006881114341, -22.16031761353068, -7.726207712934568, -2.7212533136808474, -27.495601584536804, -19.023868081692243, -19.998654973294734, -14.287340303254268, -12.416838807902064, -9.075371189061023, -1.637748159331477, -3.1218561785357535, -29.412284661729583, -8.336716903604446, -19.28149717135833, -2.1986262315599205, -18.010745430598785, -8.417011616006526, -12.561466936218961, -37.053610894960954, -14.303892351711216, -25.549756660540258, -15.290824822596818, -20.8974704635761, 6.874692653956815, 1.7513558120636805, 3.198126695993534, 10.138127475874677, -14.431436292505552, -9.761614078932729, -3.330225420057049, -13.405696099789749, -13.281939824160705, -6.719643385104769, -15.42706633300928, -26.622340366512265, -17.725314850920956, -28.23877936153621, -26.669527498492997, 3.9878230326208524, -15.488810494290801, -44.121962117129534], "policy_predator_policy_reward": [18.997545961691088, 4.235415065741616, 42.802654166819615, 4.825410139827419, -3.3479867005081623, -5.625410701791668, 40.71589835284704, 38.41536308209784, 22.269653405190553, 15.040414208823291, -6.546573789515666, 19.07264025575823, 4.916554761422653, 16.33857640834424, 26.550292335273028, 38.611987677600744, -2.6590584438620644, 25.97648272225736, 3.347756432003706, -15.046649198151787, 27.32397677818061, 6.707335097775406, 10.114292513264239, 12.038884535383374, -0.8178603692671409, 19.114488868936366, 13.945567095527155, 13.51148032883659, 45.02810538416235, 34.641566359754364, 18.987811482758417, -1.1657006767842253, 20.730253152836596, 13.984279376316518, 26.722690403357973, 34.92044500665584, 24.932806150856806, 22.463802284592727, 21.57434220036011, 21.880484076469205, 19.763710192784007, 9.909739044878183, 32.12458567748829, 12.541367781391838, -11.149046035269926, 19.313904187881658, 0.355784262436881, 13.468284248778593, 4.107959838958507, -0.030213974803267263, 10.918890837876843, 25.853417214541814, 4.76133756149142, 32.646946996916135, 4.956706476641913, -0.9249502656361539, 16.889655705574324, 34.99196702382482, 12.507584899064163, -0.4281152733670981, 20.194843291966396, 13.103747409097252, 0.9005898948639324, 24.051831785188206, 12.973427246784432, 4.496068005426018, 11.395947216588082, 16.027454046113807, 29.07876956209111, 19.168434335120747, 12.694486292240756, 21.514019583046803, 10.694585265332552, -2.080427927356415, 19.79683922579901, 15.647634852245615, 13.044962848507721, 15.019786956081404, 38.04349165941201, 21.97848496232578, 27.77456118591457, -7.662691391886952, 17.357980427313844, 9.855945430296222, 20.23562632247743, 5.573668591582633, 13.504001037864072, 5.924977910816763, 8.891402191567899, -17.05572313999253, 14.564055161630403, 42.74011383300109, 7.268063353722299, 2.8716398924692506, 6.2527538833826934, 23.782747562286975, -1.0813648473565962, 9.219335160145356, 19.133173414030992, 7.286361248841942, 25.324117490540353, 26.688447483711894, -1.9064228168503696, 3.7780977885146205, 8.696767066309881, 6.957145109886442, 47.119110868710976, 27.327170724920023, 14.087158547788812, 13.103093819837166, -4.18978811152566, -0.6339131034664138, -1.7063729606241065, 10.863730323096224, -5.169307670913408, -5.236032393275645, 15.62923985373247, 4.370773908496222, 29.731589781238085, 14.589045445823272, 0.756644715317556, 14.695770710551583, 5.011482052288795, 0.4310245750729056, 26.353934221020637, 28.637268948053023, 5.872137109795057, 32.17559905358944, 2.8523431942562194, 37.14496675233322, 18.322344970828684, 10.252335635679854, 2.24216818978618, 22.591509426017964, 0.09698491195570469, 18.053757466166342, 10.036079095839959, -6.760582777177023, 4.56851795443772, 1.6751944026337906, 17.460470287970058, 41.364099035489104, 12.301985190330244, 4.371448616878645, 18.406382571711845, 20.15661177100479, 3.1447010467918, 1.2525514163280382, 19.129105151278, 16.892385709919623, 18.970470385031167, -2.1364471530180715, 21.793073899952596, 3.329859972485309, 31.89369415006234, 42.21352763985956, 23.09475553776383, 5.5130291656585975, 28.09413960256435, 23.00537371851614, 18.094951736845967, 12.486697908347642, 37.60393001464468, 4.1910109125075214, -16.461632965919016, 2.7122476580053707, -5.965299512780561, 2.4625878886531947, -0.6607458517219671, -5.73550754026509, -13.620193327101, -6.656061624648347, 27.278452963948368, 1.5844196210627337, 1.721008449597047, 17.80221970826843, 9.887526179122759, -3.227075339008646, 18.612986515163772, 8.198405684415691, 19.454636668385646, 7.10924297993574, -6.146516920822366, 19.58580369103195, 28.89297334742954, 1.9611593185890737, 25.785359155580153, 27.45932157744445, 2.381787766498981, 33.06884193534291, 29.516635762868212, 26.960922960204137, 24.10862897639287, 29.230426020593097, 5.99977139046246, -13.975417455704154, 25.210133792844736, 5.767487195736871, 41.29226336053593, 46.9516608737231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6285399260991589, "mean_inference_ms": 1.6723036925240433, "mean_action_processing_ms": 0.25878144273091863, "mean_env_wait_ms": 0.14438451377418965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045623779296875, "StateBufferConnector_ms": 0.004139900207519531, "ViewRequirementAgentConnector_ms": 0.10318922996520996}, "num_episodes": 18, "episode_return_max": 44.12196211712951, "episode_return_min": -10.138127475874676, "episode_return_mean": 13.789502686447335, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.6790986288689, "num_env_steps_trained_throughput_per_sec": 326.6790986288689, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 139199.889, "restore_workers_time_ms": 0.019, "training_step_time_ms": 139199.672, "sample_time_ms": 1104.099, "learn_time_ms": 138064.638, "learn_throughput": 28.972, "synch_weights_time_ms": 29.137}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "training_iteration": 77, "trial_id": "06536_00000", "date": "2024-08-11_17-27-53", "timestamp": 1723411673, "time_this_iter_s": 12.27531886100769, "time_total_s": 3215.767374277115, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316ff280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3215.767374277115, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 52.80555555555556, "ram_util_percent": 82.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.736052109176914, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2528881604472795, "policy_loss": -0.008528753293406528, "vf_loss": 2.2614067122340202, "vf_explained_var": 0.9491643994425734, "kl": 0.0065348711527832394, "entropy": 0.5467808904747168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8666688007021706, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4569432641463305, "policy_loss": -0.0014951091371821585, "vf_loss": 2.458438371035157, "vf_explained_var": 0.9596161135290034, "kl": 0.0028486709567129946, "entropy": 0.30666087074254555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 44.12196211712951, "episode_reward_min": -10.138127475874676, "episode_reward_mean": 14.47756139719686, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.121962117129534, "predator_policy": -17.05572313999253}, "policy_reward_max": {"prey_policy": 10.138127475874677, "predator_policy": 47.119110868710976}, "policy_reward_mean": {"prey_policy": -14.477561397196858, "predator_policy": 14.477561397196855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.912034255607725, 2.038872932077637, 18.386154026209354, 18.7041422792038, 2.015878105502881, 25.940811364699606, 6.039734812848536, 16.6492953505318, 12.476210840026075, 8.734747626105229, 13.71170063135095, 24.12360194860591, 17.10425293764377, 4.3070786689880665, 17.722237039022303, 14.032374902294551, 30.010988310868935, 10.055934897013815, 13.60696292880503, 12.904647457030025, 9.714489474340432, -4.082160474212304, 28.65208449731575, 5.069851623095733, 15.017750722834874, 4.068985156394386, 13.20976733143642, 26.00628248712617, 0.9358374858321188, 7.826956088098166, 37.22314079681544, 13.59512618381297, -2.4118506074960235, 4.5786786812360685, -5.202670032094525, 10.00000688111433, 22.160317613530687, 7.7262077129345865, 2.721253313680844, 27.495601584536853, 19.023868081692235, 19.99865497329475, 14.287340303254284, 12.416838807902081, 9.07537118906102, 1.6377481593314691, 3.1218561785357615, 29.412284661729622, 8.33671690360444, 19.281497171358296, 2.1986262315599285, 18.010745430598853, 8.417011616006546, 12.561466936218961, 37.05361089496093, 14.303892351711209, 25.54975666054022, 15.290824822596798, 20.897470463576123, -6.874692653956826, -1.751355812063685, -3.1981266959935315, -10.138127475874676, 14.431436292505545, 9.76161407893275, 3.330225420057067, 13.405696099789736, 13.28193982416069, 6.719643385104799, 15.427066333009272, 26.622340366512283, 17.725314850920945, 28.23877936153618, 26.669527498492982, -3.9878230326208506, 15.488810494290803, 44.12196211712951, 12.728193387580754, 8.66433468633706, 34.65659524107814, 31.434256133241078, 8.956837353601895, 26.042829035554295, 11.130180035514137, 13.83412911846566, 19.669825802688536, 24.651367317977098, 41.21700268493702, 32.95143431142491, 15.626037691000153, 14.405075199530376, 14.719808080494698, 32.77241579300683, 10.189978842371929, 15.28133176493134, 15.040674222006844, 2.673480477083432, 3.8831159583393697, 27.47529332591214, 29.818813132372767], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.912034255607735, -2.0388729320776244, -18.386154026209333, -18.70414227920376, -2.015878105502881, -25.94081136469958, -6.039734812848527, -16.649295350531826, -12.476210840026088, -8.734747626105229, -13.711700631350936, -24.123601948605934, -17.104252937643782, -4.307078668988073, -17.722237039022325, -14.032374902294569, -30.0109883108689, -10.055934897013824, -13.60696292880504, -12.904647457030034, -9.714489474340416, 4.08216047421232, -28.652084497315776, -5.069851623095792, -15.017750722834801, -4.068985156394376, -13.209767331436462, -26.006282487126107, -0.9358374858321321, -7.826956088098156, -37.2231407968155, -13.59512618381298, 2.4118506074960377, -4.578678681236077, 5.202670032094525, -10.000006881114341, -22.16031761353068, -7.726207712934568, -2.7212533136808474, -27.495601584536804, -19.023868081692243, -19.998654973294734, -14.287340303254268, -12.416838807902064, -9.075371189061023, -1.637748159331477, -3.1218561785357535, -29.412284661729583, -8.336716903604446, -19.28149717135833, -2.1986262315599205, -18.010745430598785, -8.417011616006526, -12.561466936218961, -37.053610894960954, -14.303892351711216, -25.549756660540258, -15.290824822596818, -20.8974704635761, 6.874692653956815, 1.7513558120636805, 3.198126695993534, 10.138127475874677, -14.431436292505552, -9.761614078932729, -3.330225420057049, -13.405696099789749, -13.281939824160705, -6.719643385104769, -15.42706633300928, -26.622340366512265, -17.725314850920956, -28.23877936153621, -26.669527498492997, 3.9878230326208524, -15.488810494290801, -44.121962117129534, -12.728193387580735, -8.664334686337057, -34.65659524107817, -31.434256133241078, -8.956837353601884, -26.04282903555429, -11.130180035514089, -13.834129118465647, -19.66982580268852, -24.651367317977137, -41.21700268493697, -32.951434311424954, -15.626037691000153, -14.405075199530408, -14.71980808049462, -32.77241579300681, -10.189978842371886, -15.281331764931299, -15.040674222006821, -2.6734804770834266, -3.8831159583393546, -27.475293325912123, -29.818813132372682], "policy_predator_policy_reward": [0.355784262436881, 13.468284248778593, 4.107959838958507, -0.030213974803267263, 10.918890837876843, 25.853417214541814, 4.76133756149142, 32.646946996916135, 4.956706476641913, -0.9249502656361539, 16.889655705574324, 34.99196702382482, 12.507584899064163, -0.4281152733670981, 20.194843291966396, 13.103747409097252, 0.9005898948639324, 24.051831785188206, 12.973427246784432, 4.496068005426018, 11.395947216588082, 16.027454046113807, 29.07876956209111, 19.168434335120747, 12.694486292240756, 21.514019583046803, 10.694585265332552, -2.080427927356415, 19.79683922579901, 15.647634852245615, 13.044962848507721, 15.019786956081404, 38.04349165941201, 21.97848496232578, 27.77456118591457, -7.662691391886952, 17.357980427313844, 9.855945430296222, 20.23562632247743, 5.573668591582633, 13.504001037864072, 5.924977910816763, 8.891402191567899, -17.05572313999253, 14.564055161630403, 42.74011383300109, 7.268063353722299, 2.8716398924692506, 6.2527538833826934, 23.782747562286975, -1.0813648473565962, 9.219335160145356, 19.133173414030992, 7.286361248841942, 25.324117490540353, 26.688447483711894, -1.9064228168503696, 3.7780977885146205, 8.696767066309881, 6.957145109886442, 47.119110868710976, 27.327170724920023, 14.087158547788812, 13.103093819837166, -4.18978811152566, -0.6339131034664138, -1.7063729606241065, 10.863730323096224, -5.169307670913408, -5.236032393275645, 15.62923985373247, 4.370773908496222, 29.731589781238085, 14.589045445823272, 0.756644715317556, 14.695770710551583, 5.011482052288795, 0.4310245750729056, 26.353934221020637, 28.637268948053023, 5.872137109795057, 32.17559905358944, 2.8523431942562194, 37.14496675233322, 18.322344970828684, 10.252335635679854, 2.24216818978618, 22.591509426017964, 0.09698491195570469, 18.053757466166342, 10.036079095839959, -6.760582777177023, 4.56851795443772, 1.6751944026337906, 17.460470287970058, 41.364099035489104, 12.301985190330244, 4.371448616878645, 18.406382571711845, 20.15661177100479, 3.1447010467918, 1.2525514163280382, 19.129105151278, 16.892385709919623, 18.970470385031167, -2.1364471530180715, 21.793073899952596, 3.329859972485309, 31.89369415006234, 42.21352763985956, 23.09475553776383, 5.5130291656585975, 28.09413960256435, 23.00537371851614, 18.094951736845967, 12.486697908347642, 37.60393001464468, 4.1910109125075214, -16.461632965919016, 2.7122476580053707, -5.965299512780561, 2.4625878886531947, -0.6607458517219671, -5.73550754026509, -13.620193327101, -6.656061624648347, 27.278452963948368, 1.5844196210627337, 1.721008449597047, 17.80221970826843, 9.887526179122759, -3.227075339008646, 18.612986515163772, 8.198405684415691, 19.454636668385646, 7.10924297993574, -6.146516920822366, 19.58580369103195, 28.89297334742954, 1.9611593185890737, 25.785359155580153, 27.45932157744445, 2.381787766498981, 33.06884193534291, 29.516635762868212, 26.960922960204137, 24.10862897639287, 29.230426020593097, 5.99977139046246, -13.975417455704154, 25.210133792844736, 5.767487195736871, 41.29226336053593, 46.9516608737231, 4.967153975615016, 20.48923279954647, 19.407524096586343, -2.0788547239122277, 37.11232339429065, 32.20086708786568, 32.30382859002917, 30.564683676452976, 14.02886627713032, 3.884808430073422, 21.381937278981052, 30.703720792127534, 14.943456945509917, 7.316903125518289, 16.11366408304525, 11.554594153886102, -2.4835683658864482, 41.8232199712635, 32.387394700810816, 16.91533993514349, 40.047627113270494, 42.38637825660339, 32.84125873266218, 33.06160989018769, 19.28601824685047, 11.966057135149853, 25.54840052685835, 3.261749872202408, 16.486474106397665, 12.953142054591636, 30.959265732975318, 34.58556585303832, 17.62304035716938, 2.7569173275744276, -11.388772865258058, 41.951436395120666, 28.084042932462037, 1.997305511551625, -1.3917554618826538, 6.738716416049504, -14.913917747869462, 22.680149664548136, 34.76490226408953, 20.18568438773475, 25.92948904843871, 33.70813721630672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6297180910569544, "mean_inference_ms": 1.676507905161075, "mean_action_processing_ms": 0.25930014680716923, "mean_env_wait_ms": 0.1448803488518598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004610180854797363, "StateBufferConnector_ms": 0.0036574602127075195, "ViewRequirementAgentConnector_ms": 0.12053680419921875}, "num_episodes": 23, "episode_return_max": 44.12196211712951, "episode_return_min": -10.138127475874676, "episode_return_mean": 14.47756139719686, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.8587834381659, "num_env_steps_trained_throughput_per_sec": 290.8587834381659, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 32697.858, "restore_workers_time_ms": 0.041, "training_step_time_ms": 32697.571, "sample_time_ms": 1193.187, "learn_time_ms": 31471.416, "learn_throughput": 127.099, "synch_weights_time_ms": 31.059}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 78, "trial_id": "06536_00000", "date": "2024-08-11_17-28-06", "timestamp": 1723411686, "time_this_iter_s": 13.792712211608887, "time_total_s": 3229.5600864887238, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317125e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3229.5600864887238, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 59.52105263157894, "ram_util_percent": 83.48947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.716766270250082, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.032284172996879, "policy_loss": -0.010630432495478697, "vf_loss": 2.042902580772837, "vf_explained_var": 0.9572837065284451, "kl": 0.007695371476798011, "entropy": 0.5614839809325834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8450896961348398, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2059939854990236, "policy_loss": -0.0014684078475785635, "vf_loss": 2.2074623939852236, "vf_explained_var": 0.9559676961924033, "kl": 0.0032263447279173383, "entropy": 0.34330023700598056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "env_runners": {"episode_reward_max": 46.39933884697842, "episode_reward_min": -10.138127475874676, "episode_reward_mean": 15.657839652913333, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.39933884697837, "predator_policy": -17.05572313999253}, "policy_reward_max": {"prey_policy": 10.138127475874677, "predator_policy": 50.09727922699997}, "policy_reward_mean": {"prey_policy": -15.657839652913326, "predator_policy": 15.657839652913328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.60696292880503, 12.904647457030025, 9.714489474340432, -4.082160474212304, 28.65208449731575, 5.069851623095733, 15.017750722834874, 4.068985156394386, 13.20976733143642, 26.00628248712617, 0.9358374858321188, 7.826956088098166, 37.22314079681544, 13.59512618381297, -2.4118506074960235, 4.5786786812360685, -5.202670032094525, 10.00000688111433, 22.160317613530687, 7.7262077129345865, 2.721253313680844, 27.495601584536853, 19.023868081692235, 19.99865497329475, 14.287340303254284, 12.416838807902081, 9.07537118906102, 1.6377481593314691, 3.1218561785357615, 29.412284661729622, 8.33671690360444, 19.281497171358296, 2.1986262315599285, 18.010745430598853, 8.417011616006546, 12.561466936218961, 37.05361089496093, 14.303892351711209, 25.54975666054022, 15.290824822596798, 20.897470463576123, -6.874692653956826, -1.751355812063685, -3.1981266959935315, -10.138127475874676, 14.431436292505545, 9.76161407893275, 3.330225420057067, 13.405696099789736, 13.28193982416069, 6.719643385104799, 15.427066333009272, 26.622340366512283, 17.725314850920945, 28.23877936153618, 26.669527498492982, -3.9878230326208506, 15.488810494290803, 44.12196211712951, 12.728193387580754, 8.66433468633706, 34.65659524107814, 31.434256133241078, 8.956837353601895, 26.042829035554295, 11.130180035514137, 13.83412911846566, 19.669825802688536, 24.651367317977098, 41.21700268493702, 32.95143431142491, 15.626037691000153, 14.405075199530376, 14.719808080494698, 32.77241579300683, 10.189978842371929, 15.28133176493134, 15.040674222006844, 2.673480477083432, 3.8831159583393697, 27.47529332591214, 29.818813132372767, 23.266279461227917, 32.09273079052342, 14.286656427578494, 16.44995811811735, 10.979115777103026, 37.814838818464075, 46.39933884697842, 4.116712945892292, 17.933922335850475, 14.750505768633499, 15.602783059869193, 29.89634759819128, 16.17540520082149, -7.976873816349847, 12.803591297758768, 29.42764254118763, 24.86531882419502, 28.109602504205732], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.60696292880504, -12.904647457030034, -9.714489474340416, 4.08216047421232, -28.652084497315776, -5.069851623095792, -15.017750722834801, -4.068985156394376, -13.209767331436462, -26.006282487126107, -0.9358374858321321, -7.826956088098156, -37.2231407968155, -13.59512618381298, 2.4118506074960377, -4.578678681236077, 5.202670032094525, -10.000006881114341, -22.16031761353068, -7.726207712934568, -2.7212533136808474, -27.495601584536804, -19.023868081692243, -19.998654973294734, -14.287340303254268, -12.416838807902064, -9.075371189061023, -1.637748159331477, -3.1218561785357535, -29.412284661729583, -8.336716903604446, -19.28149717135833, -2.1986262315599205, -18.010745430598785, -8.417011616006526, -12.561466936218961, -37.053610894960954, -14.303892351711216, -25.549756660540258, -15.290824822596818, -20.8974704635761, 6.874692653956815, 1.7513558120636805, 3.198126695993534, 10.138127475874677, -14.431436292505552, -9.761614078932729, -3.330225420057049, -13.405696099789749, -13.281939824160705, -6.719643385104769, -15.42706633300928, -26.622340366512265, -17.725314850920956, -28.23877936153621, -26.669527498492997, 3.9878230326208524, -15.488810494290801, -44.121962117129534, -12.728193387580735, -8.664334686337057, -34.65659524107817, -31.434256133241078, -8.956837353601884, -26.04282903555429, -11.130180035514089, -13.834129118465647, -19.66982580268852, -24.651367317977137, -41.21700268493697, -32.951434311424954, -15.626037691000153, -14.405075199530408, -14.71980808049462, -32.77241579300681, -10.189978842371886, -15.281331764931299, -15.040674222006821, -2.6734804770834266, -3.8831159583393546, -27.475293325912123, -29.818813132372682, -23.266279461227924, -32.09273079052339, -14.286656427578503, -16.449958118117326, -10.979115777103024, -37.814838818464004, -46.39933884697837, -4.116712945892269, -17.93392233585048, -14.750505768633495, -15.60278305986919, -29.89634759819124, -16.175405200821483, 7.976873816349841, -12.803591297758775, -29.427642541187687, -24.865318824194993, -28.10960250420575], "policy_predator_policy_reward": [17.357980427313844, 9.855945430296222, 20.23562632247743, 5.573668591582633, 13.504001037864072, 5.924977910816763, 8.891402191567899, -17.05572313999253, 14.564055161630403, 42.74011383300109, 7.268063353722299, 2.8716398924692506, 6.2527538833826934, 23.782747562286975, -1.0813648473565962, 9.219335160145356, 19.133173414030992, 7.286361248841942, 25.324117490540353, 26.688447483711894, -1.9064228168503696, 3.7780977885146205, 8.696767066309881, 6.957145109886442, 47.119110868710976, 27.327170724920023, 14.087158547788812, 13.103093819837166, -4.18978811152566, -0.6339131034664138, -1.7063729606241065, 10.863730323096224, -5.169307670913408, -5.236032393275645, 15.62923985373247, 4.370773908496222, 29.731589781238085, 14.589045445823272, 0.756644715317556, 14.695770710551583, 5.011482052288795, 0.4310245750729056, 26.353934221020637, 28.637268948053023, 5.872137109795057, 32.17559905358944, 2.8523431942562194, 37.14496675233322, 18.322344970828684, 10.252335635679854, 2.24216818978618, 22.591509426017964, 0.09698491195570469, 18.053757466166342, 10.036079095839959, -6.760582777177023, 4.56851795443772, 1.6751944026337906, 17.460470287970058, 41.364099035489104, 12.301985190330244, 4.371448616878645, 18.406382571711845, 20.15661177100479, 3.1447010467918, 1.2525514163280382, 19.129105151278, 16.892385709919623, 18.970470385031167, -2.1364471530180715, 21.793073899952596, 3.329859972485309, 31.89369415006234, 42.21352763985956, 23.09475553776383, 5.5130291656585975, 28.09413960256435, 23.00537371851614, 18.094951736845967, 12.486697908347642, 37.60393001464468, 4.1910109125075214, -16.461632965919016, 2.7122476580053707, -5.965299512780561, 2.4625878886531947, -0.6607458517219671, -5.73550754026509, -13.620193327101, -6.656061624648347, 27.278452963948368, 1.5844196210627337, 1.721008449597047, 17.80221970826843, 9.887526179122759, -3.227075339008646, 18.612986515163772, 8.198405684415691, 19.454636668385646, 7.10924297993574, -6.146516920822366, 19.58580369103195, 28.89297334742954, 1.9611593185890737, 25.785359155580153, 27.45932157744445, 2.381787766498981, 33.06884193534291, 29.516635762868212, 26.960922960204137, 24.10862897639287, 29.230426020593097, 5.99977139046246, -13.975417455704154, 25.210133792844736, 5.767487195736871, 41.29226336053593, 46.9516608737231, 4.967153975615016, 20.48923279954647, 19.407524096586343, -2.0788547239122277, 37.11232339429065, 32.20086708786568, 32.30382859002917, 30.564683676452976, 14.02886627713032, 3.884808430073422, 21.381937278981052, 30.703720792127534, 14.943456945509917, 7.316903125518289, 16.11366408304525, 11.554594153886102, -2.4835683658864482, 41.8232199712635, 32.387394700810816, 16.91533993514349, 40.047627113270494, 42.38637825660339, 32.84125873266218, 33.06160989018769, 19.28601824685047, 11.966057135149853, 25.54840052685835, 3.261749872202408, 16.486474106397665, 12.953142054591636, 30.959265732975318, 34.58556585303832, 17.62304035716938, 2.7569173275744276, -11.388772865258058, 41.951436395120666, 28.084042932462037, 1.997305511551625, -1.3917554618826538, 6.738716416049504, -14.913917747869462, 22.680149664548136, 34.76490226408953, 20.18568438773475, 25.92948904843871, 33.70813721630672, 34.66475428279217, 11.86780463966368, 25.82465427455265, 38.36080730649409, -0.1301980036731356, 28.703510858830136, 11.462427556887116, 21.437488679347553, 15.953076981530685, 6.005154572675359, 35.077870775021196, 40.551806861906876, 50.09727922699997, 42.70139846695675, 9.166853200912923, -0.9334273091283496, 27.855687621085167, 8.012157050615784, 16.38887598854251, 13.11213554872447, 30.452567800863612, 0.7529983188747611, 28.481484574384474, 31.311210621997983, 16.73171740199767, 15.619092999645288, -1.3690855445270476, -14.584662088172646, 9.79027837000345, 15.816904225514106, 22.352182872244956, 36.503102210130386, 24.291183412805907, 25.439454235584094, 26.050923152192997, 30.16828185621852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6313919076243292, "mean_inference_ms": 1.6817008159882312, "mean_action_processing_ms": 0.25981468677722797, "mean_env_wait_ms": 0.14548647138499946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00755155086517334, "StateBufferConnector_ms": 0.00414121150970459, "ViewRequirementAgentConnector_ms": 0.14110803604125977}, "num_episodes": 18, "episode_return_max": 46.39933884697842, "episode_return_min": -10.138127475874676, "episode_return_mean": 15.657839652913333, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.0786173837892, "num_env_steps_trained_throughput_per_sec": 294.0786173837892, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 33108.875, "restore_workers_time_ms": 0.043, "training_step_time_ms": 33108.584, "sample_time_ms": 1325.247, "learn_time_ms": 31750.559, "learn_throughput": 125.982, "synch_weights_time_ms": 30.958}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "training_iteration": 79, "trial_id": "06536_00000", "date": "2024-08-11_17-28-20", "timestamp": 1723411700, "time_this_iter_s": 13.647042751312256, "time_total_s": 3243.207129240036, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3243.207129240036, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 56.85, "ram_util_percent": 83.11500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.705377537384629, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0083178603400786, "policy_loss": -0.0068209960477057996, "vf_loss": 2.015128161137303, "vf_explained_var": 0.9529152216389776, "kl": 0.0068442053879645155, "entropy": 0.5563582497959335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.965990823980362, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.343071638591706, "policy_loss": -0.0027616350734162897, "vf_loss": 2.3458332766931522, "vf_explained_var": 0.9562067505228456, "kl": 0.004796028274752044, "entropy": 0.2752256138062982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 46.39933884697842, "episode_reward_min": -10.138127475874676, "episode_reward_mean": 16.513232188077925, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.39933884697837, "predator_policy": -16.461632965919016}, "policy_reward_max": {"prey_policy": 10.138127475874677, "predator_policy": 54.96293454441708}, "policy_reward_mean": {"prey_policy": -16.51323218807792, "predator_policy": 16.51323218807792}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.023868081692235, 19.99865497329475, 14.287340303254284, 12.416838807902081, 9.07537118906102, 1.6377481593314691, 3.1218561785357615, 29.412284661729622, 8.33671690360444, 19.281497171358296, 2.1986262315599285, 18.010745430598853, 8.417011616006546, 12.561466936218961, 37.05361089496093, 14.303892351711209, 25.54975666054022, 15.290824822596798, 20.897470463576123, -6.874692653956826, -1.751355812063685, -3.1981266959935315, -10.138127475874676, 14.431436292505545, 9.76161407893275, 3.330225420057067, 13.405696099789736, 13.28193982416069, 6.719643385104799, 15.427066333009272, 26.622340366512283, 17.725314850920945, 28.23877936153618, 26.669527498492982, -3.9878230326208506, 15.488810494290803, 44.12196211712951, 12.728193387580754, 8.66433468633706, 34.65659524107814, 31.434256133241078, 8.956837353601895, 26.042829035554295, 11.130180035514137, 13.83412911846566, 19.669825802688536, 24.651367317977098, 41.21700268493702, 32.95143431142491, 15.626037691000153, 14.405075199530376, 14.719808080494698, 32.77241579300683, 10.189978842371929, 15.28133176493134, 15.040674222006844, 2.673480477083432, 3.8831159583393697, 27.47529332591214, 29.818813132372767, 23.266279461227917, 32.09273079052342, 14.286656427578494, 16.44995811811735, 10.979115777103026, 37.814838818464075, 46.39933884697842, 4.116712945892292, 17.933922335850475, 14.750505768633499, 15.602783059869193, 29.89634759819128, 16.17540520082149, -7.976873816349847, 12.803591297758768, 29.42764254118763, 24.86531882419502, 28.109602504205732, -7.521485457804381, 13.118730783959174, 1.2089655936889931, 20.482856402873047, 13.629239949374375, 6.444467976517604, 16.209319419190283, 7.889961697023215, 2.4430320043974714, 23.712039977637957, 1.995790994839278, 42.77486877698812, 15.822800952489015, 6.054178200291124, 7.000549537716717, 39.296750575765344, 25.328597448625665, 43.0091301284634, 7.756065615272721, 14.433459075538467, 21.630747539319017, 13.636453230460733], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.023868081692243, -19.998654973294734, -14.287340303254268, -12.416838807902064, -9.075371189061023, -1.637748159331477, -3.1218561785357535, -29.412284661729583, -8.336716903604446, -19.28149717135833, -2.1986262315599205, -18.010745430598785, -8.417011616006526, -12.561466936218961, -37.053610894960954, -14.303892351711216, -25.549756660540258, -15.290824822596818, -20.8974704635761, 6.874692653956815, 1.7513558120636805, 3.198126695993534, 10.138127475874677, -14.431436292505552, -9.761614078932729, -3.330225420057049, -13.405696099789749, -13.281939824160705, -6.719643385104769, -15.42706633300928, -26.622340366512265, -17.725314850920956, -28.23877936153621, -26.669527498492997, 3.9878230326208524, -15.488810494290801, -44.121962117129534, -12.728193387580735, -8.664334686337057, -34.65659524107817, -31.434256133241078, -8.956837353601884, -26.04282903555429, -11.130180035514089, -13.834129118465647, -19.66982580268852, -24.651367317977137, -41.21700268493697, -32.951434311424954, -15.626037691000153, -14.405075199530408, -14.71980808049462, -32.77241579300681, -10.189978842371886, -15.281331764931299, -15.040674222006821, -2.6734804770834266, -3.8831159583393546, -27.475293325912123, -29.818813132372682, -23.266279461227924, -32.09273079052339, -14.286656427578503, -16.449958118117326, -10.979115777103024, -37.814838818464004, -46.39933884697837, -4.116712945892269, -17.93392233585048, -14.750505768633495, -15.60278305986919, -29.89634759819124, -16.175405200821483, 7.976873816349841, -12.803591297758775, -29.427642541187687, -24.865318824194993, -28.10960250420575, 7.521485457804392, -13.118730783959158, -1.2089655936889923, -20.482856402873058, -13.629239949374394, -6.444467976517606, -16.20931941919028, -7.889961697023219, -2.4430320043974616, -23.712039977637907, -1.9957909948392842, -42.77486877698807, -15.822800952489011, -6.054178200291112, -7.0005495377167435, -39.29675057576536, -25.328597448625654, -43.009130128463404, -7.756065615272712, -14.43345907553851, -21.63074753931899, -13.636453230460713], "policy_predator_policy_reward": [5.872137109795057, 32.17559905358944, 2.8523431942562194, 37.14496675233322, 18.322344970828684, 10.252335635679854, 2.24216818978618, 22.591509426017964, 0.09698491195570469, 18.053757466166342, 10.036079095839959, -6.760582777177023, 4.56851795443772, 1.6751944026337906, 17.460470287970058, 41.364099035489104, 12.301985190330244, 4.371448616878645, 18.406382571711845, 20.15661177100479, 3.1447010467918, 1.2525514163280382, 19.129105151278, 16.892385709919623, 18.970470385031167, -2.1364471530180715, 21.793073899952596, 3.329859972485309, 31.89369415006234, 42.21352763985956, 23.09475553776383, 5.5130291656585975, 28.09413960256435, 23.00537371851614, 18.094951736845967, 12.486697908347642, 37.60393001464468, 4.1910109125075214, -16.461632965919016, 2.7122476580053707, -5.965299512780561, 2.4625878886531947, -0.6607458517219671, -5.73550754026509, -13.620193327101, -6.656061624648347, 27.278452963948368, 1.5844196210627337, 1.721008449597047, 17.80221970826843, 9.887526179122759, -3.227075339008646, 18.612986515163772, 8.198405684415691, 19.454636668385646, 7.10924297993574, -6.146516920822366, 19.58580369103195, 28.89297334742954, 1.9611593185890737, 25.785359155580153, 27.45932157744445, 2.381787766498981, 33.06884193534291, 29.516635762868212, 26.960922960204137, 24.10862897639287, 29.230426020593097, 5.99977139046246, -13.975417455704154, 25.210133792844736, 5.767487195736871, 41.29226336053593, 46.9516608737231, 4.967153975615016, 20.48923279954647, 19.407524096586343, -2.0788547239122277, 37.11232339429065, 32.20086708786568, 32.30382859002917, 30.564683676452976, 14.02886627713032, 3.884808430073422, 21.381937278981052, 30.703720792127534, 14.943456945509917, 7.316903125518289, 16.11366408304525, 11.554594153886102, -2.4835683658864482, 41.8232199712635, 32.387394700810816, 16.91533993514349, 40.047627113270494, 42.38637825660339, 32.84125873266218, 33.06160989018769, 19.28601824685047, 11.966057135149853, 25.54840052685835, 3.261749872202408, 16.486474106397665, 12.953142054591636, 30.959265732975318, 34.58556585303832, 17.62304035716938, 2.7569173275744276, -11.388772865258058, 41.951436395120666, 28.084042932462037, 1.997305511551625, -1.3917554618826538, 6.738716416049504, -14.913917747869462, 22.680149664548136, 34.76490226408953, 20.18568438773475, 25.92948904843871, 33.70813721630672, 34.66475428279217, 11.86780463966368, 25.82465427455265, 38.36080730649409, -0.1301980036731356, 28.703510858830136, 11.462427556887116, 21.437488679347553, 15.953076981530685, 6.005154572675359, 35.077870775021196, 40.551806861906876, 50.09727922699997, 42.70139846695675, 9.166853200912923, -0.9334273091283496, 27.855687621085167, 8.012157050615784, 16.38887598854251, 13.11213554872447, 30.452567800863612, 0.7529983188747611, 28.481484574384474, 31.311210621997983, 16.73171740199767, 15.619092999645288, -1.3690855445270476, -14.584662088172646, 9.79027837000345, 15.816904225514106, 22.352182872244956, 36.503102210130386, 24.291183412805907, 25.439454235584094, 26.050923152192997, 30.16828185621852, -9.722722866577275, -5.320248049031496, 30.40176990174732, -4.1643083338289895, -7.2374449794147955, 9.655376166792792, 32.5118418588301, 8.453870946915982, 17.82885934008565, 9.429620558663105, 16.222569813363332, -3.3336338603280886, 16.19472928012126, 16.22390955825928, -4.021181267466022, 19.80110466151247, -6.932377526395632, 11.818441535190555, 13.588397714063262, 33.83568224121255, -1.9600153685965402, 5.9515973582751265, 42.12322765929335, 43.42650989468285, 13.880125713879682, 17.76547619109833, 5.150937476228101, 6.957418924354142, 1.1275680320657688, 12.873531043367707, 54.96293454441708, 23.630566607113582, 14.846218524294661, 35.81097637295671, 36.46782746501678, 49.55043279191, -9.8150419405938, 25.327173171139247, 10.174192385443893, 18.692725765633103, 9.661460268651636, 33.60003480998634, 21.72904501319708, 5.5438614477243515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6335641707506103, "mean_inference_ms": 1.687001354399797, "mean_action_processing_ms": 0.26040612890934295, "mean_env_wait_ms": 0.14616712363359766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007454395294189453, "StateBufferConnector_ms": 0.003949403762817383, "ViewRequirementAgentConnector_ms": 0.1387726068496704}, "num_episodes": 22, "episode_return_max": 46.39933884697842, "episode_return_min": -10.138127475874676, "episode_return_mean": 16.513232188077925, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.71649747099605, "num_env_steps_trained_throughput_per_sec": 336.71649747099605, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 33359.549, "restore_workers_time_ms": 0.04, "training_step_time_ms": 33359.413, "sample_time_ms": 1342.147, "learn_time_ms": 31985.482, "learn_throughput": 125.057, "synch_weights_time_ms": 30.267}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 80, "trial_id": "06536_00000", "date": "2024-08-11_17-28-32", "timestamp": 1723411712, "time_this_iter_s": 11.92188286781311, "time_total_s": 3255.129012107849, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3255.129012107849, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 50.55882352941177, "ram_util_percent": 83.25882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.833133367324869, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1891910353054604, "policy_loss": -0.008253350169009839, "vf_loss": 2.19743288444976, "vf_explained_var": 0.9537661951035261, "kl": 0.007363626485311177, "entropy": 0.5458579022126894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.70386950789936, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3746278420327203, "policy_loss": -0.001687851348009808, "vf_loss": 2.376315692619041, "vf_explained_var": 0.9545295893830598, "kl": 0.0037503965983576655, "entropy": 0.2509658630799364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "env_runners": {"episode_reward_max": 46.39933884697842, "episode_reward_min": -10.138127475874676, "episode_reward_mean": 17.064389144931383, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.39933884697837, "predator_policy": -16.461632965919016}, "policy_reward_max": {"prey_policy": 10.138127475874677, "predator_policy": 56.14218574322908}, "policy_reward_mean": {"prey_policy": -17.064389144931383, "predator_policy": 17.06438914493138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.897470463576123, -6.874692653956826, -1.751355812063685, -3.1981266959935315, -10.138127475874676, 14.431436292505545, 9.76161407893275, 3.330225420057067, 13.405696099789736, 13.28193982416069, 6.719643385104799, 15.427066333009272, 26.622340366512283, 17.725314850920945, 28.23877936153618, 26.669527498492982, -3.9878230326208506, 15.488810494290803, 44.12196211712951, 12.728193387580754, 8.66433468633706, 34.65659524107814, 31.434256133241078, 8.956837353601895, 26.042829035554295, 11.130180035514137, 13.83412911846566, 19.669825802688536, 24.651367317977098, 41.21700268493702, 32.95143431142491, 15.626037691000153, 14.405075199530376, 14.719808080494698, 32.77241579300683, 10.189978842371929, 15.28133176493134, 15.040674222006844, 2.673480477083432, 3.8831159583393697, 27.47529332591214, 29.818813132372767, 23.266279461227917, 32.09273079052342, 14.286656427578494, 16.44995811811735, 10.979115777103026, 37.814838818464075, 46.39933884697842, 4.116712945892292, 17.933922335850475, 14.750505768633499, 15.602783059869193, 29.89634759819128, 16.17540520082149, -7.976873816349847, 12.803591297758768, 29.42764254118763, 24.86531882419502, 28.109602504205732, -7.521485457804381, 13.118730783959174, 1.2089655936889931, 20.482856402873047, 13.629239949374375, 6.444467976517604, 16.209319419190283, 7.889961697023215, 2.4430320043974714, 23.712039977637957, 1.995790994839278, 42.77486877698812, 15.822800952489015, 6.054178200291124, 7.000549537716717, 39.296750575765344, 25.328597448625665, 43.0091301284634, 7.756065615272721, 14.433459075538467, 21.630747539319017, 13.636453230460733, 18.374390691289616, 39.670275574997234, 17.938538198325258, 29.589828925022715, 5.743756799191548, 19.31060054108206, 15.056607538533667, 14.260812876948048, 9.44475445978633, 6.784403154450004, 11.255755783985439, -3.6946770656966095, 20.290661402836633, 35.548656321724955, 32.70032845163584, 22.170158979901316, 4.343771773948883, 26.305182651340264], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.8974704635761, 6.874692653956815, 1.7513558120636805, 3.198126695993534, 10.138127475874677, -14.431436292505552, -9.761614078932729, -3.330225420057049, -13.405696099789749, -13.281939824160705, -6.719643385104769, -15.42706633300928, -26.622340366512265, -17.725314850920956, -28.23877936153621, -26.669527498492997, 3.9878230326208524, -15.488810494290801, -44.121962117129534, -12.728193387580735, -8.664334686337057, -34.65659524107817, -31.434256133241078, -8.956837353601884, -26.04282903555429, -11.130180035514089, -13.834129118465647, -19.66982580268852, -24.651367317977137, -41.21700268493697, -32.951434311424954, -15.626037691000153, -14.405075199530408, -14.71980808049462, -32.77241579300681, -10.189978842371886, -15.281331764931299, -15.040674222006821, -2.6734804770834266, -3.8831159583393546, -27.475293325912123, -29.818813132372682, -23.266279461227924, -32.09273079052339, -14.286656427578503, -16.449958118117326, -10.979115777103024, -37.814838818464004, -46.39933884697837, -4.116712945892269, -17.93392233585048, -14.750505768633495, -15.60278305986919, -29.89634759819124, -16.175405200821483, 7.976873816349841, -12.803591297758775, -29.427642541187687, -24.865318824194993, -28.10960250420575, 7.521485457804392, -13.118730783959158, -1.2089655936889923, -20.482856402873058, -13.629239949374394, -6.444467976517606, -16.20931941919028, -7.889961697023219, -2.4430320043974616, -23.712039977637907, -1.9957909948392842, -42.77486877698807, -15.822800952489011, -6.054178200291112, -7.0005495377167435, -39.29675057576536, -25.328597448625654, -43.009130128463404, -7.756065615272712, -14.43345907553851, -21.63074753931899, -13.636453230460713, -18.374390691289598, -39.670275574997255, -17.938538198325233, -29.589828925022708, -5.743756799191544, -19.310600541082035, -15.056607538533665, -14.260812876948044, -9.444754459786305, -6.7844031544500005, -11.25575578398543, 3.694677065696613, -20.290661402836626, -35.54865632172498, -32.70032845163582, -22.17015897990138, -4.343771773948895, -26.305182651340274], "policy_predator_policy_reward": [37.60393001464468, 4.1910109125075214, -16.461632965919016, 2.7122476580053707, -5.965299512780561, 2.4625878886531947, -0.6607458517219671, -5.73550754026509, -13.620193327101, -6.656061624648347, 27.278452963948368, 1.5844196210627337, 1.721008449597047, 17.80221970826843, 9.887526179122759, -3.227075339008646, 18.612986515163772, 8.198405684415691, 19.454636668385646, 7.10924297993574, -6.146516920822366, 19.58580369103195, 28.89297334742954, 1.9611593185890737, 25.785359155580153, 27.45932157744445, 2.381787766498981, 33.06884193534291, 29.516635762868212, 26.960922960204137, 24.10862897639287, 29.230426020593097, 5.99977139046246, -13.975417455704154, 25.210133792844736, 5.767487195736871, 41.29226336053593, 46.9516608737231, 4.967153975615016, 20.48923279954647, 19.407524096586343, -2.0788547239122277, 37.11232339429065, 32.20086708786568, 32.30382859002917, 30.564683676452976, 14.02886627713032, 3.884808430073422, 21.381937278981052, 30.703720792127534, 14.943456945509917, 7.316903125518289, 16.11366408304525, 11.554594153886102, -2.4835683658864482, 41.8232199712635, 32.387394700810816, 16.91533993514349, 40.047627113270494, 42.38637825660339, 32.84125873266218, 33.06160989018769, 19.28601824685047, 11.966057135149853, 25.54840052685835, 3.261749872202408, 16.486474106397665, 12.953142054591636, 30.959265732975318, 34.58556585303832, 17.62304035716938, 2.7569173275744276, -11.388772865258058, 41.951436395120666, 28.084042932462037, 1.997305511551625, -1.3917554618826538, 6.738716416049504, -14.913917747869462, 22.680149664548136, 34.76490226408953, 20.18568438773475, 25.92948904843871, 33.70813721630672, 34.66475428279217, 11.86780463966368, 25.82465427455265, 38.36080730649409, -0.1301980036731356, 28.703510858830136, 11.462427556887116, 21.437488679347553, 15.953076981530685, 6.005154572675359, 35.077870775021196, 40.551806861906876, 50.09727922699997, 42.70139846695675, 9.166853200912923, -0.9334273091283496, 27.855687621085167, 8.012157050615784, 16.38887598854251, 13.11213554872447, 30.452567800863612, 0.7529983188747611, 28.481484574384474, 31.311210621997983, 16.73171740199767, 15.619092999645288, -1.3690855445270476, -14.584662088172646, 9.79027837000345, 15.816904225514106, 22.352182872244956, 36.503102210130386, 24.291183412805907, 25.439454235584094, 26.050923152192997, 30.16828185621852, -9.722722866577275, -5.320248049031496, 30.40176990174732, -4.1643083338289895, -7.2374449794147955, 9.655376166792792, 32.5118418588301, 8.453870946915982, 17.82885934008565, 9.429620558663105, 16.222569813363332, -3.3336338603280886, 16.19472928012126, 16.22390955825928, -4.021181267466022, 19.80110466151247, -6.932377526395632, 11.818441535190555, 13.588397714063262, 33.83568224121255, -1.9600153685965402, 5.9515973582751265, 42.12322765929335, 43.42650989468285, 13.880125713879682, 17.76547619109833, 5.150937476228101, 6.957418924354142, 1.1275680320657688, 12.873531043367707, 54.96293454441708, 23.630566607113582, 14.846218524294661, 35.81097637295671, 36.46782746501678, 49.55043279191, -9.8150419405938, 25.327173171139247, 10.174192385443893, 18.692725765633103, 9.661460268651636, 33.60003480998634, 21.72904501319708, 5.5438614477243515, 20.744315889052647, 16.00446549352658, 23.198365406765475, 56.14218574322908, 5.932423720007895, 29.944652676642637, 31.080541506504595, 28.099116343540857, 11.487164460252634, 0.0003491381304687735, 10.403168848085592, 28.218032234078503, 24.49036799254677, 5.62284708452056, 15.230475240054055, 13.291150513842068, 2.5129104766598402, 16.37659844291277, -9.594700757464949, 23.16350706636495, -7.087731893591787, 29.59924346156263, -3.439487729896765, -3.9498664014964575, 29.332192704918857, 11.249130100754405, 37.47492062412412, 33.62239201932579, 50.21866625204217, 15.18199065122946, 7.690923635757997, 36.64939432404477, 4.327353718391315, 4.3601898295064725, 17.878998770964028, 34.731366531716496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6347623387673444, "mean_inference_ms": 1.6921673966504747, "mean_action_processing_ms": 0.26091618444642306, "mean_env_wait_ms": 0.14676720048847458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014769315719604492, "StateBufferConnector_ms": 0.004198431968688965, "ViewRequirementAgentConnector_ms": 0.1454411745071411}, "num_episodes": 18, "episode_return_max": 46.39933884697842, "episode_return_min": -10.138127475874676, "episode_return_mean": 17.064389144931383, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.14601373651584, "num_env_steps_trained_throughput_per_sec": 317.14601373651584, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 33733.357, "restore_workers_time_ms": 0.041, "training_step_time_ms": 33733.186, "sample_time_ms": 1371.499, "learn_time_ms": 32328.215, "learn_throughput": 123.731, "synch_weights_time_ms": 31.747}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "training_iteration": 81, "trial_id": "06536_00000", "date": "2024-08-11_17-28-45", "timestamp": 1723411725, "time_this_iter_s": 12.65286898612976, "time_total_s": 3267.781881093979, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316da940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3267.781881093979, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 55.91666666666667, "ram_util_percent": 82.67777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.99858864483734, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.348892196516196, "policy_loss": -0.008852445767843165, "vf_loss": 2.3577300661553937, "vf_explained_var": 0.9360071669022242, "kl": 0.009328696461960521, "entropy": 0.5455524851257603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9225635233379545, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5302167355698884, "policy_loss": -0.0029899422673104457, "vf_loss": 2.533206676743018, "vf_explained_var": 0.9397663261209216, "kl": 0.005342863911524228, "entropy": 0.26127761886233375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 55.9267801501578, "episode_reward_min": -8.890591200945456, "episode_reward_mean": 17.380246471796237, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.926780150157846, "predator_policy": -14.913917747869462}, "policy_reward_max": {"prey_policy": 8.890591200945456, "predator_policy": 58.13982007222575}, "policy_reward_mean": {"prey_policy": -17.38024647179623, "predator_policy": 17.38024647179623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.956837353601895, 26.042829035554295, 11.130180035514137, 13.83412911846566, 19.669825802688536, 24.651367317977098, 41.21700268493702, 32.95143431142491, 15.626037691000153, 14.405075199530376, 14.719808080494698, 32.77241579300683, 10.189978842371929, 15.28133176493134, 15.040674222006844, 2.673480477083432, 3.8831159583393697, 27.47529332591214, 29.818813132372767, 23.266279461227917, 32.09273079052342, 14.286656427578494, 16.44995811811735, 10.979115777103026, 37.814838818464075, 46.39933884697842, 4.116712945892292, 17.933922335850475, 14.750505768633499, 15.602783059869193, 29.89634759819128, 16.17540520082149, -7.976873816349847, 12.803591297758768, 29.42764254118763, 24.86531882419502, 28.109602504205732, -7.521485457804381, 13.118730783959174, 1.2089655936889931, 20.482856402873047, 13.629239949374375, 6.444467976517604, 16.209319419190283, 7.889961697023215, 2.4430320043974714, 23.712039977637957, 1.995790994839278, 42.77486877698812, 15.822800952489015, 6.054178200291124, 7.000549537716717, 39.296750575765344, 25.328597448625665, 43.0091301284634, 7.756065615272721, 14.433459075538467, 21.630747539319017, 13.636453230460733, 18.374390691289616, 39.670275574997234, 17.938538198325258, 29.589828925022715, 5.743756799191548, 19.31060054108206, 15.056607538533667, 14.260812876948048, 9.44475445978633, 6.784403154450004, 11.255755783985439, -3.6946770656966095, 20.290661402836633, 35.548656321724955, 32.70032845163584, 22.170158979901316, 4.343771773948883, 26.305182651340264, 19.764095030308845, 10.906884914031226, 12.265522809692488, 22.461314446402106, 8.736478935942008, 11.805531338223153, 7.965640835648456, 24.469735235312758, 3.233715278975014, 15.09368109684347, 19.781136910857718, 10.637852157477365, 4.503600766571903, 13.204676395166489, 19.181958655446323, 24.764136504540744, -8.890591200945456, 16.221172545510104, 7.182589216202993, 28.08993727385801, 55.9267801501578, 8.218265137369093, 13.716698616639006], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.956837353601884, -26.04282903555429, -11.130180035514089, -13.834129118465647, -19.66982580268852, -24.651367317977137, -41.21700268493697, -32.951434311424954, -15.626037691000153, -14.405075199530408, -14.71980808049462, -32.77241579300681, -10.189978842371886, -15.281331764931299, -15.040674222006821, -2.6734804770834266, -3.8831159583393546, -27.475293325912123, -29.818813132372682, -23.266279461227924, -32.09273079052339, -14.286656427578503, -16.449958118117326, -10.979115777103024, -37.814838818464004, -46.39933884697837, -4.116712945892269, -17.93392233585048, -14.750505768633495, -15.60278305986919, -29.89634759819124, -16.175405200821483, 7.976873816349841, -12.803591297758775, -29.427642541187687, -24.865318824194993, -28.10960250420575, 7.521485457804392, -13.118730783959158, -1.2089655936889923, -20.482856402873058, -13.629239949374394, -6.444467976517606, -16.20931941919028, -7.889961697023219, -2.4430320043974616, -23.712039977637907, -1.9957909948392842, -42.77486877698807, -15.822800952489011, -6.054178200291112, -7.0005495377167435, -39.29675057576536, -25.328597448625654, -43.009130128463404, -7.756065615272712, -14.43345907553851, -21.63074753931899, -13.636453230460713, -18.374390691289598, -39.670275574997255, -17.938538198325233, -29.589828925022708, -5.743756799191544, -19.310600541082035, -15.056607538533665, -14.260812876948044, -9.444754459786305, -6.7844031544500005, -11.25575578398543, 3.694677065696613, -20.290661402836626, -35.54865632172498, -32.70032845163582, -22.17015897990138, -4.343771773948895, -26.305182651340274, -19.76409503030881, -10.906884914031236, -12.265522809692467, -22.461314446402078, -8.736478935942012, -11.805531338223187, -7.9656408356484505, -24.469735235312744, -3.2337152789750103, -15.093681096843465, -19.781136910857725, -10.637852157477361, -4.5036007665718785, -13.204676395166462, -19.18195865544632, -24.764136504540716, 8.890591200945456, -16.221172545510125, -7.182589216203034, -28.089937273858013, -55.926780150157846, -8.218265137369087, -13.716698616638974], "policy_predator_policy_reward": [14.02886627713032, 3.884808430073422, 21.381937278981052, 30.703720792127534, 14.943456945509917, 7.316903125518289, 16.11366408304525, 11.554594153886102, -2.4835683658864482, 41.8232199712635, 32.387394700810816, 16.91533993514349, 40.047627113270494, 42.38637825660339, 32.84125873266218, 33.06160989018769, 19.28601824685047, 11.966057135149853, 25.54840052685835, 3.261749872202408, 16.486474106397665, 12.953142054591636, 30.959265732975318, 34.58556585303832, 17.62304035716938, 2.7569173275744276, -11.388772865258058, 41.951436395120666, 28.084042932462037, 1.997305511551625, -1.3917554618826538, 6.738716416049504, -14.913917747869462, 22.680149664548136, 34.76490226408953, 20.18568438773475, 25.92948904843871, 33.70813721630672, 34.66475428279217, 11.86780463966368, 25.82465427455265, 38.36080730649409, -0.1301980036731356, 28.703510858830136, 11.462427556887116, 21.437488679347553, 15.953076981530685, 6.005154572675359, 35.077870775021196, 40.551806861906876, 50.09727922699997, 42.70139846695675, 9.166853200912923, -0.9334273091283496, 27.855687621085167, 8.012157050615784, 16.38887598854251, 13.11213554872447, 30.452567800863612, 0.7529983188747611, 28.481484574384474, 31.311210621997983, 16.73171740199767, 15.619092999645288, -1.3690855445270476, -14.584662088172646, 9.79027837000345, 15.816904225514106, 22.352182872244956, 36.503102210130386, 24.291183412805907, 25.439454235584094, 26.050923152192997, 30.16828185621852, -9.722722866577275, -5.320248049031496, 30.40176990174732, -4.1643083338289895, -7.2374449794147955, 9.655376166792792, 32.5118418588301, 8.453870946915982, 17.82885934008565, 9.429620558663105, 16.222569813363332, -3.3336338603280886, 16.19472928012126, 16.22390955825928, -4.021181267466022, 19.80110466151247, -6.932377526395632, 11.818441535190555, 13.588397714063262, 33.83568224121255, -1.9600153685965402, 5.9515973582751265, 42.12322765929335, 43.42650989468285, 13.880125713879682, 17.76547619109833, 5.150937476228101, 6.957418924354142, 1.1275680320657688, 12.873531043367707, 54.96293454441708, 23.630566607113582, 14.846218524294661, 35.81097637295671, 36.46782746501678, 49.55043279191, -9.8150419405938, 25.327173171139247, 10.174192385443893, 18.692725765633103, 9.661460268651636, 33.60003480998634, 21.72904501319708, 5.5438614477243515, 20.744315889052647, 16.00446549352658, 23.198365406765475, 56.14218574322908, 5.932423720007895, 29.944652676642637, 31.080541506504595, 28.099116343540857, 11.487164460252634, 0.0003491381304687735, 10.403168848085592, 28.218032234078503, 24.49036799254677, 5.62284708452056, 15.230475240054055, 13.291150513842068, 2.5129104766598402, 16.37659844291277, -9.594700757464949, 23.16350706636495, -7.087731893591787, 29.59924346156263, -3.439487729896765, -3.9498664014964575, 29.332192704918857, 11.249130100754405, 37.47492062412412, 33.62239201932579, 50.21866625204217, 15.18199065122946, 7.690923635757997, 36.64939432404477, 4.327353718391315, 4.3601898295064725, 17.878998770964028, 34.731366531716496, 18.59221314094646, 20.935976919671194, 3.811053954345196, 18.002715873717268, 14.601415240268881, 9.929630379116066, 38.02294356275747, 6.8996853300467205, 13.843149706360277, 3.6298081655237375, 0.7025757121951015, 22.90848696425126, 5.970470082581302, 9.960811588715611, 11.816711860782032, 37.122758609843416, 1.7944265366741785, 4.673004021275842, 16.205565016101808, 13.981797177585161, 30.73891714790014, 8.82335667381532, 9.48246924496899, 11.793235069985734, 11.065041253609856, -2.0578397204660916, 7.457358555220656, 18.951994235112345, 4.220646790485805, 34.14327052040683, 18.79575297142759, 30.732520037653863, -9.44538921822149, -8.335793183669427, 7.589170632704679, 24.85317445831555, 13.748298528331967, 0.6168799040740467, 26.651932947549973, 29.52794160016603, 53.71374022808994, 58.13982007222575, 10.30689856017849, 6.129631714559675, 12.509695823142199, 14.923701410135788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6360918133945028, "mean_inference_ms": 1.6984390445934157, "mean_action_processing_ms": 0.2614363309056447, "mean_env_wait_ms": 0.1475253910058713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015760064125061035, "StateBufferConnector_ms": 0.004150390625, "ViewRequirementAgentConnector_ms": 0.1637732982635498}, "num_episodes": 23, "episode_return_max": 55.9267801501578, "episode_return_min": -8.890591200945456, "episode_return_mean": 17.380246471796237, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.21767726932296, "num_env_steps_trained_throughput_per_sec": 320.21767726932296, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 34137.525, "restore_workers_time_ms": 0.043, "training_step_time_ms": 34137.336, "sample_time_ms": 1449.303, "learn_time_ms": 32653.584, "learn_throughput": 122.498, "synch_weights_time_ms": 32.623}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 82, "trial_id": "06536_00000", "date": "2024-08-11_17-28-57", "timestamp": 1723411737, "time_this_iter_s": 12.532424211502075, "time_total_s": 3280.314305305481, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33175d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3280.314305305481, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 54.611111111111114, "ram_util_percent": 81.69444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8630912272880473, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1621265078584355, "policy_loss": -0.006216914474013417, "vf_loss": 2.1683352410793306, "vf_explained_var": 0.9424212119852503, "kl": 0.00523193831870028, "entropy": 0.5302224520904323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8983255960323193, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.336217541606338, "policy_loss": -0.00796312151486596, "vf_loss": 2.3441806650666335, "vf_explained_var": 0.9464547185355393, "kl": 0.02935953224034289, "entropy": 0.3451380804811836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "env_runners": {"episode_reward_max": 55.9267801501578, "episode_reward_min": -10.609097880688285, "episode_reward_mean": 16.37037163410621, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.926780150157846, "predator_policy": -14.584662088172646}, "policy_reward_max": {"prey_policy": 10.609097880688275, "predator_policy": 58.13982007222575}, "policy_reward_mean": {"prey_policy": -16.370371634106206, "predator_policy": 16.37037163410621}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.818813132372767, 23.266279461227917, 32.09273079052342, 14.286656427578494, 16.44995811811735, 10.979115777103026, 37.814838818464075, 46.39933884697842, 4.116712945892292, 17.933922335850475, 14.750505768633499, 15.602783059869193, 29.89634759819128, 16.17540520082149, -7.976873816349847, 12.803591297758768, 29.42764254118763, 24.86531882419502, 28.109602504205732, -7.521485457804381, 13.118730783959174, 1.2089655936889931, 20.482856402873047, 13.629239949374375, 6.444467976517604, 16.209319419190283, 7.889961697023215, 2.4430320043974714, 23.712039977637957, 1.995790994839278, 42.77486877698812, 15.822800952489015, 6.054178200291124, 7.000549537716717, 39.296750575765344, 25.328597448625665, 43.0091301284634, 7.756065615272721, 14.433459075538467, 21.630747539319017, 13.636453230460733, 18.374390691289616, 39.670275574997234, 17.938538198325258, 29.589828925022715, 5.743756799191548, 19.31060054108206, 15.056607538533667, 14.260812876948048, 9.44475445978633, 6.784403154450004, 11.255755783985439, -3.6946770656966095, 20.290661402836633, 35.548656321724955, 32.70032845163584, 22.170158979901316, 4.343771773948883, 26.305182651340264, 19.764095030308845, 10.906884914031226, 12.265522809692488, 22.461314446402106, 8.736478935942008, 11.805531338223153, 7.965640835648456, 24.469735235312758, 3.233715278975014, 15.09368109684347, 19.781136910857718, 10.637852157477365, 4.503600766571903, 13.204676395166489, 19.181958655446323, 24.764136504540744, -8.890591200945456, 16.221172545510104, 7.182589216202993, 28.08993727385801, 55.9267801501578, 8.218265137369093, 13.716698616639006, 7.931200246888446, 27.632417803700548, 22.271936401350683, 23.735633213364935, 40.382691742933744, 17.6272605420159, -0.4745983655755488, 14.436092458996562, -9.14070644572787, 14.487771666738022, 12.71511443146007, -1.998409040090821, 16.233687491110302, 6.4445050653519225, 11.247918812205935, 23.163356892018847, -10.609097880688285, 13.446558209784557], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.818813132372682, -23.266279461227924, -32.09273079052339, -14.286656427578503, -16.449958118117326, -10.979115777103024, -37.814838818464004, -46.39933884697837, -4.116712945892269, -17.93392233585048, -14.750505768633495, -15.60278305986919, -29.89634759819124, -16.175405200821483, 7.976873816349841, -12.803591297758775, -29.427642541187687, -24.865318824194993, -28.10960250420575, 7.521485457804392, -13.118730783959158, -1.2089655936889923, -20.482856402873058, -13.629239949374394, -6.444467976517606, -16.20931941919028, -7.889961697023219, -2.4430320043974616, -23.712039977637907, -1.9957909948392842, -42.77486877698807, -15.822800952489011, -6.054178200291112, -7.0005495377167435, -39.29675057576536, -25.328597448625654, -43.009130128463404, -7.756065615272712, -14.43345907553851, -21.63074753931899, -13.636453230460713, -18.374390691289598, -39.670275574997255, -17.938538198325233, -29.589828925022708, -5.743756799191544, -19.310600541082035, -15.056607538533665, -14.260812876948044, -9.444754459786305, -6.7844031544500005, -11.25575578398543, 3.694677065696613, -20.290661402836626, -35.54865632172498, -32.70032845163582, -22.17015897990138, -4.343771773948895, -26.305182651340274, -19.76409503030881, -10.906884914031236, -12.265522809692467, -22.461314446402078, -8.736478935942012, -11.805531338223187, -7.9656408356484505, -24.469735235312744, -3.2337152789750103, -15.093681096843465, -19.781136910857725, -10.637852157477361, -4.5036007665718785, -13.204676395166462, -19.18195865544632, -24.764136504540716, 8.890591200945456, -16.221172545510125, -7.182589216203034, -28.089937273858013, -55.926780150157846, -8.218265137369087, -13.716698616638974, -7.931200246888435, -27.63241780370054, -22.271936401350708, -23.73563321336494, -40.382691742933744, -17.627260542015875, 0.4745983655755355, -14.43609245899656, 9.14070644572786, -14.487771666738011, -12.715114431460082, 1.998409040090821, -16.233687491110388, -6.444505065351921, -11.247918812205928, -23.163356892018832, 10.609097880688275, -13.44655820978454], "policy_predator_policy_reward": [25.92948904843871, 33.70813721630672, 34.66475428279217, 11.86780463966368, 25.82465427455265, 38.36080730649409, -0.1301980036731356, 28.703510858830136, 11.462427556887116, 21.437488679347553, 15.953076981530685, 6.005154572675359, 35.077870775021196, 40.551806861906876, 50.09727922699997, 42.70139846695675, 9.166853200912923, -0.9334273091283496, 27.855687621085167, 8.012157050615784, 16.38887598854251, 13.11213554872447, 30.452567800863612, 0.7529983188747611, 28.481484574384474, 31.311210621997983, 16.73171740199767, 15.619092999645288, -1.3690855445270476, -14.584662088172646, 9.79027837000345, 15.816904225514106, 22.352182872244956, 36.503102210130386, 24.291183412805907, 25.439454235584094, 26.050923152192997, 30.16828185621852, -9.722722866577275, -5.320248049031496, 30.40176990174732, -4.1643083338289895, -7.2374449794147955, 9.655376166792792, 32.5118418588301, 8.453870946915982, 17.82885934008565, 9.429620558663105, 16.222569813363332, -3.3336338603280886, 16.19472928012126, 16.22390955825928, -4.021181267466022, 19.80110466151247, -6.932377526395632, 11.818441535190555, 13.588397714063262, 33.83568224121255, -1.9600153685965402, 5.9515973582751265, 42.12322765929335, 43.42650989468285, 13.880125713879682, 17.76547619109833, 5.150937476228101, 6.957418924354142, 1.1275680320657688, 12.873531043367707, 54.96293454441708, 23.630566607113582, 14.846218524294661, 35.81097637295671, 36.46782746501678, 49.55043279191, -9.8150419405938, 25.327173171139247, 10.174192385443893, 18.692725765633103, 9.661460268651636, 33.60003480998634, 21.72904501319708, 5.5438614477243515, 20.744315889052647, 16.00446549352658, 23.198365406765475, 56.14218574322908, 5.932423720007895, 29.944652676642637, 31.080541506504595, 28.099116343540857, 11.487164460252634, 0.0003491381304687735, 10.403168848085592, 28.218032234078503, 24.49036799254677, 5.62284708452056, 15.230475240054055, 13.291150513842068, 2.5129104766598402, 16.37659844291277, -9.594700757464949, 23.16350706636495, -7.087731893591787, 29.59924346156263, -3.439487729896765, -3.9498664014964575, 29.332192704918857, 11.249130100754405, 37.47492062412412, 33.62239201932579, 50.21866625204217, 15.18199065122946, 7.690923635757997, 36.64939432404477, 4.327353718391315, 4.3601898295064725, 17.878998770964028, 34.731366531716496, 18.59221314094646, 20.935976919671194, 3.811053954345196, 18.002715873717268, 14.601415240268881, 9.929630379116066, 38.02294356275747, 6.8996853300467205, 13.843149706360277, 3.6298081655237375, 0.7025757121951015, 22.90848696425126, 5.970470082581302, 9.960811588715611, 11.816711860782032, 37.122758609843416, 1.7944265366741785, 4.673004021275842, 16.205565016101808, 13.981797177585161, 30.73891714790014, 8.82335667381532, 9.48246924496899, 11.793235069985734, 11.065041253609856, -2.0578397204660916, 7.457358555220656, 18.951994235112345, 4.220646790485805, 34.14327052040683, 18.79575297142759, 30.732520037653863, -9.44538921822149, -8.335793183669427, 7.589170632704679, 24.85317445831555, 13.748298528331967, 0.6168799040740467, 26.651932947549973, 29.52794160016603, 53.71374022808994, 58.13982007222575, 10.30689856017849, 6.129631714559675, 12.509695823142199, 14.923701410135788, -2.2772622587982427, 18.139662752575102, 36.70307502713878, 18.561760580262312, 23.854751639227942, 20.689121163473462, 1.4559267449654811, 46.015339681764395, 48.2658708930388, 32.499512592828644, 18.21731125591687, 17.037209828114868, -6.3153175561927295, 5.366120825041643, 16.666235701692194, 12.205949216300905, -6.081470149021205, -12.199942742434514, 10.147372283998653, 18.82817104947737, 5.035487850184396, 20.394741012735782, 7.44968836550694, -11.44650644568859, 17.714373750355062, 14.753001231865651, 16.756626736875056, -3.8676166061711834, 12.935052749888996, 9.56078487452287, 27.267063758752606, 19.059650025285066, -8.198135901456052, -13.0200598599205, 11.866300559848037, 15.026815859721053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6380162455564418, "mean_inference_ms": 1.701160732758748, "mean_action_processing_ms": 0.26171987515243905, "mean_env_wait_ms": 0.14775864488732599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01565682888031006, "StateBufferConnector_ms": 0.004084110260009766, "ViewRequirementAgentConnector_ms": 0.15702736377716064}, "num_episodes": 18, "episode_return_max": 55.9267801501578, "episode_return_min": -10.609097880688285, "episode_return_mean": 16.37037163410621, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.80432559902346, "num_env_steps_trained_throughput_per_sec": 294.80432559902346, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 11999.708, "restore_workers_time_ms": 0.045, "training_step_time_ms": 11999.505, "sample_time_ms": 1506.871, "learn_time_ms": 10458.054, "learn_throughput": 382.48, "synch_weights_time_ms": 32.867}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "training_iteration": 83, "trial_id": "06536_00000", "date": "2024-08-11_17-29-11", "timestamp": 1723411751, "time_this_iter_s": 13.61470103263855, "time_total_s": 3293.9290063381195, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310c1040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3293.9290063381195, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 62.642105263157895, "ram_util_percent": 82.72105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.681646131227414, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9862479315449795, "policy_loss": -0.010484804928516193, "vf_loss": 2.9967165163407725, "vf_explained_var": 0.9333828847234448, "kl": 0.01037657350332301, "entropy": 0.4959368309316536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.74141492452571, "cur_kl_coeff": 1.0913936421275136e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.519682651726657, "policy_loss": -0.003457265389619996, "vf_loss": 3.5231399103447245, "vf_explained_var": 0.9219767019231483, "kl": 0.0066316541877271965, "entropy": 0.4197019914470652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 55.9267801501578, "episode_reward_min": -10.609097880688285, "episode_reward_mean": 15.111708495393348, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.926780150157846, "predator_policy": -16.7503901101595}, "policy_reward_max": {"prey_policy": 10.609097880688275, "predator_policy": 58.13982007222575}, "policy_reward_mean": {"prey_policy": -15.111708495393342, "predator_policy": 15.111708495393346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.109602504205732, -7.521485457804381, 13.118730783959174, 1.2089655936889931, 20.482856402873047, 13.629239949374375, 6.444467976517604, 16.209319419190283, 7.889961697023215, 2.4430320043974714, 23.712039977637957, 1.995790994839278, 42.77486877698812, 15.822800952489015, 6.054178200291124, 7.000549537716717, 39.296750575765344, 25.328597448625665, 43.0091301284634, 7.756065615272721, 14.433459075538467, 21.630747539319017, 13.636453230460733, 18.374390691289616, 39.670275574997234, 17.938538198325258, 29.589828925022715, 5.743756799191548, 19.31060054108206, 15.056607538533667, 14.260812876948048, 9.44475445978633, 6.784403154450004, 11.255755783985439, -3.6946770656966095, 20.290661402836633, 35.548656321724955, 32.70032845163584, 22.170158979901316, 4.343771773948883, 26.305182651340264, 19.764095030308845, 10.906884914031226, 12.265522809692488, 22.461314446402106, 8.736478935942008, 11.805531338223153, 7.965640835648456, 24.469735235312758, 3.233715278975014, 15.09368109684347, 19.781136910857718, 10.637852157477365, 4.503600766571903, 13.204676395166489, 19.181958655446323, 24.764136504540744, -8.890591200945456, 16.221172545510104, 7.182589216202993, 28.08993727385801, 55.9267801501578, 8.218265137369093, 13.716698616639006, 7.931200246888446, 27.632417803700548, 22.271936401350683, 23.735633213364935, 40.382691742933744, 17.6272605420159, -0.4745983655755488, 14.436092458996562, -9.14070644572787, 14.487771666738022, 12.71511443146007, -1.998409040090821, 16.233687491110302, 6.4445050653519225, 11.247918812205935, 23.163356892018847, -10.609097880688285, 13.446558209784557, 18.24573515769644, 1.1686676881109221, 7.466850752192538, -10.570299383331006, 11.208004374212797, 21.35265925968469, 22.544492070117865, 23.953610101527623, 15.522178410202136, 29.80412505464124, 24.9648999545851, 23.818941536569575, -1.6181471943221335, 18.49642939858109, 0.9400736901252849, 16.999772469694015, 22.826834564205374, -4.2880546473650565], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.10960250420575, 7.521485457804392, -13.118730783959158, -1.2089655936889923, -20.482856402873058, -13.629239949374394, -6.444467976517606, -16.20931941919028, -7.889961697023219, -2.4430320043974616, -23.712039977637907, -1.9957909948392842, -42.77486877698807, -15.822800952489011, -6.054178200291112, -7.0005495377167435, -39.29675057576536, -25.328597448625654, -43.009130128463404, -7.756065615272712, -14.43345907553851, -21.63074753931899, -13.636453230460713, -18.374390691289598, -39.670275574997255, -17.938538198325233, -29.589828925022708, -5.743756799191544, -19.310600541082035, -15.056607538533665, -14.260812876948044, -9.444754459786305, -6.7844031544500005, -11.25575578398543, 3.694677065696613, -20.290661402836626, -35.54865632172498, -32.70032845163582, -22.17015897990138, -4.343771773948895, -26.305182651340274, -19.76409503030881, -10.906884914031236, -12.265522809692467, -22.461314446402078, -8.736478935942012, -11.805531338223187, -7.9656408356484505, -24.469735235312744, -3.2337152789750103, -15.093681096843465, -19.781136910857725, -10.637852157477361, -4.5036007665718785, -13.204676395166462, -19.18195865544632, -24.764136504540716, 8.890591200945456, -16.221172545510125, -7.182589216203034, -28.089937273858013, -55.926780150157846, -8.218265137369087, -13.716698616638974, -7.931200246888435, -27.63241780370054, -22.271936401350708, -23.73563321336494, -40.382691742933744, -17.627260542015875, 0.4745983655755355, -14.43609245899656, 9.14070644572786, -14.487771666738011, -12.715114431460082, 1.998409040090821, -16.233687491110388, -6.444505065351921, -11.247918812205928, -23.163356892018832, 10.609097880688275, -13.44655820978454, -18.245735157696455, -1.168667688110915, -7.46685075219254, 10.57029938333101, -11.208004374212798, -21.35265925968468, -22.54449207011787, -23.95361010152766, -15.522178410202134, -29.8041250546413, -24.96489995458513, -23.818941536569596, 1.6181471943221326, -18.496429398581096, -0.940073690125315, -16.999772469694022, -22.82683456420534, 4.288054647365042], "policy_predator_policy_reward": [26.050923152192997, 30.16828185621852, -9.722722866577275, -5.320248049031496, 30.40176990174732, -4.1643083338289895, -7.2374449794147955, 9.655376166792792, 32.5118418588301, 8.453870946915982, 17.82885934008565, 9.429620558663105, 16.222569813363332, -3.3336338603280886, 16.19472928012126, 16.22390955825928, -4.021181267466022, 19.80110466151247, -6.932377526395632, 11.818441535190555, 13.588397714063262, 33.83568224121255, -1.9600153685965402, 5.9515973582751265, 42.12322765929335, 43.42650989468285, 13.880125713879682, 17.76547619109833, 5.150937476228101, 6.957418924354142, 1.1275680320657688, 12.873531043367707, 54.96293454441708, 23.630566607113582, 14.846218524294661, 35.81097637295671, 36.46782746501678, 49.55043279191, -9.8150419405938, 25.327173171139247, 10.174192385443893, 18.692725765633103, 9.661460268651636, 33.60003480998634, 21.72904501319708, 5.5438614477243515, 20.744315889052647, 16.00446549352658, 23.198365406765475, 56.14218574322908, 5.932423720007895, 29.944652676642637, 31.080541506504595, 28.099116343540857, 11.487164460252634, 0.0003491381304687735, 10.403168848085592, 28.218032234078503, 24.49036799254677, 5.62284708452056, 15.230475240054055, 13.291150513842068, 2.5129104766598402, 16.37659844291277, -9.594700757464949, 23.16350706636495, -7.087731893591787, 29.59924346156263, -3.439487729896765, -3.9498664014964575, 29.332192704918857, 11.249130100754405, 37.47492062412412, 33.62239201932579, 50.21866625204217, 15.18199065122946, 7.690923635757997, 36.64939432404477, 4.327353718391315, 4.3601898295064725, 17.878998770964028, 34.731366531716496, 18.59221314094646, 20.935976919671194, 3.811053954345196, 18.002715873717268, 14.601415240268881, 9.929630379116066, 38.02294356275747, 6.8996853300467205, 13.843149706360277, 3.6298081655237375, 0.7025757121951015, 22.90848696425126, 5.970470082581302, 9.960811588715611, 11.816711860782032, 37.122758609843416, 1.7944265366741785, 4.673004021275842, 16.205565016101808, 13.981797177585161, 30.73891714790014, 8.82335667381532, 9.48246924496899, 11.793235069985734, 11.065041253609856, -2.0578397204660916, 7.457358555220656, 18.951994235112345, 4.220646790485805, 34.14327052040683, 18.79575297142759, 30.732520037653863, -9.44538921822149, -8.335793183669427, 7.589170632704679, 24.85317445831555, 13.748298528331967, 0.6168799040740467, 26.651932947549973, 29.52794160016603, 53.71374022808994, 58.13982007222575, 10.30689856017849, 6.129631714559675, 12.509695823142199, 14.923701410135788, -2.2772622587982427, 18.139662752575102, 36.70307502713878, 18.561760580262312, 23.854751639227942, 20.689121163473462, 1.4559267449654811, 46.015339681764395, 48.2658708930388, 32.499512592828644, 18.21731125591687, 17.037209828114868, -6.3153175561927295, 5.366120825041643, 16.666235701692194, 12.205949216300905, -6.081470149021205, -12.199942742434514, 10.147372283998653, 18.82817104947737, 5.035487850184396, 20.394741012735782, 7.44968836550694, -11.44650644568859, 17.714373750355062, 14.753001231865651, 16.756626736875056, -3.8676166061711834, 12.935052749888996, 9.56078487452287, 27.267063758752606, 19.059650025285066, -8.198135901456052, -13.0200598599205, 11.866300559848037, 15.026815859721053, 28.577404983350064, 7.914065332042851, 5.620889330984149, -3.283553954762306, 1.9295323995360145, 13.004169104849066, -16.7503901101595, -4.390208656502516, 19.592710269565806, 2.8232984788598063, 25.372239920855684, 17.333078598513673, 15.764995923134151, 29.323988217101558, 33.15441161253494, 14.752808590520342, 31.166477622381873, -0.12212080197756592, 30.502815979527334, 29.10543412975524, 15.053173769064864, 34.876626140105365, 14.245062131160482, 33.3928209419787, -2.331070219568586, -0.905224169075681, 7.753730750274773, 29.23912804688743, -4.074138990894722, 5.954286371145352, 21.335699280662666, 12.663845658725371, 31.1519008856645, 14.50176824274625, -14.021742477871534, 5.445633183141439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6384868558057764, "mean_inference_ms": 1.7016164340283324, "mean_action_processing_ms": 0.26170728735881854, "mean_env_wait_ms": 0.14779342479142407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012611150741577148, "StateBufferConnector_ms": 0.006705164909362793, "ViewRequirementAgentConnector_ms": 0.14167046546936035}, "num_episodes": 18, "episode_return_max": 55.9267801501578, "episode_return_min": -10.609097880688285, "episode_return_mean": 15.111708495393348, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.1720035251713, "num_env_steps_trained_throughput_per_sec": 332.1720035251713, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 12157.86, "restore_workers_time_ms": 0.045, "training_step_time_ms": 12157.662, "sample_time_ms": 1485.896, "learn_time_ms": 10642.767, "learn_throughput": 375.842, "synch_weights_time_ms": 27.317}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 84, "trial_id": "06536_00000", "date": "2024-08-11_17-29-23", "timestamp": 1723411763, "time_this_iter_s": 12.077441930770874, "time_total_s": 3306.0064482688904, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317125e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3306.0064482688904, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 52.32941176470588, "ram_util_percent": 82.31764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8180202174931765, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8288908754785855, "policy_loss": -0.007195448505323536, "vf_loss": 2.8360752142965793, "vf_explained_var": 0.9370287927488486, "kl": 0.007110730207145477, "entropy": 0.522002387760828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.878528943579033, "cur_kl_coeff": 1.0913936421275136e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3599810747873216, "policy_loss": -0.0031507287865563754, "vf_loss": 3.363131806080934, "vf_explained_var": 0.9308627589669808, "kl": 0.005072651844656711, "entropy": 0.38819056208486913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "env_runners": {"episode_reward_max": 55.9267801501578, "episode_reward_min": -10.609097880688285, "episode_reward_mean": 14.427952111906176, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.926780150157846, "predator_policy": -17.148314735485982}, "policy_reward_max": {"prey_policy": 10.609097880688275, "predator_policy": 58.13982007222575}, "policy_reward_mean": {"prey_policy": -14.427952111906182, "predator_policy": 14.42795211190618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.636453230460733, 18.374390691289616, 39.670275574997234, 17.938538198325258, 29.589828925022715, 5.743756799191548, 19.31060054108206, 15.056607538533667, 14.260812876948048, 9.44475445978633, 6.784403154450004, 11.255755783985439, -3.6946770656966095, 20.290661402836633, 35.548656321724955, 32.70032845163584, 22.170158979901316, 4.343771773948883, 26.305182651340264, 19.764095030308845, 10.906884914031226, 12.265522809692488, 22.461314446402106, 8.736478935942008, 11.805531338223153, 7.965640835648456, 24.469735235312758, 3.233715278975014, 15.09368109684347, 19.781136910857718, 10.637852157477365, 4.503600766571903, 13.204676395166489, 19.181958655446323, 24.764136504540744, -8.890591200945456, 16.221172545510104, 7.182589216202993, 28.08993727385801, 55.9267801501578, 8.218265137369093, 13.716698616639006, 7.931200246888446, 27.632417803700548, 22.271936401350683, 23.735633213364935, 40.382691742933744, 17.6272605420159, -0.4745983655755488, 14.436092458996562, -9.14070644572787, 14.487771666738022, 12.71511443146007, -1.998409040090821, 16.233687491110302, 6.4445050653519225, 11.247918812205935, 23.163356892018847, -10.609097880688285, 13.446558209784557, 18.24573515769644, 1.1686676881109221, 7.466850752192538, -10.570299383331006, 11.208004374212797, 21.35265925968469, 22.544492070117865, 23.953610101527623, 15.522178410202136, 29.80412505464124, 24.9648999545851, 23.818941536569575, -1.6181471943221335, 18.49642939858109, 0.9400736901252849, 16.999772469694015, 22.826834564205374, -4.2880546473650565, -7.4599149508999485, 2.617137922689701, 19.744720439538536, 8.430305037659707, 10.76695978436, 13.70935140092901, 6.752487916506604, -5.091060266271125, 11.035737606510741, 28.908256178261656, 26.65695778834992, -9.865117345963272, 20.5022169746252, 6.99683329656609, 16.05108095709968, 25.759032752519712, 20.875042685487962, 31.422245854062716, 17.18173649121475, 16.896243839175064, 13.706947190765181, 6.856829794467962], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.636453230460713, -18.374390691289598, -39.670275574997255, -17.938538198325233, -29.589828925022708, -5.743756799191544, -19.310600541082035, -15.056607538533665, -14.260812876948044, -9.444754459786305, -6.7844031544500005, -11.25575578398543, 3.694677065696613, -20.290661402836626, -35.54865632172498, -32.70032845163582, -22.17015897990138, -4.343771773948895, -26.305182651340274, -19.76409503030881, -10.906884914031236, -12.265522809692467, -22.461314446402078, -8.736478935942012, -11.805531338223187, -7.9656408356484505, -24.469735235312744, -3.2337152789750103, -15.093681096843465, -19.781136910857725, -10.637852157477361, -4.5036007665718785, -13.204676395166462, -19.18195865544632, -24.764136504540716, 8.890591200945456, -16.221172545510125, -7.182589216203034, -28.089937273858013, -55.926780150157846, -8.218265137369087, -13.716698616638974, -7.931200246888435, -27.63241780370054, -22.271936401350708, -23.73563321336494, -40.382691742933744, -17.627260542015875, 0.4745983655755355, -14.43609245899656, 9.14070644572786, -14.487771666738011, -12.715114431460082, 1.998409040090821, -16.233687491110388, -6.444505065351921, -11.247918812205928, -23.163356892018832, 10.609097880688275, -13.44655820978454, -18.245735157696455, -1.168667688110915, -7.46685075219254, 10.57029938333101, -11.208004374212798, -21.35265925968468, -22.54449207011787, -23.95361010152766, -15.522178410202134, -29.8041250546413, -24.96489995458513, -23.818941536569596, 1.6181471943221326, -18.496429398581096, -0.940073690125315, -16.999772469694022, -22.82683456420534, 4.288054647365042, 7.459914950899947, -2.617137922689688, -19.744720439538586, -8.430305037659734, -10.766959784360022, -13.709351400928998, -6.752487916506631, 5.091060266271128, -11.035737606510764, -28.908256178261606, -26.656957788349928, 9.865117345963267, -20.502216974625195, -6.99683329656608, -16.0510809570997, -25.75903275251974, -20.875042685487966, -31.422245854062677, -17.18173649121475, -16.896243839175085, -13.706947190765174, -6.8568297944679735], "policy_predator_policy_reward": [21.72904501319708, 5.5438614477243515, 20.744315889052647, 16.00446549352658, 23.198365406765475, 56.14218574322908, 5.932423720007895, 29.944652676642637, 31.080541506504595, 28.099116343540857, 11.487164460252634, 0.0003491381304687735, 10.403168848085592, 28.218032234078503, 24.49036799254677, 5.62284708452056, 15.230475240054055, 13.291150513842068, 2.5129104766598402, 16.37659844291277, -9.594700757464949, 23.16350706636495, -7.087731893591787, 29.59924346156263, -3.439487729896765, -3.9498664014964575, 29.332192704918857, 11.249130100754405, 37.47492062412412, 33.62239201932579, 50.21866625204217, 15.18199065122946, 7.690923635757997, 36.64939432404477, 4.327353718391315, 4.3601898295064725, 17.878998770964028, 34.731366531716496, 18.59221314094646, 20.935976919671194, 3.811053954345196, 18.002715873717268, 14.601415240268881, 9.929630379116066, 38.02294356275747, 6.8996853300467205, 13.843149706360277, 3.6298081655237375, 0.7025757121951015, 22.90848696425126, 5.970470082581302, 9.960811588715611, 11.816711860782032, 37.122758609843416, 1.7944265366741785, 4.673004021275842, 16.205565016101808, 13.981797177585161, 30.73891714790014, 8.82335667381532, 9.48246924496899, 11.793235069985734, 11.065041253609856, -2.0578397204660916, 7.457358555220656, 18.951994235112345, 4.220646790485805, 34.14327052040683, 18.79575297142759, 30.732520037653863, -9.44538921822149, -8.335793183669427, 7.589170632704679, 24.85317445831555, 13.748298528331967, 0.6168799040740467, 26.651932947549973, 29.52794160016603, 53.71374022808994, 58.13982007222575, 10.30689856017849, 6.129631714559675, 12.509695823142199, 14.923701410135788, -2.2772622587982427, 18.139662752575102, 36.70307502713878, 18.561760580262312, 23.854751639227942, 20.689121163473462, 1.4559267449654811, 46.015339681764395, 48.2658708930388, 32.499512592828644, 18.21731125591687, 17.037209828114868, -6.3153175561927295, 5.366120825041643, 16.666235701692194, 12.205949216300905, -6.081470149021205, -12.199942742434514, 10.147372283998653, 18.82817104947737, 5.035487850184396, 20.394741012735782, 7.44968836550694, -11.44650644568859, 17.714373750355062, 14.753001231865651, 16.756626736875056, -3.8676166061711834, 12.935052749888996, 9.56078487452287, 27.267063758752606, 19.059650025285066, -8.198135901456052, -13.0200598599205, 11.866300559848037, 15.026815859721053, 28.577404983350064, 7.914065332042851, 5.620889330984149, -3.283553954762306, 1.9295323995360145, 13.004169104849066, -16.7503901101595, -4.390208656502516, 19.592710269565806, 2.8232984788598063, 25.372239920855684, 17.333078598513673, 15.764995923134151, 29.323988217101558, 33.15441161253494, 14.752808590520342, 31.166477622381873, -0.12212080197756592, 30.502815979527334, 29.10543412975524, 15.053173769064864, 34.876626140105365, 14.245062131160482, 33.3928209419787, -2.331070219568586, -0.905224169075681, 7.753730750274773, 29.23912804688743, -4.074138990894722, 5.954286371145352, 21.335699280662666, 12.663845658725371, 31.1519008856645, 14.50176824274625, -14.021742477871534, 5.445633183141439, -4.163161611873708, -10.75666828992619, -1.2787945356543116, 6.513070381033696, 24.98745217584025, 14.501988703236869, 2.6915601497241184, 14.169049925595303, 5.9109263383311035, 15.622993230388904, 21.695846419201082, 5.722856382656932, 0.6632296901944112, 12.84174614281882, -11.422737687939318, 1.2406171553970626, 8.335947127025225, 13.735528085996314, 28.562887637782836, 29.253624718740458, 33.16740981596823, 20.146505760731593, -2.581919956440556, -17.148314735485982, 25.02604322421265, 15.978390725037736, 20.224086391915883, -6.23041979878373, 15.233600350953491, 16.868561563245883, 29.38531917654113, 22.1327463284983, 6.548636444254786, 35.20144892672116, 32.83536688407683, 30.00912482404855, 25.844832308941427, 8.51864067348809, 14.89188528628095, 18.90060239206921, 3.991338900620949, 23.42255548090941, 7.86729440669481, 5.846365182241133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6391467233556605, "mean_inference_ms": 1.7023638913148316, "mean_action_processing_ms": 0.26171585339210096, "mean_env_wait_ms": 0.14791139713626186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012666940689086914, "StateBufferConnector_ms": 0.006759166717529297, "ViewRequirementAgentConnector_ms": 0.14336395263671875}, "num_episodes": 22, "episode_return_max": 55.9267801501578, "episode_return_min": -10.609097880688285, "episode_return_mean": 14.427952111906176, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.4768948448205, "num_env_steps_trained_throughput_per_sec": 342.4768948448205, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 12329.003, "restore_workers_time_ms": 0.043, "training_step_time_ms": 12328.721, "sample_time_ms": 1488.743, "learn_time_ms": 10809.75, "learn_throughput": 370.036, "synch_weights_time_ms": 28.488}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "training_iteration": 85, "trial_id": "06536_00000", "date": "2024-08-11_17-29-35", "timestamp": 1723411775, "time_this_iter_s": 11.743918180465698, "time_total_s": 3317.750366449356, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3317.750366449356, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 51.311764705882354, "ram_util_percent": 82.02352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8472743507474663, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5970995026330153, "policy_loss": -0.005482367880176753, "vf_loss": 2.602572153881192, "vf_explained_var": 0.9415221807236472, "kl": 0.006221460942883213, "entropy": 0.5224153328686952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.01608469511466, "cur_kl_coeff": 1.0913936421275136e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8943920848230835, "policy_loss": -0.0040376244817500705, "vf_loss": 2.8984297053523793, "vf_explained_var": 0.9456240669760124, "kl": 0.0069359421504914575, "entropy": 0.3339071301950349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 55.9267801501578, "episode_reward_min": -10.609097880688285, "episode_reward_mean": 14.002473571406039, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.926780150157846, "predator_policy": -17.148314735485982}, "policy_reward_max": {"prey_policy": 10.609097880688275, "predator_policy": 58.13982007222575}, "policy_reward_mean": {"prey_policy": -14.002473571406043, "predator_policy": 14.002473571406044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.305182651340264, 19.764095030308845, 10.906884914031226, 12.265522809692488, 22.461314446402106, 8.736478935942008, 11.805531338223153, 7.965640835648456, 24.469735235312758, 3.233715278975014, 15.09368109684347, 19.781136910857718, 10.637852157477365, 4.503600766571903, 13.204676395166489, 19.181958655446323, 24.764136504540744, -8.890591200945456, 16.221172545510104, 7.182589216202993, 28.08993727385801, 55.9267801501578, 8.218265137369093, 13.716698616639006, 7.931200246888446, 27.632417803700548, 22.271936401350683, 23.735633213364935, 40.382691742933744, 17.6272605420159, -0.4745983655755488, 14.436092458996562, -9.14070644572787, 14.487771666738022, 12.71511443146007, -1.998409040090821, 16.233687491110302, 6.4445050653519225, 11.247918812205935, 23.163356892018847, -10.609097880688285, 13.446558209784557, 18.24573515769644, 1.1686676881109221, 7.466850752192538, -10.570299383331006, 11.208004374212797, 21.35265925968469, 22.544492070117865, 23.953610101527623, 15.522178410202136, 29.80412505464124, 24.9648999545851, 23.818941536569575, -1.6181471943221335, 18.49642939858109, 0.9400736901252849, 16.999772469694015, 22.826834564205374, -4.2880546473650565, -7.4599149508999485, 2.617137922689701, 19.744720439538536, 8.430305037659707, 10.76695978436, 13.70935140092901, 6.752487916506604, -5.091060266271125, 11.035737606510741, 28.908256178261656, 26.65695778834992, -9.865117345963272, 20.5022169746252, 6.99683329656609, 16.05108095709968, 25.759032752519712, 20.875042685487962, 31.422245854062716, 17.18173649121475, 16.896243839175064, 13.706947190765181, 6.856829794467962, 14.316406719959186, 14.979834933322147, 15.059770129564756, 32.27699175190772, 10.081915093802106, 32.4083165662108, 5.871440629185118, 21.874727279160016, 3.2162013713952717, 6.914938763220456, -3.0887197001716826, 6.254469354955569, 17.729808037977524, 13.79523524129606, 26.890437035744792, 23.280543681509748, 15.663841110662124, 12.351065588708343], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.305182651340274, -19.76409503030881, -10.906884914031236, -12.265522809692467, -22.461314446402078, -8.736478935942012, -11.805531338223187, -7.9656408356484505, -24.469735235312744, -3.2337152789750103, -15.093681096843465, -19.781136910857725, -10.637852157477361, -4.5036007665718785, -13.204676395166462, -19.18195865544632, -24.764136504540716, 8.890591200945456, -16.221172545510125, -7.182589216203034, -28.089937273858013, -55.926780150157846, -8.218265137369087, -13.716698616638974, -7.931200246888435, -27.63241780370054, -22.271936401350708, -23.73563321336494, -40.382691742933744, -17.627260542015875, 0.4745983655755355, -14.43609245899656, 9.14070644572786, -14.487771666738011, -12.715114431460082, 1.998409040090821, -16.233687491110388, -6.444505065351921, -11.247918812205928, -23.163356892018832, 10.609097880688275, -13.44655820978454, -18.245735157696455, -1.168667688110915, -7.46685075219254, 10.57029938333101, -11.208004374212798, -21.35265925968468, -22.54449207011787, -23.95361010152766, -15.522178410202134, -29.8041250546413, -24.96489995458513, -23.818941536569596, 1.6181471943221326, -18.496429398581096, -0.940073690125315, -16.999772469694022, -22.82683456420534, 4.288054647365042, 7.459914950899947, -2.617137922689688, -19.744720439538586, -8.430305037659734, -10.766959784360022, -13.709351400928998, -6.752487916506631, 5.091060266271128, -11.035737606510764, -28.908256178261606, -26.656957788349928, 9.865117345963267, -20.502216974625195, -6.99683329656608, -16.0510809570997, -25.75903275251974, -20.875042685487966, -31.422245854062677, -17.18173649121475, -16.896243839175085, -13.706947190765174, -6.8568297944679735, -14.316406719959184, -14.97983493332221, -15.059770129564779, -32.27699175190767, -10.081915093802106, -32.40831656621077, -5.871440629185123, -21.874727279159973, -3.2162013713952717, -6.914938763220465, 3.0887197001716835, -6.25446935495557, -17.72980803797754, -13.795235241296059, -26.8904370357448, -23.28054368150975, -15.663841110662107, -12.351065588708316], "policy_predator_policy_reward": [17.878998770964028, 34.731366531716496, 18.59221314094646, 20.935976919671194, 3.811053954345196, 18.002715873717268, 14.601415240268881, 9.929630379116066, 38.02294356275747, 6.8996853300467205, 13.843149706360277, 3.6298081655237375, 0.7025757121951015, 22.90848696425126, 5.970470082581302, 9.960811588715611, 11.816711860782032, 37.122758609843416, 1.7944265366741785, 4.673004021275842, 16.205565016101808, 13.981797177585161, 30.73891714790014, 8.82335667381532, 9.48246924496899, 11.793235069985734, 11.065041253609856, -2.0578397204660916, 7.457358555220656, 18.951994235112345, 4.220646790485805, 34.14327052040683, 18.79575297142759, 30.732520037653863, -9.44538921822149, -8.335793183669427, 7.589170632704679, 24.85317445831555, 13.748298528331967, 0.6168799040740467, 26.651932947549973, 29.52794160016603, 53.71374022808994, 58.13982007222575, 10.30689856017849, 6.129631714559675, 12.509695823142199, 14.923701410135788, -2.2772622587982427, 18.139662752575102, 36.70307502713878, 18.561760580262312, 23.854751639227942, 20.689121163473462, 1.4559267449654811, 46.015339681764395, 48.2658708930388, 32.499512592828644, 18.21731125591687, 17.037209828114868, -6.3153175561927295, 5.366120825041643, 16.666235701692194, 12.205949216300905, -6.081470149021205, -12.199942742434514, 10.147372283998653, 18.82817104947737, 5.035487850184396, 20.394741012735782, 7.44968836550694, -11.44650644568859, 17.714373750355062, 14.753001231865651, 16.756626736875056, -3.8676166061711834, 12.935052749888996, 9.56078487452287, 27.267063758752606, 19.059650025285066, -8.198135901456052, -13.0200598599205, 11.866300559848037, 15.026815859721053, 28.577404983350064, 7.914065332042851, 5.620889330984149, -3.283553954762306, 1.9295323995360145, 13.004169104849066, -16.7503901101595, -4.390208656502516, 19.592710269565806, 2.8232984788598063, 25.372239920855684, 17.333078598513673, 15.764995923134151, 29.323988217101558, 33.15441161253494, 14.752808590520342, 31.166477622381873, -0.12212080197756592, 30.502815979527334, 29.10543412975524, 15.053173769064864, 34.876626140105365, 14.245062131160482, 33.3928209419787, -2.331070219568586, -0.905224169075681, 7.753730750274773, 29.23912804688743, -4.074138990894722, 5.954286371145352, 21.335699280662666, 12.663845658725371, 31.1519008856645, 14.50176824274625, -14.021742477871534, 5.445633183141439, -4.163161611873708, -10.75666828992619, -1.2787945356543116, 6.513070381033696, 24.98745217584025, 14.501988703236869, 2.6915601497241184, 14.169049925595303, 5.9109263383311035, 15.622993230388904, 21.695846419201082, 5.722856382656932, 0.6632296901944112, 12.84174614281882, -11.422737687939318, 1.2406171553970626, 8.335947127025225, 13.735528085996314, 28.562887637782836, 29.253624718740458, 33.16740981596823, 20.146505760731593, -2.581919956440556, -17.148314735485982, 25.02604322421265, 15.978390725037736, 20.224086391915883, -6.23041979878373, 15.233600350953491, 16.868561563245883, 29.38531917654113, 22.1327463284983, 6.548636444254786, 35.20144892672116, 32.83536688407683, 30.00912482404855, 25.844832308941427, 8.51864067348809, 14.89188528628095, 18.90060239206921, 3.991338900620949, 23.42255548090941, 7.86729440669481, 5.846365182241133, 23.09682504747088, 5.535988392447489, 4.879156386549022, 25.080513480095377, 24.522668543211502, 5.596871715918045, 16.07357662023937, 48.48040688357604, 14.53024362314208, 5.633586564462137, 28.284216776537704, 36.53241635588384, 3.5504484034494173, 8.192432854920824, 14.256598021954563, 29.492856536365423, 12.503109572504275, -6.070706829713732, 9.654667956593755, 4.1752095698471745, -15.602598282472687, 9.425158882129315, 6.476694423035077, 6.032244286876079, 19.241285077175956, 16.218330998779116, 34.33707477681759, -6.746604294225501, 40.16149847234204, 13.619375599147554, 35.6549074560066, 10.906179907012909, 19.644096166638604, 11.683586054685632, 30.44730919409757, -5.745178016680885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6395665661467514, "mean_inference_ms": 1.7026729251820365, "mean_action_processing_ms": 0.26167385293003936, "mean_env_wait_ms": 0.14794788108619175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005401492118835449, "StateBufferConnector_ms": 0.006507515907287598, "ViewRequirementAgentConnector_ms": 0.13738393783569336}, "num_episodes": 18, "episode_return_max": 55.9267801501578, "episode_return_min": -10.609097880688285, "episode_return_mean": 14.002473571406039, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.8748277870425, "num_env_steps_trained_throughput_per_sec": 370.8748277870425, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 12465.752, "restore_workers_time_ms": 0.045, "training_step_time_ms": 12465.467, "sample_time_ms": 1481.478, "learn_time_ms": 10954.216, "learn_throughput": 365.156, "synch_weights_time_ms": 27.777}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 86, "trial_id": "06536_00000", "date": "2024-08-11_17-29-46", "timestamp": 1723411786, "time_this_iter_s": 10.832971096038818, "time_total_s": 3328.583337545395, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331714280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3328.583337545395, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 46.98666666666667, "ram_util_percent": 82.27333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.952103077992797, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.402131392930945, "policy_loss": -0.0066346659999301965, "vf_loss": 2.408755912880103, "vf_explained_var": 0.9593528407315414, "kl": 0.006493299936792792, "entropy": 0.4930909017721812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.039639873794778, "cur_kl_coeff": 1.0913936421275136e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8880289137678803, "policy_loss": -0.0015550714928568119, "vf_loss": 2.8895839902459, "vf_explained_var": 0.9544233595252668, "kl": 0.0038552710909496445, "entropy": 0.35902640409570524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "env_runners": {"episode_reward_max": 41.296493027845855, "episode_reward_min": -12.10878401191643, "episode_reward_mean": 14.655039098717111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.296493027845806, "predator_policy": -17.148314735485982}, "policy_reward_max": {"prey_policy": 12.108784011916422, "predator_policy": 48.48040688357604}, "policy_reward_mean": {"prey_policy": -14.655039098717113, "predator_policy": 14.655039098717111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.716698616639006, 7.931200246888446, 27.632417803700548, 22.271936401350683, 23.735633213364935, 40.382691742933744, 17.6272605420159, -0.4745983655755488, 14.436092458996562, -9.14070644572787, 14.487771666738022, 12.71511443146007, -1.998409040090821, 16.233687491110302, 6.4445050653519225, 11.247918812205935, 23.163356892018847, -10.609097880688285, 13.446558209784557, 18.24573515769644, 1.1686676881109221, 7.466850752192538, -10.570299383331006, 11.208004374212797, 21.35265925968469, 22.544492070117865, 23.953610101527623, 15.522178410202136, 29.80412505464124, 24.9648999545851, 23.818941536569575, -1.6181471943221335, 18.49642939858109, 0.9400736901252849, 16.999772469694015, 22.826834564205374, -4.2880546473650565, -7.4599149508999485, 2.617137922689701, 19.744720439538536, 8.430305037659707, 10.76695978436, 13.70935140092901, 6.752487916506604, -5.091060266271125, 11.035737606510741, 28.908256178261656, 26.65695778834992, -9.865117345963272, 20.5022169746252, 6.99683329656609, 16.05108095709968, 25.759032752519712, 20.875042685487962, 31.422245854062716, 17.18173649121475, 16.896243839175064, 13.706947190765181, 6.856829794467962, 14.316406719959186, 14.979834933322147, 15.059770129564756, 32.27699175190772, 10.081915093802106, 32.4083165662108, 5.871440629185118, 21.874727279160016, 3.2162013713952717, 6.914938763220456, -3.0887197001716826, 6.254469354955569, 17.729808037977524, 13.79523524129606, 26.890437035744792, 23.280543681509748, 15.663841110662124, 12.351065588708343, 13.723778098102493, 29.061465849213874, 1.7001875067348777, 33.95331066371916, 19.413389239243376, 3.9254104693250147, 5.377636718063708, 8.144595103011063, 11.338373580819933, 36.05406432632501, 21.461707964545, 17.968230199814577, 41.296493027845855, 10.111479360546683, -12.10878401191643, 18.011423106104875, 22.21512743250618, 22.639986917611207, 21.81415227157664, 9.432288049474263, 20.759942325580887, 37.38624058201017, 33.40535103578117], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.716698616638974, -7.931200246888435, -27.63241780370054, -22.271936401350708, -23.73563321336494, -40.382691742933744, -17.627260542015875, 0.4745983655755355, -14.43609245899656, 9.14070644572786, -14.487771666738011, -12.715114431460082, 1.998409040090821, -16.233687491110388, -6.444505065351921, -11.247918812205928, -23.163356892018832, 10.609097880688275, -13.44655820978454, -18.245735157696455, -1.168667688110915, -7.46685075219254, 10.57029938333101, -11.208004374212798, -21.35265925968468, -22.54449207011787, -23.95361010152766, -15.522178410202134, -29.8041250546413, -24.96489995458513, -23.818941536569596, 1.6181471943221326, -18.496429398581096, -0.940073690125315, -16.999772469694022, -22.82683456420534, 4.288054647365042, 7.459914950899947, -2.617137922689688, -19.744720439538586, -8.430305037659734, -10.766959784360022, -13.709351400928998, -6.752487916506631, 5.091060266271128, -11.035737606510764, -28.908256178261606, -26.656957788349928, 9.865117345963267, -20.502216974625195, -6.99683329656608, -16.0510809570997, -25.75903275251974, -20.875042685487966, -31.422245854062677, -17.18173649121475, -16.896243839175085, -13.706947190765174, -6.8568297944679735, -14.316406719959184, -14.97983493332221, -15.059770129564779, -32.27699175190767, -10.081915093802106, -32.40831656621077, -5.871440629185123, -21.874727279159973, -3.2162013713952717, -6.914938763220465, 3.0887197001716835, -6.25446935495557, -17.72980803797754, -13.795235241296059, -26.8904370357448, -23.28054368150975, -15.663841110662107, -12.351065588708316, -13.723778098102505, -29.061465849213903, -1.700187506734859, -33.9533106637192, -19.413389239243397, -3.9254104693250174, -5.377636718063682, -8.144595103011078, -11.33837358081992, -36.05406432632502, -21.461707964544992, -17.96823019981464, -41.296493027845806, -10.111479360546689, 12.108784011916422, -18.0114231061049, -22.215127432506176, -22.63998691761119, -21.814152271576596, -9.432288049474256, -20.75994232558091, -37.38624058201012, -33.40535103578117], "policy_predator_policy_reward": [12.509695823142199, 14.923701410135788, -2.2772622587982427, 18.139662752575102, 36.70307502713878, 18.561760580262312, 23.854751639227942, 20.689121163473462, 1.4559267449654811, 46.015339681764395, 48.2658708930388, 32.499512592828644, 18.21731125591687, 17.037209828114868, -6.3153175561927295, 5.366120825041643, 16.666235701692194, 12.205949216300905, -6.081470149021205, -12.199942742434514, 10.147372283998653, 18.82817104947737, 5.035487850184396, 20.394741012735782, 7.44968836550694, -11.44650644568859, 17.714373750355062, 14.753001231865651, 16.756626736875056, -3.8676166061711834, 12.935052749888996, 9.56078487452287, 27.267063758752606, 19.059650025285066, -8.198135901456052, -13.0200598599205, 11.866300559848037, 15.026815859721053, 28.577404983350064, 7.914065332042851, 5.620889330984149, -3.283553954762306, 1.9295323995360145, 13.004169104849066, -16.7503901101595, -4.390208656502516, 19.592710269565806, 2.8232984788598063, 25.372239920855684, 17.333078598513673, 15.764995923134151, 29.323988217101558, 33.15441161253494, 14.752808590520342, 31.166477622381873, -0.12212080197756592, 30.502815979527334, 29.10543412975524, 15.053173769064864, 34.876626140105365, 14.245062131160482, 33.3928209419787, -2.331070219568586, -0.905224169075681, 7.753730750274773, 29.23912804688743, -4.074138990894722, 5.954286371145352, 21.335699280662666, 12.663845658725371, 31.1519008856645, 14.50176824274625, -14.021742477871534, 5.445633183141439, -4.163161611873708, -10.75666828992619, -1.2787945356543116, 6.513070381033696, 24.98745217584025, 14.501988703236869, 2.6915601497241184, 14.169049925595303, 5.9109263383311035, 15.622993230388904, 21.695846419201082, 5.722856382656932, 0.6632296901944112, 12.84174614281882, -11.422737687939318, 1.2406171553970626, 8.335947127025225, 13.735528085996314, 28.562887637782836, 29.253624718740458, 33.16740981596823, 20.146505760731593, -2.581919956440556, -17.148314735485982, 25.02604322421265, 15.978390725037736, 20.224086391915883, -6.23041979878373, 15.233600350953491, 16.868561563245883, 29.38531917654113, 22.1327463284983, 6.548636444254786, 35.20144892672116, 32.83536688407683, 30.00912482404855, 25.844832308941427, 8.51864067348809, 14.89188528628095, 18.90060239206921, 3.991338900620949, 23.42255548090941, 7.86729440669481, 5.846365182241133, 23.09682504747088, 5.535988392447489, 4.879156386549022, 25.080513480095377, 24.522668543211502, 5.596871715918045, 16.07357662023937, 48.48040688357604, 14.53024362314208, 5.633586564462137, 28.284216776537704, 36.53241635588384, 3.5504484034494173, 8.192432854920824, 14.256598021954563, 29.492856536365423, 12.503109572504275, -6.070706829713732, 9.654667956593755, 4.1752095698471745, -15.602598282472687, 9.425158882129315, 6.476694423035077, 6.032244286876079, 19.241285077175956, 16.218330998779116, 34.33707477681759, -6.746604294225501, 40.16149847234204, 13.619375599147554, 35.6549074560066, 10.906179907012909, 19.644096166638604, 11.683586054685632, 30.44730919409757, -5.745178016680885, 27.15817844974056, 0.28937774646444403, 28.688744143093324, 29.43418755533444, -0.5874824133854801, 3.987857426855209, 34.23330071060608, 33.67332061683228, 14.07184342187465, 24.754935056612133, 1.5460948328951805, 6.304726105754851, -3.0260262334358883, 13.781299669563253, 14.381108541871582, 1.9080816641505551, 21.874071432889007, 0.8026757287508666, 46.120565971532564, 25.987562681117524, 41.05923953274101, 1.8641763963489966, 14.568194203993963, 21.36826619563527, 39.96310543169845, 42.62988062399316, 16.13110772206702, 4.091850999026368, -13.131319854405039, -11.086248169427815, 12.953365418565223, 23.069480793644544, 27.62061858259265, 16.80963628241971, 19.033429691628566, 26.246544143593844, 27.540644738338948, 16.087659804814265, 4.500434284388591, 14.364141814559927, 18.614940693077912, 22.90494395808392, 32.88211038143925, 41.890370782581, 35.14446978885371, 31.66623228270866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6400828669652394, "mean_inference_ms": 1.7029608180197366, "mean_action_processing_ms": 0.261738990905761, "mean_env_wait_ms": 0.14799034178703746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054399967193603516, "StateBufferConnector_ms": 0.0064716339111328125, "ViewRequirementAgentConnector_ms": 0.10354280471801758}, "num_episodes": 23, "episode_return_max": 41.296493027845855, "episode_return_min": -12.10878401191643, "episode_return_mean": 14.655039098717111, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.4885641479614, "num_env_steps_trained_throughput_per_sec": 365.4885641479614, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 12335.735, "restore_workers_time_ms": 0.045, "training_step_time_ms": 12335.458, "sample_time_ms": 1478.506, "learn_time_ms": 10835.987, "learn_throughput": 369.14, "synch_weights_time_ms": 19.045}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "training_iteration": 87, "trial_id": "06536_00000", "date": "2024-08-11_17-29-57", "timestamp": 1723411797, "time_this_iter_s": 11.014931917190552, "time_total_s": 3339.5982694625854, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331714c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3339.5982694625854, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 44.306250000000006, "ram_util_percent": 82.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.822129868467649, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5970973818873366, "policy_loss": -0.006343234532202284, "vf_loss": 1.6034316575154661, "vf_explained_var": 0.9660550073410074, "kl": 0.005731759002307203, "entropy": 0.44759659099703036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.941033499833768, "cur_kl_coeff": 5.456968210637568e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1628544598029404, "policy_loss": -0.0018099604710374796, "vf_loss": 2.1646644208166332, "vf_explained_var": 0.9595451203603593, "kl": 0.004461898315739662, "entropy": 0.32264115046414116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 41.296493027845855, "episode_reward_min": -12.10878401191643, "episode_reward_mean": 15.187527617781248, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.296493027845806, "predator_policy": -17.148314735485982}, "policy_reward_max": {"prey_policy": 12.108784011916422, "predator_policy": 48.48040688357604}, "policy_reward_mean": {"prey_policy": -15.18752761778125, "predator_policy": 15.187527617781251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.446558209784557, 18.24573515769644, 1.1686676881109221, 7.466850752192538, -10.570299383331006, 11.208004374212797, 21.35265925968469, 22.544492070117865, 23.953610101527623, 15.522178410202136, 29.80412505464124, 24.9648999545851, 23.818941536569575, -1.6181471943221335, 18.49642939858109, 0.9400736901252849, 16.999772469694015, 22.826834564205374, -4.2880546473650565, -7.4599149508999485, 2.617137922689701, 19.744720439538536, 8.430305037659707, 10.76695978436, 13.70935140092901, 6.752487916506604, -5.091060266271125, 11.035737606510741, 28.908256178261656, 26.65695778834992, -9.865117345963272, 20.5022169746252, 6.99683329656609, 16.05108095709968, 25.759032752519712, 20.875042685487962, 31.422245854062716, 17.18173649121475, 16.896243839175064, 13.706947190765181, 6.856829794467962, 14.316406719959186, 14.979834933322147, 15.059770129564756, 32.27699175190772, 10.081915093802106, 32.4083165662108, 5.871440629185118, 21.874727279160016, 3.2162013713952717, 6.914938763220456, -3.0887197001716826, 6.254469354955569, 17.729808037977524, 13.79523524129606, 26.890437035744792, 23.280543681509748, 15.663841110662124, 12.351065588708343, 13.723778098102493, 29.061465849213874, 1.7001875067348777, 33.95331066371916, 19.413389239243376, 3.9254104693250147, 5.377636718063708, 8.144595103011063, 11.338373580819933, 36.05406432632501, 21.461707964545, 17.968230199814577, 41.296493027845855, 10.111479360546683, -12.10878401191643, 18.011423106104875, 22.21512743250618, 22.639986917611207, 21.81415227157664, 9.432288049474263, 20.759942325580887, 37.38624058201017, 33.40535103578117, 14.577613010776965, 20.831119218993827, 26.88060673553153, 24.7931961644274, 14.086622001210563, 33.809323356454364, 0.17082026797153382, -3.4134983664677714, 20.657469561969005, 30.68536966874148, 27.832878347798534, 17.239159674858787, -5.319657190389714, 4.109525867849525, 8.578569070762539, 14.834117608421417, 19.97448963664635, 12.724600923550117], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.44655820978454, -18.245735157696455, -1.168667688110915, -7.46685075219254, 10.57029938333101, -11.208004374212798, -21.35265925968468, -22.54449207011787, -23.95361010152766, -15.522178410202134, -29.8041250546413, -24.96489995458513, -23.818941536569596, 1.6181471943221326, -18.496429398581096, -0.940073690125315, -16.999772469694022, -22.82683456420534, 4.288054647365042, 7.459914950899947, -2.617137922689688, -19.744720439538586, -8.430305037659734, -10.766959784360022, -13.709351400928998, -6.752487916506631, 5.091060266271128, -11.035737606510764, -28.908256178261606, -26.656957788349928, 9.865117345963267, -20.502216974625195, -6.99683329656608, -16.0510809570997, -25.75903275251974, -20.875042685487966, -31.422245854062677, -17.18173649121475, -16.896243839175085, -13.706947190765174, -6.8568297944679735, -14.316406719959184, -14.97983493332221, -15.059770129564779, -32.27699175190767, -10.081915093802106, -32.40831656621077, -5.871440629185123, -21.874727279159973, -3.2162013713952717, -6.914938763220465, 3.0887197001716835, -6.25446935495557, -17.72980803797754, -13.795235241296059, -26.8904370357448, -23.28054368150975, -15.663841110662107, -12.351065588708316, -13.723778098102505, -29.061465849213903, -1.700187506734859, -33.9533106637192, -19.413389239243397, -3.9254104693250174, -5.377636718063682, -8.144595103011078, -11.33837358081992, -36.05406432632502, -21.461707964544992, -17.96823019981464, -41.296493027845806, -10.111479360546689, 12.108784011916422, -18.0114231061049, -22.215127432506176, -22.63998691761119, -21.814152271576596, -9.432288049474256, -20.75994232558091, -37.38624058201012, -33.40535103578117, -14.577613010776952, -20.83111921899383, -26.88060673553154, -24.793196164427385, -14.08662200121056, -33.8093233564543, -0.17082026797154892, 3.413498366467783, -20.657469561969016, -30.685369668741444, -27.832878347798477, -17.239159674858783, 5.319657190389711, -4.1095258678495155, -8.578569070762555, -14.834117608421415, -19.97448963664629, -12.724600923550126], "policy_predator_policy_reward": [11.866300559848037, 15.026815859721053, 28.577404983350064, 7.914065332042851, 5.620889330984149, -3.283553954762306, 1.9295323995360145, 13.004169104849066, -16.7503901101595, -4.390208656502516, 19.592710269565806, 2.8232984788598063, 25.372239920855684, 17.333078598513673, 15.764995923134151, 29.323988217101558, 33.15441161253494, 14.752808590520342, 31.166477622381873, -0.12212080197756592, 30.502815979527334, 29.10543412975524, 15.053173769064864, 34.876626140105365, 14.245062131160482, 33.3928209419787, -2.331070219568586, -0.905224169075681, 7.753730750274773, 29.23912804688743, -4.074138990894722, 5.954286371145352, 21.335699280662666, 12.663845658725371, 31.1519008856645, 14.50176824274625, -14.021742477871534, 5.445633183141439, -4.163161611873708, -10.75666828992619, -1.2787945356543116, 6.513070381033696, 24.98745217584025, 14.501988703236869, 2.6915601497241184, 14.169049925595303, 5.9109263383311035, 15.622993230388904, 21.695846419201082, 5.722856382656932, 0.6632296901944112, 12.84174614281882, -11.422737687939318, 1.2406171553970626, 8.335947127025225, 13.735528085996314, 28.562887637782836, 29.253624718740458, 33.16740981596823, 20.146505760731593, -2.581919956440556, -17.148314735485982, 25.02604322421265, 15.978390725037736, 20.224086391915883, -6.23041979878373, 15.233600350953491, 16.868561563245883, 29.38531917654113, 22.1327463284983, 6.548636444254786, 35.20144892672116, 32.83536688407683, 30.00912482404855, 25.844832308941427, 8.51864067348809, 14.89188528628095, 18.90060239206921, 3.991338900620949, 23.42255548090941, 7.86729440669481, 5.846365182241133, 23.09682504747088, 5.535988392447489, 4.879156386549022, 25.080513480095377, 24.522668543211502, 5.596871715918045, 16.07357662023937, 48.48040688357604, 14.53024362314208, 5.633586564462137, 28.284216776537704, 36.53241635588384, 3.5504484034494173, 8.192432854920824, 14.256598021954563, 29.492856536365423, 12.503109572504275, -6.070706829713732, 9.654667956593755, 4.1752095698471745, -15.602598282472687, 9.425158882129315, 6.476694423035077, 6.032244286876079, 19.241285077175956, 16.218330998779116, 34.33707477681759, -6.746604294225501, 40.16149847234204, 13.619375599147554, 35.6549074560066, 10.906179907012909, 19.644096166638604, 11.683586054685632, 30.44730919409757, -5.745178016680885, 27.15817844974056, 0.28937774646444403, 28.688744143093324, 29.43418755533444, -0.5874824133854801, 3.987857426855209, 34.23330071060608, 33.67332061683228, 14.07184342187465, 24.754935056612133, 1.5460948328951805, 6.304726105754851, -3.0260262334358883, 13.781299669563253, 14.381108541871582, 1.9080816641505551, 21.874071432889007, 0.8026757287508666, 46.120565971532564, 25.987562681117524, 41.05923953274101, 1.8641763963489966, 14.568194203993963, 21.36826619563527, 39.96310543169845, 42.62988062399316, 16.13110772206702, 4.091850999026368, -13.131319854405039, -11.086248169427815, 12.953365418565223, 23.069480793644544, 27.62061858259265, 16.80963628241971, 19.033429691628566, 26.246544143593844, 27.540644738338948, 16.087659804814265, 4.500434284388591, 14.364141814559927, 18.614940693077912, 22.90494395808392, 32.88211038143925, 41.890370782581, 35.14446978885371, 31.66623228270866, 15.647001955284566, 13.508224066269369, 28.816922965251788, 12.845315472735898, 29.897314510257562, 23.863898960805493, 16.66831175628568, 32.918080572569124, 21.656188761636457, 6.51705524078467, 45.54225297034055, 22.076393742568087, -6.69536177503983, 7.037002310982928, 1.3269395947119005, -8.153936327647447, 34.262119103549736, 7.052820020388305, 32.35847280423101, 29.012266533251875, 25.47752099843117, 30.188235697165823, 24.23857983237914, 10.23973951733845, -3.816589913535262, -6.8227244672441625, -8.296341826324037, 16.51539356202307, 14.647259097798138, 2.5098790437269507, 7.819568044778702, 21.848667172064115, 23.25235356068929, 16.696625712603314, 20.817016977604663, 4.632184869495605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6400284885334534, "mean_inference_ms": 1.7019476320196705, "mean_action_processing_ms": 0.2615706311895405, "mean_env_wait_ms": 0.1479725159600822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036824941635131836, "StateBufferConnector_ms": 0.00634765625, "ViewRequirementAgentConnector_ms": 0.09617209434509277}, "num_episodes": 18, "episode_return_max": 41.296493027845855, "episode_return_min": -12.10878401191643, "episode_return_mean": 15.187527617781248, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.2113346798402, "num_env_steps_trained_throughput_per_sec": 380.2113346798402, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 12012.53, "restore_workers_time_ms": 0.023, "training_step_time_ms": 12012.312, "sample_time_ms": 1409.602, "learn_time_ms": 10582.716, "learn_throughput": 377.975, "synch_weights_time_ms": 18.245}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 88, "trial_id": "06536_00000", "date": "2024-08-11_17-30-08", "timestamp": 1723411808, "time_this_iter_s": 10.586707830429077, "time_total_s": 3350.1849772930145, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316ffc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3350.1849772930145, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 46.13999999999999, "ram_util_percent": 82.52666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.995819907511274, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1439767232785623, "policy_loss": -0.008309118442897064, "vf_loss": 2.1522734417269627, "vf_explained_var": 0.9555084322889645, "kl": 0.007939091819455261, "entropy": 0.4423407348183294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.992339217725885, "cur_kl_coeff": 2.728484105318784e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.686424426931553, "policy_loss": -0.004643397269001793, "vf_loss": 2.691067827694, "vf_explained_var": 0.9473926116549779, "kl": 0.005066801827203896, "entropy": 0.33238253206330004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "env_runners": {"episode_reward_max": 41.792170449036476, "episode_reward_min": -12.10878401191643, "episode_reward_mean": 15.986414934785422, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.7921704490364, "predator_policy": -17.148314735485982}, "policy_reward_max": {"prey_policy": 12.108784011916422, "predator_policy": 48.48040688357604}, "policy_reward_mean": {"prey_policy": -15.986414934785419, "predator_policy": 15.98641493478542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.430305037659707, 10.76695978436, 13.70935140092901, 6.752487916506604, -5.091060266271125, 11.035737606510741, 28.908256178261656, 26.65695778834992, -9.865117345963272, 20.5022169746252, 6.99683329656609, 16.05108095709968, 25.759032752519712, 20.875042685487962, 31.422245854062716, 17.18173649121475, 16.896243839175064, 13.706947190765181, 6.856829794467962, 14.316406719959186, 14.979834933322147, 15.059770129564756, 32.27699175190772, 10.081915093802106, 32.4083165662108, 5.871440629185118, 21.874727279160016, 3.2162013713952717, 6.914938763220456, -3.0887197001716826, 6.254469354955569, 17.729808037977524, 13.79523524129606, 26.890437035744792, 23.280543681509748, 15.663841110662124, 12.351065588708343, 13.723778098102493, 29.061465849213874, 1.7001875067348777, 33.95331066371916, 19.413389239243376, 3.9254104693250147, 5.377636718063708, 8.144595103011063, 11.338373580819933, 36.05406432632501, 21.461707964545, 17.968230199814577, 41.296493027845855, 10.111479360546683, -12.10878401191643, 18.011423106104875, 22.21512743250618, 22.639986917611207, 21.81415227157664, 9.432288049474263, 20.759942325580887, 37.38624058201017, 33.40535103578117, 14.577613010776965, 20.831119218993827, 26.88060673553153, 24.7931961644274, 14.086622001210563, 33.809323356454364, 0.17082026797153382, -3.4134983664677714, 20.657469561969005, 30.68536966874148, 27.832878347798534, 17.239159674858787, -5.319657190389714, 4.109525867849525, 8.578569070762539, 14.834117608421417, 19.97448963664635, 12.724600923550117, 10.630973172294086, 18.665413647081603, 18.21930501566096, 5.174807021040943, 7.129495493945541, 20.012308213200214, 8.20065514346531, 31.480132852831183, 14.136258046271703, 17.448392298436453, 41.792170449036476, 21.45228810107188, 20.521685789553832, 0.9550902227153895, 8.10354764399518, 32.484441823632146, 8.457109530462139, 28.739516322244327, 11.590326166880391, 13.872383335520752, 16.358989807639297, -4.351283518321138], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.430305037659734, -10.766959784360022, -13.709351400928998, -6.752487916506631, 5.091060266271128, -11.035737606510764, -28.908256178261606, -26.656957788349928, 9.865117345963267, -20.502216974625195, -6.99683329656608, -16.0510809570997, -25.75903275251974, -20.875042685487966, -31.422245854062677, -17.18173649121475, -16.896243839175085, -13.706947190765174, -6.8568297944679735, -14.316406719959184, -14.97983493332221, -15.059770129564779, -32.27699175190767, -10.081915093802106, -32.40831656621077, -5.871440629185123, -21.874727279159973, -3.2162013713952717, -6.914938763220465, 3.0887197001716835, -6.25446935495557, -17.72980803797754, -13.795235241296059, -26.8904370357448, -23.28054368150975, -15.663841110662107, -12.351065588708316, -13.723778098102505, -29.061465849213903, -1.700187506734859, -33.9533106637192, -19.413389239243397, -3.9254104693250174, -5.377636718063682, -8.144595103011078, -11.33837358081992, -36.05406432632502, -21.461707964544992, -17.96823019981464, -41.296493027845806, -10.111479360546689, 12.108784011916422, -18.0114231061049, -22.215127432506176, -22.63998691761119, -21.814152271576596, -9.432288049474256, -20.75994232558091, -37.38624058201012, -33.40535103578117, -14.577613010776952, -20.83111921899383, -26.88060673553154, -24.793196164427385, -14.08662200121056, -33.8093233564543, -0.17082026797154892, 3.413498366467783, -20.657469561969016, -30.685369668741444, -27.832878347798477, -17.239159674858783, 5.319657190389711, -4.1095258678495155, -8.578569070762555, -14.834117608421415, -19.97448963664629, -12.724600923550126, -10.630973172294059, -18.665413647081582, -18.219305015660957, -5.174807021040949, -7.129495493945521, -20.01230821320016, -8.200655143465337, -31.480132852831186, -14.136258046271736, -17.448392298436456, -41.7921704490364, -21.45228810107186, -20.52168578955373, -0.9550902227154117, -8.103547643995203, -32.4844418236322, -8.45710953046214, -28.73951632224431, -11.590326166880388, -13.872383335520778, -16.358989807639297, 4.351283518321134], "policy_predator_policy_reward": [2.6915601497241184, 14.169049925595303, 5.9109263383311035, 15.622993230388904, 21.695846419201082, 5.722856382656932, 0.6632296901944112, 12.84174614281882, -11.422737687939318, 1.2406171553970626, 8.335947127025225, 13.735528085996314, 28.562887637782836, 29.253624718740458, 33.16740981596823, 20.146505760731593, -2.581919956440556, -17.148314735485982, 25.02604322421265, 15.978390725037736, 20.224086391915883, -6.23041979878373, 15.233600350953491, 16.868561563245883, 29.38531917654113, 22.1327463284983, 6.548636444254786, 35.20144892672116, 32.83536688407683, 30.00912482404855, 25.844832308941427, 8.51864067348809, 14.89188528628095, 18.90060239206921, 3.991338900620949, 23.42255548090941, 7.86729440669481, 5.846365182241133, 23.09682504747088, 5.535988392447489, 4.879156386549022, 25.080513480095377, 24.522668543211502, 5.596871715918045, 16.07357662023937, 48.48040688357604, 14.53024362314208, 5.633586564462137, 28.284216776537704, 36.53241635588384, 3.5504484034494173, 8.192432854920824, 14.256598021954563, 29.492856536365423, 12.503109572504275, -6.070706829713732, 9.654667956593755, 4.1752095698471745, -15.602598282472687, 9.425158882129315, 6.476694423035077, 6.032244286876079, 19.241285077175956, 16.218330998779116, 34.33707477681759, -6.746604294225501, 40.16149847234204, 13.619375599147554, 35.6549074560066, 10.906179907012909, 19.644096166638604, 11.683586054685632, 30.44730919409757, -5.745178016680885, 27.15817844974056, 0.28937774646444403, 28.688744143093324, 29.43418755533444, -0.5874824133854801, 3.987857426855209, 34.23330071060608, 33.67332061683228, 14.07184342187465, 24.754935056612133, 1.5460948328951805, 6.304726105754851, -3.0260262334358883, 13.781299669563253, 14.381108541871582, 1.9080816641505551, 21.874071432889007, 0.8026757287508666, 46.120565971532564, 25.987562681117524, 41.05923953274101, 1.8641763963489966, 14.568194203993963, 21.36826619563527, 39.96310543169845, 42.62988062399316, 16.13110772206702, 4.091850999026368, -13.131319854405039, -11.086248169427815, 12.953365418565223, 23.069480793644544, 27.62061858259265, 16.80963628241971, 19.033429691628566, 26.246544143593844, 27.540644738338948, 16.087659804814265, 4.500434284388591, 14.364141814559927, 18.614940693077912, 22.90494395808392, 32.88211038143925, 41.890370782581, 35.14446978885371, 31.66623228270866, 15.647001955284566, 13.508224066269369, 28.816922965251788, 12.845315472735898, 29.897314510257562, 23.863898960805493, 16.66831175628568, 32.918080572569124, 21.656188761636457, 6.51705524078467, 45.54225297034055, 22.076393742568087, -6.69536177503983, 7.037002310982928, 1.3269395947119005, -8.153936327647447, 34.262119103549736, 7.052820020388305, 32.35847280423101, 29.012266533251875, 25.47752099843117, 30.188235697165823, 24.23857983237914, 10.23973951733845, -3.816589913535262, -6.8227244672441625, -8.296341826324037, 16.51539356202307, 14.647259097798138, 2.5098790437269507, 7.819568044778702, 21.848667172064115, 23.25235356068929, 16.696625712603314, 20.817016977604663, 4.632184869495605, 6.632132559414076, 14.629813785174061, 20.882947647815506, 16.447879646347698, 16.170826016440774, 20.26778401488114, 3.2858899980630145, 7.063724044018878, 22.811330006478265, -8.55233901858722, 26.714015331634425, 13.310601094765934, -0.15440368713349084, 16.555713974064155, 32.93087653589828, 30.02938916976408, -5.157948755665096, 33.43046484820853, 27.62266150898659, 7.274123087886316, 45.80461840049673, 37.77972249757611, 21.97992809108427, 20.92464811105946, 26.22416257699699, 14.819209002110576, 7.682590515262888, -5.772410069832045, 17.96734892597177, -1.7602536379813492, 46.782015714753356, 18.186867932510964, 12.251547163993653, 4.662671896930634, 31.661234816162086, 25.817797828326558, 2.375044582233799, 20.80560775152698, 12.235791428465783, 15.508975242575739, 18.9483136038857, 13.769666011392882, -4.083624135714897, -4.618942900927369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6397091798227355, "mean_inference_ms": 1.6985968067617847, "mean_action_processing_ms": 0.2611669783235275, "mean_env_wait_ms": 0.14784733951996581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003600597381591797, "StateBufferConnector_ms": 0.0028733015060424805, "ViewRequirementAgentConnector_ms": 0.08784782886505127}, "num_episodes": 22, "episode_return_max": 41.792170449036476, "episode_return_min": -12.10878401191643, "episode_return_mean": 15.986414934785422, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.2667177292552, "num_env_steps_trained_throughput_per_sec": 386.2667177292552, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 11687.903, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11687.687, "sample_time_ms": 1276.709, "learn_time_ms": 10391.222, "learn_throughput": 384.94, "synch_weights_time_ms": 18.03}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "training_iteration": 89, "trial_id": "06536_00000", "date": "2024-08-11_17-30-18", "timestamp": 1723411818, "time_this_iter_s": 10.387476921081543, "time_total_s": 3360.572454214096, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316ff8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3360.572454214096, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 47.54, "ram_util_percent": 82.61333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8741918478161095, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1920617376764615, "policy_loss": -0.0067442879175359845, "vf_loss": 2.1987953649212915, "vf_explained_var": 0.9532632599274318, "kl": 0.006822064637124229, "entropy": 0.4309269949172934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.797979285729625, "cur_kl_coeff": 2.728484105318784e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4142985793648575, "policy_loss": -0.0010213752168787534, "vf_loss": 2.4153199559797054, "vf_explained_var": 0.9533707508334407, "kl": 0.002153366228134005, "entropy": 0.2859780426220919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 41.792170449036476, "episode_reward_min": -12.10878401191643, "episode_reward_mean": 16.174117935063183, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.7921704490364, "predator_policy": -15.602598282472687}, "policy_reward_max": {"prey_policy": 12.108784011916422, "predator_policy": 48.48040688357604}, "policy_reward_mean": {"prey_policy": -16.174117935063183, "predator_policy": 16.174117935063187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.856829794467962, 14.316406719959186, 14.979834933322147, 15.059770129564756, 32.27699175190772, 10.081915093802106, 32.4083165662108, 5.871440629185118, 21.874727279160016, 3.2162013713952717, 6.914938763220456, -3.0887197001716826, 6.254469354955569, 17.729808037977524, 13.79523524129606, 26.890437035744792, 23.280543681509748, 15.663841110662124, 12.351065588708343, 13.723778098102493, 29.061465849213874, 1.7001875067348777, 33.95331066371916, 19.413389239243376, 3.9254104693250147, 5.377636718063708, 8.144595103011063, 11.338373580819933, 36.05406432632501, 21.461707964545, 17.968230199814577, 41.296493027845855, 10.111479360546683, -12.10878401191643, 18.011423106104875, 22.21512743250618, 22.639986917611207, 21.81415227157664, 9.432288049474263, 20.759942325580887, 37.38624058201017, 33.40535103578117, 14.577613010776965, 20.831119218993827, 26.88060673553153, 24.7931961644274, 14.086622001210563, 33.809323356454364, 0.17082026797153382, -3.4134983664677714, 20.657469561969005, 30.68536966874148, 27.832878347798534, 17.239159674858787, -5.319657190389714, 4.109525867849525, 8.578569070762539, 14.834117608421417, 19.97448963664635, 12.724600923550117, 10.630973172294086, 18.665413647081603, 18.21930501566096, 5.174807021040943, 7.129495493945541, 20.012308213200214, 8.20065514346531, 31.480132852831183, 14.136258046271703, 17.448392298436453, 41.792170449036476, 21.45228810107188, 20.521685789553832, 0.9550902227153895, 8.10354764399518, 32.484441823632146, 8.457109530462139, 28.739516322244327, 11.590326166880391, 13.872383335520752, 16.358989807639297, -4.351283518321138, 17.36300367180482, 2.2544734496835996, 10.080498361611264, 17.477068766638954, 10.169496724644526, 15.948342550740303, -0.32464060747321, 11.419665829569187, 17.111047750268206, 36.34038314422991, 3.3703358913624335, 26.337613388424554, 10.38688655299886, 16.98168178004189, 6.987448470860587, 28.02847675811982, 32.254502103777725, 17.2792735823327], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.8568297944679735, -14.316406719959184, -14.97983493332221, -15.059770129564779, -32.27699175190767, -10.081915093802106, -32.40831656621077, -5.871440629185123, -21.874727279159973, -3.2162013713952717, -6.914938763220465, 3.0887197001716835, -6.25446935495557, -17.72980803797754, -13.795235241296059, -26.8904370357448, -23.28054368150975, -15.663841110662107, -12.351065588708316, -13.723778098102505, -29.061465849213903, -1.700187506734859, -33.9533106637192, -19.413389239243397, -3.9254104693250174, -5.377636718063682, -8.144595103011078, -11.33837358081992, -36.05406432632502, -21.461707964544992, -17.96823019981464, -41.296493027845806, -10.111479360546689, 12.108784011916422, -18.0114231061049, -22.215127432506176, -22.63998691761119, -21.814152271576596, -9.432288049474256, -20.75994232558091, -37.38624058201012, -33.40535103578117, -14.577613010776952, -20.83111921899383, -26.88060673553154, -24.793196164427385, -14.08662200121056, -33.8093233564543, -0.17082026797154892, 3.413498366467783, -20.657469561969016, -30.685369668741444, -27.832878347798477, -17.239159674858783, 5.319657190389711, -4.1095258678495155, -8.578569070762555, -14.834117608421415, -19.97448963664629, -12.724600923550126, -10.630973172294059, -18.665413647081582, -18.219305015660957, -5.174807021040949, -7.129495493945521, -20.01230821320016, -8.200655143465337, -31.480132852831186, -14.136258046271736, -17.448392298436456, -41.7921704490364, -21.45228810107186, -20.52168578955373, -0.9550902227154117, -8.103547643995203, -32.4844418236322, -8.45710953046214, -28.73951632224431, -11.590326166880388, -13.872383335520778, -16.358989807639297, 4.351283518321134, -17.363003671804815, -2.2544734496835934, -10.080498361611262, -17.477068766638993, -10.169496724644514, -15.948342550740255, 0.324640607473218, -11.4196658295692, -17.111047750268206, -36.34038314422989, -3.3703358913624406, -26.337613388424533, -10.386886552998849, -16.98168178004189, -6.987448470860603, -28.02847675811978, -32.25450210377776, -17.27927358233267], "policy_predator_policy_reward": [7.86729440669481, 5.846365182241133, 23.09682504747088, 5.535988392447489, 4.879156386549022, 25.080513480095377, 24.522668543211502, 5.596871715918045, 16.07357662023937, 48.48040688357604, 14.53024362314208, 5.633586564462137, 28.284216776537704, 36.53241635588384, 3.5504484034494173, 8.192432854920824, 14.256598021954563, 29.492856536365423, 12.503109572504275, -6.070706829713732, 9.654667956593755, 4.1752095698471745, -15.602598282472687, 9.425158882129315, 6.476694423035077, 6.032244286876079, 19.241285077175956, 16.218330998779116, 34.33707477681759, -6.746604294225501, 40.16149847234204, 13.619375599147554, 35.6549074560066, 10.906179907012909, 19.644096166638604, 11.683586054685632, 30.44730919409757, -5.745178016680885, 27.15817844974056, 0.28937774646444403, 28.688744143093324, 29.43418755533444, -0.5874824133854801, 3.987857426855209, 34.23330071060608, 33.67332061683228, 14.07184342187465, 24.754935056612133, 1.5460948328951805, 6.304726105754851, -3.0260262334358883, 13.781299669563253, 14.381108541871582, 1.9080816641505551, 21.874071432889007, 0.8026757287508666, 46.120565971532564, 25.987562681117524, 41.05923953274101, 1.8641763963489966, 14.568194203993963, 21.36826619563527, 39.96310543169845, 42.62988062399316, 16.13110772206702, 4.091850999026368, -13.131319854405039, -11.086248169427815, 12.953365418565223, 23.069480793644544, 27.62061858259265, 16.80963628241971, 19.033429691628566, 26.246544143593844, 27.540644738338948, 16.087659804814265, 4.500434284388591, 14.364141814559927, 18.614940693077912, 22.90494395808392, 32.88211038143925, 41.890370782581, 35.14446978885371, 31.66623228270866, 15.647001955284566, 13.508224066269369, 28.816922965251788, 12.845315472735898, 29.897314510257562, 23.863898960805493, 16.66831175628568, 32.918080572569124, 21.656188761636457, 6.51705524078467, 45.54225297034055, 22.076393742568087, -6.69536177503983, 7.037002310982928, 1.3269395947119005, -8.153936327647447, 34.262119103549736, 7.052820020388305, 32.35847280423101, 29.012266533251875, 25.47752099843117, 30.188235697165823, 24.23857983237914, 10.23973951733845, -3.816589913535262, -6.8227244672441625, -8.296341826324037, 16.51539356202307, 14.647259097798138, 2.5098790437269507, 7.819568044778702, 21.848667172064115, 23.25235356068929, 16.696625712603314, 20.817016977604663, 4.632184869495605, 6.632132559414076, 14.629813785174061, 20.882947647815506, 16.447879646347698, 16.170826016440774, 20.26778401488114, 3.2858899980630145, 7.063724044018878, 22.811330006478265, -8.55233901858722, 26.714015331634425, 13.310601094765934, -0.15440368713349084, 16.555713974064155, 32.93087653589828, 30.02938916976408, -5.157948755665096, 33.43046484820853, 27.62266150898659, 7.274123087886316, 45.80461840049673, 37.77972249757611, 21.97992809108427, 20.92464811105946, 26.22416257699699, 14.819209002110576, 7.682590515262888, -5.772410069832045, 17.96734892597177, -1.7602536379813492, 46.782015714753356, 18.186867932510964, 12.251547163993653, 4.662671896930634, 31.661234816162086, 25.817797828326558, 2.375044582233799, 20.80560775152698, 12.235791428465783, 15.508975242575739, 18.9483136038857, 13.769666011392882, -4.083624135714897, -4.618942900927369, 31.732243928862452, 2.9937634147471694, 3.5205059318881116, 0.9884409674790735, 24.43283708921804, -4.271840365995521, 6.838561886760415, 28.11557564651754, 7.660595916541444, 12.67839753274756, 14.229618989780475, 17.66706611170006, -8.957871273972655, 8.308590059026253, 8.205329273757872, 14.634002385380509, 33.61289092870908, 0.6092045718273713, 43.365177054870834, 29.315589233588973, -1.512947672642694, 8.253619455367561, 30.905696968541505, 21.769529808307553, 17.173185792066985, 3.60058731393071, 21.319052373078836, 12.644311187004936, 21.176456228048814, -7.201559286327649, 34.55276343453574, 21.504190081703854, 32.77497597303106, 31.734028234524434, -2.010878958431581, 36.56942612309698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.638329568000795, "mean_inference_ms": 1.6964684888432173, "mean_action_processing_ms": 0.2608634352143968, "mean_env_wait_ms": 0.14764502003417884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034438371658325195, "StateBufferConnector_ms": 0.0026848316192626953, "ViewRequirementAgentConnector_ms": 0.08084976673126221}, "num_episodes": 18, "episode_return_max": 41.792170449036476, "episode_return_min": -12.10878401191643, "episode_return_mean": 16.174117935063183, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.22088575119136, "num_env_steps_trained_throughput_per_sec": 376.22088575119136, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 11563.166, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11562.948, "sample_time_ms": 1268.59, "learn_time_ms": 10274.683, "learn_throughput": 389.306, "synch_weights_time_ms": 17.844}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 90, "trial_id": "06536_00000", "date": "2024-08-11_17-30-29", "timestamp": 1723411829, "time_this_iter_s": 10.676843166351318, "time_total_s": 3371.2492973804474, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331712550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3371.2492973804474, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 46.36000000000001, "ram_util_percent": 82.35333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.153191195055842, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.115339075525602, "policy_loss": -0.009724436971979836, "vf_loss": 2.1250509866823752, "vf_explained_var": 0.9571381005768974, "kl": 0.008015982731162715, "entropy": 0.46893791211768987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.099361781720762, "cur_kl_coeff": 1.364242052659392e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.184772449511069, "policy_loss": -0.001960226037741575, "vf_loss": 2.1867326761679675, "vf_explained_var": 0.9647789074314965, "kl": 0.0029529012969078073, "entropy": 0.2688469935504217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "env_runners": {"episode_reward_max": 41.792170449036476, "episode_reward_min": -12.10878401191643, "episode_reward_mean": 17.25281423133215, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.7921704490364, "predator_policy": -13.131319854405039}, "policy_reward_max": {"prey_policy": 12.108784011916422, "predator_policy": 48.17594803780719}, "policy_reward_mean": {"prey_policy": -17.25281423133214, "predator_policy": 17.252814231332145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.413389239243376, 3.9254104693250147, 5.377636718063708, 8.144595103011063, 11.338373580819933, 36.05406432632501, 21.461707964545, 17.968230199814577, 41.296493027845855, 10.111479360546683, -12.10878401191643, 18.011423106104875, 22.21512743250618, 22.639986917611207, 21.81415227157664, 9.432288049474263, 20.759942325580887, 37.38624058201017, 33.40535103578117, 14.577613010776965, 20.831119218993827, 26.88060673553153, 24.7931961644274, 14.086622001210563, 33.809323356454364, 0.17082026797153382, -3.4134983664677714, 20.657469561969005, 30.68536966874148, 27.832878347798534, 17.239159674858787, -5.319657190389714, 4.109525867849525, 8.578569070762539, 14.834117608421417, 19.97448963664635, 12.724600923550117, 10.630973172294086, 18.665413647081603, 18.21930501566096, 5.174807021040943, 7.129495493945541, 20.012308213200214, 8.20065514346531, 31.480132852831183, 14.136258046271703, 17.448392298436453, 41.792170449036476, 21.45228810107188, 20.521685789553832, 0.9550902227153895, 8.10354764399518, 32.484441823632146, 8.457109530462139, 28.739516322244327, 11.590326166880391, 13.872383335520752, 16.358989807639297, -4.351283518321138, 17.36300367180482, 2.2544734496835996, 10.080498361611264, 17.477068766638954, 10.169496724644526, 15.948342550740303, -0.32464060747321, 11.419665829569187, 17.111047750268206, 36.34038314422991, 3.3703358913624335, 26.337613388424554, 10.38688655299886, 16.98168178004189, 6.987448470860587, 28.02847675811982, 32.254502103777725, 17.2792735823327, 30.785069878627393, 30.226881659846786, 22.91870179047522, 28.000542647555793, 4.384343129203748, 23.31114956528741, 7.618579379732541, 33.83649988028041, 37.74263329101705, 12.667973213191667, 35.3848697686139, 15.86804830835309, -2.13797576068783, 21.030329426087718, -0.03883759253526353, 5.148581243132725, 10.47156782871323, 3.1615479954725982, 32.00531936910098, 21.27011722048587, 33.414343975373114, 37.49405025150001, 18.478088658715954], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.413389239243397, -3.9254104693250174, -5.377636718063682, -8.144595103011078, -11.33837358081992, -36.05406432632502, -21.461707964544992, -17.96823019981464, -41.296493027845806, -10.111479360546689, 12.108784011916422, -18.0114231061049, -22.215127432506176, -22.63998691761119, -21.814152271576596, -9.432288049474256, -20.75994232558091, -37.38624058201012, -33.40535103578117, -14.577613010776952, -20.83111921899383, -26.88060673553154, -24.793196164427385, -14.08662200121056, -33.8093233564543, -0.17082026797154892, 3.413498366467783, -20.657469561969016, -30.685369668741444, -27.832878347798477, -17.239159674858783, 5.319657190389711, -4.1095258678495155, -8.578569070762555, -14.834117608421415, -19.97448963664629, -12.724600923550126, -10.630973172294059, -18.665413647081582, -18.219305015660957, -5.174807021040949, -7.129495493945521, -20.01230821320016, -8.200655143465337, -31.480132852831186, -14.136258046271736, -17.448392298436456, -41.7921704490364, -21.45228810107186, -20.52168578955373, -0.9550902227154117, -8.103547643995203, -32.4844418236322, -8.45710953046214, -28.73951632224431, -11.590326166880388, -13.872383335520778, -16.358989807639297, 4.351283518321134, -17.363003671804815, -2.2544734496835934, -10.080498361611262, -17.477068766638993, -10.169496724644514, -15.948342550740255, 0.324640607473218, -11.4196658295692, -17.111047750268206, -36.34038314422989, -3.3703358913624406, -26.337613388424533, -10.386886552998849, -16.98168178004189, -6.987448470860603, -28.02847675811978, -32.25450210377776, -17.27927358233267, -30.785069878627418, -30.2268816598468, -22.918701790475204, -28.00054264755577, -4.384343129203747, -23.311149565287405, -7.618579379732539, -33.8364998802804, -37.74263329101704, -12.667973213191663, -35.38486976861391, -15.868048308353144, 2.1379757606878282, -21.03032942608777, 0.03883759253526531, -5.148581243132723, -10.47156782871323, -3.1615479954726045, -32.005319369100995, -21.27011722048588, -33.41434397537318, -37.49405025150003, -18.47808865871595], "policy_predator_policy_reward": [14.07184342187465, 24.754935056612133, 1.5460948328951805, 6.304726105754851, -3.0260262334358883, 13.781299669563253, 14.381108541871582, 1.9080816641505551, 21.874071432889007, 0.8026757287508666, 46.120565971532564, 25.987562681117524, 41.05923953274101, 1.8641763963489966, 14.568194203993963, 21.36826619563527, 39.96310543169845, 42.62988062399316, 16.13110772206702, 4.091850999026368, -13.131319854405039, -11.086248169427815, 12.953365418565223, 23.069480793644544, 27.62061858259265, 16.80963628241971, 19.033429691628566, 26.246544143593844, 27.540644738338948, 16.087659804814265, 4.500434284388591, 14.364141814559927, 18.614940693077912, 22.90494395808392, 32.88211038143925, 41.890370782581, 35.14446978885371, 31.66623228270866, 15.647001955284566, 13.508224066269369, 28.816922965251788, 12.845315472735898, 29.897314510257562, 23.863898960805493, 16.66831175628568, 32.918080572569124, 21.656188761636457, 6.51705524078467, 45.54225297034055, 22.076393742568087, -6.69536177503983, 7.037002310982928, 1.3269395947119005, -8.153936327647447, 34.262119103549736, 7.052820020388305, 32.35847280423101, 29.012266533251875, 25.47752099843117, 30.188235697165823, 24.23857983237914, 10.23973951733845, -3.816589913535262, -6.8227244672441625, -8.296341826324037, 16.51539356202307, 14.647259097798138, 2.5098790437269507, 7.819568044778702, 21.848667172064115, 23.25235356068929, 16.696625712603314, 20.817016977604663, 4.632184869495605, 6.632132559414076, 14.629813785174061, 20.882947647815506, 16.447879646347698, 16.170826016440774, 20.26778401488114, 3.2858899980630145, 7.063724044018878, 22.811330006478265, -8.55233901858722, 26.714015331634425, 13.310601094765934, -0.15440368713349084, 16.555713974064155, 32.93087653589828, 30.02938916976408, -5.157948755665096, 33.43046484820853, 27.62266150898659, 7.274123087886316, 45.80461840049673, 37.77972249757611, 21.97992809108427, 20.92464811105946, 26.22416257699699, 14.819209002110576, 7.682590515262888, -5.772410069832045, 17.96734892597177, -1.7602536379813492, 46.782015714753356, 18.186867932510964, 12.251547163993653, 4.662671896930634, 31.661234816162086, 25.817797828326558, 2.375044582233799, 20.80560775152698, 12.235791428465783, 15.508975242575739, 18.9483136038857, 13.769666011392882, -4.083624135714897, -4.618942900927369, 31.732243928862452, 2.9937634147471694, 3.5205059318881116, 0.9884409674790735, 24.43283708921804, -4.271840365995521, 6.838561886760415, 28.11557564651754, 7.660595916541444, 12.67839753274756, 14.229618989780475, 17.66706611170006, -8.957871273972655, 8.308590059026253, 8.205329273757872, 14.634002385380509, 33.61289092870908, 0.6092045718273713, 43.365177054870834, 29.315589233588973, -1.512947672642694, 8.253619455367561, 30.905696968541505, 21.769529808307553, 17.173185792066985, 3.60058731393071, 21.319052373078836, 12.644311187004936, 21.176456228048814, -7.201559286327649, 34.55276343453574, 21.504190081703854, 32.77497597303106, 31.734028234524434, -2.010878958431581, 36.56942612309698, 27.13475153642201, 34.435388220832806, 28.804009056192356, 31.64975426350125, 25.418601534325614, 20.418802046624805, 27.14836499595532, 28.852720299156235, 10.223456230850148, -1.454769972442655, 28.752105411513092, 17.870193719061696, 10.403818575244763, 4.833340184220328, 48.17594803780719, 19.497051722753554, 38.71234370556707, 36.77292287646702, 16.64345537826175, 8.692491048121529, 38.611901385452846, 32.15783815177498, 17.140357851818433, 14.595738764887809, -5.2720820316616095, 0.9961305102859406, 20.415663380323245, 21.644995471852262, 2.263915503188663, -2.341590688259185, 22.03943862695688, -11.74227614069141, 5.058779059553357, 15.884356597873111, 8.54706762371235, -2.223971632767144, 28.671486231201364, 35.339152507000605, 11.774364098311354, 30.765870342660424, 41.61531517483742, 25.21337277590892, 33.00510235211329, 41.98299815088674, 28.38001248524143, 8.57616483219047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6373561800996952, "mean_inference_ms": 1.6949303307734147, "mean_action_processing_ms": 0.26076775195658364, "mean_env_wait_ms": 0.14768926282152406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040378570556640625, "StateBufferConnector_ms": 0.0029494762420654297, "ViewRequirementAgentConnector_ms": 0.08859467506408691}, "num_episodes": 23, "episode_return_max": 41.792170449036476, "episode_return_min": -12.10878401191643, "episode_return_mean": 17.25281423133215, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.38006633526095, "num_env_steps_trained_throughput_per_sec": 359.38006633526095, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 11414.944, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11414.763, "sample_time_ms": 1291.61, "learn_time_ms": 10105.056, "learn_throughput": 395.841, "synch_weights_time_ms": 16.364}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "training_iteration": 91, "trial_id": "06536_00000", "date": "2024-08-11_17-30-40", "timestamp": 1723411840, "time_this_iter_s": 11.157140254974365, "time_total_s": 3382.4064376354218, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316ffc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3382.4064376354218, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 48.337500000000006, "ram_util_percent": 82.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6698258839547635, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2737796610842147, "policy_loss": -0.005849332613191412, "vf_loss": 2.2796205754081407, "vf_explained_var": 0.9420754089330633, "kl": 0.005388180952216302, "entropy": 0.47933215998734036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7766872440065655, "cur_kl_coeff": 6.82121026329696e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.486819183321857, "policy_loss": -0.003228462337289577, "vf_loss": 2.4900476464518793, "vf_explained_var": 0.9513042234554493, "kl": 0.00557305504986282, "entropy": 0.33146491583692966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 41.792170449036476, "episode_reward_min": -5.319657190389714, "episode_reward_mean": 16.968680417101034, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.7921704490364, "predator_policy": -12.227152497974163}, "policy_reward_max": {"prey_policy": 5.319657190389711, "predator_policy": 50.78511257458022}, "policy_reward_mean": {"prey_policy": -16.96868041710103, "predator_policy": 16.96868041710103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.40535103578117, 14.577613010776965, 20.831119218993827, 26.88060673553153, 24.7931961644274, 14.086622001210563, 33.809323356454364, 0.17082026797153382, -3.4134983664677714, 20.657469561969005, 30.68536966874148, 27.832878347798534, 17.239159674858787, -5.319657190389714, 4.109525867849525, 8.578569070762539, 14.834117608421417, 19.97448963664635, 12.724600923550117, 10.630973172294086, 18.665413647081603, 18.21930501566096, 5.174807021040943, 7.129495493945541, 20.012308213200214, 8.20065514346531, 31.480132852831183, 14.136258046271703, 17.448392298436453, 41.792170449036476, 21.45228810107188, 20.521685789553832, 0.9550902227153895, 8.10354764399518, 32.484441823632146, 8.457109530462139, 28.739516322244327, 11.590326166880391, 13.872383335520752, 16.358989807639297, -4.351283518321138, 17.36300367180482, 2.2544734496835996, 10.080498361611264, 17.477068766638954, 10.169496724644526, 15.948342550740303, -0.32464060747321, 11.419665829569187, 17.111047750268206, 36.34038314422991, 3.3703358913624335, 26.337613388424554, 10.38688655299886, 16.98168178004189, 6.987448470860587, 28.02847675811982, 32.254502103777725, 17.2792735823327, 30.785069878627393, 30.226881659846786, 22.91870179047522, 28.000542647555793, 4.384343129203748, 23.31114956528741, 7.618579379732541, 33.83649988028041, 37.74263329101705, 12.667973213191667, 35.3848697686139, 15.86804830835309, -2.13797576068783, 21.030329426087718, -0.03883759253526353, 5.148581243132725, 10.47156782871323, 3.1615479954725982, 32.00531936910098, 21.27011722048587, 33.414343975373114, 37.49405025150001, 18.478088658715954, 15.37643172284859, 1.2952843546851058, 23.654843867189133, 11.2213608742279, 31.970179866211023, 21.717159625482395, 7.567097572743062, 27.42177799339216, -1.44122886760535, 10.656212204379067, 3.095736117625478, 18.875776205393812, 23.728270175323466, 4.34930597838794, 20.240387497599855, 21.60869075806065, 34.91880449853182, 10.572284794900684], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-33.40535103578117, -14.577613010776952, -20.83111921899383, -26.88060673553154, -24.793196164427385, -14.08662200121056, -33.8093233564543, -0.17082026797154892, 3.413498366467783, -20.657469561969016, -30.685369668741444, -27.832878347798477, -17.239159674858783, 5.319657190389711, -4.1095258678495155, -8.578569070762555, -14.834117608421415, -19.97448963664629, -12.724600923550126, -10.630973172294059, -18.665413647081582, -18.219305015660957, -5.174807021040949, -7.129495493945521, -20.01230821320016, -8.200655143465337, -31.480132852831186, -14.136258046271736, -17.448392298436456, -41.7921704490364, -21.45228810107186, -20.52168578955373, -0.9550902227154117, -8.103547643995203, -32.4844418236322, -8.45710953046214, -28.73951632224431, -11.590326166880388, -13.872383335520778, -16.358989807639297, 4.351283518321134, -17.363003671804815, -2.2544734496835934, -10.080498361611262, -17.477068766638993, -10.169496724644514, -15.948342550740255, 0.324640607473218, -11.4196658295692, -17.111047750268206, -36.34038314422989, -3.3703358913624406, -26.337613388424533, -10.386886552998849, -16.98168178004189, -6.987448470860603, -28.02847675811978, -32.25450210377776, -17.27927358233267, -30.785069878627418, -30.2268816598468, -22.918701790475204, -28.00054264755577, -4.384343129203747, -23.311149565287405, -7.618579379732539, -33.8364998802804, -37.74263329101704, -12.667973213191663, -35.38486976861391, -15.868048308353144, 2.1379757606878282, -21.03032942608777, 0.03883759253526531, -5.148581243132723, -10.47156782871323, -3.1615479954726045, -32.005319369100995, -21.27011722048588, -33.41434397537318, -37.49405025150003, -18.47808865871595, -15.376431722848576, -1.2952843546851005, -23.654843867189143, -11.221360874227898, -31.970179866210994, -21.717159625482395, -7.567097572743056, -27.42177799339218, 1.4412288676053544, -10.656212204379065, -3.0957361176254796, -18.8757762053938, -23.728270175323477, -4.349305978387934, -20.240387497599848, -21.608690758060654, -34.91880449853186, -10.572284794900678], "policy_predator_policy_reward": [35.14446978885371, 31.66623228270866, 15.647001955284566, 13.508224066269369, 28.816922965251788, 12.845315472735898, 29.897314510257562, 23.863898960805493, 16.66831175628568, 32.918080572569124, 21.656188761636457, 6.51705524078467, 45.54225297034055, 22.076393742568087, -6.69536177503983, 7.037002310982928, 1.3269395947119005, -8.153936327647447, 34.262119103549736, 7.052820020388305, 32.35847280423101, 29.012266533251875, 25.47752099843117, 30.188235697165823, 24.23857983237914, 10.23973951733845, -3.816589913535262, -6.8227244672441625, -8.296341826324037, 16.51539356202307, 14.647259097798138, 2.5098790437269507, 7.819568044778702, 21.848667172064115, 23.25235356068929, 16.696625712603314, 20.817016977604663, 4.632184869495605, 6.632132559414076, 14.629813785174061, 20.882947647815506, 16.447879646347698, 16.170826016440774, 20.26778401488114, 3.2858899980630145, 7.063724044018878, 22.811330006478265, -8.55233901858722, 26.714015331634425, 13.310601094765934, -0.15440368713349084, 16.555713974064155, 32.93087653589828, 30.02938916976408, -5.157948755665096, 33.43046484820853, 27.62266150898659, 7.274123087886316, 45.80461840049673, 37.77972249757611, 21.97992809108427, 20.92464811105946, 26.22416257699699, 14.819209002110576, 7.682590515262888, -5.772410069832045, 17.96734892597177, -1.7602536379813492, 46.782015714753356, 18.186867932510964, 12.251547163993653, 4.662671896930634, 31.661234816162086, 25.817797828326558, 2.375044582233799, 20.80560775152698, 12.235791428465783, 15.508975242575739, 18.9483136038857, 13.769666011392882, -4.083624135714897, -4.618942900927369, 31.732243928862452, 2.9937634147471694, 3.5205059318881116, 0.9884409674790735, 24.43283708921804, -4.271840365995521, 6.838561886760415, 28.11557564651754, 7.660595916541444, 12.67839753274756, 14.229618989780475, 17.66706611170006, -8.957871273972655, 8.308590059026253, 8.205329273757872, 14.634002385380509, 33.61289092870908, 0.6092045718273713, 43.365177054870834, 29.315589233588973, -1.512947672642694, 8.253619455367561, 30.905696968541505, 21.769529808307553, 17.173185792066985, 3.60058731393071, 21.319052373078836, 12.644311187004936, 21.176456228048814, -7.201559286327649, 34.55276343453574, 21.504190081703854, 32.77497597303106, 31.734028234524434, -2.010878958431581, 36.56942612309698, 27.13475153642201, 34.435388220832806, 28.804009056192356, 31.64975426350125, 25.418601534325614, 20.418802046624805, 27.14836499595532, 28.852720299156235, 10.223456230850148, -1.454769972442655, 28.752105411513092, 17.870193719061696, 10.403818575244763, 4.833340184220328, 48.17594803780719, 19.497051722753554, 38.71234370556707, 36.77292287646702, 16.64345537826175, 8.692491048121529, 38.611901385452846, 32.15783815177498, 17.140357851818433, 14.595738764887809, -5.2720820316616095, 0.9961305102859406, 20.415663380323245, 21.644995471852262, 2.263915503188663, -2.341590688259185, 22.03943862695688, -11.74227614069141, 5.058779059553357, 15.884356597873111, 8.54706762371235, -2.223971632767144, 28.671486231201364, 35.339152507000605, 11.774364098311354, 30.765870342660424, 41.61531517483742, 25.21337277590892, 33.00510235211329, 41.98299815088674, 28.38001248524143, 8.57616483219047, 24.991520100826648, 5.76134334487049, 14.81772120734437, -12.227152497974163, 27.148554532377624, 20.16113320200066, 13.719209816078006, 8.723511932377786, 34.60615884039856, 29.334200892023404, 27.6109338869068, 15.82338536405796, 5.267841894232182, 9.866353251253935, 50.78511257458022, 4.058443412204092, 7.355338234664133, -10.237795969874846, 5.500088607339817, 15.812335801418289, -3.8772681375405558, 10.068740372791519, 16.466101577859042, 21.285450832928582, 44.26859698827535, 3.187943362371584, -0.2534039424668695, 8.952015899242761, 29.117230977453524, 11.363544017746165, 8.819961591935067, 34.39741992418627, 35.43226421846244, 34.40534477860124, 21.340055735231665, -0.1954861454303245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6366306912519706, "mean_inference_ms": 1.6911880449241077, "mean_action_processing_ms": 0.2603029560410107, "mean_env_wait_ms": 0.14730192157161734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004296779632568359, "StateBufferConnector_ms": 0.002911090850830078, "ViewRequirementAgentConnector_ms": 0.08113384246826172}, "num_episodes": 18, "episode_return_max": 41.792170449036476, "episode_return_min": -5.319657190389714, "episode_return_mean": 16.968680417101034, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.91158387550524, "num_env_steps_trained_throughput_per_sec": 361.91158387550524, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 11271.034, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11270.824, "sample_time_ms": 1232.328, "learn_time_ms": 10019.034, "learn_throughput": 399.24, "synch_weights_time_ms": 17.518}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 92, "trial_id": "06536_00000", "date": "2024-08-11_17-30-51", "timestamp": 1723411851, "time_this_iter_s": 11.10521912574768, "time_total_s": 3393.5116567611694, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3393.5116567611694, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 50.45625, "ram_util_percent": 82.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8504588599006335, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.340309314057231, "policy_loss": -0.0100640401962058, "vf_loss": 2.3503530247757833, "vf_explained_var": 0.9401484744002422, "kl": 0.013014590341580678, "entropy": 0.4514494790695608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0870486512385975, "cur_kl_coeff": 6.82121026329696e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7171636819839478, "policy_loss": -0.0027207766306000174, "vf_loss": 2.7198844599345375, "vf_explained_var": 0.9479061022322014, "kl": 0.003744436088582615, "entropy": 0.28108330523526226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "env_runners": {"episode_reward_max": 44.79817366964083, "episode_reward_min": -4.351283518321138, "episode_reward_mean": 17.609350549033863, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.79817366964083, "predator_policy": -12.684329406803062}, "policy_reward_max": {"prey_policy": 4.351283518321134, "predator_policy": 50.78511257458022}, "policy_reward_mean": {"prey_policy": -17.609350549033863, "predator_policy": 17.609350549033863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.724600923550117, 10.630973172294086, 18.665413647081603, 18.21930501566096, 5.174807021040943, 7.129495493945541, 20.012308213200214, 8.20065514346531, 31.480132852831183, 14.136258046271703, 17.448392298436453, 41.792170449036476, 21.45228810107188, 20.521685789553832, 0.9550902227153895, 8.10354764399518, 32.484441823632146, 8.457109530462139, 28.739516322244327, 11.590326166880391, 13.872383335520752, 16.358989807639297, -4.351283518321138, 17.36300367180482, 2.2544734496835996, 10.080498361611264, 17.477068766638954, 10.169496724644526, 15.948342550740303, -0.32464060747321, 11.419665829569187, 17.111047750268206, 36.34038314422991, 3.3703358913624335, 26.337613388424554, 10.38688655299886, 16.98168178004189, 6.987448470860587, 28.02847675811982, 32.254502103777725, 17.2792735823327, 30.785069878627393, 30.226881659846786, 22.91870179047522, 28.000542647555793, 4.384343129203748, 23.31114956528741, 7.618579379732541, 33.83649988028041, 37.74263329101705, 12.667973213191667, 35.3848697686139, 15.86804830835309, -2.13797576068783, 21.030329426087718, -0.03883759253526353, 5.148581243132725, 10.47156782871323, 3.1615479954725982, 32.00531936910098, 21.27011722048587, 33.414343975373114, 37.49405025150001, 18.478088658715954, 15.37643172284859, 1.2952843546851058, 23.654843867189133, 11.2213608742279, 31.970179866211023, 21.717159625482395, 7.567097572743062, 27.42177799339216, -1.44122886760535, 10.656212204379067, 3.095736117625478, 18.875776205393812, 23.728270175323466, 4.34930597838794, 20.240387497599855, 21.60869075806065, 34.91880449853182, 10.572284794900684, 8.389663160144535, 44.79817366964083, 18.9904869530022, 34.231254702799546, 18.104977637713247, -2.0155622909049997, 24.124026159356262, 20.63821323098313, 31.562197328854893, 31.679167083972263, 30.097166481043384, 5.638174376010446, 17.10625997747987, 18.66332624263234, 23.820486995384062, 22.87659429240353, 5.220466435845379, 13.875016428259471], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.724600923550126, -10.630973172294059, -18.665413647081582, -18.219305015660957, -5.174807021040949, -7.129495493945521, -20.01230821320016, -8.200655143465337, -31.480132852831186, -14.136258046271736, -17.448392298436456, -41.7921704490364, -21.45228810107186, -20.52168578955373, -0.9550902227154117, -8.103547643995203, -32.4844418236322, -8.45710953046214, -28.73951632224431, -11.590326166880388, -13.872383335520778, -16.358989807639297, 4.351283518321134, -17.363003671804815, -2.2544734496835934, -10.080498361611262, -17.477068766638993, -10.169496724644514, -15.948342550740255, 0.324640607473218, -11.4196658295692, -17.111047750268206, -36.34038314422989, -3.3703358913624406, -26.337613388424533, -10.386886552998849, -16.98168178004189, -6.987448470860603, -28.02847675811978, -32.25450210377776, -17.27927358233267, -30.785069878627418, -30.2268816598468, -22.918701790475204, -28.00054264755577, -4.384343129203747, -23.311149565287405, -7.618579379732539, -33.8364998802804, -37.74263329101704, -12.667973213191663, -35.38486976861391, -15.868048308353144, 2.1379757606878282, -21.03032942608777, 0.03883759253526531, -5.148581243132723, -10.47156782871323, -3.1615479954726045, -32.005319369100995, -21.27011722048588, -33.41434397537318, -37.49405025150003, -18.47808865871595, -15.376431722848576, -1.2952843546851005, -23.654843867189143, -11.221360874227898, -31.970179866210994, -21.717159625482395, -7.567097572743056, -27.42177799339218, 1.4412288676053544, -10.656212204379065, -3.0957361176254796, -18.8757762053938, -23.728270175323477, -4.349305978387934, -20.240387497599848, -21.608690758060654, -34.91880449853186, -10.572284794900678, -8.389663160144543, -44.79817366964083, -18.990486953002225, -34.23125470279956, -18.10497763771322, 2.01556229090499, -24.12402615935626, -20.638213230983116, -31.56219732885492, -31.679167083972267, -30.097166481043395, -5.638174376010456, -17.106259977479894, -18.6633262426323, -23.820486995384094, -22.876594292403535, -5.220466435845406, -13.875016428259462], "policy_predator_policy_reward": [20.817016977604663, 4.632184869495605, 6.632132559414076, 14.629813785174061, 20.882947647815506, 16.447879646347698, 16.170826016440774, 20.26778401488114, 3.2858899980630145, 7.063724044018878, 22.811330006478265, -8.55233901858722, 26.714015331634425, 13.310601094765934, -0.15440368713349084, 16.555713974064155, 32.93087653589828, 30.02938916976408, -5.157948755665096, 33.43046484820853, 27.62266150898659, 7.274123087886316, 45.80461840049673, 37.77972249757611, 21.97992809108427, 20.92464811105946, 26.22416257699699, 14.819209002110576, 7.682590515262888, -5.772410069832045, 17.96734892597177, -1.7602536379813492, 46.782015714753356, 18.186867932510964, 12.251547163993653, 4.662671896930634, 31.661234816162086, 25.817797828326558, 2.375044582233799, 20.80560775152698, 12.235791428465783, 15.508975242575739, 18.9483136038857, 13.769666011392882, -4.083624135714897, -4.618942900927369, 31.732243928862452, 2.9937634147471694, 3.5205059318881116, 0.9884409674790735, 24.43283708921804, -4.271840365995521, 6.838561886760415, 28.11557564651754, 7.660595916541444, 12.67839753274756, 14.229618989780475, 17.66706611170006, -8.957871273972655, 8.308590059026253, 8.205329273757872, 14.634002385380509, 33.61289092870908, 0.6092045718273713, 43.365177054870834, 29.315589233588973, -1.512947672642694, 8.253619455367561, 30.905696968541505, 21.769529808307553, 17.173185792066985, 3.60058731393071, 21.319052373078836, 12.644311187004936, 21.176456228048814, -7.201559286327649, 34.55276343453574, 21.504190081703854, 32.77497597303106, 31.734028234524434, -2.010878958431581, 36.56942612309698, 27.13475153642201, 34.435388220832806, 28.804009056192356, 31.64975426350125, 25.418601534325614, 20.418802046624805, 27.14836499595532, 28.852720299156235, 10.223456230850148, -1.454769972442655, 28.752105411513092, 17.870193719061696, 10.403818575244763, 4.833340184220328, 48.17594803780719, 19.497051722753554, 38.71234370556707, 36.77292287646702, 16.64345537826175, 8.692491048121529, 38.611901385452846, 32.15783815177498, 17.140357851818433, 14.595738764887809, -5.2720820316616095, 0.9961305102859406, 20.415663380323245, 21.644995471852262, 2.263915503188663, -2.341590688259185, 22.03943862695688, -11.74227614069141, 5.058779059553357, 15.884356597873111, 8.54706762371235, -2.223971632767144, 28.671486231201364, 35.339152507000605, 11.774364098311354, 30.765870342660424, 41.61531517483742, 25.21337277590892, 33.00510235211329, 41.98299815088674, 28.38001248524143, 8.57616483219047, 24.991520100826648, 5.76134334487049, 14.81772120734437, -12.227152497974163, 27.148554532377624, 20.16113320200066, 13.719209816078006, 8.723511932377786, 34.60615884039856, 29.334200892023404, 27.6109338869068, 15.82338536405796, 5.267841894232182, 9.866353251253935, 50.78511257458022, 4.058443412204092, 7.355338234664133, -10.237795969874846, 5.500088607339817, 15.812335801418289, -3.8772681375405558, 10.068740372791519, 16.466101577859042, 21.285450832928582, 44.26859698827535, 3.187943362371584, -0.2534039424668695, 8.952015899242761, 29.117230977453524, 11.363544017746165, 8.819961591935067, 34.39741992418627, 35.43226421846244, 34.40534477860124, 21.340055735231665, -0.1954861454303245, 7.492601755454397, 9.286724564834685, 39.33984789964802, 50.25649943963367, 23.655823256734337, 14.325150649270052, 25.427061473529324, 43.03544793206976, 3.5781123512933934, 32.631842924133075, 8.653204824993075, -12.684329406803062, 27.572872271658788, 20.675180047053708, 25.362786287186903, 15.913640174779328, 15.202044147424452, 47.92235051028541, 27.592835295076835, 35.76549887286767, 15.125103373143022, 45.06922958894368, 2.869056774656425, 8.407291977364496, 14.256294445660496, 19.956225509299273, 14.590343166578645, 22.736309318685997, 34.27282692324211, 13.368147067526053, 26.014580371107982, 19.738608213699088, 10.305348889113507, 0.13558398257726267, 6.934164628174656, 20.815868228344257]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.635810553135466, "mean_inference_ms": 1.6892843693757407, "mean_action_processing_ms": 0.2601067580513531, "mean_env_wait_ms": 0.14710590381058183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005033731460571289, "StateBufferConnector_ms": 0.0043364763259887695, "ViewRequirementAgentConnector_ms": 0.0830756425857544}, "num_episodes": 18, "episode_return_max": 44.79817366964083, "episode_return_min": -4.351283518321138, "episode_return_mean": 17.609350549033863, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.98089860414507, "num_env_steps_trained_throughput_per_sec": 355.98089860414507, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 11037.857, "restore_workers_time_ms": 0.019, "training_step_time_ms": 11037.659, "sample_time_ms": 1231.412, "learn_time_ms": 9787.843, "learn_throughput": 408.67, "synch_weights_time_ms": 16.464}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "training_iteration": 93, "trial_id": "06536_00000", "date": "2024-08-11_17-31-02", "timestamp": 1723411862, "time_this_iter_s": 11.28422999382019, "time_total_s": 3404.7958867549896, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331714e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3404.7958867549896, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 50.8875, "ram_util_percent": 82.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9856050701191026, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0855673112596076, "policy_loss": -0.00550951582796794, "vf_loss": 2.0910664196436604, "vf_explained_var": 0.9512046530842782, "kl": 0.006664187036781641, "entropy": 0.44655231004580853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8449932363928943, "cur_kl_coeff": 3.41060513164848e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2735231467655725, "policy_loss": -0.002150204331520452, "vf_loss": 2.275673353987396, "vf_explained_var": 0.9518510132554978, "kl": 0.00424625522465673, "entropy": 0.31389349153432894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 44.79817366964083, "episode_reward_min": -6.951077879005044, "episode_reward_mean": 17.481742690039894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.79817366964083, "predator_policy": -15.243031820684521}, "policy_reward_max": {"prey_policy": 6.951077879005038, "predator_policy": 50.78511257458022}, "policy_reward_mean": {"prey_policy": -17.481742690039894, "predator_policy": 17.481742690039894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.351283518321138, 17.36300367180482, 2.2544734496835996, 10.080498361611264, 17.477068766638954, 10.169496724644526, 15.948342550740303, -0.32464060747321, 11.419665829569187, 17.111047750268206, 36.34038314422991, 3.3703358913624335, 26.337613388424554, 10.38688655299886, 16.98168178004189, 6.987448470860587, 28.02847675811982, 32.254502103777725, 17.2792735823327, 30.785069878627393, 30.226881659846786, 22.91870179047522, 28.000542647555793, 4.384343129203748, 23.31114956528741, 7.618579379732541, 33.83649988028041, 37.74263329101705, 12.667973213191667, 35.3848697686139, 15.86804830835309, -2.13797576068783, 21.030329426087718, -0.03883759253526353, 5.148581243132725, 10.47156782871323, 3.1615479954725982, 32.00531936910098, 21.27011722048587, 33.414343975373114, 37.49405025150001, 18.478088658715954, 15.37643172284859, 1.2952843546851058, 23.654843867189133, 11.2213608742279, 31.970179866211023, 21.717159625482395, 7.567097572743062, 27.42177799339216, -1.44122886760535, 10.656212204379067, 3.095736117625478, 18.875776205393812, 23.728270175323466, 4.34930597838794, 20.240387497599855, 21.60869075806065, 34.91880449853182, 10.572284794900684, 8.389663160144535, 44.79817366964083, 18.9904869530022, 34.231254702799546, 18.104977637713247, -2.0155622909049997, 24.124026159356262, 20.63821323098313, 31.562197328854893, 31.679167083972263, 30.097166481043384, 5.638174376010446, 17.10625997747987, 18.66332624263234, 23.820486995384062, 22.87659429240353, 5.220466435845379, 13.875016428259471, 35.08684257938378, 9.483166154777313, 10.899671823785022, 8.782952548965879, -6.951077879005044, 27.940729631293138, 25.12593563952562, 29.13122517896325, -1.3803073542168152, 19.011066940975976, 14.818462122106581, 25.613053917324088, 19.463584410879488, 11.24317308884875, 23.10917220666772, 9.077113978824995, 26.028118072534106, 20.172735669468363, 15.150295778893495, -2.602697245658848, 32.38378000632772, 3.802107850468701], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.351283518321134, -17.363003671804815, -2.2544734496835934, -10.080498361611262, -17.477068766638993, -10.169496724644514, -15.948342550740255, 0.324640607473218, -11.4196658295692, -17.111047750268206, -36.34038314422989, -3.3703358913624406, -26.337613388424533, -10.386886552998849, -16.98168178004189, -6.987448470860603, -28.02847675811978, -32.25450210377776, -17.27927358233267, -30.785069878627418, -30.2268816598468, -22.918701790475204, -28.00054264755577, -4.384343129203747, -23.311149565287405, -7.618579379732539, -33.8364998802804, -37.74263329101704, -12.667973213191663, -35.38486976861391, -15.868048308353144, 2.1379757606878282, -21.03032942608777, 0.03883759253526531, -5.148581243132723, -10.47156782871323, -3.1615479954726045, -32.005319369100995, -21.27011722048588, -33.41434397537318, -37.49405025150003, -18.47808865871595, -15.376431722848576, -1.2952843546851005, -23.654843867189143, -11.221360874227898, -31.970179866210994, -21.717159625482395, -7.567097572743056, -27.42177799339218, 1.4412288676053544, -10.656212204379065, -3.0957361176254796, -18.8757762053938, -23.728270175323477, -4.349305978387934, -20.240387497599848, -21.608690758060654, -34.91880449853186, -10.572284794900678, -8.389663160144543, -44.79817366964083, -18.990486953002225, -34.23125470279956, -18.10497763771322, 2.01556229090499, -24.12402615935626, -20.638213230983116, -31.56219732885492, -31.679167083972267, -30.097166481043395, -5.638174376010456, -17.106259977479894, -18.6633262426323, -23.820486995384094, -22.876594292403535, -5.220466435845406, -13.875016428259462, -35.08684257938375, -9.483166154777312, -10.899671823785003, -8.782952548965886, 6.951077879005038, -27.940729631293145, -25.12593563952563, -29.131225178963188, 1.3803073542168107, -19.011066940975986, -14.818462122106586, -25.613053917324073, -19.46358441087947, -11.24317308884875, -23.10917220666775, -9.077113978824993, -26.028118072534145, -20.172735669468377, -15.150295778893458, 2.602697245658857, -32.38378000632764, -3.802107850468703], "policy_predator_policy_reward": [-4.083624135714897, -4.618942900927369, 31.732243928862452, 2.9937634147471694, 3.5205059318881116, 0.9884409674790735, 24.43283708921804, -4.271840365995521, 6.838561886760415, 28.11557564651754, 7.660595916541444, 12.67839753274756, 14.229618989780475, 17.66706611170006, -8.957871273972655, 8.308590059026253, 8.205329273757872, 14.634002385380509, 33.61289092870908, 0.6092045718273713, 43.365177054870834, 29.315589233588973, -1.512947672642694, 8.253619455367561, 30.905696968541505, 21.769529808307553, 17.173185792066985, 3.60058731393071, 21.319052373078836, 12.644311187004936, 21.176456228048814, -7.201559286327649, 34.55276343453574, 21.504190081703854, 32.77497597303106, 31.734028234524434, -2.010878958431581, 36.56942612309698, 27.13475153642201, 34.435388220832806, 28.804009056192356, 31.64975426350125, 25.418601534325614, 20.418802046624805, 27.14836499595532, 28.852720299156235, 10.223456230850148, -1.454769972442655, 28.752105411513092, 17.870193719061696, 10.403818575244763, 4.833340184220328, 48.17594803780719, 19.497051722753554, 38.71234370556707, 36.77292287646702, 16.64345537826175, 8.692491048121529, 38.611901385452846, 32.15783815177498, 17.140357851818433, 14.595738764887809, -5.2720820316616095, 0.9961305102859406, 20.415663380323245, 21.644995471852262, 2.263915503188663, -2.341590688259185, 22.03943862695688, -11.74227614069141, 5.058779059553357, 15.884356597873111, 8.54706762371235, -2.223971632767144, 28.671486231201364, 35.339152507000605, 11.774364098311354, 30.765870342660424, 41.61531517483742, 25.21337277590892, 33.00510235211329, 41.98299815088674, 28.38001248524143, 8.57616483219047, 24.991520100826648, 5.76134334487049, 14.81772120734437, -12.227152497974163, 27.148554532377624, 20.16113320200066, 13.719209816078006, 8.723511932377786, 34.60615884039856, 29.334200892023404, 27.6109338869068, 15.82338536405796, 5.267841894232182, 9.866353251253935, 50.78511257458022, 4.058443412204092, 7.355338234664133, -10.237795969874846, 5.500088607339817, 15.812335801418289, -3.8772681375405558, 10.068740372791519, 16.466101577859042, 21.285450832928582, 44.26859698827535, 3.187943362371584, -0.2534039424668695, 8.952015899242761, 29.117230977453524, 11.363544017746165, 8.819961591935067, 34.39741992418627, 35.43226421846244, 34.40534477860124, 21.340055735231665, -0.1954861454303245, 7.492601755454397, 9.286724564834685, 39.33984789964802, 50.25649943963367, 23.655823256734337, 14.325150649270052, 25.427061473529324, 43.03544793206976, 3.5781123512933934, 32.631842924133075, 8.653204824993075, -12.684329406803062, 27.572872271658788, 20.675180047053708, 25.362786287186903, 15.913640174779328, 15.202044147424452, 47.92235051028541, 27.592835295076835, 35.76549887286767, 15.125103373143022, 45.06922958894368, 2.869056774656425, 8.407291977364496, 14.256294445660496, 19.956225509299273, 14.590343166578645, 22.736309318685997, 34.27282692324211, 13.368147067526053, 26.014580371107982, 19.738608213699088, 10.305348889113507, 0.13558398257726267, 6.934164628174656, 20.815868228344257, 37.14242471466107, 33.03126044410652, 5.604717834054952, 13.361614475499668, 5.292640418975114, 16.506703228594915, -1.2020005397908244, 18.767905637722574, 1.340876062674445, -15.243031820684521, 19.08765667655714, 36.79380258602916, 33.1681149747809, 17.083756304270352, 23.937727525958223, 34.324722831968174, 10.590506540712816, -13.351121249146443, 14.988989834306023, 23.03314404764597, 4.533020211927393, 25.103904032285815, 25.272861079271394, 25.95324675537674, 37.24997903098944, 1.6771897907695523, 0.6786925939993211, 21.80765358369818, 21.99149115526463, 24.22685325807088, 21.61688637364368, -3.4626584159936655, 21.574978160248534, 30.481257984819752, 27.176662256435023, 13.168809082501724, 8.204162071160964, 22.096429486625972, -12.991027183097842, 7.785632691780128, 31.74428590248675, 33.02327411016852, 4.414663204523876, 3.189552496413519]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.634721296575702, "mean_inference_ms": 1.6867993657101434, "mean_action_processing_ms": 0.2598334314012951, "mean_env_wait_ms": 0.1468452837474645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054885149002075195, "StateBufferConnector_ms": 0.004285454750061035, "ViewRequirementAgentConnector_ms": 0.08250820636749268}, "num_episodes": 22, "episode_return_max": 44.79817366964083, "episode_return_min": -6.951077879005044, "episode_return_mean": 17.481742690039894, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.5525948496608, "num_env_steps_trained_throughput_per_sec": 384.5525948496608, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 10873.832, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10873.633, "sample_time_ms": 1163.228, "learn_time_ms": 9692.065, "learn_throughput": 412.709, "synch_weights_time_ms": 16.476}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 94, "trial_id": "06536_00000", "date": "2024-08-11_17-31-13", "timestamp": 1723411873, "time_this_iter_s": 10.450845003128052, "time_total_s": 3415.2467317581177, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331712550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3415.2467317581177, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 45.76, "ram_util_percent": 81.94666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.893233424114684, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2857727942367396, "policy_loss": -0.006778599334453853, "vf_loss": 2.2925425082445146, "vf_explained_var": 0.9457325474669536, "kl": 0.0056913457539531954, "entropy": 0.4523271012119949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9200999164707446, "cur_kl_coeff": 1.70530256582424e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7140457067540082, "policy_loss": -0.0023548295250822786, "vf_loss": 2.7164005438486734, "vf_explained_var": 0.945978177949865, "kl": 0.003319386366067308, "entropy": 0.3130054852082616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "env_runners": {"episode_reward_max": 44.79817366964083, "episode_reward_min": -6.951077879005044, "episode_reward_mean": 18.252719596372415, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.79817366964083, "predator_policy": -15.243031820684521}, "policy_reward_max": {"prey_policy": 6.951077879005038, "predator_policy": 50.78511257458022}, "policy_reward_mean": {"prey_policy": -18.25271959637242, "predator_policy": 18.252719596372412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.2792735823327, 30.785069878627393, 30.226881659846786, 22.91870179047522, 28.000542647555793, 4.384343129203748, 23.31114956528741, 7.618579379732541, 33.83649988028041, 37.74263329101705, 12.667973213191667, 35.3848697686139, 15.86804830835309, -2.13797576068783, 21.030329426087718, -0.03883759253526353, 5.148581243132725, 10.47156782871323, 3.1615479954725982, 32.00531936910098, 21.27011722048587, 33.414343975373114, 37.49405025150001, 18.478088658715954, 15.37643172284859, 1.2952843546851058, 23.654843867189133, 11.2213608742279, 31.970179866211023, 21.717159625482395, 7.567097572743062, 27.42177799339216, -1.44122886760535, 10.656212204379067, 3.095736117625478, 18.875776205393812, 23.728270175323466, 4.34930597838794, 20.240387497599855, 21.60869075806065, 34.91880449853182, 10.572284794900684, 8.389663160144535, 44.79817366964083, 18.9904869530022, 34.231254702799546, 18.104977637713247, -2.0155622909049997, 24.124026159356262, 20.63821323098313, 31.562197328854893, 31.679167083972263, 30.097166481043384, 5.638174376010446, 17.10625997747987, 18.66332624263234, 23.820486995384062, 22.87659429240353, 5.220466435845379, 13.875016428259471, 35.08684257938378, 9.483166154777313, 10.899671823785022, 8.782952548965879, -6.951077879005044, 27.940729631293138, 25.12593563952562, 29.13122517896325, -1.3803073542168152, 19.011066940975976, 14.818462122106581, 25.613053917324088, 19.463584410879488, 11.24317308884875, 23.10917220666772, 9.077113978824995, 26.028118072534106, 20.172735669468363, 15.150295778893495, -2.602697245658848, 32.38378000632772, 3.802107850468701, 9.957494468502821, 8.191158508867963, -4.263324595893204, 19.068997546099396, 13.637041087137831, 42.54899186522784, 20.837163863367234, 29.05981652984506, 8.435764121359133, 0.34400670964778834, 22.33320289665359, 11.48727181548289, 36.18787686215583, 24.92952416575993, 7.065804730955187, 22.878496160878882, 21.27003021627378, 40.96337474991208], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.27927358233267, -30.785069878627418, -30.2268816598468, -22.918701790475204, -28.00054264755577, -4.384343129203747, -23.311149565287405, -7.618579379732539, -33.8364998802804, -37.74263329101704, -12.667973213191663, -35.38486976861391, -15.868048308353144, 2.1379757606878282, -21.03032942608777, 0.03883759253526531, -5.148581243132723, -10.47156782871323, -3.1615479954726045, -32.005319369100995, -21.27011722048588, -33.41434397537318, -37.49405025150003, -18.47808865871595, -15.376431722848576, -1.2952843546851005, -23.654843867189143, -11.221360874227898, -31.970179866210994, -21.717159625482395, -7.567097572743056, -27.42177799339218, 1.4412288676053544, -10.656212204379065, -3.0957361176254796, -18.8757762053938, -23.728270175323477, -4.349305978387934, -20.240387497599848, -21.608690758060654, -34.91880449853186, -10.572284794900678, -8.389663160144543, -44.79817366964083, -18.990486953002225, -34.23125470279956, -18.10497763771322, 2.01556229090499, -24.12402615935626, -20.638213230983116, -31.56219732885492, -31.679167083972267, -30.097166481043395, -5.638174376010456, -17.106259977479894, -18.6633262426323, -23.820486995384094, -22.876594292403535, -5.220466435845406, -13.875016428259462, -35.08684257938375, -9.483166154777312, -10.899671823785003, -8.782952548965886, 6.951077879005038, -27.940729631293145, -25.12593563952563, -29.131225178963188, 1.3803073542168107, -19.011066940975986, -14.818462122106586, -25.613053917324073, -19.46358441087947, -11.24317308884875, -23.10917220666775, -9.077113978824993, -26.028118072534145, -20.172735669468377, -15.150295778893458, 2.602697245658857, -32.38378000632764, -3.802107850468703, -9.957494468502817, -8.191158508867964, 4.2633245958931845, -19.06899754609941, -13.637041087137812, -42.54899186522778, -20.83716386336724, -29.059816529845083, -8.435764121359146, -0.344006709647791, -22.33320289665362, -11.487271815482892, -36.18787686215584, -24.92952416575998, -7.065804730955193, -22.878496160878893, -21.270030216273774, -40.96337474991209], "policy_predator_policy_reward": [-2.010878958431581, 36.56942612309698, 27.13475153642201, 34.435388220832806, 28.804009056192356, 31.64975426350125, 25.418601534325614, 20.418802046624805, 27.14836499595532, 28.852720299156235, 10.223456230850148, -1.454769972442655, 28.752105411513092, 17.870193719061696, 10.403818575244763, 4.833340184220328, 48.17594803780719, 19.497051722753554, 38.71234370556707, 36.77292287646702, 16.64345537826175, 8.692491048121529, 38.611901385452846, 32.15783815177498, 17.140357851818433, 14.595738764887809, -5.2720820316616095, 0.9961305102859406, 20.415663380323245, 21.644995471852262, 2.263915503188663, -2.341590688259185, 22.03943862695688, -11.74227614069141, 5.058779059553357, 15.884356597873111, 8.54706762371235, -2.223971632767144, 28.671486231201364, 35.339152507000605, 11.774364098311354, 30.765870342660424, 41.61531517483742, 25.21337277590892, 33.00510235211329, 41.98299815088674, 28.38001248524143, 8.57616483219047, 24.991520100826648, 5.76134334487049, 14.81772120734437, -12.227152497974163, 27.148554532377624, 20.16113320200066, 13.719209816078006, 8.723511932377786, 34.60615884039856, 29.334200892023404, 27.6109338869068, 15.82338536405796, 5.267841894232182, 9.866353251253935, 50.78511257458022, 4.058443412204092, 7.355338234664133, -10.237795969874846, 5.500088607339817, 15.812335801418289, -3.8772681375405558, 10.068740372791519, 16.466101577859042, 21.285450832928582, 44.26859698827535, 3.187943362371584, -0.2534039424668695, 8.952015899242761, 29.117230977453524, 11.363544017746165, 8.819961591935067, 34.39741992418627, 35.43226421846244, 34.40534477860124, 21.340055735231665, -0.1954861454303245, 7.492601755454397, 9.286724564834685, 39.33984789964802, 50.25649943963367, 23.655823256734337, 14.325150649270052, 25.427061473529324, 43.03544793206976, 3.5781123512933934, 32.631842924133075, 8.653204824993075, -12.684329406803062, 27.572872271658788, 20.675180047053708, 25.362786287186903, 15.913640174779328, 15.202044147424452, 47.92235051028541, 27.592835295076835, 35.76549887286767, 15.125103373143022, 45.06922958894368, 2.869056774656425, 8.407291977364496, 14.256294445660496, 19.956225509299273, 14.590343166578645, 22.736309318685997, 34.27282692324211, 13.368147067526053, 26.014580371107982, 19.738608213699088, 10.305348889113507, 0.13558398257726267, 6.934164628174656, 20.815868228344257, 37.14242471466107, 33.03126044410652, 5.604717834054952, 13.361614475499668, 5.292640418975114, 16.506703228594915, -1.2020005397908244, 18.767905637722574, 1.340876062674445, -15.243031820684521, 19.08765667655714, 36.79380258602916, 33.1681149747809, 17.083756304270352, 23.937727525958223, 34.324722831968174, 10.590506540712816, -13.351121249146443, 14.988989834306023, 23.03314404764597, 4.533020211927393, 25.103904032285815, 25.272861079271394, 25.95324675537674, 37.24997903098944, 1.6771897907695523, 0.6786925939993211, 21.80765358369818, 21.99149115526463, 24.22685325807088, 21.61688637364368, -3.4626584159936655, 21.574978160248534, 30.481257984819752, 27.176662256435023, 13.168809082501724, 8.204162071160964, 22.096429486625972, -12.991027183097842, 7.785632691780128, 31.74428590248675, 33.02327411016852, 4.414663204523876, 3.189552496413519, 13.340567471150791, 6.57442146585486, 22.27621301176659, -5.893895994030638, -12.079448177397326, 3.5527989856109556, 19.289382204705348, 18.84861288749346, 9.544579791391183, 17.729502382884483, 40.16018670773817, 44.937797022717426, 19.78418422084106, 21.890143505893427, 29.594153959899902, 28.52547909979025, 16.72041182847086, 0.15111641424742217, -2.1795685860096343, 2.8675820053052137, 36.494479730150466, 8.17192606315674, 17.732498081616104, 5.242045549349649, 35.550532625477445, 36.82522109883421, 19.533203733236753, 30.32584459828319, 4.666910449080071, 9.464699012830309, 26.093116082617954, 19.66387623913983, 22.38258655929902, 20.157473873248534, 32.3380305701524, 49.58871892967178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6338483723741555, "mean_inference_ms": 1.6848272557790325, "mean_action_processing_ms": 0.2595881133730402, "mean_env_wait_ms": 0.1466764543719175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005749821662902832, "StateBufferConnector_ms": 0.004309654235839844, "ViewRequirementAgentConnector_ms": 0.08439016342163086}, "num_episodes": 18, "episode_return_max": 44.79817366964083, "episode_return_min": -6.951077879005044, "episode_return_mean": 18.252719596372415, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.96272453908296, "num_env_steps_trained_throughput_per_sec": 398.96272453908296, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 10708.471, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10708.356, "sample_time_ms": 1141.943, "learn_time_ms": 9548.441, "learn_throughput": 418.917, "synch_weights_time_ms": 16.154}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "training_iteration": 95, "trial_id": "06536_00000", "date": "2024-08-11_17-31-23", "timestamp": 1723411883, "time_this_iter_s": 10.062374830245972, "time_total_s": 3425.3091065883636, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316fff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3425.3091065883636, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 43.964285714285715, "ram_util_percent": 81.92142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8833170837412276, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2578688016782205, "policy_loss": -0.005037000350421294, "vf_loss": 2.262896622469028, "vf_explained_var": 0.9514959416662653, "kl": 0.00587289637508996, "entropy": 0.45646424299726884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.902871355493233, "cur_kl_coeff": 8.5265128291212e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6598446669401947, "policy_loss": -0.0030694395292639024, "vf_loss": 2.6629141115006947, "vf_explained_var": 0.9457789815292157, "kl": 0.0038304119655633976, "entropy": 0.2539347843518333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 44.79817366964083, "episode_reward_min": -6.951077879005044, "episode_reward_mean": 17.446795218845285, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.79817366964083, "predator_policy": -15.526005914229208}, "policy_reward_max": {"prey_policy": 6.951077879005038, "predator_policy": 51.47501038631397}, "policy_reward_mean": {"prey_policy": -17.446795218845285, "predator_policy": 17.44679521884529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.478088658715954, 15.37643172284859, 1.2952843546851058, 23.654843867189133, 11.2213608742279, 31.970179866211023, 21.717159625482395, 7.567097572743062, 27.42177799339216, -1.44122886760535, 10.656212204379067, 3.095736117625478, 18.875776205393812, 23.728270175323466, 4.34930597838794, 20.240387497599855, 21.60869075806065, 34.91880449853182, 10.572284794900684, 8.389663160144535, 44.79817366964083, 18.9904869530022, 34.231254702799546, 18.104977637713247, -2.0155622909049997, 24.124026159356262, 20.63821323098313, 31.562197328854893, 31.679167083972263, 30.097166481043384, 5.638174376010446, 17.10625997747987, 18.66332624263234, 23.820486995384062, 22.87659429240353, 5.220466435845379, 13.875016428259471, 35.08684257938378, 9.483166154777313, 10.899671823785022, 8.782952548965879, -6.951077879005044, 27.940729631293138, 25.12593563952562, 29.13122517896325, -1.3803073542168152, 19.011066940975976, 14.818462122106581, 25.613053917324088, 19.463584410879488, 11.24317308884875, 23.10917220666772, 9.077113978824995, 26.028118072534106, 20.172735669468363, 15.150295778893495, -2.602697245658848, 32.38378000632772, 3.802107850468701, 9.957494468502821, 8.191158508867963, -4.263324595893204, 19.068997546099396, 13.637041087137831, 42.54899186522784, 20.837163863367234, 29.05981652984506, 8.435764121359133, 0.34400670964778834, 22.33320289665359, 11.48727181548289, 36.18787686215583, 24.92952416575993, 7.065804730955187, 22.878496160878882, 21.27003021627378, 40.96337474991208, 38.969865547864586, 9.797737067313557, 28.796142663928652, 23.05784032897746, 11.04027977611894, 9.07994459173777, 15.63171911465167, 9.874822978597553, 14.96088368985948, 17.851425573130424, 26.485323273998336, 40.3707314437359, -4.174844417036723, 38.032383065977996, 6.87183883244219, 18.33851107653116, -2.978417445064604, 28.788902195638887, 22.304283020656584, 13.752264865562216, 8.23525029871348, -3.4773145360988025, 9.641599291211689], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.47808865871595, -15.376431722848576, -1.2952843546851005, -23.654843867189143, -11.221360874227898, -31.970179866210994, -21.717159625482395, -7.567097572743056, -27.42177799339218, 1.4412288676053544, -10.656212204379065, -3.0957361176254796, -18.8757762053938, -23.728270175323477, -4.349305978387934, -20.240387497599848, -21.608690758060654, -34.91880449853186, -10.572284794900678, -8.389663160144543, -44.79817366964083, -18.990486953002225, -34.23125470279956, -18.10497763771322, 2.01556229090499, -24.12402615935626, -20.638213230983116, -31.56219732885492, -31.679167083972267, -30.097166481043395, -5.638174376010456, -17.106259977479894, -18.6633262426323, -23.820486995384094, -22.876594292403535, -5.220466435845406, -13.875016428259462, -35.08684257938375, -9.483166154777312, -10.899671823785003, -8.782952548965886, 6.951077879005038, -27.940729631293145, -25.12593563952563, -29.131225178963188, 1.3803073542168107, -19.011066940975986, -14.818462122106586, -25.613053917324073, -19.46358441087947, -11.24317308884875, -23.10917220666775, -9.077113978824993, -26.028118072534145, -20.172735669468377, -15.150295778893458, 2.602697245658857, -32.38378000632764, -3.802107850468703, -9.957494468502817, -8.191158508867964, 4.2633245958931845, -19.06899754609941, -13.637041087137812, -42.54899186522778, -20.83716386336724, -29.059816529845083, -8.435764121359146, -0.344006709647791, -22.33320289665362, -11.487271815482892, -36.18787686215584, -24.92952416575998, -7.065804730955193, -22.878496160878893, -21.270030216273774, -40.96337474991209, -38.9698655478647, -9.79773706731357, -28.79614266392864, -23.057840328977456, -11.040279776118938, -9.07994459173775, -15.631719114651673, -9.874822978597532, -14.960883689859497, -17.851425573130406, -26.48532327399831, -40.37073144373587, 4.174844417036724, -38.03238306597801, -6.871838832442225, -18.33851107653119, 2.9784174450645917, -28.788902195638865, -22.304283020656584, -13.752264865562207, -8.235250298713465, 3.477314536098805, -9.641599291211687], "policy_predator_policy_reward": [28.38001248524143, 8.57616483219047, 24.991520100826648, 5.76134334487049, 14.81772120734437, -12.227152497974163, 27.148554532377624, 20.16113320200066, 13.719209816078006, 8.723511932377786, 34.60615884039856, 29.334200892023404, 27.6109338869068, 15.82338536405796, 5.267841894232182, 9.866353251253935, 50.78511257458022, 4.058443412204092, 7.355338234664133, -10.237795969874846, 5.500088607339817, 15.812335801418289, -3.8772681375405558, 10.068740372791519, 16.466101577859042, 21.285450832928582, 44.26859698827535, 3.187943362371584, -0.2534039424668695, 8.952015899242761, 29.117230977453524, 11.363544017746165, 8.819961591935067, 34.39741992418627, 35.43226421846244, 34.40534477860124, 21.340055735231665, -0.1954861454303245, 7.492601755454397, 9.286724564834685, 39.33984789964802, 50.25649943963367, 23.655823256734337, 14.325150649270052, 25.427061473529324, 43.03544793206976, 3.5781123512933934, 32.631842924133075, 8.653204824993075, -12.684329406803062, 27.572872271658788, 20.675180047053708, 25.362786287186903, 15.913640174779328, 15.202044147424452, 47.92235051028541, 27.592835295076835, 35.76549887286767, 15.125103373143022, 45.06922958894368, 2.869056774656425, 8.407291977364496, 14.256294445660496, 19.956225509299273, 14.590343166578645, 22.736309318685997, 34.27282692324211, 13.368147067526053, 26.014580371107982, 19.738608213699088, 10.305348889113507, 0.13558398257726267, 6.934164628174656, 20.815868228344257, 37.14242471466107, 33.03126044410652, 5.604717834054952, 13.361614475499668, 5.292640418975114, 16.506703228594915, -1.2020005397908244, 18.767905637722574, 1.340876062674445, -15.243031820684521, 19.08765667655714, 36.79380258602916, 33.1681149747809, 17.083756304270352, 23.937727525958223, 34.324722831968174, 10.590506540712816, -13.351121249146443, 14.988989834306023, 23.03314404764597, 4.533020211927393, 25.103904032285815, 25.272861079271394, 25.95324675537674, 37.24997903098944, 1.6771897907695523, 0.6786925939993211, 21.80765358369818, 21.99149115526463, 24.22685325807088, 21.61688637364368, -3.4626584159936655, 21.574978160248534, 30.481257984819752, 27.176662256435023, 13.168809082501724, 8.204162071160964, 22.096429486625972, -12.991027183097842, 7.785632691780128, 31.74428590248675, 33.02327411016852, 4.414663204523876, 3.189552496413519, 13.340567471150791, 6.57442146585486, 22.27621301176659, -5.893895994030638, -12.079448177397326, 3.5527989856109556, 19.289382204705348, 18.84861288749346, 9.544579791391183, 17.729502382884483, 40.16018670773817, 44.937797022717426, 19.78418422084106, 21.890143505893427, 29.594153959899902, 28.52547909979025, 16.72041182847086, 0.15111641424742217, -2.1795685860096343, 2.8675820053052137, 36.494479730150466, 8.17192606315674, 17.732498081616104, 5.242045549349649, 35.550532625477445, 36.82522109883421, 19.533203733236753, 30.32584459828319, 4.666910449080071, 9.464699012830309, 26.093116082617954, 19.66387623913983, 22.38258655929902, 20.157473873248534, 32.3380305701524, 49.58871892967178, 40.1878209914799, 37.751910104249475, 22.303403165682795, -2.7079290310556754, 7.983204373216967, 49.609080954640326, 27.687049610184793, 18.428631047770107, 11.41311311557959, 10.667446436658288, 23.63087092237638, -5.4709817389008695, 21.627157978207784, 9.636280251095556, 11.415619177525612, 8.334026779669458, 6.101133368040633, 23.820634011678344, 33.09718620933973, 2.605664936921106, 35.59085049427612, 17.379796053720472, 51.47501038631397, 29.26645250115779, -11.362661026077225, 3.0129721920037618, 26.483762727069262, 49.581003404886744, -11.959979726402004, 25.70365739128642, 5.213409192387369, 31.46361296067496, -5.06639915079537, -0.8904357393338067, 36.16590581479875, 21.41189857647903, 13.7257576497375, 30.882808391575644, 17.900675642443947, 9.603854088680482, 0.11606983157211337, 16.354430765854822, -15.526005914229208, 8.5713768420316, 18.242451036254895, 1.040747546168479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6325704981682201, "mean_inference_ms": 1.6814561212237775, "mean_action_processing_ms": 0.2591514046473072, "mean_env_wait_ms": 0.14639246147239404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005139350891113281, "StateBufferConnector_ms": 0.0040084123611450195, "ViewRequirementAgentConnector_ms": 0.07615447044372559}, "num_episodes": 23, "episode_return_max": 44.79817366964083, "episode_return_min": -6.951077879005044, "episode_return_mean": 17.446795218845285, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.04195678833696, "num_env_steps_trained_throughput_per_sec": 344.04195678833696, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 10792.59, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10792.464, "sample_time_ms": 1158.572, "learn_time_ms": 9614.074, "learn_throughput": 416.057, "synch_weights_time_ms": 18.284}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 96, "trial_id": "06536_00000", "date": "2024-08-11_17-31-35", "timestamp": 1723411895, "time_this_iter_s": 11.67764687538147, "time_total_s": 3436.986753463745, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331712670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3436.986753463745, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 50.9764705882353, "ram_util_percent": 82.39411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.047633019213875, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5435331992805006, "policy_loss": -0.010137333103921264, "vf_loss": 2.5536563088496527, "vf_explained_var": 0.9420407451689243, "kl": 0.009100542232375376, "entropy": 0.4778781248567005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8475024613753828, "cur_kl_coeff": 4.2632564145606e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6858897588240405, "policy_loss": -0.003093451724348284, "vf_loss": 2.688983208855624, "vf_explained_var": 0.9470437516611089, "kl": 0.004431196334124591, "entropy": 0.2745488772001216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "env_runners": {"episode_reward_max": 44.79817366964083, "episode_reward_min": -6.951077879005044, "episode_reward_mean": 17.862129542785773, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.79817366964083, "predator_policy": -15.526005914229208}, "policy_reward_max": {"prey_policy": 6.951077879005038, "predator_policy": 51.47501038631397}, "policy_reward_mean": {"prey_policy": -17.862129542785773, "predator_policy": 17.862129542785773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.572284794900684, 8.389663160144535, 44.79817366964083, 18.9904869530022, 34.231254702799546, 18.104977637713247, -2.0155622909049997, 24.124026159356262, 20.63821323098313, 31.562197328854893, 31.679167083972263, 30.097166481043384, 5.638174376010446, 17.10625997747987, 18.66332624263234, 23.820486995384062, 22.87659429240353, 5.220466435845379, 13.875016428259471, 35.08684257938378, 9.483166154777313, 10.899671823785022, 8.782952548965879, -6.951077879005044, 27.940729631293138, 25.12593563952562, 29.13122517896325, -1.3803073542168152, 19.011066940975976, 14.818462122106581, 25.613053917324088, 19.463584410879488, 11.24317308884875, 23.10917220666772, 9.077113978824995, 26.028118072534106, 20.172735669468363, 15.150295778893495, -2.602697245658848, 32.38378000632772, 3.802107850468701, 9.957494468502821, 8.191158508867963, -4.263324595893204, 19.068997546099396, 13.637041087137831, 42.54899186522784, 20.837163863367234, 29.05981652984506, 8.435764121359133, 0.34400670964778834, 22.33320289665359, 11.48727181548289, 36.18787686215583, 24.92952416575993, 7.065804730955187, 22.878496160878882, 21.27003021627378, 40.96337474991208, 38.969865547864586, 9.797737067313557, 28.796142663928652, 23.05784032897746, 11.04027977611894, 9.07994459173777, 15.63171911465167, 9.874822978597553, 14.96088368985948, 17.851425573130424, 26.485323273998336, 40.3707314437359, -4.174844417036723, 38.032383065977996, 6.87183883244219, 18.33851107653116, -2.978417445064604, 28.788902195638887, 22.304283020656584, 13.752264865562216, 8.23525029871348, -3.4773145360988025, 9.641599291211689, 13.416308452948266, 17.002255672736037, 18.874087010301, 9.555709638238262, 40.87979209188555, 15.674672219193644, 23.634971749277373, 27.74989489491082, -5.626149156925041, 32.292181498271255, -1.4371830300390158, 36.90362166545948, 30.659297908210362, 10.287235254555288, 14.607687902002088, 21.80004751674719, 29.317790892582842, 0.6753893168850214], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.572284794900678, -8.389663160144543, -44.79817366964083, -18.990486953002225, -34.23125470279956, -18.10497763771322, 2.01556229090499, -24.12402615935626, -20.638213230983116, -31.56219732885492, -31.679167083972267, -30.097166481043395, -5.638174376010456, -17.106259977479894, -18.6633262426323, -23.820486995384094, -22.876594292403535, -5.220466435845406, -13.875016428259462, -35.08684257938375, -9.483166154777312, -10.899671823785003, -8.782952548965886, 6.951077879005038, -27.940729631293145, -25.12593563952563, -29.131225178963188, 1.3803073542168107, -19.011066940975986, -14.818462122106586, -25.613053917324073, -19.46358441087947, -11.24317308884875, -23.10917220666775, -9.077113978824993, -26.028118072534145, -20.172735669468377, -15.150295778893458, 2.602697245658857, -32.38378000632764, -3.802107850468703, -9.957494468502817, -8.191158508867964, 4.2633245958931845, -19.06899754609941, -13.637041087137812, -42.54899186522778, -20.83716386336724, -29.059816529845083, -8.435764121359146, -0.344006709647791, -22.33320289665362, -11.487271815482892, -36.18787686215584, -24.92952416575998, -7.065804730955193, -22.878496160878893, -21.270030216273774, -40.96337474991209, -38.9698655478647, -9.79773706731357, -28.79614266392864, -23.057840328977456, -11.040279776118938, -9.07994459173775, -15.631719114651673, -9.874822978597532, -14.960883689859497, -17.851425573130406, -26.48532327399831, -40.37073144373587, 4.174844417036724, -38.03238306597801, -6.871838832442225, -18.33851107653119, 2.9784174450645917, -28.788902195638865, -22.304283020656584, -13.752264865562207, -8.235250298713465, 3.477314536098805, -9.641599291211687, -13.416308452948282, -17.00225567273604, -18.874087010301025, -9.555709638238246, -40.87979209188557, -15.67467221919365, -23.634971749277383, -27.749894894910845, 5.626149156925044, -32.29218149827124, 1.4371830300390216, -36.9036216654595, -30.659297908210362, -10.28723525455527, -14.607687902002064, -21.800047516747167, -29.317790892582828, -0.6753893168850018], "policy_predator_policy_reward": [21.340055735231665, -0.1954861454303245, 7.492601755454397, 9.286724564834685, 39.33984789964802, 50.25649943963367, 23.655823256734337, 14.325150649270052, 25.427061473529324, 43.03544793206976, 3.5781123512933934, 32.631842924133075, 8.653204824993075, -12.684329406803062, 27.572872271658788, 20.675180047053708, 25.362786287186903, 15.913640174779328, 15.202044147424452, 47.92235051028541, 27.592835295076835, 35.76549887286767, 15.125103373143022, 45.06922958894368, 2.869056774656425, 8.407291977364496, 14.256294445660496, 19.956225509299273, 14.590343166578645, 22.736309318685997, 34.27282692324211, 13.368147067526053, 26.014580371107982, 19.738608213699088, 10.305348889113507, 0.13558398257726267, 6.934164628174656, 20.815868228344257, 37.14242471466107, 33.03126044410652, 5.604717834054952, 13.361614475499668, 5.292640418975114, 16.506703228594915, -1.2020005397908244, 18.767905637722574, 1.340876062674445, -15.243031820684521, 19.08765667655714, 36.79380258602916, 33.1681149747809, 17.083756304270352, 23.937727525958223, 34.324722831968174, 10.590506540712816, -13.351121249146443, 14.988989834306023, 23.03314404764597, 4.533020211927393, 25.103904032285815, 25.272861079271394, 25.95324675537674, 37.24997903098944, 1.6771897907695523, 0.6786925939993211, 21.80765358369818, 21.99149115526463, 24.22685325807088, 21.61688637364368, -3.4626584159936655, 21.574978160248534, 30.481257984819752, 27.176662256435023, 13.168809082501724, 8.204162071160964, 22.096429486625972, -12.991027183097842, 7.785632691780128, 31.74428590248675, 33.02327411016852, 4.414663204523876, 3.189552496413519, 13.340567471150791, 6.57442146585486, 22.27621301176659, -5.893895994030638, -12.079448177397326, 3.5527989856109556, 19.289382204705348, 18.84861288749346, 9.544579791391183, 17.729502382884483, 40.16018670773817, 44.937797022717426, 19.78418422084106, 21.890143505893427, 29.594153959899902, 28.52547909979025, 16.72041182847086, 0.15111641424742217, -2.1795685860096343, 2.8675820053052137, 36.494479730150466, 8.17192606315674, 17.732498081616104, 5.242045549349649, 35.550532625477445, 36.82522109883421, 19.533203733236753, 30.32584459828319, 4.666910449080071, 9.464699012830309, 26.093116082617954, 19.66387623913983, 22.38258655929902, 20.157473873248534, 32.3380305701524, 49.58871892967178, 40.1878209914799, 37.751910104249475, 22.303403165682795, -2.7079290310556754, 7.983204373216967, 49.609080954640326, 27.687049610184793, 18.428631047770107, 11.41311311557959, 10.667446436658288, 23.63087092237638, -5.4709817389008695, 21.627157978207784, 9.636280251095556, 11.415619177525612, 8.334026779669458, 6.101133368040633, 23.820634011678344, 33.09718620933973, 2.605664936921106, 35.59085049427612, 17.379796053720472, 51.47501038631397, 29.26645250115779, -11.362661026077225, 3.0129721920037618, 26.483762727069262, 49.581003404886744, -11.959979726402004, 25.70365739128642, 5.213409192387369, 31.46361296067496, -5.06639915079537, -0.8904357393338067, 36.16590581479875, 21.41189857647903, 13.7257576497375, 30.882808391575644, 17.900675642443947, 9.603854088680482, 0.11606983157211337, 16.354430765854822, -15.526005914229208, 8.5713768420316, 18.242451036254895, 1.040747546168479, 10.43888112529298, 16.393735780603585, 15.900904934785125, 18.103606410686954, 19.491128834714655, 18.25704518588736, 7.699724707980973, 11.411694568495543, 49.43735500723329, 32.32222917653781, 11.365967904845842, 19.98337653354148, 33.73802410249888, 13.531919396055883, 39.87976916586001, 15.620020623961626, -12.617015067577615, 1.3647167537275227, 32.556977340410235, 32.0273856561323, 6.88729925854385, -9.761665318621908, 32.43252946193326, 41.37471386898571, 26.912677189109253, 34.405918627311436, 8.633929398535182, 11.940541110575353, 20.83741113747345, 8.377964666530676, 32.83706087106785, 10.763034162426466, 30.894331585593243, 27.741250199572427, 6.580935880193362, -5.230157246423362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6316391671650058, "mean_inference_ms": 1.6790298933031804, "mean_action_processing_ms": 0.2588159639443856, "mean_env_wait_ms": 0.14619049351732497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004758119583129883, "StateBufferConnector_ms": 0.004063248634338379, "ViewRequirementAgentConnector_ms": 0.07509088516235352}, "num_episodes": 18, "episode_return_max": 44.79817366964083, "episode_return_min": -6.951077879005044, "episode_return_mean": 17.862129542785773, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.10139813891493, "num_env_steps_trained_throughput_per_sec": 370.10139813891493, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 10778.951, "restore_workers_time_ms": 0.021, "training_step_time_ms": 10778.822, "sample_time_ms": 1111.124, "learn_time_ms": 9648.155, "learn_throughput": 414.587, "synch_weights_time_ms": 18.037}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "training_iteration": 97, "trial_id": "06536_00000", "date": "2024-08-11_17-31-46", "timestamp": 1723411906, "time_this_iter_s": 10.857284784317017, "time_total_s": 3447.844038248062, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316dae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3447.844038248062, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 51.366666666666674, "ram_util_percent": 82.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.890839146450162, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2013982106000185, "policy_loss": -0.00430597872909857, "vf_loss": 2.2056952347358068, "vf_explained_var": 0.951340248870353, "kl": 0.005734367950400602, "entropy": 0.4794665206844608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9405796603550987, "cur_kl_coeff": 2.1316282072803e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6476517186593758, "policy_loss": -0.0019622752231067764, "vf_loss": 2.6496139996266237, "vf_explained_var": 0.9388302271959013, "kl": 0.003282793841352623, "entropy": 0.2485174375472876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 42.54899186522784, "episode_reward_min": -6.951077879005044, "episode_reward_mean": 16.826151525321148, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.54899186522778, "predator_policy": -15.526005914229208}, "policy_reward_max": {"prey_policy": 6.951077879005038, "predator_policy": 51.47501038631397}, "policy_reward_mean": {"prey_policy": -16.826151525321148, "predator_policy": 16.82615152532115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.782952548965879, -6.951077879005044, 27.940729631293138, 25.12593563952562, 29.13122517896325, -1.3803073542168152, 19.011066940975976, 14.818462122106581, 25.613053917324088, 19.463584410879488, 11.24317308884875, 23.10917220666772, 9.077113978824995, 26.028118072534106, 20.172735669468363, 15.150295778893495, -2.602697245658848, 32.38378000632772, 3.802107850468701, 9.957494468502821, 8.191158508867963, -4.263324595893204, 19.068997546099396, 13.637041087137831, 42.54899186522784, 20.837163863367234, 29.05981652984506, 8.435764121359133, 0.34400670964778834, 22.33320289665359, 11.48727181548289, 36.18787686215583, 24.92952416575993, 7.065804730955187, 22.878496160878882, 21.27003021627378, 40.96337474991208, 38.969865547864586, 9.797737067313557, 28.796142663928652, 23.05784032897746, 11.04027977611894, 9.07994459173777, 15.63171911465167, 9.874822978597553, 14.96088368985948, 17.851425573130424, 26.485323273998336, 40.3707314437359, -4.174844417036723, 38.032383065977996, 6.87183883244219, 18.33851107653116, -2.978417445064604, 28.788902195638887, 22.304283020656584, 13.752264865562216, 8.23525029871348, -3.4773145360988025, 9.641599291211689, 13.416308452948266, 17.002255672736037, 18.874087010301, 9.555709638238262, 40.87979209188555, 15.674672219193644, 23.634971749277373, 27.74989489491082, -5.626149156925041, 32.292181498271255, -1.4371830300390158, 36.90362166545948, 30.659297908210362, 10.287235254555288, 14.607687902002088, 21.80004751674719, 29.317790892582842, 0.6753893168850214, 3.8065947383123575, 22.095728140857847, 0.7532008572081423, 30.608349895719442, 28.206903028072134, 31.76729595062269, 34.088315607840535, 20.58363199839863, 4.983098586395417, 37.02401587246032, -0.7947943745068642, 22.574690434433847, 23.854299323018484, 20.65271891357518, 3.095371666715682, 6.75857832338264, 5.26052756886488, 18.9856449959555, -0.32146860815367617, 2.837286670098454, -2.6387796461252, 16.06304252785851], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.782952548965886, 6.951077879005038, -27.940729631293145, -25.12593563952563, -29.131225178963188, 1.3803073542168107, -19.011066940975986, -14.818462122106586, -25.613053917324073, -19.46358441087947, -11.24317308884875, -23.10917220666775, -9.077113978824993, -26.028118072534145, -20.172735669468377, -15.150295778893458, 2.602697245658857, -32.38378000632764, -3.802107850468703, -9.957494468502817, -8.191158508867964, 4.2633245958931845, -19.06899754609941, -13.637041087137812, -42.54899186522778, -20.83716386336724, -29.059816529845083, -8.435764121359146, -0.344006709647791, -22.33320289665362, -11.487271815482892, -36.18787686215584, -24.92952416575998, -7.065804730955193, -22.878496160878893, -21.270030216273774, -40.96337474991209, -38.9698655478647, -9.79773706731357, -28.79614266392864, -23.057840328977456, -11.040279776118938, -9.07994459173775, -15.631719114651673, -9.874822978597532, -14.960883689859497, -17.851425573130406, -26.48532327399831, -40.37073144373587, 4.174844417036724, -38.03238306597801, -6.871838832442225, -18.33851107653119, 2.9784174450645917, -28.788902195638865, -22.304283020656584, -13.752264865562207, -8.235250298713465, 3.477314536098805, -9.641599291211687, -13.416308452948282, -17.00225567273604, -18.874087010301025, -9.555709638238246, -40.87979209188557, -15.67467221919365, -23.634971749277383, -27.749894894910845, 5.626149156925044, -32.29218149827124, 1.4371830300390216, -36.9036216654595, -30.659297908210362, -10.28723525455527, -14.607687902002064, -21.800047516747167, -29.317790892582828, -0.6753893168850018, -3.8065947383123637, -22.09572814085786, -0.7532008572081414, -30.60834989571948, -28.206903028072137, -31.76729595062266, -34.088315607840535, -20.583631998398683, -4.983098586395412, -37.024015872460346, 0.7947943745068615, -22.57469043443384, -23.85429932301845, -20.652718913575185, -3.0953716667156908, -6.758578323382639, -5.26052756886488, -18.985644995955507, 0.3214686081536495, -2.8372866700984627, 2.6387796461252027, -16.0630425278585], "policy_predator_policy_reward": [-1.2020005397908244, 18.767905637722574, 1.340876062674445, -15.243031820684521, 19.08765667655714, 36.79380258602916, 33.1681149747809, 17.083756304270352, 23.937727525958223, 34.324722831968174, 10.590506540712816, -13.351121249146443, 14.988989834306023, 23.03314404764597, 4.533020211927393, 25.103904032285815, 25.272861079271394, 25.95324675537674, 37.24997903098944, 1.6771897907695523, 0.6786925939993211, 21.80765358369818, 21.99149115526463, 24.22685325807088, 21.61688637364368, -3.4626584159936655, 21.574978160248534, 30.481257984819752, 27.176662256435023, 13.168809082501724, 8.204162071160964, 22.096429486625972, -12.991027183097842, 7.785632691780128, 31.74428590248675, 33.02327411016852, 4.414663204523876, 3.189552496413519, 13.340567471150791, 6.57442146585486, 22.27621301176659, -5.893895994030638, -12.079448177397326, 3.5527989856109556, 19.289382204705348, 18.84861288749346, 9.544579791391183, 17.729502382884483, 40.16018670773817, 44.937797022717426, 19.78418422084106, 21.890143505893427, 29.594153959899902, 28.52547909979025, 16.72041182847086, 0.15111641424742217, -2.1795685860096343, 2.8675820053052137, 36.494479730150466, 8.17192606315674, 17.732498081616104, 5.242045549349649, 35.550532625477445, 36.82522109883421, 19.533203733236753, 30.32584459828319, 4.666910449080071, 9.464699012830309, 26.093116082617954, 19.66387623913983, 22.38258655929902, 20.157473873248534, 32.3380305701524, 49.58871892967178, 40.1878209914799, 37.751910104249475, 22.303403165682795, -2.7079290310556754, 7.983204373216967, 49.609080954640326, 27.687049610184793, 18.428631047770107, 11.41311311557959, 10.667446436658288, 23.63087092237638, -5.4709817389008695, 21.627157978207784, 9.636280251095556, 11.415619177525612, 8.334026779669458, 6.101133368040633, 23.820634011678344, 33.09718620933973, 2.605664936921106, 35.59085049427612, 17.379796053720472, 51.47501038631397, 29.26645250115779, -11.362661026077225, 3.0129721920037618, 26.483762727069262, 49.581003404886744, -11.959979726402004, 25.70365739128642, 5.213409192387369, 31.46361296067496, -5.06639915079537, -0.8904357393338067, 36.16590581479875, 21.41189857647903, 13.7257576497375, 30.882808391575644, 17.900675642443947, 9.603854088680482, 0.11606983157211337, 16.354430765854822, -15.526005914229208, 8.5713768420316, 18.242451036254895, 1.040747546168479, 10.43888112529298, 16.393735780603585, 15.900904934785125, 18.103606410686954, 19.491128834714655, 18.25704518588736, 7.699724707980973, 11.411694568495543, 49.43735500723329, 32.32222917653781, 11.365967904845842, 19.98337653354148, 33.73802410249888, 13.531919396055883, 39.87976916586001, 15.620020623961626, -12.617015067577615, 1.3647167537275227, 32.556977340410235, 32.0273856561323, 6.88729925854385, -9.761665318621908, 32.43252946193326, 41.37471386898571, 26.912677189109253, 34.405918627311436, 8.633929398535182, 11.940541110575353, 20.83741113747345, 8.377964666530676, 32.83706087106785, 10.763034162426466, 30.894331585593243, 27.741250199572427, 6.580935880193362, -5.230157246423362, 14.362674605179615, -6.749485128554894, 26.373370380427577, 17.81808590128812, 6.058120488041938, -4.55171877362566, 32.91125044354353, 28.305449347895433, 31.6543346364231, 24.75947141972119, 36.369424967323965, 27.16516693392137, 44.52618873992111, 23.650442475760002, 27.76645009063932, 13.400813906158039, -4.742548123364675, 14.708745296155504, 36.13962723487968, 37.90840451004104, -0.20111604663641103, -1.388472702377321, 32.753810190479115, 12.395570678388571, 45.36586494639533, 2.3427336996415704, 6.640684838215324, 34.66475298893504, 11.043980396297817, -4.853237062866452, 10.549823856346414, 2.967332790418853, 17.180284155574036, -6.659229017844281, 32.387065956657395, 5.584224035253637, -8.569735895552752, 7.926798679245433, 0.08435877678762971, 5.590214563409251, -3.5140075093529806, -1.7635517828974292, 2.520223738794064, 29.605861316922987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6311896846405404, "mean_inference_ms": 1.675893311333918, "mean_action_processing_ms": 0.25841046125166406, "mean_env_wait_ms": 0.14607064651483756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00401461124420166, "StateBufferConnector_ms": 0.002886056900024414, "ViewRequirementAgentConnector_ms": 0.0843193531036377}, "num_episodes": 22, "episode_return_max": 42.54899186522784, "episode_return_min": -6.951077879005044, "episode_return_mean": 16.826151525321148, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.8865019717299, "num_env_steps_trained_throughput_per_sec": 366.8865019717299, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 10817.16, "restore_workers_time_ms": 0.021, "training_step_time_ms": 10817.041, "sample_time_ms": 1166.991, "learn_time_ms": 9631.456, "learn_throughput": 415.306, "synch_weights_time_ms": 17.137}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 98, "trial_id": "06536_00000", "date": "2024-08-11_17-31-57", "timestamp": 1723411917, "time_this_iter_s": 10.946049213409424, "time_total_s": 3458.7900874614716, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316e0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3458.7900874614716, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 47.75, "ram_util_percent": 82.54374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.083898529782891, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.324700694096585, "policy_loss": -0.007379183317243587, "vf_loss": 2.3320691591749587, "vf_explained_var": 0.9437916944424312, "kl": 0.006870658715730848, "entropy": 0.4353119611740112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.82021634667008, "cur_kl_coeff": 1.06581410364015e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.744583848229161, "policy_loss": -0.0025652230813330602, "vf_loss": 2.747149063039709, "vf_explained_var": 0.9336022594933787, "kl": 0.004122720052289501, "entropy": 0.2562020200427878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "env_runners": {"episode_reward_max": 42.54899186522784, "episode_reward_min": -5.626149156925041, "episode_reward_mean": 16.142133825287605, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.54899186522778, "predator_policy": -15.526005914229208}, "policy_reward_max": {"prey_policy": 5.626149156925044, "predator_policy": 52.99072835110295}, "policy_reward_mean": {"prey_policy": -16.14213382528761, "predator_policy": 16.142133825287605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.802107850468701, 9.957494468502821, 8.191158508867963, -4.263324595893204, 19.068997546099396, 13.637041087137831, 42.54899186522784, 20.837163863367234, 29.05981652984506, 8.435764121359133, 0.34400670964778834, 22.33320289665359, 11.48727181548289, 36.18787686215583, 24.92952416575993, 7.065804730955187, 22.878496160878882, 21.27003021627378, 40.96337474991208, 38.969865547864586, 9.797737067313557, 28.796142663928652, 23.05784032897746, 11.04027977611894, 9.07994459173777, 15.63171911465167, 9.874822978597553, 14.96088368985948, 17.851425573130424, 26.485323273998336, 40.3707314437359, -4.174844417036723, 38.032383065977996, 6.87183883244219, 18.33851107653116, -2.978417445064604, 28.788902195638887, 22.304283020656584, 13.752264865562216, 8.23525029871348, -3.4773145360988025, 9.641599291211689, 13.416308452948266, 17.002255672736037, 18.874087010301, 9.555709638238262, 40.87979209188555, 15.674672219193644, 23.634971749277373, 27.74989489491082, -5.626149156925041, 32.292181498271255, -1.4371830300390158, 36.90362166545948, 30.659297908210362, 10.287235254555288, 14.607687902002088, 21.80004751674719, 29.317790892582842, 0.6753893168850214, 3.8065947383123575, 22.095728140857847, 0.7532008572081423, 30.608349895719442, 28.206903028072134, 31.76729595062269, 34.088315607840535, 20.58363199839863, 4.983098586395417, 37.02401587246032, -0.7947943745068642, 22.574690434433847, 23.854299323018484, 20.65271891357518, 3.095371666715682, 6.75857832338264, 5.26052756886488, 18.9856449959555, -0.32146860815367617, 2.837286670098454, -2.6387796461252, 16.06304252785851, 15.600091446238771, -0.29140373561729227, 28.239151079815137, 8.672431071316659, 26.154227472534856, -2.3694164548842096, 9.31426395764762, 4.6702450765250925, 16.366321925279205, 2.1870868797557366, 7.9648619048037705, 4.512707447075204, 22.540645285281016, 13.00251172336034, 32.4417042988248, 2.1849207217295783, 10.986555642243596, 25.53864096743397], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.802107850468703, -9.957494468502817, -8.191158508867964, 4.2633245958931845, -19.06899754609941, -13.637041087137812, -42.54899186522778, -20.83716386336724, -29.059816529845083, -8.435764121359146, -0.344006709647791, -22.33320289665362, -11.487271815482892, -36.18787686215584, -24.92952416575998, -7.065804730955193, -22.878496160878893, -21.270030216273774, -40.96337474991209, -38.9698655478647, -9.79773706731357, -28.79614266392864, -23.057840328977456, -11.040279776118938, -9.07994459173775, -15.631719114651673, -9.874822978597532, -14.960883689859497, -17.851425573130406, -26.48532327399831, -40.37073144373587, 4.174844417036724, -38.03238306597801, -6.871838832442225, -18.33851107653119, 2.9784174450645917, -28.788902195638865, -22.304283020656584, -13.752264865562207, -8.235250298713465, 3.477314536098805, -9.641599291211687, -13.416308452948282, -17.00225567273604, -18.874087010301025, -9.555709638238246, -40.87979209188557, -15.67467221919365, -23.634971749277383, -27.749894894910845, 5.626149156925044, -32.29218149827124, 1.4371830300390216, -36.9036216654595, -30.659297908210362, -10.28723525455527, -14.607687902002064, -21.800047516747167, -29.317790892582828, -0.6753893168850018, -3.8065947383123637, -22.09572814085786, -0.7532008572081414, -30.60834989571948, -28.206903028072137, -31.76729595062266, -34.088315607840535, -20.583631998398683, -4.983098586395412, -37.024015872460346, 0.7947943745068615, -22.57469043443384, -23.85429932301845, -20.652718913575185, -3.0953716667156908, -6.758578323382639, -5.26052756886488, -18.985644995955507, 0.3214686081536495, -2.8372866700984627, 2.6387796461252027, -16.0630425278585, -15.600091446238793, 0.29140373561728694, -28.239151079815116, -8.672431071316643, -26.15422747253484, 2.36941645488424, -9.314263957647622, -4.670245076525119, -16.366321925279152, -2.187086879755737, -7.964861904803773, -4.512707447075201, -22.540645285281055, -13.002511723360332, -32.441704298824796, -2.1849207217295783, -10.986555642243623, -25.538640967433963], "policy_predator_policy_reward": [4.414663204523876, 3.189552496413519, 13.340567471150791, 6.57442146585486, 22.27621301176659, -5.893895994030638, -12.079448177397326, 3.5527989856109556, 19.289382204705348, 18.84861288749346, 9.544579791391183, 17.729502382884483, 40.16018670773817, 44.937797022717426, 19.78418422084106, 21.890143505893427, 29.594153959899902, 28.52547909979025, 16.72041182847086, 0.15111641424742217, -2.1795685860096343, 2.8675820053052137, 36.494479730150466, 8.17192606315674, 17.732498081616104, 5.242045549349649, 35.550532625477445, 36.82522109883421, 19.533203733236753, 30.32584459828319, 4.666910449080071, 9.464699012830309, 26.093116082617954, 19.66387623913983, 22.38258655929902, 20.157473873248534, 32.3380305701524, 49.58871892967178, 40.1878209914799, 37.751910104249475, 22.303403165682795, -2.7079290310556754, 7.983204373216967, 49.609080954640326, 27.687049610184793, 18.428631047770107, 11.41311311557959, 10.667446436658288, 23.63087092237638, -5.4709817389008695, 21.627157978207784, 9.636280251095556, 11.415619177525612, 8.334026779669458, 6.101133368040633, 23.820634011678344, 33.09718620933973, 2.605664936921106, 35.59085049427612, 17.379796053720472, 51.47501038631397, 29.26645250115779, -11.362661026077225, 3.0129721920037618, 26.483762727069262, 49.581003404886744, -11.959979726402004, 25.70365739128642, 5.213409192387369, 31.46361296067496, -5.06639915079537, -0.8904357393338067, 36.16590581479875, 21.41189857647903, 13.7257576497375, 30.882808391575644, 17.900675642443947, 9.603854088680482, 0.11606983157211337, 16.354430765854822, -15.526005914229208, 8.5713768420316, 18.242451036254895, 1.040747546168479, 10.43888112529298, 16.393735780603585, 15.900904934785125, 18.103606410686954, 19.491128834714655, 18.25704518588736, 7.699724707980973, 11.411694568495543, 49.43735500723329, 32.32222917653781, 11.365967904845842, 19.98337653354148, 33.73802410249888, 13.531919396055883, 39.87976916586001, 15.620020623961626, -12.617015067577615, 1.3647167537275227, 32.556977340410235, 32.0273856561323, 6.88729925854385, -9.761665318621908, 32.43252946193326, 41.37471386898571, 26.912677189109253, 34.405918627311436, 8.633929398535182, 11.940541110575353, 20.83741113747345, 8.377964666530676, 32.83706087106785, 10.763034162426466, 30.894331585593243, 27.741250199572427, 6.580935880193362, -5.230157246423362, 14.362674605179615, -6.749485128554894, 26.373370380427577, 17.81808590128812, 6.058120488041938, -4.55171877362566, 32.91125044354353, 28.305449347895433, 31.6543346364231, 24.75947141972119, 36.369424967323965, 27.16516693392137, 44.52618873992111, 23.650442475760002, 27.76645009063932, 13.400813906158039, -4.742548123364675, 14.708745296155504, 36.13962723487968, 37.90840451004104, -0.20111604663641103, -1.388472702377321, 32.753810190479115, 12.395570678388571, 45.36586494639533, 2.3427336996415704, 6.640684838215324, 34.66475298893504, 11.043980396297817, -4.853237062866452, 10.549823856346414, 2.967332790418853, 17.180284155574036, -6.659229017844281, 32.387065956657395, 5.584224035253637, -8.569735895552752, 7.926798679245433, 0.08435877678762971, 5.590214563409251, -3.5140075093529806, -1.7635517828974292, 2.520223738794064, 29.605861316922987, 14.553453804082485, 16.646729088395038, -2.635310677147304, 2.0525032059127426, 46.431853049363546, 10.046449110266657, 10.15618044934894, 7.18868169328438, 52.99072835110295, -0.6822734060333309, -8.877575775374813, 4.138742865606366, 11.154807732719368, 7.473720182575873, 7.419804243075674, 1.9206859099745497, -4.649209635925015, 37.381853486483394, 5.9665589225419025, -1.5923851630304213, 7.728481684889479, 8.20124212471807, -3.99370502508342, 13.01911991923382, 16.195873656304844, 28.885416914257235, 3.0306748476014462, 22.97434859911923, 29.987124289487415, 34.89628430816221, 5.578633756184501, -1.2087923127253486, 9.974768467859214, 11.998342816628043, 34.32627270840985, 16.75100922645812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6302095553145853, "mean_inference_ms": 1.6752773202500806, "mean_action_processing_ms": 0.2582092831938436, "mean_env_wait_ms": 0.14592506546409273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037316083908081055, "StateBufferConnector_ms": 0.0029685497283935547, "ViewRequirementAgentConnector_ms": 0.08828139305114746}, "num_episodes": 18, "episode_return_max": 42.54899186522784, "episode_return_min": -5.626149156925041, "episode_return_mean": 16.142133825287605, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.2645781271266, "num_env_steps_trained_throughput_per_sec": 408.2645781271266, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 10761.361, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10761.235, "sample_time_ms": 1178.98, "learn_time_ms": 9562.116, "learn_throughput": 418.317, "synch_weights_time_ms": 18.479}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "training_iteration": 99, "trial_id": "06536_00000", "date": "2024-08-11_17-32-06", "timestamp": 1723411926, "time_this_iter_s": 9.860737800598145, "time_total_s": 3468.6508252620697, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316e0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3468.6508252620697, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 42.34285714285715, "ram_util_percent": 82.40714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.878994827841719, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.244410651177168, "policy_loss": -0.0071378842083504425, "vf_loss": 2.251538508137067, "vf_explained_var": 0.9471132638553779, "kl": 0.006416137942780025, "entropy": 0.4485796532593668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9096289999901304, "cur_kl_coeff": 5.32907051820075e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.592780938665703, "policy_loss": -0.0012779951806392068, "vf_loss": 2.594058928729365, "vf_explained_var": 0.9424422753551019, "kl": 0.002609492346426154, "entropy": 0.24864483599467252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 40.87979209188555, "episode_reward_min": -5.626149156925041, "episode_reward_mean": 15.259168827339755, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.87979209188557, "predator_policy": -18.632360273653173}, "policy_reward_max": {"prey_policy": 5.626149156925044, "predator_policy": 52.99072835110295}, "policy_reward_mean": {"prey_policy": -15.259168827339757, "predator_policy": 15.259168827339755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.04027977611894, 9.07994459173777, 15.63171911465167, 9.874822978597553, 14.96088368985948, 17.851425573130424, 26.485323273998336, 40.3707314437359, -4.174844417036723, 38.032383065977996, 6.87183883244219, 18.33851107653116, -2.978417445064604, 28.788902195638887, 22.304283020656584, 13.752264865562216, 8.23525029871348, -3.4773145360988025, 9.641599291211689, 13.416308452948266, 17.002255672736037, 18.874087010301, 9.555709638238262, 40.87979209188555, 15.674672219193644, 23.634971749277373, 27.74989489491082, -5.626149156925041, 32.292181498271255, -1.4371830300390158, 36.90362166545948, 30.659297908210362, 10.287235254555288, 14.607687902002088, 21.80004751674719, 29.317790892582842, 0.6753893168850214, 3.8065947383123575, 22.095728140857847, 0.7532008572081423, 30.608349895719442, 28.206903028072134, 31.76729595062269, 34.088315607840535, 20.58363199839863, 4.983098586395417, 37.02401587246032, -0.7947943745068642, 22.574690434433847, 23.854299323018484, 20.65271891357518, 3.095371666715682, 6.75857832338264, 5.26052756886488, 18.9856449959555, -0.32146860815367617, 2.837286670098454, -2.6387796461252, 16.06304252785851, 15.600091446238771, -0.29140373561729227, 28.239151079815137, 8.672431071316659, 26.154227472534856, -2.3694164548842096, 9.31426395764762, 4.6702450765250925, 16.366321925279205, 2.1870868797557366, 7.9648619048037705, 4.512707447075204, 22.540645285281016, 13.00251172336034, 32.4417042988248, 2.1849207217295783, 10.986555642243596, 25.53864096743397, 17.35839179217576, 20.335930854053252, 24.887868903021925, 6.696745783477354, 13.648819238347428, -1.5751011033161753, 26.173152120955, 22.518741549917753, 20.717303339805873, 8.333573398502047, 8.589979304410765, -4.838685024810394, 27.60396603725792, 10.577419857282761, 34.669381262267464, -3.247574576021603, 18.496869446427628, 17.551625602844695, 20.318446924731838, 36.13558459322251, -2.93750105366309, -2.6376275134214957, 31.68257462853264], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.040279776118938, -9.07994459173775, -15.631719114651673, -9.874822978597532, -14.960883689859497, -17.851425573130406, -26.48532327399831, -40.37073144373587, 4.174844417036724, -38.03238306597801, -6.871838832442225, -18.33851107653119, 2.9784174450645917, -28.788902195638865, -22.304283020656584, -13.752264865562207, -8.235250298713465, 3.477314536098805, -9.641599291211687, -13.416308452948282, -17.00225567273604, -18.874087010301025, -9.555709638238246, -40.87979209188557, -15.67467221919365, -23.634971749277383, -27.749894894910845, 5.626149156925044, -32.29218149827124, 1.4371830300390216, -36.9036216654595, -30.659297908210362, -10.28723525455527, -14.607687902002064, -21.800047516747167, -29.317790892582828, -0.6753893168850018, -3.8065947383123637, -22.09572814085786, -0.7532008572081414, -30.60834989571948, -28.206903028072137, -31.76729595062266, -34.088315607840535, -20.583631998398683, -4.983098586395412, -37.024015872460346, 0.7947943745068615, -22.57469043443384, -23.85429932301845, -20.652718913575185, -3.0953716667156908, -6.758578323382639, -5.26052756886488, -18.985644995955507, 0.3214686081536495, -2.8372866700984627, 2.6387796461252027, -16.0630425278585, -15.600091446238793, 0.29140373561728694, -28.239151079815116, -8.672431071316643, -26.15422747253484, 2.36941645488424, -9.314263957647622, -4.670245076525119, -16.366321925279152, -2.187086879755737, -7.964861904803773, -4.512707447075201, -22.540645285281055, -13.002511723360332, -32.441704298824796, -2.1849207217295783, -10.986555642243623, -25.538640967433963, -17.358391792175798, -20.335930854053284, -24.887868903021904, -6.6967457834773585, -13.648819238347434, 1.575101103316177, -26.173152120955017, -22.518741549917735, -20.71730333980584, -8.333573398502017, -8.589979304410774, 4.838685024810388, -27.603966037257937, -10.57741985728276, -34.669381262267486, 3.2475745760216013, -18.49686944642763, -17.551625602844712, -20.31844692473183, -36.135584593222546, 2.9375010536630937, 2.637627513421501, -31.682574628532656], "policy_predator_policy_reward": [11.41311311557959, 10.667446436658288, 23.63087092237638, -5.4709817389008695, 21.627157978207784, 9.636280251095556, 11.415619177525612, 8.334026779669458, 6.101133368040633, 23.820634011678344, 33.09718620933973, 2.605664936921106, 35.59085049427612, 17.379796053720472, 51.47501038631397, 29.26645250115779, -11.362661026077225, 3.0129721920037618, 26.483762727069262, 49.581003404886744, -11.959979726402004, 25.70365739128642, 5.213409192387369, 31.46361296067496, -5.06639915079537, -0.8904357393338067, 36.16590581479875, 21.41189857647903, 13.7257576497375, 30.882808391575644, 17.900675642443947, 9.603854088680482, 0.11606983157211337, 16.354430765854822, -15.526005914229208, 8.5713768420316, 18.242451036254895, 1.040747546168479, 10.43888112529298, 16.393735780603585, 15.900904934785125, 18.103606410686954, 19.491128834714655, 18.25704518588736, 7.699724707980973, 11.411694568495543, 49.43735500723329, 32.32222917653781, 11.365967904845842, 19.98337653354148, 33.73802410249888, 13.531919396055883, 39.87976916586001, 15.620020623961626, -12.617015067577615, 1.3647167537275227, 32.556977340410235, 32.0273856561323, 6.88729925854385, -9.761665318621908, 32.43252946193326, 41.37471386898571, 26.912677189109253, 34.405918627311436, 8.633929398535182, 11.940541110575353, 20.83741113747345, 8.377964666530676, 32.83706087106785, 10.763034162426466, 30.894331585593243, 27.741250199572427, 6.580935880193362, -5.230157246423362, 14.362674605179615, -6.749485128554894, 26.373370380427577, 17.81808590128812, 6.058120488041938, -4.55171877362566, 32.91125044354353, 28.305449347895433, 31.6543346364231, 24.75947141972119, 36.369424967323965, 27.16516693392137, 44.52618873992111, 23.650442475760002, 27.76645009063932, 13.400813906158039, -4.742548123364675, 14.708745296155504, 36.13962723487968, 37.90840451004104, -0.20111604663641103, -1.388472702377321, 32.753810190479115, 12.395570678388571, 45.36586494639533, 2.3427336996415704, 6.640684838215324, 34.66475298893504, 11.043980396297817, -4.853237062866452, 10.549823856346414, 2.967332790418853, 17.180284155574036, -6.659229017844281, 32.387065956657395, 5.584224035253637, -8.569735895552752, 7.926798679245433, 0.08435877678762971, 5.590214563409251, -3.5140075093529806, -1.7635517828974292, 2.520223738794064, 29.605861316922987, 14.553453804082485, 16.646729088395038, -2.635310677147304, 2.0525032059127426, 46.431853049363546, 10.046449110266657, 10.15618044934894, 7.18868169328438, 52.99072835110295, -0.6822734060333309, -8.877575775374813, 4.138742865606366, 11.154807732719368, 7.473720182575873, 7.419804243075674, 1.9206859099745497, -4.649209635925015, 37.381853486483394, 5.9665589225419025, -1.5923851630304213, 7.728481684889479, 8.20124212471807, -3.99370502508342, 13.01911991923382, 16.195873656304844, 28.885416914257235, 3.0306748476014462, 22.97434859911923, 29.987124289487415, 34.89628430816221, 5.578633756184501, -1.2087923127253486, 9.974768467859214, 11.998342816628043, 34.32627270840985, 16.75100922645812, 17.540502835396612, 17.176280748955016, 8.211546232867448, 32.460315475239035, 32.56416662510913, 17.211571180934676, 5.325916007048001, 8.067575559906722, 31.47526055959474, -4.177622082899841, 0.5062792281187036, -3.656481434751056, 25.736388962651727, 26.60991527925828, 30.29207596622589, 14.745407133609588, 33.213200170156284, 8.221406509455424, 15.066021106049597, 1.6011256909544755, 1.76876502851231, 15.411193580309247, 3.0489701411255545, -12.726340190746335, 16.74862260506535, 38.459309469450524, 15.316679866871304, 5.838159847694211, 40.843360533700526, 28.495401990834434, -2.5542638837530305, -3.940885268290165, 27.9133303770178, 9.080408515837476, 28.23212038282258, 6.871130822866792, 33.66125045241144, 6.975643397052256, 42.116698485936226, 30.154470700508824, 2.8860920269627925, -8.761094134288973, 13.357105246810193, -18.632360273653173, 32.44565627199667, 30.919492985068647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6296668498742055, "mean_inference_ms": 1.6754598563646357, "mean_action_processing_ms": 0.25831644699293077, "mean_env_wait_ms": 0.14598013156910136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004209756851196289, "StateBufferConnector_ms": 0.0031996965408325195, "ViewRequirementAgentConnector_ms": 0.09480094909667969}, "num_episodes": 23, "episode_return_max": 40.87979209188555, "episode_return_min": -5.626149156925041, "episode_return_mean": 15.259168827339755, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.2614577240284, "num_env_steps_trained_throughput_per_sec": 351.2614577240284, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 10836.91, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10836.72, "sample_time_ms": 1207.456, "learn_time_ms": 9607.559, "learn_throughput": 416.339, "synch_weights_time_ms": 19.88}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 100, "trial_id": "06536_00000", "date": "2024-08-11_17-32-18", "timestamp": 1723411938, "time_this_iter_s": 11.431760787963867, "time_total_s": 3480.0825860500336, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3310ed430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3480.0825860500336, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 52.518750000000004, "ram_util_percent": 82.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8209780772527058, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1459220251689355, "policy_loss": -0.005558744492009282, "vf_loss": 2.1514728628098965, "vf_explained_var": 0.9464233793318272, "kl": 0.005065984759060508, "entropy": 0.4528895823905865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9352219554482315, "cur_kl_coeff": 2.664535259100375e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5180041608356296, "policy_loss": -0.0029170726648921137, "vf_loss": 2.5209212238195713, "vf_explained_var": 0.9464048144678591, "kl": 0.004255312027639688, "entropy": 0.2261243936561403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "env_runners": {"episode_reward_max": 44.268945104660546, "episode_reward_min": -5.626149156925041, "episode_reward_mean": 15.46845167595145, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.26894510466046, "predator_policy": -18.632360273653173}, "policy_reward_max": {"prey_policy": 5.626149156925044, "predator_policy": 52.99072835110295}, "policy_reward_mean": {"prey_policy": -15.468451675951451, "predator_policy": 15.46845167595145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.641599291211689, 13.416308452948266, 17.002255672736037, 18.874087010301, 9.555709638238262, 40.87979209188555, 15.674672219193644, 23.634971749277373, 27.74989489491082, -5.626149156925041, 32.292181498271255, -1.4371830300390158, 36.90362166545948, 30.659297908210362, 10.287235254555288, 14.607687902002088, 21.80004751674719, 29.317790892582842, 0.6753893168850214, 3.8065947383123575, 22.095728140857847, 0.7532008572081423, 30.608349895719442, 28.206903028072134, 31.76729595062269, 34.088315607840535, 20.58363199839863, 4.983098586395417, 37.02401587246032, -0.7947943745068642, 22.574690434433847, 23.854299323018484, 20.65271891357518, 3.095371666715682, 6.75857832338264, 5.26052756886488, 18.9856449959555, -0.32146860815367617, 2.837286670098454, -2.6387796461252, 16.06304252785851, 15.600091446238771, -0.29140373561729227, 28.239151079815137, 8.672431071316659, 26.154227472534856, -2.3694164548842096, 9.31426395764762, 4.6702450765250925, 16.366321925279205, 2.1870868797557366, 7.9648619048037705, 4.512707447075204, 22.540645285281016, 13.00251172336034, 32.4417042988248, 2.1849207217295783, 10.986555642243596, 25.53864096743397, 17.35839179217576, 20.335930854053252, 24.887868903021925, 6.696745783477354, 13.648819238347428, -1.5751011033161753, 26.173152120955, 22.518741549917753, 20.717303339805873, 8.333573398502047, 8.589979304410765, -4.838685024810394, 27.60396603725792, 10.577419857282761, 34.669381262267464, -3.247574576021603, 18.496869446427628, 17.551625602844695, 20.318446924731838, 36.13558459322251, -2.93750105366309, -2.6376275134214957, 31.68257462853264, 8.661624103085883, 44.268945104660546, 16.534539035321938, 19.784374630548538, 20.168994281511083, 17.891820573006044, 6.3926058022667736, -0.49635261802330266, 21.813468086110927, 14.218254059868082, 7.355305103999277, 17.2294128641974, 25.033451100304266, 12.225636368384208, 27.119146591743082, 18.33490191036181, 2.5927330977641345, 12.787412165211466], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.641599291211687, -13.416308452948282, -17.00225567273604, -18.874087010301025, -9.555709638238246, -40.87979209188557, -15.67467221919365, -23.634971749277383, -27.749894894910845, 5.626149156925044, -32.29218149827124, 1.4371830300390216, -36.9036216654595, -30.659297908210362, -10.28723525455527, -14.607687902002064, -21.800047516747167, -29.317790892582828, -0.6753893168850018, -3.8065947383123637, -22.09572814085786, -0.7532008572081414, -30.60834989571948, -28.206903028072137, -31.76729595062266, -34.088315607840535, -20.583631998398683, -4.983098586395412, -37.024015872460346, 0.7947943745068615, -22.57469043443384, -23.85429932301845, -20.652718913575185, -3.0953716667156908, -6.758578323382639, -5.26052756886488, -18.985644995955507, 0.3214686081536495, -2.8372866700984627, 2.6387796461252027, -16.0630425278585, -15.600091446238793, 0.29140373561728694, -28.239151079815116, -8.672431071316643, -26.15422747253484, 2.36941645488424, -9.314263957647622, -4.670245076525119, -16.366321925279152, -2.187086879755737, -7.964861904803773, -4.512707447075201, -22.540645285281055, -13.002511723360332, -32.441704298824796, -2.1849207217295783, -10.986555642243623, -25.538640967433963, -17.358391792175798, -20.335930854053284, -24.887868903021904, -6.6967457834773585, -13.648819238347434, 1.575101103316177, -26.173152120955017, -22.518741549917735, -20.71730333980584, -8.333573398502017, -8.589979304410774, 4.838685024810388, -27.603966037257937, -10.57741985728276, -34.669381262267486, 3.2475745760216013, -18.49686944642763, -17.551625602844712, -20.31844692473183, -36.135584593222546, 2.9375010536630937, 2.637627513421501, -31.682574628532656, -8.661624103085874, -44.26894510466046, -16.534539035321952, -19.78437463054854, -20.168994281511075, -17.891820573006058, -6.392605802266775, 0.49635261802330133, -21.813468086110923, -14.218254059868094, -7.3553051039992745, -17.229412864197396, -25.03345110030415, -12.225636368384214, -27.119146591743082, -18.33490191036179, -2.5927330977641248, -12.787412165211475], "policy_predator_policy_reward": [18.242451036254895, 1.040747546168479, 10.43888112529298, 16.393735780603585, 15.900904934785125, 18.103606410686954, 19.491128834714655, 18.25704518588736, 7.699724707980973, 11.411694568495543, 49.43735500723329, 32.32222917653781, 11.365967904845842, 19.98337653354148, 33.73802410249888, 13.531919396055883, 39.87976916586001, 15.620020623961626, -12.617015067577615, 1.3647167537275227, 32.556977340410235, 32.0273856561323, 6.88729925854385, -9.761665318621908, 32.43252946193326, 41.37471386898571, 26.912677189109253, 34.405918627311436, 8.633929398535182, 11.940541110575353, 20.83741113747345, 8.377964666530676, 32.83706087106785, 10.763034162426466, 30.894331585593243, 27.741250199572427, 6.580935880193362, -5.230157246423362, 14.362674605179615, -6.749485128554894, 26.373370380427577, 17.81808590128812, 6.058120488041938, -4.55171877362566, 32.91125044354353, 28.305449347895433, 31.6543346364231, 24.75947141972119, 36.369424967323965, 27.16516693392137, 44.52618873992111, 23.650442475760002, 27.76645009063932, 13.400813906158039, -4.742548123364675, 14.708745296155504, 36.13962723487968, 37.90840451004104, -0.20111604663641103, -1.388472702377321, 32.753810190479115, 12.395570678388571, 45.36586494639533, 2.3427336996415704, 6.640684838215324, 34.66475298893504, 11.043980396297817, -4.853237062866452, 10.549823856346414, 2.967332790418853, 17.180284155574036, -6.659229017844281, 32.387065956657395, 5.584224035253637, -8.569735895552752, 7.926798679245433, 0.08435877678762971, 5.590214563409251, -3.5140075093529806, -1.7635517828974292, 2.520223738794064, 29.605861316922987, 14.553453804082485, 16.646729088395038, -2.635310677147304, 2.0525032059127426, 46.431853049363546, 10.046449110266657, 10.15618044934894, 7.18868169328438, 52.99072835110295, -0.6822734060333309, -8.877575775374813, 4.138742865606366, 11.154807732719368, 7.473720182575873, 7.419804243075674, 1.9206859099745497, -4.649209635925015, 37.381853486483394, 5.9665589225419025, -1.5923851630304213, 7.728481684889479, 8.20124212471807, -3.99370502508342, 13.01911991923382, 16.195873656304844, 28.885416914257235, 3.0306748476014462, 22.97434859911923, 29.987124289487415, 34.89628430816221, 5.578633756184501, -1.2087923127253486, 9.974768467859214, 11.998342816628043, 34.32627270840985, 16.75100922645812, 17.540502835396612, 17.176280748955016, 8.211546232867448, 32.460315475239035, 32.56416662510913, 17.211571180934676, 5.325916007048001, 8.067575559906722, 31.47526055959474, -4.177622082899841, 0.5062792281187036, -3.656481434751056, 25.736388962651727, 26.60991527925828, 30.29207596622589, 14.745407133609588, 33.213200170156284, 8.221406509455424, 15.066021106049597, 1.6011256909544755, 1.76876502851231, 15.411193580309247, 3.0489701411255545, -12.726340190746335, 16.74862260506535, 38.459309469450524, 15.316679866871304, 5.838159847694211, 40.843360533700526, 28.495401990834434, -2.5542638837530305, -3.940885268290165, 27.9133303770178, 9.080408515837476, 28.23212038282258, 6.871130822866792, 33.66125045241144, 6.975643397052256, 42.116698485936226, 30.154470700508824, 2.8860920269627925, -8.761094134288973, 13.357105246810193, -18.632360273653173, 32.44565627199667, 30.919492985068647, 16.44158575526166, 0.8816624509101665, 40.75549078680825, 47.78239942251268, 14.500826087866319, 18.56825198277759, 12.686368978199667, 26.882380282897387, 11.39997454895005, 28.938014014072095, 2.3673556249865606, 33.41628552102555, 2.096066258755444, 10.689145345778083, -3.3259995494571335, 2.3332943134105326, 10.826369938081427, 32.800566234140426, 18.95169660214902, 9.484811517587154, 17.087824659382704, -2.377214451384157, 26.363952436217414, 8.094873292177382, 19.847698852959624, 30.219203347648776, 24.031349948854174, 0.41992278791426685, 33.969743512974475, 20.26854967051169, 0.6032087017830827, 36.06659511894051, 17.40527366589306, -12.219807470364831, 4.908610760396591, 20.666213570026358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6299503692526343, "mean_inference_ms": 1.6744347546245058, "mean_action_processing_ms": 0.2582545032686731, "mean_env_wait_ms": 0.1458094026069923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263639450073242, "StateBufferConnector_ms": 0.00323641300201416, "ViewRequirementAgentConnector_ms": 0.10448896884918213}, "num_episodes": 18, "episode_return_max": 44.268945104660546, "episode_return_min": -5.626149156925041, "episode_return_mean": 15.46845167595145, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.0724100580563, "num_env_steps_trained_throughput_per_sec": 368.0724100580563, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 10810.627, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10810.433, "sample_time_ms": 1216.493, "learn_time_ms": 9572.332, "learn_throughput": 417.871, "synch_weights_time_ms": 19.881}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "training_iteration": 101, "trial_id": "06536_00000", "date": "2024-08-11_17-32-29", "timestamp": 1723411949, "time_this_iter_s": 10.904310941696167, "time_total_s": 3490.9868969917297, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3490.9868969917297, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 47.25, "ram_util_percent": 82.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9562209571401277, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.041051180412372, "policy_loss": -0.0026835169546150913, "vf_loss": 2.043726942812403, "vf_explained_var": 0.9478526757409175, "kl": 0.004965497126733531, "entropy": 0.4446680220154425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.013736131203868, "cur_kl_coeff": 1.3322676295501876e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4919756164626468, "policy_loss": -0.0026797971027908186, "vf_loss": 2.494655410637931, "vf_explained_var": 0.9447729958112908, "kl": 0.003017607152723964, "entropy": 0.23932114282928446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 44.268945104660546, "episode_reward_min": -4.838685024810394, "episode_reward_mean": 14.171101175108568, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.26894510466046, "predator_policy": -18.632360273653173}, "policy_reward_max": {"prey_policy": 4.838685024810388, "predator_policy": 52.99072835110295}, "policy_reward_mean": {"prey_policy": -14.171101175108568, "predator_policy": 14.17110117510857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6753893168850214, 3.8065947383123575, 22.095728140857847, 0.7532008572081423, 30.608349895719442, 28.206903028072134, 31.76729595062269, 34.088315607840535, 20.58363199839863, 4.983098586395417, 37.02401587246032, -0.7947943745068642, 22.574690434433847, 23.854299323018484, 20.65271891357518, 3.095371666715682, 6.75857832338264, 5.26052756886488, 18.9856449959555, -0.32146860815367617, 2.837286670098454, -2.6387796461252, 16.06304252785851, 15.600091446238771, -0.29140373561729227, 28.239151079815137, 8.672431071316659, 26.154227472534856, -2.3694164548842096, 9.31426395764762, 4.6702450765250925, 16.366321925279205, 2.1870868797557366, 7.9648619048037705, 4.512707447075204, 22.540645285281016, 13.00251172336034, 32.4417042988248, 2.1849207217295783, 10.986555642243596, 25.53864096743397, 17.35839179217576, 20.335930854053252, 24.887868903021925, 6.696745783477354, 13.648819238347428, -1.5751011033161753, 26.173152120955, 22.518741549917753, 20.717303339805873, 8.333573398502047, 8.589979304410765, -4.838685024810394, 27.60396603725792, 10.577419857282761, 34.669381262267464, -3.247574576021603, 18.496869446427628, 17.551625602844695, 20.318446924731838, 36.13558459322251, -2.93750105366309, -2.6376275134214957, 31.68257462853264, 8.661624103085883, 44.268945104660546, 16.534539035321938, 19.784374630548538, 20.168994281511083, 17.891820573006044, 6.3926058022667736, -0.49635261802330266, 21.813468086110927, 14.218254059868082, 7.355305103999277, 17.2294128641974, 25.033451100304266, 12.225636368384208, 27.119146591743082, 18.33490191036181, 2.5927330977641345, 12.787412165211466, 18.59048584300175, 16.15352056440949, 24.613873868779407, 9.073735328060833, -1.8190370937254121, 10.653760373182093, 25.8221527874744, 2.247605507822704, 20.187438668891343, 17.34840110323698, 14.806450824459272, 25.094100610914857, 0.1308931601340495, 20.09616345014019, -1.7532992472278246, 1.9968383653703463, 13.001382051349676, -0.7456947789950688], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.6753893168850018, -3.8065947383123637, -22.09572814085786, -0.7532008572081414, -30.60834989571948, -28.206903028072137, -31.76729595062266, -34.088315607840535, -20.583631998398683, -4.983098586395412, -37.024015872460346, 0.7947943745068615, -22.57469043443384, -23.85429932301845, -20.652718913575185, -3.0953716667156908, -6.758578323382639, -5.26052756886488, -18.985644995955507, 0.3214686081536495, -2.8372866700984627, 2.6387796461252027, -16.0630425278585, -15.600091446238793, 0.29140373561728694, -28.239151079815116, -8.672431071316643, -26.15422747253484, 2.36941645488424, -9.314263957647622, -4.670245076525119, -16.366321925279152, -2.187086879755737, -7.964861904803773, -4.512707447075201, -22.540645285281055, -13.002511723360332, -32.441704298824796, -2.1849207217295783, -10.986555642243623, -25.538640967433963, -17.358391792175798, -20.335930854053284, -24.887868903021904, -6.6967457834773585, -13.648819238347434, 1.575101103316177, -26.173152120955017, -22.518741549917735, -20.71730333980584, -8.333573398502017, -8.589979304410774, 4.838685024810388, -27.603966037257937, -10.57741985728276, -34.669381262267486, 3.2475745760216013, -18.49686944642763, -17.551625602844712, -20.31844692473183, -36.135584593222546, 2.9375010536630937, 2.637627513421501, -31.682574628532656, -8.661624103085874, -44.26894510466046, -16.534539035321952, -19.78437463054854, -20.168994281511075, -17.891820573006058, -6.392605802266775, 0.49635261802330133, -21.813468086110923, -14.218254059868094, -7.3553051039992745, -17.229412864197396, -25.03345110030415, -12.225636368384214, -27.119146591743082, -18.33490191036179, -2.5927330977641248, -12.787412165211475, -18.590485843001748, -16.153520564409497, -24.613873868779425, -9.073735328060831, 1.8190370937254041, -10.653760373182077, -25.822152787474398, -2.2476055078227164, -20.187438668891343, -17.34840110323696, -14.80645082445929, -25.094100610914882, -0.13089316013404684, -20.09616345014018, 1.7532992472278268, -1.9968383653703436, -13.001382051349685, 0.7456947789950834], "policy_predator_policy_reward": [6.580935880193362, -5.230157246423362, 14.362674605179615, -6.749485128554894, 26.373370380427577, 17.81808590128812, 6.058120488041938, -4.55171877362566, 32.91125044354353, 28.305449347895433, 31.6543346364231, 24.75947141972119, 36.369424967323965, 27.16516693392137, 44.52618873992111, 23.650442475760002, 27.76645009063932, 13.400813906158039, -4.742548123364675, 14.708745296155504, 36.13962723487968, 37.90840451004104, -0.20111604663641103, -1.388472702377321, 32.753810190479115, 12.395570678388571, 45.36586494639533, 2.3427336996415704, 6.640684838215324, 34.66475298893504, 11.043980396297817, -4.853237062866452, 10.549823856346414, 2.967332790418853, 17.180284155574036, -6.659229017844281, 32.387065956657395, 5.584224035253637, -8.569735895552752, 7.926798679245433, 0.08435877678762971, 5.590214563409251, -3.5140075093529806, -1.7635517828974292, 2.520223738794064, 29.605861316922987, 14.553453804082485, 16.646729088395038, -2.635310677147304, 2.0525032059127426, 46.431853049363546, 10.046449110266657, 10.15618044934894, 7.18868169328438, 52.99072835110295, -0.6822734060333309, -8.877575775374813, 4.138742865606366, 11.154807732719368, 7.473720182575873, 7.419804243075674, 1.9206859099745497, -4.649209635925015, 37.381853486483394, 5.9665589225419025, -1.5923851630304213, 7.728481684889479, 8.20124212471807, -3.99370502508342, 13.01911991923382, 16.195873656304844, 28.885416914257235, 3.0306748476014462, 22.97434859911923, 29.987124289487415, 34.89628430816221, 5.578633756184501, -1.2087923127253486, 9.974768467859214, 11.998342816628043, 34.32627270840985, 16.75100922645812, 17.540502835396612, 17.176280748955016, 8.211546232867448, 32.460315475239035, 32.56416662510913, 17.211571180934676, 5.325916007048001, 8.067575559906722, 31.47526055959474, -4.177622082899841, 0.5062792281187036, -3.656481434751056, 25.736388962651727, 26.60991527925828, 30.29207596622589, 14.745407133609588, 33.213200170156284, 8.221406509455424, 15.066021106049597, 1.6011256909544755, 1.76876502851231, 15.411193580309247, 3.0489701411255545, -12.726340190746335, 16.74862260506535, 38.459309469450524, 15.316679866871304, 5.838159847694211, 40.843360533700526, 28.495401990834434, -2.5542638837530305, -3.940885268290165, 27.9133303770178, 9.080408515837476, 28.23212038282258, 6.871130822866792, 33.66125045241144, 6.975643397052256, 42.116698485936226, 30.154470700508824, 2.8860920269627925, -8.761094134288973, 13.357105246810193, -18.632360273653173, 32.44565627199667, 30.919492985068647, 16.44158575526166, 0.8816624509101665, 40.75549078680825, 47.78239942251268, 14.500826087866319, 18.56825198277759, 12.686368978199667, 26.882380282897387, 11.39997454895005, 28.938014014072095, 2.3673556249865606, 33.41628552102555, 2.096066258755444, 10.689145345778083, -3.3259995494571335, 2.3332943134105326, 10.826369938081427, 32.800566234140426, 18.95169660214902, 9.484811517587154, 17.087824659382704, -2.377214451384157, 26.363952436217414, 8.094873292177382, 19.847698852959624, 30.219203347648776, 24.031349948854174, 0.41992278791426685, 33.969743512974475, 20.26854967051169, 0.6032087017830827, 36.06659511894051, 17.40527366589306, -12.219807470364831, 4.908610760396591, 20.666213570026358, 12.648986336073884, 24.531985349929602, 10.269933324373325, 22.037107804445668, 18.037198658878296, 31.190549078680558, 19.738710160132243, -1.5912395040105576, 3.083901162359064, -6.7219753498098775, 6.859870666305129, 14.447650080059024, 34.05017318969965, 17.59413238524919, 4.121684675244431, 0.3735263404009963, 21.12794019732288, 19.246937140459757, 14.581810655225723, 20.114991551248202, 20.548582186894997, 9.064319462023581, 16.664510984018083, 33.52369023781165, 8.797828353127633, -8.536042032859532, 21.473839780582328, 18.718487119698032, -2.4545007144366346, -1.0520977800190234, 6.75710913097668, -2.763432400235981, 25.391185520856453, 0.6115785818429114, 4.99321703213465, -6.484606590124809]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6301321414786564, "mean_inference_ms": 1.6748095990849594, "mean_action_processing_ms": 0.2583992184273374, "mean_env_wait_ms": 0.14585319910558148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004489302635192871, "StateBufferConnector_ms": 0.003301858901977539, "ViewRequirementAgentConnector_ms": 0.11449956893920898}, "num_episodes": 18, "episode_return_max": 44.268945104660546, "episode_return_min": -4.838685024810394, "episode_return_mean": 14.171101175108568, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.39136274346646, "num_env_steps_trained_throughput_per_sec": 361.39136274346646, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 10812.218, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10812.068, "sample_time_ms": 1238.303, "learn_time_ms": 9554.294, "learn_throughput": 418.66, "synch_weights_time_ms": 18.029}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 102, "trial_id": "06536_00000", "date": "2024-08-11_17-32-40", "timestamp": 1723411960, "time_this_iter_s": 11.12973427772522, "time_total_s": 3502.116631269455, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316e0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3502.116631269455, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 49.44666666666667, "ram_util_percent": 82.71333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.745386015872161, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.040101654579242, "policy_loss": -0.008327594862203113, "vf_loss": 2.048423172781865, "vf_explained_var": 0.9562964800124367, "kl": 0.007767837550874409, "entropy": 0.47844315599650145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9646856400701735, "cur_kl_coeff": 6.661338147750938e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5693451235534024, "policy_loss": -0.0015639424962164076, "vf_loss": 2.5709090625167526, "vf_explained_var": 0.9469699642960987, "kl": 0.0032534938648257077, "entropy": 0.21703102093525034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "env_runners": {"episode_reward_max": 44.268945104660546, "episode_reward_min": -10.023064520267226, "episode_reward_mean": 14.046184778951558, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.26894510466046, "predator_policy": -18.632360273653173}, "policy_reward_max": {"prey_policy": 10.023064520267225, "predator_policy": 53.66058853801053}, "policy_reward_mean": {"prey_policy": -14.046184778951558, "predator_policy": 14.046184778951558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.06304252785851, 15.600091446238771, -0.29140373561729227, 28.239151079815137, 8.672431071316659, 26.154227472534856, -2.3694164548842096, 9.31426395764762, 4.6702450765250925, 16.366321925279205, 2.1870868797557366, 7.9648619048037705, 4.512707447075204, 22.540645285281016, 13.00251172336034, 32.4417042988248, 2.1849207217295783, 10.986555642243596, 25.53864096743397, 17.35839179217576, 20.335930854053252, 24.887868903021925, 6.696745783477354, 13.648819238347428, -1.5751011033161753, 26.173152120955, 22.518741549917753, 20.717303339805873, 8.333573398502047, 8.589979304410765, -4.838685024810394, 27.60396603725792, 10.577419857282761, 34.669381262267464, -3.247574576021603, 18.496869446427628, 17.551625602844695, 20.318446924731838, 36.13558459322251, -2.93750105366309, -2.6376275134214957, 31.68257462853264, 8.661624103085883, 44.268945104660546, 16.534539035321938, 19.784374630548538, 20.168994281511083, 17.891820573006044, 6.3926058022667736, -0.49635261802330266, 21.813468086110927, 14.218254059868082, 7.355305103999277, 17.2294128641974, 25.033451100304266, 12.225636368384208, 27.119146591743082, 18.33490191036181, 2.5927330977641345, 12.787412165211466, 18.59048584300175, 16.15352056440949, 24.613873868779407, 9.073735328060833, -1.8190370937254121, 10.653760373182093, 25.8221527874744, 2.247605507822704, 20.187438668891343, 17.34840110323698, 14.806450824459272, 25.094100610914857, 0.1308931601340495, 20.09616345014019, -1.7532992472278246, 1.9968383653703463, 13.001382051349676, -0.7456947789950688, 11.278017659156829, 22.641399984336687, -9.931686143959045, 12.486225954556287, 28.410036863044166, 6.69858978070401, 0.35949010478235266, -4.018645242430896, 9.82244467500568, 29.429150202001182, 38.71889369302704, 7.366120090813907, -4.294089174350406, -1.3375116864742758, 26.488841738426405, 26.176127052416284, 3.5639509529580913, 41.751254058479525, 43.91954350799202, 14.335259239122538, 8.524610854989183, -10.023064520267226], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0630425278585, -15.600091446238793, 0.29140373561728694, -28.239151079815116, -8.672431071316643, -26.15422747253484, 2.36941645488424, -9.314263957647622, -4.670245076525119, -16.366321925279152, -2.187086879755737, -7.964861904803773, -4.512707447075201, -22.540645285281055, -13.002511723360332, -32.441704298824796, -2.1849207217295783, -10.986555642243623, -25.538640967433963, -17.358391792175798, -20.335930854053284, -24.887868903021904, -6.6967457834773585, -13.648819238347434, 1.575101103316177, -26.173152120955017, -22.518741549917735, -20.71730333980584, -8.333573398502017, -8.589979304410774, 4.838685024810388, -27.603966037257937, -10.57741985728276, -34.669381262267486, 3.2475745760216013, -18.49686944642763, -17.551625602844712, -20.31844692473183, -36.135584593222546, 2.9375010536630937, 2.637627513421501, -31.682574628532656, -8.661624103085874, -44.26894510466046, -16.534539035321952, -19.78437463054854, -20.168994281511075, -17.891820573006058, -6.392605802266775, 0.49635261802330133, -21.813468086110923, -14.218254059868094, -7.3553051039992745, -17.229412864197396, -25.03345110030415, -12.225636368384214, -27.119146591743082, -18.33490191036179, -2.5927330977641248, -12.787412165211475, -18.590485843001748, -16.153520564409497, -24.613873868779425, -9.073735328060831, 1.8190370937254041, -10.653760373182077, -25.822152787474398, -2.2476055078227164, -20.187438668891343, -17.34840110323696, -14.80645082445929, -25.094100610914882, -0.13089316013404684, -20.09616345014018, 1.7532992472278268, -1.9968383653703436, -13.001382051349685, 0.7456947789950834, -11.27801765915683, -22.6413999843367, 9.931686143959048, -12.486225954556243, -28.41003686304417, -6.6985897807040145, -0.35949010478235, 4.018645242430898, -9.822444675005686, -29.42915020200115, -38.71889369302707, -7.366120090813938, 4.294089174350381, 1.3375116864742722, -26.4888417384264, -26.176127052416284, -3.5639509529580806, -41.75125405847956, -43.919543507992046, -14.335259239122541, -8.524610854989199, 10.023064520267225], "policy_predator_policy_reward": [2.520223738794064, 29.605861316922987, 14.553453804082485, 16.646729088395038, -2.635310677147304, 2.0525032059127426, 46.431853049363546, 10.046449110266657, 10.15618044934894, 7.18868169328438, 52.99072835110295, -0.6822734060333309, -8.877575775374813, 4.138742865606366, 11.154807732719368, 7.473720182575873, 7.419804243075674, 1.9206859099745497, -4.649209635925015, 37.381853486483394, 5.9665589225419025, -1.5923851630304213, 7.728481684889479, 8.20124212471807, -3.99370502508342, 13.01911991923382, 16.195873656304844, 28.885416914257235, 3.0306748476014462, 22.97434859911923, 29.987124289487415, 34.89628430816221, 5.578633756184501, -1.2087923127253486, 9.974768467859214, 11.998342816628043, 34.32627270840985, 16.75100922645812, 17.540502835396612, 17.176280748955016, 8.211546232867448, 32.460315475239035, 32.56416662510913, 17.211571180934676, 5.325916007048001, 8.067575559906722, 31.47526055959474, -4.177622082899841, 0.5062792281187036, -3.656481434751056, 25.736388962651727, 26.60991527925828, 30.29207596622589, 14.745407133609588, 33.213200170156284, 8.221406509455424, 15.066021106049597, 1.6011256909544755, 1.76876502851231, 15.411193580309247, 3.0489701411255545, -12.726340190746335, 16.74862260506535, 38.459309469450524, 15.316679866871304, 5.838159847694211, 40.843360533700526, 28.495401990834434, -2.5542638837530305, -3.940885268290165, 27.9133303770178, 9.080408515837476, 28.23212038282258, 6.871130822866792, 33.66125045241144, 6.975643397052256, 42.116698485936226, 30.154470700508824, 2.8860920269627925, -8.761094134288973, 13.357105246810193, -18.632360273653173, 32.44565627199667, 30.919492985068647, 16.44158575526166, 0.8816624509101665, 40.75549078680825, 47.78239942251268, 14.500826087866319, 18.56825198277759, 12.686368978199667, 26.882380282897387, 11.39997454895005, 28.938014014072095, 2.3673556249865606, 33.41628552102555, 2.096066258755444, 10.689145345778083, -3.3259995494571335, 2.3332943134105326, 10.826369938081427, 32.800566234140426, 18.95169660214902, 9.484811517587154, 17.087824659382704, -2.377214451384157, 26.363952436217414, 8.094873292177382, 19.847698852959624, 30.219203347648776, 24.031349948854174, 0.41992278791426685, 33.969743512974475, 20.26854967051169, 0.6032087017830827, 36.06659511894051, 17.40527366589306, -12.219807470364831, 4.908610760396591, 20.666213570026358, 12.648986336073884, 24.531985349929602, 10.269933324373325, 22.037107804445668, 18.037198658878296, 31.190549078680558, 19.738710160132243, -1.5912395040105576, 3.083901162359064, -6.7219753498098775, 6.859870666305129, 14.447650080059024, 34.05017318969965, 17.59413238524919, 4.121684675244431, 0.3735263404009963, 21.12794019732288, 19.246937140459757, 14.581810655225723, 20.114991551248202, 20.548582186894997, 9.064319462023581, 16.664510984018083, 33.52369023781165, 8.797828353127633, -8.536042032859532, 21.473839780582328, 18.718487119698032, -2.4545007144366346, -1.0520977800190234, 6.75710913097668, -2.763432400235981, 25.391185520856453, 0.6115785818429114, 4.99321703213465, -6.484606590124809, 26.727225220575995, -4.171189902262353, 32.182319713873135, 13.100480254800232, -6.790809701802786, -13.072562586115305, 16.872117024050155, 8.100334885062367, 27.169460529565942, 29.650613196522407, 6.267945725463594, 7.129233835944426, -1.650047989149268, 2.369028198713968, -7.548929050025448, -0.48836143483635297, -0.7930285526843885, 20.43791790269577, 28.72920065457987, 30.129099749422483, 40.29086025920331, 37.146927126850855, 4.563298249222844, 10.168941932405012, -6.930333412621872, -1.6578449360788987, 0.6736736933096665, -3.3486970662582127, 33.8800912480059, 19.097592228846946, 24.294238022260338, 28.05801608257225, 20.23383093674025, -13.105929030824086, 41.26661739343024, 42.235890723528826, 53.66058853801053, 34.17849847797359, 28.28239788903471, 0.3881205892103545, 24.811629169905174, -7.762407459926806, -12.904755556396413, -7.141373484138031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6299496852249092, "mean_inference_ms": 1.674023648359338, "mean_action_processing_ms": 0.25840605236048936, "mean_env_wait_ms": 0.1457492711612647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060492753982543945, "StateBufferConnector_ms": 0.003404855728149414, "ViewRequirementAgentConnector_ms": 0.11513984203338623}, "num_episodes": 22, "episode_return_max": 44.268945104660546, "episode_return_min": -10.023064520267226, "episode_return_mean": 14.046184778951558, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.09304767875767, "num_env_steps_trained_throughput_per_sec": 376.09304767875767, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 10752.131, "restore_workers_time_ms": 0.021, "training_step_time_ms": 10751.849, "sample_time_ms": 1212.588, "learn_time_ms": 9516.494, "learn_throughput": 420.323, "synch_weights_time_ms": 20.891}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "training_iteration": 103, "trial_id": "06536_00000", "date": "2024-08-11_17-32-51", "timestamp": 1723411971, "time_this_iter_s": 10.695918083190918, "time_total_s": 3512.812549352646, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316da8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3512.812549352646, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 49.61875, "ram_util_percent": 83.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7699105750769375, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7839502298583587, "policy_loss": -0.007326351462688762, "vf_loss": 1.7912701517343521, "vf_explained_var": 0.9636468683679899, "kl": 0.008221376634643975, "entropy": 0.485009626361231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.742412452123783, "cur_kl_coeff": 3.330669073875469e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2273236858150947, "policy_loss": -0.0021438024400994575, "vf_loss": 2.2294674875875, "vf_explained_var": 0.9592018296478917, "kl": 0.004422953337082471, "entropy": 0.24356074833838398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 44.268945104660546, "episode_reward_min": -10.023064520267226, "episode_reward_mean": 14.298391807591672, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.26894510466046, "predator_policy": -18.632360273653173}, "policy_reward_max": {"prey_policy": 10.023064520267225, "predator_policy": 53.66058853801053}, "policy_reward_mean": {"prey_policy": -14.298391807591674, "predator_policy": 14.298391807591674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.53864096743397, 17.35839179217576, 20.335930854053252, 24.887868903021925, 6.696745783477354, 13.648819238347428, -1.5751011033161753, 26.173152120955, 22.518741549917753, 20.717303339805873, 8.333573398502047, 8.589979304410765, -4.838685024810394, 27.60396603725792, 10.577419857282761, 34.669381262267464, -3.247574576021603, 18.496869446427628, 17.551625602844695, 20.318446924731838, 36.13558459322251, -2.93750105366309, -2.6376275134214957, 31.68257462853264, 8.661624103085883, 44.268945104660546, 16.534539035321938, 19.784374630548538, 20.168994281511083, 17.891820573006044, 6.3926058022667736, -0.49635261802330266, 21.813468086110927, 14.218254059868082, 7.355305103999277, 17.2294128641974, 25.033451100304266, 12.225636368384208, 27.119146591743082, 18.33490191036181, 2.5927330977641345, 12.787412165211466, 18.59048584300175, 16.15352056440949, 24.613873868779407, 9.073735328060833, -1.8190370937254121, 10.653760373182093, 25.8221527874744, 2.247605507822704, 20.187438668891343, 17.34840110323698, 14.806450824459272, 25.094100610914857, 0.1308931601340495, 20.09616345014019, -1.7532992472278246, 1.9968383653703463, 13.001382051349676, -0.7456947789950688, 11.278017659156829, 22.641399984336687, -9.931686143959045, 12.486225954556287, 28.410036863044166, 6.69858978070401, 0.35949010478235266, -4.018645242430896, 9.82244467500568, 29.429150202001182, 38.71889369302704, 7.366120090813907, -4.294089174350406, -1.3375116864742758, 26.488841738426405, 26.176127052416284, 3.5639509529580913, 41.751254058479525, 43.91954350799202, 14.335259239122538, 8.524610854989183, -10.023064520267226, 21.167253800806385, 6.747059872155997, 21.333368830086798, 25.47500956936893, 14.162365906062993, 9.983984668923435, 0.05851068643730617, 7.193416003331015, 2.1003914052522905, -5.776322634253223, 0.2734145378550572, 33.6179816611694, 12.01059911700774, 27.23568418842385, 21.670550254399256, 11.01144675669959, 14.450659563830575, 20.745276946242537], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.538640967433963, -17.358391792175798, -20.335930854053284, -24.887868903021904, -6.6967457834773585, -13.648819238347434, 1.575101103316177, -26.173152120955017, -22.518741549917735, -20.71730333980584, -8.333573398502017, -8.589979304410774, 4.838685024810388, -27.603966037257937, -10.57741985728276, -34.669381262267486, 3.2475745760216013, -18.49686944642763, -17.551625602844712, -20.31844692473183, -36.135584593222546, 2.9375010536630937, 2.637627513421501, -31.682574628532656, -8.661624103085874, -44.26894510466046, -16.534539035321952, -19.78437463054854, -20.168994281511075, -17.891820573006058, -6.392605802266775, 0.49635261802330133, -21.813468086110923, -14.218254059868094, -7.3553051039992745, -17.229412864197396, -25.03345110030415, -12.225636368384214, -27.119146591743082, -18.33490191036179, -2.5927330977641248, -12.787412165211475, -18.590485843001748, -16.153520564409497, -24.613873868779425, -9.073735328060831, 1.8190370937254041, -10.653760373182077, -25.822152787474398, -2.2476055078227164, -20.187438668891343, -17.34840110323696, -14.80645082445929, -25.094100610914882, -0.13089316013404684, -20.09616345014018, 1.7532992472278268, -1.9968383653703436, -13.001382051349685, 0.7456947789950834, -11.27801765915683, -22.6413999843367, 9.931686143959048, -12.486225954556243, -28.41003686304417, -6.6985897807040145, -0.35949010478235, 4.018645242430898, -9.822444675005686, -29.42915020200115, -38.71889369302707, -7.366120090813938, 4.294089174350381, 1.3375116864742722, -26.4888417384264, -26.176127052416284, -3.5639509529580806, -41.75125405847956, -43.919543507992046, -14.335259239122541, -8.524610854989199, 10.023064520267225, -21.167253800806385, -6.7470598721559885, -21.3333688300868, -25.475009569368904, -14.16236590606297, -9.983984668923412, -0.058510686437293735, -7.193416003330999, -2.100391405252295, 5.776322634253205, -0.2734145378550288, -33.617981661169395, -12.010599117007757, -27.235684188423804, -21.67055025439922, -11.011446756699593, -14.450659563830566, -20.7452769462426], "policy_predator_policy_reward": [34.32627270840985, 16.75100922645812, 17.540502835396612, 17.176280748955016, 8.211546232867448, 32.460315475239035, 32.56416662510913, 17.211571180934676, 5.325916007048001, 8.067575559906722, 31.47526055959474, -4.177622082899841, 0.5062792281187036, -3.656481434751056, 25.736388962651727, 26.60991527925828, 30.29207596622589, 14.745407133609588, 33.213200170156284, 8.221406509455424, 15.066021106049597, 1.6011256909544755, 1.76876502851231, 15.411193580309247, 3.0489701411255545, -12.726340190746335, 16.74862260506535, 38.459309469450524, 15.316679866871304, 5.838159847694211, 40.843360533700526, 28.495401990834434, -2.5542638837530305, -3.940885268290165, 27.9133303770178, 9.080408515837476, 28.23212038282258, 6.871130822866792, 33.66125045241144, 6.975643397052256, 42.116698485936226, 30.154470700508824, 2.8860920269627925, -8.761094134288973, 13.357105246810193, -18.632360273653173, 32.44565627199667, 30.919492985068647, 16.44158575526166, 0.8816624509101665, 40.75549078680825, 47.78239942251268, 14.500826087866319, 18.56825198277759, 12.686368978199667, 26.882380282897387, 11.39997454895005, 28.938014014072095, 2.3673556249865606, 33.41628552102555, 2.096066258755444, 10.689145345778083, -3.3259995494571335, 2.3332943134105326, 10.826369938081427, 32.800566234140426, 18.95169660214902, 9.484811517587154, 17.087824659382704, -2.377214451384157, 26.363952436217414, 8.094873292177382, 19.847698852959624, 30.219203347648776, 24.031349948854174, 0.41992278791426685, 33.969743512974475, 20.26854967051169, 0.6032087017830827, 36.06659511894051, 17.40527366589306, -12.219807470364831, 4.908610760396591, 20.666213570026358, 12.648986336073884, 24.531985349929602, 10.269933324373325, 22.037107804445668, 18.037198658878296, 31.190549078680558, 19.738710160132243, -1.5912395040105576, 3.083901162359064, -6.7219753498098775, 6.859870666305129, 14.447650080059024, 34.05017318969965, 17.59413238524919, 4.121684675244431, 0.3735263404009963, 21.12794019732288, 19.246937140459757, 14.581810655225723, 20.114991551248202, 20.548582186894997, 9.064319462023581, 16.664510984018083, 33.52369023781165, 8.797828353127633, -8.536042032859532, 21.473839780582328, 18.718487119698032, -2.4545007144366346, -1.0520977800190234, 6.75710913097668, -2.763432400235981, 25.391185520856453, 0.6115785818429114, 4.99321703213465, -6.484606590124809, 26.727225220575995, -4.171189902262353, 32.182319713873135, 13.100480254800232, -6.790809701802786, -13.072562586115305, 16.872117024050155, 8.100334885062367, 27.169460529565942, 29.650613196522407, 6.267945725463594, 7.129233835944426, -1.650047989149268, 2.369028198713968, -7.548929050025448, -0.48836143483635297, -0.7930285526843885, 20.43791790269577, 28.72920065457987, 30.129099749422483, 40.29086025920331, 37.146927126850855, 4.563298249222844, 10.168941932405012, -6.930333412621872, -1.6578449360788987, 0.6736736933096665, -3.3486970662582127, 33.8800912480059, 19.097592228846946, 24.294238022260338, 28.05801608257225, 20.23383093674025, -13.105929030824086, 41.26661739343024, 42.235890723528826, 53.66058853801053, 34.17849847797359, 28.28239788903471, 0.3881205892103545, 24.811629169905174, -7.762407459926806, -12.904755556396413, -7.141373484138031, 36.72320514007308, 5.61130246153968, 8.677703260349654, 4.816416483962309, 13.298153591036415, 29.3685840691372, 28.83439872856951, 22.115620410168297, 13.244491922502977, 15.080239889622959, 18.248213964481536, 1.719755373365306, -0.2077160084659493, 0.32473738134054564, 12.529441059810342, 1.8573909468516767, 17.746583884547213, -13.545801074042645, -15.144658309934627, 3.5920130414281957, -0.26469139889466575, 0.8115204746047482, 32.450420226727175, 34.785543095611615, 16.691419394100972, 7.329778839914528, 21.27979242719506, 33.19157594965257, 33.942982927471654, 9.398117581326781, 7.525541412717978, 14.497352100681214, 20.547395973830675, 8.353923153830477, 26.57887254951084, 14.91168134297433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6302370261746408, "mean_inference_ms": 1.6744660717282691, "mean_action_processing_ms": 0.2585786039845456, "mean_env_wait_ms": 0.14573011029411162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008176684379577637, "StateBufferConnector_ms": 0.003445148468017578, "ViewRequirementAgentConnector_ms": 0.13767194747924805}, "num_episodes": 18, "episode_return_max": 44.268945104660546, "episode_return_min": -10.023064520267226, "episode_return_mean": 14.298391807591672, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.49922851134295, "num_env_steps_trained_throughput_per_sec": 351.49922851134295, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 10849.945, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10849.66, "sample_time_ms": 1275.874, "learn_time_ms": 9550.898, "learn_throughput": 418.809, "synch_weights_time_ms": 20.961}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 104, "trial_id": "06536_00000", "date": "2024-08-11_17-33-02", "timestamp": 1723411982, "time_this_iter_s": 11.439244031906128, "time_total_s": 3524.251793384552, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3524.251793384552, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 50.4, "ram_util_percent": 83.28750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.016055789589882, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.176283752049009, "policy_loss": -0.007733087968275262, "vf_loss": 2.184012098113696, "vf_explained_var": 0.9562196246658762, "kl": 0.0060810280177350014, "entropy": 0.5298587190918624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.953528225548053, "cur_kl_coeff": 1.6653345369377344e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.631480531402366, "policy_loss": -0.0018746304727361473, "vf_loss": 2.6333551550668384, "vf_explained_var": 0.9478136551758599, "kl": 0.0029252294674580806, "entropy": 0.2013334485391776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "env_runners": {"episode_reward_max": 44.268945104660546, "episode_reward_min": -15.297061479869733, "episode_reward_mean": 14.602017265160383, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.26894510466046, "predator_policy": -24.480225966598653}, "policy_reward_max": {"prey_policy": 15.297061479869736, "predator_policy": 53.66058853801053}, "policy_reward_mean": {"prey_policy": -14.602017265160377, "predator_policy": 14.602017265160383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.68257462853264, 8.661624103085883, 44.268945104660546, 16.534539035321938, 19.784374630548538, 20.168994281511083, 17.891820573006044, 6.3926058022667736, -0.49635261802330266, 21.813468086110927, 14.218254059868082, 7.355305103999277, 17.2294128641974, 25.033451100304266, 12.225636368384208, 27.119146591743082, 18.33490191036181, 2.5927330977641345, 12.787412165211466, 18.59048584300175, 16.15352056440949, 24.613873868779407, 9.073735328060833, -1.8190370937254121, 10.653760373182093, 25.8221527874744, 2.247605507822704, 20.187438668891343, 17.34840110323698, 14.806450824459272, 25.094100610914857, 0.1308931601340495, 20.09616345014019, -1.7532992472278246, 1.9968383653703463, 13.001382051349676, -0.7456947789950688, 11.278017659156829, 22.641399984336687, -9.931686143959045, 12.486225954556287, 28.410036863044166, 6.69858978070401, 0.35949010478235266, -4.018645242430896, 9.82244467500568, 29.429150202001182, 38.71889369302704, 7.366120090813907, -4.294089174350406, -1.3375116864742758, 26.488841738426405, 26.176127052416284, 3.5639509529580913, 41.751254058479525, 43.91954350799202, 14.335259239122538, 8.524610854989183, -10.023064520267226, 21.167253800806385, 6.747059872155997, 21.333368830086798, 25.47500956936893, 14.162365906062993, 9.983984668923435, 0.05851068643730617, 7.193416003331015, 2.1003914052522905, -5.776322634253223, 0.2734145378550572, 33.6179816611694, 12.01059911700774, 27.23568418842385, 21.670550254399256, 11.01144675669959, 14.450659563830575, 20.745276946242537, 30.99193618033977, 14.024625578244928, 19.226731383536922, 15.896468504692375, 29.587357416463927, -2.282597857866051, -15.297061479869733, 7.403866279500937, 27.763802526871938, 17.19206467935068, 7.993822984782886, 6.651036030426274, 25.35837890562824, 18.191371780618827, 12.470358429946833, 16.87577743763183, 36.650761227036256, 25.80671134474609, 23.81607930389954, -8.143260244555304, 23.67163011415967, 16.68914068645881, 24.739496249728624], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.682574628532656, -8.661624103085874, -44.26894510466046, -16.534539035321952, -19.78437463054854, -20.168994281511075, -17.891820573006058, -6.392605802266775, 0.49635261802330133, -21.813468086110923, -14.218254059868094, -7.3553051039992745, -17.229412864197396, -25.03345110030415, -12.225636368384214, -27.119146591743082, -18.33490191036179, -2.5927330977641248, -12.787412165211475, -18.590485843001748, -16.153520564409497, -24.613873868779425, -9.073735328060831, 1.8190370937254041, -10.653760373182077, -25.822152787474398, -2.2476055078227164, -20.187438668891343, -17.34840110323696, -14.80645082445929, -25.094100610914882, -0.13089316013404684, -20.09616345014018, 1.7532992472278268, -1.9968383653703436, -13.001382051349685, 0.7456947789950834, -11.27801765915683, -22.6413999843367, 9.931686143959048, -12.486225954556243, -28.41003686304417, -6.6985897807040145, -0.35949010478235, 4.018645242430898, -9.822444675005686, -29.42915020200115, -38.71889369302707, -7.366120090813938, 4.294089174350381, 1.3375116864742722, -26.4888417384264, -26.176127052416284, -3.5639509529580806, -41.75125405847956, -43.919543507992046, -14.335259239122541, -8.524610854989199, 10.023064520267225, -21.167253800806385, -6.7470598721559885, -21.3333688300868, -25.475009569368904, -14.16236590606297, -9.983984668923412, -0.058510686437293735, -7.193416003330999, -2.100391405252295, 5.776322634253205, -0.2734145378550288, -33.617981661169395, -12.010599117007757, -27.235684188423804, -21.67055025439922, -11.011446756699593, -14.450659563830566, -20.7452769462426, -30.99193618033977, -14.024625578244915, -19.22673138353694, -15.896468504692368, -29.587357416463895, 2.2825978578660524, 15.297061479869736, -7.403866279500934, -27.76380252687185, -17.192064679350644, -7.993822984782902, -6.651036030426275, -25.358378905628243, -18.19137178061888, -12.47035842994682, -16.875777437631832, -36.65076122703627, -25.806711344746127, -23.816079303899464, 8.1432602445553, -23.671630114159687, -16.68914068645881, -24.739496249728568], "policy_predator_policy_reward": [32.44565627199667, 30.919492985068647, 16.44158575526166, 0.8816624509101665, 40.75549078680825, 47.78239942251268, 14.500826087866319, 18.56825198277759, 12.686368978199667, 26.882380282897387, 11.39997454895005, 28.938014014072095, 2.3673556249865606, 33.41628552102555, 2.096066258755444, 10.689145345778083, -3.3259995494571335, 2.3332943134105326, 10.826369938081427, 32.800566234140426, 18.95169660214902, 9.484811517587154, 17.087824659382704, -2.377214451384157, 26.363952436217414, 8.094873292177382, 19.847698852959624, 30.219203347648776, 24.031349948854174, 0.41992278791426685, 33.969743512974475, 20.26854967051169, 0.6032087017830827, 36.06659511894051, 17.40527366589306, -12.219807470364831, 4.908610760396591, 20.666213570026358, 12.648986336073884, 24.531985349929602, 10.269933324373325, 22.037107804445668, 18.037198658878296, 31.190549078680558, 19.738710160132243, -1.5912395040105576, 3.083901162359064, -6.7219753498098775, 6.859870666305129, 14.447650080059024, 34.05017318969965, 17.59413238524919, 4.121684675244431, 0.3735263404009963, 21.12794019732288, 19.246937140459757, 14.581810655225723, 20.114991551248202, 20.548582186894997, 9.064319462023581, 16.664510984018083, 33.52369023781165, 8.797828353127633, -8.536042032859532, 21.473839780582328, 18.718487119698032, -2.4545007144366346, -1.0520977800190234, 6.75710913097668, -2.763432400235981, 25.391185520856453, 0.6115785818429114, 4.99321703213465, -6.484606590124809, 26.727225220575995, -4.171189902262353, 32.182319713873135, 13.100480254800232, -6.790809701802786, -13.072562586115305, 16.872117024050155, 8.100334885062367, 27.169460529565942, 29.650613196522407, 6.267945725463594, 7.129233835944426, -1.650047989149268, 2.369028198713968, -7.548929050025448, -0.48836143483635297, -0.7930285526843885, 20.43791790269577, 28.72920065457987, 30.129099749422483, 40.29086025920331, 37.146927126850855, 4.563298249222844, 10.168941932405012, -6.930333412621872, -1.6578449360788987, 0.6736736933096665, -3.3486970662582127, 33.8800912480059, 19.097592228846946, 24.294238022260338, 28.05801608257225, 20.23383093674025, -13.105929030824086, 41.26661739343024, 42.235890723528826, 53.66058853801053, 34.17849847797359, 28.28239788903471, 0.3881205892103545, 24.811629169905174, -7.762407459926806, -12.904755556396413, -7.141373484138031, 36.72320514007308, 5.61130246153968, 8.677703260349654, 4.816416483962309, 13.298153591036415, 29.3685840691372, 28.83439872856951, 22.115620410168297, 13.244491922502977, 15.080239889622959, 18.248213964481536, 1.719755373365306, -0.2077160084659493, 0.32473738134054564, 12.529441059810342, 1.8573909468516767, 17.746583884547213, -13.545801074042645, -15.144658309934627, 3.5920130414281957, -0.26469139889466575, 0.8115204746047482, 32.450420226727175, 34.785543095611615, 16.691419394100972, 7.329778839914528, 21.27979242719506, 33.19157594965257, 33.942982927471654, 9.398117581326781, 7.525541412717978, 14.497352100681214, 20.547395973830675, 8.353923153830477, 26.57887254951084, 14.91168134297433, 45.57546678143624, 16.408405579243293, 20.734168336469224, 7.315082820020628, 47.02286099573557, -8.569398228661663, 8.372625738457415, 23.42031127092732, 34.24096586537247, 24.933748967555296, 4.664689000868951, -9.229884716601054, -24.480225966598653, -6.113896993140834, 4.969921698659244, 9.837810860342632, 24.363419492808944, 31.16418556093482, 7.064661892114961, 27.319467466586346, 5.163382333542449, 10.824263636023357, 5.121777868829708, 8.180294192022835, 32.78159921036327, 17.935158600893207, 8.160995621075932, 28.22174794016175, 4.086618755880469, 20.854098104013154, 3.887876973918667, 29.86367790134499, 43.29512832222508, 30.00639413184744, 18.22753672145098, 33.385885968041244, 37.54782129107481, 10.084337316724174, -16.98106946431982, 0.694548975209214, 30.056546476920047, 17.28671375139933, 0.18091640996190073, 33.197364962955696, 18.185323399911915, 31.29366909954527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6304104952157044, "mean_inference_ms": 1.673885090113291, "mean_action_processing_ms": 0.2585777828409056, "mean_env_wait_ms": 0.14566729299552914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007466435432434082, "StateBufferConnector_ms": 0.0032519102096557617, "ViewRequirementAgentConnector_ms": 0.13121068477630615}, "num_episodes": 23, "episode_return_max": 44.268945104660546, "episode_return_min": -15.297061479869733, "episode_return_mean": 14.602017265160383, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 379.47473655208904, "num_env_steps_trained_throughput_per_sec": 379.47473655208904, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 10901.432, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10901.153, "sample_time_ms": 1269.868, "learn_time_ms": 9609.266, "learn_throughput": 416.265, "synch_weights_time_ms": 20.099}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "training_iteration": 105, "trial_id": "06536_00000", "date": "2024-08-11_17-33-13", "timestamp": 1723411993, "time_this_iter_s": 10.585448026657104, "time_total_s": 3534.837241411209, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33165c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3534.837241411209, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 46.526666666666664, "ram_util_percent": 83.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.123647861431042, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3280688834687076, "policy_loss": -0.008075766699039377, "vf_loss": 2.3361366536468267, "vf_explained_var": 0.9503033307070533, "kl": 0.01023063531338361, "entropy": 0.5304486421247323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.038640889351961, "cur_kl_coeff": 8.326672684688672e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6311784922130523, "policy_loss": -0.001430990222333955, "vf_loss": 2.632609475983514, "vf_explained_var": 0.9484472732379954, "kl": 0.002086606776444959, "entropy": 0.22969360856940507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 43.91954350799202, "episode_reward_min": -15.297061479869733, "episode_reward_mean": 15.223744761381278, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -43.919543507992046, "predator_policy": -24.480225966598653}, "policy_reward_max": {"prey_policy": 15.297061479869736, "predator_policy": 53.66058853801053}, "policy_reward_mean": {"prey_policy": -15.223744761381278, "predator_policy": 15.223744761381276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.787412165211466, 18.59048584300175, 16.15352056440949, 24.613873868779407, 9.073735328060833, -1.8190370937254121, 10.653760373182093, 25.8221527874744, 2.247605507822704, 20.187438668891343, 17.34840110323698, 14.806450824459272, 25.094100610914857, 0.1308931601340495, 20.09616345014019, -1.7532992472278246, 1.9968383653703463, 13.001382051349676, -0.7456947789950688, 11.278017659156829, 22.641399984336687, -9.931686143959045, 12.486225954556287, 28.410036863044166, 6.69858978070401, 0.35949010478235266, -4.018645242430896, 9.82244467500568, 29.429150202001182, 38.71889369302704, 7.366120090813907, -4.294089174350406, -1.3375116864742758, 26.488841738426405, 26.176127052416284, 3.5639509529580913, 41.751254058479525, 43.91954350799202, 14.335259239122538, 8.524610854989183, -10.023064520267226, 21.167253800806385, 6.747059872155997, 21.333368830086798, 25.47500956936893, 14.162365906062993, 9.983984668923435, 0.05851068643730617, 7.193416003331015, 2.1003914052522905, -5.776322634253223, 0.2734145378550572, 33.6179816611694, 12.01059911700774, 27.23568418842385, 21.670550254399256, 11.01144675669959, 14.450659563830575, 20.745276946242537, 30.99193618033977, 14.024625578244928, 19.226731383536922, 15.896468504692375, 29.587357416463927, -2.282597857866051, -15.297061479869733, 7.403866279500937, 27.763802526871938, 17.19206467935068, 7.993822984782886, 6.651036030426274, 25.35837890562824, 18.191371780618827, 12.470358429946833, 16.87577743763183, 36.650761227036256, 25.80671134474609, 23.81607930389954, -8.143260244555304, 23.67163011415967, 16.68914068645881, 24.739496249728624, 15.066463708402148, 34.86765016699654, -5.23620877752638, 23.703820121693145, 38.304500436913095, 6.28628554969909, 30.499666706780445, 19.676758247237057, 26.47135694340009, 0.25414153217676994, 8.70039881278714, 31.34933662634121, 16.19994873639764, 21.62706349120562, 28.674202895490197, 36.99121649283675, 17.135937116379484, 22.411645538522897], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.787412165211475, -18.590485843001748, -16.153520564409497, -24.613873868779425, -9.073735328060831, 1.8190370937254041, -10.653760373182077, -25.822152787474398, -2.2476055078227164, -20.187438668891343, -17.34840110323696, -14.80645082445929, -25.094100610914882, -0.13089316013404684, -20.09616345014018, 1.7532992472278268, -1.9968383653703436, -13.001382051349685, 0.7456947789950834, -11.27801765915683, -22.6413999843367, 9.931686143959048, -12.486225954556243, -28.41003686304417, -6.6985897807040145, -0.35949010478235, 4.018645242430898, -9.822444675005686, -29.42915020200115, -38.71889369302707, -7.366120090813938, 4.294089174350381, 1.3375116864742722, -26.4888417384264, -26.176127052416284, -3.5639509529580806, -41.75125405847956, -43.919543507992046, -14.335259239122541, -8.524610854989199, 10.023064520267225, -21.167253800806385, -6.7470598721559885, -21.3333688300868, -25.475009569368904, -14.16236590606297, -9.983984668923412, -0.058510686437293735, -7.193416003330999, -2.100391405252295, 5.776322634253205, -0.2734145378550288, -33.617981661169395, -12.010599117007757, -27.235684188423804, -21.67055025439922, -11.011446756699593, -14.450659563830566, -20.7452769462426, -30.99193618033977, -14.024625578244915, -19.22673138353694, -15.896468504692368, -29.587357416463895, 2.2825978578660524, 15.297061479869736, -7.403866279500934, -27.76380252687185, -17.192064679350644, -7.993822984782902, -6.651036030426275, -25.358378905628243, -18.19137178061888, -12.47035842994682, -16.875777437631832, -36.65076122703627, -25.806711344746127, -23.816079303899464, 8.1432602445553, -23.671630114159687, -16.68914068645881, -24.739496249728568, -15.066463708402132, -34.86765016699658, 5.236208777526382, -23.70382012169318, -38.30450043691311, -6.286285549699084, -30.49966670678038, -19.67675824723706, -26.471356943400085, -0.25414153217676105, -8.700398812787121, -31.349336626341223, -16.199948736397644, -21.627063491205607, -28.674202895490172, -36.99121649283678, -17.135937116379473, -22.41164553852291], "policy_predator_policy_reward": [4.908610760396591, 20.666213570026358, 12.648986336073884, 24.531985349929602, 10.269933324373325, 22.037107804445668, 18.037198658878296, 31.190549078680558, 19.738710160132243, -1.5912395040105576, 3.083901162359064, -6.7219753498098775, 6.859870666305129, 14.447650080059024, 34.05017318969965, 17.59413238524919, 4.121684675244431, 0.3735263404009963, 21.12794019732288, 19.246937140459757, 14.581810655225723, 20.114991551248202, 20.548582186894997, 9.064319462023581, 16.664510984018083, 33.52369023781165, 8.797828353127633, -8.536042032859532, 21.473839780582328, 18.718487119698032, -2.4545007144366346, -1.0520977800190234, 6.75710913097668, -2.763432400235981, 25.391185520856453, 0.6115785818429114, 4.99321703213465, -6.484606590124809, 26.727225220575995, -4.171189902262353, 32.182319713873135, 13.100480254800232, -6.790809701802786, -13.072562586115305, 16.872117024050155, 8.100334885062367, 27.169460529565942, 29.650613196522407, 6.267945725463594, 7.129233835944426, -1.650047989149268, 2.369028198713968, -7.548929050025448, -0.48836143483635297, -0.7930285526843885, 20.43791790269577, 28.72920065457987, 30.129099749422483, 40.29086025920331, 37.146927126850855, 4.563298249222844, 10.168941932405012, -6.930333412621872, -1.6578449360788987, 0.6736736933096665, -3.3486970662582127, 33.8800912480059, 19.097592228846946, 24.294238022260338, 28.05801608257225, 20.23383093674025, -13.105929030824086, 41.26661739343024, 42.235890723528826, 53.66058853801053, 34.17849847797359, 28.28239788903471, 0.3881205892103545, 24.811629169905174, -7.762407459926806, -12.904755556396413, -7.141373484138031, 36.72320514007308, 5.61130246153968, 8.677703260349654, 4.816416483962309, 13.298153591036415, 29.3685840691372, 28.83439872856951, 22.115620410168297, 13.244491922502977, 15.080239889622959, 18.248213964481536, 1.719755373365306, -0.2077160084659493, 0.32473738134054564, 12.529441059810342, 1.8573909468516767, 17.746583884547213, -13.545801074042645, -15.144658309934627, 3.5920130414281957, -0.26469139889466575, 0.8115204746047482, 32.450420226727175, 34.785543095611615, 16.691419394100972, 7.329778839914528, 21.27979242719506, 33.19157594965257, 33.942982927471654, 9.398117581326781, 7.525541412717978, 14.497352100681214, 20.547395973830675, 8.353923153830477, 26.57887254951084, 14.91168134297433, 45.57546678143624, 16.408405579243293, 20.734168336469224, 7.315082820020628, 47.02286099573557, -8.569398228661663, 8.372625738457415, 23.42031127092732, 34.24096586537247, 24.933748967555296, 4.664689000868951, -9.229884716601054, -24.480225966598653, -6.113896993140834, 4.969921698659244, 9.837810860342632, 24.363419492808944, 31.16418556093482, 7.064661892114961, 27.319467466586346, 5.163382333542449, 10.824263636023357, 5.121777868829708, 8.180294192022835, 32.78159921036327, 17.935158600893207, 8.160995621075932, 28.22174794016175, 4.086618755880469, 20.854098104013154, 3.887876973918667, 29.86367790134499, 43.29512832222508, 30.00639413184744, 18.22753672145098, 33.385885968041244, 37.54782129107481, 10.084337316724174, -16.98106946431982, 0.694548975209214, 30.056546476920047, 17.28671375139933, 0.18091640996190073, 33.197364962955696, 18.185323399911915, 31.29366909954527, 22.99320568026541, 7.139721736538863, 22.068855216649087, 47.666445117344, -3.2614400106793546, -7.2109775443734065, 36.774710883672384, 10.632929359713934, 35.68827879176395, 40.92072208206227, 14.024328117376804, -1.451757017978629, 23.76727327220877, 37.232060141352044, 31.45701844355428, 7.896498050919838, 32.256465995335915, 20.686247891464244, -9.213236746156502, 9.721519810510015, 8.602880870106317, 8.797916755467922, 31.67131206726187, 31.027361185420563, 14.08421838393894, 18.315679088856356, 12.537242433309348, 30.716884549101863, 24.24470736423814, 33.10369842674224, 34.72116595492917, 39.26126703074437, 21.06125490928062, 13.210619323478348, 13.97592964036348, 30.847361436682323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6302480099972819, "mean_inference_ms": 1.6738185598750985, "mean_action_processing_ms": 0.25853594620530573, "mean_env_wait_ms": 0.14566663892963763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007442593574523926, "StateBufferConnector_ms": 0.0032492876052856445, "ViewRequirementAgentConnector_ms": 0.12227940559387207}, "num_episodes": 18, "episode_return_max": 43.91954350799202, "episode_return_min": -15.297061479869733, "episode_return_mean": 15.223744761381278, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.4003173343108, "num_env_steps_trained_throughput_per_sec": 377.4003173343108, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 10798.663, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10798.394, "sample_time_ms": 1300.965, "learn_time_ms": 9476.645, "learn_throughput": 422.09, "synch_weights_time_ms": 18.899}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 106, "trial_id": "06536_00000", "date": "2024-08-11_17-33-24", "timestamp": 1723412004, "time_this_iter_s": 10.69588017463684, "time_total_s": 3545.533121585846, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33165cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3545.533121585846, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 45.49333333333334, "ram_util_percent": 83.11333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5670184676845866, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6308169423912962, "policy_loss": -0.0061046042338906165, "vf_loss": 1.636916622519493, "vf_explained_var": 0.9598278018335501, "kl": 0.006298535103699365, "entropy": 0.5002155972023805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.832914461976006, "cur_kl_coeff": 4.163336342344336e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2136707999088148, "policy_loss": -0.002999580880656602, "vf_loss": 2.216670375967783, "vf_explained_var": 0.9520760744021683, "kl": 0.0038874314210640627, "entropy": 0.24158029061934305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "env_runners": {"episode_reward_max": 56.740421062573105, "episode_reward_min": -15.297061479869733, "episode_reward_mean": 15.80884090159584, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.74042106257304, "predator_policy": -24.480225966598653}, "policy_reward_max": {"prey_policy": 15.297061479869736, "predator_policy": 56.95842190688271}, "policy_reward_mean": {"prey_policy": -15.808840901595836, "predator_policy": 15.808840901595836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.486225954556287, 28.410036863044166, 6.69858978070401, 0.35949010478235266, -4.018645242430896, 9.82244467500568, 29.429150202001182, 38.71889369302704, 7.366120090813907, -4.294089174350406, -1.3375116864742758, 26.488841738426405, 26.176127052416284, 3.5639509529580913, 41.751254058479525, 43.91954350799202, 14.335259239122538, 8.524610854989183, -10.023064520267226, 21.167253800806385, 6.747059872155997, 21.333368830086798, 25.47500956936893, 14.162365906062993, 9.983984668923435, 0.05851068643730617, 7.193416003331015, 2.1003914052522905, -5.776322634253223, 0.2734145378550572, 33.6179816611694, 12.01059911700774, 27.23568418842385, 21.670550254399256, 11.01144675669959, 14.450659563830575, 20.745276946242537, 30.99193618033977, 14.024625578244928, 19.226731383536922, 15.896468504692375, 29.587357416463927, -2.282597857866051, -15.297061479869733, 7.403866279500937, 27.763802526871938, 17.19206467935068, 7.993822984782886, 6.651036030426274, 25.35837890562824, 18.191371780618827, 12.470358429946833, 16.87577743763183, 36.650761227036256, 25.80671134474609, 23.81607930389954, -8.143260244555304, 23.67163011415967, 16.68914068645881, 24.739496249728624, 15.066463708402148, 34.86765016699654, -5.23620877752638, 23.703820121693145, 38.304500436913095, 6.28628554969909, 30.499666706780445, 19.676758247237057, 26.47135694340009, 0.25414153217676994, 8.70039881278714, 31.34933662634121, 16.19994873639764, 21.62706349120562, 28.674202895490197, 36.99121649283675, 17.135937116379484, 22.411645538522897, 5.4446931487905115, 24.024518255693796, 18.10677804885068, 23.241423436037802, 8.63456372023599, 10.435935054000733, 13.371673688567062, 5.313528690134774, 4.474826234834985, 56.740421062573105, 9.05694829917263, 0.21807708104606238, -8.128801906528297, 25.478312913089542, 22.50712935904464, 15.938898664314799, 14.700582109497258, 10.726923862951567, 16.640429402853037, 12.35797799709506, 15.721808609158657, 5.776881342066331], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.486225954556243, -28.41003686304417, -6.6985897807040145, -0.35949010478235, 4.018645242430898, -9.822444675005686, -29.42915020200115, -38.71889369302707, -7.366120090813938, 4.294089174350381, 1.3375116864742722, -26.4888417384264, -26.176127052416284, -3.5639509529580806, -41.75125405847956, -43.919543507992046, -14.335259239122541, -8.524610854989199, 10.023064520267225, -21.167253800806385, -6.7470598721559885, -21.3333688300868, -25.475009569368904, -14.16236590606297, -9.983984668923412, -0.058510686437293735, -7.193416003330999, -2.100391405252295, 5.776322634253205, -0.2734145378550288, -33.617981661169395, -12.010599117007757, -27.235684188423804, -21.67055025439922, -11.011446756699593, -14.450659563830566, -20.7452769462426, -30.99193618033977, -14.024625578244915, -19.22673138353694, -15.896468504692368, -29.587357416463895, 2.2825978578660524, 15.297061479869736, -7.403866279500934, -27.76380252687185, -17.192064679350644, -7.993822984782902, -6.651036030426275, -25.358378905628243, -18.19137178061888, -12.47035842994682, -16.875777437631832, -36.65076122703627, -25.806711344746127, -23.816079303899464, 8.1432602445553, -23.671630114159687, -16.68914068645881, -24.739496249728568, -15.066463708402132, -34.86765016699658, 5.236208777526382, -23.70382012169318, -38.30450043691311, -6.286285549699084, -30.49966670678038, -19.67675824723706, -26.471356943400085, -0.25414153217676105, -8.700398812787121, -31.349336626341223, -16.199948736397644, -21.627063491205607, -28.674202895490172, -36.99121649283678, -17.135937116379473, -22.41164553852291, -5.4446931487905035, -24.024518255693767, -18.10677804885067, -23.241423436037806, -8.634563720235995, -10.435935054000732, -13.371673688567064, -5.313528690134797, -4.474826234834983, -56.74042106257304, -9.056948299172625, -0.2180770810460766, 8.12880190652831, -25.478312913089535, -22.50712935904466, -15.938898664314777, -14.700582109497244, -10.726923862951562, -16.64042940285303, -12.357977997095048, -15.721808609158685, -5.77688134206633], "policy_predator_policy_reward": [16.872117024050155, 8.100334885062367, 27.169460529565942, 29.650613196522407, 6.267945725463594, 7.129233835944426, -1.650047989149268, 2.369028198713968, -7.548929050025448, -0.48836143483635297, -0.7930285526843885, 20.43791790269577, 28.72920065457987, 30.129099749422483, 40.29086025920331, 37.146927126850855, 4.563298249222844, 10.168941932405012, -6.930333412621872, -1.6578449360788987, 0.6736736933096665, -3.3486970662582127, 33.8800912480059, 19.097592228846946, 24.294238022260338, 28.05801608257225, 20.23383093674025, -13.105929030824086, 41.26661739343024, 42.235890723528826, 53.66058853801053, 34.17849847797359, 28.28239788903471, 0.3881205892103545, 24.811629169905174, -7.762407459926806, -12.904755556396413, -7.141373484138031, 36.72320514007308, 5.61130246153968, 8.677703260349654, 4.816416483962309, 13.298153591036415, 29.3685840691372, 28.83439872856951, 22.115620410168297, 13.244491922502977, 15.080239889622959, 18.248213964481536, 1.719755373365306, -0.2077160084659493, 0.32473738134054564, 12.529441059810342, 1.8573909468516767, 17.746583884547213, -13.545801074042645, -15.144658309934627, 3.5920130414281957, -0.26469139889466575, 0.8115204746047482, 32.450420226727175, 34.785543095611615, 16.691419394100972, 7.329778839914528, 21.27979242719506, 33.19157594965257, 33.942982927471654, 9.398117581326781, 7.525541412717978, 14.497352100681214, 20.547395973830675, 8.353923153830477, 26.57887254951084, 14.91168134297433, 45.57546678143624, 16.408405579243293, 20.734168336469224, 7.315082820020628, 47.02286099573557, -8.569398228661663, 8.372625738457415, 23.42031127092732, 34.24096586537247, 24.933748967555296, 4.664689000868951, -9.229884716601054, -24.480225966598653, -6.113896993140834, 4.969921698659244, 9.837810860342632, 24.363419492808944, 31.16418556093482, 7.064661892114961, 27.319467466586346, 5.163382333542449, 10.824263636023357, 5.121777868829708, 8.180294192022835, 32.78159921036327, 17.935158600893207, 8.160995621075932, 28.22174794016175, 4.086618755880469, 20.854098104013154, 3.887876973918667, 29.86367790134499, 43.29512832222508, 30.00639413184744, 18.22753672145098, 33.385885968041244, 37.54782129107481, 10.084337316724174, -16.98106946431982, 0.694548975209214, 30.056546476920047, 17.28671375139933, 0.18091640996190073, 33.197364962955696, 18.185323399911915, 31.29366909954527, 22.99320568026541, 7.139721736538863, 22.068855216649087, 47.666445117344, -3.2614400106793546, -7.2109775443734065, 36.774710883672384, 10.632929359713934, 35.68827879176395, 40.92072208206227, 14.024328117376804, -1.451757017978629, 23.76727327220877, 37.232060141352044, 31.45701844355428, 7.896498050919838, 32.256465995335915, 20.686247891464244, -9.213236746156502, 9.721519810510015, 8.602880870106317, 8.797916755467922, 31.67131206726187, 31.027361185420563, 14.08421838393894, 18.315679088856356, 12.537242433309348, 30.716884549101863, 24.24470736423814, 33.10369842674224, 34.72116595492917, 39.26126703074437, 21.06125490928062, 13.210619323478348, 13.97592964036348, 30.847361436682323, 14.271073117634177, -3.38168682005317, 31.808460490015296, 16.24057602137226, 31.528068614178103, 4.685487483523206, 26.206844849798156, 20.276002022277474, 14.482257887931942, 2.786869552540078, 17.578586430289644, 3.293283677711827, 11.595995644058117, 15.147351733076038, 10.924530275880034, -0.2974728956105075, 5.567176494565011, 3.3824759751049416, 56.522420218263406, 56.95842190688271, 12.38401518467687, 5.729881413668378, -9.806254217737465, 10.242408379829577, -7.964689140932485, -8.292914672124132, 30.644426196551592, 20.31219962962747, 21.59693669891299, 23.417322019176353, 16.814817372691888, 15.0629799559377, 7.741921605013203, 21.659242613981295, 13.810492062793562, 7.643355663109551, 17.300542203248526, 15.980316602457533, 12.784586965718075, 11.93136902847203, 9.841700155815229, 21.60191706250213, 16.806039014200948, -5.252276330068299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6304262132494397, "mean_inference_ms": 1.6728571899330666, "mean_action_processing_ms": 0.258458178948805, "mean_env_wait_ms": 0.14572124002007159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006334424018859863, "StateBufferConnector_ms": 0.002986431121826172, "ViewRequirementAgentConnector_ms": 0.1099468469619751}, "num_episodes": 22, "episode_return_max": 56.740421062573105, "episode_return_min": -15.297061479869733, "episode_return_mean": 15.80884090159584, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.69732665215275, "num_env_steps_trained_throughput_per_sec": 355.69732665215275, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 10842.429, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10842.16, "sample_time_ms": 1326.331, "learn_time_ms": 9495.486, "learn_throughput": 421.253, "synch_weights_time_ms": 18.506}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "training_iteration": 107, "trial_id": "06536_00000", "date": "2024-08-11_17-33-35", "timestamp": 1723412015, "time_this_iter_s": 11.271411895751953, "time_total_s": 3556.804533481598, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316dac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3556.804533481598, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 52.20625, "ram_util_percent": 83.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.75851913690567, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.164559098581473, "policy_loss": -0.006480929061459998, "vf_loss": 2.171035389850537, "vf_explained_var": 0.9442467889438073, "kl": 0.005933678848823032, "entropy": 0.4722571675044795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.913554770795126, "cur_kl_coeff": 2.081668171172168e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.595777787922551, "policy_loss": -0.0028113822472434513, "vf_loss": 2.598589174709623, "vf_explained_var": 0.9384455178465162, "kl": 0.00469424461925313, "entropy": 0.24071310516545383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 56.740421062573105, "episode_reward_min": -15.297061479869733, "episode_reward_mean": 15.500606174134413, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.74042106257304, "predator_policy": -24.480225966598653}, "policy_reward_max": {"prey_policy": 15.297061479869736, "predator_policy": 56.95842190688271}, "policy_reward_mean": {"prey_policy": -15.50060617413441, "predator_policy": 15.50060617413441}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.023064520267226, 21.167253800806385, 6.747059872155997, 21.333368830086798, 25.47500956936893, 14.162365906062993, 9.983984668923435, 0.05851068643730617, 7.193416003331015, 2.1003914052522905, -5.776322634253223, 0.2734145378550572, 33.6179816611694, 12.01059911700774, 27.23568418842385, 21.670550254399256, 11.01144675669959, 14.450659563830575, 20.745276946242537, 30.99193618033977, 14.024625578244928, 19.226731383536922, 15.896468504692375, 29.587357416463927, -2.282597857866051, -15.297061479869733, 7.403866279500937, 27.763802526871938, 17.19206467935068, 7.993822984782886, 6.651036030426274, 25.35837890562824, 18.191371780618827, 12.470358429946833, 16.87577743763183, 36.650761227036256, 25.80671134474609, 23.81607930389954, -8.143260244555304, 23.67163011415967, 16.68914068645881, 24.739496249728624, 15.066463708402148, 34.86765016699654, -5.23620877752638, 23.703820121693145, 38.304500436913095, 6.28628554969909, 30.499666706780445, 19.676758247237057, 26.47135694340009, 0.25414153217676994, 8.70039881278714, 31.34933662634121, 16.19994873639764, 21.62706349120562, 28.674202895490197, 36.99121649283675, 17.135937116379484, 22.411645538522897, 5.4446931487905115, 24.024518255693796, 18.10677804885068, 23.241423436037802, 8.63456372023599, 10.435935054000733, 13.371673688567062, 5.313528690134774, 4.474826234834985, 56.740421062573105, 9.05694829917263, 0.21807708104606238, -8.128801906528297, 25.478312913089542, 22.50712935904464, 15.938898664314799, 14.700582109497258, 10.726923862951567, 16.640429402853037, 12.35797799709506, 15.721808609158657, 5.776881342066331, 27.5498295412595, 12.779292072836961, 18.382049524172167, 14.452211559962354, 15.7631150618817, 10.262156060231261, 10.247821265048735, 13.697705107991519, 26.86460583648077, 18.024329464740433, 12.767011901469722, 17.272945636225003, 8.20105183774797, 18.36222122082781, -6.6559461181169315, 25.149072530498003, 6.10873004494316, 8.348617370720596], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.023064520267225, -21.167253800806385, -6.7470598721559885, -21.3333688300868, -25.475009569368904, -14.16236590606297, -9.983984668923412, -0.058510686437293735, -7.193416003330999, -2.100391405252295, 5.776322634253205, -0.2734145378550288, -33.617981661169395, -12.010599117007757, -27.235684188423804, -21.67055025439922, -11.011446756699593, -14.450659563830566, -20.7452769462426, -30.99193618033977, -14.024625578244915, -19.22673138353694, -15.896468504692368, -29.587357416463895, 2.2825978578660524, 15.297061479869736, -7.403866279500934, -27.76380252687185, -17.192064679350644, -7.993822984782902, -6.651036030426275, -25.358378905628243, -18.19137178061888, -12.47035842994682, -16.875777437631832, -36.65076122703627, -25.806711344746127, -23.816079303899464, 8.1432602445553, -23.671630114159687, -16.68914068645881, -24.739496249728568, -15.066463708402132, -34.86765016699658, 5.236208777526382, -23.70382012169318, -38.30450043691311, -6.286285549699084, -30.49966670678038, -19.67675824723706, -26.471356943400085, -0.25414153217676105, -8.700398812787121, -31.349336626341223, -16.199948736397644, -21.627063491205607, -28.674202895490172, -36.99121649283678, -17.135937116379473, -22.41164553852291, -5.4446931487905035, -24.024518255693767, -18.10677804885067, -23.241423436037806, -8.634563720235995, -10.435935054000732, -13.371673688567064, -5.313528690134797, -4.474826234834983, -56.74042106257304, -9.056948299172625, -0.2180770810460766, 8.12880190652831, -25.478312913089535, -22.50712935904466, -15.938898664314777, -14.700582109497244, -10.726923862951562, -16.64042940285303, -12.357977997095048, -15.721808609158685, -5.77688134206633, -27.54982954125952, -12.77929207283696, -18.382049524172107, -14.45221155996236, -15.76311506188171, -10.262156060231273, -10.247821265048726, -13.697705107991524, -26.86460583648075, -18.024329464740433, -12.76701190146976, -17.272945636224982, -8.20105183774799, -18.362221220827806, 6.655946118116936, -25.149072530498035, -6.1087300449431545, -8.348617370720595], "policy_predator_policy_reward": [-12.904755556396413, -7.141373484138031, 36.72320514007308, 5.61130246153968, 8.677703260349654, 4.816416483962309, 13.298153591036415, 29.3685840691372, 28.83439872856951, 22.115620410168297, 13.244491922502977, 15.080239889622959, 18.248213964481536, 1.719755373365306, -0.2077160084659493, 0.32473738134054564, 12.529441059810342, 1.8573909468516767, 17.746583884547213, -13.545801074042645, -15.144658309934627, 3.5920130414281957, -0.26469139889466575, 0.8115204746047482, 32.450420226727175, 34.785543095611615, 16.691419394100972, 7.329778839914528, 21.27979242719506, 33.19157594965257, 33.942982927471654, 9.398117581326781, 7.525541412717978, 14.497352100681214, 20.547395973830675, 8.353923153830477, 26.57887254951084, 14.91168134297433, 45.57546678143624, 16.408405579243293, 20.734168336469224, 7.315082820020628, 47.02286099573557, -8.569398228661663, 8.372625738457415, 23.42031127092732, 34.24096586537247, 24.933748967555296, 4.664689000868951, -9.229884716601054, -24.480225966598653, -6.113896993140834, 4.969921698659244, 9.837810860342632, 24.363419492808944, 31.16418556093482, 7.064661892114961, 27.319467466586346, 5.163382333542449, 10.824263636023357, 5.121777868829708, 8.180294192022835, 32.78159921036327, 17.935158600893207, 8.160995621075932, 28.22174794016175, 4.086618755880469, 20.854098104013154, 3.887876973918667, 29.86367790134499, 43.29512832222508, 30.00639413184744, 18.22753672145098, 33.385885968041244, 37.54782129107481, 10.084337316724174, -16.98106946431982, 0.694548975209214, 30.056546476920047, 17.28671375139933, 0.18091640996190073, 33.197364962955696, 18.185323399911915, 31.29366909954527, 22.99320568026541, 7.139721736538863, 22.068855216649087, 47.666445117344, -3.2614400106793546, -7.2109775443734065, 36.774710883672384, 10.632929359713934, 35.68827879176395, 40.92072208206227, 14.024328117376804, -1.451757017978629, 23.76727327220877, 37.232060141352044, 31.45701844355428, 7.896498050919838, 32.256465995335915, 20.686247891464244, -9.213236746156502, 9.721519810510015, 8.602880870106317, 8.797916755467922, 31.67131206726187, 31.027361185420563, 14.08421838393894, 18.315679088856356, 12.537242433309348, 30.716884549101863, 24.24470736423814, 33.10369842674224, 34.72116595492917, 39.26126703074437, 21.06125490928062, 13.210619323478348, 13.97592964036348, 30.847361436682323, 14.271073117634177, -3.38168682005317, 31.808460490015296, 16.24057602137226, 31.528068614178103, 4.685487483523206, 26.206844849798156, 20.276002022277474, 14.482257887931942, 2.786869552540078, 17.578586430289644, 3.293283677711827, 11.595995644058117, 15.147351733076038, 10.924530275880034, -0.2974728956105075, 5.567176494565011, 3.3824759751049416, 56.522420218263406, 56.95842190688271, 12.38401518467687, 5.729881413668378, -9.806254217737465, 10.242408379829577, -7.964689140932485, -8.292914672124132, 30.644426196551592, 20.31219962962747, 21.59693669891299, 23.417322019176353, 16.814817372691888, 15.0629799559377, 7.741921605013203, 21.659242613981295, 13.810492062793562, 7.643355663109551, 17.300542203248526, 15.980316602457533, 12.784586965718075, 11.93136902847203, 9.841700155815229, 21.60191706250213, 16.806039014200948, -5.252276330068299, 29.379493648126747, 25.720165434392307, 1.2662941309178048, 24.292290014756144, 7.306014372204648, 29.45808467613959, 27.23638386235575, 1.6680392575689784, -3.4776644179113116, 35.003894541674676, 5.224177274960491, 15.300134845502052, 12.603005500840553, 7.892637029256887, 25.882161906429737, 1.5132483095533198, 29.311601620829865, 24.417610052131643, 14.553854530647468, 21.49480439883338, 2.7979909270292946, 22.7360328759102, 16.765669538784643, 17.780221733665307, -1.2336131916036175, 17.63571686709959, 10.973201969049832, 25.751240472605804, -11.186968913956626, -2.124923322277251, 36.58344489255597, 13.714700168440114, -1.6876715277825092, 13.905131617668836, 10.24456654512833, 6.452668196312862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6303613710347209, "mean_inference_ms": 1.6742495838621607, "mean_action_processing_ms": 0.25861239384950446, "mean_env_wait_ms": 0.14581386773702212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006070137023925781, "StateBufferConnector_ms": 0.0028524398803710938, "ViewRequirementAgentConnector_ms": 0.10413002967834473}, "num_episodes": 18, "episode_return_max": 56.740421062573105, "episode_return_min": -15.297061479869733, "episode_return_mean": 15.500606174134413, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.99938034149193, "num_env_steps_trained_throughput_per_sec": 370.99938034149193, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 10830.343, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10830.073, "sample_time_ms": 1299.646, "learn_time_ms": 9506.038, "learn_throughput": 420.785, "synch_weights_time_ms": 22.371}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 108, "trial_id": "06536_00000", "date": "2024-08-11_17-33-46", "timestamp": 1723412026, "time_this_iter_s": 10.838234901428223, "time_total_s": 3567.642768383026, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331714430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3567.642768383026, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 47.279999999999994, "ram_util_percent": 82.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8190633433560532, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2958162343750397, "policy_loss": -0.00785641521360958, "vf_loss": 2.3036675702780487, "vf_explained_var": 0.9437866566702724, "kl": 0.006503062211911698, "entropy": 0.4808046940093239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8946370076250147, "cur_kl_coeff": 1.040834085586084e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6444481910851896, "policy_loss": -0.0018960426917555865, "vf_loss": 2.6463442337576044, "vf_explained_var": 0.9428889466656579, "kl": 0.004444514961559129, "entropy": 0.2370761400808102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "env_runners": {"episode_reward_max": 56.740421062573105, "episode_reward_min": -15.297061479869733, "episode_reward_mean": 16.091067800412024, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.74042106257304, "predator_policy": -24.480225966598653}, "policy_reward_max": {"prey_policy": 15.297061479869736, "predator_policy": 56.95842190688271}, "policy_reward_mean": {"prey_policy": -16.091067800412024, "predator_policy": 16.09106780041202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.745276946242537, 30.99193618033977, 14.024625578244928, 19.226731383536922, 15.896468504692375, 29.587357416463927, -2.282597857866051, -15.297061479869733, 7.403866279500937, 27.763802526871938, 17.19206467935068, 7.993822984782886, 6.651036030426274, 25.35837890562824, 18.191371780618827, 12.470358429946833, 16.87577743763183, 36.650761227036256, 25.80671134474609, 23.81607930389954, -8.143260244555304, 23.67163011415967, 16.68914068645881, 24.739496249728624, 15.066463708402148, 34.86765016699654, -5.23620877752638, 23.703820121693145, 38.304500436913095, 6.28628554969909, 30.499666706780445, 19.676758247237057, 26.47135694340009, 0.25414153217676994, 8.70039881278714, 31.34933662634121, 16.19994873639764, 21.62706349120562, 28.674202895490197, 36.99121649283675, 17.135937116379484, 22.411645538522897, 5.4446931487905115, 24.024518255693796, 18.10677804885068, 23.241423436037802, 8.63456372023599, 10.435935054000733, 13.371673688567062, 5.313528690134774, 4.474826234834985, 56.740421062573105, 9.05694829917263, 0.21807708104606238, -8.128801906528297, 25.478312913089542, 22.50712935904464, 15.938898664314799, 14.700582109497258, 10.726923862951567, 16.640429402853037, 12.35797799709506, 15.721808609158657, 5.776881342066331, 27.5498295412595, 12.779292072836961, 18.382049524172167, 14.452211559962354, 15.7631150618817, 10.262156060231261, 10.247821265048735, 13.697705107991519, 26.86460583648077, 18.024329464740433, 12.767011901469722, 17.272945636225003, 8.20105183774797, 18.36222122082781, -6.6559461181169315, 25.149072530498003, 6.10873004494316, 8.348617370720596, 13.620182361172668, 10.63815899569681, 20.791250310002575, 25.099122252633205, 11.067191581827524, 36.981950869254135, 12.621525084979474, -12.26384596447764, 13.230226446074713, 8.72837947202878, 20.287443311979576, -7.721392464545269, 11.195564771758734, 35.35329689061671, 11.775166004644875, 18.531798053222868, 22.786009577555394, 19.016444740625865], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.7452769462426, -30.99193618033977, -14.024625578244915, -19.22673138353694, -15.896468504692368, -29.587357416463895, 2.2825978578660524, 15.297061479869736, -7.403866279500934, -27.76380252687185, -17.192064679350644, -7.993822984782902, -6.651036030426275, -25.358378905628243, -18.19137178061888, -12.47035842994682, -16.875777437631832, -36.65076122703627, -25.806711344746127, -23.816079303899464, 8.1432602445553, -23.671630114159687, -16.68914068645881, -24.739496249728568, -15.066463708402132, -34.86765016699658, 5.236208777526382, -23.70382012169318, -38.30450043691311, -6.286285549699084, -30.49966670678038, -19.67675824723706, -26.471356943400085, -0.25414153217676105, -8.700398812787121, -31.349336626341223, -16.199948736397644, -21.627063491205607, -28.674202895490172, -36.99121649283678, -17.135937116379473, -22.41164553852291, -5.4446931487905035, -24.024518255693767, -18.10677804885067, -23.241423436037806, -8.634563720235995, -10.435935054000732, -13.371673688567064, -5.313528690134797, -4.474826234834983, -56.74042106257304, -9.056948299172625, -0.2180770810460766, 8.12880190652831, -25.478312913089535, -22.50712935904466, -15.938898664314777, -14.700582109497244, -10.726923862951562, -16.64042940285303, -12.357977997095048, -15.721808609158685, -5.77688134206633, -27.54982954125952, -12.77929207283696, -18.382049524172107, -14.45221155996236, -15.76311506188171, -10.262156060231273, -10.247821265048726, -13.697705107991524, -26.86460583648075, -18.024329464740433, -12.76701190146976, -17.272945636224982, -8.20105183774799, -18.362221220827806, 6.655946118116936, -25.149072530498035, -6.1087300449431545, -8.348617370720595, -13.62018236117266, -10.638158995696806, -20.791250310002575, -25.099122252633233, -11.067191581827519, -36.98195086925412, -12.621525084979476, 12.263845964477639, -13.230226446074715, -8.728379472028797, -20.287443311979615, 7.721392464545274, -11.195564771758724, -35.3532968906167, -11.775166004644898, -18.531798053222886, -22.7860095775554, -19.016444740625857], "policy_predator_policy_reward": [26.57887254951084, 14.91168134297433, 45.57546678143624, 16.408405579243293, 20.734168336469224, 7.315082820020628, 47.02286099573557, -8.569398228661663, 8.372625738457415, 23.42031127092732, 34.24096586537247, 24.933748967555296, 4.664689000868951, -9.229884716601054, -24.480225966598653, -6.113896993140834, 4.969921698659244, 9.837810860342632, 24.363419492808944, 31.16418556093482, 7.064661892114961, 27.319467466586346, 5.163382333542449, 10.824263636023357, 5.121777868829708, 8.180294192022835, 32.78159921036327, 17.935158600893207, 8.160995621075932, 28.22174794016175, 4.086618755880469, 20.854098104013154, 3.887876973918667, 29.86367790134499, 43.29512832222508, 30.00639413184744, 18.22753672145098, 33.385885968041244, 37.54782129107481, 10.084337316724174, -16.98106946431982, 0.694548975209214, 30.056546476920047, 17.28671375139933, 0.18091640996190073, 33.197364962955696, 18.185323399911915, 31.29366909954527, 22.99320568026541, 7.139721736538863, 22.068855216649087, 47.666445117344, -3.2614400106793546, -7.2109775443734065, 36.774710883672384, 10.632929359713934, 35.68827879176395, 40.92072208206227, 14.024328117376804, -1.451757017978629, 23.76727327220877, 37.232060141352044, 31.45701844355428, 7.896498050919838, 32.256465995335915, 20.686247891464244, -9.213236746156502, 9.721519810510015, 8.602880870106317, 8.797916755467922, 31.67131206726187, 31.027361185420563, 14.08421838393894, 18.315679088856356, 12.537242433309348, 30.716884549101863, 24.24470736423814, 33.10369842674224, 34.72116595492917, 39.26126703074437, 21.06125490928062, 13.210619323478348, 13.97592964036348, 30.847361436682323, 14.271073117634177, -3.38168682005317, 31.808460490015296, 16.24057602137226, 31.528068614178103, 4.685487483523206, 26.206844849798156, 20.276002022277474, 14.482257887931942, 2.786869552540078, 17.578586430289644, 3.293283677711827, 11.595995644058117, 15.147351733076038, 10.924530275880034, -0.2974728956105075, 5.567176494565011, 3.3824759751049416, 56.522420218263406, 56.95842190688271, 12.38401518467687, 5.729881413668378, -9.806254217737465, 10.242408379829577, -7.964689140932485, -8.292914672124132, 30.644426196551592, 20.31219962962747, 21.59693669891299, 23.417322019176353, 16.814817372691888, 15.0629799559377, 7.741921605013203, 21.659242613981295, 13.810492062793562, 7.643355663109551, 17.300542203248526, 15.980316602457533, 12.784586965718075, 11.93136902847203, 9.841700155815229, 21.60191706250213, 16.806039014200948, -5.252276330068299, 29.379493648126747, 25.720165434392307, 1.2662941309178048, 24.292290014756144, 7.306014372204648, 29.45808467613959, 27.23638386235575, 1.6680392575689784, -3.4776644179113116, 35.003894541674676, 5.224177274960491, 15.300134845502052, 12.603005500840553, 7.892637029256887, 25.882161906429737, 1.5132483095533198, 29.311601620829865, 24.417610052131643, 14.553854530647468, 21.49480439883338, 2.7979909270292946, 22.7360328759102, 16.765669538784643, 17.780221733665307, -1.2336131916036175, 17.63571686709959, 10.973201969049832, 25.751240472605804, -11.186968913956626, -2.124923322277251, 36.58344489255597, 13.714700168440114, -1.6876715277825092, 13.905131617668836, 10.24456654512833, 6.452668196312862, 25.77051932665103, 1.4698453956942892, 11.119035677222957, 10.157282314170654, 10.831821928067935, 30.75067869193721, 29.384539035708116, 20.813705469558325, 18.640118216527277, 3.4942649471277782, 35.83047232614748, 38.133429412360734, 13.077885758688655, 12.165164411270293, -14.505729507326542, -10.021962421628732, 16.679163670085234, 9.78128922206422, 1.5728497183909145, 15.88390922566667, 6.323536399524913, 34.25135022443423, -4.853660217702753, -10.58912471138779, 15.433781447894985, 6.957348095622472, 30.951519295717027, 39.755074485516296, 2.678357056899026, 20.87197495239078, 23.496113073836955, 13.5674830326088, 14.993995040752829, 30.57802411435799, 35.6473000707456, 2.3855894105061424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6302734340685606, "mean_inference_ms": 1.6738893243134663, "mean_action_processing_ms": 0.2585665332198744, "mean_env_wait_ms": 0.14586465564161513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004591703414916992, "StateBufferConnector_ms": 0.0028716325759887695, "ViewRequirementAgentConnector_ms": 0.08269369602203369}, "num_episodes": 18, "episode_return_max": 56.740421062573105, "episode_return_min": -15.297061479869733, "episode_return_mean": 16.091067800412024, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.6456547867408, "num_env_steps_trained_throughput_per_sec": 368.6456547867408, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 10935.639, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10935.38, "sample_time_ms": 1308.915, "learn_time_ms": 9603.377, "learn_throughput": 416.52, "synch_weights_time_ms": 21.267}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "training_iteration": 109, "trial_id": "06536_00000", "date": "2024-08-11_17-33-57", "timestamp": 1723412037, "time_this_iter_s": 10.887322902679443, "time_total_s": 3578.5300912857056, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3578.5300912857056, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 47.85000000000001, "ram_util_percent": 82.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7395619223515193, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1328124423821766, "policy_loss": -0.0051824662625828445, "vf_loss": 2.137990133712689, "vf_explained_var": 0.9390520998587211, "kl": 0.006104946864944753, "entropy": 0.4944233061745763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.024259590471863, "cur_kl_coeff": 5.20417042793042e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.730940154683653, "policy_loss": -0.0015821068640059185, "vf_loss": 2.7325222637287525, "vf_explained_var": 0.9395626453810899, "kl": 0.0014987701651713395, "entropy": 0.22715868074742573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 56.740421062573105, "episode_reward_min": -12.26384596447764, "episode_reward_mean": 15.744810831500445, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.74042106257304, "predator_policy": -14.505729507326542}, "policy_reward_max": {"prey_policy": 12.263845964477639, "predator_policy": 56.95842190688271}, "policy_reward_mean": {"prey_policy": -15.744810831500443, "predator_policy": 15.74481083150044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.739496249728624, 15.066463708402148, 34.86765016699654, -5.23620877752638, 23.703820121693145, 38.304500436913095, 6.28628554969909, 30.499666706780445, 19.676758247237057, 26.47135694340009, 0.25414153217676994, 8.70039881278714, 31.34933662634121, 16.19994873639764, 21.62706349120562, 28.674202895490197, 36.99121649283675, 17.135937116379484, 22.411645538522897, 5.4446931487905115, 24.024518255693796, 18.10677804885068, 23.241423436037802, 8.63456372023599, 10.435935054000733, 13.371673688567062, 5.313528690134774, 4.474826234834985, 56.740421062573105, 9.05694829917263, 0.21807708104606238, -8.128801906528297, 25.478312913089542, 22.50712935904464, 15.938898664314799, 14.700582109497258, 10.726923862951567, 16.640429402853037, 12.35797799709506, 15.721808609158657, 5.776881342066331, 27.5498295412595, 12.779292072836961, 18.382049524172167, 14.452211559962354, 15.7631150618817, 10.262156060231261, 10.247821265048735, 13.697705107991519, 26.86460583648077, 18.024329464740433, 12.767011901469722, 17.272945636225003, 8.20105183774797, 18.36222122082781, -6.6559461181169315, 25.149072530498003, 6.10873004494316, 8.348617370720596, 13.620182361172668, 10.63815899569681, 20.791250310002575, 25.099122252633205, 11.067191581827524, 36.981950869254135, 12.621525084979474, -12.26384596447764, 13.230226446074713, 8.72837947202878, 20.287443311979576, -7.721392464545269, 11.195564771758734, 35.35329689061671, 11.775166004644875, 18.531798053222868, 22.786009577555394, 19.016444740625865, 36.42187891668181, 12.270495046679045, 17.807951121669394, 30.775016628658854, -5.791066214386203, 21.851926813839576, -3.0254064456795913, 7.64625368148931, 23.567127744065633, 23.13007148018879, 1.0661300515321912, 22.412642936145204, 9.661074937138647, 8.308490024581344, 28.481482892415602, 18.753021746156463, 21.061720841135156, 7.288994129563619, -6.596723613514374, 15.984866011696791, 17.728826763560278, -2.2372634294203673, 30.091069202933014], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.739496249728568, -15.066463708402132, -34.86765016699658, 5.236208777526382, -23.70382012169318, -38.30450043691311, -6.286285549699084, -30.49966670678038, -19.67675824723706, -26.471356943400085, -0.25414153217676105, -8.700398812787121, -31.349336626341223, -16.199948736397644, -21.627063491205607, -28.674202895490172, -36.99121649283678, -17.135937116379473, -22.41164553852291, -5.4446931487905035, -24.024518255693767, -18.10677804885067, -23.241423436037806, -8.634563720235995, -10.435935054000732, -13.371673688567064, -5.313528690134797, -4.474826234834983, -56.74042106257304, -9.056948299172625, -0.2180770810460766, 8.12880190652831, -25.478312913089535, -22.50712935904466, -15.938898664314777, -14.700582109497244, -10.726923862951562, -16.64042940285303, -12.357977997095048, -15.721808609158685, -5.77688134206633, -27.54982954125952, -12.77929207283696, -18.382049524172107, -14.45221155996236, -15.76311506188171, -10.262156060231273, -10.247821265048726, -13.697705107991524, -26.86460583648075, -18.024329464740433, -12.76701190146976, -17.272945636224982, -8.20105183774799, -18.362221220827806, 6.655946118116936, -25.149072530498035, -6.1087300449431545, -8.348617370720595, -13.62018236117266, -10.638158995696806, -20.791250310002575, -25.099122252633233, -11.067191581827519, -36.98195086925412, -12.621525084979476, 12.263845964477639, -13.230226446074715, -8.728379472028797, -20.287443311979615, 7.721392464545274, -11.195564771758724, -35.3532968906167, -11.775166004644898, -18.531798053222886, -22.7860095775554, -19.016444740625857, -36.42187891668184, -12.270495046679041, -17.80795112166935, -30.775016628658904, 5.791066214386186, -21.851926813839555, 3.025406445679586, -7.646253681489307, -23.567127744065665, -23.130071480188757, -1.0661300515321734, -22.412642936145232, -9.661074937138638, -8.308490024581365, -28.481482892415613, -18.753021746156406, -21.061720841135187, -7.288994129563616, 6.596723613514371, -15.98486601169677, -17.72882676356026, 2.2372634294203904, -30.09106920293306], "policy_predator_policy_reward": [18.185323399911915, 31.29366909954527, 22.99320568026541, 7.139721736538863, 22.068855216649087, 47.666445117344, -3.2614400106793546, -7.2109775443734065, 36.774710883672384, 10.632929359713934, 35.68827879176395, 40.92072208206227, 14.024328117376804, -1.451757017978629, 23.76727327220877, 37.232060141352044, 31.45701844355428, 7.896498050919838, 32.256465995335915, 20.686247891464244, -9.213236746156502, 9.721519810510015, 8.602880870106317, 8.797916755467922, 31.67131206726187, 31.027361185420563, 14.08421838393894, 18.315679088856356, 12.537242433309348, 30.716884549101863, 24.24470736423814, 33.10369842674224, 34.72116595492917, 39.26126703074437, 21.06125490928062, 13.210619323478348, 13.97592964036348, 30.847361436682323, 14.271073117634177, -3.38168682005317, 31.808460490015296, 16.24057602137226, 31.528068614178103, 4.685487483523206, 26.206844849798156, 20.276002022277474, 14.482257887931942, 2.786869552540078, 17.578586430289644, 3.293283677711827, 11.595995644058117, 15.147351733076038, 10.924530275880034, -0.2974728956105075, 5.567176494565011, 3.3824759751049416, 56.522420218263406, 56.95842190688271, 12.38401518467687, 5.729881413668378, -9.806254217737465, 10.242408379829577, -7.964689140932485, -8.292914672124132, 30.644426196551592, 20.31219962962747, 21.59693669891299, 23.417322019176353, 16.814817372691888, 15.0629799559377, 7.741921605013203, 21.659242613981295, 13.810492062793562, 7.643355663109551, 17.300542203248526, 15.980316602457533, 12.784586965718075, 11.93136902847203, 9.841700155815229, 21.60191706250213, 16.806039014200948, -5.252276330068299, 29.379493648126747, 25.720165434392307, 1.2662941309178048, 24.292290014756144, 7.306014372204648, 29.45808467613959, 27.23638386235575, 1.6680392575689784, -3.4776644179113116, 35.003894541674676, 5.224177274960491, 15.300134845502052, 12.603005500840553, 7.892637029256887, 25.882161906429737, 1.5132483095533198, 29.311601620829865, 24.417610052131643, 14.553854530647468, 21.49480439883338, 2.7979909270292946, 22.7360328759102, 16.765669538784643, 17.780221733665307, -1.2336131916036175, 17.63571686709959, 10.973201969049832, 25.751240472605804, -11.186968913956626, -2.124923322277251, 36.58344489255597, 13.714700168440114, -1.6876715277825092, 13.905131617668836, 10.24456654512833, 6.452668196312862, 25.77051932665103, 1.4698453956942892, 11.119035677222957, 10.157282314170654, 10.831821928067935, 30.75067869193721, 29.384539035708116, 20.813705469558325, 18.640118216527277, 3.4942649471277782, 35.83047232614748, 38.133429412360734, 13.077885758688655, 12.165164411270293, -14.505729507326542, -10.021962421628732, 16.679163670085234, 9.78128922206422, 1.5728497183909145, 15.88390922566667, 6.323536399524913, 34.25135022443423, -4.853660217702753, -10.58912471138779, 15.433781447894985, 6.957348095622472, 30.951519295717027, 39.755074485516296, 2.678357056899026, 20.87197495239078, 23.496113073836955, 13.5674830326088, 14.993995040752829, 30.57802411435799, 35.6473000707456, 2.3855894105061424, 45.22068634156279, 27.62307149180083, 0.4507049266356802, 24.090285166722392, 31.86443350098041, 3.7514687423583246, 20.77261455447932, 40.77741870283841, -6.559192602621412, -5.022939826150961, 16.966954631178687, 26.73689899650042, -1.4598020393517235, -4.591010852007445, 14.843973980094992, 0.4485333828836371, 19.295972937143873, 27.838282550987373, 35.345419835477294, 10.914723124900204, 9.82414415358514, -7.691884050520764, 10.337502293480163, 34.487783578810294, 22.792927409277087, -3.4707775349998267, 4.0279399422368165, 12.589040106925921, 37.99404817634815, 18.968917608483068, 23.26885205548591, 14.23719143682693, 10.1098994704786, 32.013542211791766, 0.8217700147883962, 13.756218244338832, -2.5379224430738017, -10.655524783954945, 25.89960914990026, 6.070122873493328, 25.16230983588317, 10.295343691237342, -1.880836881127264, -2.5936899777135167, 29.513091536959422, 30.669046868906648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6299384773666173, "mean_inference_ms": 1.6731186420221138, "mean_action_processing_ms": 0.2584586214880087, "mean_env_wait_ms": 0.14591043914771362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004784345626831055, "StateBufferConnector_ms": 0.002896904945373535, "ViewRequirementAgentConnector_ms": 0.08230710029602051}, "num_episodes": 23, "episode_return_max": 56.740421062573105, "episode_return_min": -12.26384596447764, "episode_return_mean": 15.744810831500445, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.805817113219, "num_env_steps_trained_throughput_per_sec": 382.805817113219, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 10841.81, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10841.588, "sample_time_ms": 1253.495, "learn_time_ms": 9565.696, "learn_throughput": 418.161, "synch_weights_time_ms": 20.806}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 110, "trial_id": "06536_00000", "date": "2024-08-11_17-34-07", "timestamp": 1723412047, "time_this_iter_s": 10.51080584526062, "time_total_s": 3589.040897130966, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5885670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3589.040897130966, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 48.40666666666666, "ram_util_percent": 82.95333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8924965439985195, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0214725186427436, "policy_loss": -0.007110832356556784, "vf_loss": 2.0285767160356043, "vf_explained_var": 0.9459883156542976, "kl": 0.008487494987835702, "entropy": 0.44225432332605125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.836708364537153, "cur_kl_coeff": 2.60208521396521e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.603515799146481, "policy_loss": -0.0018428769512052732, "vf_loss": 2.6053586774402193, "vf_explained_var": 0.9350403261247766, "kl": 0.002288002467749644, "entropy": 0.19396397040161506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "env_runners": {"episode_reward_max": 56.740421062573105, "episode_reward_min": -12.26384596447764, "episode_reward_mean": 13.842533530875842, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.74042106257304, "predator_policy": -14.505729507326542}, "policy_reward_max": {"prey_policy": 12.263845964477639, "predator_policy": 56.95842190688271}, "policy_reward_mean": {"prey_policy": -13.842533530875842, "predator_policy": 13.842533530875839}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.411645538522897, 5.4446931487905115, 24.024518255693796, 18.10677804885068, 23.241423436037802, 8.63456372023599, 10.435935054000733, 13.371673688567062, 5.313528690134774, 4.474826234834985, 56.740421062573105, 9.05694829917263, 0.21807708104606238, -8.128801906528297, 25.478312913089542, 22.50712935904464, 15.938898664314799, 14.700582109497258, 10.726923862951567, 16.640429402853037, 12.35797799709506, 15.721808609158657, 5.776881342066331, 27.5498295412595, 12.779292072836961, 18.382049524172167, 14.452211559962354, 15.7631150618817, 10.262156060231261, 10.247821265048735, 13.697705107991519, 26.86460583648077, 18.024329464740433, 12.767011901469722, 17.272945636225003, 8.20105183774797, 18.36222122082781, -6.6559461181169315, 25.149072530498003, 6.10873004494316, 8.348617370720596, 13.620182361172668, 10.63815899569681, 20.791250310002575, 25.099122252633205, 11.067191581827524, 36.981950869254135, 12.621525084979474, -12.26384596447764, 13.230226446074713, 8.72837947202878, 20.287443311979576, -7.721392464545269, 11.195564771758734, 35.35329689061671, 11.775166004644875, 18.531798053222868, 22.786009577555394, 19.016444740625865, 36.42187891668181, 12.270495046679045, 17.807951121669394, 30.775016628658854, -5.791066214386203, 21.851926813839576, -3.0254064456795913, 7.64625368148931, 23.567127744065633, 23.13007148018879, 1.0661300515321912, 22.412642936145204, 9.661074937138647, 8.308490024581344, 28.481482892415602, 18.753021746156463, 21.061720841135156, 7.288994129563619, -6.596723613514374, 15.984866011696791, 17.728826763560278, -2.2372634294203673, 30.091069202933014, 7.433604725930258, -1.8706750322236143, 12.16981746531973, 19.898757016628622, 14.969510140560415, 25.93477554455571, 5.555733109550881, 9.572762501445538, 1.6048171152701176, 2.4686693824397565, 13.933094482376896, 14.958447350278629, 2.6953803442381137, 4.941689359787002, -1.0421014441908785, 13.51028507026948, 17.145531074700326, 21.204206787541594], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.41164553852291, -5.4446931487905035, -24.024518255693767, -18.10677804885067, -23.241423436037806, -8.634563720235995, -10.435935054000732, -13.371673688567064, -5.313528690134797, -4.474826234834983, -56.74042106257304, -9.056948299172625, -0.2180770810460766, 8.12880190652831, -25.478312913089535, -22.50712935904466, -15.938898664314777, -14.700582109497244, -10.726923862951562, -16.64042940285303, -12.357977997095048, -15.721808609158685, -5.77688134206633, -27.54982954125952, -12.77929207283696, -18.382049524172107, -14.45221155996236, -15.76311506188171, -10.262156060231273, -10.247821265048726, -13.697705107991524, -26.86460583648075, -18.024329464740433, -12.76701190146976, -17.272945636224982, -8.20105183774799, -18.362221220827806, 6.655946118116936, -25.149072530498035, -6.1087300449431545, -8.348617370720595, -13.62018236117266, -10.638158995696806, -20.791250310002575, -25.099122252633233, -11.067191581827519, -36.98195086925412, -12.621525084979476, 12.263845964477639, -13.230226446074715, -8.728379472028797, -20.287443311979615, 7.721392464545274, -11.195564771758724, -35.3532968906167, -11.775166004644898, -18.531798053222886, -22.7860095775554, -19.016444740625857, -36.42187891668184, -12.270495046679041, -17.80795112166935, -30.775016628658904, 5.791066214386186, -21.851926813839555, 3.025406445679586, -7.646253681489307, -23.567127744065665, -23.130071480188757, -1.0661300515321734, -22.412642936145232, -9.661074937138638, -8.308490024581365, -28.481482892415613, -18.753021746156406, -21.061720841135187, -7.288994129563616, 6.596723613514371, -15.98486601169677, -17.72882676356026, 2.2372634294203904, -30.09106920293306, -7.4336047259302624, 1.8706750322236152, -12.169817465319735, -19.89875701662864, -14.969510140560399, -25.93477554455576, -5.555733109550855, -9.572762501445572, -1.6048171152701132, -2.4686693824397525, -13.933094482376926, -14.958447350278611, -2.6953803442381083, -4.941689359787005, 1.0421014441908758, -13.510285070269472, -17.145531074700344, -21.204206787541615], "policy_predator_policy_reward": [13.97592964036348, 30.847361436682323, 14.271073117634177, -3.38168682005317, 31.808460490015296, 16.24057602137226, 31.528068614178103, 4.685487483523206, 26.206844849798156, 20.276002022277474, 14.482257887931942, 2.786869552540078, 17.578586430289644, 3.293283677711827, 11.595995644058117, 15.147351733076038, 10.924530275880034, -0.2974728956105075, 5.567176494565011, 3.3824759751049416, 56.522420218263406, 56.95842190688271, 12.38401518467687, 5.729881413668378, -9.806254217737465, 10.242408379829577, -7.964689140932485, -8.292914672124132, 30.644426196551592, 20.31219962962747, 21.59693669891299, 23.417322019176353, 16.814817372691888, 15.0629799559377, 7.741921605013203, 21.659242613981295, 13.810492062793562, 7.643355663109551, 17.300542203248526, 15.980316602457533, 12.784586965718075, 11.93136902847203, 9.841700155815229, 21.60191706250213, 16.806039014200948, -5.252276330068299, 29.379493648126747, 25.720165434392307, 1.2662941309178048, 24.292290014756144, 7.306014372204648, 29.45808467613959, 27.23638386235575, 1.6680392575689784, -3.4776644179113116, 35.003894541674676, 5.224177274960491, 15.300134845502052, 12.603005500840553, 7.892637029256887, 25.882161906429737, 1.5132483095533198, 29.311601620829865, 24.417610052131643, 14.553854530647468, 21.49480439883338, 2.7979909270292946, 22.7360328759102, 16.765669538784643, 17.780221733665307, -1.2336131916036175, 17.63571686709959, 10.973201969049832, 25.751240472605804, -11.186968913956626, -2.124923322277251, 36.58344489255597, 13.714700168440114, -1.6876715277825092, 13.905131617668836, 10.24456654512833, 6.452668196312862, 25.77051932665103, 1.4698453956942892, 11.119035677222957, 10.157282314170654, 10.831821928067935, 30.75067869193721, 29.384539035708116, 20.813705469558325, 18.640118216527277, 3.4942649471277782, 35.83047232614748, 38.133429412360734, 13.077885758688655, 12.165164411270293, -14.505729507326542, -10.021962421628732, 16.679163670085234, 9.78128922206422, 1.5728497183909145, 15.88390922566667, 6.323536399524913, 34.25135022443423, -4.853660217702753, -10.58912471138779, 15.433781447894985, 6.957348095622472, 30.951519295717027, 39.755074485516296, 2.678357056899026, 20.87197495239078, 23.496113073836955, 13.5674830326088, 14.993995040752829, 30.57802411435799, 35.6473000707456, 2.3855894105061424, 45.22068634156279, 27.62307149180083, 0.4507049266356802, 24.090285166722392, 31.86443350098041, 3.7514687423583246, 20.77261455447932, 40.77741870283841, -6.559192602621412, -5.022939826150961, 16.966954631178687, 26.73689899650042, -1.4598020393517235, -4.591010852007445, 14.843973980094992, 0.4485333828836371, 19.295972937143873, 27.838282550987373, 35.345419835477294, 10.914723124900204, 9.82414415358514, -7.691884050520764, 10.337502293480163, 34.487783578810294, 22.792927409277087, -3.4707775349998267, 4.0279399422368165, 12.589040106925921, 37.99404817634815, 18.968917608483068, 23.26885205548591, 14.23719143682693, 10.1098994704786, 32.013542211791766, 0.8217700147883962, 13.756218244338832, -2.5379224430738017, -10.655524783954945, 25.89960914990026, 6.070122873493328, 25.16230983588317, 10.295343691237342, -1.880836881127264, -2.5936899777135167, 29.513091536959422, 30.669046868906648, 1.4072186762106584, 13.459990775649853, 0.9346233382640694, -4.6759734027112945, 20.883183750253558, 3.456451180385905, 21.69760742950122, 18.09990660375604, 33.664740189798, -3.7257199086772324, 19.690170550851903, 32.179380538259544, 8.115744034642708, 2.995722184459, 20.050883467338465, -0.9053584644473034, 3.209896400947768, -0.0002621704075327358, 4.171030557483696, 0.7663082073958183, 6.351543310708422, 21.514645654045367, 13.526167112352155, 16.39072758820511, -1.0904473702949762, 6.481208058771198, 4.558027286900497, 5.325351432673512, 4.164201435566827, -6.248404323948568, 15.365125150789005, 11.6554449897499, 8.086392047332474, 26.204670102068214, 23.99047082085368, 18.417942754229543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6297251884153873, "mean_inference_ms": 1.6721084478380168, "mean_action_processing_ms": 0.258372980043001, "mean_env_wait_ms": 0.14582854753910607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004925370216369629, "StateBufferConnector_ms": 0.003024578094482422, "ViewRequirementAgentConnector_ms": 0.09379148483276367}, "num_episodes": 18, "episode_return_max": 56.740421062573105, "episode_return_min": -12.26384596447764, "episode_return_mean": 13.842533530875842, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.9385781629461, "num_env_steps_trained_throughput_per_sec": 365.9385781629461, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 10848.146, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10847.925, "sample_time_ms": 1244.113, "learn_time_ms": 9580.749, "learn_throughput": 417.504, "synch_weights_time_ms": 21.121}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "training_iteration": 111, "trial_id": "06536_00000", "date": "2024-08-11_17-34-18", "timestamp": 1723412058, "time_this_iter_s": 10.981603145599365, "time_total_s": 3600.0225002765656, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5885700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3600.0225002765656, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 51.83333333333333, "ram_util_percent": 83.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.050901525219282, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3032236887762942, "policy_loss": -0.006463784337878072, "vf_loss": 2.3096816221872967, "vf_explained_var": 0.9456136832013726, "kl": 0.007492084441374421, "entropy": 0.43052439807603754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7484594476286066, "cur_kl_coeff": 1.301042606982605e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4693419877814238, "policy_loss": -0.0017062184381145965, "vf_loss": 2.471048202779558, "vf_explained_var": 0.9499977817611088, "kl": 0.0032582389936588315, "entropy": 0.2256353059379512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 41.9147581616882, "episode_reward_min": -12.26384596447764, "episode_reward_mean": 14.06504389877182, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.91475816168827, "predator_policy": -14.505729507326542}, "policy_reward_max": {"prey_policy": 12.263845964477639, "predator_policy": 45.22068634156279}, "policy_reward_mean": {"prey_policy": -14.065043898771824, "predator_policy": 14.065043898771826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.776881342066331, 27.5498295412595, 12.779292072836961, 18.382049524172167, 14.452211559962354, 15.7631150618817, 10.262156060231261, 10.247821265048735, 13.697705107991519, 26.86460583648077, 18.024329464740433, 12.767011901469722, 17.272945636225003, 8.20105183774797, 18.36222122082781, -6.6559461181169315, 25.149072530498003, 6.10873004494316, 8.348617370720596, 13.620182361172668, 10.63815899569681, 20.791250310002575, 25.099122252633205, 11.067191581827524, 36.981950869254135, 12.621525084979474, -12.26384596447764, 13.230226446074713, 8.72837947202878, 20.287443311979576, -7.721392464545269, 11.195564771758734, 35.35329689061671, 11.775166004644875, 18.531798053222868, 22.786009577555394, 19.016444740625865, 36.42187891668181, 12.270495046679045, 17.807951121669394, 30.775016628658854, -5.791066214386203, 21.851926813839576, -3.0254064456795913, 7.64625368148931, 23.567127744065633, 23.13007148018879, 1.0661300515321912, 22.412642936145204, 9.661074937138647, 8.308490024581344, 28.481482892415602, 18.753021746156463, 21.061720841135156, 7.288994129563619, -6.596723613514374, 15.984866011696791, 17.728826763560278, -2.2372634294203673, 30.091069202933014, 7.433604725930258, -1.8706750322236143, 12.16981746531973, 19.898757016628622, 14.969510140560415, 25.93477554455571, 5.555733109550881, 9.572762501445538, 1.6048171152701176, 2.4686693824397565, 13.933094482376896, 14.958447350278629, 2.6953803442381137, 4.941689359787002, -1.0421014441908785, 13.51028507026948, 17.145531074700326, 21.204206787541594, 4.323566041429049, 4.796169390755849, 27.340581518426497, 19.41194517066711, 13.16708998094315, 2.0227503541363694, 17.022685429986446, 15.873087355238802, 8.403620454042983, 20.848396654290305, 8.307375358786267, 9.515139000633829, 41.9147581616882, -3.293828672435332, 6.20680958828581, 32.48622745369179, 21.924061502178432, 35.03396027244372, -3.1293981626773446, 24.476263061371323, 21.592139244915735, 21.425930900736475], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.77688134206633, -27.54982954125952, -12.77929207283696, -18.382049524172107, -14.45221155996236, -15.76311506188171, -10.262156060231273, -10.247821265048726, -13.697705107991524, -26.86460583648075, -18.024329464740433, -12.76701190146976, -17.272945636224982, -8.20105183774799, -18.362221220827806, 6.655946118116936, -25.149072530498035, -6.1087300449431545, -8.348617370720595, -13.62018236117266, -10.638158995696806, -20.791250310002575, -25.099122252633233, -11.067191581827519, -36.98195086925412, -12.621525084979476, 12.263845964477639, -13.230226446074715, -8.728379472028797, -20.287443311979615, 7.721392464545274, -11.195564771758724, -35.3532968906167, -11.775166004644898, -18.531798053222886, -22.7860095775554, -19.016444740625857, -36.42187891668184, -12.270495046679041, -17.80795112166935, -30.775016628658904, 5.791066214386186, -21.851926813839555, 3.025406445679586, -7.646253681489307, -23.567127744065665, -23.130071480188757, -1.0661300515321734, -22.412642936145232, -9.661074937138638, -8.308490024581365, -28.481482892415613, -18.753021746156406, -21.061720841135187, -7.288994129563616, 6.596723613514371, -15.98486601169677, -17.72882676356026, 2.2372634294203904, -30.09106920293306, -7.4336047259302624, 1.8706750322236152, -12.169817465319735, -19.89875701662864, -14.969510140560399, -25.93477554455576, -5.555733109550855, -9.572762501445572, -1.6048171152701132, -2.4686693824397525, -13.933094482376926, -14.958447350278611, -2.6953803442381083, -4.941689359787005, 1.0421014441908758, -13.510285070269472, -17.145531074700344, -21.204206787541615, -4.323566041429044, -4.796169390755825, -27.34058151842646, -19.41194517066714, -13.167089980943143, -2.0227503541363463, -17.022685429986442, -15.873087355238802, -8.403620454042986, -20.848396654290294, -8.307375358786258, -9.515139000633825, -41.91475816168827, 3.2938286724353327, -6.206809588285803, -32.48622745369181, -21.924061502178414, -35.03396027244376, 3.12939816267734, -24.476263061371355, -21.592139244915717, -21.42593090073644], "policy_predator_policy_reward": [16.806039014200948, -5.252276330068299, 29.379493648126747, 25.720165434392307, 1.2662941309178048, 24.292290014756144, 7.306014372204648, 29.45808467613959, 27.23638386235575, 1.6680392575689784, -3.4776644179113116, 35.003894541674676, 5.224177274960491, 15.300134845502052, 12.603005500840553, 7.892637029256887, 25.882161906429737, 1.5132483095533198, 29.311601620829865, 24.417610052131643, 14.553854530647468, 21.49480439883338, 2.7979909270292946, 22.7360328759102, 16.765669538784643, 17.780221733665307, -1.2336131916036175, 17.63571686709959, 10.973201969049832, 25.751240472605804, -11.186968913956626, -2.124923322277251, 36.58344489255597, 13.714700168440114, -1.6876715277825092, 13.905131617668836, 10.24456654512833, 6.452668196312862, 25.77051932665103, 1.4698453956942892, 11.119035677222957, 10.157282314170654, 10.831821928067935, 30.75067869193721, 29.384539035708116, 20.813705469558325, 18.640118216527277, 3.4942649471277782, 35.83047232614748, 38.133429412360734, 13.077885758688655, 12.165164411270293, -14.505729507326542, -10.021962421628732, 16.679163670085234, 9.78128922206422, 1.5728497183909145, 15.88390922566667, 6.323536399524913, 34.25135022443423, -4.853660217702753, -10.58912471138779, 15.433781447894985, 6.957348095622472, 30.951519295717027, 39.755074485516296, 2.678357056899026, 20.87197495239078, 23.496113073836955, 13.5674830326088, 14.993995040752829, 30.57802411435799, 35.6473000707456, 2.3855894105061424, 45.22068634156279, 27.62307149180083, 0.4507049266356802, 24.090285166722392, 31.86443350098041, 3.7514687423583246, 20.77261455447932, 40.77741870283841, -6.559192602621412, -5.022939826150961, 16.966954631178687, 26.73689899650042, -1.4598020393517235, -4.591010852007445, 14.843973980094992, 0.4485333828836371, 19.295972937143873, 27.838282550987373, 35.345419835477294, 10.914723124900204, 9.82414415358514, -7.691884050520764, 10.337502293480163, 34.487783578810294, 22.792927409277087, -3.4707775349998267, 4.0279399422368165, 12.589040106925921, 37.99404817634815, 18.968917608483068, 23.26885205548591, 14.23719143682693, 10.1098994704786, 32.013542211791766, 0.8217700147883962, 13.756218244338832, -2.5379224430738017, -10.655524783954945, 25.89960914990026, 6.070122873493328, 25.16230983588317, 10.295343691237342, -1.880836881127264, -2.5936899777135167, 29.513091536959422, 30.669046868906648, 1.4072186762106584, 13.459990775649853, 0.9346233382640694, -4.6759734027112945, 20.883183750253558, 3.456451180385905, 21.69760742950122, 18.09990660375604, 33.664740189798, -3.7257199086772324, 19.690170550851903, 32.179380538259544, 8.115744034642708, 2.995722184459, 20.050883467338465, -0.9053584644473034, 3.209896400947768, -0.0002621704075327358, 4.171030557483696, 0.7663082073958183, 6.351543310708422, 21.514645654045367, 13.526167112352155, 16.39072758820511, -1.0904473702949762, 6.481208058771198, 4.558027286900497, 5.325351432673512, 4.164201435566827, -6.248404323948568, 15.365125150789005, 11.6554449897499, 8.086392047332474, 26.204670102068214, 23.99047082085368, 18.417942754229543, 6.406898376681932, 2.2402337061761735, -7.388608085114086, 16.980946866625736, 36.40644802111195, 18.274715015741016, 34.41843489217317, 4.40545544916108, 21.70012122501339, 4.6340587368729125, 3.2292799850293274, 0.8162207232433776, 27.694039458811226, 6.351331401161652, 37.335387647617466, -5.589212937139851, 5.330043529991198, 11.477197378094774, 24.606265944903665, 17.090527363676983, -5.890006456208905, 22.50475717378147, -5.638666020244354, 24.66894402151202, 41.38215333518266, 42.447362988193845, -2.5511476445660835, -4.036509700304569, 19.53559936875878, -7.1219801921871735, 38.83842344437577, 26.134031463007886, 30.291445456394527, 13.556677547962323, 28.984918781091324, 41.08300176379615, -6.321831429334972, 0.06303510398028322, 11.296837152623413, 37.65568897011932, 27.220942456128725, 15.96333603370274, 22.156996990689947, 20.694864810782942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6295174181858519, "mean_inference_ms": 1.6712116975809719, "mean_action_processing_ms": 0.25832083872527406, "mean_env_wait_ms": 0.14567331859925362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00547027587890625, "StateBufferConnector_ms": 0.003341197967529297, "ViewRequirementAgentConnector_ms": 0.13143670558929443}, "num_episodes": 22, "episode_return_max": 41.9147581616882, "episode_return_min": -12.26384596447764, "episode_return_mean": 14.06504389877182, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.42713349747834, "num_env_steps_trained_throughput_per_sec": 343.42713349747834, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 10906.043, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10905.824, "sample_time_ms": 1269.087, "learn_time_ms": 9613.743, "learn_throughput": 416.071, "synch_weights_time_ms": 21.058}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 112, "trial_id": "06536_00000", "date": "2024-08-11_17-34-30", "timestamp": 1723412070, "time_this_iter_s": 11.70374870300293, "time_total_s": 3611.7262489795685, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33177d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3611.7262489795685, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 52.529411764705884, "ram_util_percent": 82.9529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7856110453605654, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3165762639294067, "policy_loss": -0.005753636482889609, "vf_loss": 2.3223257382710774, "vf_explained_var": 0.9457365756233533, "kl": 0.005326128399236889, "entropy": 0.4356570290712019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6693163268149847, "cur_kl_coeff": 6.505213034913025e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4177023692105815, "policy_loss": -0.002499899769906526, "vf_loss": 2.42020227480187, "vf_explained_var": 0.9434265774393839, "kl": 0.004165267346747391, "entropy": 0.22194616588808241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "env_runners": {"episode_reward_max": 41.9147581616882, "episode_reward_min": -12.26384596447764, "episode_reward_mean": 14.293528917466785, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.91475816168827, "predator_policy": -14.505729507326542}, "policy_reward_max": {"prey_policy": 12.263845964477639, "predator_policy": 45.22068634156279}, "policy_reward_mean": {"prey_policy": -14.29352891746679, "predator_policy": 14.29352891746679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.348617370720596, 13.620182361172668, 10.63815899569681, 20.791250310002575, 25.099122252633205, 11.067191581827524, 36.981950869254135, 12.621525084979474, -12.26384596447764, 13.230226446074713, 8.72837947202878, 20.287443311979576, -7.721392464545269, 11.195564771758734, 35.35329689061671, 11.775166004644875, 18.531798053222868, 22.786009577555394, 19.016444740625865, 36.42187891668181, 12.270495046679045, 17.807951121669394, 30.775016628658854, -5.791066214386203, 21.851926813839576, -3.0254064456795913, 7.64625368148931, 23.567127744065633, 23.13007148018879, 1.0661300515321912, 22.412642936145204, 9.661074937138647, 8.308490024581344, 28.481482892415602, 18.753021746156463, 21.061720841135156, 7.288994129563619, -6.596723613514374, 15.984866011696791, 17.728826763560278, -2.2372634294203673, 30.091069202933014, 7.433604725930258, -1.8706750322236143, 12.16981746531973, 19.898757016628622, 14.969510140560415, 25.93477554455571, 5.555733109550881, 9.572762501445538, 1.6048171152701176, 2.4686693824397565, 13.933094482376896, 14.958447350278629, 2.6953803442381137, 4.941689359787002, -1.0421014441908785, 13.51028507026948, 17.145531074700326, 21.204206787541594, 4.323566041429049, 4.796169390755849, 27.340581518426497, 19.41194517066711, 13.16708998094315, 2.0227503541363694, 17.022685429986446, 15.873087355238802, 8.403620454042983, 20.848396654290305, 8.307375358786267, 9.515139000633829, 41.9147581616882, -3.293828672435332, 6.20680958828581, 32.48622745369179, 21.924061502178432, 35.03396027244372, -3.1293981626773446, 24.476263061371323, 21.592139244915735, 21.425930900736475, 12.454249327026483, 17.318171528738823, 19.431900716142753, 23.470837428004597, 8.259916766494415, -6.854948880278345, -1.1676397954038862, 30.49947780746072, 2.6656335092168018, 33.56521854664121, 3.2328926029287484, 24.639854774977845, -0.9230057547326274, 12.75692267097427, 24.479854005616847, 39.580056562994535, 20.696727611449965, 13.747466331509992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.348617370720595, -13.62018236117266, -10.638158995696806, -20.791250310002575, -25.099122252633233, -11.067191581827519, -36.98195086925412, -12.621525084979476, 12.263845964477639, -13.230226446074715, -8.728379472028797, -20.287443311979615, 7.721392464545274, -11.195564771758724, -35.3532968906167, -11.775166004644898, -18.531798053222886, -22.7860095775554, -19.016444740625857, -36.42187891668184, -12.270495046679041, -17.80795112166935, -30.775016628658904, 5.791066214386186, -21.851926813839555, 3.025406445679586, -7.646253681489307, -23.567127744065665, -23.130071480188757, -1.0661300515321734, -22.412642936145232, -9.661074937138638, -8.308490024581365, -28.481482892415613, -18.753021746156406, -21.061720841135187, -7.288994129563616, 6.596723613514371, -15.98486601169677, -17.72882676356026, 2.2372634294203904, -30.09106920293306, -7.4336047259302624, 1.8706750322236152, -12.169817465319735, -19.89875701662864, -14.969510140560399, -25.93477554455576, -5.555733109550855, -9.572762501445572, -1.6048171152701132, -2.4686693824397525, -13.933094482376926, -14.958447350278611, -2.6953803442381083, -4.941689359787005, 1.0421014441908758, -13.510285070269472, -17.145531074700344, -21.204206787541615, -4.323566041429044, -4.796169390755825, -27.34058151842646, -19.41194517066714, -13.167089980943143, -2.0227503541363463, -17.022685429986442, -15.873087355238802, -8.403620454042986, -20.848396654290294, -8.307375358786258, -9.515139000633825, -41.91475816168827, 3.2938286724353327, -6.206809588285803, -32.48622745369181, -21.924061502178414, -35.03396027244376, 3.12939816267734, -24.476263061371355, -21.592139244915717, -21.42593090073644, -12.454249327026485, -17.318171528738844, -19.431900716142792, -23.470837428004586, -8.259916766494428, 6.8549488802783465, 1.167639795403887, -30.499477807460693, -2.665633509216782, -33.56521854664117, -3.2328926029287555, -24.639854774977834, 0.9230057547326354, -12.756922670974275, -24.47985400561685, -39.580056562994564, -20.696727611449933, -13.747466331510001], "policy_predator_policy_reward": [10.24456654512833, 6.452668196312862, 25.77051932665103, 1.4698453956942892, 11.119035677222957, 10.157282314170654, 10.831821928067935, 30.75067869193721, 29.384539035708116, 20.813705469558325, 18.640118216527277, 3.4942649471277782, 35.83047232614748, 38.133429412360734, 13.077885758688655, 12.165164411270293, -14.505729507326542, -10.021962421628732, 16.679163670085234, 9.78128922206422, 1.5728497183909145, 15.88390922566667, 6.323536399524913, 34.25135022443423, -4.853660217702753, -10.58912471138779, 15.433781447894985, 6.957348095622472, 30.951519295717027, 39.755074485516296, 2.678357056899026, 20.87197495239078, 23.496113073836955, 13.5674830326088, 14.993995040752829, 30.57802411435799, 35.6473000707456, 2.3855894105061424, 45.22068634156279, 27.62307149180083, 0.4507049266356802, 24.090285166722392, 31.86443350098041, 3.7514687423583246, 20.77261455447932, 40.77741870283841, -6.559192602621412, -5.022939826150961, 16.966954631178687, 26.73689899650042, -1.4598020393517235, -4.591010852007445, 14.843973980094992, 0.4485333828836371, 19.295972937143873, 27.838282550987373, 35.345419835477294, 10.914723124900204, 9.82414415358514, -7.691884050520764, 10.337502293480163, 34.487783578810294, 22.792927409277087, -3.4707775349998267, 4.0279399422368165, 12.589040106925921, 37.99404817634815, 18.968917608483068, 23.26885205548591, 14.23719143682693, 10.1098994704786, 32.013542211791766, 0.8217700147883962, 13.756218244338832, -2.5379224430738017, -10.655524783954945, 25.89960914990026, 6.070122873493328, 25.16230983588317, 10.295343691237342, -1.880836881127264, -2.5936899777135167, 29.513091536959422, 30.669046868906648, 1.4072186762106584, 13.459990775649853, 0.9346233382640694, -4.6759734027112945, 20.883183750253558, 3.456451180385905, 21.69760742950122, 18.09990660375604, 33.664740189798, -3.7257199086772324, 19.690170550851903, 32.179380538259544, 8.115744034642708, 2.995722184459, 20.050883467338465, -0.9053584644473034, 3.209896400947768, -0.0002621704075327358, 4.171030557483696, 0.7663082073958183, 6.351543310708422, 21.514645654045367, 13.526167112352155, 16.39072758820511, -1.0904473702949762, 6.481208058771198, 4.558027286900497, 5.325351432673512, 4.164201435566827, -6.248404323948568, 15.365125150789005, 11.6554449897499, 8.086392047332474, 26.204670102068214, 23.99047082085368, 18.417942754229543, 6.406898376681932, 2.2402337061761735, -7.388608085114086, 16.980946866625736, 36.40644802111195, 18.274715015741016, 34.41843489217317, 4.40545544916108, 21.70012122501339, 4.6340587368729125, 3.2292799850293274, 0.8162207232433776, 27.694039458811226, 6.351331401161652, 37.335387647617466, -5.589212937139851, 5.330043529991198, 11.477197378094774, 24.606265944903665, 17.090527363676983, -5.890006456208905, 22.50475717378147, -5.638666020244354, 24.66894402151202, 41.38215333518266, 42.447362988193845, -2.5511476445660835, -4.036509700304569, 19.53559936875878, -7.1219801921871735, 38.83842344437577, 26.134031463007886, 30.291445456394527, 13.556677547962323, 28.984918781091324, 41.08300176379615, -6.321831429334972, 0.06303510398028322, 11.296837152623413, 37.65568897011932, 27.220942456128725, 15.96333603370274, 22.156996990689947, 20.694864810782942, -2.445695695809296, 27.354194349862254, 3.5403041072343377, 31.096038950243354, 20.643158437799173, 18.220642994486365, 37.61831204506977, 9.323362810939441, 12.95526456433277, 3.56456896865609, -0.00757467984253779, -13.702323080714187, 4.976533561691246, -7.31181315249902, 24.4759681616963, 36.522987453225106, 7.223216559061383, -1.8919495406278166, 31.324901527916037, 35.80553556536634, 4.903953970992468, 1.561831234865041, 27.103644107707964, 22.17606544224775, -13.753570641829768, 11.907559132364504, 14.01217038628094, 11.501674955667625, 16.597024520652923, 32.36268349058081, 43.403964912600294, 35.756148213388876, 30.67586873755553, 10.717586485344398, 20.005999702182518, 7.488932960837485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6293144510665547, "mean_inference_ms": 1.6706827796006116, "mean_action_processing_ms": 0.258344203398246, "mean_env_wait_ms": 0.1455608843149912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005340933799743652, "StateBufferConnector_ms": 0.0035573244094848633, "ViewRequirementAgentConnector_ms": 0.1351381540298462}, "num_episodes": 18, "episode_return_max": 41.9147581616882, "episode_return_min": -12.26384596447764, "episode_return_mean": 14.293528917466785, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.514918589057, "num_env_steps_trained_throughput_per_sec": 377.514918589057, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 10902.035, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10901.917, "sample_time_ms": 1288.664, "learn_time_ms": 9591.918, "learn_throughput": 417.018, "synch_weights_time_ms": 19.646}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "training_iteration": 113, "trial_id": "06536_00000", "date": "2024-08-11_17-34-41", "timestamp": 1723412081, "time_this_iter_s": 10.663802146911621, "time_total_s": 3622.39005112648, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33177d790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3622.39005112648, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 46.47333333333333, "ram_util_percent": 82.83333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7947480940570433, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8448926033452153, "policy_loss": -0.006851698774456357, "vf_loss": 1.851739890500903, "vf_explained_var": 0.9626643487562736, "kl": 0.005643982038056401, "entropy": 0.43076501740142703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7966347376505536, "cur_kl_coeff": 3.2526065174565126e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1538859941971995, "policy_loss": -0.003038026631942817, "vf_loss": 2.1569240188472487, "vf_explained_var": 0.9600137011399344, "kl": 0.004050380781944157, "entropy": 0.1899477826224433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 41.9147581616882, "episode_reward_min": -7.8576364033941335, "episode_reward_mean": 13.05237118859966, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.91475816168827, "predator_policy": -13.753570641829768}, "policy_reward_max": {"prey_policy": 7.857636403394139, "predator_policy": 43.403964912600294}, "policy_reward_mean": {"prey_policy": -13.052371188599661, "predator_policy": 13.052371188599661}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.791066214386203, 21.851926813839576, -3.0254064456795913, 7.64625368148931, 23.567127744065633, 23.13007148018879, 1.0661300515321912, 22.412642936145204, 9.661074937138647, 8.308490024581344, 28.481482892415602, 18.753021746156463, 21.061720841135156, 7.288994129563619, -6.596723613514374, 15.984866011696791, 17.728826763560278, -2.2372634294203673, 30.091069202933014, 7.433604725930258, -1.8706750322236143, 12.16981746531973, 19.898757016628622, 14.969510140560415, 25.93477554455571, 5.555733109550881, 9.572762501445538, 1.6048171152701176, 2.4686693824397565, 13.933094482376896, 14.958447350278629, 2.6953803442381137, 4.941689359787002, -1.0421014441908785, 13.51028507026948, 17.145531074700326, 21.204206787541594, 4.323566041429049, 4.796169390755849, 27.340581518426497, 19.41194517066711, 13.16708998094315, 2.0227503541363694, 17.022685429986446, 15.873087355238802, 8.403620454042983, 20.848396654290305, 8.307375358786267, 9.515139000633829, 41.9147581616882, -3.293828672435332, 6.20680958828581, 32.48622745369179, 21.924061502178432, 35.03396027244372, -3.1293981626773446, 24.476263061371323, 21.592139244915735, 21.425930900736475, 12.454249327026483, 17.318171528738823, 19.431900716142753, 23.470837428004597, 8.259916766494415, -6.854948880278345, -1.1676397954038862, 30.49947780746072, 2.6656335092168018, 33.56521854664121, 3.2328926029287484, 24.639854774977845, -0.9230057547326274, 12.75692267097427, 24.479854005616847, 39.580056562994535, 20.696727611449965, 13.747466331509992, 5.791336369342279, 17.86063643076468, 10.96027219310993, 9.684572616567927, -4.800389537581933, 15.716166987905448, 7.888156741049504, 17.74726494564306, 2.841545499901848, 11.234713474784296, -7.8576364033941335, 10.204299774313233, 16.704738992292924, 39.18429010784712, 6.65631203014212, 10.668235440806697, 38.59278584648404, -0.6782233231537012, 25.68223968351305, 12.542266834969702, 3.03703712893987, -0.6322769639350767, 4.218313622434843], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.791066214386186, -21.851926813839555, 3.025406445679586, -7.646253681489307, -23.567127744065665, -23.130071480188757, -1.0661300515321734, -22.412642936145232, -9.661074937138638, -8.308490024581365, -28.481482892415613, -18.753021746156406, -21.061720841135187, -7.288994129563616, 6.596723613514371, -15.98486601169677, -17.72882676356026, 2.2372634294203904, -30.09106920293306, -7.4336047259302624, 1.8706750322236152, -12.169817465319735, -19.89875701662864, -14.969510140560399, -25.93477554455576, -5.555733109550855, -9.572762501445572, -1.6048171152701132, -2.4686693824397525, -13.933094482376926, -14.958447350278611, -2.6953803442381083, -4.941689359787005, 1.0421014441908758, -13.510285070269472, -17.145531074700344, -21.204206787541615, -4.323566041429044, -4.796169390755825, -27.34058151842646, -19.41194517066714, -13.167089980943143, -2.0227503541363463, -17.022685429986442, -15.873087355238802, -8.403620454042986, -20.848396654290294, -8.307375358786258, -9.515139000633825, -41.91475816168827, 3.2938286724353327, -6.206809588285803, -32.48622745369181, -21.924061502178414, -35.03396027244376, 3.12939816267734, -24.476263061371355, -21.592139244915717, -21.42593090073644, -12.454249327026485, -17.318171528738844, -19.431900716142792, -23.470837428004586, -8.259916766494428, 6.8549488802783465, 1.167639795403887, -30.499477807460693, -2.665633509216782, -33.56521854664117, -3.2328926029287555, -24.639854774977834, 0.9230057547326354, -12.756922670974275, -24.47985400561685, -39.580056562994564, -20.696727611449933, -13.747466331510001, -5.791336369342284, -17.860636430764675, -10.960272193109896, -9.684572616567914, 4.800389537581935, -15.716166987905439, -7.888156741049494, -17.74726494564308, -2.8415454999018497, -11.234713474784304, 7.857636403394139, -10.204299774313235, -16.704738992292917, -39.184290107847175, -6.656312030142072, -10.668235440806688, -38.59278584648408, 0.6782233231536834, -25.682239683512982, -12.542266834969697, -3.037037128939861, 0.6322769639350749, -4.2183136224348186], "policy_predator_policy_reward": [-6.559192602621412, -5.022939826150961, 16.966954631178687, 26.73689899650042, -1.4598020393517235, -4.591010852007445, 14.843973980094992, 0.4485333828836371, 19.295972937143873, 27.838282550987373, 35.345419835477294, 10.914723124900204, 9.82414415358514, -7.691884050520764, 10.337502293480163, 34.487783578810294, 22.792927409277087, -3.4707775349998267, 4.0279399422368165, 12.589040106925921, 37.99404817634815, 18.968917608483068, 23.26885205548591, 14.23719143682693, 10.1098994704786, 32.013542211791766, 0.8217700147883962, 13.756218244338832, -2.5379224430738017, -10.655524783954945, 25.89960914990026, 6.070122873493328, 25.16230983588317, 10.295343691237342, -1.880836881127264, -2.5936899777135167, 29.513091536959422, 30.669046868906648, 1.4072186762106584, 13.459990775649853, 0.9346233382640694, -4.6759734027112945, 20.883183750253558, 3.456451180385905, 21.69760742950122, 18.09990660375604, 33.664740189798, -3.7257199086772324, 19.690170550851903, 32.179380538259544, 8.115744034642708, 2.995722184459, 20.050883467338465, -0.9053584644473034, 3.209896400947768, -0.0002621704075327358, 4.171030557483696, 0.7663082073958183, 6.351543310708422, 21.514645654045367, 13.526167112352155, 16.39072758820511, -1.0904473702949762, 6.481208058771198, 4.558027286900497, 5.325351432673512, 4.164201435566827, -6.248404323948568, 15.365125150789005, 11.6554449897499, 8.086392047332474, 26.204670102068214, 23.99047082085368, 18.417942754229543, 6.406898376681932, 2.2402337061761735, -7.388608085114086, 16.980946866625736, 36.40644802111195, 18.274715015741016, 34.41843489217317, 4.40545544916108, 21.70012122501339, 4.6340587368729125, 3.2292799850293274, 0.8162207232433776, 27.694039458811226, 6.351331401161652, 37.335387647617466, -5.589212937139851, 5.330043529991198, 11.477197378094774, 24.606265944903665, 17.090527363676983, -5.890006456208905, 22.50475717378147, -5.638666020244354, 24.66894402151202, 41.38215333518266, 42.447362988193845, -2.5511476445660835, -4.036509700304569, 19.53559936875878, -7.1219801921871735, 38.83842344437577, 26.134031463007886, 30.291445456394527, 13.556677547962323, 28.984918781091324, 41.08300176379615, -6.321831429334972, 0.06303510398028322, 11.296837152623413, 37.65568897011932, 27.220942456128725, 15.96333603370274, 22.156996990689947, 20.694864810782942, -2.445695695809296, 27.354194349862254, 3.5403041072343377, 31.096038950243354, 20.643158437799173, 18.220642994486365, 37.61831204506977, 9.323362810939441, 12.95526456433277, 3.56456896865609, -0.00757467984253779, -13.702323080714187, 4.976533561691246, -7.31181315249902, 24.4759681616963, 36.522987453225106, 7.223216559061383, -1.8919495406278166, 31.324901527916037, 35.80553556536634, 4.903953970992468, 1.561831234865041, 27.103644107707964, 22.17606544224775, -13.753570641829768, 11.907559132364504, 14.01217038628094, 11.501674955667625, 16.597024520652923, 32.36268349058081, 43.403964912600294, 35.756148213388876, 30.67586873755553, 10.717586485344398, 20.005999702182518, 7.488932960837485, 17.17532644047695, -5.59265370179237, 31.343604850165537, 4.377668011363843, 8.456189153596029, 13.464355232623788, 0.8691108168803474, 18.500034416255495, -3.4078587500947624, -6.192920325069105, 23.564116731785003, 7.868217244025875, 7.544032287488557, 8.232281194610444, 33.80344141778538, 1.6910884735007405, 7.402048194173879, -1.7189571943701942, 14.244833330888664, 8.224593618679947, -10.844485748537359, -4.870787058250903, 9.565993104875618, 10.842606443750844, 9.1544261958683, 24.25505178871751, 43.226412754225926, 35.14216746146833, 9.918259847374525, 3.3943642129096787, 2.265851522989805, 19.07061935862356, 41.17172442662668, 36.013847266341415, 1.2955145367532204, -2.6519611830606014, 25.82459555019191, 25.539883816834127, 11.084832886665192, 13.999700783274196, 5.525604653339821, 0.5484696045399353, -8.72500379752947, 7.460449869659305, 3.3004249843283304, 5.136202260541316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.629106726925516, "mean_inference_ms": 1.671729194612284, "mean_action_processing_ms": 0.25854942240851136, "mean_env_wait_ms": 0.14565738241209386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00530397891998291, "StateBufferConnector_ms": 0.00352632999420166, "ViewRequirementAgentConnector_ms": 0.13490867614746094}, "num_episodes": 23, "episode_return_max": 41.9147581616882, "episode_return_min": -7.8576364033941335, "episode_return_mean": 13.05237118859966, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.35237426118977, "num_env_steps_trained_throughput_per_sec": 389.35237426118977, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 10791.399, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10791.232, "sample_time_ms": 1251.309, "learn_time_ms": 9516.775, "learn_throughput": 420.31, "synch_weights_time_ms": 21.384}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 114, "trial_id": "06536_00000", "date": "2024-08-11_17-34-51", "timestamp": 1723412091, "time_this_iter_s": 10.323596239089966, "time_total_s": 3632.71364736557, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5885700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3632.71364736557, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 43.88571428571429, "ram_util_percent": 82.66428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3356752866879105, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.73151498225828, "policy_loss": -0.00601900859013161, "vf_loss": 1.737528401426971, "vf_explained_var": 0.9608486698319515, "kl": 0.007163074398625372, "entropy": 0.41385036424423255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.637091050829206, "cur_kl_coeff": 1.6263032587282563e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1172808607419333, "policy_loss": -0.006672903429470444, "vf_loss": 2.123953763833122, "vf_explained_var": 0.9582467509009851, "kl": 0.017336438891748348, "entropy": 0.2560501704534526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "env_runners": {"episode_reward_max": 41.9147581616882, "episode_reward_min": -7.8576364033941335, "episode_reward_mean": 13.892708717575818, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.91475816168827, "predator_policy": -13.753570641829768}, "policy_reward_max": {"prey_policy": 7.857636403394139, "predator_policy": 43.403964912600294}, "policy_reward_mean": {"prey_policy": -13.892708717575818, "predator_policy": 13.89270871757582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.091069202933014, 7.433604725930258, -1.8706750322236143, 12.16981746531973, 19.898757016628622, 14.969510140560415, 25.93477554455571, 5.555733109550881, 9.572762501445538, 1.6048171152701176, 2.4686693824397565, 13.933094482376896, 14.958447350278629, 2.6953803442381137, 4.941689359787002, -1.0421014441908785, 13.51028507026948, 17.145531074700326, 21.204206787541594, 4.323566041429049, 4.796169390755849, 27.340581518426497, 19.41194517066711, 13.16708998094315, 2.0227503541363694, 17.022685429986446, 15.873087355238802, 8.403620454042983, 20.848396654290305, 8.307375358786267, 9.515139000633829, 41.9147581616882, -3.293828672435332, 6.20680958828581, 32.48622745369179, 21.924061502178432, 35.03396027244372, -3.1293981626773446, 24.476263061371323, 21.592139244915735, 21.425930900736475, 12.454249327026483, 17.318171528738823, 19.431900716142753, 23.470837428004597, 8.259916766494415, -6.854948880278345, -1.1676397954038862, 30.49947780746072, 2.6656335092168018, 33.56521854664121, 3.2328926029287484, 24.639854774977845, -0.9230057547326274, 12.75692267097427, 24.479854005616847, 39.580056562994535, 20.696727611449965, 13.747466331509992, 5.791336369342279, 17.86063643076468, 10.96027219310993, 9.684572616567927, -4.800389537581933, 15.716166987905448, 7.888156741049504, 17.74726494564306, 2.841545499901848, 11.234713474784296, -7.8576364033941335, 10.204299774313233, 16.704738992292924, 39.18429010784712, 6.65631203014212, 10.668235440806697, 38.59278584648404, -0.6782233231537012, 25.68223968351305, 12.542266834969702, 3.03703712893987, -0.6322769639350767, 4.218313622434843, 9.521625516263768, 22.08135722049398, 30.115996746208758, 14.445889848715495, 6.795856210805367, 13.49570881564242, 17.959915607706954, -1.534145214756518, 21.333614238938026, 7.343349893136587, 9.847585326105811, 27.45066042056678, 30.127852594900524, 1.2175406018955224, 6.668456612992518, 21.631873479432212, 34.062728731595385, 20.76005659748037], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.09106920293306, -7.4336047259302624, 1.8706750322236152, -12.169817465319735, -19.89875701662864, -14.969510140560399, -25.93477554455576, -5.555733109550855, -9.572762501445572, -1.6048171152701132, -2.4686693824397525, -13.933094482376926, -14.958447350278611, -2.6953803442381083, -4.941689359787005, 1.0421014441908758, -13.510285070269472, -17.145531074700344, -21.204206787541615, -4.323566041429044, -4.796169390755825, -27.34058151842646, -19.41194517066714, -13.167089980943143, -2.0227503541363463, -17.022685429986442, -15.873087355238802, -8.403620454042986, -20.848396654290294, -8.307375358786258, -9.515139000633825, -41.91475816168827, 3.2938286724353327, -6.206809588285803, -32.48622745369181, -21.924061502178414, -35.03396027244376, 3.12939816267734, -24.476263061371355, -21.592139244915717, -21.42593090073644, -12.454249327026485, -17.318171528738844, -19.431900716142792, -23.470837428004586, -8.259916766494428, 6.8549488802783465, 1.167639795403887, -30.499477807460693, -2.665633509216782, -33.56521854664117, -3.2328926029287555, -24.639854774977834, 0.9230057547326354, -12.756922670974275, -24.47985400561685, -39.580056562994564, -20.696727611449933, -13.747466331510001, -5.791336369342284, -17.860636430764675, -10.960272193109896, -9.684572616567914, 4.800389537581935, -15.716166987905439, -7.888156741049494, -17.74726494564308, -2.8415454999018497, -11.234713474784304, 7.857636403394139, -10.204299774313235, -16.704738992292917, -39.184290107847175, -6.656312030142072, -10.668235440806688, -38.59278584648408, 0.6782233231536834, -25.682239683512982, -12.542266834969697, -3.037037128939861, 0.6322769639350749, -4.2183136224348186, -9.521625516263759, -22.081357220494, -30.11599674620876, -14.445889848715499, -6.795856210805378, -13.495708815642416, -17.959915607706982, 1.5341452147565082, -21.33361423893802, -7.343349893136603, -9.84758532610581, -27.450660420566756, -30.127852594900443, -1.2175406018955286, -6.668456612992536, -21.63187347943219, -34.06272873159537, -20.760056597480386], "policy_predator_policy_reward": [29.513091536959422, 30.669046868906648, 1.4072186762106584, 13.459990775649853, 0.9346233382640694, -4.6759734027112945, 20.883183750253558, 3.456451180385905, 21.69760742950122, 18.09990660375604, 33.664740189798, -3.7257199086772324, 19.690170550851903, 32.179380538259544, 8.115744034642708, 2.995722184459, 20.050883467338465, -0.9053584644473034, 3.209896400947768, -0.0002621704075327358, 4.171030557483696, 0.7663082073958183, 6.351543310708422, 21.514645654045367, 13.526167112352155, 16.39072758820511, -1.0904473702949762, 6.481208058771198, 4.558027286900497, 5.325351432673512, 4.164201435566827, -6.248404323948568, 15.365125150789005, 11.6554449897499, 8.086392047332474, 26.204670102068214, 23.99047082085368, 18.417942754229543, 6.406898376681932, 2.2402337061761735, -7.388608085114086, 16.980946866625736, 36.40644802111195, 18.274715015741016, 34.41843489217317, 4.40545544916108, 21.70012122501339, 4.6340587368729125, 3.2292799850293274, 0.8162207232433776, 27.694039458811226, 6.351331401161652, 37.335387647617466, -5.589212937139851, 5.330043529991198, 11.477197378094774, 24.606265944903665, 17.090527363676983, -5.890006456208905, 22.50475717378147, -5.638666020244354, 24.66894402151202, 41.38215333518266, 42.447362988193845, -2.5511476445660835, -4.036509700304569, 19.53559936875878, -7.1219801921871735, 38.83842344437577, 26.134031463007886, 30.291445456394527, 13.556677547962323, 28.984918781091324, 41.08300176379615, -6.321831429334972, 0.06303510398028322, 11.296837152623413, 37.65568897011932, 27.220942456128725, 15.96333603370274, 22.156996990689947, 20.694864810782942, -2.445695695809296, 27.354194349862254, 3.5403041072343377, 31.096038950243354, 20.643158437799173, 18.220642994486365, 37.61831204506977, 9.323362810939441, 12.95526456433277, 3.56456896865609, -0.00757467984253779, -13.702323080714187, 4.976533561691246, -7.31181315249902, 24.4759681616963, 36.522987453225106, 7.223216559061383, -1.8919495406278166, 31.324901527916037, 35.80553556536634, 4.903953970992468, 1.561831234865041, 27.103644107707964, 22.17606544224775, -13.753570641829768, 11.907559132364504, 14.01217038628094, 11.501674955667625, 16.597024520652923, 32.36268349058081, 43.403964912600294, 35.756148213388876, 30.67586873755553, 10.717586485344398, 20.005999702182518, 7.488932960837485, 17.17532644047695, -5.59265370179237, 31.343604850165537, 4.377668011363843, 8.456189153596029, 13.464355232623788, 0.8691108168803474, 18.500034416255495, -3.4078587500947624, -6.192920325069105, 23.564116731785003, 7.868217244025875, 7.544032287488557, 8.232281194610444, 33.80344141778538, 1.6910884735007405, 7.402048194173879, -1.7189571943701942, 14.244833330888664, 8.224593618679947, -10.844485748537359, -4.870787058250903, 9.565993104875618, 10.842606443750844, 9.1544261958683, 24.25505178871751, 43.226412754225926, 35.14216746146833, 9.918259847374525, 3.3943642129096787, 2.265851522989805, 19.07061935862356, 41.17172442662668, 36.013847266341415, 1.2955145367532204, -2.6519611830606014, 25.82459555019191, 25.539883816834127, 11.084832886665192, 13.999700783274196, 5.525604653339821, 0.5484696045399353, -8.72500379752947, 7.460449869659305, 3.3004249843283304, 5.136202260541316, 13.353393708626488, 5.68985732390103, 26.85654254731503, 17.30617189367298, 34.836955096941644, 25.395038395475908, 19.181769752331103, 9.710009945099877, 13.365780927053958, 0.2259314945567974, 16.643540163518644, 10.347877467766189, 22.7002905110459, 13.219540704368017, 3.606488520729009, -6.674778950242035, 21.70763677172488, 20.95959170615118, 15.270871598219522, -0.5841718119463213, -4.304908578258836, 24.000079230470426, 26.68053164310318, 28.220789198030392, 29.606617208985657, 30.64908798081523, 1.396786428682537, 1.0382947751085183, 15.701925049132512, -2.3650118231474577, 29.459540010186053, 13.80420694867832, 30.2535704508492, 37.87188701234153, 28.80560650423091, 12.71450669072984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6291152612736977, "mean_inference_ms": 1.67050968491591, "mean_action_processing_ms": 0.2583811216119136, "mean_env_wait_ms": 0.14537296355020837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190253257751465, "StateBufferConnector_ms": 0.0034286975860595703, "ViewRequirementAgentConnector_ms": 0.1344696283340454}, "num_episodes": 18, "episode_return_max": 41.9147581616882, "episode_return_min": -7.8576364033941335, "episode_return_mean": 13.892708717575818, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.35732420505644, "num_env_steps_trained_throughput_per_sec": 365.35732420505644, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 10832.131, "restore_workers_time_ms": 0.025, "training_step_time_ms": 10831.96, "sample_time_ms": 1270.745, "learn_time_ms": 9537.928, "learn_throughput": 419.378, "synch_weights_time_ms": 21.469}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "training_iteration": 115, "trial_id": "06536_00000", "date": "2024-08-11_17-35-02", "timestamp": 1723412102, "time_this_iter_s": 10.993598937988281, "time_total_s": 3643.7072463035583, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3643.7072463035583, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 48.893750000000004, "ram_util_percent": 82.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.509177782634894, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.024156943957011, "policy_loss": -0.005167993000213755, "vf_loss": 2.029320311360061, "vf_explained_var": 0.9403026609991988, "kl": 0.005919090759476969, "entropy": 0.38933036411181093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.629403238447886, "cur_kl_coeff": 1.6263032587282563e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.629458228810124, "policy_loss": -0.004841790763814022, "vf_loss": 2.634300022781211, "vf_explained_var": 0.9274891583377092, "kl": 0.005931496136254944, "entropy": 0.27326209511233385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 41.9147581616882, "episode_reward_min": -7.8576364033941335, "episode_reward_mean": 14.646131258674354, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.91475816168827, "predator_policy": -13.753570641829768}, "policy_reward_max": {"prey_policy": 7.857636403394139, "predator_policy": 46.39954233693191}, "policy_reward_mean": {"prey_policy": -14.646131258674354, "predator_policy": 14.646131258674354}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.41194517066711, 13.16708998094315, 2.0227503541363694, 17.022685429986446, 15.873087355238802, 8.403620454042983, 20.848396654290305, 8.307375358786267, 9.515139000633829, 41.9147581616882, -3.293828672435332, 6.20680958828581, 32.48622745369179, 21.924061502178432, 35.03396027244372, -3.1293981626773446, 24.476263061371323, 21.592139244915735, 21.425930900736475, 12.454249327026483, 17.318171528738823, 19.431900716142753, 23.470837428004597, 8.259916766494415, -6.854948880278345, -1.1676397954038862, 30.49947780746072, 2.6656335092168018, 33.56521854664121, 3.2328926029287484, 24.639854774977845, -0.9230057547326274, 12.75692267097427, 24.479854005616847, 39.580056562994535, 20.696727611449965, 13.747466331509992, 5.791336369342279, 17.86063643076468, 10.96027219310993, 9.684572616567927, -4.800389537581933, 15.716166987905448, 7.888156741049504, 17.74726494564306, 2.841545499901848, 11.234713474784296, -7.8576364033941335, 10.204299774313233, 16.704738992292924, 39.18429010784712, 6.65631203014212, 10.668235440806697, 38.59278584648404, -0.6782233231537012, 25.68223968351305, 12.542266834969702, 3.03703712893987, -0.6322769639350767, 4.218313622434843, 9.521625516263768, 22.08135722049398, 30.115996746208758, 14.445889848715495, 6.795856210805367, 13.49570881564242, 17.959915607706954, -1.534145214756518, 21.333614238938026, 7.343349893136587, 9.847585326105811, 27.45066042056678, 30.127852594900524, 1.2175406018955224, 6.668456612992518, 21.631873479432212, 34.062728731595385, 20.76005659748037, 0.31666806962045424, 25.137032501165045, 21.316924495604496, 14.647713121797064, 5.225968014540057, 0.08270088013459542, 23.30352293339281, 34.35258012717706, 23.99974975536955, 28.370151626162563, 17.500328646934406, 9.306372626072223, 18.94322447124184, 0.8601985087040065, 23.2133262943632, -3.0487930324389922, 18.147877159642295, 17.375497298138182, 11.00071117070364, 14.072427201734916, 11.330749397860933, 11.523013989956155], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.41194517066714, -13.167089980943143, -2.0227503541363463, -17.022685429986442, -15.873087355238802, -8.403620454042986, -20.848396654290294, -8.307375358786258, -9.515139000633825, -41.91475816168827, 3.2938286724353327, -6.206809588285803, -32.48622745369181, -21.924061502178414, -35.03396027244376, 3.12939816267734, -24.476263061371355, -21.592139244915717, -21.42593090073644, -12.454249327026485, -17.318171528738844, -19.431900716142792, -23.470837428004586, -8.259916766494428, 6.8549488802783465, 1.167639795403887, -30.499477807460693, -2.665633509216782, -33.56521854664117, -3.2328926029287555, -24.639854774977834, 0.9230057547326354, -12.756922670974275, -24.47985400561685, -39.580056562994564, -20.696727611449933, -13.747466331510001, -5.791336369342284, -17.860636430764675, -10.960272193109896, -9.684572616567914, 4.800389537581935, -15.716166987905439, -7.888156741049494, -17.74726494564308, -2.8415454999018497, -11.234713474784304, 7.857636403394139, -10.204299774313235, -16.704738992292917, -39.184290107847175, -6.656312030142072, -10.668235440806688, -38.59278584648408, 0.6782233231536834, -25.682239683512982, -12.542266834969697, -3.037037128939861, 0.6322769639350749, -4.2183136224348186, -9.521625516263759, -22.081357220494, -30.11599674620876, -14.445889848715499, -6.795856210805378, -13.495708815642416, -17.959915607706982, 1.5341452147565082, -21.33361423893802, -7.343349893136603, -9.84758532610581, -27.450660420566756, -30.127852594900443, -1.2175406018955286, -6.668456612992536, -21.63187347943219, -34.06272873159537, -20.760056597480386, -0.3166680696204369, -25.137032501165038, -21.316924495604546, -14.647713121797054, -5.225968014540051, -0.0827008801345972, -23.30352293339278, -34.35258012717707, -23.99974975536954, -28.370151626162595, -17.500328646934424, -9.306372626072209, -18.943224471241834, -0.8601985087039941, -23.21332629436319, 3.048793032438993, -18.147877159642313, -17.375497298138175, -11.000711170703632, -14.072427201734875, -11.330749397860941, -11.523013989956144], "policy_predator_policy_reward": [34.41843489217317, 4.40545544916108, 21.70012122501339, 4.6340587368729125, 3.2292799850293274, 0.8162207232433776, 27.694039458811226, 6.351331401161652, 37.335387647617466, -5.589212937139851, 5.330043529991198, 11.477197378094774, 24.606265944903665, 17.090527363676983, -5.890006456208905, 22.50475717378147, -5.638666020244354, 24.66894402151202, 41.38215333518266, 42.447362988193845, -2.5511476445660835, -4.036509700304569, 19.53559936875878, -7.1219801921871735, 38.83842344437577, 26.134031463007886, 30.291445456394527, 13.556677547962323, 28.984918781091324, 41.08300176379615, -6.321831429334972, 0.06303510398028322, 11.296837152623413, 37.65568897011932, 27.220942456128725, 15.96333603370274, 22.156996990689947, 20.694864810782942, -2.445695695809296, 27.354194349862254, 3.5403041072343377, 31.096038950243354, 20.643158437799173, 18.220642994486365, 37.61831204506977, 9.323362810939441, 12.95526456433277, 3.56456896865609, -0.00757467984253779, -13.702323080714187, 4.976533561691246, -7.31181315249902, 24.4759681616963, 36.522987453225106, 7.223216559061383, -1.8919495406278166, 31.324901527916037, 35.80553556536634, 4.903953970992468, 1.561831234865041, 27.103644107707964, 22.17606544224775, -13.753570641829768, 11.907559132364504, 14.01217038628094, 11.501674955667625, 16.597024520652923, 32.36268349058081, 43.403964912600294, 35.756148213388876, 30.67586873755553, 10.717586485344398, 20.005999702182518, 7.488932960837485, 17.17532644047695, -5.59265370179237, 31.343604850165537, 4.377668011363843, 8.456189153596029, 13.464355232623788, 0.8691108168803474, 18.500034416255495, -3.4078587500947624, -6.192920325069105, 23.564116731785003, 7.868217244025875, 7.544032287488557, 8.232281194610444, 33.80344141778538, 1.6910884735007405, 7.402048194173879, -1.7189571943701942, 14.244833330888664, 8.224593618679947, -10.844485748537359, -4.870787058250903, 9.565993104875618, 10.842606443750844, 9.1544261958683, 24.25505178871751, 43.226412754225926, 35.14216746146833, 9.918259847374525, 3.3943642129096787, 2.265851522989805, 19.07061935862356, 41.17172442662668, 36.013847266341415, 1.2955145367532204, -2.6519611830606014, 25.82459555019191, 25.539883816834127, 11.084832886665192, 13.999700783274196, 5.525604653339821, 0.5484696045399353, -8.72500379752947, 7.460449869659305, 3.3004249843283304, 5.136202260541316, 13.353393708626488, 5.68985732390103, 26.85654254731503, 17.30617189367298, 34.836955096941644, 25.395038395475908, 19.181769752331103, 9.710009945099877, 13.365780927053958, 0.2259314945567974, 16.643540163518644, 10.347877467766189, 22.7002905110459, 13.219540704368017, 3.606488520729009, -6.674778950242035, 21.70763677172488, 20.95959170615118, 15.270871598219522, -0.5841718119463213, -4.304908578258836, 24.000079230470426, 26.68053164310318, 28.220789198030392, 29.606617208985657, 30.64908798081523, 1.396786428682537, 1.0382947751085183, 15.701925049132512, -2.3650118231474577, 29.459540010186053, 13.80420694867832, 30.2535704508492, 37.87188701234153, 28.80560650423091, 12.71450669072984, 10.93215480825955, -10.298818669018672, 14.336661551005587, 35.93740345132444, 25.48092699642625, 17.152921994782833, 29.44744692294555, -0.15202067935143404, 18.746213614427234, -8.294277585347153, -4.360484400766856, 4.525886161036045, 33.14965906011678, 13.457386806668795, 22.30561791742223, 46.39954233693191, 42.63386830238622, 5.365631208352847, 17.121167814739813, 39.61913543758537, -1.3180546891739295, 36.31871198304281, 9.613275396506628, 8.99946985563781, 8.95873292134736, 28.927716021136316, -11.708344644264933, 13.428741661672927, 22.612990959669716, 23.813661629056682, -4.554069682620334, -1.5435163822576659, 28.027355063478076, 8.268399255806557, 30.350984870104224, 4.400009726172108, 11.890150397648123, 10.111271943759156, 17.33116631031863, 10.813688093151134, -4.033225465115137, 26.69472426083702, 23.890166006901502, -0.8441380269892171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6290643426369882, "mean_inference_ms": 1.6694627510480549, "mean_action_processing_ms": 0.2582433635541828, "mean_env_wait_ms": 0.14523516428383543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005492091178894043, "StateBufferConnector_ms": 0.0032744407653808594, "ViewRequirementAgentConnector_ms": 0.12177348136901855}, "num_episodes": 22, "episode_return_max": 41.9147581616882, "episode_return_min": -7.8576364033941335, "episode_return_mean": 14.646131258674354, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.3887888787608, "num_env_steps_trained_throughput_per_sec": 377.3887888787608, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 10832.163, "restore_workers_time_ms": 0.025, "training_step_time_ms": 10831.996, "sample_time_ms": 1250.628, "learn_time_ms": 9559.213, "learn_throughput": 418.444, "synch_weights_time_ms": 20.377}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 116, "trial_id": "06536_00000", "date": "2024-08-11_17-35-13", "timestamp": 1723412113, "time_this_iter_s": 10.653822898864746, "time_total_s": 3654.361069202423, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331635160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3654.361069202423, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 47.46, "ram_util_percent": 82.89333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9435212487975755, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.143447433412075, "policy_loss": -0.010834113580737418, "vf_loss": 2.1542750243097544, "vf_explained_var": 0.9513007884845137, "kl": 0.008345025065221091, "entropy": 0.3940105416501562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9099921508440896, "cur_kl_coeff": 1.6263032587282563e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4575147840711806, "policy_loss": -0.00272232926273275, "vf_loss": 2.4602371109225762, "vf_explained_var": 0.9475348288735385, "kl": 0.004515592866565572, "entropy": 0.27314593519167923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "env_runners": {"episode_reward_max": 39.580056562994535, "episode_reward_min": -7.8576364033941335, "episode_reward_mean": 14.67550595284316, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -39.580056562994564, "predator_policy": -13.753570641829768}, "policy_reward_max": {"prey_policy": 7.857636403394139, "predator_policy": 46.39954233693191}, "policy_reward_mean": {"prey_policy": -14.67550595284316, "predator_policy": 14.67550595284316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.425930900736475, 12.454249327026483, 17.318171528738823, 19.431900716142753, 23.470837428004597, 8.259916766494415, -6.854948880278345, -1.1676397954038862, 30.49947780746072, 2.6656335092168018, 33.56521854664121, 3.2328926029287484, 24.639854774977845, -0.9230057547326274, 12.75692267097427, 24.479854005616847, 39.580056562994535, 20.696727611449965, 13.747466331509992, 5.791336369342279, 17.86063643076468, 10.96027219310993, 9.684572616567927, -4.800389537581933, 15.716166987905448, 7.888156741049504, 17.74726494564306, 2.841545499901848, 11.234713474784296, -7.8576364033941335, 10.204299774313233, 16.704738992292924, 39.18429010784712, 6.65631203014212, 10.668235440806697, 38.59278584648404, -0.6782233231537012, 25.68223968351305, 12.542266834969702, 3.03703712893987, -0.6322769639350767, 4.218313622434843, 9.521625516263768, 22.08135722049398, 30.115996746208758, 14.445889848715495, 6.795856210805367, 13.49570881564242, 17.959915607706954, -1.534145214756518, 21.333614238938026, 7.343349893136587, 9.847585326105811, 27.45066042056678, 30.127852594900524, 1.2175406018955224, 6.668456612992518, 21.631873479432212, 34.062728731595385, 20.76005659748037, 0.31666806962045424, 25.137032501165045, 21.316924495604496, 14.647713121797064, 5.225968014540057, 0.08270088013459542, 23.30352293339281, 34.35258012717706, 23.99974975536955, 28.370151626162563, 17.500328646934406, 9.306372626072223, 18.94322447124184, 0.8601985087040065, 23.2133262943632, -3.0487930324389922, 18.147877159642295, 17.375497298138182, 11.00071117070364, 14.072427201734916, 11.330749397860933, 11.523013989956155, 30.244736599780204, 4.907809971558621, 21.34845752567976, 33.82438332974293, 6.911974024889055, 11.356610051070907, 19.7191105376844, 20.0704575342974, 13.50918704360014, 2.3247521385000818, 20.440154622780028, 20.679633518568334, 23.471132964057144, 1.1582107925152494, -3.677642713031556, 35.167044312871695, 8.400568365590152, 24.86397100491385], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.42593090073644, -12.454249327026485, -17.318171528738844, -19.431900716142792, -23.470837428004586, -8.259916766494428, 6.8549488802783465, 1.167639795403887, -30.499477807460693, -2.665633509216782, -33.56521854664117, -3.2328926029287555, -24.639854774977834, 0.9230057547326354, -12.756922670974275, -24.47985400561685, -39.580056562994564, -20.696727611449933, -13.747466331510001, -5.791336369342284, -17.860636430764675, -10.960272193109896, -9.684572616567914, 4.800389537581935, -15.716166987905439, -7.888156741049494, -17.74726494564308, -2.8415454999018497, -11.234713474784304, 7.857636403394139, -10.204299774313235, -16.704738992292917, -39.184290107847175, -6.656312030142072, -10.668235440806688, -38.59278584648408, 0.6782233231536834, -25.682239683512982, -12.542266834969697, -3.037037128939861, 0.6322769639350749, -4.2183136224348186, -9.521625516263759, -22.081357220494, -30.11599674620876, -14.445889848715499, -6.795856210805378, -13.495708815642416, -17.959915607706982, 1.5341452147565082, -21.33361423893802, -7.343349893136603, -9.84758532610581, -27.450660420566756, -30.127852594900443, -1.2175406018955286, -6.668456612992536, -21.63187347943219, -34.06272873159537, -20.760056597480386, -0.3166680696204369, -25.137032501165038, -21.316924495604546, -14.647713121797054, -5.225968014540051, -0.0827008801345972, -23.30352293339278, -34.35258012717707, -23.99974975536954, -28.370151626162595, -17.500328646934424, -9.306372626072209, -18.943224471241834, -0.8601985087039941, -23.21332629436319, 3.048793032438993, -18.147877159642313, -17.375497298138175, -11.000711170703632, -14.072427201734875, -11.330749397860941, -11.523013989956144, -30.244736599780204, -4.907809971558601, -21.34845752567977, -33.82438332974296, -6.911974024889048, -11.356610051070923, -19.7191105376844, -20.07045753429737, -13.509187043600129, -2.3247521385000676, -20.440154622780025, -20.679633518568355, -23.471132964057183, -1.158210792515245, 3.6776427130315534, -35.16704431287172, -8.400568365590132, -24.863971004913793], "policy_predator_policy_reward": [22.156996990689947, 20.694864810782942, -2.445695695809296, 27.354194349862254, 3.5403041072343377, 31.096038950243354, 20.643158437799173, 18.220642994486365, 37.61831204506977, 9.323362810939441, 12.95526456433277, 3.56456896865609, -0.00757467984253779, -13.702323080714187, 4.976533561691246, -7.31181315249902, 24.4759681616963, 36.522987453225106, 7.223216559061383, -1.8919495406278166, 31.324901527916037, 35.80553556536634, 4.903953970992468, 1.561831234865041, 27.103644107707964, 22.17606544224775, -13.753570641829768, 11.907559132364504, 14.01217038628094, 11.501674955667625, 16.597024520652923, 32.36268349058081, 43.403964912600294, 35.756148213388876, 30.67586873755553, 10.717586485344398, 20.005999702182518, 7.488932960837485, 17.17532644047695, -5.59265370179237, 31.343604850165537, 4.377668011363843, 8.456189153596029, 13.464355232623788, 0.8691108168803474, 18.500034416255495, -3.4078587500947624, -6.192920325069105, 23.564116731785003, 7.868217244025875, 7.544032287488557, 8.232281194610444, 33.80344141778538, 1.6910884735007405, 7.402048194173879, -1.7189571943701942, 14.244833330888664, 8.224593618679947, -10.844485748537359, -4.870787058250903, 9.565993104875618, 10.842606443750844, 9.1544261958683, 24.25505178871751, 43.226412754225926, 35.14216746146833, 9.918259847374525, 3.3943642129096787, 2.265851522989805, 19.07061935862356, 41.17172442662668, 36.013847266341415, 1.2955145367532204, -2.6519611830606014, 25.82459555019191, 25.539883816834127, 11.084832886665192, 13.999700783274196, 5.525604653339821, 0.5484696045399353, -8.72500379752947, 7.460449869659305, 3.3004249843283304, 5.136202260541316, 13.353393708626488, 5.68985732390103, 26.85654254731503, 17.30617189367298, 34.836955096941644, 25.395038395475908, 19.181769752331103, 9.710009945099877, 13.365780927053958, 0.2259314945567974, 16.643540163518644, 10.347877467766189, 22.7002905110459, 13.219540704368017, 3.606488520729009, -6.674778950242035, 21.70763677172488, 20.95959170615118, 15.270871598219522, -0.5841718119463213, -4.304908578258836, 24.000079230470426, 26.68053164310318, 28.220789198030392, 29.606617208985657, 30.64908798081523, 1.396786428682537, 1.0382947751085183, 15.701925049132512, -2.3650118231474577, 29.459540010186053, 13.80420694867832, 30.2535704508492, 37.87188701234153, 28.80560650423091, 12.71450669072984, 10.93215480825955, -10.298818669018672, 14.336661551005587, 35.93740345132444, 25.48092699642625, 17.152921994782833, 29.44744692294555, -0.15202067935143404, 18.746213614427234, -8.294277585347153, -4.360484400766856, 4.525886161036045, 33.14965906011678, 13.457386806668795, 22.30561791742223, 46.39954233693191, 42.63386830238622, 5.365631208352847, 17.121167814739813, 39.61913543758537, -1.3180546891739295, 36.31871198304281, 9.613275396506628, 8.99946985563781, 8.95873292134736, 28.927716021136316, -11.708344644264933, 13.428741661672927, 22.612990959669716, 23.813661629056682, -4.554069682620334, -1.5435163822576659, 28.027355063478076, 8.268399255806557, 30.350984870104224, 4.400009726172108, 11.890150397648123, 10.111271943759156, 17.33116631031863, 10.813688093151134, -4.033225465115137, 26.69472426083702, 23.890166006901502, -0.8441380269892171, 32.336986213980865, 28.152486985579507, 11.469258284916496, -1.6536383417992795, 13.320861631800724, 29.376053419558804, 24.550472046717445, 43.09829461276842, 3.932677097572989, 9.891270952205117, 8.198958797601874, 14.514261304539964, 17.29505983458827, 22.14316124078054, 32.39441790111233, 7.746497167482445, 14.033263652034744, 12.985110435165536, -0.6154104627626253, 5.264914739762764, 10.983451394004405, 29.89685785155565, 20.170853641340095, 21.18841339579658, 34.8428588373833, 12.09940709073106, 0.9263886339344296, 1.390032951096078, -2.4863995270829715, -4.868885898980146, 30.22271027309143, 40.11137835265198, -6.855824047104123, 23.656960778284414, 29.48924694088022, 20.23869506894743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6288429113148497, "mean_inference_ms": 1.6705904358043702, "mean_action_processing_ms": 0.2583243965048326, "mean_env_wait_ms": 0.14524951943828587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005350589752197266, "StateBufferConnector_ms": 0.0031529664993286133, "ViewRequirementAgentConnector_ms": 0.09260964393615723}, "num_episodes": 18, "episode_return_max": 39.580056562994535, "episode_return_min": -7.8576364033941335, "episode_return_mean": 14.67550595284316, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.3021636849563, "num_env_steps_trained_throughput_per_sec": 374.3021636849563, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 10776.266, "restore_workers_time_ms": 0.024, "training_step_time_ms": 10776.047, "sample_time_ms": 1258.001, "learn_time_ms": 9494.015, "learn_throughput": 421.318, "synch_weights_time_ms": 21.768}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "training_iteration": 117, "trial_id": "06536_00000", "date": "2024-08-11_17-35-24", "timestamp": 1723412124, "time_this_iter_s": 10.748876094818115, "time_total_s": 3665.109945297241, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5893e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3665.109945297241, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 47.49333333333334, "ram_util_percent": 82.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.950434654330214, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2736268524080514, "policy_loss": -0.004172497418282243, "vf_loss": 2.277796725059549, "vf_explained_var": 0.9479765094816685, "kl": 0.003356417972584168, "entropy": 0.35047535620008907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.863547991823267, "cur_kl_coeff": 8.131516293641281e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.566891360724414, "policy_loss": -0.0025275233209074016, "vf_loss": 2.5694188822514166, "vf_explained_var": 0.9406181431005871, "kl": 0.003329326918120602, "entropy": 0.24004259437480302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 42.689760494469155, "episode_reward_min": -7.8576364033941335, "episode_reward_mean": 14.93808456909936, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.689760494469134, "predator_policy": -12.499880987718504}, "policy_reward_max": {"prey_policy": 7.857636403394139, "predator_policy": 51.29249403791907}, "policy_reward_mean": {"prey_policy": -14.938084569099358, "predator_policy": 14.93808456909936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.747466331509992, 5.791336369342279, 17.86063643076468, 10.96027219310993, 9.684572616567927, -4.800389537581933, 15.716166987905448, 7.888156741049504, 17.74726494564306, 2.841545499901848, 11.234713474784296, -7.8576364033941335, 10.204299774313233, 16.704738992292924, 39.18429010784712, 6.65631203014212, 10.668235440806697, 38.59278584648404, -0.6782233231537012, 25.68223968351305, 12.542266834969702, 3.03703712893987, -0.6322769639350767, 4.218313622434843, 9.521625516263768, 22.08135722049398, 30.115996746208758, 14.445889848715495, 6.795856210805367, 13.49570881564242, 17.959915607706954, -1.534145214756518, 21.333614238938026, 7.343349893136587, 9.847585326105811, 27.45066042056678, 30.127852594900524, 1.2175406018955224, 6.668456612992518, 21.631873479432212, 34.062728731595385, 20.76005659748037, 0.31666806962045424, 25.137032501165045, 21.316924495604496, 14.647713121797064, 5.225968014540057, 0.08270088013459542, 23.30352293339281, 34.35258012717706, 23.99974975536955, 28.370151626162563, 17.500328646934406, 9.306372626072223, 18.94322447124184, 0.8601985087040065, 23.2133262943632, -3.0487930324389922, 18.147877159642295, 17.375497298138182, 11.00071117070364, 14.072427201734916, 11.330749397860933, 11.523013989956155, 30.244736599780204, 4.907809971558621, 21.34845752567976, 33.82438332974293, 6.911974024889055, 11.356610051070907, 19.7191105376844, 20.0704575342974, 13.50918704360014, 2.3247521385000818, 20.440154622780028, 20.679633518568334, 23.471132964057144, 1.1582107925152494, -3.677642713031556, 35.167044312871695, 8.400568365590152, 24.86397100491385, 24.531431950847942, 26.02702248881657, 20.763361223173217, 22.64635324826954, 42.689760494469155, 28.67152755331415, 28.105074915534075, 12.615710006489703, -7.608639429227749, 20.726685954316913, -0.6864109311424587, 15.268869000757059, 27.656597455720313, 29.723285483969562, 6.361237778829662, 9.575131703594444, -7.637984697021659, 12.360897753898998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.747466331510001, -5.791336369342284, -17.860636430764675, -10.960272193109896, -9.684572616567914, 4.800389537581935, -15.716166987905439, -7.888156741049494, -17.74726494564308, -2.8415454999018497, -11.234713474784304, 7.857636403394139, -10.204299774313235, -16.704738992292917, -39.184290107847175, -6.656312030142072, -10.668235440806688, -38.59278584648408, 0.6782233231536834, -25.682239683512982, -12.542266834969697, -3.037037128939861, 0.6322769639350749, -4.2183136224348186, -9.521625516263759, -22.081357220494, -30.11599674620876, -14.445889848715499, -6.795856210805378, -13.495708815642416, -17.959915607706982, 1.5341452147565082, -21.33361423893802, -7.343349893136603, -9.84758532610581, -27.450660420566756, -30.127852594900443, -1.2175406018955286, -6.668456612992536, -21.63187347943219, -34.06272873159537, -20.760056597480386, -0.3166680696204369, -25.137032501165038, -21.316924495604546, -14.647713121797054, -5.225968014540051, -0.0827008801345972, -23.30352293339278, -34.35258012717707, -23.99974975536954, -28.370151626162595, -17.500328646934424, -9.306372626072209, -18.943224471241834, -0.8601985087039941, -23.21332629436319, 3.048793032438993, -18.147877159642313, -17.375497298138175, -11.000711170703632, -14.072427201734875, -11.330749397860941, -11.523013989956144, -30.244736599780204, -4.907809971558601, -21.34845752567977, -33.82438332974296, -6.911974024889048, -11.356610051070923, -19.7191105376844, -20.07045753429737, -13.509187043600129, -2.3247521385000676, -20.440154622780025, -20.679633518568355, -23.471132964057183, -1.158210792515245, 3.6776427130315534, -35.16704431287172, -8.400568365590132, -24.863971004913793, -24.531431950847903, -26.027022488816577, -20.763361223173217, -22.646353248269556, -42.689760494469134, -28.671527553314178, -28.10507491553412, -12.615710006489701, 7.608639429227748, -20.72668595431691, 0.6864109311424471, -15.268869000757068, -27.65659745572033, -29.723285483969537, -6.361237778829679, -9.575131703594447, 7.637984697021664, -12.360897753898996], "policy_predator_policy_reward": [20.005999702182518, 7.488932960837485, 17.17532644047695, -5.59265370179237, 31.343604850165537, 4.377668011363843, 8.456189153596029, 13.464355232623788, 0.8691108168803474, 18.500034416255495, -3.4078587500947624, -6.192920325069105, 23.564116731785003, 7.868217244025875, 7.544032287488557, 8.232281194610444, 33.80344141778538, 1.6910884735007405, 7.402048194173879, -1.7189571943701942, 14.244833330888664, 8.224593618679947, -10.844485748537359, -4.870787058250903, 9.565993104875618, 10.842606443750844, 9.1544261958683, 24.25505178871751, 43.226412754225926, 35.14216746146833, 9.918259847374525, 3.3943642129096787, 2.265851522989805, 19.07061935862356, 41.17172442662668, 36.013847266341415, 1.2955145367532204, -2.6519611830606014, 25.82459555019191, 25.539883816834127, 11.084832886665192, 13.999700783274196, 5.525604653339821, 0.5484696045399353, -8.72500379752947, 7.460449869659305, 3.3004249843283304, 5.136202260541316, 13.353393708626488, 5.68985732390103, 26.85654254731503, 17.30617189367298, 34.836955096941644, 25.395038395475908, 19.181769752331103, 9.710009945099877, 13.365780927053958, 0.2259314945567974, 16.643540163518644, 10.347877467766189, 22.7002905110459, 13.219540704368017, 3.606488520729009, -6.674778950242035, 21.70763677172488, 20.95959170615118, 15.270871598219522, -0.5841718119463213, -4.304908578258836, 24.000079230470426, 26.68053164310318, 28.220789198030392, 29.606617208985657, 30.64908798081523, 1.396786428682537, 1.0382947751085183, 15.701925049132512, -2.3650118231474577, 29.459540010186053, 13.80420694867832, 30.2535704508492, 37.87188701234153, 28.80560650423091, 12.71450669072984, 10.93215480825955, -10.298818669018672, 14.336661551005587, 35.93740345132444, 25.48092699642625, 17.152921994782833, 29.44744692294555, -0.15202067935143404, 18.746213614427234, -8.294277585347153, -4.360484400766856, 4.525886161036045, 33.14965906011678, 13.457386806668795, 22.30561791742223, 46.39954233693191, 42.63386830238622, 5.365631208352847, 17.121167814739813, 39.61913543758537, -1.3180546891739295, 36.31871198304281, 9.613275396506628, 8.99946985563781, 8.95873292134736, 28.927716021136316, -11.708344644264933, 13.428741661672927, 22.612990959669716, 23.813661629056682, -4.554069682620334, -1.5435163822576659, 28.027355063478076, 8.268399255806557, 30.350984870104224, 4.400009726172108, 11.890150397648123, 10.111271943759156, 17.33116631031863, 10.813688093151134, -4.033225465115137, 26.69472426083702, 23.890166006901502, -0.8441380269892171, 32.336986213980865, 28.152486985579507, 11.469258284916496, -1.6536383417992795, 13.320861631800724, 29.376053419558804, 24.550472046717445, 43.09829461276842, 3.932677097572989, 9.891270952205117, 8.198958797601874, 14.514261304539964, 17.29505983458827, 22.14316124078054, 32.39441790111233, 7.746497167482445, 14.033263652034744, 12.985110435165536, -0.6154104627626253, 5.264914739762764, 10.983451394004405, 29.89685785155565, 20.170853641340095, 21.18841339579658, 34.8428588373833, 12.09940709073106, 0.9263886339344296, 1.390032951096078, -2.4863995270829715, -4.868885898980146, 30.22271027309143, 40.11137835265198, -6.855824047104123, 23.656960778284414, 29.48924694088022, 20.23869506894743, 17.929558473311733, 31.13330542838412, 36.72319681881707, 15.33084815881608, 34.48913330840916, 7.037589137937285, 13.078378318632529, 32.2143281779066, 34.08702695101921, 51.29249403791907, 24.893766497753074, 32.449288608875285, 20.26398116862816, 35.94616866244006, 17.597381030826476, 7.634038982152923, -12.499880987718504, -2.717397870736992, 21.024204303050304, 20.42916760558351, 0.7935440444697406, -2.1663659067546366, 9.925372353266741, 20.61236564824741, 22.817291000521543, 32.49590391091906, 26.74484994545455, 32.70172102248455, 10.936645456257748, 1.7858301014015794, 11.712408779744074, 7.43785462744477, -9.833113453542705, -5.442855940500607, 13.620261464799093, 11.101534042998908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6284156417466791, "mean_inference_ms": 1.6696050118793364, "mean_action_processing_ms": 0.2581238035194343, "mean_env_wait_ms": 0.1451727792661571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052825212478637695, "StateBufferConnector_ms": 0.0028592348098754883, "ViewRequirementAgentConnector_ms": 0.08565843105316162}, "num_episodes": 18, "episode_return_max": 42.689760494469155, "episode_return_min": -7.8576364033941335, "episode_return_mean": 14.93808456909936, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.9891071796175, "num_env_steps_trained_throughput_per_sec": 378.9891071796175, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 10753.537, "restore_workers_time_ms": 0.026, "training_step_time_ms": 10753.301, "sample_time_ms": 1215.229, "learn_time_ms": 9518.183, "learn_throughput": 420.248, "synch_weights_time_ms": 17.709}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 118, "trial_id": "06536_00000", "date": "2024-08-11_17-35-34", "timestamp": 1723412134, "time_this_iter_s": 10.583676815032959, "time_total_s": 3675.693622112274, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5893ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3675.693622112274, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 46.91999999999999, "ram_util_percent": 83.07333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.78565750233829, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2243820328886312, "policy_loss": -0.006335550696288313, "vf_loss": 2.2307158219317595, "vf_explained_var": 0.9453261841088534, "kl": 0.004515691520224478, "entropy": 0.3659262752470871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7911591842060997, "cur_kl_coeff": 4.065758146820641e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.64568921567271, "policy_loss": -0.0024769491582576717, "vf_loss": 2.648166162437863, "vf_explained_var": 0.9313489808291985, "kl": 0.004116526010358673, "entropy": 0.2386646132541712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "env_runners": {"episode_reward_max": 42.689760494469155, "episode_reward_min": -7.637984697021659, "episode_reward_mean": 15.88995578297904, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.689760494469134, "predator_policy": -12.499880987718504}, "policy_reward_max": {"prey_policy": 7.637984697021664, "predator_policy": 51.29249403791907}, "policy_reward_mean": {"prey_policy": -15.889955782979039, "predator_policy": 15.88995578297904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.218313622434843, 9.521625516263768, 22.08135722049398, 30.115996746208758, 14.445889848715495, 6.795856210805367, 13.49570881564242, 17.959915607706954, -1.534145214756518, 21.333614238938026, 7.343349893136587, 9.847585326105811, 27.45066042056678, 30.127852594900524, 1.2175406018955224, 6.668456612992518, 21.631873479432212, 34.062728731595385, 20.76005659748037, 0.31666806962045424, 25.137032501165045, 21.316924495604496, 14.647713121797064, 5.225968014540057, 0.08270088013459542, 23.30352293339281, 34.35258012717706, 23.99974975536955, 28.370151626162563, 17.500328646934406, 9.306372626072223, 18.94322447124184, 0.8601985087040065, 23.2133262943632, -3.0487930324389922, 18.147877159642295, 17.375497298138182, 11.00071117070364, 14.072427201734916, 11.330749397860933, 11.523013989956155, 30.244736599780204, 4.907809971558621, 21.34845752567976, 33.82438332974293, 6.911974024889055, 11.356610051070907, 19.7191105376844, 20.0704575342974, 13.50918704360014, 2.3247521385000818, 20.440154622780028, 20.679633518568334, 23.471132964057144, 1.1582107925152494, -3.677642713031556, 35.167044312871695, 8.400568365590152, 24.86397100491385, 24.531431950847942, 26.02702248881657, 20.763361223173217, 22.64635324826954, 42.689760494469155, 28.67152755331415, 28.105074915534075, 12.615710006489703, -7.608639429227749, 20.726685954316913, -0.6864109311424587, 15.268869000757059, 27.656597455720313, 29.723285483969562, 6.361237778829662, 9.575131703594444, -7.637984697021659, 12.360897753898998, 21.665090183627154, 24.704572086847513, 14.2008241401167, 25.070124764566504, 20.43035901980389, 6.122791291749949, 29.526502209750554, 18.911364822018825, -3.4548372316106963, 40.55397076810884, 0.5927869129162389, 19.137482195605738, 4.337422540898169, 6.432553139192613, 21.327144116190247, 2.878187298832661, 22.041464928620965, 36.14351833362884, 1.3081890374475496, 3.0582900688775183, 10.813121132149279, 24.496048977051494, 7.665961853400518], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.2183136224348186, -9.521625516263759, -22.081357220494, -30.11599674620876, -14.445889848715499, -6.795856210805378, -13.495708815642416, -17.959915607706982, 1.5341452147565082, -21.33361423893802, -7.343349893136603, -9.84758532610581, -27.450660420566756, -30.127852594900443, -1.2175406018955286, -6.668456612992536, -21.63187347943219, -34.06272873159537, -20.760056597480386, -0.3166680696204369, -25.137032501165038, -21.316924495604546, -14.647713121797054, -5.225968014540051, -0.0827008801345972, -23.30352293339278, -34.35258012717707, -23.99974975536954, -28.370151626162595, -17.500328646934424, -9.306372626072209, -18.943224471241834, -0.8601985087039941, -23.21332629436319, 3.048793032438993, -18.147877159642313, -17.375497298138175, -11.000711170703632, -14.072427201734875, -11.330749397860941, -11.523013989956144, -30.244736599780204, -4.907809971558601, -21.34845752567977, -33.82438332974296, -6.911974024889048, -11.356610051070923, -19.7191105376844, -20.07045753429737, -13.509187043600129, -2.3247521385000676, -20.440154622780025, -20.679633518568355, -23.471132964057183, -1.158210792515245, 3.6776427130315534, -35.16704431287172, -8.400568365590132, -24.863971004913793, -24.531431950847903, -26.027022488816577, -20.763361223173217, -22.646353248269556, -42.689760494469134, -28.671527553314178, -28.10507491553412, -12.615710006489701, 7.608639429227748, -20.72668595431691, 0.6864109311424471, -15.268869000757068, -27.65659745572033, -29.723285483969537, -6.361237778829679, -9.575131703594447, 7.637984697021664, -12.360897753898996, -21.665090183627154, -24.70457208684752, -14.200824140116685, -25.070124764566458, -20.430359019803873, -6.122791291749953, -29.526502209750593, -18.911364822018804, 3.4548372316106883, -40.553970768108826, -0.5927869129162477, -19.13748219560572, -4.337422540898169, -6.432553139192621, -21.32714411619025, -2.8781872988326542, -22.041464928620943, -36.14351833362879, -1.3081890374475296, -3.058290068877519, -10.813121132149265, -24.49604897705147, -7.665961853400498], "policy_predator_policy_reward": [3.3004249843283304, 5.136202260541316, 13.353393708626488, 5.68985732390103, 26.85654254731503, 17.30617189367298, 34.836955096941644, 25.395038395475908, 19.181769752331103, 9.710009945099877, 13.365780927053958, 0.2259314945567974, 16.643540163518644, 10.347877467766189, 22.7002905110459, 13.219540704368017, 3.606488520729009, -6.674778950242035, 21.70763677172488, 20.95959170615118, 15.270871598219522, -0.5841718119463213, -4.304908578258836, 24.000079230470426, 26.68053164310318, 28.220789198030392, 29.606617208985657, 30.64908798081523, 1.396786428682537, 1.0382947751085183, 15.701925049132512, -2.3650118231474577, 29.459540010186053, 13.80420694867832, 30.2535704508492, 37.87188701234153, 28.80560650423091, 12.71450669072984, 10.93215480825955, -10.298818669018672, 14.336661551005587, 35.93740345132444, 25.48092699642625, 17.152921994782833, 29.44744692294555, -0.15202067935143404, 18.746213614427234, -8.294277585347153, -4.360484400766856, 4.525886161036045, 33.14965906011678, 13.457386806668795, 22.30561791742223, 46.39954233693191, 42.63386830238622, 5.365631208352847, 17.121167814739813, 39.61913543758537, -1.3180546891739295, 36.31871198304281, 9.613275396506628, 8.99946985563781, 8.95873292134736, 28.927716021136316, -11.708344644264933, 13.428741661672927, 22.612990959669716, 23.813661629056682, -4.554069682620334, -1.5435163822576659, 28.027355063478076, 8.268399255806557, 30.350984870104224, 4.400009726172108, 11.890150397648123, 10.111271943759156, 17.33116631031863, 10.813688093151134, -4.033225465115137, 26.69472426083702, 23.890166006901502, -0.8441380269892171, 32.336986213980865, 28.152486985579507, 11.469258284916496, -1.6536383417992795, 13.320861631800724, 29.376053419558804, 24.550472046717445, 43.09829461276842, 3.932677097572989, 9.891270952205117, 8.198958797601874, 14.514261304539964, 17.29505983458827, 22.14316124078054, 32.39441790111233, 7.746497167482445, 14.033263652034744, 12.985110435165536, -0.6154104627626253, 5.264914739762764, 10.983451394004405, 29.89685785155565, 20.170853641340095, 21.18841339579658, 34.8428588373833, 12.09940709073106, 0.9263886339344296, 1.390032951096078, -2.4863995270829715, -4.868885898980146, 30.22271027309143, 40.11137835265198, -6.855824047104123, 23.656960778284414, 29.48924694088022, 20.23869506894743, 17.929558473311733, 31.13330542838412, 36.72319681881707, 15.33084815881608, 34.48913330840916, 7.037589137937285, 13.078378318632529, 32.2143281779066, 34.08702695101921, 51.29249403791907, 24.893766497753074, 32.449288608875285, 20.26398116862816, 35.94616866244006, 17.597381030826476, 7.634038982152923, -12.499880987718504, -2.717397870736992, 21.024204303050304, 20.42916760558351, 0.7935440444697406, -2.1663659067546366, 9.925372353266741, 20.61236564824741, 22.817291000521543, 32.49590391091906, 26.74484994545455, 32.70172102248455, 10.936645456257748, 1.7858301014015794, 11.712408779744074, 7.43785462744477, -9.833113453542705, -5.442855940500607, 13.620261464799093, 11.101534042998908, 18.062395251597902, 25.267785115656388, 8.810046587412366, 40.59909758628264, 22.843817295934052, 5.557830984299343, 17.569991328742983, 32.57025820038997, 16.208928945008882, 24.65178909459885, -0.7549039586648121, 13.000486542164712, 36.19714362018612, 22.855860799315078, 16.47314149687498, 21.349588147162635, 1.2777826818586693, -8.187457145080057, 41.208657929588426, 39.89928360662918, -10.799386979694008, 11.984960805526505, 32.40950386589918, 5.865460525312287, 6.9208684719258144, 1.753976609870552, -3.361762153610149, 16.226868431995392, 25.59877864339074, 17.055509588989736, -2.6083697471754297, 8.36474434484074, 8.725253462385606, 35.35767639485624, 29.97481680771441, 42.31221985954322, 7.446339624200808, -4.829961549305743, 0.392781080079601, 5.723799057675448, 21.30461682893192, 0.3216254353666219, 20.47625262878476, 28.515845325318196, -2.45692981107179, 17.788853517872816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6276114165484321, "mean_inference_ms": 1.6674902048599356, "mean_action_processing_ms": 0.2577497521600346, "mean_env_wait_ms": 0.14498202679411473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004948139190673828, "StateBufferConnector_ms": 0.0029230117797851562, "ViewRequirementAgentConnector_ms": 0.0847024917602539}, "num_episodes": 23, "episode_return_max": 42.689760494469155, "episode_return_min": -7.637984697021659, "episode_return_mean": 15.88995578297904, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.7719598997418, "num_env_steps_trained_throughput_per_sec": 384.7719598997418, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 10708.063, "restore_workers_time_ms": 0.028, "training_step_time_ms": 10707.823, "sample_time_ms": 1182.94, "learn_time_ms": 9505.157, "learn_throughput": 420.824, "synch_weights_time_ms": 17.519}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "training_iteration": 119, "trial_id": "06536_00000", "date": "2024-08-11_17-35-45", "timestamp": 1723412145, "time_this_iter_s": 10.438733100891113, "time_total_s": 3686.1323552131653, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33165c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3686.1323552131653, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 46.813333333333325, "ram_util_percent": 83.01333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.88631258358558, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.870026524613301, "policy_loss": -0.013859090264789604, "vf_loss": 2.8838820026566583, "vf_explained_var": 0.9141685866440336, "kl": 0.01847626273812132, "entropy": 0.37530118810633817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8267121577389025, "cur_kl_coeff": 2.0328790734103204e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1378253668073626, "policy_loss": -0.0029788259080507687, "vf_loss": 3.1408041888443883, "vf_explained_var": 0.9113225963380601, "kl": 0.0051537606448925025, "entropy": 0.202742341598348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 42.689760494469155, "episode_reward_min": -9.962769740891648, "episode_reward_mean": 16.04633983135835, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.689760494469134, "predator_policy": -15.214681957610757}, "policy_reward_max": {"prey_policy": 9.96276974089165, "predator_policy": 51.29249403791907}, "policy_reward_mean": {"prey_policy": -16.04633983135835, "predator_policy": 16.04633983135835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.647713121797064, 5.225968014540057, 0.08270088013459542, 23.30352293339281, 34.35258012717706, 23.99974975536955, 28.370151626162563, 17.500328646934406, 9.306372626072223, 18.94322447124184, 0.8601985087040065, 23.2133262943632, -3.0487930324389922, 18.147877159642295, 17.375497298138182, 11.00071117070364, 14.072427201734916, 11.330749397860933, 11.523013989956155, 30.244736599780204, 4.907809971558621, 21.34845752567976, 33.82438332974293, 6.911974024889055, 11.356610051070907, 19.7191105376844, 20.0704575342974, 13.50918704360014, 2.3247521385000818, 20.440154622780028, 20.679633518568334, 23.471132964057144, 1.1582107925152494, -3.677642713031556, 35.167044312871695, 8.400568365590152, 24.86397100491385, 24.531431950847942, 26.02702248881657, 20.763361223173217, 22.64635324826954, 42.689760494469155, 28.67152755331415, 28.105074915534075, 12.615710006489703, -7.608639429227749, 20.726685954316913, -0.6864109311424587, 15.268869000757059, 27.656597455720313, 29.723285483969562, 6.361237778829662, 9.575131703594444, -7.637984697021659, 12.360897753898998, 21.665090183627154, 24.704572086847513, 14.2008241401167, 25.070124764566504, 20.43035901980389, 6.122791291749949, 29.526502209750554, 18.911364822018825, -3.4548372316106963, 40.55397076810884, 0.5927869129162389, 19.137482195605738, 4.337422540898169, 6.432553139192613, 21.327144116190247, 2.878187298832661, 22.041464928620965, 36.14351833362884, 1.3081890374475496, 3.0582900688775183, 10.813121132149279, 24.496048977051494, 7.665961853400518, 5.864458938466878, 17.26639821836496, 31.383474468209283, 15.859383113498762, 13.624387531447445, 19.509341570860084, 15.185892901134663, 11.046013687537704, 36.05648650363163, 7.043074360967512, -9.962769740891648, 19.259709659414938, 18.644206560497977, 10.63245854877696, 30.549841267485945, 14.366928807402912, 17.370053263366245, 13.485417128049951, 10.479047711610773, 6.681906258873958, 30.112598737225262, 25.49495727894758], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.647713121797054, -5.225968014540051, -0.0827008801345972, -23.30352293339278, -34.35258012717707, -23.99974975536954, -28.370151626162595, -17.500328646934424, -9.306372626072209, -18.943224471241834, -0.8601985087039941, -23.21332629436319, 3.048793032438993, -18.147877159642313, -17.375497298138175, -11.000711170703632, -14.072427201734875, -11.330749397860941, -11.523013989956144, -30.244736599780204, -4.907809971558601, -21.34845752567977, -33.82438332974296, -6.911974024889048, -11.356610051070923, -19.7191105376844, -20.07045753429737, -13.509187043600129, -2.3247521385000676, -20.440154622780025, -20.679633518568355, -23.471132964057183, -1.158210792515245, 3.6776427130315534, -35.16704431287172, -8.400568365590132, -24.863971004913793, -24.531431950847903, -26.027022488816577, -20.763361223173217, -22.646353248269556, -42.689760494469134, -28.671527553314178, -28.10507491553412, -12.615710006489701, 7.608639429227748, -20.72668595431691, 0.6864109311424471, -15.268869000757068, -27.65659745572033, -29.723285483969537, -6.361237778829679, -9.575131703594447, 7.637984697021664, -12.360897753898996, -21.665090183627154, -24.70457208684752, -14.200824140116685, -25.070124764566458, -20.430359019803873, -6.122791291749953, -29.526502209750593, -18.911364822018804, 3.4548372316106883, -40.553970768108826, -0.5927869129162477, -19.13748219560572, -4.337422540898169, -6.432553139192621, -21.32714411619025, -2.8781872988326542, -22.041464928620943, -36.14351833362879, -1.3081890374475296, -3.058290068877519, -10.813121132149265, -24.49604897705147, -7.665961853400498, -5.864458938466879, -17.26639821836496, -31.383474468209275, -15.859383113498772, -13.624387531447468, -19.50934157086003, -15.185892901134654, -11.04601368753768, -36.05648650363158, -7.043074360967508, 9.96276974089165, -19.25970965941492, -18.644206560497974, -10.632458548776995, -30.54984126748593, -14.36692880740291, -17.37005326336627, -13.485417128049953, -10.479047711610825, -6.68190625887396, -30.112598737225223, -25.49495727894758], "policy_predator_policy_reward": [29.44744692294555, -0.15202067935143404, 18.746213614427234, -8.294277585347153, -4.360484400766856, 4.525886161036045, 33.14965906011678, 13.457386806668795, 22.30561791742223, 46.39954233693191, 42.63386830238622, 5.365631208352847, 17.121167814739813, 39.61913543758537, -1.3180546891739295, 36.31871198304281, 9.613275396506628, 8.99946985563781, 8.95873292134736, 28.927716021136316, -11.708344644264933, 13.428741661672927, 22.612990959669716, 23.813661629056682, -4.554069682620334, -1.5435163822576659, 28.027355063478076, 8.268399255806557, 30.350984870104224, 4.400009726172108, 11.890150397648123, 10.111271943759156, 17.33116631031863, 10.813688093151134, -4.033225465115137, 26.69472426083702, 23.890166006901502, -0.8441380269892171, 32.336986213980865, 28.152486985579507, 11.469258284916496, -1.6536383417992795, 13.320861631800724, 29.376053419558804, 24.550472046717445, 43.09829461276842, 3.932677097572989, 9.891270952205117, 8.198958797601874, 14.514261304539964, 17.29505983458827, 22.14316124078054, 32.39441790111233, 7.746497167482445, 14.033263652034744, 12.985110435165536, -0.6154104627626253, 5.264914739762764, 10.983451394004405, 29.89685785155565, 20.170853641340095, 21.18841339579658, 34.8428588373833, 12.09940709073106, 0.9263886339344296, 1.390032951096078, -2.4863995270829715, -4.868885898980146, 30.22271027309143, 40.11137835265198, -6.855824047104123, 23.656960778284414, 29.48924694088022, 20.23869506894743, 17.929558473311733, 31.13330542838412, 36.72319681881707, 15.33084815881608, 34.48913330840916, 7.037589137937285, 13.078378318632529, 32.2143281779066, 34.08702695101921, 51.29249403791907, 24.893766497753074, 32.449288608875285, 20.26398116862816, 35.94616866244006, 17.597381030826476, 7.634038982152923, -12.499880987718504, -2.717397870736992, 21.024204303050304, 20.42916760558351, 0.7935440444697406, -2.1663659067546366, 9.925372353266741, 20.61236564824741, 22.817291000521543, 32.49590391091906, 26.74484994545455, 32.70172102248455, 10.936645456257748, 1.7858301014015794, 11.712408779744074, 7.43785462744477, -9.833113453542705, -5.442855940500607, 13.620261464799093, 11.101534042998908, 18.062395251597902, 25.267785115656388, 8.810046587412366, 40.59909758628264, 22.843817295934052, 5.557830984299343, 17.569991328742983, 32.57025820038997, 16.208928945008882, 24.65178909459885, -0.7549039586648121, 13.000486542164712, 36.19714362018612, 22.855860799315078, 16.47314149687498, 21.349588147162635, 1.2777826818586693, -8.187457145080057, 41.208657929588426, 39.89928360662918, -10.799386979694008, 11.984960805526505, 32.40950386589918, 5.865460525312287, 6.9208684719258144, 1.753976609870552, -3.361762153610149, 16.226868431995392, 25.59877864339074, 17.055509588989736, -2.6083697471754297, 8.36474434484074, 8.725253462385606, 35.35767639485624, 29.97481680771441, 42.31221985954322, 7.446339624200808, -4.829961549305743, 0.392781080079601, 5.723799057675448, 21.30461682893192, 0.3216254353666219, 20.47625262878476, 28.515845325318196, -2.45692981107179, 17.788853517872816, 9.098622099414252, 2.6302957775195086, 12.131285597291438, 22.401510839438465, 40.892189927944465, 21.87475900847408, 28.21596940653829, 3.5027968204593307, 22.169815019263147, 5.078960043631794, 28.53285449333816, 10.48582864838195, 15.291741242310138, 15.080044559959187, 4.334554752072634, 17.757472623002755, 41.752473719236086, 30.360499288027125, 10.415271427128118, 3.670877294806897, -15.214681957610757, -4.710857524172537, 19.04404989461969, 19.47536942421018, 26.56864049183571, 10.71977262916024, 6.3158076301620945, 14.949109467391864, 21.050333662254772, 40.04934887271709, 15.689670356866465, 13.04418725793936, 12.55089020651554, 22.189216320217007, 8.423415021809427, 18.54741923429049, 14.917226131809816, 6.040869291411795, -0.8735702791373718, 14.237382796885278, 29.639443643121343, 30.585753831329157, 22.634724747594362, 28.3551898103008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.626766802369102, "mean_inference_ms": 1.6638020862463376, "mean_action_processing_ms": 0.257362676253001, "mean_env_wait_ms": 0.14471306586897123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00495755672454834, "StateBufferConnector_ms": 0.0029796361923217773, "ViewRequirementAgentConnector_ms": 0.085113525390625}, "num_episodes": 22, "episode_return_max": 42.689760494469155, "episode_return_min": -9.962769740891648, "episode_return_mean": 16.04633983135835, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.4146817068168, "num_env_steps_trained_throughput_per_sec": 384.4146817068168, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 10703.681, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10703.469, "sample_time_ms": 1205.89, "learn_time_ms": 9478.928, "learn_throughput": 421.989, "synch_weights_time_ms": 16.54}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 120, "trial_id": "06536_00000", "date": "2024-08-11_17-35-55", "timestamp": 1723412155, "time_this_iter_s": 10.442360162734985, "time_total_s": 3696.5747153759003, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33165cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3696.5747153759003, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 45.25333333333334, "ram_util_percent": 83.06}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9590849512567123, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4687852402528128, "policy_loss": -0.00790223090928824, "vf_loss": 2.476686187957724, "vf_explained_var": 0.9500308205063145, "kl": 0.006581015729517868, "entropy": 0.38285489473491907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7748600363731386, "cur_kl_coeff": 2.0328790734103204e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5034734973831783, "policy_loss": -0.0024531695655443603, "vf_loss": 2.5059266679501406, "vf_explained_var": 0.9507630147000469, "kl": 0.002839977199580442, "entropy": 0.2152305278749693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "env_runners": {"episode_reward_max": 46.25405662371304, "episode_reward_min": -9.962769740891648, "episode_reward_mean": 16.993286261663698, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.254056623713, "predator_policy": -15.214681957610757}, "policy_reward_max": {"prey_policy": 9.96276974089165, "predator_policy": 54.94140188557235}, "policy_reward_mean": {"prey_policy": -16.993286261663695, "predator_policy": 16.993286261663695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.523013989956155, 30.244736599780204, 4.907809971558621, 21.34845752567976, 33.82438332974293, 6.911974024889055, 11.356610051070907, 19.7191105376844, 20.0704575342974, 13.50918704360014, 2.3247521385000818, 20.440154622780028, 20.679633518568334, 23.471132964057144, 1.1582107925152494, -3.677642713031556, 35.167044312871695, 8.400568365590152, 24.86397100491385, 24.531431950847942, 26.02702248881657, 20.763361223173217, 22.64635324826954, 42.689760494469155, 28.67152755331415, 28.105074915534075, 12.615710006489703, -7.608639429227749, 20.726685954316913, -0.6864109311424587, 15.268869000757059, 27.656597455720313, 29.723285483969562, 6.361237778829662, 9.575131703594444, -7.637984697021659, 12.360897753898998, 21.665090183627154, 24.704572086847513, 14.2008241401167, 25.070124764566504, 20.43035901980389, 6.122791291749949, 29.526502209750554, 18.911364822018825, -3.4548372316106963, 40.55397076810884, 0.5927869129162389, 19.137482195605738, 4.337422540898169, 6.432553139192613, 21.327144116190247, 2.878187298832661, 22.041464928620965, 36.14351833362884, 1.3081890374475496, 3.0582900688775183, 10.813121132149279, 24.496048977051494, 7.665961853400518, 5.864458938466878, 17.26639821836496, 31.383474468209283, 15.859383113498762, 13.624387531447445, 19.509341570860084, 15.185892901134663, 11.046013687537704, 36.05648650363163, 7.043074360967512, -9.962769740891648, 19.259709659414938, 18.644206560497977, 10.63245854877696, 30.549841267485945, 14.366928807402912, 17.370053263366245, 13.485417128049951, 10.479047711610773, 6.681906258873958, 30.112598737225262, 25.49495727894758, 27.665028907737714, 12.126068862021716, 18.75491380257383, 38.94034647611012, 24.99942580774352, 21.960874967179503, 33.66287206914601, 6.100085873658085, 11.156849853449154, 15.566458782156127, 26.952700871285256, 15.434658266656031, 6.163181141672278, 13.050069323617828, 20.58949069332713, 12.71739888527929, 11.284468024738056, 46.25405662371304], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.523013989956144, -30.244736599780204, -4.907809971558601, -21.34845752567977, -33.82438332974296, -6.911974024889048, -11.356610051070923, -19.7191105376844, -20.07045753429737, -13.509187043600129, -2.3247521385000676, -20.440154622780025, -20.679633518568355, -23.471132964057183, -1.158210792515245, 3.6776427130315534, -35.16704431287172, -8.400568365590132, -24.863971004913793, -24.531431950847903, -26.027022488816577, -20.763361223173217, -22.646353248269556, -42.689760494469134, -28.671527553314178, -28.10507491553412, -12.615710006489701, 7.608639429227748, -20.72668595431691, 0.6864109311424471, -15.268869000757068, -27.65659745572033, -29.723285483969537, -6.361237778829679, -9.575131703594447, 7.637984697021664, -12.360897753898996, -21.665090183627154, -24.70457208684752, -14.200824140116685, -25.070124764566458, -20.430359019803873, -6.122791291749953, -29.526502209750593, -18.911364822018804, 3.4548372316106883, -40.553970768108826, -0.5927869129162477, -19.13748219560572, -4.337422540898169, -6.432553139192621, -21.32714411619025, -2.8781872988326542, -22.041464928620943, -36.14351833362879, -1.3081890374475296, -3.058290068877519, -10.813121132149265, -24.49604897705147, -7.665961853400498, -5.864458938466879, -17.26639821836496, -31.383474468209275, -15.859383113498772, -13.624387531447468, -19.50934157086003, -15.185892901134654, -11.04601368753768, -36.05648650363158, -7.043074360967508, 9.96276974089165, -19.25970965941492, -18.644206560497974, -10.632458548776995, -30.54984126748593, -14.36692880740291, -17.37005326336627, -13.485417128049953, -10.479047711610825, -6.68190625887396, -30.112598737225223, -25.49495727894758, -27.665028907737714, -12.126068862021732, -18.754913802573864, -38.94034647611023, -24.999425807743517, -21.96087496717947, -33.66287206914602, -6.10008587365808, -11.156849853449149, -15.566458782156143, -26.95270087128522, -15.434658266656037, -6.163181141672278, -13.050069323617809, -20.589490693327132, -12.717398885279305, -11.28446802473805, -46.254056623713], "policy_predator_policy_reward": [23.890166006901502, -0.8441380269892171, 32.336986213980865, 28.152486985579507, 11.469258284916496, -1.6536383417992795, 13.320861631800724, 29.376053419558804, 24.550472046717445, 43.09829461276842, 3.932677097572989, 9.891270952205117, 8.198958797601874, 14.514261304539964, 17.29505983458827, 22.14316124078054, 32.39441790111233, 7.746497167482445, 14.033263652034744, 12.985110435165536, -0.6154104627626253, 5.264914739762764, 10.983451394004405, 29.89685785155565, 20.170853641340095, 21.18841339579658, 34.8428588373833, 12.09940709073106, 0.9263886339344296, 1.390032951096078, -2.4863995270829715, -4.868885898980146, 30.22271027309143, 40.11137835265198, -6.855824047104123, 23.656960778284414, 29.48924694088022, 20.23869506894743, 17.929558473311733, 31.13330542838412, 36.72319681881707, 15.33084815881608, 34.48913330840916, 7.037589137937285, 13.078378318632529, 32.2143281779066, 34.08702695101921, 51.29249403791907, 24.893766497753074, 32.449288608875285, 20.26398116862816, 35.94616866244006, 17.597381030826476, 7.634038982152923, -12.499880987718504, -2.717397870736992, 21.024204303050304, 20.42916760558351, 0.7935440444697406, -2.1663659067546366, 9.925372353266741, 20.61236564824741, 22.817291000521543, 32.49590391091906, 26.74484994545455, 32.70172102248455, 10.936645456257748, 1.7858301014015794, 11.712408779744074, 7.43785462744477, -9.833113453542705, -5.442855940500607, 13.620261464799093, 11.101534042998908, 18.062395251597902, 25.267785115656388, 8.810046587412366, 40.59909758628264, 22.843817295934052, 5.557830984299343, 17.569991328742983, 32.57025820038997, 16.208928945008882, 24.65178909459885, -0.7549039586648121, 13.000486542164712, 36.19714362018612, 22.855860799315078, 16.47314149687498, 21.349588147162635, 1.2777826818586693, -8.187457145080057, 41.208657929588426, 39.89928360662918, -10.799386979694008, 11.984960805526505, 32.40950386589918, 5.865460525312287, 6.9208684719258144, 1.753976609870552, -3.361762153610149, 16.226868431995392, 25.59877864339074, 17.055509588989736, -2.6083697471754297, 8.36474434484074, 8.725253462385606, 35.35767639485624, 29.97481680771441, 42.31221985954322, 7.446339624200808, -4.829961549305743, 0.392781080079601, 5.723799057675448, 21.30461682893192, 0.3216254353666219, 20.47625262878476, 28.515845325318196, -2.45692981107179, 17.788853517872816, 9.098622099414252, 2.6302957775195086, 12.131285597291438, 22.401510839438465, 40.892189927944465, 21.87475900847408, 28.21596940653829, 3.5027968204593307, 22.169815019263147, 5.078960043631794, 28.53285449333816, 10.48582864838195, 15.291741242310138, 15.080044559959187, 4.334554752072634, 17.757472623002755, 41.752473719236086, 30.360499288027125, 10.415271427128118, 3.670877294806897, -15.214681957610757, -4.710857524172537, 19.04404989461969, 19.47536942421018, 26.56864049183571, 10.71977262916024, 6.3158076301620945, 14.949109467391864, 21.050333662254772, 40.04934887271709, 15.689670356866465, 13.04418725793936, 12.55089020651554, 22.189216320217007, 8.423415021809427, 18.54741923429049, 14.917226131809816, 6.040869291411795, -0.8735702791373718, 14.237382796885278, 29.639443643121343, 30.585753831329157, 22.634724747594362, 28.3551898103008, 23.361332750355924, 31.9687250651195, 0.5717197712733313, 23.68041795277014, 11.837069589363237, 25.67275801578446, 33.73656842456187, 44.14412452765853, 30.661211309332007, 19.337640306155144, 12.845842149282173, 31.075907785076794, 31.110004464552695, 36.21573967373936, 2.6871099448913114, 9.51306180242486, 13.445091259325848, 8.868608447572448, 23.072129007357095, 8.06078855695515, 18.916636745814436, 34.98876499675601, 22.518212156879898, 8.351104376432158, 5.730171356233118, 6.596190927111438, 5.832894081801397, 20.26724456543421, 22.388370682310743, 18.79061070434354, 15.998525628036115, 9.436272142522496, 1.6493856104667737, 20.919550439009342, 54.94140188557235, 37.56671136185366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6261546681095328, "mean_inference_ms": 1.6634172793321245, "mean_action_processing_ms": 0.257279877086677, "mean_env_wait_ms": 0.14462836961137288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047032833099365234, "StateBufferConnector_ms": 0.0029941797256469727, "ViewRequirementAgentConnector_ms": 0.10705053806304932}, "num_episodes": 18, "episode_return_max": 46.25405662371304, "episode_return_min": -9.962769740891648, "episode_return_mean": 16.993286261663698, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.9453512218415, "num_env_steps_trained_throughput_per_sec": 376.9453512218415, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 10671.762, "restore_workers_time_ms": 0.021, "training_step_time_ms": 10671.514, "sample_time_ms": 1209.812, "learn_time_ms": 9442.375, "learn_throughput": 423.622, "synch_weights_time_ms": 17.231}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "training_iteration": 121, "trial_id": "06536_00000", "date": "2024-08-11_17-36-06", "timestamp": 1723412166, "time_this_iter_s": 10.665634155273438, "time_total_s": 3707.2403495311737, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316e04c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3707.2403495311737, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 46.18, "ram_util_percent": 83.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6533691895504794, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.783729403776427, "policy_loss": -0.005657770510879345, "vf_loss": 1.789386284785966, "vf_explained_var": 0.9462035703162353, "kl": 0.004551069480142361, "entropy": 0.3263714308850467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4498746813289705, "cur_kl_coeff": 1.0164395367051602e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.319535405862899, "policy_loss": -0.002134181451663454, "vf_loss": 2.3216695844811737, "vf_explained_var": 0.9244308166718357, "kl": 0.0032962701931460647, "entropy": 0.18525616593225291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 46.25405662371304, "episode_reward_min": -9.962769740891648, "episode_reward_mean": 16.93925604086921, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.254056623713, "predator_policy": -15.214681957610757}, "policy_reward_max": {"prey_policy": 9.96276974089165, "predator_policy": 54.94140188557235}, "policy_reward_mean": {"prey_policy": -16.939256040869207, "predator_policy": 16.93925604086921}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.86397100491385, 24.531431950847942, 26.02702248881657, 20.763361223173217, 22.64635324826954, 42.689760494469155, 28.67152755331415, 28.105074915534075, 12.615710006489703, -7.608639429227749, 20.726685954316913, -0.6864109311424587, 15.268869000757059, 27.656597455720313, 29.723285483969562, 6.361237778829662, 9.575131703594444, -7.637984697021659, 12.360897753898998, 21.665090183627154, 24.704572086847513, 14.2008241401167, 25.070124764566504, 20.43035901980389, 6.122791291749949, 29.526502209750554, 18.911364822018825, -3.4548372316106963, 40.55397076810884, 0.5927869129162389, 19.137482195605738, 4.337422540898169, 6.432553139192613, 21.327144116190247, 2.878187298832661, 22.041464928620965, 36.14351833362884, 1.3081890374475496, 3.0582900688775183, 10.813121132149279, 24.496048977051494, 7.665961853400518, 5.864458938466878, 17.26639821836496, 31.383474468209283, 15.859383113498762, 13.624387531447445, 19.509341570860084, 15.185892901134663, 11.046013687537704, 36.05648650363163, 7.043074360967512, -9.962769740891648, 19.259709659414938, 18.644206560497977, 10.63245854877696, 30.549841267485945, 14.366928807402912, 17.370053263366245, 13.485417128049951, 10.479047711610773, 6.681906258873958, 30.112598737225262, 25.49495727894758, 27.665028907737714, 12.126068862021716, 18.75491380257383, 38.94034647611012, 24.99942580774352, 21.960874967179503, 33.66287206914601, 6.100085873658085, 11.156849853449154, 15.566458782156127, 26.952700871285256, 15.434658266656031, 6.163181141672278, 13.050069323617828, 20.58949069332713, 12.71739888527929, 11.284468024738056, 46.25405662371304, 9.721930953572915, 17.25715734525002, 20.286098257309483, 2.3315228743004544, 20.62381781691904, 14.448111336367303, 17.7953440503851, 17.28945739684196, 27.488155792657633, 12.700205332371619, 28.74735179108975, 33.023522283258956, 5.883359498129297, 14.471629881510399, 10.833274379824418, 14.85428789084018, 17.935482617370514, -9.71413696733687], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.863971004913793, -24.531431950847903, -26.027022488816577, -20.763361223173217, -22.646353248269556, -42.689760494469134, -28.671527553314178, -28.10507491553412, -12.615710006489701, 7.608639429227748, -20.72668595431691, 0.6864109311424471, -15.268869000757068, -27.65659745572033, -29.723285483969537, -6.361237778829679, -9.575131703594447, 7.637984697021664, -12.360897753898996, -21.665090183627154, -24.70457208684752, -14.200824140116685, -25.070124764566458, -20.430359019803873, -6.122791291749953, -29.526502209750593, -18.911364822018804, 3.4548372316106883, -40.553970768108826, -0.5927869129162477, -19.13748219560572, -4.337422540898169, -6.432553139192621, -21.32714411619025, -2.8781872988326542, -22.041464928620943, -36.14351833362879, -1.3081890374475296, -3.058290068877519, -10.813121132149265, -24.49604897705147, -7.665961853400498, -5.864458938466879, -17.26639821836496, -31.383474468209275, -15.859383113498772, -13.624387531447468, -19.50934157086003, -15.185892901134654, -11.04601368753768, -36.05648650363158, -7.043074360967508, 9.96276974089165, -19.25970965941492, -18.644206560497974, -10.632458548776995, -30.54984126748593, -14.36692880740291, -17.37005326336627, -13.485417128049953, -10.479047711610825, -6.68190625887396, -30.112598737225223, -25.49495727894758, -27.665028907737714, -12.126068862021732, -18.754913802573864, -38.94034647611023, -24.999425807743517, -21.96087496717947, -33.66287206914602, -6.10008587365808, -11.156849853449149, -15.566458782156143, -26.95270087128522, -15.434658266656037, -6.163181141672278, -13.050069323617809, -20.589490693327132, -12.717398885279305, -11.28446802473805, -46.254056623713, -9.721930953572917, -17.25715734525006, -20.286098257309472, -2.331522874300459, -20.623817816919043, -14.448111336367289, -17.795344050384983, -17.28945739684197, -27.48815579265762, -12.700205332371638, -28.747351791089844, -33.023522283258956, -5.883359498129302, -14.471629881510394, -10.83327437982441, -14.85428789084019, -17.935482617370468, 9.714136967336877], "policy_predator_policy_reward": [29.48924694088022, 20.23869506894743, 17.929558473311733, 31.13330542838412, 36.72319681881707, 15.33084815881608, 34.48913330840916, 7.037589137937285, 13.078378318632529, 32.2143281779066, 34.08702695101921, 51.29249403791907, 24.893766497753074, 32.449288608875285, 20.26398116862816, 35.94616866244006, 17.597381030826476, 7.634038982152923, -12.499880987718504, -2.717397870736992, 21.024204303050304, 20.42916760558351, 0.7935440444697406, -2.1663659067546366, 9.925372353266741, 20.61236564824741, 22.817291000521543, 32.49590391091906, 26.74484994545455, 32.70172102248455, 10.936645456257748, 1.7858301014015794, 11.712408779744074, 7.43785462744477, -9.833113453542705, -5.442855940500607, 13.620261464799093, 11.101534042998908, 18.062395251597902, 25.267785115656388, 8.810046587412366, 40.59909758628264, 22.843817295934052, 5.557830984299343, 17.569991328742983, 32.57025820038997, 16.208928945008882, 24.65178909459885, -0.7549039586648121, 13.000486542164712, 36.19714362018612, 22.855860799315078, 16.47314149687498, 21.349588147162635, 1.2777826818586693, -8.187457145080057, 41.208657929588426, 39.89928360662918, -10.799386979694008, 11.984960805526505, 32.40950386589918, 5.865460525312287, 6.9208684719258144, 1.753976609870552, -3.361762153610149, 16.226868431995392, 25.59877864339074, 17.055509588989736, -2.6083697471754297, 8.36474434484074, 8.725253462385606, 35.35767639485624, 29.97481680771441, 42.31221985954322, 7.446339624200808, -4.829961549305743, 0.392781080079601, 5.723799057675448, 21.30461682893192, 0.3216254353666219, 20.47625262878476, 28.515845325318196, -2.45692981107179, 17.788853517872816, 9.098622099414252, 2.6302957775195086, 12.131285597291438, 22.401510839438465, 40.892189927944465, 21.87475900847408, 28.21596940653829, 3.5027968204593307, 22.169815019263147, 5.078960043631794, 28.53285449333816, 10.48582864838195, 15.291741242310138, 15.080044559959187, 4.334554752072634, 17.757472623002755, 41.752473719236086, 30.360499288027125, 10.415271427128118, 3.670877294806897, -15.214681957610757, -4.710857524172537, 19.04404989461969, 19.47536942421018, 26.56864049183571, 10.71977262916024, 6.3158076301620945, 14.949109467391864, 21.050333662254772, 40.04934887271709, 15.689670356866465, 13.04418725793936, 12.55089020651554, 22.189216320217007, 8.423415021809427, 18.54741923429049, 14.917226131809816, 6.040869291411795, -0.8735702791373718, 14.237382796885278, 29.639443643121343, 30.585753831329157, 22.634724747594362, 28.3551898103008, 23.361332750355924, 31.9687250651195, 0.5717197712733313, 23.68041795277014, 11.837069589363237, 25.67275801578446, 33.73656842456187, 44.14412452765853, 30.661211309332007, 19.337640306155144, 12.845842149282173, 31.075907785076794, 31.110004464552695, 36.21573967373936, 2.6871099448913114, 9.51306180242486, 13.445091259325848, 8.868608447572448, 23.072129007357095, 8.06078855695515, 18.916636745814436, 34.98876499675601, 22.518212156879898, 8.351104376432158, 5.730171356233118, 6.596190927111438, 5.832894081801397, 20.26724456543421, 22.388370682310743, 18.79061070434354, 15.998525628036115, 9.436272142522496, 1.6493856104667737, 20.919550439009342, 54.94140188557235, 37.56671136185366, 14.493845174938915, 4.950016732206917, 18.371217434539233, 16.143097255960868, 14.254377143053848, 26.317819371565122, 8.753897910071766, -4.090852161470858, 12.677133697903848, 28.57050193593424, 19.27795804105054, 9.618264631684061, 9.795866204296535, 25.794821896473582, 25.384997702737685, 9.193917090946242, 36.006429235145504, 18.96988235016972, 19.166965693913248, 6.2334449708300195, 30.889436545676723, 26.605267036502823, 41.21311379114576, 24.833930775372156, 9.126501683252954, 2.640217313005638, 9.886486374437016, 19.056773388583782, 14.945819091125962, 6.720729668522877, -2.862353983292989, 32.57092976497332, 18.95495899819975, 16.916006236541204, -8.759865060683087, -10.668408873990671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6254090948574403, "mean_inference_ms": 1.6614868337368451, "mean_action_processing_ms": 0.25701697014912533, "mean_env_wait_ms": 0.1444267590164539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004530787467956543, "StateBufferConnector_ms": 0.0032036304473876953, "ViewRequirementAgentConnector_ms": 0.10400772094726562}, "num_episodes": 18, "episode_return_max": 46.25405662371304, "episode_return_min": -9.962769740891648, "episode_return_mean": 16.93925604086921, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.94357619144364, "num_env_steps_trained_throughput_per_sec": 373.94357619144364, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 10576.713, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10576.461, "sample_time_ms": 1179.88, "learn_time_ms": 9376.758, "learn_throughput": 426.587, "synch_weights_time_ms": 17.687}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 122, "trial_id": "06536_00000", "date": "2024-08-11_17-36-17", "timestamp": 1723412177, "time_this_iter_s": 10.716153860092163, "time_total_s": 3717.956503391266, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5885430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3717.956503391266, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 48.160000000000004, "ram_util_percent": 83.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.046499374881387, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4016362722963094, "policy_loss": -0.004309384629110961, "vf_loss": 2.4059451098243394, "vf_explained_var": 0.9359647468353312, "kl": 0.005576134507488521, "entropy": 0.33051815076420704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9814430918643082, "cur_kl_coeff": 5.082197683525801e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8181453282870943, "policy_loss": -0.0021692715348705415, "vf_loss": 2.820314597452759, "vf_explained_var": 0.9334430788875256, "kl": 0.0023540467666868857, "entropy": 0.15836019017708997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "env_runners": {"episode_reward_max": 46.25405662371304, "episode_reward_min": -9.962769740891648, "episode_reward_mean": 16.19070783571834, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.254056623713, "predator_policy": -17.334321982804056}, "policy_reward_max": {"prey_policy": 9.96276974089165, "predator_policy": 54.94140188557235}, "policy_reward_mean": {"prey_policy": -16.19070783571833, "predator_policy": 16.19070783571834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.43035901980389, 6.122791291749949, 29.526502209750554, 18.911364822018825, -3.4548372316106963, 40.55397076810884, 0.5927869129162389, 19.137482195605738, 4.337422540898169, 6.432553139192613, 21.327144116190247, 2.878187298832661, 22.041464928620965, 36.14351833362884, 1.3081890374475496, 3.0582900688775183, 10.813121132149279, 24.496048977051494, 7.665961853400518, 5.864458938466878, 17.26639821836496, 31.383474468209283, 15.859383113498762, 13.624387531447445, 19.509341570860084, 15.185892901134663, 11.046013687537704, 36.05648650363163, 7.043074360967512, -9.962769740891648, 19.259709659414938, 18.644206560497977, 10.63245854877696, 30.549841267485945, 14.366928807402912, 17.370053263366245, 13.485417128049951, 10.479047711610773, 6.681906258873958, 30.112598737225262, 25.49495727894758, 27.665028907737714, 12.126068862021716, 18.75491380257383, 38.94034647611012, 24.99942580774352, 21.960874967179503, 33.66287206914601, 6.100085873658085, 11.156849853449154, 15.566458782156127, 26.952700871285256, 15.434658266656031, 6.163181141672278, 13.050069323617828, 20.58949069332713, 12.71739888527929, 11.284468024738056, 46.25405662371304, 9.721930953572915, 17.25715734525002, 20.286098257309483, 2.3315228743004544, 20.62381781691904, 14.448111336367303, 17.7953440503851, 17.28945739684196, 27.488155792657633, 12.700205332371619, 28.74735179108975, 33.023522283258956, 5.883359498129297, 14.471629881510399, 10.833274379824418, 14.85428789084018, 17.935482617370514, -9.71413696733687, 20.528200161639393, 23.066663473143386, 28.052447651057566, 22.253398669008916, 19.424124342545706, 20.590816672450845, 21.268140801736127, -4.247483323237208, -3.4601581210119416, 29.68283708666018, 11.960097713936456, -1.3907990459986195, 21.12269994426829, 3.7159968452628984, 37.69153601414384, -9.865740114851311, 13.812278083604395, 17.905259119605915, 34.534650366935686, -0.1875200501548573, 1.070903660278189, 15.322842570516132, 24.588481098054128], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.430359019803873, -6.122791291749953, -29.526502209750593, -18.911364822018804, 3.4548372316106883, -40.553970768108826, -0.5927869129162477, -19.13748219560572, -4.337422540898169, -6.432553139192621, -21.32714411619025, -2.8781872988326542, -22.041464928620943, -36.14351833362879, -1.3081890374475296, -3.058290068877519, -10.813121132149265, -24.49604897705147, -7.665961853400498, -5.864458938466879, -17.26639821836496, -31.383474468209275, -15.859383113498772, -13.624387531447468, -19.50934157086003, -15.185892901134654, -11.04601368753768, -36.05648650363158, -7.043074360967508, 9.96276974089165, -19.25970965941492, -18.644206560497974, -10.632458548776995, -30.54984126748593, -14.36692880740291, -17.37005326336627, -13.485417128049953, -10.479047711610825, -6.68190625887396, -30.112598737225223, -25.49495727894758, -27.665028907737714, -12.126068862021732, -18.754913802573864, -38.94034647611023, -24.999425807743517, -21.96087496717947, -33.66287206914602, -6.10008587365808, -11.156849853449149, -15.566458782156143, -26.95270087128522, -15.434658266656037, -6.163181141672278, -13.050069323617809, -20.589490693327132, -12.717398885279305, -11.28446802473805, -46.254056623713, -9.721930953572917, -17.25715734525006, -20.286098257309472, -2.331522874300459, -20.623817816919043, -14.448111336367289, -17.795344050384983, -17.28945739684197, -27.48815579265762, -12.700205332371638, -28.747351791089844, -33.023522283258956, -5.883359498129302, -14.471629881510394, -10.83327437982441, -14.85428789084019, -17.935482617370468, 9.714136967336877, -20.52820016163939, -23.066663473143386, -28.052447651057562, -22.253398669008906, -19.424124342545696, -20.590816672450856, -21.268140801736134, 4.2474833232372085, 3.4601581210119328, -29.682837086660154, -11.960097713936454, 1.3907990459986133, -21.122699944268295, -3.7159968452628878, -37.691536014143836, 9.865740114851313, -13.812278083604394, -17.905259119605894, -34.53465036693568, 0.18752005015485018, -1.0709036602781925, -15.32284257051614, -24.588481098054082], "policy_predator_policy_reward": [16.208928945008882, 24.65178909459885, -0.7549039586648121, 13.000486542164712, 36.19714362018612, 22.855860799315078, 16.47314149687498, 21.349588147162635, 1.2777826818586693, -8.187457145080057, 41.208657929588426, 39.89928360662918, -10.799386979694008, 11.984960805526505, 32.40950386589918, 5.865460525312287, 6.9208684719258144, 1.753976609870552, -3.361762153610149, 16.226868431995392, 25.59877864339074, 17.055509588989736, -2.6083697471754297, 8.36474434484074, 8.725253462385606, 35.35767639485624, 29.97481680771441, 42.31221985954322, 7.446339624200808, -4.829961549305743, 0.392781080079601, 5.723799057675448, 21.30461682893192, 0.3216254353666219, 20.47625262878476, 28.515845325318196, -2.45692981107179, 17.788853517872816, 9.098622099414252, 2.6302957775195086, 12.131285597291438, 22.401510839438465, 40.892189927944465, 21.87475900847408, 28.21596940653829, 3.5027968204593307, 22.169815019263147, 5.078960043631794, 28.53285449333816, 10.48582864838195, 15.291741242310138, 15.080044559959187, 4.334554752072634, 17.757472623002755, 41.752473719236086, 30.360499288027125, 10.415271427128118, 3.670877294806897, -15.214681957610757, -4.710857524172537, 19.04404989461969, 19.47536942421018, 26.56864049183571, 10.71977262916024, 6.3158076301620945, 14.949109467391864, 21.050333662254772, 40.04934887271709, 15.689670356866465, 13.04418725793936, 12.55089020651554, 22.189216320217007, 8.423415021809427, 18.54741923429049, 14.917226131809816, 6.040869291411795, -0.8735702791373718, 14.237382796885278, 29.639443643121343, 30.585753831329157, 22.634724747594362, 28.3551898103008, 23.361332750355924, 31.9687250651195, 0.5717197712733313, 23.68041795277014, 11.837069589363237, 25.67275801578446, 33.73656842456187, 44.14412452765853, 30.661211309332007, 19.337640306155144, 12.845842149282173, 31.075907785076794, 31.110004464552695, 36.21573967373936, 2.6871099448913114, 9.51306180242486, 13.445091259325848, 8.868608447572448, 23.072129007357095, 8.06078855695515, 18.916636745814436, 34.98876499675601, 22.518212156879898, 8.351104376432158, 5.730171356233118, 6.596190927111438, 5.832894081801397, 20.26724456543421, 22.388370682310743, 18.79061070434354, 15.998525628036115, 9.436272142522496, 1.6493856104667737, 20.919550439009342, 54.94140188557235, 37.56671136185366, 14.493845174938915, 4.950016732206917, 18.371217434539233, 16.143097255960868, 14.254377143053848, 26.317819371565122, 8.753897910071766, -4.090852161470858, 12.677133697903848, 28.57050193593424, 19.27795804105054, 9.618264631684061, 9.795866204296535, 25.794821896473582, 25.384997702737685, 9.193917090946242, 36.006429235145504, 18.96988235016972, 19.166965693913248, 6.2334449708300195, 30.889436545676723, 26.605267036502823, 41.21311379114576, 24.833930775372156, 9.126501683252954, 2.640217313005638, 9.886486374437016, 19.056773388583782, 14.945819091125962, 6.720729668522877, -2.862353983292989, 32.57092976497332, 18.95495899819975, 16.916006236541204, -8.759865060683087, -10.668408873990671, 13.220385736010316, 27.836014587268473, 28.03506017312744, 18.098266773159327, 36.025240770715044, 20.079654531400053, 9.731524927993215, 34.77527241002456, 25.337672752017728, 13.510575933073659, 31.820923625046383, 9.360709719855347, 26.769102260169056, 15.767179343303198, -7.24002989131996, -1.254936755154457, -10.790988498549211, 3.870672256525351, 22.719706101414328, 36.64596807190602, 1.7748963554585488, 22.145299072414367, -3.444937999731586, 0.6633399077343487, 13.440492762471564, 28.80490712606503, -6.800196537328352, 14.232190227854138, 25.738474155309966, 49.64459787297769, -12.146208786350751, -7.585271443351877, 22.32834158415627, 5.296214583052503, 24.50919196137941, 11.301326277832374, 28.357646472751334, 40.71165426112001, 16.95928188249435, -17.334321982804056, -9.175070564586587, 11.316877885142967, 24.90077006776036, 5.744915073271912, 21.585705861407316, 27.591256334700883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6245234234969453, "mean_inference_ms": 1.6607426608123967, "mean_action_processing_ms": 0.2569229234888009, "mean_env_wait_ms": 0.1443861139517296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00422978401184082, "StateBufferConnector_ms": 0.003237128257751465, "ViewRequirementAgentConnector_ms": 0.10356283187866211}, "num_episodes": 23, "episode_return_max": 46.25405662371304, "episode_return_min": -9.962769740891648, "episode_return_mean": 16.19070783571834, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.71015745698423, "num_env_steps_trained_throughput_per_sec": 373.71015745698423, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 10587.5, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10587.28, "sample_time_ms": 1120.028, "learn_time_ms": 9449.035, "learn_throughput": 423.324, "synch_weights_time_ms": 16.362}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "training_iteration": 123, "trial_id": "06536_00000", "date": "2024-08-11_17-36-28", "timestamp": 1723412188, "time_this_iter_s": 10.776732921600342, "time_total_s": 3728.733236312866, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316ab8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3728.733236312866, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 48.14999999999999, "ram_util_percent": 82.96875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0949842064330975, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.628915978471438, "policy_loss": -0.00543136451766865, "vf_loss": 2.6343468114733697, "vf_explained_var": 0.9328294265394409, "kl": 0.005429321273036259, "entropy": 0.3493666243273765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9595740307575813, "cur_kl_coeff": 2.5410988417629005e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8952934844153266, "policy_loss": -0.0023326579158603356, "vf_loss": 2.8976261382380493, "vf_explained_var": 0.932449804222773, "kl": 0.0032390465818496286, "entropy": 0.22815057895486318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 46.25405662371304, "episode_reward_min": -9.962769740891648, "episode_reward_mean": 16.40735464654824, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.254056623713, "predator_policy": -17.334321982804056}, "policy_reward_max": {"prey_policy": 9.96276974089165, "predator_policy": 54.94140188557235}, "policy_reward_mean": {"prey_policy": -16.407354646548235, "predator_policy": 16.407354646548235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.665961853400518, 5.864458938466878, 17.26639821836496, 31.383474468209283, 15.859383113498762, 13.624387531447445, 19.509341570860084, 15.185892901134663, 11.046013687537704, 36.05648650363163, 7.043074360967512, -9.962769740891648, 19.259709659414938, 18.644206560497977, 10.63245854877696, 30.549841267485945, 14.366928807402912, 17.370053263366245, 13.485417128049951, 10.479047711610773, 6.681906258873958, 30.112598737225262, 25.49495727894758, 27.665028907737714, 12.126068862021716, 18.75491380257383, 38.94034647611012, 24.99942580774352, 21.960874967179503, 33.66287206914601, 6.100085873658085, 11.156849853449154, 15.566458782156127, 26.952700871285256, 15.434658266656031, 6.163181141672278, 13.050069323617828, 20.58949069332713, 12.71739888527929, 11.284468024738056, 46.25405662371304, 9.721930953572915, 17.25715734525002, 20.286098257309483, 2.3315228743004544, 20.62381781691904, 14.448111336367303, 17.7953440503851, 17.28945739684196, 27.488155792657633, 12.700205332371619, 28.74735179108975, 33.023522283258956, 5.883359498129297, 14.471629881510399, 10.833274379824418, 14.85428789084018, 17.935482617370514, -9.71413696733687, 20.528200161639393, 23.066663473143386, 28.052447651057566, 22.253398669008916, 19.424124342545706, 20.590816672450845, 21.268140801736127, -4.247483323237208, -3.4601581210119416, 29.68283708666018, 11.960097713936456, -1.3907990459986195, 21.12269994426829, 3.7159968452628984, 37.69153601414384, -9.865740114851311, 13.812278083604395, 17.905259119605915, 34.534650366935686, -0.1875200501548573, 1.070903660278189, 15.322842570516132, 24.588481098054128, -8.379791156013459, 25.23415735489459, 18.36697049552514, 19.506762966260304, 13.14125681198726, 12.00779265161737, -2.3556747456736966, 11.26916912928993, 31.368513968857606, 25.402455276026053, 25.461097306043506, 12.724719667403336, 15.345482950751828, 23.03389895922531, 5.188255244030625, 22.03323619096652, 14.915879645144667, 22.05685792788563], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.665961853400498, -5.864458938466879, -17.26639821836496, -31.383474468209275, -15.859383113498772, -13.624387531447468, -19.50934157086003, -15.185892901134654, -11.04601368753768, -36.05648650363158, -7.043074360967508, 9.96276974089165, -19.25970965941492, -18.644206560497974, -10.632458548776995, -30.54984126748593, -14.36692880740291, -17.37005326336627, -13.485417128049953, -10.479047711610825, -6.68190625887396, -30.112598737225223, -25.49495727894758, -27.665028907737714, -12.126068862021732, -18.754913802573864, -38.94034647611023, -24.999425807743517, -21.96087496717947, -33.66287206914602, -6.10008587365808, -11.156849853449149, -15.566458782156143, -26.95270087128522, -15.434658266656037, -6.163181141672278, -13.050069323617809, -20.589490693327132, -12.717398885279305, -11.28446802473805, -46.254056623713, -9.721930953572917, -17.25715734525006, -20.286098257309472, -2.331522874300459, -20.623817816919043, -14.448111336367289, -17.795344050384983, -17.28945739684197, -27.48815579265762, -12.700205332371638, -28.747351791089844, -33.023522283258956, -5.883359498129302, -14.471629881510394, -10.83327437982441, -14.85428789084019, -17.935482617370468, 9.714136967336877, -20.52820016163939, -23.066663473143386, -28.052447651057562, -22.253398669008906, -19.424124342545696, -20.590816672450856, -21.268140801736134, 4.2474833232372085, 3.4601581210119328, -29.682837086660154, -11.960097713936454, 1.3907990459986133, -21.122699944268295, -3.7159968452628878, -37.691536014143836, 9.865740114851313, -13.812278083604394, -17.905259119605894, -34.53465036693568, 0.18752005015485018, -1.0709036602781925, -15.32284257051614, -24.588481098054082, 8.379791156013448, -25.234157354894588, -18.366970495525162, -19.506762966260272, -13.141256811987262, -12.007792651617363, 2.3556747456736957, -11.269169129289931, -31.368513968857613, -25.40245527602606, -25.461097306043516, -12.72471966740336, -15.345482950751837, -23.033898959225308, -5.1882552440306045, -22.033236190966473, -14.915879645144681, -22.05685792788565], "policy_predator_policy_reward": [-2.45692981107179, 17.788853517872816, 9.098622099414252, 2.6302957775195086, 12.131285597291438, 22.401510839438465, 40.892189927944465, 21.87475900847408, 28.21596940653829, 3.5027968204593307, 22.169815019263147, 5.078960043631794, 28.53285449333816, 10.48582864838195, 15.291741242310138, 15.080044559959187, 4.334554752072634, 17.757472623002755, 41.752473719236086, 30.360499288027125, 10.415271427128118, 3.670877294806897, -15.214681957610757, -4.710857524172537, 19.04404989461969, 19.47536942421018, 26.56864049183571, 10.71977262916024, 6.3158076301620945, 14.949109467391864, 21.050333662254772, 40.04934887271709, 15.689670356866465, 13.04418725793936, 12.55089020651554, 22.189216320217007, 8.423415021809427, 18.54741923429049, 14.917226131809816, 6.040869291411795, -0.8735702791373718, 14.237382796885278, 29.639443643121343, 30.585753831329157, 22.634724747594362, 28.3551898103008, 23.361332750355924, 31.9687250651195, 0.5717197712733313, 23.68041795277014, 11.837069589363237, 25.67275801578446, 33.73656842456187, 44.14412452765853, 30.661211309332007, 19.337640306155144, 12.845842149282173, 31.075907785076794, 31.110004464552695, 36.21573967373936, 2.6871099448913114, 9.51306180242486, 13.445091259325848, 8.868608447572448, 23.072129007357095, 8.06078855695515, 18.916636745814436, 34.98876499675601, 22.518212156879898, 8.351104376432158, 5.730171356233118, 6.596190927111438, 5.832894081801397, 20.26724456543421, 22.388370682310743, 18.79061070434354, 15.998525628036115, 9.436272142522496, 1.6493856104667737, 20.919550439009342, 54.94140188557235, 37.56671136185366, 14.493845174938915, 4.950016732206917, 18.371217434539233, 16.143097255960868, 14.254377143053848, 26.317819371565122, 8.753897910071766, -4.090852161470858, 12.677133697903848, 28.57050193593424, 19.27795804105054, 9.618264631684061, 9.795866204296535, 25.794821896473582, 25.384997702737685, 9.193917090946242, 36.006429235145504, 18.96988235016972, 19.166965693913248, 6.2334449708300195, 30.889436545676723, 26.605267036502823, 41.21311379114576, 24.833930775372156, 9.126501683252954, 2.640217313005638, 9.886486374437016, 19.056773388583782, 14.945819091125962, 6.720729668522877, -2.862353983292989, 32.57092976497332, 18.95495899819975, 16.916006236541204, -8.759865060683087, -10.668408873990671, 13.220385736010316, 27.836014587268473, 28.03506017312744, 18.098266773159327, 36.025240770715044, 20.079654531400053, 9.731524927993215, 34.77527241002456, 25.337672752017728, 13.510575933073659, 31.820923625046383, 9.360709719855347, 26.769102260169056, 15.767179343303198, -7.24002989131996, -1.254936755154457, -10.790988498549211, 3.870672256525351, 22.719706101414328, 36.64596807190602, 1.7748963554585488, 22.145299072414367, -3.444937999731586, 0.6633399077343487, 13.440492762471564, 28.80490712606503, -6.800196537328352, 14.232190227854138, 25.738474155309966, 49.64459787297769, -12.146208786350751, -7.585271443351877, 22.32834158415627, 5.296214583052503, 24.50919196137941, 11.301326277832374, 28.357646472751334, 40.71165426112001, 16.95928188249435, -17.334321982804056, -9.175070564586587, 11.316877885142967, 24.90077006776036, 5.744915073271912, 21.585705861407316, 27.591256334700883, -8.816109003451647, -7.943473308575262, 30.435433539302057, 20.032881170487066, 7.6168686544232855, 29.117072336626997, 4.650049765505375, 34.36347616701521, 12.480744923211862, 13.801768700762658, 9.598563983698101, 14.417021319536632, 3.036933439747294, -7.748282931094694, 1.6964943819276925, 20.841843876652174, 18.201650949006414, 44.53537698870877, 28.96636214960644, 21.838548402445674, 29.140574312681416, 21.78162029940558, 11.339632637783245, 14.109806697023469, 27.35453459888788, 3.336431302615761, 20.65202848042947, 25.41576943802116, -2.436650740205925, 12.813161228267154, 14.04522156033282, 30.021250821600148, -2.6247101621301274, 32.45646945241948, 17.12389685955602, 26.98981899621527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6240888110848156, "mean_inference_ms": 1.6582865365598496, "mean_action_processing_ms": 0.25656328091175035, "mean_env_wait_ms": 0.14401224186230585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004084348678588867, "StateBufferConnector_ms": 0.0031849145889282227, "ViewRequirementAgentConnector_ms": 0.10950970649719238}, "num_episodes": 18, "episode_return_max": 46.25405662371304, "episode_return_min": -9.962769740891648, "episode_return_mean": 16.40735464654824, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.69220783434827, "num_env_steps_trained_throughput_per_sec": 380.69220783434827, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 10610.869, "restore_workers_time_ms": 0.037, "training_step_time_ms": 10610.573, "sample_time_ms": 1165.578, "learn_time_ms": 9426.287, "learn_throughput": 424.345, "synch_weights_time_ms": 16.486}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 124, "trial_id": "06536_00000", "date": "2024-08-11_17-36-38", "timestamp": 1723412198, "time_this_iter_s": 10.546014070510864, "time_total_s": 3739.279250383377, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58a5550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3739.279250383377, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 45.74666666666667, "ram_util_percent": 82.47333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7051611800988513, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.911283986394604, "policy_loss": -0.005034154481351531, "vf_loss": 1.916317554252843, "vf_explained_var": 0.952725627211233, "kl": 0.006012303047364901, "entropy": 0.33125057170788447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.631561558208768, "cur_kl_coeff": 1.2705494208814502e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5683641448853507, "policy_loss": -0.003804969779467062, "vf_loss": 2.572169118268149, "vf_explained_var": 0.9384777655992559, "kl": 0.004969161419929916, "entropy": 0.21033914628483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "env_runners": {"episode_reward_max": 46.25405662371304, "episode_reward_min": -10.302404780377202, "episode_reward_mean": 16.534613438269083, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.254056623713, "predator_policy": -17.334321982804056}, "policy_reward_max": {"prey_policy": 10.302404780377204, "predator_policy": 54.94140188557235}, "policy_reward_mean": {"prey_policy": -16.534613438269083, "predator_policy": 16.534613438269083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.49495727894758, 27.665028907737714, 12.126068862021716, 18.75491380257383, 38.94034647611012, 24.99942580774352, 21.960874967179503, 33.66287206914601, 6.100085873658085, 11.156849853449154, 15.566458782156127, 26.952700871285256, 15.434658266656031, 6.163181141672278, 13.050069323617828, 20.58949069332713, 12.71739888527929, 11.284468024738056, 46.25405662371304, 9.721930953572915, 17.25715734525002, 20.286098257309483, 2.3315228743004544, 20.62381781691904, 14.448111336367303, 17.7953440503851, 17.28945739684196, 27.488155792657633, 12.700205332371619, 28.74735179108975, 33.023522283258956, 5.883359498129297, 14.471629881510399, 10.833274379824418, 14.85428789084018, 17.935482617370514, -9.71413696733687, 20.528200161639393, 23.066663473143386, 28.052447651057566, 22.253398669008916, 19.424124342545706, 20.590816672450845, 21.268140801736127, -4.247483323237208, -3.4601581210119416, 29.68283708666018, 11.960097713936456, -1.3907990459986195, 21.12269994426829, 3.7159968452628984, 37.69153601414384, -9.865740114851311, 13.812278083604395, 17.905259119605915, 34.534650366935686, -0.1875200501548573, 1.070903660278189, 15.322842570516132, 24.588481098054128, -8.379791156013459, 25.23415735489459, 18.36697049552514, 19.506762966260304, 13.14125681198726, 12.00779265161737, -2.3556747456736966, 11.26916912928993, 31.368513968857606, 25.402455276026053, 25.461097306043506, 12.724719667403336, 15.345482950751828, 23.03389895922531, 5.188255244030625, 22.03323619096652, 14.915879645144667, 22.05685792788563, 15.298582273687591, 12.465515196990081, 22.672515783526492, 29.72232162565305, 6.8050372884954635, 16.245562249452583, 3.5052279334130834, 19.453069950110397, 3.3375192531920304, 26.722834028983257, 22.34134503541319, 23.141876338507494, 7.0633902316818915, 17.644545372012818, 16.781093772956755, 33.46788545053535, 8.07516160534791, 5.9355718526049195, 34.278696276029294, -10.302404780377202, 2.051352721642248, 38.14345106155869], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.49495727894758, -27.665028907737714, -12.126068862021732, -18.754913802573864, -38.94034647611023, -24.999425807743517, -21.96087496717947, -33.66287206914602, -6.10008587365808, -11.156849853449149, -15.566458782156143, -26.95270087128522, -15.434658266656037, -6.163181141672278, -13.050069323617809, -20.589490693327132, -12.717398885279305, -11.28446802473805, -46.254056623713, -9.721930953572917, -17.25715734525006, -20.286098257309472, -2.331522874300459, -20.623817816919043, -14.448111336367289, -17.795344050384983, -17.28945739684197, -27.48815579265762, -12.700205332371638, -28.747351791089844, -33.023522283258956, -5.883359498129302, -14.471629881510394, -10.83327437982441, -14.85428789084019, -17.935482617370468, 9.714136967336877, -20.52820016163939, -23.066663473143386, -28.052447651057562, -22.253398669008906, -19.424124342545696, -20.590816672450856, -21.268140801736134, 4.2474833232372085, 3.4601581210119328, -29.682837086660154, -11.960097713936454, 1.3907990459986133, -21.122699944268295, -3.7159968452628878, -37.691536014143836, 9.865740114851313, -13.812278083604394, -17.905259119605894, -34.53465036693568, 0.18752005015485018, -1.0709036602781925, -15.32284257051614, -24.588481098054082, 8.379791156013448, -25.234157354894588, -18.366970495525162, -19.506762966260272, -13.141256811987262, -12.007792651617363, 2.3556747456736957, -11.269169129289931, -31.368513968857613, -25.40245527602606, -25.461097306043516, -12.72471966740336, -15.345482950751837, -23.033898959225308, -5.1882552440306045, -22.033236190966473, -14.915879645144681, -22.05685792788565, -15.298582273687611, -12.46551519699008, -22.672515783526496, -29.72232162565303, -6.805037288495471, -16.245562249452526, -3.5052279334130745, -19.453069950110397, -3.3375192531920272, -26.722834028983236, -22.341345035413184, -23.141876338507497, -7.06339023168189, -17.644545372012814, -16.78109377295676, -33.4678854505353, -8.075161605347915, -5.935571852604911, -34.27869627602936, 10.302404780377204, -2.0513527216422514, -38.14345106155863], "policy_predator_policy_reward": [22.634724747594362, 28.3551898103008, 23.361332750355924, 31.9687250651195, 0.5717197712733313, 23.68041795277014, 11.837069589363237, 25.67275801578446, 33.73656842456187, 44.14412452765853, 30.661211309332007, 19.337640306155144, 12.845842149282173, 31.075907785076794, 31.110004464552695, 36.21573967373936, 2.6871099448913114, 9.51306180242486, 13.445091259325848, 8.868608447572448, 23.072129007357095, 8.06078855695515, 18.916636745814436, 34.98876499675601, 22.518212156879898, 8.351104376432158, 5.730171356233118, 6.596190927111438, 5.832894081801397, 20.26724456543421, 22.388370682310743, 18.79061070434354, 15.998525628036115, 9.436272142522496, 1.6493856104667737, 20.919550439009342, 54.94140188557235, 37.56671136185366, 14.493845174938915, 4.950016732206917, 18.371217434539233, 16.143097255960868, 14.254377143053848, 26.317819371565122, 8.753897910071766, -4.090852161470858, 12.677133697903848, 28.57050193593424, 19.27795804105054, 9.618264631684061, 9.795866204296535, 25.794821896473582, 25.384997702737685, 9.193917090946242, 36.006429235145504, 18.96988235016972, 19.166965693913248, 6.2334449708300195, 30.889436545676723, 26.605267036502823, 41.21311379114576, 24.833930775372156, 9.126501683252954, 2.640217313005638, 9.886486374437016, 19.056773388583782, 14.945819091125962, 6.720729668522877, -2.862353983292989, 32.57092976497332, 18.95495899819975, 16.916006236541204, -8.759865060683087, -10.668408873990671, 13.220385736010316, 27.836014587268473, 28.03506017312744, 18.098266773159327, 36.025240770715044, 20.079654531400053, 9.731524927993215, 34.77527241002456, 25.337672752017728, 13.510575933073659, 31.820923625046383, 9.360709719855347, 26.769102260169056, 15.767179343303198, -7.24002989131996, -1.254936755154457, -10.790988498549211, 3.870672256525351, 22.719706101414328, 36.64596807190602, 1.7748963554585488, 22.145299072414367, -3.444937999731586, 0.6633399077343487, 13.440492762471564, 28.80490712606503, -6.800196537328352, 14.232190227854138, 25.738474155309966, 49.64459787297769, -12.146208786350751, -7.585271443351877, 22.32834158415627, 5.296214583052503, 24.50919196137941, 11.301326277832374, 28.357646472751334, 40.71165426112001, 16.95928188249435, -17.334321982804056, -9.175070564586587, 11.316877885142967, 24.90077006776036, 5.744915073271912, 21.585705861407316, 27.591256334700883, -8.816109003451647, -7.943473308575262, 30.435433539302057, 20.032881170487066, 7.6168686544232855, 29.117072336626997, 4.650049765505375, 34.36347616701521, 12.480744923211862, 13.801768700762658, 9.598563983698101, 14.417021319536632, 3.036933439747294, -7.748282931094694, 1.6964943819276925, 20.841843876652174, 18.201650949006414, 44.53537698870877, 28.96636214960644, 21.838548402445674, 29.140574312681416, 21.78162029940558, 11.339632637783245, 14.109806697023469, 27.35453459888788, 3.336431302615761, 20.65202848042947, 25.41576943802116, -2.436650740205925, 12.813161228267154, 14.04522156033282, 30.021250821600148, -2.6247101621301274, 32.45646945241948, 17.12389685955602, 26.98981899621527, 9.23811659136949, 21.359047956005696, 0.47021539584934735, 24.460814998130815, 20.042132217746328, 25.302899349306685, 18.903074973305678, 40.54156827800038, 11.387279209930934, 2.222795367060032, -3.4938509765655397, 35.984975475470634, 5.727219546000894, 1.2832363208252495, 12.65712643698481, 26.249013463235983, 11.889663231464237, -5.214624725080185, 18.353957739124237, 35.09171031884229, -0.3177298020225159, 45.00041987284892, 26.480107220328243, 19.80364545668676, 10.41111249274309, 3.7156679706206646, 15.216898168739972, 20.072192575285655, 15.700382988948633, 17.861804556964884, 42.253678903126826, 24.68209199794388, 19.01264091452871, -2.8623177038329253, -1.3178344586878037, 13.18897816389758, 34.184746421505174, 34.3726461305535, -13.234452703214703, -7.370356857539704, 7.890029902403951, -3.787324459119427, 36.8807905552679, 39.40611156784947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6242145858181815, "mean_inference_ms": 1.6587714331504042, "mean_action_processing_ms": 0.25657345532829956, "mean_env_wait_ms": 0.14398334319740727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016365647315979004, "StateBufferConnector_ms": 0.003510713577270508, "ViewRequirementAgentConnector_ms": 0.14205920696258545}, "num_episodes": 22, "episode_return_max": 46.25405662371304, "episode_return_min": -10.302404780377202, "episode_return_mean": 16.534613438269083, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.7379263265097, "num_env_steps_trained_throughput_per_sec": 354.7379263265097, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 10643.65, "restore_workers_time_ms": 0.041, "training_step_time_ms": 10643.343, "sample_time_ms": 1211.32, "learn_time_ms": 9413.463, "learn_throughput": 424.923, "synch_weights_time_ms": 16.396}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "training_iteration": 125, "trial_id": "06536_00000", "date": "2024-08-11_17-36-49", "timestamp": 1723412209, "time_this_iter_s": 11.352581024169922, "time_total_s": 3750.631831407547, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316e0040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3750.631831407547, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 51.06875, "ram_util_percent": 82.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7763781304160755, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.284698263866206, "policy_loss": -0.005727845365860655, "vf_loss": 2.290425606071949, "vf_explained_var": 0.9538207849487662, "kl": 0.0052472294560838755, "entropy": 0.39549854779616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8687248540933803, "cur_kl_coeff": 6.352747104407251e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.687656376853822, "policy_loss": -0.003205121405885885, "vf_loss": 2.690861497228108, "vf_explained_var": 0.9500753899730703, "kl": 0.005283655292755131, "entropy": 0.23860846114537074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 46.25405662371304, "episode_reward_min": -10.302404780377202, "episode_reward_mean": 16.77045160323479, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.254056623713, "predator_policy": -17.334321982804056}, "policy_reward_max": {"prey_policy": 10.302404780377204, "predator_policy": 54.94140188557235}, "policy_reward_mean": {"prey_policy": -16.770451603234786, "predator_policy": 16.770451603234786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.25405662371304, 9.721930953572915, 17.25715734525002, 20.286098257309483, 2.3315228743004544, 20.62381781691904, 14.448111336367303, 17.7953440503851, 17.28945739684196, 27.488155792657633, 12.700205332371619, 28.74735179108975, 33.023522283258956, 5.883359498129297, 14.471629881510399, 10.833274379824418, 14.85428789084018, 17.935482617370514, -9.71413696733687, 20.528200161639393, 23.066663473143386, 28.052447651057566, 22.253398669008916, 19.424124342545706, 20.590816672450845, 21.268140801736127, -4.247483323237208, -3.4601581210119416, 29.68283708666018, 11.960097713936456, -1.3907990459986195, 21.12269994426829, 3.7159968452628984, 37.69153601414384, -9.865740114851311, 13.812278083604395, 17.905259119605915, 34.534650366935686, -0.1875200501548573, 1.070903660278189, 15.322842570516132, 24.588481098054128, -8.379791156013459, 25.23415735489459, 18.36697049552514, 19.506762966260304, 13.14125681198726, 12.00779265161737, -2.3556747456736966, 11.26916912928993, 31.368513968857606, 25.402455276026053, 25.461097306043506, 12.724719667403336, 15.345482950751828, 23.03389895922531, 5.188255244030625, 22.03323619096652, 14.915879645144667, 22.05685792788563, 15.298582273687591, 12.465515196990081, 22.672515783526492, 29.72232162565305, 6.8050372884954635, 16.245562249452583, 3.5052279334130834, 19.453069950110397, 3.3375192531920304, 26.722834028983257, 22.34134503541319, 23.141876338507494, 7.0633902316818915, 17.644545372012818, 16.781093772956755, 33.46788545053535, 8.07516160534791, 5.9355718526049195, 34.278696276029294, -10.302404780377202, 2.051352721642248, 38.14345106155869, 28.823316753088957, 33.753287371277956, 38.346422514691675, 31.732003483371265, 26.665201088632408, 36.93415654488626, 19.79662678236219, -0.729746769958838, 6.88914243521451, 26.03794505949685, 7.1606544181657, 15.528531494474187, 28.500607475644333, 15.12585279797916, -2.128630565700372, 40.672283287687854, 8.724783813396291, 4.3712283991595005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-46.254056623713, -9.721930953572917, -17.25715734525006, -20.286098257309472, -2.331522874300459, -20.623817816919043, -14.448111336367289, -17.795344050384983, -17.28945739684197, -27.48815579265762, -12.700205332371638, -28.747351791089844, -33.023522283258956, -5.883359498129302, -14.471629881510394, -10.83327437982441, -14.85428789084019, -17.935482617370468, 9.714136967336877, -20.52820016163939, -23.066663473143386, -28.052447651057562, -22.253398669008906, -19.424124342545696, -20.590816672450856, -21.268140801736134, 4.2474833232372085, 3.4601581210119328, -29.682837086660154, -11.960097713936454, 1.3907990459986133, -21.122699944268295, -3.7159968452628878, -37.691536014143836, 9.865740114851313, -13.812278083604394, -17.905259119605894, -34.53465036693568, 0.18752005015485018, -1.0709036602781925, -15.32284257051614, -24.588481098054082, 8.379791156013448, -25.234157354894588, -18.366970495525162, -19.506762966260272, -13.141256811987262, -12.007792651617363, 2.3556747456736957, -11.269169129289931, -31.368513968857613, -25.40245527602606, -25.461097306043516, -12.72471966740336, -15.345482950751837, -23.033898959225308, -5.1882552440306045, -22.033236190966473, -14.915879645144681, -22.05685792788565, -15.298582273687611, -12.46551519699008, -22.672515783526496, -29.72232162565303, -6.805037288495471, -16.245562249452526, -3.5052279334130745, -19.453069950110397, -3.3375192531920272, -26.722834028983236, -22.341345035413184, -23.141876338507497, -7.06339023168189, -17.644545372012814, -16.78109377295676, -33.4678854505353, -8.075161605347915, -5.935571852604911, -34.27869627602936, 10.302404780377204, -2.0513527216422514, -38.14345106155863, -28.82331675308893, -33.75328737127794, -38.34642251469163, -31.732003483371248, -26.665201088632376, -36.934156544886264, -19.796626782362193, 0.7297467699588367, -6.88914243521451, -26.03794505949684, -7.160654418165735, -15.528531494474176, -28.500607475644326, -15.125852797979192, 2.1286305657003677, -40.67228328768792, -8.724783813396302, -4.371228399159498], "policy_predator_policy_reward": [54.94140188557235, 37.56671136185366, 14.493845174938915, 4.950016732206917, 18.371217434539233, 16.143097255960868, 14.254377143053848, 26.317819371565122, 8.753897910071766, -4.090852161470858, 12.677133697903848, 28.57050193593424, 19.27795804105054, 9.618264631684061, 9.795866204296535, 25.794821896473582, 25.384997702737685, 9.193917090946242, 36.006429235145504, 18.96988235016972, 19.166965693913248, 6.2334449708300195, 30.889436545676723, 26.605267036502823, 41.21311379114576, 24.833930775372156, 9.126501683252954, 2.640217313005638, 9.886486374437016, 19.056773388583782, 14.945819091125962, 6.720729668522877, -2.862353983292989, 32.57092976497332, 18.95495899819975, 16.916006236541204, -8.759865060683087, -10.668408873990671, 13.220385736010316, 27.836014587268473, 28.03506017312744, 18.098266773159327, 36.025240770715044, 20.079654531400053, 9.731524927993215, 34.77527241002456, 25.337672752017728, 13.510575933073659, 31.820923625046383, 9.360709719855347, 26.769102260169056, 15.767179343303198, -7.24002989131996, -1.254936755154457, -10.790988498549211, 3.870672256525351, 22.719706101414328, 36.64596807190602, 1.7748963554585488, 22.145299072414367, -3.444937999731586, 0.6633399077343487, 13.440492762471564, 28.80490712606503, -6.800196537328352, 14.232190227854138, 25.738474155309966, 49.64459787297769, -12.146208786350751, -7.585271443351877, 22.32834158415627, 5.296214583052503, 24.50919196137941, 11.301326277832374, 28.357646472751334, 40.71165426112001, 16.95928188249435, -17.334321982804056, -9.175070564586587, 11.316877885142967, 24.90077006776036, 5.744915073271912, 21.585705861407316, 27.591256334700883, -8.816109003451647, -7.943473308575262, 30.435433539302057, 20.032881170487066, 7.6168686544232855, 29.117072336626997, 4.650049765505375, 34.36347616701521, 12.480744923211862, 13.801768700762658, 9.598563983698101, 14.417021319536632, 3.036933439747294, -7.748282931094694, 1.6964943819276925, 20.841843876652174, 18.201650949006414, 44.53537698870877, 28.96636214960644, 21.838548402445674, 29.140574312681416, 21.78162029940558, 11.339632637783245, 14.109806697023469, 27.35453459888788, 3.336431302615761, 20.65202848042947, 25.41576943802116, -2.436650740205925, 12.813161228267154, 14.04522156033282, 30.021250821600148, -2.6247101621301274, 32.45646945241948, 17.12389685955602, 26.98981899621527, 9.23811659136949, 21.359047956005696, 0.47021539584934735, 24.460814998130815, 20.042132217746328, 25.302899349306685, 18.903074973305678, 40.54156827800038, 11.387279209930934, 2.222795367060032, -3.4938509765655397, 35.984975475470634, 5.727219546000894, 1.2832363208252495, 12.65712643698481, 26.249013463235983, 11.889663231464237, -5.214624725080185, 18.353957739124237, 35.09171031884229, -0.3177298020225159, 45.00041987284892, 26.480107220328243, 19.80364545668676, 10.41111249274309, 3.7156679706206646, 15.216898168739972, 20.072192575285655, 15.700382988948633, 17.861804556964884, 42.253678903126826, 24.68209199794388, 19.01264091452871, -2.8623177038329253, -1.3178344586878037, 13.18897816389758, 34.184746421505174, 34.3726461305535, -13.234452703214703, -7.370356857539704, 7.890029902403951, -3.787324459119427, 36.8807905552679, 39.40611156784947, 29.714599332395906, 27.932034173781947, 32.652328507426, 34.85424623512987, 47.61188780620326, 29.080957223180064, 19.843739943404543, 43.62026702333797, 37.63837689239606, 15.692025284868734, 31.54713697399653, 42.321176115775984, 23.809474939465424, 15.783778625258932, 1.2737601872791515, -2.733253727196834, 23.032879547552177, -9.25459467712314, 38.07156577925419, 14.004324339739487, 8.545677020771612, 5.775631815559818, 24.77484813165517, 6.2822148572931935, 32.60447930060917, 24.396735650679442, 30.339523646424276, -0.08781805046590208, 1.6780424499438702, -5.935303581344614, 38.29882782323074, 43.04573875214504, 4.386283293380628, 13.063284333411964, 4.087273457336867, 4.655183340982132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6242036634466642, "mean_inference_ms": 1.6585524774396243, "mean_action_processing_ms": 0.2565204730516732, "mean_env_wait_ms": 0.14392562885960997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01623821258544922, "StateBufferConnector_ms": 0.0034499168395996094, "ViewRequirementAgentConnector_ms": 0.12312912940979004}, "num_episodes": 18, "episode_return_max": 46.25405662371304, "episode_return_min": -10.302404780377202, "episode_return_mean": 16.77045160323479, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.29757942131727, "num_env_steps_trained_throughput_per_sec": 380.29757942131727, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 10635.543, "restore_workers_time_ms": 0.041, "training_step_time_ms": 10635.236, "sample_time_ms": 1207.269, "learn_time_ms": 9409.437, "learn_throughput": 425.105, "synch_weights_time_ms": 16.373}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 126, "trial_id": "06536_00000", "date": "2024-08-11_17-37-00", "timestamp": 1723412220, "time_this_iter_s": 10.56157636642456, "time_total_s": 3761.1934077739716, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3761.1934077739716, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 46.75714285714285, "ram_util_percent": 82.7142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4900830393036206, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.063580527094503, "policy_loss": -0.008347868119017221, "vf_loss": 2.071927806548774, "vf_explained_var": 0.9393890896191199, "kl": 0.006040591663134383, "entropy": 0.33182935062795876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.629979256915037, "cur_kl_coeff": 6.352747104407251e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.609532004941708, "policy_loss": -0.0024046605487388593, "vf_loss": 2.611936664329004, "vf_explained_var": 0.931110966394818, "kl": 0.0024270450042263654, "entropy": 0.19426667802232914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "env_runners": {"episode_reward_max": 45.205169185013816, "episode_reward_min": -10.302404780377202, "episode_reward_mean": 16.595835857026046, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.20516918501381, "predator_policy": -22.06509614692313}, "policy_reward_max": {"prey_policy": 10.302404780377204, "predator_policy": 49.662917841491364}, "policy_reward_mean": {"prey_policy": -16.595835857026046, "predator_policy": 16.595835857026046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.71413696733687, 20.528200161639393, 23.066663473143386, 28.052447651057566, 22.253398669008916, 19.424124342545706, 20.590816672450845, 21.268140801736127, -4.247483323237208, -3.4601581210119416, 29.68283708666018, 11.960097713936456, -1.3907990459986195, 21.12269994426829, 3.7159968452628984, 37.69153601414384, -9.865740114851311, 13.812278083604395, 17.905259119605915, 34.534650366935686, -0.1875200501548573, 1.070903660278189, 15.322842570516132, 24.588481098054128, -8.379791156013459, 25.23415735489459, 18.36697049552514, 19.506762966260304, 13.14125681198726, 12.00779265161737, -2.3556747456736966, 11.26916912928993, 31.368513968857606, 25.402455276026053, 25.461097306043506, 12.724719667403336, 15.345482950751828, 23.03389895922531, 5.188255244030625, 22.03323619096652, 14.915879645144667, 22.05685792788563, 15.298582273687591, 12.465515196990081, 22.672515783526492, 29.72232162565305, 6.8050372884954635, 16.245562249452583, 3.5052279334130834, 19.453069950110397, 3.3375192531920304, 26.722834028983257, 22.34134503541319, 23.141876338507494, 7.0633902316818915, 17.644545372012818, 16.781093772956755, 33.46788545053535, 8.07516160534791, 5.9355718526049195, 34.278696276029294, -10.302404780377202, 2.051352721642248, 38.14345106155869, 28.823316753088957, 33.753287371277956, 38.346422514691675, 31.732003483371265, 26.665201088632408, 36.93415654488626, 19.79662678236219, -0.729746769958838, 6.88914243521451, 26.03794505949685, 7.1606544181657, 15.528531494474187, 28.500607475644333, 15.12585279797916, -2.128630565700372, 40.672283287687854, 8.724783813396291, 4.3712283991595005, 14.097131991041461, 3.326917162266467, 45.205169185013816, 27.63320672359131, 29.4102372118911, 3.0954833585689014, 2.5968760804123425, 23.384936614808012, 14.89513730864588, 20.11922915654987, -6.728118750816749, 33.81306638903687, 1.9092067181320438, 5.03762694203116, 34.461703280473316, 0.8462017974898499, 26.262974603031317, 35.11620572867075], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [9.714136967336877, -20.52820016163939, -23.066663473143386, -28.052447651057562, -22.253398669008906, -19.424124342545696, -20.590816672450856, -21.268140801736134, 4.2474833232372085, 3.4601581210119328, -29.682837086660154, -11.960097713936454, 1.3907990459986133, -21.122699944268295, -3.7159968452628878, -37.691536014143836, 9.865740114851313, -13.812278083604394, -17.905259119605894, -34.53465036693568, 0.18752005015485018, -1.0709036602781925, -15.32284257051614, -24.588481098054082, 8.379791156013448, -25.234157354894588, -18.366970495525162, -19.506762966260272, -13.141256811987262, -12.007792651617363, 2.3556747456736957, -11.269169129289931, -31.368513968857613, -25.40245527602606, -25.461097306043516, -12.72471966740336, -15.345482950751837, -23.033898959225308, -5.1882552440306045, -22.033236190966473, -14.915879645144681, -22.05685792788565, -15.298582273687611, -12.46551519699008, -22.672515783526496, -29.72232162565303, -6.805037288495471, -16.245562249452526, -3.5052279334130745, -19.453069950110397, -3.3375192531920272, -26.722834028983236, -22.341345035413184, -23.141876338507497, -7.06339023168189, -17.644545372012814, -16.78109377295676, -33.4678854505353, -8.075161605347915, -5.935571852604911, -34.27869627602936, 10.302404780377204, -2.0513527216422514, -38.14345106155863, -28.82331675308893, -33.75328737127794, -38.34642251469163, -31.732003483371248, -26.665201088632376, -36.934156544886264, -19.796626782362193, 0.7297467699588367, -6.88914243521451, -26.03794505949684, -7.160654418165735, -15.528531494474176, -28.500607475644326, -15.125852797979192, 2.1286305657003677, -40.67228328768792, -8.724783813396302, -4.371228399159498, -14.097131991041422, -3.3269171622664393, -45.20516918501381, -27.633206723591307, -29.41023721189112, -3.0954833585689014, -2.5968760804123523, -23.384936614808012, -14.895137308645875, -20.11922915654987, 6.7281187508167575, -33.813066389036884, -1.9092067181320571, -5.037626942031158, -34.46170328047335, -0.8462017974898508, -26.262974603031324, -35.116205728670764], "policy_predator_policy_reward": [-8.759865060683087, -10.668408873990671, 13.220385736010316, 27.836014587268473, 28.03506017312744, 18.098266773159327, 36.025240770715044, 20.079654531400053, 9.731524927993215, 34.77527241002456, 25.337672752017728, 13.510575933073659, 31.820923625046383, 9.360709719855347, 26.769102260169056, 15.767179343303198, -7.24002989131996, -1.254936755154457, -10.790988498549211, 3.870672256525351, 22.719706101414328, 36.64596807190602, 1.7748963554585488, 22.145299072414367, -3.444937999731586, 0.6633399077343487, 13.440492762471564, 28.80490712606503, -6.800196537328352, 14.232190227854138, 25.738474155309966, 49.64459787297769, -12.146208786350751, -7.585271443351877, 22.32834158415627, 5.296214583052503, 24.50919196137941, 11.301326277832374, 28.357646472751334, 40.71165426112001, 16.95928188249435, -17.334321982804056, -9.175070564586587, 11.316877885142967, 24.90077006776036, 5.744915073271912, 21.585705861407316, 27.591256334700883, -8.816109003451647, -7.943473308575262, 30.435433539302057, 20.032881170487066, 7.6168686544232855, 29.117072336626997, 4.650049765505375, 34.36347616701521, 12.480744923211862, 13.801768700762658, 9.598563983698101, 14.417021319536632, 3.036933439747294, -7.748282931094694, 1.6964943819276925, 20.841843876652174, 18.201650949006414, 44.53537698870877, 28.96636214960644, 21.838548402445674, 29.140574312681416, 21.78162029940558, 11.339632637783245, 14.109806697023469, 27.35453459888788, 3.336431302615761, 20.65202848042947, 25.41576943802116, -2.436650740205925, 12.813161228267154, 14.04522156033282, 30.021250821600148, -2.6247101621301274, 32.45646945241948, 17.12389685955602, 26.98981899621527, 9.23811659136949, 21.359047956005696, 0.47021539584934735, 24.460814998130815, 20.042132217746328, 25.302899349306685, 18.903074973305678, 40.54156827800038, 11.387279209930934, 2.222795367060032, -3.4938509765655397, 35.984975475470634, 5.727219546000894, 1.2832363208252495, 12.65712643698481, 26.249013463235983, 11.889663231464237, -5.214624725080185, 18.353957739124237, 35.09171031884229, -0.3177298020225159, 45.00041987284892, 26.480107220328243, 19.80364545668676, 10.41111249274309, 3.7156679706206646, 15.216898168739972, 20.072192575285655, 15.700382988948633, 17.861804556964884, 42.253678903126826, 24.68209199794388, 19.01264091452871, -2.8623177038329253, -1.3178344586878037, 13.18897816389758, 34.184746421505174, 34.3726461305535, -13.234452703214703, -7.370356857539704, 7.890029902403951, -3.787324459119427, 36.8807905552679, 39.40611156784947, 29.714599332395906, 27.932034173781947, 32.652328507426, 34.85424623512987, 47.61188780620326, 29.080957223180064, 19.843739943404543, 43.62026702333797, 37.63837689239606, 15.692025284868734, 31.54713697399653, 42.321176115775984, 23.809474939465424, 15.783778625258932, 1.2737601872791515, -2.733253727196834, 23.032879547552177, -9.25459467712314, 38.07156577925419, 14.004324339739487, 8.545677020771612, 5.775631815559818, 24.77484813165517, 6.2822148572931935, 32.60447930060917, 24.396735650679442, 30.339523646424276, -0.08781805046590208, 1.6780424499438702, -5.935303581344614, 38.29882782323074, 43.04573875214504, 4.386283293380628, 13.063284333411964, 4.087273457336867, 4.655183340982132, 7.937896652034622, 20.256367330048203, -2.0188908655246234, 8.672725190057507, 47.85013948191056, 42.56019888811708, 28.823350208072355, 26.443063239110263, 32.45878717478759, 26.361687248994585, 5.89636590761855, 0.2946008095192525, 3.137639814281253, 2.0561123465434488, 16.172294028704002, 30.59757920091206, 30.93143622467745, -1.1411616073856976, 14.038787499761622, 26.199670813338116, 8.608858645289633, -22.06509614692313, 26.934056143070997, 40.692076635002714, 7.332863520551635, -3.5144500842875166, 4.624530117817589, 5.4507237662447245, 40.42571725083177, 28.49768931011491, -3.9483610113921515, 5.64076460637186, 21.58235048988044, 30.9435987161822, 20.56949361585014, 49.662917841491364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6243060615359187, "mean_inference_ms": 1.6584597615329522, "mean_action_processing_ms": 0.2564965700704478, "mean_env_wait_ms": 0.14389408882652627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01636648178100586, "StateBufferConnector_ms": 0.003306746482849121, "ViewRequirementAgentConnector_ms": 0.12309300899505615}, "num_episodes": 18, "episode_return_max": 45.205169185013816, "episode_return_min": -10.302404780377202, "episode_return_mean": 16.595835857026046, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.10184967902296, "num_env_steps_trained_throughput_per_sec": 376.10184967902296, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1524000, "timers": {"training_iteration_time_ms": 10630.429, "restore_workers_time_ms": 0.041, "training_step_time_ms": 10630.162, "sample_time_ms": 1209.044, "learn_time_ms": 9402.368, "learn_throughput": 425.425, "synch_weights_time_ms": 16.925}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "done": false, "training_iteration": 127, "trial_id": "06536_00000", "date": "2024-08-11_17-37-11", "timestamp": 1723412231, "time_this_iter_s": 10.731712579727173, "time_total_s": 3771.9251203536987, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5893f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3771.9251203536987, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 46.39375, "ram_util_percent": 82.61250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.03098937869072, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.141517270108064, "policy_loss": -0.003860042470235688, "vf_loss": 2.1453769080340863, "vf_explained_var": 0.954131901388367, "kl": 0.004097073597048806, "entropy": 0.3476254055276513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9220534481699505, "cur_kl_coeff": 3.1763735522036256e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6326332617689063, "policy_loss": -0.0005804935778200469, "vf_loss": 2.6332137585947755, "vf_explained_var": 0.9406888530052528, "kl": 0.0020126743485714927, "entropy": 0.25117818954445065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 45.205169185013816, "episode_reward_min": -16.215636492534717, "episode_reward_mean": 17.425880149167007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.20516918501381, "predator_policy": -22.06509614692313}, "policy_reward_max": {"prey_policy": 16.215636492534713, "predator_policy": 49.662917841491364}, "policy_reward_mean": {"prey_policy": -17.425880149167007, "predator_policy": 17.425880149167007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.588481098054128, -8.379791156013459, 25.23415735489459, 18.36697049552514, 19.506762966260304, 13.14125681198726, 12.00779265161737, -2.3556747456736966, 11.26916912928993, 31.368513968857606, 25.402455276026053, 25.461097306043506, 12.724719667403336, 15.345482950751828, 23.03389895922531, 5.188255244030625, 22.03323619096652, 14.915879645144667, 22.05685792788563, 15.298582273687591, 12.465515196990081, 22.672515783526492, 29.72232162565305, 6.8050372884954635, 16.245562249452583, 3.5052279334130834, 19.453069950110397, 3.3375192531920304, 26.722834028983257, 22.34134503541319, 23.141876338507494, 7.0633902316818915, 17.644545372012818, 16.781093772956755, 33.46788545053535, 8.07516160534791, 5.9355718526049195, 34.278696276029294, -10.302404780377202, 2.051352721642248, 38.14345106155869, 28.823316753088957, 33.753287371277956, 38.346422514691675, 31.732003483371265, 26.665201088632408, 36.93415654488626, 19.79662678236219, -0.729746769958838, 6.88914243521451, 26.03794505949685, 7.1606544181657, 15.528531494474187, 28.500607475644333, 15.12585279797916, -2.128630565700372, 40.672283287687854, 8.724783813396291, 4.3712283991595005, 14.097131991041461, 3.326917162266467, 45.205169185013816, 27.63320672359131, 29.4102372118911, 3.0954833585689014, 2.5968760804123425, 23.384936614808012, 14.89513730864588, 20.11922915654987, -6.728118750816749, 33.81306638903687, 1.9092067181320438, 5.03762694203116, 34.461703280473316, 0.8462017974898499, 26.262974603031317, 35.11620572867075, 2.66744184845364, 13.405918433092491, 18.78116460135543, 18.659716161069777, 19.392907039495643, -0.648242065400515, 19.239851931156117, 23.500812927971893, 23.670579199393547, -16.215636492534717, 39.9468770690657, 27.16245910007593, 13.933601300850317, 15.809138242865032, 16.51081221813287, 31.373802204708085, -2.097125147228784, 22.457352710500594, 24.59973232247403, 20.019454049082334, 17.682987543934622, 24.95924973196014, 21.328629837824803], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.588481098054082, 8.379791156013448, -25.234157354894588, -18.366970495525162, -19.506762966260272, -13.141256811987262, -12.007792651617363, 2.3556747456736957, -11.269169129289931, -31.368513968857613, -25.40245527602606, -25.461097306043516, -12.72471966740336, -15.345482950751837, -23.033898959225308, -5.1882552440306045, -22.033236190966473, -14.915879645144681, -22.05685792788565, -15.298582273687611, -12.46551519699008, -22.672515783526496, -29.72232162565303, -6.805037288495471, -16.245562249452526, -3.5052279334130745, -19.453069950110397, -3.3375192531920272, -26.722834028983236, -22.341345035413184, -23.141876338507497, -7.06339023168189, -17.644545372012814, -16.78109377295676, -33.4678854505353, -8.075161605347915, -5.935571852604911, -34.27869627602936, 10.302404780377204, -2.0513527216422514, -38.14345106155863, -28.82331675308893, -33.75328737127794, -38.34642251469163, -31.732003483371248, -26.665201088632376, -36.934156544886264, -19.796626782362193, 0.7297467699588367, -6.88914243521451, -26.03794505949684, -7.160654418165735, -15.528531494474176, -28.500607475644326, -15.125852797979192, 2.1286305657003677, -40.67228328768792, -8.724783813396302, -4.371228399159498, -14.097131991041422, -3.3269171622664393, -45.20516918501381, -27.633206723591307, -29.41023721189112, -3.0954833585689014, -2.5968760804123523, -23.384936614808012, -14.895137308645875, -20.11922915654987, 6.7281187508167575, -33.813066389036884, -1.9092067181320571, -5.037626942031158, -34.46170328047335, -0.8462017974898508, -26.262974603031324, -35.116205728670764, -2.6674418484536453, -13.4059184330925, -18.781164601355385, -18.659716161069788, -19.392907039495686, 0.6482420654004901, -19.239851931156124, -23.50081292797192, -23.67057919939357, 16.215636492534713, -39.94687706906568, -27.162459100075907, -13.933601300850315, -15.809138242864995, -16.510812218132887, -31.373802204708078, 2.097125147228785, -22.457352710500597, -24.59973232247402, -20.01945404908236, -17.68298754393463, -24.959249731960124, -21.328629837824803], "policy_predator_policy_reward": [21.585705861407316, 27.591256334700883, -8.816109003451647, -7.943473308575262, 30.435433539302057, 20.032881170487066, 7.6168686544232855, 29.117072336626997, 4.650049765505375, 34.36347616701521, 12.480744923211862, 13.801768700762658, 9.598563983698101, 14.417021319536632, 3.036933439747294, -7.748282931094694, 1.6964943819276925, 20.841843876652174, 18.201650949006414, 44.53537698870877, 28.96636214960644, 21.838548402445674, 29.140574312681416, 21.78162029940558, 11.339632637783245, 14.109806697023469, 27.35453459888788, 3.336431302615761, 20.65202848042947, 25.41576943802116, -2.436650740205925, 12.813161228267154, 14.04522156033282, 30.021250821600148, -2.6247101621301274, 32.45646945241948, 17.12389685955602, 26.98981899621527, 9.23811659136949, 21.359047956005696, 0.47021539584934735, 24.460814998130815, 20.042132217746328, 25.302899349306685, 18.903074973305678, 40.54156827800038, 11.387279209930934, 2.222795367060032, -3.4938509765655397, 35.984975475470634, 5.727219546000894, 1.2832363208252495, 12.65712643698481, 26.249013463235983, 11.889663231464237, -5.214624725080185, 18.353957739124237, 35.09171031884229, -0.3177298020225159, 45.00041987284892, 26.480107220328243, 19.80364545668676, 10.41111249274309, 3.7156679706206646, 15.216898168739972, 20.072192575285655, 15.700382988948633, 17.861804556964884, 42.253678903126826, 24.68209199794388, 19.01264091452871, -2.8623177038329253, -1.3178344586878037, 13.18897816389758, 34.184746421505174, 34.3726461305535, -13.234452703214703, -7.370356857539704, 7.890029902403951, -3.787324459119427, 36.8807905552679, 39.40611156784947, 29.714599332395906, 27.932034173781947, 32.652328507426, 34.85424623512987, 47.61188780620326, 29.080957223180064, 19.843739943404543, 43.62026702333797, 37.63837689239606, 15.692025284868734, 31.54713697399653, 42.321176115775984, 23.809474939465424, 15.783778625258932, 1.2737601872791515, -2.733253727196834, 23.032879547552177, -9.25459467712314, 38.07156577925419, 14.004324339739487, 8.545677020771612, 5.775631815559818, 24.77484813165517, 6.2822148572931935, 32.60447930060917, 24.396735650679442, 30.339523646424276, -0.08781805046590208, 1.6780424499438702, -5.935303581344614, 38.29882782323074, 43.04573875214504, 4.386283293380628, 13.063284333411964, 4.087273457336867, 4.655183340982132, 7.937896652034622, 20.256367330048203, -2.0188908655246234, 8.672725190057507, 47.85013948191056, 42.56019888811708, 28.823350208072355, 26.443063239110263, 32.45878717478759, 26.361687248994585, 5.89636590761855, 0.2946008095192525, 3.137639814281253, 2.0561123465434488, 16.172294028704002, 30.59757920091206, 30.93143622467745, -1.1411616073856976, 14.038787499761622, 26.199670813338116, 8.608858645289633, -22.06509614692313, 26.934056143070997, 40.692076635002714, 7.332863520551635, -3.5144500842875166, 4.624530117817589, 5.4507237662447245, 40.42571725083177, 28.49768931011491, -3.9483610113921515, 5.64076460637186, 21.58235048988044, 30.9435987161822, 20.56949361585014, 49.662917841491364, -4.7663682721721585, 10.101251969079444, 8.553995060727962, 18.257841805457044, 14.362179829352236, 23.20014937335857, 12.93552464507763, 24.383907677061917, 8.022965727914643, 30.76284835107668, 0.15448639680557008, -1.450970527606568, 6.086234269992322, 32.39346959231996, 31.26315053688038, 15.738475319063442, 38.122448550904956, 9.218709847882165, -13.99005577623587, -18.441217208833567, 43.89003720411327, 36.00371693401808, 36.245406777252846, 18.07951142289896, 23.085917857774312, 4.781284743926312, 23.315572793605618, 8.302703692124414, 1.5004784128097226, 31.521146023456012, 36.568189219366204, 26.17941519004995, -3.9113164588937215, -0.28293383556384955, 28.6546881015041, 16.260017319497095, 23.57717823519534, 25.622286409752704, 29.37729103075192, 10.66161706741281, 14.903437213448026, 20.462537874421237, 20.48199978192777, 29.436499681992494, 8.599673143284877, 34.057586532364724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.624788934939001, "mean_inference_ms": 1.659454417336444, "mean_action_processing_ms": 0.25659982295904166, "mean_env_wait_ms": 0.14396215385056105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017879605293273926, "StateBufferConnector_ms": 0.0035152435302734375, "ViewRequirementAgentConnector_ms": 0.13055157661437988}, "num_episodes": 23, "episode_return_max": 45.205169185013816, "episode_return_min": -16.215636492534717, "episode_return_mean": 17.425880149167007, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.8343402156412, "num_env_steps_trained_throughput_per_sec": 371.8343402156412, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 10650.736, "restore_workers_time_ms": 0.039, "training_step_time_ms": 10650.482, "sample_time_ms": 1241.773, "learn_time_ms": 9389.141, "learn_throughput": 426.024, "synch_weights_time_ms": 17.743}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 128, "trial_id": "06536_00000", "date": "2024-08-11_17-37-22", "timestamp": 1723412242, "time_this_iter_s": 10.8109769821167, "time_total_s": 3782.7360973358154, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331699940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3782.7360973358154, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 47.99999999999999, "ram_util_percent": 82.64666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7871789493908485, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.280175981794794, "policy_loss": -0.01298779700155137, "vf_loss": 2.2931634183973073, "vf_explained_var": 0.9331452760845422, "kl": 0.007504570259096433, "entropy": 0.3700897226110101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.693713191892735, "cur_kl_coeff": 1.5881867761018128e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6921392227606797, "policy_loss": -0.002072626776948926, "vf_loss": 2.694211848450716, "vf_explained_var": 0.9267100697471982, "kl": 0.003667299025474173, "entropy": 0.24947928945538858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "env_runners": {"episode_reward_max": 45.205169185013816, "episode_reward_min": -16.215636492534717, "episode_reward_mean": 18.300144740147765, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.20516918501381, "predator_policy": -22.06509614692313}, "policy_reward_max": {"prey_policy": 16.215636492534713, "predator_policy": 54.032669433732444}, "policy_reward_mean": {"prey_policy": -18.300144740147765, "predator_policy": 18.30014474014776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.72232162565305, 6.8050372884954635, 16.245562249452583, 3.5052279334130834, 19.453069950110397, 3.3375192531920304, 26.722834028983257, 22.34134503541319, 23.141876338507494, 7.0633902316818915, 17.644545372012818, 16.781093772956755, 33.46788545053535, 8.07516160534791, 5.9355718526049195, 34.278696276029294, -10.302404780377202, 2.051352721642248, 38.14345106155869, 28.823316753088957, 33.753287371277956, 38.346422514691675, 31.732003483371265, 26.665201088632408, 36.93415654488626, 19.79662678236219, -0.729746769958838, 6.88914243521451, 26.03794505949685, 7.1606544181657, 15.528531494474187, 28.500607475644333, 15.12585279797916, -2.128630565700372, 40.672283287687854, 8.724783813396291, 4.3712283991595005, 14.097131991041461, 3.326917162266467, 45.205169185013816, 27.63320672359131, 29.4102372118911, 3.0954833585689014, 2.5968760804123425, 23.384936614808012, 14.89513730864588, 20.11922915654987, -6.728118750816749, 33.81306638903687, 1.9092067181320438, 5.03762694203116, 34.461703280473316, 0.8462017974898499, 26.262974603031317, 35.11620572867075, 2.66744184845364, 13.405918433092491, 18.78116460135543, 18.659716161069777, 19.392907039495643, -0.648242065400515, 19.239851931156117, 23.500812927971893, 23.670579199393547, -16.215636492534717, 39.9468770690657, 27.16245910007593, 13.933601300850317, 15.809138242865032, 16.51081221813287, 31.373802204708085, -2.097125147228784, 22.457352710500594, 24.59973232247403, 20.019454049082334, 17.682987543934622, 24.95924973196014, 21.328629837824803, 16.874073529425978, 14.22498256350882, 18.858049665365265, 0.8052039742311425, 12.65980913854327, 15.127678380058208, 5.284276571716076, 19.584391530765046, 21.888159304385788, 34.1054453303266, 14.557777492658396, 34.04507323135355, 23.028243988529557, 20.886314712973505, 19.137097701163388, 28.81667045123156, 12.655064308457716, 13.100572880777237, 38.86267049210113, 32.24548150815729, 32.993248572906786, 19.0323087659201], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.72232162565303, -6.805037288495471, -16.245562249452526, -3.5052279334130745, -19.453069950110397, -3.3375192531920272, -26.722834028983236, -22.341345035413184, -23.141876338507497, -7.06339023168189, -17.644545372012814, -16.78109377295676, -33.4678854505353, -8.075161605347915, -5.935571852604911, -34.27869627602936, 10.302404780377204, -2.0513527216422514, -38.14345106155863, -28.82331675308893, -33.75328737127794, -38.34642251469163, -31.732003483371248, -26.665201088632376, -36.934156544886264, -19.796626782362193, 0.7297467699588367, -6.88914243521451, -26.03794505949684, -7.160654418165735, -15.528531494474176, -28.500607475644326, -15.125852797979192, 2.1286305657003677, -40.67228328768792, -8.724783813396302, -4.371228399159498, -14.097131991041422, -3.3269171622664393, -45.20516918501381, -27.633206723591307, -29.41023721189112, -3.0954833585689014, -2.5968760804123523, -23.384936614808012, -14.895137308645875, -20.11922915654987, 6.7281187508167575, -33.813066389036884, -1.9092067181320571, -5.037626942031158, -34.46170328047335, -0.8462017974898508, -26.262974603031324, -35.116205728670764, -2.6674418484536453, -13.4059184330925, -18.781164601355385, -18.659716161069788, -19.392907039495686, 0.6482420654004901, -19.239851931156124, -23.50081292797192, -23.67057919939357, 16.215636492534713, -39.94687706906568, -27.162459100075907, -13.933601300850315, -15.809138242864995, -16.510812218132887, -31.373802204708078, 2.097125147228785, -22.457352710500597, -24.59973232247402, -20.01945404908236, -17.68298754393463, -24.959249731960124, -21.328629837824803, -16.874073529425978, -14.224982563508819, -18.858049665365243, -0.8052039742311408, -12.65980913854326, -15.1276783800582, -5.284276571716115, -19.584391530765043, -21.88815930438578, -34.105445330326646, -14.557777492658396, -34.0450732313535, -23.028243988529567, -20.886314712973522, -19.137097701163405, -28.816670451231598, -12.655064308457721, -13.10057288077726, -38.86267049210117, -32.24548150815729, -32.99324857290678, -19.032308765920057], "policy_predator_policy_reward": [18.903074973305678, 40.54156827800038, 11.387279209930934, 2.222795367060032, -3.4938509765655397, 35.984975475470634, 5.727219546000894, 1.2832363208252495, 12.65712643698481, 26.249013463235983, 11.889663231464237, -5.214624725080185, 18.353957739124237, 35.09171031884229, -0.3177298020225159, 45.00041987284892, 26.480107220328243, 19.80364545668676, 10.41111249274309, 3.7156679706206646, 15.216898168739972, 20.072192575285655, 15.700382988948633, 17.861804556964884, 42.253678903126826, 24.68209199794388, 19.01264091452871, -2.8623177038329253, -1.3178344586878037, 13.18897816389758, 34.184746421505174, 34.3726461305535, -13.234452703214703, -7.370356857539704, 7.890029902403951, -3.787324459119427, 36.8807905552679, 39.40611156784947, 29.714599332395906, 27.932034173781947, 32.652328507426, 34.85424623512987, 47.61188780620326, 29.080957223180064, 19.843739943404543, 43.62026702333797, 37.63837689239606, 15.692025284868734, 31.54713697399653, 42.321176115775984, 23.809474939465424, 15.783778625258932, 1.2737601872791515, -2.733253727196834, 23.032879547552177, -9.25459467712314, 38.07156577925419, 14.004324339739487, 8.545677020771612, 5.775631815559818, 24.77484813165517, 6.2822148572931935, 32.60447930060917, 24.396735650679442, 30.339523646424276, -0.08781805046590208, 1.6780424499438702, -5.935303581344614, 38.29882782323074, 43.04573875214504, 4.386283293380628, 13.063284333411964, 4.087273457336867, 4.655183340982132, 7.937896652034622, 20.256367330048203, -2.0188908655246234, 8.672725190057507, 47.85013948191056, 42.56019888811708, 28.823350208072355, 26.443063239110263, 32.45878717478759, 26.361687248994585, 5.89636590761855, 0.2946008095192525, 3.137639814281253, 2.0561123465434488, 16.172294028704002, 30.59757920091206, 30.93143622467745, -1.1411616073856976, 14.038787499761622, 26.199670813338116, 8.608858645289633, -22.06509614692313, 26.934056143070997, 40.692076635002714, 7.332863520551635, -3.5144500842875166, 4.624530117817589, 5.4507237662447245, 40.42571725083177, 28.49768931011491, -3.9483610113921515, 5.64076460637186, 21.58235048988044, 30.9435987161822, 20.56949361585014, 49.662917841491364, -4.7663682721721585, 10.101251969079444, 8.553995060727962, 18.257841805457044, 14.362179829352236, 23.20014937335857, 12.93552464507763, 24.383907677061917, 8.022965727914643, 30.76284835107668, 0.15448639680557008, -1.450970527606568, 6.086234269992322, 32.39346959231996, 31.26315053688038, 15.738475319063442, 38.122448550904956, 9.218709847882165, -13.99005577623587, -18.441217208833567, 43.89003720411327, 36.00371693401808, 36.245406777252846, 18.07951142289896, 23.085917857774312, 4.781284743926312, 23.315572793605618, 8.302703692124414, 1.5004784128097226, 31.521146023456012, 36.568189219366204, 26.17941519004995, -3.9113164588937215, -0.28293383556384955, 28.6546881015041, 16.260017319497095, 23.57717823519534, 25.622286409752704, 29.37729103075192, 10.66161706741281, 14.903437213448026, 20.462537874421237, 20.48199978192777, 29.436499681992494, 8.599673143284877, 34.057586532364724, 12.619276887961227, 21.12887017089073, 18.917698113621064, 9.532267013396577, 15.894223497975151, 21.821875832755374, 9.819746154924216, -8.209338206461934, 4.003547816289501, 21.31607046079704, 20.97669703076307, 9.27865972935333, -16.120942437153772, 26.68949558058602, 10.793848189232794, 28.374934872297295, 19.27790470971324, 24.498413899058356, 40.51658140525069, 27.694309255402615, 13.02631706842887, 16.08923791688792, 32.03696215263605, 36.05318431007102, 36.36955454058431, 9.686933436474833, 28.866131662250943, 12.906497763696095, 9.01504415130302, 29.2591512510238, 33.30740951637813, 24.325931386085106, -1.8551792610639568, 27.165307877979398, 8.648946083704086, 17.552199677850425, 54.032669433732444, 23.69267155046985, 32.18248856196216, 32.30847445435239, 29.607707949266718, 36.378789196546826, 17.827479641089905, 20.237137890750237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6244796624959995, "mean_inference_ms": 1.6571447759033457, "mean_action_processing_ms": 0.2563886429214576, "mean_env_wait_ms": 0.14385778699607418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017661333084106445, "StateBufferConnector_ms": 0.003377079963684082, "ViewRequirementAgentConnector_ms": 0.1155996322631836}, "num_episodes": 22, "episode_return_max": 45.205169185013816, "episode_return_min": -16.215636492534717, "episode_return_mean": 18.300144740147765, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.84872814634565, "num_env_steps_trained_throughput_per_sec": 295.84872814634565, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1548000, "timers": {"training_iteration_time_ms": 10963.203, "restore_workers_time_ms": 0.039, "training_step_time_ms": 10962.947, "sample_time_ms": 1238.275, "learn_time_ms": 9703.561, "learn_throughput": 412.22, "synch_weights_time_ms": 19.313}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "done": false, "training_iteration": 129, "trial_id": "06536_00000", "date": "2024-08-11_17-37-35", "timestamp": 1723412255, "time_this_iter_s": 13.591437101364136, "time_total_s": 3796.3275344371796, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3796.3275344371796, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 64.3421052631579, "ram_util_percent": 82.85263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.754948232943813, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1501924267659587, "policy_loss": -0.006603997333392423, "vf_loss": 2.15679614606003, "vf_explained_var": 0.9576051610832413, "kl": 0.005804815322498769, "entropy": 0.364709441922605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.768980567732816, "cur_kl_coeff": 7.940933880509064e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.371191274993634, "policy_loss": -0.002416404525911997, "vf_loss": 2.373607678325088, "vf_explained_var": 0.9610188857903557, "kl": 0.004681937645770918, "entropy": 0.23009179655521636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 45.205169185013816, "episode_reward_min": -16.215636492534717, "episode_reward_mean": 18.739307925483672, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.20516918501381, "predator_policy": -22.06509614692313}, "policy_reward_max": {"prey_policy": 16.215636492534713, "predator_policy": 54.032669433732444}, "policy_reward_mean": {"prey_policy": -18.739307925483672, "predator_policy": 18.739307925483672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.14345106155869, 28.823316753088957, 33.753287371277956, 38.346422514691675, 31.732003483371265, 26.665201088632408, 36.93415654488626, 19.79662678236219, -0.729746769958838, 6.88914243521451, 26.03794505949685, 7.1606544181657, 15.528531494474187, 28.500607475644333, 15.12585279797916, -2.128630565700372, 40.672283287687854, 8.724783813396291, 4.3712283991595005, 14.097131991041461, 3.326917162266467, 45.205169185013816, 27.63320672359131, 29.4102372118911, 3.0954833585689014, 2.5968760804123425, 23.384936614808012, 14.89513730864588, 20.11922915654987, -6.728118750816749, 33.81306638903687, 1.9092067181320438, 5.03762694203116, 34.461703280473316, 0.8462017974898499, 26.262974603031317, 35.11620572867075, 2.66744184845364, 13.405918433092491, 18.78116460135543, 18.659716161069777, 19.392907039495643, -0.648242065400515, 19.239851931156117, 23.500812927971893, 23.670579199393547, -16.215636492534717, 39.9468770690657, 27.16245910007593, 13.933601300850317, 15.809138242865032, 16.51081221813287, 31.373802204708085, -2.097125147228784, 22.457352710500594, 24.59973232247403, 20.019454049082334, 17.682987543934622, 24.95924973196014, 21.328629837824803, 16.874073529425978, 14.22498256350882, 18.858049665365265, 0.8052039742311425, 12.65980913854327, 15.127678380058208, 5.284276571716076, 19.584391530765046, 21.888159304385788, 34.1054453303266, 14.557777492658396, 34.04507323135355, 23.028243988529557, 20.886314712973505, 19.137097701163388, 28.81667045123156, 12.655064308457716, 13.100572880777237, 38.86267049210113, 32.24548150815729, 32.993248572906786, 19.0323087659201, 19.048779553867394, 30.260452093427624, 23.168701492871108, 1.519954330498642, 13.365928390837517, 11.834447358485884, 37.13441045334085, 14.68613901574064, -2.715711603770349, 16.298589047163507, 35.24201796044006, 10.292527603063405, 21.620845857809982, 20.850096991371814, 7.003496126912092, 16.975879994040522, 15.197690579225014, 18.402159493919793], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.14345106155863, -28.82331675308893, -33.75328737127794, -38.34642251469163, -31.732003483371248, -26.665201088632376, -36.934156544886264, -19.796626782362193, 0.7297467699588367, -6.88914243521451, -26.03794505949684, -7.160654418165735, -15.528531494474176, -28.500607475644326, -15.125852797979192, 2.1286305657003677, -40.67228328768792, -8.724783813396302, -4.371228399159498, -14.097131991041422, -3.3269171622664393, -45.20516918501381, -27.633206723591307, -29.41023721189112, -3.0954833585689014, -2.5968760804123523, -23.384936614808012, -14.895137308645875, -20.11922915654987, 6.7281187508167575, -33.813066389036884, -1.9092067181320571, -5.037626942031158, -34.46170328047335, -0.8462017974898508, -26.262974603031324, -35.116205728670764, -2.6674418484536453, -13.4059184330925, -18.781164601355385, -18.659716161069788, -19.392907039495686, 0.6482420654004901, -19.239851931156124, -23.50081292797192, -23.67057919939357, 16.215636492534713, -39.94687706906568, -27.162459100075907, -13.933601300850315, -15.809138242864995, -16.510812218132887, -31.373802204708078, 2.097125147228785, -22.457352710500597, -24.59973232247402, -20.01945404908236, -17.68298754393463, -24.959249731960124, -21.328629837824803, -16.874073529425978, -14.224982563508819, -18.858049665365243, -0.8052039742311408, -12.65980913854326, -15.1276783800582, -5.284276571716115, -19.584391530765043, -21.88815930438578, -34.105445330326646, -14.557777492658396, -34.0450732313535, -23.028243988529567, -20.886314712973522, -19.137097701163405, -28.816670451231598, -12.655064308457721, -13.10057288077726, -38.86267049210117, -32.24548150815729, -32.99324857290678, -19.032308765920057, -19.048779553867384, -30.26045209342764, -23.16870149287111, -1.5199543304986864, -13.365928390837475, -11.834447358485875, -37.13441045334084, -14.686139015740618, 2.7157116037703544, -16.298589047163503, -35.24201796044002, -10.292527603063386, -21.620845857809993, -20.850096991371817, -7.003496126912103, -16.975879994040497, -15.197690579224979, -18.40215949391978], "policy_predator_policy_reward": [36.8807905552679, 39.40611156784947, 29.714599332395906, 27.932034173781947, 32.652328507426, 34.85424623512987, 47.61188780620326, 29.080957223180064, 19.843739943404543, 43.62026702333797, 37.63837689239606, 15.692025284868734, 31.54713697399653, 42.321176115775984, 23.809474939465424, 15.783778625258932, 1.2737601872791515, -2.733253727196834, 23.032879547552177, -9.25459467712314, 38.07156577925419, 14.004324339739487, 8.545677020771612, 5.775631815559818, 24.77484813165517, 6.2822148572931935, 32.60447930060917, 24.396735650679442, 30.339523646424276, -0.08781805046590208, 1.6780424499438702, -5.935303581344614, 38.29882782323074, 43.04573875214504, 4.386283293380628, 13.063284333411964, 4.087273457336867, 4.655183340982132, 7.937896652034622, 20.256367330048203, -2.0188908655246234, 8.672725190057507, 47.85013948191056, 42.56019888811708, 28.823350208072355, 26.443063239110263, 32.45878717478759, 26.361687248994585, 5.89636590761855, 0.2946008095192525, 3.137639814281253, 2.0561123465434488, 16.172294028704002, 30.59757920091206, 30.93143622467745, -1.1411616073856976, 14.038787499761622, 26.199670813338116, 8.608858645289633, -22.06509614692313, 26.934056143070997, 40.692076635002714, 7.332863520551635, -3.5144500842875166, 4.624530117817589, 5.4507237662447245, 40.42571725083177, 28.49768931011491, -3.9483610113921515, 5.64076460637186, 21.58235048988044, 30.9435987161822, 20.56949361585014, 49.662917841491364, -4.7663682721721585, 10.101251969079444, 8.553995060727962, 18.257841805457044, 14.362179829352236, 23.20014937335857, 12.93552464507763, 24.383907677061917, 8.022965727914643, 30.76284835107668, 0.15448639680557008, -1.450970527606568, 6.086234269992322, 32.39346959231996, 31.26315053688038, 15.738475319063442, 38.122448550904956, 9.218709847882165, -13.99005577623587, -18.441217208833567, 43.89003720411327, 36.00371693401808, 36.245406777252846, 18.07951142289896, 23.085917857774312, 4.781284743926312, 23.315572793605618, 8.302703692124414, 1.5004784128097226, 31.521146023456012, 36.568189219366204, 26.17941519004995, -3.9113164588937215, -0.28293383556384955, 28.6546881015041, 16.260017319497095, 23.57717823519534, 25.622286409752704, 29.37729103075192, 10.66161706741281, 14.903437213448026, 20.462537874421237, 20.48199978192777, 29.436499681992494, 8.599673143284877, 34.057586532364724, 12.619276887961227, 21.12887017089073, 18.917698113621064, 9.532267013396577, 15.894223497975151, 21.821875832755374, 9.819746154924216, -8.209338206461934, 4.003547816289501, 21.31607046079704, 20.97669703076307, 9.27865972935333, -16.120942437153772, 26.68949558058602, 10.793848189232794, 28.374934872297295, 19.27790470971324, 24.498413899058356, 40.51658140525069, 27.694309255402615, 13.02631706842887, 16.08923791688792, 32.03696215263605, 36.05318431007102, 36.36955454058431, 9.686933436474833, 28.866131662250943, 12.906497763696095, 9.01504415130302, 29.2591512510238, 33.30740951637813, 24.325931386085106, -1.8551792610639568, 27.165307877979398, 8.648946083704086, 17.552199677850425, 54.032669433732444, 23.69267155046985, 32.18248856196216, 32.30847445435239, 29.607707949266718, 36.378789196546826, 17.827479641089905, 20.237137890750237, 25.67053635294298, 12.427022754791793, 52.190294145909384, 8.330610040945881, 46.4451157837295, -0.10771279798730227, -6.623313449683263, 9.663222110680579, 15.965846547034428, 10.766010234640554, 18.486065378714354, 5.182829338257398, 33.416610351030094, 40.852210555651546, 11.230244811791156, 18.142033219690116, 0.5679760772571161, -5.999399284797828, 24.75256786392458, 7.844610230402465, 31.013460487401854, 39.47057543347822, 19.35286396921427, 1.232191236912512, 9.005160800051835, 34.23653091556813, 23.147280286805493, 18.55291369593812, 20.076388972504798, -6.069396718680602, 11.848086264624646, 22.103673723456392, 7.7118853109128, 22.68349584753718, 30.170441871337246, 6.633877116502358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6243562653884563, "mean_inference_ms": 1.6583238470820176, "mean_action_processing_ms": 0.25644954112810225, "mean_env_wait_ms": 0.14386727442470199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059632062911987305, "StateBufferConnector_ms": 0.0032237768173217773, "ViewRequirementAgentConnector_ms": 0.10983598232269287}, "num_episodes": 18, "episode_return_max": 45.205169185013816, "episode_return_min": -16.215636492534717, "episode_return_mean": 18.739307925483672, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.6622203692248, "num_env_steps_trained_throughput_per_sec": 336.6622203692248, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 11110.795, "restore_workers_time_ms": 0.039, "training_step_time_ms": 11110.539, "sample_time_ms": 1335.27, "learn_time_ms": 9752.935, "learn_throughput": 410.133, "synch_weights_time_ms": 20.511}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 130, "trial_id": "06536_00000", "date": "2024-08-11_17-37-47", "timestamp": 1723412267, "time_this_iter_s": 11.927955150604248, "time_total_s": 3808.255489587784, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5893700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3808.255489587784, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 54.311764705882354, "ram_util_percent": 83.11176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.530697335116565, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7986479371786117, "policy_loss": -0.006428554696807017, "vf_loss": 1.8050761484230557, "vf_explained_var": 0.9479684887453914, "kl": 0.0070801095330117764, "entropy": 0.31390086859464644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6929703071634608, "cur_kl_coeff": 3.970466940254532e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3873230830071464, "policy_loss": -0.0010932903941326514, "vf_loss": 2.3884163637640614, "vf_explained_var": 0.9297642273562295, "kl": 0.00292635037325374, "entropy": 0.20697305223771503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "env_runners": {"episode_reward_max": 45.205169185013816, "episode_reward_min": -16.215636492534717, "episode_reward_mean": 18.441029738933146, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.20516918501381, "predator_policy": -22.06509614692313}, "policy_reward_max": {"prey_policy": 16.215636492534713, "predator_policy": 54.032669433732444}, "policy_reward_mean": {"prey_policy": -18.441029738933146, "predator_policy": 18.441029738933146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.3712283991595005, 14.097131991041461, 3.326917162266467, 45.205169185013816, 27.63320672359131, 29.4102372118911, 3.0954833585689014, 2.5968760804123425, 23.384936614808012, 14.89513730864588, 20.11922915654987, -6.728118750816749, 33.81306638903687, 1.9092067181320438, 5.03762694203116, 34.461703280473316, 0.8462017974898499, 26.262974603031317, 35.11620572867075, 2.66744184845364, 13.405918433092491, 18.78116460135543, 18.659716161069777, 19.392907039495643, -0.648242065400515, 19.239851931156117, 23.500812927971893, 23.670579199393547, -16.215636492534717, 39.9468770690657, 27.16245910007593, 13.933601300850317, 15.809138242865032, 16.51081221813287, 31.373802204708085, -2.097125147228784, 22.457352710500594, 24.59973232247403, 20.019454049082334, 17.682987543934622, 24.95924973196014, 21.328629837824803, 16.874073529425978, 14.22498256350882, 18.858049665365265, 0.8052039742311425, 12.65980913854327, 15.127678380058208, 5.284276571716076, 19.584391530765046, 21.888159304385788, 34.1054453303266, 14.557777492658396, 34.04507323135355, 23.028243988529557, 20.886314712973505, 19.137097701163388, 28.81667045123156, 12.655064308457716, 13.100572880777237, 38.86267049210113, 32.24548150815729, 32.993248572906786, 19.0323087659201, 19.048779553867394, 30.260452093427624, 23.168701492871108, 1.519954330498642, 13.365928390837517, 11.834447358485884, 37.13441045334085, 14.68613901574064, -2.715711603770349, 16.298589047163507, 35.24201796044006, 10.292527603063405, 21.620845857809982, 20.850096991371814, 7.003496126912092, 16.975879994040522, 15.197690579225014, 18.402159493919793, 18.898529093061228, 6.996303473946765, 26.09284561573825, 8.958690962189737, 3.3688305729109196, 18.25745812473252, 21.88915659068927, 11.936141850772522, 16.38360746143032, 34.01553779405613, 24.649508242832205, 19.194339652130374, 39.47727736943524, 9.823138815864791, 37.57728287569067, 34.00128799185123, 11.6343856760861, 26.993748227798132], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.371228399159498, -14.097131991041422, -3.3269171622664393, -45.20516918501381, -27.633206723591307, -29.41023721189112, -3.0954833585689014, -2.5968760804123523, -23.384936614808012, -14.895137308645875, -20.11922915654987, 6.7281187508167575, -33.813066389036884, -1.9092067181320571, -5.037626942031158, -34.46170328047335, -0.8462017974898508, -26.262974603031324, -35.116205728670764, -2.6674418484536453, -13.4059184330925, -18.781164601355385, -18.659716161069788, -19.392907039495686, 0.6482420654004901, -19.239851931156124, -23.50081292797192, -23.67057919939357, 16.215636492534713, -39.94687706906568, -27.162459100075907, -13.933601300850315, -15.809138242864995, -16.510812218132887, -31.373802204708078, 2.097125147228785, -22.457352710500597, -24.59973232247402, -20.01945404908236, -17.68298754393463, -24.959249731960124, -21.328629837824803, -16.874073529425978, -14.224982563508819, -18.858049665365243, -0.8052039742311408, -12.65980913854326, -15.1276783800582, -5.284276571716115, -19.584391530765043, -21.88815930438578, -34.105445330326646, -14.557777492658396, -34.0450732313535, -23.028243988529567, -20.886314712973522, -19.137097701163405, -28.816670451231598, -12.655064308457721, -13.10057288077726, -38.86267049210117, -32.24548150815729, -32.99324857290678, -19.032308765920057, -19.048779553867384, -30.26045209342764, -23.16870149287111, -1.5199543304986864, -13.365928390837475, -11.834447358485875, -37.13441045334084, -14.686139015740618, 2.7157116037703544, -16.298589047163503, -35.24201796044002, -10.292527603063386, -21.620845857809993, -20.850096991371817, -7.003496126912103, -16.975879994040497, -15.197690579224979, -18.40215949391978, -18.898529093061196, -6.9963034739467655, -26.092845615738206, -8.958690962189724, -3.3688305729109134, -18.257458124732516, -21.889156590689346, -11.93614185077251, -16.383607461430323, -34.015537794056115, -24.64950824283218, -19.194339652130374, -39.47727736943524, -9.823138815864777, -37.577282875690656, -34.00128799185132, -11.634385676086099, -26.99374822779813], "policy_predator_policy_reward": [4.087273457336867, 4.655183340982132, 7.937896652034622, 20.256367330048203, -2.0188908655246234, 8.672725190057507, 47.85013948191056, 42.56019888811708, 28.823350208072355, 26.443063239110263, 32.45878717478759, 26.361687248994585, 5.89636590761855, 0.2946008095192525, 3.137639814281253, 2.0561123465434488, 16.172294028704002, 30.59757920091206, 30.93143622467745, -1.1411616073856976, 14.038787499761622, 26.199670813338116, 8.608858645289633, -22.06509614692313, 26.934056143070997, 40.692076635002714, 7.332863520551635, -3.5144500842875166, 4.624530117817589, 5.4507237662447245, 40.42571725083177, 28.49768931011491, -3.9483610113921515, 5.64076460637186, 21.58235048988044, 30.9435987161822, 20.56949361585014, 49.662917841491364, -4.7663682721721585, 10.101251969079444, 8.553995060727962, 18.257841805457044, 14.362179829352236, 23.20014937335857, 12.93552464507763, 24.383907677061917, 8.022965727914643, 30.76284835107668, 0.15448639680557008, -1.450970527606568, 6.086234269992322, 32.39346959231996, 31.26315053688038, 15.738475319063442, 38.122448550904956, 9.218709847882165, -13.99005577623587, -18.441217208833567, 43.89003720411327, 36.00371693401808, 36.245406777252846, 18.07951142289896, 23.085917857774312, 4.781284743926312, 23.315572793605618, 8.302703692124414, 1.5004784128097226, 31.521146023456012, 36.568189219366204, 26.17941519004995, -3.9113164588937215, -0.28293383556384955, 28.6546881015041, 16.260017319497095, 23.57717823519534, 25.622286409752704, 29.37729103075192, 10.66161706741281, 14.903437213448026, 20.462537874421237, 20.48199978192777, 29.436499681992494, 8.599673143284877, 34.057586532364724, 12.619276887961227, 21.12887017089073, 18.917698113621064, 9.532267013396577, 15.894223497975151, 21.821875832755374, 9.819746154924216, -8.209338206461934, 4.003547816289501, 21.31607046079704, 20.97669703076307, 9.27865972935333, -16.120942437153772, 26.68949558058602, 10.793848189232794, 28.374934872297295, 19.27790470971324, 24.498413899058356, 40.51658140525069, 27.694309255402615, 13.02631706842887, 16.08923791688792, 32.03696215263605, 36.05318431007102, 36.36955454058431, 9.686933436474833, 28.866131662250943, 12.906497763696095, 9.01504415130302, 29.2591512510238, 33.30740951637813, 24.325931386085106, -1.8551792610639568, 27.165307877979398, 8.648946083704086, 17.552199677850425, 54.032669433732444, 23.69267155046985, 32.18248856196216, 32.30847445435239, 29.607707949266718, 36.378789196546826, 17.827479641089905, 20.237137890750237, 25.67053635294298, 12.427022754791793, 52.190294145909384, 8.330610040945881, 46.4451157837295, -0.10771279798730227, -6.623313449683263, 9.663222110680579, 15.965846547034428, 10.766010234640554, 18.486065378714354, 5.182829338257398, 33.416610351030094, 40.852210555651546, 11.230244811791156, 18.142033219690116, 0.5679760772571161, -5.999399284797828, 24.75256786392458, 7.844610230402465, 31.013460487401854, 39.47057543347822, 19.35286396921427, 1.232191236912512, 9.005160800051835, 34.23653091556813, 23.147280286805493, 18.55291369593812, 20.076388972504798, -6.069396718680602, 11.848086264624646, 22.103673723456392, 7.7118853109128, 22.68349584753718, 30.170441871337246, 6.633877116502358, 16.75079061223776, 21.046267573884595, 2.293500580850229, 11.699106367043306, 25.077231390893317, 27.10845984058311, 4.050566766702612, 13.866815157676836, 4.81039701352713, 1.9272641322946988, 4.751676030635173, 31.76324021882985, 29.129912945434956, 14.648400235943695, 20.357143561717347, 3.5151401398276896, 16.76911966876479, 15.998095254095876, 27.660513858179524, 40.370561729932724, 22.394592427971745, 26.904424057692623, 14.837130968253437, 23.551548336007315, 44.52550331189213, 34.42905142697833, 17.65636760825351, 1.9899100234760598, 40.37745543788973, 34.77711031349161, 29.95405931162667, 38.04851667207588, 9.385702115046588, 13.883069237125651, 19.1675178038708, 34.819978651725464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6242481614457016, "mean_inference_ms": 1.6585579077469048, "mean_action_processing_ms": 0.25648372307915623, "mean_env_wait_ms": 0.14386188028568447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005951642990112305, "StateBufferConnector_ms": 0.003512740135192871, "ViewRequirementAgentConnector_ms": 0.11365854740142822}, "num_episodes": 18, "episode_return_max": 45.205169185013816, "episode_return_min": -16.215636492534717, "episode_return_mean": 18.441029738933146, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.6632658264786, "num_env_steps_trained_throughput_per_sec": 390.6632658264786, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1572000, "timers": {"training_iteration_time_ms": 11073.533, "restore_workers_time_ms": 0.039, "training_step_time_ms": 11073.291, "sample_time_ms": 1328.145, "learn_time_ms": 9721.713, "learn_throughput": 411.45, "synch_weights_time_ms": 21.824}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "done": false, "training_iteration": 131, "trial_id": "06536_00000", "date": "2024-08-11_17-37-58", "timestamp": 1723412278, "time_this_iter_s": 10.298373222351074, "time_total_s": 3818.553862810135, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5893790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3818.553862810135, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 46.033333333333346, "ram_util_percent": 83.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.515508522838354, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8208062791575987, "policy_loss": -0.005315339792286977, "vf_loss": 1.826121322872738, "vf_explained_var": 0.9435713700950146, "kl": 0.006206067683166419, "entropy": 0.32101122024469075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6081339470923894, "cur_kl_coeff": 1.985233470127266e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.414585908190914, "policy_loss": -0.0019816511983258857, "vf_loss": 2.4165675604154195, "vf_explained_var": 0.9246603767392496, "kl": 0.003339785817534671, "entropy": 0.18912469641793342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 39.9468770690657, "episode_reward_min": -16.215636492534717, "episode_reward_mean": 18.14299242444242, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -39.94687706906568, "predator_policy": -18.82168619208355}, "policy_reward_max": {"prey_policy": 16.215636492534713, "predator_policy": 54.032669433732444}, "policy_reward_mean": {"prey_policy": -18.142992424442422, "predator_policy": 18.142992424442422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.392907039495643, -0.648242065400515, 19.239851931156117, 23.500812927971893, 23.670579199393547, -16.215636492534717, 39.9468770690657, 27.16245910007593, 13.933601300850317, 15.809138242865032, 16.51081221813287, 31.373802204708085, -2.097125147228784, 22.457352710500594, 24.59973232247403, 20.019454049082334, 17.682987543934622, 24.95924973196014, 21.328629837824803, 16.874073529425978, 14.22498256350882, 18.858049665365265, 0.8052039742311425, 12.65980913854327, 15.127678380058208, 5.284276571716076, 19.584391530765046, 21.888159304385788, 34.1054453303266, 14.557777492658396, 34.04507323135355, 23.028243988529557, 20.886314712973505, 19.137097701163388, 28.81667045123156, 12.655064308457716, 13.100572880777237, 38.86267049210113, 32.24548150815729, 32.993248572906786, 19.0323087659201, 19.048779553867394, 30.260452093427624, 23.168701492871108, 1.519954330498642, 13.365928390837517, 11.834447358485884, 37.13441045334085, 14.68613901574064, -2.715711603770349, 16.298589047163507, 35.24201796044006, 10.292527603063405, 21.620845857809982, 20.850096991371814, 7.003496126912092, 16.975879994040522, 15.197690579225014, 18.402159493919793, 18.898529093061228, 6.996303473946765, 26.09284561573825, 8.958690962189737, 3.3688305729109196, 18.25745812473252, 21.88915659068927, 11.936141850772522, 16.38360746143032, 34.01553779405613, 24.649508242832205, 19.194339652130374, 39.47727736943524, 9.823138815864791, 37.57728287569067, 34.00128799185123, 11.6343856760861, 26.993748227798132, 11.171860839473402, 6.096955100072911, 16.480063080842765, 37.599735247087025, 21.24369611776862, 14.283633571145439, 15.97974218761262, 3.3198769296253197, 21.459424163444332, 13.137663078743625, -0.145897954488575, 9.017586508926547, 20.285741396197437, 17.473752050907088, 7.41952173748816, -12.065975532980245, 28.42183522322268, 24.172061796085828, 14.38321592049257, 27.70984062810713, -9.425769603152617, 22.03299927144424, 32.513367736829856], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.392907039495686, 0.6482420654004901, -19.239851931156124, -23.50081292797192, -23.67057919939357, 16.215636492534713, -39.94687706906568, -27.162459100075907, -13.933601300850315, -15.809138242864995, -16.510812218132887, -31.373802204708078, 2.097125147228785, -22.457352710500597, -24.59973232247402, -20.01945404908236, -17.68298754393463, -24.959249731960124, -21.328629837824803, -16.874073529425978, -14.224982563508819, -18.858049665365243, -0.8052039742311408, -12.65980913854326, -15.1276783800582, -5.284276571716115, -19.584391530765043, -21.88815930438578, -34.105445330326646, -14.557777492658396, -34.0450732313535, -23.028243988529567, -20.886314712973522, -19.137097701163405, -28.816670451231598, -12.655064308457721, -13.10057288077726, -38.86267049210117, -32.24548150815729, -32.99324857290678, -19.032308765920057, -19.048779553867384, -30.26045209342764, -23.16870149287111, -1.5199543304986864, -13.365928390837475, -11.834447358485875, -37.13441045334084, -14.686139015740618, 2.7157116037703544, -16.298589047163503, -35.24201796044002, -10.292527603063386, -21.620845857809993, -20.850096991371817, -7.003496126912103, -16.975879994040497, -15.197690579224979, -18.40215949391978, -18.898529093061196, -6.9963034739467655, -26.092845615738206, -8.958690962189724, -3.3688305729109134, -18.257458124732516, -21.889156590689346, -11.93614185077251, -16.383607461430323, -34.015537794056115, -24.64950824283218, -19.194339652130374, -39.47727736943524, -9.823138815864777, -37.577282875690656, -34.00128799185132, -11.634385676086099, -26.99374822779813, -11.171860839473403, -6.096955100072941, -16.480063080842733, -37.59973524708703, -21.243696117768614, -14.283633571145437, -15.979742187612635, -3.3198769296252673, -21.459424163444318, -13.137663078743621, 0.145897954488591, -9.017586508926545, -20.28574139619743, -17.473752050907088, -7.419521737488163, 12.065975532980255, -28.421835223222626, -24.172061796085863, -14.383215920492527, -27.709840628107123, 9.425769603152611, -22.03299927144423, -32.51336773682984], "policy_predator_policy_reward": [8.022965727914643, 30.76284835107668, 0.15448639680557008, -1.450970527606568, 6.086234269992322, 32.39346959231996, 31.26315053688038, 15.738475319063442, 38.122448550904956, 9.218709847882165, -13.99005577623587, -18.441217208833567, 43.89003720411327, 36.00371693401808, 36.245406777252846, 18.07951142289896, 23.085917857774312, 4.781284743926312, 23.315572793605618, 8.302703692124414, 1.5004784128097226, 31.521146023456012, 36.568189219366204, 26.17941519004995, -3.9113164588937215, -0.28293383556384955, 28.6546881015041, 16.260017319497095, 23.57717823519534, 25.622286409752704, 29.37729103075192, 10.66161706741281, 14.903437213448026, 20.462537874421237, 20.48199978192777, 29.436499681992494, 8.599673143284877, 34.057586532364724, 12.619276887961227, 21.12887017089073, 18.917698113621064, 9.532267013396577, 15.894223497975151, 21.821875832755374, 9.819746154924216, -8.209338206461934, 4.003547816289501, 21.31607046079704, 20.97669703076307, 9.27865972935333, -16.120942437153772, 26.68949558058602, 10.793848189232794, 28.374934872297295, 19.27790470971324, 24.498413899058356, 40.51658140525069, 27.694309255402615, 13.02631706842887, 16.08923791688792, 32.03696215263605, 36.05318431007102, 36.36955454058431, 9.686933436474833, 28.866131662250943, 12.906497763696095, 9.01504415130302, 29.2591512510238, 33.30740951637813, 24.325931386085106, -1.8551792610639568, 27.165307877979398, 8.648946083704086, 17.552199677850425, 54.032669433732444, 23.69267155046985, 32.18248856196216, 32.30847445435239, 29.607707949266718, 36.378789196546826, 17.827479641089905, 20.237137890750237, 25.67053635294298, 12.427022754791793, 52.190294145909384, 8.330610040945881, 46.4451157837295, -0.10771279798730227, -6.623313449683263, 9.663222110680579, 15.965846547034428, 10.766010234640554, 18.486065378714354, 5.182829338257398, 33.416610351030094, 40.852210555651546, 11.230244811791156, 18.142033219690116, 0.5679760772571161, -5.999399284797828, 24.75256786392458, 7.844610230402465, 31.013460487401854, 39.47057543347822, 19.35286396921427, 1.232191236912512, 9.005160800051835, 34.23653091556813, 23.147280286805493, 18.55291369593812, 20.076388972504798, -6.069396718680602, 11.848086264624646, 22.103673723456392, 7.7118853109128, 22.68349584753718, 30.170441871337246, 6.633877116502358, 16.75079061223776, 21.046267573884595, 2.293500580850229, 11.699106367043306, 25.077231390893317, 27.10845984058311, 4.050566766702612, 13.866815157676836, 4.81039701352713, 1.9272641322946988, 4.751676030635173, 31.76324021882985, 29.129912945434956, 14.648400235943695, 20.357143561717347, 3.5151401398276896, 16.76911966876479, 15.998095254095876, 27.660513858179524, 40.370561729932724, 22.394592427971745, 26.904424057692623, 14.837130968253437, 23.551548336007315, 44.52550331189213, 34.42905142697833, 17.65636760825351, 1.9899100234760598, 40.37745543788973, 34.77711031349161, 29.95405931162667, 38.04851667207588, 9.385702115046588, 13.883069237125651, 19.1675178038708, 34.819978651725464, 8.817043786129714, 13.52667789281709, -4.325516146963741, 16.519426347109576, 23.951040826251862, 9.009085335433694, 32.38121562613069, 42.81825486804337, 14.781642203479912, 27.70575003205733, 7.02935555925577, 21.5379115830351, 23.992024367659738, 7.967460007565508, -12.726382117332562, 19.366135976583116, 33.833031556367104, 9.085816770521582, 18.616611203712388, 7.658714953774849, -18.82168619208355, 18.529890283106383, 11.548400520945528, 6.4867724969075695, 14.740204728908843, 25.83127806348603, 8.136313345348992, 26.81119075646518, 16.116277854838287, -1.277234379861989, -6.4061821480263195, -17.72576891793419, 26.624424576748623, 30.21924586969665, 23.028873615501936, 25.315249976669797, 21.4925626787037, 7.27386916228139, 24.117894694660446, 31.30178656155383, -14.0631175678938, -4.7884216384114175, 24.848505690558383, 19.217492852330075, 45.822574578818646, 19.204160894841095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6243982376007892, "mean_inference_ms": 1.6613478908960742, "mean_action_processing_ms": 0.2568472159092529, "mean_env_wait_ms": 0.14410363345868923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005738496780395508, "StateBufferConnector_ms": 0.0035114288330078125, "ViewRequirementAgentConnector_ms": 0.11598849296569824}, "num_episodes": 23, "episode_return_max": 39.9468770690657, "episode_return_min": -16.215636492534717, "episode_return_mean": 18.14299242444242, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.1142528625892, "num_env_steps_trained_throughput_per_sec": 360.1142528625892, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 11114.611, "restore_workers_time_ms": 0.04, "training_step_time_ms": 11114.36, "sample_time_ms": 1357.307, "learn_time_ms": 9733.274, "learn_throughput": 410.961, "synch_weights_time_ms": 22.176}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 132, "trial_id": "06536_00000", "date": "2024-08-11_17-38-09", "timestamp": 1723412289, "time_this_iter_s": 11.145848989486694, "time_total_s": 3829.6997117996216, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5893ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3829.6997117996216, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 50.64666666666667, "ram_util_percent": 82.78666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.439827491963903, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7362293776745596, "policy_loss": -0.0051395335651856534, "vf_loss": 1.7413686917473872, "vf_explained_var": 0.9598084511235356, "kl": 0.004369022131046926, "entropy": 0.29295954544407626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.340509757099959, "cur_kl_coeff": 9.92616735063633e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5215592232961503, "policy_loss": -0.002268588538503363, "vf_loss": 2.523827811334499, "vf_explained_var": 0.9321152658374221, "kl": 0.0030142084654760076, "entropy": 0.17518732436198406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "env_runners": {"episode_reward_max": 39.47727736943524, "episode_reward_min": -12.065975532980245, "episode_reward_mean": 18.284116749238727, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -39.47727736943524, "predator_policy": -18.82168619208355}, "policy_reward_max": {"prey_policy": 12.065975532980255, "predator_policy": 54.032669433732444}, "policy_reward_mean": {"prey_policy": -18.284116749238727, "predator_policy": 18.284116749238727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.328629837824803, 16.874073529425978, 14.22498256350882, 18.858049665365265, 0.8052039742311425, 12.65980913854327, 15.127678380058208, 5.284276571716076, 19.584391530765046, 21.888159304385788, 34.1054453303266, 14.557777492658396, 34.04507323135355, 23.028243988529557, 20.886314712973505, 19.137097701163388, 28.81667045123156, 12.655064308457716, 13.100572880777237, 38.86267049210113, 32.24548150815729, 32.993248572906786, 19.0323087659201, 19.048779553867394, 30.260452093427624, 23.168701492871108, 1.519954330498642, 13.365928390837517, 11.834447358485884, 37.13441045334085, 14.68613901574064, -2.715711603770349, 16.298589047163507, 35.24201796044006, 10.292527603063405, 21.620845857809982, 20.850096991371814, 7.003496126912092, 16.975879994040522, 15.197690579225014, 18.402159493919793, 18.898529093061228, 6.996303473946765, 26.09284561573825, 8.958690962189737, 3.3688305729109196, 18.25745812473252, 21.88915659068927, 11.936141850772522, 16.38360746143032, 34.01553779405613, 24.649508242832205, 19.194339652130374, 39.47727736943524, 9.823138815864791, 37.57728287569067, 34.00128799185123, 11.6343856760861, 26.993748227798132, 11.171860839473402, 6.096955100072911, 16.480063080842765, 37.599735247087025, 21.24369611776862, 14.283633571145439, 15.97974218761262, 3.3198769296253197, 21.459424163444332, 13.137663078743625, -0.145897954488575, 9.017586508926547, 20.285741396197437, 17.473752050907088, 7.41952173748816, -12.065975532980245, 28.42183522322268, 24.172061796085828, 14.38321592049257, 27.70984062810713, -9.425769603152617, 22.03299927144424, 32.513367736829856, 3.6203210261960734, 32.03418987282001, 16.798242374586565, 22.111706893685522, 7.79617198475918, 10.498145680227768, 10.51044606433397, 13.6328303797072, 19.595233940498098, 24.7563171020217, 15.792459504842284, 8.856667541523999, 24.860212702946995, 14.8718678490768, 33.09860038917411, 26.094361079868328, 31.621618380116267, 18.86165359974881], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.328629837824803, -16.874073529425978, -14.224982563508819, -18.858049665365243, -0.8052039742311408, -12.65980913854326, -15.1276783800582, -5.284276571716115, -19.584391530765043, -21.88815930438578, -34.105445330326646, -14.557777492658396, -34.0450732313535, -23.028243988529567, -20.886314712973522, -19.137097701163405, -28.816670451231598, -12.655064308457721, -13.10057288077726, -38.86267049210117, -32.24548150815729, -32.99324857290678, -19.032308765920057, -19.048779553867384, -30.26045209342764, -23.16870149287111, -1.5199543304986864, -13.365928390837475, -11.834447358485875, -37.13441045334084, -14.686139015740618, 2.7157116037703544, -16.298589047163503, -35.24201796044002, -10.292527603063386, -21.620845857809993, -20.850096991371817, -7.003496126912103, -16.975879994040497, -15.197690579224979, -18.40215949391978, -18.898529093061196, -6.9963034739467655, -26.092845615738206, -8.958690962189724, -3.3688305729109134, -18.257458124732516, -21.889156590689346, -11.93614185077251, -16.383607461430323, -34.015537794056115, -24.64950824283218, -19.194339652130374, -39.47727736943524, -9.823138815864777, -37.577282875690656, -34.00128799185132, -11.634385676086099, -26.99374822779813, -11.171860839473403, -6.096955100072941, -16.480063080842733, -37.59973524708703, -21.243696117768614, -14.283633571145437, -15.979742187612635, -3.3198769296252673, -21.459424163444318, -13.137663078743621, 0.145897954488591, -9.017586508926545, -20.28574139619743, -17.473752050907088, -7.419521737488163, 12.065975532980255, -28.421835223222626, -24.172061796085863, -14.383215920492527, -27.709840628107123, 9.425769603152611, -22.03299927144423, -32.51336773682984, -3.6203210261960788, -32.034189872819994, -16.798242374586565, -22.111706893685504, -7.796171984759184, -10.498145680227774, -10.51044606433401, -13.632830379707212, -19.59523394049809, -24.756317102021704, -15.792459504842284, -8.856667541523986, -24.860212702946985, -14.871867849076764, -33.09860038917411, -26.094361079868406, -31.62161838011628, -18.861653599748813], "policy_predator_policy_reward": [8.599673143284877, 34.057586532364724, 12.619276887961227, 21.12887017089073, 18.917698113621064, 9.532267013396577, 15.894223497975151, 21.821875832755374, 9.819746154924216, -8.209338206461934, 4.003547816289501, 21.31607046079704, 20.97669703076307, 9.27865972935333, -16.120942437153772, 26.68949558058602, 10.793848189232794, 28.374934872297295, 19.27790470971324, 24.498413899058356, 40.51658140525069, 27.694309255402615, 13.02631706842887, 16.08923791688792, 32.03696215263605, 36.05318431007102, 36.36955454058431, 9.686933436474833, 28.866131662250943, 12.906497763696095, 9.01504415130302, 29.2591512510238, 33.30740951637813, 24.325931386085106, -1.8551792610639568, 27.165307877979398, 8.648946083704086, 17.552199677850425, 54.032669433732444, 23.69267155046985, 32.18248856196216, 32.30847445435239, 29.607707949266718, 36.378789196546826, 17.827479641089905, 20.237137890750237, 25.67053635294298, 12.427022754791793, 52.190294145909384, 8.330610040945881, 46.4451157837295, -0.10771279798730227, -6.623313449683263, 9.663222110680579, 15.965846547034428, 10.766010234640554, 18.486065378714354, 5.182829338257398, 33.416610351030094, 40.852210555651546, 11.230244811791156, 18.142033219690116, 0.5679760772571161, -5.999399284797828, 24.75256786392458, 7.844610230402465, 31.013460487401854, 39.47057543347822, 19.35286396921427, 1.232191236912512, 9.005160800051835, 34.23653091556813, 23.147280286805493, 18.55291369593812, 20.076388972504798, -6.069396718680602, 11.848086264624646, 22.103673723456392, 7.7118853109128, 22.68349584753718, 30.170441871337246, 6.633877116502358, 16.75079061223776, 21.046267573884595, 2.293500580850229, 11.699106367043306, 25.077231390893317, 27.10845984058311, 4.050566766702612, 13.866815157676836, 4.81039701352713, 1.9272641322946988, 4.751676030635173, 31.76324021882985, 29.129912945434956, 14.648400235943695, 20.357143561717347, 3.5151401398276896, 16.76911966876479, 15.998095254095876, 27.660513858179524, 40.370561729932724, 22.394592427971745, 26.904424057692623, 14.837130968253437, 23.551548336007315, 44.52550331189213, 34.42905142697833, 17.65636760825351, 1.9899100234760598, 40.37745543788973, 34.77711031349161, 29.95405931162667, 38.04851667207588, 9.385702115046588, 13.883069237125651, 19.1675178038708, 34.819978651725464, 8.817043786129714, 13.52667789281709, -4.325516146963741, 16.519426347109576, 23.951040826251862, 9.009085335433694, 32.38121562613069, 42.81825486804337, 14.781642203479912, 27.70575003205733, 7.02935555925577, 21.5379115830351, 23.992024367659738, 7.967460007565508, -12.726382117332562, 19.366135976583116, 33.833031556367104, 9.085816770521582, 18.616611203712388, 7.658714953774849, -18.82168619208355, 18.529890283106383, 11.548400520945528, 6.4867724969075695, 14.740204728908843, 25.83127806348603, 8.136313345348992, 26.81119075646518, 16.116277854838287, -1.277234379861989, -6.4061821480263195, -17.72576891793419, 26.624424576748623, 30.21924586969665, 23.028873615501936, 25.315249976669797, 21.4925626787037, 7.27386916228139, 24.117894694660446, 31.30178656155383, -14.0631175678938, -4.7884216384114175, 24.848505690558383, 19.217492852330075, 45.822574578818646, 19.204160894841095, 5.931981689351435, 1.3086603630407154, 21.74017179427448, 42.32820795136553, 14.36164494265157, 19.234839806521556, 15.907260761317964, 28.316153026053044, 2.614063638270668, 12.978280331247689, 1.7519411211777385, 19.2443502392778, 10.537354687344111, 10.483537441323907, 9.123355361318636, 18.1423053980958, 14.052952320296288, 25.137515560699896, 16.374209183064927, 33.138425020978474, 16.469753597200004, 15.115165412484544, 15.593785230421203, 2.11954985262677, 10.872726101384929, 38.84769930450905, 29.900282630485894, -0.1565469323323363, 31.815631926681412, 34.38156885166679, 28.07057944067129, 24.118142719065425, 18.469178054124267, 44.77405870610828, 12.644528482515526, 25.078778716982093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6239156425702683, "mean_inference_ms": 1.6592391947929253, "mean_action_processing_ms": 0.2565812798343412, "mean_env_wait_ms": 0.1438071556071165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004197955131530762, "StateBufferConnector_ms": 0.0032720565795898438, "ViewRequirementAgentConnector_ms": 0.10943865776062012}, "num_episodes": 18, "episode_return_max": 39.47727736943524, "episode_return_min": -12.065975532980245, "episode_return_mean": 18.284116749238727, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.1635578846529, "num_env_steps_trained_throughput_per_sec": 371.1635578846529, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1596000, "timers": {"training_iteration_time_ms": 11121.956, "restore_workers_time_ms": 0.042, "training_step_time_ms": 11121.703, "sample_time_ms": 1385.789, "learn_time_ms": 9712.055, "learn_throughput": 411.859, "synch_weights_time_ms": 22.311}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "done": false, "training_iteration": 133, "trial_id": "06536_00000", "date": "2024-08-11_17-38-20", "timestamp": 1723412300, "time_this_iter_s": 10.84310507774353, "time_total_s": 3840.542816877365, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331792310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3840.542816877365, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 47.4, "ram_util_percent": 83.04375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.733105934535464, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.82795473386844, "policy_loss": -0.007720770106000903, "vf_loss": 1.8356753139446178, "vf_explained_var": 0.95048443817844, "kl": 0.007417857702739409, "entropy": 0.3766808231671651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.900868849779563, "cur_kl_coeff": 4.963083675318165e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.343257866334663, "policy_loss": -0.002232625158429737, "vf_loss": 2.3454904869750695, "vf_explained_var": 0.9341078332492283, "kl": 0.0023910088949656073, "entropy": 0.22664508663472674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "env_runners": {"episode_reward_max": 51.36805889756212, "episode_reward_min": -12.065975532980245, "episode_reward_mean": 17.033161952858258, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36805889756216, "predator_policy": -18.82168619208355}, "policy_reward_max": {"prey_policy": 12.065975532980255, "predator_policy": 52.55828380795427}, "policy_reward_mean": {"prey_policy": -17.033161952858254, "predator_policy": 17.033161952858258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0323087659201, 19.048779553867394, 30.260452093427624, 23.168701492871108, 1.519954330498642, 13.365928390837517, 11.834447358485884, 37.13441045334085, 14.68613901574064, -2.715711603770349, 16.298589047163507, 35.24201796044006, 10.292527603063405, 21.620845857809982, 20.850096991371814, 7.003496126912092, 16.975879994040522, 15.197690579225014, 18.402159493919793, 18.898529093061228, 6.996303473946765, 26.09284561573825, 8.958690962189737, 3.3688305729109196, 18.25745812473252, 21.88915659068927, 11.936141850772522, 16.38360746143032, 34.01553779405613, 24.649508242832205, 19.194339652130374, 39.47727736943524, 9.823138815864791, 37.57728287569067, 34.00128799185123, 11.6343856760861, 26.993748227798132, 11.171860839473402, 6.096955100072911, 16.480063080842765, 37.599735247087025, 21.24369611776862, 14.283633571145439, 15.97974218761262, 3.3198769296253197, 21.459424163444332, 13.137663078743625, -0.145897954488575, 9.017586508926547, 20.285741396197437, 17.473752050907088, 7.41952173748816, -12.065975532980245, 28.42183522322268, 24.172061796085828, 14.38321592049257, 27.70984062810713, -9.425769603152617, 22.03299927144424, 32.513367736829856, 3.6203210261960734, 32.03418987282001, 16.798242374586565, 22.111706893685522, 7.79617198475918, 10.498145680227768, 10.51044606433397, 13.6328303797072, 19.595233940498098, 24.7563171020217, 15.792459504842284, 8.856667541523999, 24.860212702946995, 14.8718678490768, 33.09860038917411, 26.094361079868328, 31.621618380116267, 18.86165359974881, 30.842068591929728, -6.625827220686034, 16.903148955609637, 24.631621383590467, 24.586235903161153, 2.351086277158341, 51.36805889756212, 17.61065820151435, -8.874833516298974, 12.643348353283837, 2.4959417528200554, 24.178659763795626, 17.16720711270558, 16.312941797874096, 17.763272743996943, -2.5347144018307164, 24.9724157828119, 15.724936235175731, 16.986140440051404, 20.795120808805354, 0.926689389337044, 5.749258276046358], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.032308765920057, -19.048779553867384, -30.26045209342764, -23.16870149287111, -1.5199543304986864, -13.365928390837475, -11.834447358485875, -37.13441045334084, -14.686139015740618, 2.7157116037703544, -16.298589047163503, -35.24201796044002, -10.292527603063386, -21.620845857809993, -20.850096991371817, -7.003496126912103, -16.975879994040497, -15.197690579224979, -18.40215949391978, -18.898529093061196, -6.9963034739467655, -26.092845615738206, -8.958690962189724, -3.3688305729109134, -18.257458124732516, -21.889156590689346, -11.93614185077251, -16.383607461430323, -34.015537794056115, -24.64950824283218, -19.194339652130374, -39.47727736943524, -9.823138815864777, -37.577282875690656, -34.00128799185132, -11.634385676086099, -26.99374822779813, -11.171860839473403, -6.096955100072941, -16.480063080842733, -37.59973524708703, -21.243696117768614, -14.283633571145437, -15.979742187612635, -3.3198769296252673, -21.459424163444318, -13.137663078743621, 0.145897954488591, -9.017586508926545, -20.28574139619743, -17.473752050907088, -7.419521737488163, 12.065975532980255, -28.421835223222626, -24.172061796085863, -14.383215920492527, -27.709840628107123, 9.425769603152611, -22.03299927144423, -32.51336773682984, -3.6203210261960788, -32.034189872819994, -16.798242374586565, -22.111706893685504, -7.796171984759184, -10.498145680227774, -10.51044606433401, -13.632830379707212, -19.59523394049809, -24.756317102021704, -15.792459504842284, -8.856667541523986, -24.860212702946985, -14.871867849076764, -33.09860038917411, -26.094361079868406, -31.62161838011628, -18.861653599748813, -30.842068591929642, 6.625827220686031, -16.903148955609662, -24.631621383590467, -24.58623590316118, -2.351086277158336, -51.36805889756216, -17.610658201514347, 8.874833516298965, -12.64334835328384, -2.495941752820049, -24.17865976379563, -17.167207112705594, -16.312941797874082, -17.76327274399694, 2.534714401830719, -24.972415782811897, -15.724936235175718, -16.9861404400514, -20.79512080880533, -0.9266893893370449, -5.749258276046357], "policy_predator_policy_reward": [17.827479641089905, 20.237137890750237, 25.67053635294298, 12.427022754791793, 52.190294145909384, 8.330610040945881, 46.4451157837295, -0.10771279798730227, -6.623313449683263, 9.663222110680579, 15.965846547034428, 10.766010234640554, 18.486065378714354, 5.182829338257398, 33.416610351030094, 40.852210555651546, 11.230244811791156, 18.142033219690116, 0.5679760772571161, -5.999399284797828, 24.75256786392458, 7.844610230402465, 31.013460487401854, 39.47057543347822, 19.35286396921427, 1.232191236912512, 9.005160800051835, 34.23653091556813, 23.147280286805493, 18.55291369593812, 20.076388972504798, -6.069396718680602, 11.848086264624646, 22.103673723456392, 7.7118853109128, 22.68349584753718, 30.170441871337246, 6.633877116502358, 16.75079061223776, 21.046267573884595, 2.293500580850229, 11.699106367043306, 25.077231390893317, 27.10845984058311, 4.050566766702612, 13.866815157676836, 4.81039701352713, 1.9272641322946988, 4.751676030635173, 31.76324021882985, 29.129912945434956, 14.648400235943695, 20.357143561717347, 3.5151401398276896, 16.76911966876479, 15.998095254095876, 27.660513858179524, 40.370561729932724, 22.394592427971745, 26.904424057692623, 14.837130968253437, 23.551548336007315, 44.52550331189213, 34.42905142697833, 17.65636760825351, 1.9899100234760598, 40.37745543788973, 34.77711031349161, 29.95405931162667, 38.04851667207588, 9.385702115046588, 13.883069237125651, 19.1675178038708, 34.819978651725464, 8.817043786129714, 13.52667789281709, -4.325516146963741, 16.519426347109576, 23.951040826251862, 9.009085335433694, 32.38121562613069, 42.81825486804337, 14.781642203479912, 27.70575003205733, 7.02935555925577, 21.5379115830351, 23.992024367659738, 7.967460007565508, -12.726382117332562, 19.366135976583116, 33.833031556367104, 9.085816770521582, 18.616611203712388, 7.658714953774849, -18.82168619208355, 18.529890283106383, 11.548400520945528, 6.4867724969075695, 14.740204728908843, 25.83127806348603, 8.136313345348992, 26.81119075646518, 16.116277854838287, -1.277234379861989, -6.4061821480263195, -17.72576891793419, 26.624424576748623, 30.21924586969665, 23.028873615501936, 25.315249976669797, 21.4925626787037, 7.27386916228139, 24.117894694660446, 31.30178656155383, -14.0631175678938, -4.7884216384114175, 24.848505690558383, 19.217492852330075, 45.822574578818646, 19.204160894841095, 5.931981689351435, 1.3086603630407154, 21.74017179427448, 42.32820795136553, 14.36164494265157, 19.234839806521556, 15.907260761317964, 28.316153026053044, 2.614063638270668, 12.978280331247689, 1.7519411211777385, 19.2443502392778, 10.537354687344111, 10.483537441323907, 9.123355361318636, 18.1423053980958, 14.052952320296288, 25.137515560699896, 16.374209183064927, 33.138425020978474, 16.469753597200004, 15.115165412484544, 15.593785230421203, 2.11954985262677, 10.872726101384929, 38.84769930450905, 29.900282630485894, -0.1565469323323363, 31.815631926681412, 34.38156885166679, 28.07057944067129, 24.118142719065425, 18.469178054124267, 44.77405870610828, 12.644528482515526, 25.078778716982093, 32.22775706345386, 29.456380120405488, -4.505978974074047, -8.745675467298035, 25.66504340235988, 8.141254508859433, 7.056593786192522, 42.20664898098841, 34.74098361139813, 14.431488194924196, -7.02565391496714, 11.727826469283805, 50.17783398716999, 52.55828380795427, 15.467600831697673, 19.753715571331018, -4.157732458358683, -13.591934574239248, 4.615590285098332, 20.671106421469386, -15.370108605259716, 20.36199211089983, 23.87514193138893, 24.482177596202327, -1.515829820231934, 35.85024404564311, 17.259596864689506, 15.36628673105866, 31.12889583562831, 4.397649652365587, 5.93135869701824, -11.000787500679671, 37.68976587526206, 12.255065690361752, 13.328768817691218, 18.12110365266023, 20.81935775022575, 13.152923129877042, 18.99057414042946, 22.599667477181207, 2.179789339400049, -0.3264105607259582, 10.584359312229104, 0.91415723986362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6240786722858249, "mean_inference_ms": 1.660414903240395, "mean_action_processing_ms": 0.25674169543851977, "mean_env_wait_ms": 0.1438687999803584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005049347877502441, "StateBufferConnector_ms": 0.0035295486450195312, "ViewRequirementAgentConnector_ms": 0.12022852897644043}, "num_episodes": 22, "episode_return_max": 51.36805889756212, "episode_return_min": -12.065975532980245, "episode_return_mean": 17.033161952858258, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.4175006915853, "num_env_steps_trained_throughput_per_sec": 347.4175006915853, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 11222.591, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11222.464, "sample_time_ms": 1372.279, "learn_time_ms": 9828.675, "learn_throughput": 406.972, "synch_weights_time_ms": 20.435}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "training_iteration": 134, "trial_id": "06536_00000", "date": "2024-08-11_17-38-31", "timestamp": 1723412311, "time_this_iter_s": 11.553523063659668, "time_total_s": 3852.096339941025, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331792dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3852.096339941025, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 52.08125, "ram_util_percent": 83.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3788633801043035, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6170375507324934, "policy_loss": -0.010677069113201772, "vf_loss": 1.6277142889176806, "vf_explained_var": 0.9547662510847051, "kl": 0.013544641429309142, "entropy": 0.35962245740617316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.640250125763908, "cur_kl_coeff": 2.4815418376590825e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2259801748568417, "policy_loss": -0.0032649734845907287, "vf_loss": 2.229245148197053, "vf_explained_var": 0.9438601656250222, "kl": 0.008287477881108297, "entropy": 0.20106652800841307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "env_runners": {"episode_reward_max": 51.36805889756212, "episode_reward_min": -12.065975532980245, "episode_reward_mean": 16.341618669631135, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36805889756216, "predator_policy": -18.82168619208355}, "policy_reward_max": {"prey_policy": 12.065975532980255, "predator_policy": 54.57874380772435}, "policy_reward_mean": {"prey_policy": -16.341618669631135, "predator_policy": 16.341618669631135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.402159493919793, 18.898529093061228, 6.996303473946765, 26.09284561573825, 8.958690962189737, 3.3688305729109196, 18.25745812473252, 21.88915659068927, 11.936141850772522, 16.38360746143032, 34.01553779405613, 24.649508242832205, 19.194339652130374, 39.47727736943524, 9.823138815864791, 37.57728287569067, 34.00128799185123, 11.6343856760861, 26.993748227798132, 11.171860839473402, 6.096955100072911, 16.480063080842765, 37.599735247087025, 21.24369611776862, 14.283633571145439, 15.97974218761262, 3.3198769296253197, 21.459424163444332, 13.137663078743625, -0.145897954488575, 9.017586508926547, 20.285741396197437, 17.473752050907088, 7.41952173748816, -12.065975532980245, 28.42183522322268, 24.172061796085828, 14.38321592049257, 27.70984062810713, -9.425769603152617, 22.03299927144424, 32.513367736829856, 3.6203210261960734, 32.03418987282001, 16.798242374586565, 22.111706893685522, 7.79617198475918, 10.498145680227768, 10.51044606433397, 13.6328303797072, 19.595233940498098, 24.7563171020217, 15.792459504842284, 8.856667541523999, 24.860212702946995, 14.8718678490768, 33.09860038917411, 26.094361079868328, 31.621618380116267, 18.86165359974881, 30.842068591929728, -6.625827220686034, 16.903148955609637, 24.631621383590467, 24.586235903161153, 2.351086277158341, 51.36805889756212, 17.61065820151435, -8.874833516298974, 12.643348353283837, 2.4959417528200554, 24.178659763795626, 17.16720711270558, 16.312941797874096, 17.763272743996943, -2.5347144018307164, 24.9724157828119, 15.724936235175731, 16.986140440051404, 20.795120808805354, 0.926689389337044, 5.749258276046358, 9.064471950668596, 12.202036906912785, -4.734500285393915, 21.048996270984443, 2.6053426036898752, 16.646942309512056, 13.120627596068331, 2.894642440241163, 18.236113124276397, 28.517865944941306, 4.109660940164861, 6.9627801282818975, 7.376586266038048, 27.778790714528967, 25.45712846378347, 6.215860805837874, 5.103959984446436, 39.054919523550964], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.40215949391978, -18.898529093061196, -6.9963034739467655, -26.092845615738206, -8.958690962189724, -3.3688305729109134, -18.257458124732516, -21.889156590689346, -11.93614185077251, -16.383607461430323, -34.015537794056115, -24.64950824283218, -19.194339652130374, -39.47727736943524, -9.823138815864777, -37.577282875690656, -34.00128799185132, -11.634385676086099, -26.99374822779813, -11.171860839473403, -6.096955100072941, -16.480063080842733, -37.59973524708703, -21.243696117768614, -14.283633571145437, -15.979742187612635, -3.3198769296252673, -21.459424163444318, -13.137663078743621, 0.145897954488591, -9.017586508926545, -20.28574139619743, -17.473752050907088, -7.419521737488163, 12.065975532980255, -28.421835223222626, -24.172061796085863, -14.383215920492527, -27.709840628107123, 9.425769603152611, -22.03299927144423, -32.51336773682984, -3.6203210261960788, -32.034189872819994, -16.798242374586565, -22.111706893685504, -7.796171984759184, -10.498145680227774, -10.51044606433401, -13.632830379707212, -19.59523394049809, -24.756317102021704, -15.792459504842284, -8.856667541523986, -24.860212702946985, -14.871867849076764, -33.09860038917411, -26.094361079868406, -31.62161838011628, -18.861653599748813, -30.842068591929642, 6.625827220686031, -16.903148955609662, -24.631621383590467, -24.58623590316118, -2.351086277158336, -51.36805889756216, -17.610658201514347, 8.874833516298965, -12.64334835328384, -2.495941752820049, -24.17865976379563, -17.167207112705594, -16.312941797874082, -17.76327274399694, 2.534714401830719, -24.972415782811897, -15.724936235175718, -16.9861404400514, -20.79512080880533, -0.9266893893370449, -5.749258276046357, -9.064471950668576, -12.202036906912802, 4.7345002853939215, -21.048996270984464, -2.6053426036898806, -16.646942309512067, -13.12062759606833, -2.8946424402411592, -18.2361131242764, -28.517865944941324, -4.109660940164872, -6.962780128281907, -7.376586266038085, -27.778790714528967, -25.45712846378347, -6.215860805837876, -5.103959984446427, -39.05491952355099], "policy_predator_policy_reward": [30.170441871337246, 6.633877116502358, 16.75079061223776, 21.046267573884595, 2.293500580850229, 11.699106367043306, 25.077231390893317, 27.10845984058311, 4.050566766702612, 13.866815157676836, 4.81039701352713, 1.9272641322946988, 4.751676030635173, 31.76324021882985, 29.129912945434956, 14.648400235943695, 20.357143561717347, 3.5151401398276896, 16.76911966876479, 15.998095254095876, 27.660513858179524, 40.370561729932724, 22.394592427971745, 26.904424057692623, 14.837130968253437, 23.551548336007315, 44.52550331189213, 34.42905142697833, 17.65636760825351, 1.9899100234760598, 40.37745543788973, 34.77711031349161, 29.95405931162667, 38.04851667207588, 9.385702115046588, 13.883069237125651, 19.1675178038708, 34.819978651725464, 8.817043786129714, 13.52667789281709, -4.325516146963741, 16.519426347109576, 23.951040826251862, 9.009085335433694, 32.38121562613069, 42.81825486804337, 14.781642203479912, 27.70575003205733, 7.02935555925577, 21.5379115830351, 23.992024367659738, 7.967460007565508, -12.726382117332562, 19.366135976583116, 33.833031556367104, 9.085816770521582, 18.616611203712388, 7.658714953774849, -18.82168619208355, 18.529890283106383, 11.548400520945528, 6.4867724969075695, 14.740204728908843, 25.83127806348603, 8.136313345348992, 26.81119075646518, 16.116277854838287, -1.277234379861989, -6.4061821480263195, -17.72576891793419, 26.624424576748623, 30.21924586969665, 23.028873615501936, 25.315249976669797, 21.4925626787037, 7.27386916228139, 24.117894694660446, 31.30178656155383, -14.0631175678938, -4.7884216384114175, 24.848505690558383, 19.217492852330075, 45.822574578818646, 19.204160894841095, 5.931981689351435, 1.3086603630407154, 21.74017179427448, 42.32820795136553, 14.36164494265157, 19.234839806521556, 15.907260761317964, 28.316153026053044, 2.614063638270668, 12.978280331247689, 1.7519411211777385, 19.2443502392778, 10.537354687344111, 10.483537441323907, 9.123355361318636, 18.1423053980958, 14.052952320296288, 25.137515560699896, 16.374209183064927, 33.138425020978474, 16.469753597200004, 15.115165412484544, 15.593785230421203, 2.11954985262677, 10.872726101384929, 38.84769930450905, 29.900282630485894, -0.1565469323323363, 31.815631926681412, 34.38156885166679, 28.07057944067129, 24.118142719065425, 18.469178054124267, 44.77405870610828, 12.644528482515526, 25.078778716982093, 32.22775706345386, 29.456380120405488, -4.505978974074047, -8.745675467298035, 25.66504340235988, 8.141254508859433, 7.056593786192522, 42.20664898098841, 34.74098361139813, 14.431488194924196, -7.02565391496714, 11.727826469283805, 50.17783398716999, 52.55828380795427, 15.467600831697673, 19.753715571331018, -4.157732458358683, -13.591934574239248, 4.615590285098332, 20.671106421469386, -15.370108605259716, 20.36199211089983, 23.87514193138893, 24.482177596202327, -1.515829820231934, 35.85024404564311, 17.259596864689506, 15.36628673105866, 31.12889583562831, 4.397649652365587, 5.93135869701824, -11.000787500679671, 37.68976587526206, 12.255065690361752, 13.328768817691218, 18.12110365266023, 20.81935775022575, 13.152923129877042, 18.99057414042946, 22.599667477181207, 2.179789339400049, -0.3264105607259582, 10.584359312229104, 0.91415723986362, 20.528317690679312, -2.3993737893421656, 15.770486513579893, 8.633587300245708, 4.13687670963211, -13.605877280419957, 12.921909589822302, 29.17608295214659, -0.3028524209525507, 5.513537628332301, 9.209838517151393, 24.084046101872737, 9.254668588509848, 16.986586603626805, -0.10941399101466054, 5.898698871496979, 12.341288183840387, 24.130938064712407, 18.58315321256472, 38.45257867731791, -5.414097144857408, 13.633419025187084, 3.4550077707081925, 10.470552485855597, 7.074676405232241, 7.678496126843928, 20.444144522093286, 35.11343690696466, 21.83070034229897, 29.08355658526795, 9.13281418035569, 3.298907431320063, -0.42234690012242915, 10.630266869015296, 23.53109523937763, 54.57874380772435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6240107121509166, "mean_inference_ms": 1.6603121264292064, "mean_action_processing_ms": 0.2567721480933075, "mean_env_wait_ms": 0.14385661764036456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005281925201416016, "StateBufferConnector_ms": 0.003551006317138672, "ViewRequirementAgentConnector_ms": 0.10355651378631592}, "num_episodes": 18, "episode_return_max": 51.36805889756212, "episode_return_min": -12.065975532980245, "episode_return_mean": 16.341618669631135, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.41832544963336, "num_env_steps_trained_throughput_per_sec": 369.41832544963336, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1620000, "timers": {"training_iteration_time_ms": 11177.774, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11177.656, "sample_time_ms": 1360.056, "learn_time_ms": 9794.792, "learn_throughput": 408.38, "synch_weights_time_ms": 21.628}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "done": false, "training_iteration": 135, "trial_id": "06536_00000", "date": "2024-08-11_17-38-42", "timestamp": 1723412322, "time_this_iter_s": 10.906214237213135, "time_total_s": 3863.002554178238, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5893ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3863.002554178238, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 48.01875, "ram_util_percent": 83.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7782471239566804, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.713979248329997, "policy_loss": -0.004249861510955574, "vf_loss": 2.7182288989424706, "vf_explained_var": 0.9027939156318704, "kl": 0.007444757130914266, "entropy": 0.3456298924672107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9725095444886143, "cur_kl_coeff": 2.4815418376590825e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3554873083003613, "policy_loss": -0.0018818030555156015, "vf_loss": 3.357369109184023, "vf_explained_var": 0.878203457562381, "kl": 0.004956892389884864, "entropy": 0.2591109640620373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 51.36805889756212, "episode_reward_min": -12.065975532980245, "episode_reward_mean": 15.84236336375919, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36805889756216, "predator_policy": -18.82168619208355}, "policy_reward_max": {"prey_policy": 12.065975532980255, "predator_policy": 54.57874380772435}, "policy_reward_mean": {"prey_policy": -15.842363363759194, "predator_policy": 15.842363363759194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.993748227798132, 11.171860839473402, 6.096955100072911, 16.480063080842765, 37.599735247087025, 21.24369611776862, 14.283633571145439, 15.97974218761262, 3.3198769296253197, 21.459424163444332, 13.137663078743625, -0.145897954488575, 9.017586508926547, 20.285741396197437, 17.473752050907088, 7.41952173748816, -12.065975532980245, 28.42183522322268, 24.172061796085828, 14.38321592049257, 27.70984062810713, -9.425769603152617, 22.03299927144424, 32.513367736829856, 3.6203210261960734, 32.03418987282001, 16.798242374586565, 22.111706893685522, 7.79617198475918, 10.498145680227768, 10.51044606433397, 13.6328303797072, 19.595233940498098, 24.7563171020217, 15.792459504842284, 8.856667541523999, 24.860212702946995, 14.8718678490768, 33.09860038917411, 26.094361079868328, 31.621618380116267, 18.86165359974881, 30.842068591929728, -6.625827220686034, 16.903148955609637, 24.631621383590467, 24.586235903161153, 2.351086277158341, 51.36805889756212, 17.61065820151435, -8.874833516298974, 12.643348353283837, 2.4959417528200554, 24.178659763795626, 17.16720711270558, 16.312941797874096, 17.763272743996943, -2.5347144018307164, 24.9724157828119, 15.724936235175731, 16.986140440051404, 20.795120808805354, 0.926689389337044, 5.749258276046358, 9.064471950668596, 12.202036906912785, -4.734500285393915, 21.048996270984443, 2.6053426036898752, 16.646942309512056, 13.120627596068331, 2.894642440241163, 18.236113124276397, 28.517865944941306, 4.109660940164861, 6.9627801282818975, 7.376586266038048, 27.778790714528967, 25.45712846378347, 6.215860805837874, 5.103959984446436, 39.054919523550964, 4.695010328081458, 0.09605694049747893, 34.75588209871706, 21.82982220877548, 29.846182628603003, 3.185146339242749, 8.27408272677319, 31.398048219712493, -10.741552530476866, 18.454742668644702, 31.85463961085749, 12.471360504573385, 21.20983960155621, 24.639689626545664, 27.856497787714567, 23.06078232444435, 9.211918003191693, 19.53280198268982], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.99374822779813, -11.171860839473403, -6.096955100072941, -16.480063080842733, -37.59973524708703, -21.243696117768614, -14.283633571145437, -15.979742187612635, -3.3198769296252673, -21.459424163444318, -13.137663078743621, 0.145897954488591, -9.017586508926545, -20.28574139619743, -17.473752050907088, -7.419521737488163, 12.065975532980255, -28.421835223222626, -24.172061796085863, -14.383215920492527, -27.709840628107123, 9.425769603152611, -22.03299927144423, -32.51336773682984, -3.6203210261960788, -32.034189872819994, -16.798242374586565, -22.111706893685504, -7.796171984759184, -10.498145680227774, -10.51044606433401, -13.632830379707212, -19.59523394049809, -24.756317102021704, -15.792459504842284, -8.856667541523986, -24.860212702946985, -14.871867849076764, -33.09860038917411, -26.094361079868406, -31.62161838011628, -18.861653599748813, -30.842068591929642, 6.625827220686031, -16.903148955609662, -24.631621383590467, -24.58623590316118, -2.351086277158336, -51.36805889756216, -17.610658201514347, 8.874833516298965, -12.64334835328384, -2.495941752820049, -24.17865976379563, -17.167207112705594, -16.312941797874082, -17.76327274399694, 2.534714401830719, -24.972415782811897, -15.724936235175718, -16.9861404400514, -20.79512080880533, -0.9266893893370449, -5.749258276046357, -9.064471950668576, -12.202036906912802, 4.7345002853939215, -21.048996270984464, -2.6053426036898806, -16.646942309512067, -13.12062759606833, -2.8946424402411592, -18.2361131242764, -28.517865944941324, -4.109660940164872, -6.962780128281907, -7.376586266038085, -27.778790714528967, -25.45712846378347, -6.215860805837876, -5.103959984446427, -39.05491952355099, -4.695010328081445, -0.09605694049747449, -34.755882098717066, -21.829822208775465, -29.84618262860299, -3.1851463392427632, -8.274082726773191, -31.398048219712486, 10.741552530476861, -18.45474266864472, -31.85463961085749, -12.471360504573383, -21.20983960155622, -24.639689626545668, -27.8564977877145, -23.060782324444304, -9.211918003191673, -19.532801982689882], "policy_predator_policy_reward": [19.1675178038708, 34.819978651725464, 8.817043786129714, 13.52667789281709, -4.325516146963741, 16.519426347109576, 23.951040826251862, 9.009085335433694, 32.38121562613069, 42.81825486804337, 14.781642203479912, 27.70575003205733, 7.02935555925577, 21.5379115830351, 23.992024367659738, 7.967460007565508, -12.726382117332562, 19.366135976583116, 33.833031556367104, 9.085816770521582, 18.616611203712388, 7.658714953774849, -18.82168619208355, 18.529890283106383, 11.548400520945528, 6.4867724969075695, 14.740204728908843, 25.83127806348603, 8.136313345348992, 26.81119075646518, 16.116277854838287, -1.277234379861989, -6.4061821480263195, -17.72576891793419, 26.624424576748623, 30.21924586969665, 23.028873615501936, 25.315249976669797, 21.4925626787037, 7.27386916228139, 24.117894694660446, 31.30178656155383, -14.0631175678938, -4.7884216384114175, 24.848505690558383, 19.217492852330075, 45.822574578818646, 19.204160894841095, 5.931981689351435, 1.3086603630407154, 21.74017179427448, 42.32820795136553, 14.36164494265157, 19.234839806521556, 15.907260761317964, 28.316153026053044, 2.614063638270668, 12.978280331247689, 1.7519411211777385, 19.2443502392778, 10.537354687344111, 10.483537441323907, 9.123355361318636, 18.1423053980958, 14.052952320296288, 25.137515560699896, 16.374209183064927, 33.138425020978474, 16.469753597200004, 15.115165412484544, 15.593785230421203, 2.11954985262677, 10.872726101384929, 38.84769930450905, 29.900282630485894, -0.1565469323323363, 31.815631926681412, 34.38156885166679, 28.07057944067129, 24.118142719065425, 18.469178054124267, 44.77405870610828, 12.644528482515526, 25.078778716982093, 32.22775706345386, 29.456380120405488, -4.505978974074047, -8.745675467298035, 25.66504340235988, 8.141254508859433, 7.056593786192522, 42.20664898098841, 34.74098361139813, 14.431488194924196, -7.02565391496714, 11.727826469283805, 50.17783398716999, 52.55828380795427, 15.467600831697673, 19.753715571331018, -4.157732458358683, -13.591934574239248, 4.615590285098332, 20.671106421469386, -15.370108605259716, 20.36199211089983, 23.87514193138893, 24.482177596202327, -1.515829820231934, 35.85024404564311, 17.259596864689506, 15.36628673105866, 31.12889583562831, 4.397649652365587, 5.93135869701824, -11.000787500679671, 37.68976587526206, 12.255065690361752, 13.328768817691218, 18.12110365266023, 20.81935775022575, 13.152923129877042, 18.99057414042946, 22.599667477181207, 2.179789339400049, -0.3264105607259582, 10.584359312229104, 0.91415723986362, 20.528317690679312, -2.3993737893421656, 15.770486513579893, 8.633587300245708, 4.13687670963211, -13.605877280419957, 12.921909589822302, 29.17608295214659, -0.3028524209525507, 5.513537628332301, 9.209838517151393, 24.084046101872737, 9.254668588509848, 16.986586603626805, -0.10941399101466054, 5.898698871496979, 12.341288183840387, 24.130938064712407, 18.58315321256472, 38.45257867731791, -5.414097144857408, 13.633419025187084, 3.4550077707081925, 10.470552485855597, 7.074676405232241, 7.678496126843928, 20.444144522093286, 35.11343690696466, 21.83070034229897, 29.08355658526795, 9.13281418035569, 3.298907431320063, -0.42234690012242915, 10.630266869015296, 23.53109523937763, 54.57874380772435, 12.047604592320482, -2.6575839361575984, -6.920097413931412, 7.1122112949263645, 26.37117225641218, 43.140591941021924, 23.341677886751334, 20.317966530799584, 24.991689700217535, 34.70067555698842, 7.7167255635922345, -1.3464328851066858, -1.0761104354605777, 17.624275889006956, 34.871079583563215, 27.92501685586175, -13.430811029576041, -8.05229403137768, -0.39396013838519384, 37.303445475674636, 24.666351325366843, 39.04292789634813, 5.599298872157341, 19.343422136989425, 14.216939272403257, 28.202739930709157, 10.05948826111807, 39.21989099197326, 20.96604728527825, 34.746948290150776, 30.058475200489966, 16.063089448398635, 9.781808313313105, 8.642027693070252, 11.109187283788884, 27.956416681590866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6242178839927385, "mean_inference_ms": 1.6611207442747444, "mean_action_processing_ms": 0.2568653316197358, "mean_env_wait_ms": 0.1439029119442705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056951045989990234, "StateBufferConnector_ms": 0.00332486629486084, "ViewRequirementAgentConnector_ms": 0.10955297946929932}, "num_episodes": 18, "episode_return_max": 51.36805889756212, "episode_return_min": -12.065975532980245, "episode_return_mean": 15.84236336375919, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.86583694488945, "num_env_steps_trained_throughput_per_sec": 353.86583694488945, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 11256.339, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11256.205, "sample_time_ms": 1435.522, "learn_time_ms": 9796.98, "learn_throughput": 408.289, "synch_weights_time_ms": 22.052}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 136, "trial_id": "06536_00000", "date": "2024-08-11_17-38-54", "timestamp": 1723412334, "time_this_iter_s": 11.338714838027954, "time_total_s": 3874.341269016266, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331792e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3874.341269016266, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 50.2125, "ram_util_percent": 83.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.165788988272349, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0596056286245585, "policy_loss": -0.008497808308068974, "vf_loss": 3.068103201438983, "vf_explained_var": 0.9219506065050761, "kl": 0.009074743412220225, "entropy": 0.40294731203466655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.930196842945442, "cur_kl_coeff": 1.2407709188295412e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7867202283213377, "policy_loss": -0.006476815734748487, "vf_loss": 3.7931970525670935, "vf_explained_var": 0.8929305475224893, "kl": 0.009201835946745777, "entropy": 0.32657857707568577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "env_runners": {"episode_reward_max": 51.36805889756212, "episode_reward_min": -10.741552530476866, "episode_reward_mean": 15.411184120277412, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36805889756216, "predator_policy": -18.365110978470792}, "policy_reward_max": {"prey_policy": 10.741552530476861, "predator_policy": 54.57874380772435}, "policy_reward_mean": {"prey_policy": -15.411184120277412, "predator_policy": 15.411184120277412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.513367736829856, 3.6203210261960734, 32.03418987282001, 16.798242374586565, 22.111706893685522, 7.79617198475918, 10.498145680227768, 10.51044606433397, 13.6328303797072, 19.595233940498098, 24.7563171020217, 15.792459504842284, 8.856667541523999, 24.860212702946995, 14.8718678490768, 33.09860038917411, 26.094361079868328, 31.621618380116267, 18.86165359974881, 30.842068591929728, -6.625827220686034, 16.903148955609637, 24.631621383590467, 24.586235903161153, 2.351086277158341, 51.36805889756212, 17.61065820151435, -8.874833516298974, 12.643348353283837, 2.4959417528200554, 24.178659763795626, 17.16720711270558, 16.312941797874096, 17.763272743996943, -2.5347144018307164, 24.9724157828119, 15.724936235175731, 16.986140440051404, 20.795120808805354, 0.926689389337044, 5.749258276046358, 9.064471950668596, 12.202036906912785, -4.734500285393915, 21.048996270984443, 2.6053426036898752, 16.646942309512056, 13.120627596068331, 2.894642440241163, 18.236113124276397, 28.517865944941306, 4.109660940164861, 6.9627801282818975, 7.376586266038048, 27.778790714528967, 25.45712846378347, 6.215860805837874, 5.103959984446436, 39.054919523550964, 4.695010328081458, 0.09605694049747893, 34.75588209871706, 21.82982220877548, 29.846182628603003, 3.185146339242749, 8.27408272677319, 31.398048219712493, -10.741552530476866, 18.454742668644702, 31.85463961085749, 12.471360504573385, 21.20983960155621, 24.639689626545664, 27.856497787714567, 23.06078232444435, 9.211918003191693, 19.53280198268982, 15.747999255947601, 27.789038861007782, 16.762523506220504, 31.69850159060618, 3.111919864241578, -9.79671911409664, 6.891083937375778, 30.525633211619674, 17.240675188348103, -0.6280456762762228, -10.097170200610734, 28.55305156350007, -2.996581556620473, 27.837114619830352, 0.6264803591301007, -5.371939497359893, 14.150316647428347, 5.15736017644781, 22.318937156521837, 21.744909031777635, 15.24858013424588, 9.763727445065362, 27.649989133335517], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.51336773682984, -3.6203210261960788, -32.034189872819994, -16.798242374586565, -22.111706893685504, -7.796171984759184, -10.498145680227774, -10.51044606433401, -13.632830379707212, -19.59523394049809, -24.756317102021704, -15.792459504842284, -8.856667541523986, -24.860212702946985, -14.871867849076764, -33.09860038917411, -26.094361079868406, -31.62161838011628, -18.861653599748813, -30.842068591929642, 6.625827220686031, -16.903148955609662, -24.631621383590467, -24.58623590316118, -2.351086277158336, -51.36805889756216, -17.610658201514347, 8.874833516298965, -12.64334835328384, -2.495941752820049, -24.17865976379563, -17.167207112705594, -16.312941797874082, -17.76327274399694, 2.534714401830719, -24.972415782811897, -15.724936235175718, -16.9861404400514, -20.79512080880533, -0.9266893893370449, -5.749258276046357, -9.064471950668576, -12.202036906912802, 4.7345002853939215, -21.048996270984464, -2.6053426036898806, -16.646942309512067, -13.12062759606833, -2.8946424402411592, -18.2361131242764, -28.517865944941324, -4.109660940164872, -6.962780128281907, -7.376586266038085, -27.778790714528967, -25.45712846378347, -6.215860805837876, -5.103959984446427, -39.05491952355099, -4.695010328081445, -0.09605694049747449, -34.755882098717066, -21.829822208775465, -29.84618262860299, -3.1851463392427632, -8.274082726773191, -31.398048219712486, 10.741552530476861, -18.45474266864472, -31.85463961085749, -12.471360504573383, -21.20983960155622, -24.639689626545668, -27.8564977877145, -23.060782324444304, -9.211918003191673, -19.532801982689882, -15.747999255947608, -27.789038861007764, -16.76252350622051, -31.698501590606167, -3.111919864241523, 9.796719114096646, -6.89108393737578, -30.525633211619684, -17.24067518834808, 0.6280456762761917, 10.097170200610726, -28.553051563500077, 2.996581556620483, -27.837114619830334, -0.6264803591300883, 5.371939497359895, -14.15031664742836, -5.157360176447803, -22.318937156521827, -21.744909031777638, -15.24858013424585, -9.763727445065406, -27.649989133335552], "policy_predator_policy_reward": [45.822574578818646, 19.204160894841095, 5.931981689351435, 1.3086603630407154, 21.74017179427448, 42.32820795136553, 14.36164494265157, 19.234839806521556, 15.907260761317964, 28.316153026053044, 2.614063638270668, 12.978280331247689, 1.7519411211777385, 19.2443502392778, 10.537354687344111, 10.483537441323907, 9.123355361318636, 18.1423053980958, 14.052952320296288, 25.137515560699896, 16.374209183064927, 33.138425020978474, 16.469753597200004, 15.115165412484544, 15.593785230421203, 2.11954985262677, 10.872726101384929, 38.84769930450905, 29.900282630485894, -0.1565469323323363, 31.815631926681412, 34.38156885166679, 28.07057944067129, 24.118142719065425, 18.469178054124267, 44.77405870610828, 12.644528482515526, 25.078778716982093, 32.22775706345386, 29.456380120405488, -4.505978974074047, -8.745675467298035, 25.66504340235988, 8.141254508859433, 7.056593786192522, 42.20664898098841, 34.74098361139813, 14.431488194924196, -7.02565391496714, 11.727826469283805, 50.17783398716999, 52.55828380795427, 15.467600831697673, 19.753715571331018, -4.157732458358683, -13.591934574239248, 4.615590285098332, 20.671106421469386, -15.370108605259716, 20.36199211089983, 23.87514193138893, 24.482177596202327, -1.515829820231934, 35.85024404564311, 17.259596864689506, 15.36628673105866, 31.12889583562831, 4.397649652365587, 5.93135869701824, -11.000787500679671, 37.68976587526206, 12.255065690361752, 13.328768817691218, 18.12110365266023, 20.81935775022575, 13.152923129877042, 18.99057414042946, 22.599667477181207, 2.179789339400049, -0.3264105607259582, 10.584359312229104, 0.91415723986362, 20.528317690679312, -2.3993737893421656, 15.770486513579893, 8.633587300245708, 4.13687670963211, -13.605877280419957, 12.921909589822302, 29.17608295214659, -0.3028524209525507, 5.513537628332301, 9.209838517151393, 24.084046101872737, 9.254668588509848, 16.986586603626805, -0.10941399101466054, 5.898698871496979, 12.341288183840387, 24.130938064712407, 18.58315321256472, 38.45257867731791, -5.414097144857408, 13.633419025187084, 3.4550077707081925, 10.470552485855597, 7.074676405232241, 7.678496126843928, 20.444144522093286, 35.11343690696466, 21.83070034229897, 29.08355658526795, 9.13281418035569, 3.298907431320063, -0.42234690012242915, 10.630266869015296, 23.53109523937763, 54.57874380772435, 12.047604592320482, -2.6575839361575984, -6.920097413931412, 7.1122112949263645, 26.37117225641218, 43.140591941021924, 23.341677886751334, 20.317966530799584, 24.991689700217535, 34.70067555698842, 7.7167255635922345, -1.3464328851066858, -1.0761104354605777, 17.624275889006956, 34.871079583563215, 27.92501685586175, -13.430811029576041, -8.05229403137768, -0.39396013838519384, 37.303445475674636, 24.666351325366843, 39.04292789634813, 5.599298872157341, 19.343422136989425, 14.216939272403257, 28.202739930709157, 10.05948826111807, 39.21989099197326, 20.96604728527825, 34.746948290150776, 30.058475200489966, 16.063089448398635, 9.781808313313105, 8.642027693070252, 11.109187283788884, 27.956416681590866, 20.331446108862384, 11.164552403032845, 24.20957897588663, 31.368498746128914, 13.805465657053425, 19.7195813553876, 25.16106498278519, 38.235938198427135, 6.181883282516738, 0.04195644596634551, -15.281478238514278, -4.311959989679011, 3.7715894553728564, 10.010578419378698, 32.45793012487597, 28.59333629836341, 6.751832902420652, 27.729517474275568, -10.905965968418677, 9.649874615866267, -18.365110978470792, -1.8292294227506574, 18.138586557023892, 38.96751656997626, -12.249603138488, 6.256440025247025, 18.21305245165503, 37.461176788005666, -3.0011005376931497, 4.2540612559533315, -0.657291782999744, -10.08658721172004, 18.25875026210996, 10.04188303274669, 12.558571709112478, -2.2438513562168794, 20.57079849970475, 24.067075813338896, 27.108367638198366, 16.381450425356935, 3.187657140596965, 27.309503127894754, 15.629453342714925, 3.898001547415845, 21.377967782618672, 33.92201048405251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6243733641081981, "mean_inference_ms": 1.6614326535801178, "mean_action_processing_ms": 0.25687647681169434, "mean_env_wait_ms": 0.1439152823353255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063588619232177734, "StateBufferConnector_ms": 0.003220677375793457, "ViewRequirementAgentConnector_ms": 0.10453939437866211}, "num_episodes": 23, "episode_return_max": 51.36805889756212, "episode_return_min": -10.741552530476866, "episode_return_mean": 15.411184120277412, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.6962821448752, "num_env_steps_trained_throughput_per_sec": 388.6962821448752, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1644000, "timers": {"training_iteration_time_ms": 11221.878, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11221.761, "sample_time_ms": 1414.18, "learn_time_ms": 9785.927, "learn_throughput": 408.75, "synch_weights_time_ms": 20.163}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "done": false, "training_iteration": 137, "trial_id": "06536_00000", "date": "2024-08-11_17-39-04", "timestamp": 1723412344, "time_this_iter_s": 10.337643146514893, "time_total_s": 3884.6789121627808, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58859d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3884.6789121627808, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 45.76428571428573, "ram_util_percent": 82.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.045975844313701, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0418505519628525, "policy_loss": -0.010174268832876502, "vf_loss": 3.0520246222615244, "vf_explained_var": 0.9021875269711017, "kl": 0.007185646845818875, "entropy": 0.3959606343880296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.74112275277496, "cur_kl_coeff": 1.2407709188295412e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3946652725260096, "policy_loss": -0.002716304980854075, "vf_loss": 3.3973815808220515, "vf_explained_var": 0.8824037280032244, "kl": 0.005726772672651684, "entropy": 0.3188310200259799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "env_runners": {"episode_reward_max": 51.36805889756212, "episode_reward_min": -17.289790404482094, "episode_reward_mean": 13.920769459367907, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.36805889756216, "predator_policy": -21.912320289472127}, "policy_reward_max": {"prey_policy": 17.28979040448209, "predator_policy": 54.57874380772435}, "policy_reward_mean": {"prey_policy": -13.920769459367907, "predator_policy": 13.920769459367905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.631621383590467, 24.586235903161153, 2.351086277158341, 51.36805889756212, 17.61065820151435, -8.874833516298974, 12.643348353283837, 2.4959417528200554, 24.178659763795626, 17.16720711270558, 16.312941797874096, 17.763272743996943, -2.5347144018307164, 24.9724157828119, 15.724936235175731, 16.986140440051404, 20.795120808805354, 0.926689389337044, 5.749258276046358, 9.064471950668596, 12.202036906912785, -4.734500285393915, 21.048996270984443, 2.6053426036898752, 16.646942309512056, 13.120627596068331, 2.894642440241163, 18.236113124276397, 28.517865944941306, 4.109660940164861, 6.9627801282818975, 7.376586266038048, 27.778790714528967, 25.45712846378347, 6.215860805837874, 5.103959984446436, 39.054919523550964, 4.695010328081458, 0.09605694049747893, 34.75588209871706, 21.82982220877548, 29.846182628603003, 3.185146339242749, 8.27408272677319, 31.398048219712493, -10.741552530476866, 18.454742668644702, 31.85463961085749, 12.471360504573385, 21.20983960155621, 24.639689626545664, 27.856497787714567, 23.06078232444435, 9.211918003191693, 19.53280198268982, 15.747999255947601, 27.789038861007782, 16.762523506220504, 31.69850159060618, 3.111919864241578, -9.79671911409664, 6.891083937375778, 30.525633211619674, 17.240675188348103, -0.6280456762762228, -10.097170200610734, 28.55305156350007, -2.996581556620473, 27.837114619830352, 0.6264803591301007, -5.371939497359893, 14.150316647428347, 5.15736017644781, 22.318937156521837, 21.744909031777635, 15.24858013424588, 9.763727445065362, 27.649989133335517, -5.830804963625901, 12.747528223495427, 23.61192681718908, -17.289790404482094, 11.757820601178498, 19.854154962687993, -4.798523366779325, 2.202660524927431, 20.601580418512313, 20.74433321872539, 10.009091064635477, 29.562125628521617, 10.056511807187295, 21.793140609011527, 7.059503751874486, 15.674946265472457, 13.37842527340032, 27.3329193434311, 18.581046880571847, -7.828203466514255, 8.447677124218405, 22.334268025227097], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.631621383590467, -24.58623590316118, -2.351086277158336, -51.36805889756216, -17.610658201514347, 8.874833516298965, -12.64334835328384, -2.495941752820049, -24.17865976379563, -17.167207112705594, -16.312941797874082, -17.76327274399694, 2.534714401830719, -24.972415782811897, -15.724936235175718, -16.9861404400514, -20.79512080880533, -0.9266893893370449, -5.749258276046357, -9.064471950668576, -12.202036906912802, 4.7345002853939215, -21.048996270984464, -2.6053426036898806, -16.646942309512067, -13.12062759606833, -2.8946424402411592, -18.2361131242764, -28.517865944941324, -4.109660940164872, -6.962780128281907, -7.376586266038085, -27.778790714528967, -25.45712846378347, -6.215860805837876, -5.103959984446427, -39.05491952355099, -4.695010328081445, -0.09605694049747449, -34.755882098717066, -21.829822208775465, -29.84618262860299, -3.1851463392427632, -8.274082726773191, -31.398048219712486, 10.741552530476861, -18.45474266864472, -31.85463961085749, -12.471360504573383, -21.20983960155622, -24.639689626545668, -27.8564977877145, -23.060782324444304, -9.211918003191673, -19.532801982689882, -15.747999255947608, -27.789038861007764, -16.76252350622051, -31.698501590606167, -3.111919864241523, 9.796719114096646, -6.89108393737578, -30.525633211619684, -17.24067518834808, 0.6280456762761917, 10.097170200610726, -28.553051563500077, 2.996581556620483, -27.837114619830334, -0.6264803591300883, 5.371939497359895, -14.15031664742836, -5.157360176447803, -22.318937156521827, -21.744909031777638, -15.24858013424585, -9.763727445065406, -27.649989133335552, 5.830804963625916, -12.747528223495433, -23.611926817189033, 17.28979040448209, -11.757820601178494, -19.854154962687982, 4.798523366779312, -2.202660524927429, -20.60158041851232, -20.744333218725387, -10.009091064635486, -29.562125628521613, -10.056511807187292, -21.793140609011562, -7.059503751874499, -15.674946265472453, -13.378425273400303, -27.332919343431097, -18.581046880571805, 7.82820346651426, -8.447677124218407, -22.334268025227093], "policy_predator_policy_reward": [7.056593786192522, 42.20664898098841, 34.74098361139813, 14.431488194924196, -7.02565391496714, 11.727826469283805, 50.17783398716999, 52.55828380795427, 15.467600831697673, 19.753715571331018, -4.157732458358683, -13.591934574239248, 4.615590285098332, 20.671106421469386, -15.370108605259716, 20.36199211089983, 23.87514193138893, 24.482177596202327, -1.515829820231934, 35.85024404564311, 17.259596864689506, 15.36628673105866, 31.12889583562831, 4.397649652365587, 5.93135869701824, -11.000787500679671, 37.68976587526206, 12.255065690361752, 13.328768817691218, 18.12110365266023, 20.81935775022575, 13.152923129877042, 18.99057414042946, 22.599667477181207, 2.179789339400049, -0.3264105607259582, 10.584359312229104, 0.91415723986362, 20.528317690679312, -2.3993737893421656, 15.770486513579893, 8.633587300245708, 4.13687670963211, -13.605877280419957, 12.921909589822302, 29.17608295214659, -0.3028524209525507, 5.513537628332301, 9.209838517151393, 24.084046101872737, 9.254668588509848, 16.986586603626805, -0.10941399101466054, 5.898698871496979, 12.341288183840387, 24.130938064712407, 18.58315321256472, 38.45257867731791, -5.414097144857408, 13.633419025187084, 3.4550077707081925, 10.470552485855597, 7.074676405232241, 7.678496126843928, 20.444144522093286, 35.11343690696466, 21.83070034229897, 29.08355658526795, 9.13281418035569, 3.298907431320063, -0.42234690012242915, 10.630266869015296, 23.53109523937763, 54.57874380772435, 12.047604592320482, -2.6575839361575984, -6.920097413931412, 7.1122112949263645, 26.37117225641218, 43.140591941021924, 23.341677886751334, 20.317966530799584, 24.991689700217535, 34.70067555698842, 7.7167255635922345, -1.3464328851066858, -1.0761104354605777, 17.624275889006956, 34.871079583563215, 27.92501685586175, -13.430811029576041, -8.05229403137768, -0.39396013838519384, 37.303445475674636, 24.666351325366843, 39.04292789634813, 5.599298872157341, 19.343422136989425, 14.216939272403257, 28.202739930709157, 10.05948826111807, 39.21989099197326, 20.96604728527825, 34.746948290150776, 30.058475200489966, 16.063089448398635, 9.781808313313105, 8.642027693070252, 11.109187283788884, 27.956416681590866, 20.331446108862384, 11.164552403032845, 24.20957897588663, 31.368498746128914, 13.805465657053425, 19.7195813553876, 25.16106498278519, 38.235938198427135, 6.181883282516738, 0.04195644596634551, -15.281478238514278, -4.311959989679011, 3.7715894553728564, 10.010578419378698, 32.45793012487597, 28.59333629836341, 6.751832902420652, 27.729517474275568, -10.905965968418677, 9.649874615866267, -18.365110978470792, -1.8292294227506574, 18.138586557023892, 38.96751656997626, -12.249603138488, 6.256440025247025, 18.21305245165503, 37.461176788005666, -3.0011005376931497, 4.2540612559533315, -0.657291782999744, -10.08658721172004, 18.25875026210996, 10.04188303274669, 12.558571709112478, -2.2438513562168794, 20.57079849970475, 24.067075813338896, 27.108367638198366, 16.381450425356935, 3.187657140596965, 27.309503127894754, 15.629453342714925, 3.898001547415845, 21.377967782618672, 33.92201048405251, 1.844404452345092, -13.506014379596913, 10.69974844475999, 14.795308002230875, 10.16311471468868, 37.060738919689385, -12.667260519492045, -21.912320289472127, 10.209317445908505, 13.306323756448485, 26.296840334948, 13.411469590427954, -2.7940261855415116, -6.803020548017109, -5.0680969704110534, 9.473418020265907, 21.44027549368797, 19.76288534333667, 26.198674586136836, 15.289991851313907, 14.134341931122343, 5.883840198148624, 22.558638742683446, 36.565612514359756, 10.676527631437764, 9.43649598293683, 9.428845640346927, 34.15743557767618, 10.063454053466751, 4.055553450282249, 30.195720362580275, 1.154172168364635, -3.0694314959908118, 29.826282042791426, 37.03194745599602, 17.633891230866187, 9.87017785258313, 27.291915908560544, -8.001725505435246, -7.654681427593271, 11.358044054791819, 5.537310193644995, 27.581071678721514, 17.08746437173272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6248047712614233, "mean_inference_ms": 1.661845359241641, "mean_action_processing_ms": 0.25691752777590227, "mean_env_wait_ms": 0.1440442628802186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007587552070617676, "StateBufferConnector_ms": 0.0032427310943603516, "ViewRequirementAgentConnector_ms": 0.11602449417114258}, "num_episodes": 22, "episode_return_max": 51.36805889756212, "episode_return_min": -17.289790404482094, "episode_return_mean": 13.920769459367907, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.83577651737244, "num_env_steps_trained_throughput_per_sec": 368.83577651737244, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1656000, "timers": {"training_iteration_time_ms": 11230.624, "restore_workers_time_ms": 0.023, "training_step_time_ms": 11230.461, "sample_time_ms": 1461.679, "learn_time_ms": 9745.456, "learn_throughput": 410.448, "synch_weights_time_ms": 21.596}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "done": false, "training_iteration": 138, "trial_id": "06536_00000", "date": "2024-08-11_17-39-15", "timestamp": 1723412355, "time_this_iter_s": 10.886414766311646, "time_total_s": 3895.5653269290924, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58e5f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3895.5653269290924, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 50.45625, "ram_util_percent": 83.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.25044509395957, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0677305993934474, "policy_loss": -0.00600600893618927, "vf_loss": 3.073736402516564, "vf_explained_var": 0.9068733302255472, "kl": 0.006957452152301377, "entropy": 0.4016410557863613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.90280674412137, "cur_kl_coeff": 1.2407709188295412e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7559502750477463, "policy_loss": -0.0029805258304501574, "vf_loss": 3.758930802345276, "vf_explained_var": 0.8607229332444529, "kl": 0.007674936725384527, "entropy": 0.28889364301369935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "env_runners": {"episode_reward_max": 41.27439783227218, "episode_reward_min": -17.289790404482094, "episode_reward_mean": 14.116569824679583, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.27439783227221, "predator_policy": -21.912320289472127}, "policy_reward_max": {"prey_policy": 17.28979040448209, "predator_policy": 54.57874380772435}, "policy_reward_mean": {"prey_policy": -14.116569824679583, "predator_policy": 14.116569824679587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.749258276046358, 9.064471950668596, 12.202036906912785, -4.734500285393915, 21.048996270984443, 2.6053426036898752, 16.646942309512056, 13.120627596068331, 2.894642440241163, 18.236113124276397, 28.517865944941306, 4.109660940164861, 6.9627801282818975, 7.376586266038048, 27.778790714528967, 25.45712846378347, 6.215860805837874, 5.103959984446436, 39.054919523550964, 4.695010328081458, 0.09605694049747893, 34.75588209871706, 21.82982220877548, 29.846182628603003, 3.185146339242749, 8.27408272677319, 31.398048219712493, -10.741552530476866, 18.454742668644702, 31.85463961085749, 12.471360504573385, 21.20983960155621, 24.639689626545664, 27.856497787714567, 23.06078232444435, 9.211918003191693, 19.53280198268982, 15.747999255947601, 27.789038861007782, 16.762523506220504, 31.69850159060618, 3.111919864241578, -9.79671911409664, 6.891083937375778, 30.525633211619674, 17.240675188348103, -0.6280456762762228, -10.097170200610734, 28.55305156350007, -2.996581556620473, 27.837114619830352, 0.6264803591301007, -5.371939497359893, 14.150316647428347, 5.15736017644781, 22.318937156521837, 21.744909031777635, 15.24858013424588, 9.763727445065362, 27.649989133335517, -5.830804963625901, 12.747528223495427, 23.61192681718908, -17.289790404482094, 11.757820601178498, 19.854154962687993, -4.798523366779325, 2.202660524927431, 20.601580418512313, 20.74433321872539, 10.009091064635477, 29.562125628521617, 10.056511807187295, 21.793140609011527, 7.059503751874486, 15.674946265472457, 13.37842527340032, 27.3329193434311, 18.581046880571847, -7.828203466514255, 8.447677124218405, 22.334268025227097, 16.059855800007085, 9.63080190183897, 41.27439783227218, 9.342187006702787, 10.24680555260113, 32.98778125570965, 5.654775055591073, 18.047897814958304, 0.0460988494552943, 25.94895423556434, 6.946701006592758, -0.00363535151159855, 19.463714458845608, 10.809224701924755, 11.880982016063683, 26.368741065419506, 35.45888013466725, 18.52066011997981], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.749258276046357, -9.064471950668576, -12.202036906912802, 4.7345002853939215, -21.048996270984464, -2.6053426036898806, -16.646942309512067, -13.12062759606833, -2.8946424402411592, -18.2361131242764, -28.517865944941324, -4.109660940164872, -6.962780128281907, -7.376586266038085, -27.778790714528967, -25.45712846378347, -6.215860805837876, -5.103959984446427, -39.05491952355099, -4.695010328081445, -0.09605694049747449, -34.755882098717066, -21.829822208775465, -29.84618262860299, -3.1851463392427632, -8.274082726773191, -31.398048219712486, 10.741552530476861, -18.45474266864472, -31.85463961085749, -12.471360504573383, -21.20983960155622, -24.639689626545668, -27.8564977877145, -23.060782324444304, -9.211918003191673, -19.532801982689882, -15.747999255947608, -27.789038861007764, -16.76252350622051, -31.698501590606167, -3.111919864241523, 9.796719114096646, -6.89108393737578, -30.525633211619684, -17.24067518834808, 0.6280456762761917, 10.097170200610726, -28.553051563500077, 2.996581556620483, -27.837114619830334, -0.6264803591300883, 5.371939497359895, -14.15031664742836, -5.157360176447803, -22.318937156521827, -21.744909031777638, -15.24858013424585, -9.763727445065406, -27.649989133335552, 5.830804963625916, -12.747528223495433, -23.611926817189033, 17.28979040448209, -11.757820601178494, -19.854154962687982, 4.798523366779312, -2.202660524927429, -20.60158041851232, -20.744333218725387, -10.009091064635486, -29.562125628521613, -10.056511807187292, -21.793140609011562, -7.059503751874499, -15.674946265472453, -13.378425273400303, -27.332919343431097, -18.581046880571805, 7.82820346651426, -8.447677124218407, -22.334268025227093, -16.059855800007085, -9.630801901838975, -41.27439783227221, -9.342187006702767, -10.24680555260112, -32.987781255709585, -5.654775055591009, -18.047897814958276, -0.046098849455326274, -25.948954235564326, -6.946701006592751, 0.0036353515115745694, -19.463714458845608, -10.809224701924757, -11.880982016063673, -26.368741065419517, -35.45888013466723, -18.520660119979805], "policy_predator_policy_reward": [10.584359312229104, 0.91415723986362, 20.528317690679312, -2.3993737893421656, 15.770486513579893, 8.633587300245708, 4.13687670963211, -13.605877280419957, 12.921909589822302, 29.17608295214659, -0.3028524209525507, 5.513537628332301, 9.209838517151393, 24.084046101872737, 9.254668588509848, 16.986586603626805, -0.10941399101466054, 5.898698871496979, 12.341288183840387, 24.130938064712407, 18.58315321256472, 38.45257867731791, -5.414097144857408, 13.633419025187084, 3.4550077707081925, 10.470552485855597, 7.074676405232241, 7.678496126843928, 20.444144522093286, 35.11343690696466, 21.83070034229897, 29.08355658526795, 9.13281418035569, 3.298907431320063, -0.42234690012242915, 10.630266869015296, 23.53109523937763, 54.57874380772435, 12.047604592320482, -2.6575839361575984, -6.920097413931412, 7.1122112949263645, 26.37117225641218, 43.140591941021924, 23.341677886751334, 20.317966530799584, 24.991689700217535, 34.70067555698842, 7.7167255635922345, -1.3464328851066858, -1.0761104354605777, 17.624275889006956, 34.871079583563215, 27.92501685586175, -13.430811029576041, -8.05229403137768, -0.39396013838519384, 37.303445475674636, 24.666351325366843, 39.04292789634813, 5.599298872157341, 19.343422136989425, 14.216939272403257, 28.202739930709157, 10.05948826111807, 39.21989099197326, 20.96604728527825, 34.746948290150776, 30.058475200489966, 16.063089448398635, 9.781808313313105, 8.642027693070252, 11.109187283788884, 27.956416681590866, 20.331446108862384, 11.164552403032845, 24.20957897588663, 31.368498746128914, 13.805465657053425, 19.7195813553876, 25.16106498278519, 38.235938198427135, 6.181883282516738, 0.04195644596634551, -15.281478238514278, -4.311959989679011, 3.7715894553728564, 10.010578419378698, 32.45793012487597, 28.59333629836341, 6.751832902420652, 27.729517474275568, -10.905965968418677, 9.649874615866267, -18.365110978470792, -1.8292294227506574, 18.138586557023892, 38.96751656997626, -12.249603138488, 6.256440025247025, 18.21305245165503, 37.461176788005666, -3.0011005376931497, 4.2540612559533315, -0.657291782999744, -10.08658721172004, 18.25875026210996, 10.04188303274669, 12.558571709112478, -2.2438513562168794, 20.57079849970475, 24.067075813338896, 27.108367638198366, 16.381450425356935, 3.187657140596965, 27.309503127894754, 15.629453342714925, 3.898001547415845, 21.377967782618672, 33.92201048405251, 1.844404452345092, -13.506014379596913, 10.69974844475999, 14.795308002230875, 10.16311471468868, 37.060738919689385, -12.667260519492045, -21.912320289472127, 10.209317445908505, 13.306323756448485, 26.296840334948, 13.411469590427954, -2.7940261855415116, -6.803020548017109, -5.0680969704110534, 9.473418020265907, 21.44027549368797, 19.76288534333667, 26.198674586136836, 15.289991851313907, 14.134341931122343, 5.883840198148624, 22.558638742683446, 36.565612514359756, 10.676527631437764, 9.43649598293683, 9.428845640346927, 34.15743557767618, 10.063454053466751, 4.055553450282249, 30.195720362580275, 1.154172168364635, -3.0694314959908118, 29.826282042791426, 37.03194745599602, 17.633891230866187, 9.87017785258313, 27.291915908560544, -8.001725505435246, -7.654681427593271, 11.358044054791819, 5.537310193644995, 27.581071678721514, 17.08746437173272, 2.3792849227358754, 29.7404266772783, 5.373421432625928, 13.888182371052002, 34.44688304283681, 48.10191262170761, 8.29248717322901, 10.39188684017655, 13.857966814880653, 6.635644290321622, 24.296257383153076, 41.67930512826613, -1.375665240054908, 12.68521535123693, 36.043491526743885, 0.05230410317265566, 1.9099289270824862, -1.8177312281718425, 20.1370438480789, 31.760864623049727, 9.802935291497196, 4.090466721688305, -11.32725744793259, 11.319986744909428, 21.532154234412722, 17.39527468327849, 6.355286464566911, 15.263162939282601, 14.512551480094789, 9.249412552032554, 23.980582197669964, 28.75689993316906, 35.00739999204038, 35.91036027729412, 26.171195299410215, 10.870124940549418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6252494814529075, "mean_inference_ms": 1.6643015884469685, "mean_action_processing_ms": 0.2572127363549281, "mean_env_wait_ms": 0.14420851543094249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007119417190551758, "StateBufferConnector_ms": 0.003065824508666992, "ViewRequirementAgentConnector_ms": 0.10736441612243652}, "num_episodes": 18, "episode_return_max": 41.27439783227218, "episode_return_min": -17.289790404482094, "episode_return_mean": 14.116569824679583, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.7471285065063, "num_env_steps_trained_throughput_per_sec": 375.7471285065063, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1668000, "timers": {"training_iteration_time_ms": 10943.126, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10942.96, "sample_time_ms": 1497.76, "learn_time_ms": 9420.818, "learn_throughput": 424.592, "synch_weights_time_ms": 22.531}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "done": false, "training_iteration": 139, "trial_id": "06536_00000", "date": "2024-08-11_17-39-26", "timestamp": 1723412366, "time_this_iter_s": 10.662032127380371, "time_total_s": 3906.227359056473, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5885700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3906.227359056473, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 46.89333333333334, "ram_util_percent": 82.72666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.78620652196308, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3304843485355375, "policy_loss": -0.003926201315092233, "vf_loss": 2.3344104730834565, "vf_explained_var": 0.937810137681663, "kl": 0.00417935679592798, "entropy": 0.3712185063709815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8402579691674976, "cur_kl_coeff": 1.2407709188295412e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.080164536155721, "policy_loss": -0.0024887620816352192, "vf_loss": 3.0826532950476992, "vf_explained_var": 0.9155223781469638, "kl": 0.004504556062428005, "entropy": 0.27820036922970776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 41.27439783227218, "episode_reward_min": -17.289790404482094, "episode_reward_mean": 13.904754113112697, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.27439783227221, "predator_policy": -21.912320289472127}, "policy_reward_max": {"prey_policy": 17.28979040448209, "predator_policy": 54.57874380772435}, "policy_reward_mean": {"prey_policy": -13.904754113112693, "predator_policy": 13.904754113112693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.054919523550964, 4.695010328081458, 0.09605694049747893, 34.75588209871706, 21.82982220877548, 29.846182628603003, 3.185146339242749, 8.27408272677319, 31.398048219712493, -10.741552530476866, 18.454742668644702, 31.85463961085749, 12.471360504573385, 21.20983960155621, 24.639689626545664, 27.856497787714567, 23.06078232444435, 9.211918003191693, 19.53280198268982, 15.747999255947601, 27.789038861007782, 16.762523506220504, 31.69850159060618, 3.111919864241578, -9.79671911409664, 6.891083937375778, 30.525633211619674, 17.240675188348103, -0.6280456762762228, -10.097170200610734, 28.55305156350007, -2.996581556620473, 27.837114619830352, 0.6264803591301007, -5.371939497359893, 14.150316647428347, 5.15736017644781, 22.318937156521837, 21.744909031777635, 15.24858013424588, 9.763727445065362, 27.649989133335517, -5.830804963625901, 12.747528223495427, 23.61192681718908, -17.289790404482094, 11.757820601178498, 19.854154962687993, -4.798523366779325, 2.202660524927431, 20.601580418512313, 20.74433321872539, 10.009091064635477, 29.562125628521617, 10.056511807187295, 21.793140609011527, 7.059503751874486, 15.674946265472457, 13.37842527340032, 27.3329193434311, 18.581046880571847, -7.828203466514255, 8.447677124218405, 22.334268025227097, 16.059855800007085, 9.63080190183897, 41.27439783227218, 9.342187006702787, 10.24680555260113, 32.98778125570965, 5.654775055591073, 18.047897814958304, 0.0460988494552943, 25.94895423556434, 6.946701006592758, -0.00363535151159855, 19.463714458845608, 10.809224701924755, 11.880982016063683, 26.368741065419506, 35.45888013466725, 18.52066011997981, -0.3885665626617456, 14.917087795169481, 22.387863032143628, 18.539919674482697, 22.186717676105122, 12.62511428926168, 28.426277265058246, 11.142954652593534, 3.602860500986968, -0.5548523474673015, -8.913858617943822, 1.7366277429593584, 9.315311275593315, 30.479738619242113, 16.690139469849044, -4.262956552755677, 5.968239180662951, 3.276376191060013], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.05491952355099, -4.695010328081445, -0.09605694049747449, -34.755882098717066, -21.829822208775465, -29.84618262860299, -3.1851463392427632, -8.274082726773191, -31.398048219712486, 10.741552530476861, -18.45474266864472, -31.85463961085749, -12.471360504573383, -21.20983960155622, -24.639689626545668, -27.8564977877145, -23.060782324444304, -9.211918003191673, -19.532801982689882, -15.747999255947608, -27.789038861007764, -16.76252350622051, -31.698501590606167, -3.111919864241523, 9.796719114096646, -6.89108393737578, -30.525633211619684, -17.24067518834808, 0.6280456762761917, 10.097170200610726, -28.553051563500077, 2.996581556620483, -27.837114619830334, -0.6264803591300883, 5.371939497359895, -14.15031664742836, -5.157360176447803, -22.318937156521827, -21.744909031777638, -15.24858013424585, -9.763727445065406, -27.649989133335552, 5.830804963625916, -12.747528223495433, -23.611926817189033, 17.28979040448209, -11.757820601178494, -19.854154962687982, 4.798523366779312, -2.202660524927429, -20.60158041851232, -20.744333218725387, -10.009091064635486, -29.562125628521613, -10.056511807187292, -21.793140609011562, -7.059503751874499, -15.674946265472453, -13.378425273400303, -27.332919343431097, -18.581046880571805, 7.82820346651426, -8.447677124218407, -22.334268025227093, -16.059855800007085, -9.630801901838975, -41.27439783227221, -9.342187006702767, -10.24680555260112, -32.987781255709585, -5.654775055591009, -18.047897814958276, -0.046098849455326274, -25.948954235564326, -6.946701006592751, 0.0036353515115745694, -19.463714458845608, -10.809224701924757, -11.880982016063673, -26.368741065419517, -35.45888013466723, -18.520660119979805, 0.38856656266173495, -14.917087795169468, -22.38786303214363, -18.539919674482697, -22.18671767610519, -12.625114289261662, -28.426277265058253, -11.142954652593527, -3.6028605009869556, 0.5548523474673055, 8.913858617943797, -1.736627742959346, -9.315311275593313, -30.47973861924214, -16.690139469849047, 4.26295655275569, -5.96823918066295, -3.276376191060036], "policy_predator_policy_reward": [23.53109523937763, 54.57874380772435, 12.047604592320482, -2.6575839361575984, -6.920097413931412, 7.1122112949263645, 26.37117225641218, 43.140591941021924, 23.341677886751334, 20.317966530799584, 24.991689700217535, 34.70067555698842, 7.7167255635922345, -1.3464328851066858, -1.0761104354605777, 17.624275889006956, 34.871079583563215, 27.92501685586175, -13.430811029576041, -8.05229403137768, -0.39396013838519384, 37.303445475674636, 24.666351325366843, 39.04292789634813, 5.599298872157341, 19.343422136989425, 14.216939272403257, 28.202739930709157, 10.05948826111807, 39.21989099197326, 20.96604728527825, 34.746948290150776, 30.058475200489966, 16.063089448398635, 9.781808313313105, 8.642027693070252, 11.109187283788884, 27.956416681590866, 20.331446108862384, 11.164552403032845, 24.20957897588663, 31.368498746128914, 13.805465657053425, 19.7195813553876, 25.16106498278519, 38.235938198427135, 6.181883282516738, 0.04195644596634551, -15.281478238514278, -4.311959989679011, 3.7715894553728564, 10.010578419378698, 32.45793012487597, 28.59333629836341, 6.751832902420652, 27.729517474275568, -10.905965968418677, 9.649874615866267, -18.365110978470792, -1.8292294227506574, 18.138586557023892, 38.96751656997626, -12.249603138488, 6.256440025247025, 18.21305245165503, 37.461176788005666, -3.0011005376931497, 4.2540612559533315, -0.657291782999744, -10.08658721172004, 18.25875026210996, 10.04188303274669, 12.558571709112478, -2.2438513562168794, 20.57079849970475, 24.067075813338896, 27.108367638198366, 16.381450425356935, 3.187657140596965, 27.309503127894754, 15.629453342714925, 3.898001547415845, 21.377967782618672, 33.92201048405251, 1.844404452345092, -13.506014379596913, 10.69974844475999, 14.795308002230875, 10.16311471468868, 37.060738919689385, -12.667260519492045, -21.912320289472127, 10.209317445908505, 13.306323756448485, 26.296840334948, 13.411469590427954, -2.7940261855415116, -6.803020548017109, -5.0680969704110534, 9.473418020265907, 21.44027549368797, 19.76288534333667, 26.198674586136836, 15.289991851313907, 14.134341931122343, 5.883840198148624, 22.558638742683446, 36.565612514359756, 10.676527631437764, 9.43649598293683, 9.428845640346927, 34.15743557767618, 10.063454053466751, 4.055553450282249, 30.195720362580275, 1.154172168364635, -3.0694314959908118, 29.826282042791426, 37.03194745599602, 17.633891230866187, 9.87017785258313, 27.291915908560544, -8.001725505435246, -7.654681427593271, 11.358044054791819, 5.537310193644995, 27.581071678721514, 17.08746437173272, 2.3792849227358754, 29.7404266772783, 5.373421432625928, 13.888182371052002, 34.44688304283681, 48.10191262170761, 8.29248717322901, 10.39188684017655, 13.857966814880653, 6.635644290321622, 24.296257383153076, 41.67930512826613, -1.375665240054908, 12.68521535123693, 36.043491526743885, 0.05230410317265566, 1.9099289270824862, -1.8177312281718425, 20.1370438480789, 31.760864623049727, 9.802935291497196, 4.090466721688305, -11.32725744793259, 11.319986744909428, 21.532154234412722, 17.39527468327849, 6.355286464566911, 15.263162939282601, 14.512551480094789, 9.249412552032554, 23.980582197669964, 28.75689993316906, 35.00739999204038, 35.91036027729412, 26.171195299410215, 10.870124940549418, -3.1786953255125923, 2.4015622001891046, 29.539845816961126, 0.29432977337781807, 34.436876463815864, 10.338849600471399, 7.643764662627476, 29.436074686337918, 19.59747523121716, 24.775960120993144, 23.495895147483573, 1.7543334310397887, 23.005500212449515, 33.84705431766699, 19.116152037015475, 3.1697572681715727, 17.053443896010528, -9.847722894036592, -5.085178353032887, 3.9754736580982613, 1.6731627733196177, -19.500880009207197, -2.9322022410898363, 6.40545772700856, 15.093453278640874, 3.537169272545757, 24.498967531719693, 36.46050970676456, 22.348120340677163, 11.032158599020951, -2.1637795683609795, -6.362133537150386, 1.1293181792157319, 10.80716018211017, -6.812131373540353, 13.36488375566042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6255094966274138, "mean_inference_ms": 1.6647643017158158, "mean_action_processing_ms": 0.2572493921980859, "mean_env_wait_ms": 0.14431191662633217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006905198097229004, "StateBufferConnector_ms": 0.0029071569442749023, "ViewRequirementAgentConnector_ms": 0.10249757766723633}, "num_episodes": 18, "episode_return_max": 41.27439783227218, "episode_return_min": -17.289790404482094, "episode_return_mean": 13.904754113112697, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.3749880955791, "num_env_steps_trained_throughput_per_sec": 364.3749880955791, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 10852.764, "restore_workers_time_ms": 0.024, "training_step_time_ms": 10852.59, "sample_time_ms": 1427.765, "learn_time_ms": 9401.289, "learn_throughput": 425.474, "synch_weights_time_ms": 21.639}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 140, "trial_id": "06536_00000", "date": "2024-08-11_17-39-37", "timestamp": 1723412377, "time_this_iter_s": 11.03093409538269, "time_total_s": 3917.2582931518555, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331699670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3917.2582931518555, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 53.266666666666666, "ram_util_percent": 82.69333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.066921372835835, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.175338952119152, "policy_loss": -0.003270765515238357, "vf_loss": 3.1786097204933563, "vf_explained_var": 0.8927343796938658, "kl": 0.004864064823778981, "entropy": 0.3893916269764304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.090493822097779, "cur_kl_coeff": 6.203854594147706e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.129296647430097, "policy_loss": -0.0022576749066097867, "vf_loss": 3.1315543222679665, "vf_explained_var": 0.9093757036501768, "kl": 0.0037297632650836942, "entropy": 0.24943273408072336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "env_runners": {"episode_reward_max": 41.27439783227218, "episode_reward_min": -17.289790404482094, "episode_reward_mean": 11.77748968208625, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.27439783227221, "predator_policy": -21.912320289472127}, "policy_reward_max": {"prey_policy": 17.28979040448209, "predator_policy": 48.10191262170761}, "policy_reward_mean": {"prey_policy": -11.777489682086248, "predator_policy": 11.777489682086252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.111919864241578, -9.79671911409664, 6.891083937375778, 30.525633211619674, 17.240675188348103, -0.6280456762762228, -10.097170200610734, 28.55305156350007, -2.996581556620473, 27.837114619830352, 0.6264803591301007, -5.371939497359893, 14.150316647428347, 5.15736017644781, 22.318937156521837, 21.744909031777635, 15.24858013424588, 9.763727445065362, 27.649989133335517, -5.830804963625901, 12.747528223495427, 23.61192681718908, -17.289790404482094, 11.757820601178498, 19.854154962687993, -4.798523366779325, 2.202660524927431, 20.601580418512313, 20.74433321872539, 10.009091064635477, 29.562125628521617, 10.056511807187295, 21.793140609011527, 7.059503751874486, 15.674946265472457, 13.37842527340032, 27.3329193434311, 18.581046880571847, -7.828203466514255, 8.447677124218405, 22.334268025227097, 16.059855800007085, 9.63080190183897, 41.27439783227218, 9.342187006702787, 10.24680555260113, 32.98778125570965, 5.654775055591073, 18.047897814958304, 0.0460988494552943, 25.94895423556434, 6.946701006592758, -0.00363535151159855, 19.463714458845608, 10.809224701924755, 11.880982016063683, 26.368741065419506, 35.45888013466725, 18.52066011997981, -0.3885665626617456, 14.917087795169481, 22.387863032143628, 18.539919674482697, 22.186717676105122, 12.62511428926168, 28.426277265058246, 11.142954652593534, 3.602860500986968, -0.5548523474673015, -8.913858617943822, 1.7366277429593584, 9.315311275593315, 30.479738619242113, 16.690139469849044, -4.262956552755677, 5.968239180662951, 3.276376191060013, 14.540002737531527, 14.818724917343916, 25.92796537133329, 4.694895339573837, 3.108917070742411, -6.140569804302637, -5.39744681750584, 1.0525867525774544, 20.221374563921696, -0.28381962307382036, -1.0348306103278455, 5.8369097595578685, 15.101139797863596, 17.31148515872806, 9.642738261456868, 10.555219794302063, 23.775469977986294, 29.78949958823387, 5.044186740240957, 19.755423359573058, 14.93478404307333, 6.0954592774840854, 0.607375048518624], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.111919864241523, 9.796719114096646, -6.89108393737578, -30.525633211619684, -17.24067518834808, 0.6280456762761917, 10.097170200610726, -28.553051563500077, 2.996581556620483, -27.837114619830334, -0.6264803591300883, 5.371939497359895, -14.15031664742836, -5.157360176447803, -22.318937156521827, -21.744909031777638, -15.24858013424585, -9.763727445065406, -27.649989133335552, 5.830804963625916, -12.747528223495433, -23.611926817189033, 17.28979040448209, -11.757820601178494, -19.854154962687982, 4.798523366779312, -2.202660524927429, -20.60158041851232, -20.744333218725387, -10.009091064635486, -29.562125628521613, -10.056511807187292, -21.793140609011562, -7.059503751874499, -15.674946265472453, -13.378425273400303, -27.332919343431097, -18.581046880571805, 7.82820346651426, -8.447677124218407, -22.334268025227093, -16.059855800007085, -9.630801901838975, -41.27439783227221, -9.342187006702767, -10.24680555260112, -32.987781255709585, -5.654775055591009, -18.047897814958276, -0.046098849455326274, -25.948954235564326, -6.946701006592751, 0.0036353515115745694, -19.463714458845608, -10.809224701924757, -11.880982016063673, -26.368741065419517, -35.45888013466723, -18.520660119979805, 0.38856656266173495, -14.917087795169468, -22.38786303214363, -18.539919674482697, -22.18671767610519, -12.625114289261662, -28.426277265058253, -11.142954652593527, -3.6028605009869556, 0.5548523474673055, 8.913858617943797, -1.736627742959346, -9.315311275593313, -30.47973861924214, -16.690139469849047, 4.26295655275569, -5.96823918066295, -3.276376191060036, -14.540002737531541, -14.818724917343925, -25.927965371333208, -4.694895339573836, -3.1089170707424056, 6.140569804302634, 5.397446817505843, -1.0525867525774943, -20.221374563921714, 0.2838196230738266, 1.0348306103278357, -5.83690975955786, -15.101139797863604, -17.311485158728065, -9.642738261456877, -10.55521979430208, -23.77546997798632, -29.78949958823386, -5.044186740240953, -19.75542335957308, -14.934784043073304, -6.095459277484102, -0.6073750485186107], "policy_predator_policy_reward": [6.181883282516738, 0.04195644596634551, -15.281478238514278, -4.311959989679011, 3.7715894553728564, 10.010578419378698, 32.45793012487597, 28.59333629836341, 6.751832902420652, 27.729517474275568, -10.905965968418677, 9.649874615866267, -18.365110978470792, -1.8292294227506574, 18.138586557023892, 38.96751656997626, -12.249603138488, 6.256440025247025, 18.21305245165503, 37.461176788005666, -3.0011005376931497, 4.2540612559533315, -0.657291782999744, -10.08658721172004, 18.25875026210996, 10.04188303274669, 12.558571709112478, -2.2438513562168794, 20.57079849970475, 24.067075813338896, 27.108367638198366, 16.381450425356935, 3.187657140596965, 27.309503127894754, 15.629453342714925, 3.898001547415845, 21.377967782618672, 33.92201048405251, 1.844404452345092, -13.506014379596913, 10.69974844475999, 14.795308002230875, 10.16311471468868, 37.060738919689385, -12.667260519492045, -21.912320289472127, 10.209317445908505, 13.306323756448485, 26.296840334948, 13.411469590427954, -2.7940261855415116, -6.803020548017109, -5.0680969704110534, 9.473418020265907, 21.44027549368797, 19.76288534333667, 26.198674586136836, 15.289991851313907, 14.134341931122343, 5.883840198148624, 22.558638742683446, 36.565612514359756, 10.676527631437764, 9.43649598293683, 9.428845640346927, 34.15743557767618, 10.063454053466751, 4.055553450282249, 30.195720362580275, 1.154172168364635, -3.0694314959908118, 29.826282042791426, 37.03194745599602, 17.633891230866187, 9.87017785258313, 27.291915908560544, -8.001725505435246, -7.654681427593271, 11.358044054791819, 5.537310193644995, 27.581071678721514, 17.08746437173272, 2.3792849227358754, 29.7404266772783, 5.373421432625928, 13.888182371052002, 34.44688304283681, 48.10191262170761, 8.29248717322901, 10.39188684017655, 13.857966814880653, 6.635644290321622, 24.296257383153076, 41.67930512826613, -1.375665240054908, 12.68521535123693, 36.043491526743885, 0.05230410317265566, 1.9099289270824862, -1.8177312281718425, 20.1370438480789, 31.760864623049727, 9.802935291497196, 4.090466721688305, -11.32725744793259, 11.319986744909428, 21.532154234412722, 17.39527468327849, 6.355286464566911, 15.263162939282601, 14.512551480094789, 9.249412552032554, 23.980582197669964, 28.75689993316906, 35.00739999204038, 35.91036027729412, 26.171195299410215, 10.870124940549418, -3.1786953255125923, 2.4015622001891046, 29.539845816961126, 0.29432977337781807, 34.436876463815864, 10.338849600471399, 7.643764662627476, 29.436074686337918, 19.59747523121716, 24.775960120993144, 23.495895147483573, 1.7543334310397887, 23.005500212449515, 33.84705431766699, 19.116152037015475, 3.1697572681715727, 17.053443896010528, -9.847722894036592, -5.085178353032887, 3.9754736580982613, 1.6731627733196177, -19.500880009207197, -2.9322022410898363, 6.40545772700856, 15.093453278640874, 3.537169272545757, 24.498967531719693, 36.46050970676456, 22.348120340677163, 11.032158599020951, -2.1637795683609795, -6.362133537150386, 1.1293181792157319, 10.80716018211017, -6.812131373540353, 13.36488375566042, 3.7244321440807493, 25.35557333098234, 12.447401416495739, 17.190048418192116, 30.281904369111263, 21.574026373555217, 5.343578309214951, 4.046212369932724, 13.795858134636855, -7.57802399315203, -2.6884055579013495, -9.592734050703893, 0.9942970641360649, -11.789190699147746, 8.551605327361388, -6.446431822206419, 18.919330720913646, 21.523418406929757, -5.615149083359604, 5.047509837211955, 4.483343851991309, -6.553005072646988, 13.875537101521743, -2.2017175824060153, 13.362145200208719, 16.840134395518444, 7.222861048044909, 27.400109269411193, 23.5041911069668, -4.2187145840530444, 9.243062784899745, 11.867376803704417, 17.3778678387097, 30.17307211726294, 38.76197311119491, 20.817026065272845, 13.374414582220393, -3.2860411017384887, 19.93273490966466, 19.57811180948149, 15.197042636692657, 14.672525449453998, -6.212114036453382, 18.403032591421578, 8.796574082580834, -7.5818239855436165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6258817518185211, "mean_inference_ms": 1.6666158897542571, "mean_action_processing_ms": 0.25752269971892316, "mean_env_wait_ms": 0.14461762537385214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006910443305969238, "StateBufferConnector_ms": 0.0038107633590698242, "ViewRequirementAgentConnector_ms": 0.10122025012969971}, "num_episodes": 23, "episode_return_max": 41.27439783227218, "episode_return_min": -17.289790404482094, "episode_return_mean": 11.77748968208625, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.88099260180786, "num_env_steps_trained_throughput_per_sec": 356.88099260180786, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1692000, "timers": {"training_iteration_time_ms": 10949.686, "restore_workers_time_ms": 0.025, "training_step_time_ms": 10949.535, "sample_time_ms": 1442.142, "learn_time_ms": 9486.103, "learn_throughput": 421.669, "synch_weights_time_ms": 19.499}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "done": false, "training_iteration": 141, "trial_id": "06536_00000", "date": "2024-08-11_17-39-48", "timestamp": 1723412388, "time_this_iter_s": 11.257437229156494, "time_total_s": 3928.515730381012, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317a1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3928.515730381012, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 47.675, "ram_util_percent": 82.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.219847373167673, "cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.056888509665926, "policy_loss": -0.0076685246817457175, "vf_loss": 3.0645570234706003, "vf_explained_var": 0.9110158347835143, "kl": 0.006274853499041283, "entropy": 0.3880652523289124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.043942730956608, "cur_kl_coeff": 3.101927297073853e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3865658303417225, "policy_loss": -0.0018511210824486125, "vf_loss": 3.388416950664823, "vf_explained_var": 0.8966334421483297, "kl": 0.0032751931718595544, "entropy": 0.23048193611638257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "env_runners": {"episode_reward_max": 41.27439783227218, "episode_reward_min": -17.289790404482094, "episode_reward_mean": 12.402681285410194, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.27439783227221, "predator_policy": -21.912320289472127}, "policy_reward_max": {"prey_policy": 17.28979040448209, "predator_policy": 48.10191262170761}, "policy_reward_mean": {"prey_policy": -12.402681285410196, "predator_policy": 12.4026812854102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.649989133335517, -5.830804963625901, 12.747528223495427, 23.61192681718908, -17.289790404482094, 11.757820601178498, 19.854154962687993, -4.798523366779325, 2.202660524927431, 20.601580418512313, 20.74433321872539, 10.009091064635477, 29.562125628521617, 10.056511807187295, 21.793140609011527, 7.059503751874486, 15.674946265472457, 13.37842527340032, 27.3329193434311, 18.581046880571847, -7.828203466514255, 8.447677124218405, 22.334268025227097, 16.059855800007085, 9.63080190183897, 41.27439783227218, 9.342187006702787, 10.24680555260113, 32.98778125570965, 5.654775055591073, 18.047897814958304, 0.0460988494552943, 25.94895423556434, 6.946701006592758, -0.00363535151159855, 19.463714458845608, 10.809224701924755, 11.880982016063683, 26.368741065419506, 35.45888013466725, 18.52066011997981, -0.3885665626617456, 14.917087795169481, 22.387863032143628, 18.539919674482697, 22.186717676105122, 12.62511428926168, 28.426277265058246, 11.142954652593534, 3.602860500986968, -0.5548523474673015, -8.913858617943822, 1.7366277429593584, 9.315311275593315, 30.479738619242113, 16.690139469849044, -4.262956552755677, 5.968239180662951, 3.276376191060013, 14.540002737531527, 14.818724917343916, 25.92796537133329, 4.694895339573837, 3.108917070742411, -6.140569804302637, -5.39744681750584, 1.0525867525774544, 20.221374563921696, -0.28381962307382036, -1.0348306103278455, 5.8369097595578685, 15.101139797863596, 17.31148515872806, 9.642738261456868, 10.555219794302063, 23.775469977986294, 29.78949958823387, 5.044186740240957, 19.755423359573058, 14.93478404307333, 6.0954592774840854, 0.607375048518624, 11.530162514479278, 31.981688845939985, 20.59764934528485, 14.838731675695156, 10.793608460812083, 11.72129062356866, 10.101610717615676, 28.137097854191666, -8.061142416925323, 7.717421276620719, 29.00855061549303, 16.544036723859584, 28.896061713410766, 14.245930414154332, 12.31684157056281, 0.3603761478774006, -4.459033416567384, 0.5276109568898777], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.649989133335552, 5.830804963625916, -12.747528223495433, -23.611926817189033, 17.28979040448209, -11.757820601178494, -19.854154962687982, 4.798523366779312, -2.202660524927429, -20.60158041851232, -20.744333218725387, -10.009091064635486, -29.562125628521613, -10.056511807187292, -21.793140609011562, -7.059503751874499, -15.674946265472453, -13.378425273400303, -27.332919343431097, -18.581046880571805, 7.82820346651426, -8.447677124218407, -22.334268025227093, -16.059855800007085, -9.630801901838975, -41.27439783227221, -9.342187006702767, -10.24680555260112, -32.987781255709585, -5.654775055591009, -18.047897814958276, -0.046098849455326274, -25.948954235564326, -6.946701006592751, 0.0036353515115745694, -19.463714458845608, -10.809224701924757, -11.880982016063673, -26.368741065419517, -35.45888013466723, -18.520660119979805, 0.38856656266173495, -14.917087795169468, -22.38786303214363, -18.539919674482697, -22.18671767610519, -12.625114289261662, -28.426277265058253, -11.142954652593527, -3.6028605009869556, 0.5548523474673055, 8.913858617943797, -1.736627742959346, -9.315311275593313, -30.47973861924214, -16.690139469849047, 4.26295655275569, -5.96823918066295, -3.276376191060036, -14.540002737531541, -14.818724917343925, -25.927965371333208, -4.694895339573836, -3.1089170707424056, 6.140569804302634, 5.397446817505843, -1.0525867525774943, -20.221374563921714, 0.2838196230738266, 1.0348306103278357, -5.83690975955786, -15.101139797863604, -17.311485158728065, -9.642738261456877, -10.55521979430208, -23.77546997798632, -29.78949958823386, -5.044186740240953, -19.75542335957308, -14.934784043073304, -6.095459277484102, -0.6073750485186107, -11.530162514479269, -31.981688845940006, -20.597649345284843, -14.838731675695183, -10.793608460812091, -11.72129062356866, -10.101610717615678, -28.137097854191676, 8.061142416925321, -7.717421276620735, -29.00855061549301, -16.54403672385959, -28.89606171341076, -14.245930414154316, -12.316841570562815, -0.3603761478774068, 4.459033416567392, -0.5276109568898679], "policy_predator_policy_reward": [21.377967782618672, 33.92201048405251, 1.844404452345092, -13.506014379596913, 10.69974844475999, 14.795308002230875, 10.16311471468868, 37.060738919689385, -12.667260519492045, -21.912320289472127, 10.209317445908505, 13.306323756448485, 26.296840334948, 13.411469590427954, -2.7940261855415116, -6.803020548017109, -5.0680969704110534, 9.473418020265907, 21.44027549368797, 19.76288534333667, 26.198674586136836, 15.289991851313907, 14.134341931122343, 5.883840198148624, 22.558638742683446, 36.565612514359756, 10.676527631437764, 9.43649598293683, 9.428845640346927, 34.15743557767618, 10.063454053466751, 4.055553450282249, 30.195720362580275, 1.154172168364635, -3.0694314959908118, 29.826282042791426, 37.03194745599602, 17.633891230866187, 9.87017785258313, 27.291915908560544, -8.001725505435246, -7.654681427593271, 11.358044054791819, 5.537310193644995, 27.581071678721514, 17.08746437173272, 2.3792849227358754, 29.7404266772783, 5.373421432625928, 13.888182371052002, 34.44688304283681, 48.10191262170761, 8.29248717322901, 10.39188684017655, 13.857966814880653, 6.635644290321622, 24.296257383153076, 41.67930512826613, -1.375665240054908, 12.68521535123693, 36.043491526743885, 0.05230410317265566, 1.9099289270824862, -1.8177312281718425, 20.1370438480789, 31.760864623049727, 9.802935291497196, 4.090466721688305, -11.32725744793259, 11.319986744909428, 21.532154234412722, 17.39527468327849, 6.355286464566911, 15.263162939282601, 14.512551480094789, 9.249412552032554, 23.980582197669964, 28.75689993316906, 35.00739999204038, 35.91036027729412, 26.171195299410215, 10.870124940549418, -3.1786953255125923, 2.4015622001891046, 29.539845816961126, 0.29432977337781807, 34.436876463815864, 10.338849600471399, 7.643764662627476, 29.436074686337918, 19.59747523121716, 24.775960120993144, 23.495895147483573, 1.7543334310397887, 23.005500212449515, 33.84705431766699, 19.116152037015475, 3.1697572681715727, 17.053443896010528, -9.847722894036592, -5.085178353032887, 3.9754736580982613, 1.6731627733196177, -19.500880009207197, -2.9322022410898363, 6.40545772700856, 15.093453278640874, 3.537169272545757, 24.498967531719693, 36.46050970676456, 22.348120340677163, 11.032158599020951, -2.1637795683609795, -6.362133537150386, 1.1293181792157319, 10.80716018211017, -6.812131373540353, 13.36488375566042, 3.7244321440807493, 25.35557333098234, 12.447401416495739, 17.190048418192116, 30.281904369111263, 21.574026373555217, 5.343578309214951, 4.046212369932724, 13.795858134636855, -7.57802399315203, -2.6884055579013495, -9.592734050703893, 0.9942970641360649, -11.789190699147746, 8.551605327361388, -6.446431822206419, 18.919330720913646, 21.523418406929757, -5.615149083359604, 5.047509837211955, 4.483343851991309, -6.553005072646988, 13.875537101521743, -2.2017175824060153, 13.362145200208719, 16.840134395518444, 7.222861048044909, 27.400109269411193, 23.5041911069668, -4.2187145840530444, 9.243062784899745, 11.867376803704417, 17.3778678387097, 30.17307211726294, 38.76197311119491, 20.817026065272845, 13.374414582220393, -3.2860411017384887, 19.93273490966466, 19.57811180948149, 15.197042636692657, 14.672525449453998, -6.212114036453382, 18.403032591421578, 8.796574082580834, -7.5818239855436165, 19.85350545778693, 3.2068195711716037, 40.6781592344649, 23.285218457415063, 10.500319189856839, 30.69497950071287, 21.266081413690266, 8.41138193770008, 5.23742018971979, 16.349796731904352, 13.054564476719037, 10.388016770418293, -2.0263475575457908, 22.229568992777125, 35.32005463329589, 20.954141075087506, -7.1060613772793335, -9.016223456571309, 9.440094201021882, 5.994748352219606, 22.945497107689416, 35.07160412329662, 24.12169283385122, 8.966380613867955, 15.990576667870798, 41.801546758950714, 10.214538817372507, 18.27732201093617, -2.8725579119733298, 27.50624105309893, 2.6215708044610615, -1.9008185087062568, -8.144497936199866, -0.7735688969349228, -7.709980846212421, 8.765202759992158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.625501815714103, "mean_inference_ms": 1.6638384284542476, "mean_action_processing_ms": 0.25714187971843677, "mean_env_wait_ms": 0.14446765574899573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006210207939147949, "StateBufferConnector_ms": 0.0037565231323242188, "ViewRequirementAgentConnector_ms": 0.09777092933654785}, "num_episodes": 18, "episode_return_max": 41.27439783227218, "episode_return_min": -17.289790404482094, "episode_return_mean": 12.402681285410194, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 367.35756603751315, "num_env_steps_trained_throughput_per_sec": 367.35756603751315, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1704000, "timers": {"training_iteration_time_ms": 10927.783, "restore_workers_time_ms": 0.023, "training_step_time_ms": 10927.641, "sample_time_ms": 1409.251, "learn_time_ms": 9497.044, "learn_throughput": 421.184, "synch_weights_time_ms": 19.535}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "done": false, "training_iteration": 142, "trial_id": "06536_00000", "date": "2024-08-11_17-39-59", "timestamp": 1723412399, "time_this_iter_s": 10.911099910736084, "time_total_s": 3939.426830291748, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317ee790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3939.426830291748, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 51.975, "ram_util_percent": 82.86875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.005591736609737, "cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.359619317576289, "policy_loss": -0.0048724818235010995, "vf_loss": 2.36449178767701, "vf_explained_var": 0.9341039781148235, "kl": 0.004195928789545947, "entropy": 0.34477012262990075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8564806115059627, "cur_kl_coeff": 1.5509636485369265e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8866873955600476, "policy_loss": -0.0018964945820342533, "vf_loss": 2.888583883217403, "vf_explained_var": 0.9335297003624932, "kl": 0.004630956261020288, "entropy": 0.2522947722405353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "env_runners": {"episode_reward_max": 41.27439783227218, "episode_reward_min": -17.312577170853945, "episode_reward_mean": 13.305255404562988, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.27439783227221, "predator_policy": -20.230849351641705}, "policy_reward_max": {"prey_policy": 17.31257717085395, "predator_policy": 48.10191262170761}, "policy_reward_mean": {"prey_policy": -13.305255404562988, "predator_policy": 13.30525540456299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.334268025227097, 16.059855800007085, 9.63080190183897, 41.27439783227218, 9.342187006702787, 10.24680555260113, 32.98778125570965, 5.654775055591073, 18.047897814958304, 0.0460988494552943, 25.94895423556434, 6.946701006592758, -0.00363535151159855, 19.463714458845608, 10.809224701924755, 11.880982016063683, 26.368741065419506, 35.45888013466725, 18.52066011997981, -0.3885665626617456, 14.917087795169481, 22.387863032143628, 18.539919674482697, 22.186717676105122, 12.62511428926168, 28.426277265058246, 11.142954652593534, 3.602860500986968, -0.5548523474673015, -8.913858617943822, 1.7366277429593584, 9.315311275593315, 30.479738619242113, 16.690139469849044, -4.262956552755677, 5.968239180662951, 3.276376191060013, 14.540002737531527, 14.818724917343916, 25.92796537133329, 4.694895339573837, 3.108917070742411, -6.140569804302637, -5.39744681750584, 1.0525867525774544, 20.221374563921696, -0.28381962307382036, -1.0348306103278455, 5.8369097595578685, 15.101139797863596, 17.31148515872806, 9.642738261456868, 10.555219794302063, 23.775469977986294, 29.78949958823387, 5.044186740240957, 19.755423359573058, 14.93478404307333, 6.0954592774840854, 0.607375048518624, 11.530162514479278, 31.981688845939985, 20.59764934528485, 14.838731675695156, 10.793608460812083, 11.72129062356866, 10.101610717615676, 28.137097854191666, -8.061142416925323, 7.717421276620719, 29.00855061549303, 16.544036723859584, 28.896061713410766, 14.245930414154332, 12.31684157056281, 0.3603761478774006, -4.459033416567384, 0.5276109568898777, 37.423638464398756, 41.226083103985516, 19.123402791890904, -2.711247215807388, 33.74610941053836, 25.78272234889207, 12.6471707487015, 30.693315765736656, 3.7308121066053275, 9.591943820418166, -2.7233770957365726, 15.330657024730753, 38.93459645203237, 14.562812164394822, 4.807864458137944, 9.895877232897497, -17.312577170853945, 5.214966270215163, 28.88194336240765, 13.323182154922437, 19.75864366287885, 13.646931500866863], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.334268025227093, -16.059855800007085, -9.630801901838975, -41.27439783227221, -9.342187006702767, -10.24680555260112, -32.987781255709585, -5.654775055591009, -18.047897814958276, -0.046098849455326274, -25.948954235564326, -6.946701006592751, 0.0036353515115745694, -19.463714458845608, -10.809224701924757, -11.880982016063673, -26.368741065419517, -35.45888013466723, -18.520660119979805, 0.38856656266173495, -14.917087795169468, -22.38786303214363, -18.539919674482697, -22.18671767610519, -12.625114289261662, -28.426277265058253, -11.142954652593527, -3.6028605009869556, 0.5548523474673055, 8.913858617943797, -1.736627742959346, -9.315311275593313, -30.47973861924214, -16.690139469849047, 4.26295655275569, -5.96823918066295, -3.276376191060036, -14.540002737531541, -14.818724917343925, -25.927965371333208, -4.694895339573836, -3.1089170707424056, 6.140569804302634, 5.397446817505843, -1.0525867525774943, -20.221374563921714, 0.2838196230738266, 1.0348306103278357, -5.83690975955786, -15.101139797863604, -17.311485158728065, -9.642738261456877, -10.55521979430208, -23.77546997798632, -29.78949958823386, -5.044186740240953, -19.75542335957308, -14.934784043073304, -6.095459277484102, -0.6073750485186107, -11.530162514479269, -31.981688845940006, -20.597649345284843, -14.838731675695183, -10.793608460812091, -11.72129062356866, -10.101610717615678, -28.137097854191676, 8.061142416925321, -7.717421276620735, -29.00855061549301, -16.54403672385959, -28.89606171341076, -14.245930414154316, -12.316841570562815, -0.3603761478774068, 4.459033416567392, -0.5276109568898679, -37.42363846439876, -41.22608310398548, -19.123402791890864, 2.7112472158074086, -33.74610941053838, -25.78272234889206, -12.647170748701502, -30.693315765736642, -3.7308121066053186, -9.59194382041816, 2.7233770957365886, -15.330657024730737, -38.93459645203239, -14.562812164394835, -4.807864458137907, -9.895877232897508, 17.31257717085395, -5.214966270215143, -28.881943362407604, -13.323182154922417, -19.75864366287886, -13.646931500866879], "policy_predator_policy_reward": [27.581071678721514, 17.08746437173272, 2.3792849227358754, 29.7404266772783, 5.373421432625928, 13.888182371052002, 34.44688304283681, 48.10191262170761, 8.29248717322901, 10.39188684017655, 13.857966814880653, 6.635644290321622, 24.296257383153076, 41.67930512826613, -1.375665240054908, 12.68521535123693, 36.043491526743885, 0.05230410317265566, 1.9099289270824862, -1.8177312281718425, 20.1370438480789, 31.760864623049727, 9.802935291497196, 4.090466721688305, -11.32725744793259, 11.319986744909428, 21.532154234412722, 17.39527468327849, 6.355286464566911, 15.263162939282601, 14.512551480094789, 9.249412552032554, 23.980582197669964, 28.75689993316906, 35.00739999204038, 35.91036027729412, 26.171195299410215, 10.870124940549418, -3.1786953255125923, 2.4015622001891046, 29.539845816961126, 0.29432977337781807, 34.436876463815864, 10.338849600471399, 7.643764662627476, 29.436074686337918, 19.59747523121716, 24.775960120993144, 23.495895147483573, 1.7543334310397887, 23.005500212449515, 33.84705431766699, 19.116152037015475, 3.1697572681715727, 17.053443896010528, -9.847722894036592, -5.085178353032887, 3.9754736580982613, 1.6731627733196177, -19.500880009207197, -2.9322022410898363, 6.40545772700856, 15.093453278640874, 3.537169272545757, 24.498967531719693, 36.46050970676456, 22.348120340677163, 11.032158599020951, -2.1637795683609795, -6.362133537150386, 1.1293181792157319, 10.80716018211017, -6.812131373540353, 13.36488375566042, 3.7244321440807493, 25.35557333098234, 12.447401416495739, 17.190048418192116, 30.281904369111263, 21.574026373555217, 5.343578309214951, 4.046212369932724, 13.795858134636855, -7.57802399315203, -2.6884055579013495, -9.592734050703893, 0.9942970641360649, -11.789190699147746, 8.551605327361388, -6.446431822206419, 18.919330720913646, 21.523418406929757, -5.615149083359604, 5.047509837211955, 4.483343851991309, -6.553005072646988, 13.875537101521743, -2.2017175824060153, 13.362145200208719, 16.840134395518444, 7.222861048044909, 27.400109269411193, 23.5041911069668, -4.2187145840530444, 9.243062784899745, 11.867376803704417, 17.3778678387097, 30.17307211726294, 38.76197311119491, 20.817026065272845, 13.374414582220393, -3.2860411017384887, 19.93273490966466, 19.57811180948149, 15.197042636692657, 14.672525449453998, -6.212114036453382, 18.403032591421578, 8.796574082580834, -7.5818239855436165, 19.85350545778693, 3.2068195711716037, 40.6781592344649, 23.285218457415063, 10.500319189856839, 30.69497950071287, 21.266081413690266, 8.41138193770008, 5.23742018971979, 16.349796731904352, 13.054564476719037, 10.388016770418293, -2.0263475575457908, 22.229568992777125, 35.32005463329589, 20.954141075087506, -7.1060613772793335, -9.016223456571309, 9.440094201021882, 5.994748352219606, 22.945497107689416, 35.07160412329662, 24.12169283385122, 8.966380613867955, 15.990576667870798, 41.801546758950714, 10.214538817372507, 18.27732201093617, -2.8725579119733298, 27.50624105309893, 2.6215708044610615, -1.9008185087062568, -8.144497936199866, -0.7735688969349228, -7.709980846212421, 8.765202759992158, 36.054406203135805, 38.792870725661714, 43.0633647551149, 39.388801452856086, 15.441229574411683, 22.805576009370093, -4.4547546004292276, -0.9677398311855292, 34.135737939100125, 33.35648088197661, 16.14065267108048, 35.42479202670363, 15.447964634342695, 9.846376863060309, 23.09211050044147, 38.29452103103182, -3.825035501401139, 11.28665971461179, 1.0308762681935377, 18.15301137264281, 1.8110547969103141, -7.25780898838347, 9.661081298361832, 21.000232751099638, 31.198457665855702, 46.67073523820911, 30.229623776794806, -1.1039994480051316, 5.810540566605937, 3.8051883496699155, 11.853221290467662, 7.938533175327322, -20.230849351641705, -14.394304990066196, -3.555754863977839, 13.985687404408125, 32.878883242329394, 24.88500348248586, 20.18487791473065, 6.461486395114202, 19.5136426996196, 20.00364462613809, -0.21290588968299495, 27.506768891416726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6252271237297253, "mean_inference_ms": 1.6626691347319025, "mean_action_processing_ms": 0.25701807257489434, "mean_env_wait_ms": 0.14453548143284686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005214810371398926, "StateBufferConnector_ms": 0.003711700439453125, "ViewRequirementAgentConnector_ms": 0.09644341468811035}, "num_episodes": 22, "episode_return_max": 41.27439783227218, "episode_return_min": -17.312577170853945, "episode_return_mean": 13.305255404562988, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.3911352288532, "num_env_steps_trained_throughput_per_sec": 350.3911352288532, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1716000, "timers": {"training_iteration_time_ms": 10991.672, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10991.518, "sample_time_ms": 1452.214, "learn_time_ms": 9514.969, "learn_throughput": 420.39, "synch_weights_time_ms": 22.11}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "done": false, "training_iteration": 143, "trial_id": "06536_00000", "date": "2024-08-11_17-40-10", "timestamp": 1723412410, "time_this_iter_s": 11.463783979415894, "time_total_s": 3950.890614271164, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3950.890614271164, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 49.74375, "ram_util_percent": 82.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6767462333043417, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.090363992502292, "policy_loss": -0.005527349051165705, "vf_loss": 2.0958913347373405, "vf_explained_var": 0.9215354974071185, "kl": 0.004814590438574129, "entropy": 0.32001124086479343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5891992115469837, "cur_kl_coeff": 7.754818242684633e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.700250511699253, "policy_loss": -0.0027308124763073113, "vf_loss": 2.702981330730297, "vf_explained_var": 0.8957751127777906, "kl": 0.0035544132607505784, "entropy": 0.21118545314622303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 41.226083103985516, "episode_reward_min": -17.312577170853945, "episode_reward_mean": 12.966264367068169, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.22608310398548, "predator_policy": -20.230849351641705}, "policy_reward_max": {"prey_policy": 17.31257717085395, "predator_policy": 46.67073523820911}, "policy_reward_mean": {"prey_policy": -12.966264367068169, "predator_policy": 12.96626436706817}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.52066011997981, -0.3885665626617456, 14.917087795169481, 22.387863032143628, 18.539919674482697, 22.186717676105122, 12.62511428926168, 28.426277265058246, 11.142954652593534, 3.602860500986968, -0.5548523474673015, -8.913858617943822, 1.7366277429593584, 9.315311275593315, 30.479738619242113, 16.690139469849044, -4.262956552755677, 5.968239180662951, 3.276376191060013, 14.540002737531527, 14.818724917343916, 25.92796537133329, 4.694895339573837, 3.108917070742411, -6.140569804302637, -5.39744681750584, 1.0525867525774544, 20.221374563921696, -0.28381962307382036, -1.0348306103278455, 5.8369097595578685, 15.101139797863596, 17.31148515872806, 9.642738261456868, 10.555219794302063, 23.775469977986294, 29.78949958823387, 5.044186740240957, 19.755423359573058, 14.93478404307333, 6.0954592774840854, 0.607375048518624, 11.530162514479278, 31.981688845939985, 20.59764934528485, 14.838731675695156, 10.793608460812083, 11.72129062356866, 10.101610717615676, 28.137097854191666, -8.061142416925323, 7.717421276620719, 29.00855061549303, 16.544036723859584, 28.896061713410766, 14.245930414154332, 12.31684157056281, 0.3603761478774006, -4.459033416567384, 0.5276109568898777, 37.423638464398756, 41.226083103985516, 19.123402791890904, -2.711247215807388, 33.74610941053836, 25.78272234889207, 12.6471707487015, 30.693315765736656, 3.7308121066053275, 9.591943820418166, -2.7233770957365726, 15.330657024730753, 38.93459645203237, 14.562812164394822, 4.807864458137944, 9.895877232897497, -17.312577170853945, 5.214966270215163, 28.88194336240765, 13.323182154922437, 19.75864366287885, 13.646931500866863, 15.840093100746065, 24.340365153804917, 21.44390561126372, 27.498782185095006, 9.498662149512073, 3.1662790369446014, 11.163878953032475, 35.8139387146961, 25.17414804745923, 8.810565464719513, 16.61512551763813, 2.2146953718637796, 21.02240396867635, 2.436427341392495, 10.133753658965986, 1.8685475132378517, 23.319115963482357, 8.23863985991713], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.520660119979805, 0.38856656266173495, -14.917087795169468, -22.38786303214363, -18.539919674482697, -22.18671767610519, -12.625114289261662, -28.426277265058253, -11.142954652593527, -3.6028605009869556, 0.5548523474673055, 8.913858617943797, -1.736627742959346, -9.315311275593313, -30.47973861924214, -16.690139469849047, 4.26295655275569, -5.96823918066295, -3.276376191060036, -14.540002737531541, -14.818724917343925, -25.927965371333208, -4.694895339573836, -3.1089170707424056, 6.140569804302634, 5.397446817505843, -1.0525867525774943, -20.221374563921714, 0.2838196230738266, 1.0348306103278357, -5.83690975955786, -15.101139797863604, -17.311485158728065, -9.642738261456877, -10.55521979430208, -23.77546997798632, -29.78949958823386, -5.044186740240953, -19.75542335957308, -14.934784043073304, -6.095459277484102, -0.6073750485186107, -11.530162514479269, -31.981688845940006, -20.597649345284843, -14.838731675695183, -10.793608460812091, -11.72129062356866, -10.101610717615678, -28.137097854191676, 8.061142416925321, -7.717421276620735, -29.00855061549301, -16.54403672385959, -28.89606171341076, -14.245930414154316, -12.316841570562815, -0.3603761478774068, 4.459033416567392, -0.5276109568898679, -37.42363846439876, -41.22608310398548, -19.123402791890864, 2.7112472158074086, -33.74610941053838, -25.78272234889206, -12.647170748701502, -30.693315765736642, -3.7308121066053186, -9.59194382041816, 2.7233770957365886, -15.330657024730737, -38.93459645203239, -14.562812164394835, -4.807864458137907, -9.895877232897508, 17.31257717085395, -5.214966270215143, -28.881943362407604, -13.323182154922417, -19.75864366287886, -13.646931500866879, -15.840093100746074, -24.3403651538049, -21.44390561126371, -27.49878218509501, -9.498662149512082, -3.1662790369446157, -11.163878953032496, -35.81393871469611, -25.174148047459234, -8.81056546471951, -16.61512551763814, -2.2146953718637725, -21.022403968676354, -2.436427341392519, -10.133753658965988, -1.868547513237881, -23.31911596348236, -8.238639859917132], "policy_predator_policy_reward": [26.171195299410215, 10.870124940549418, -3.1786953255125923, 2.4015622001891046, 29.539845816961126, 0.29432977337781807, 34.436876463815864, 10.338849600471399, 7.643764662627476, 29.436074686337918, 19.59747523121716, 24.775960120993144, 23.495895147483573, 1.7543334310397887, 23.005500212449515, 33.84705431766699, 19.116152037015475, 3.1697572681715727, 17.053443896010528, -9.847722894036592, -5.085178353032887, 3.9754736580982613, 1.6731627733196177, -19.500880009207197, -2.9322022410898363, 6.40545772700856, 15.093453278640874, 3.537169272545757, 24.498967531719693, 36.46050970676456, 22.348120340677163, 11.032158599020951, -2.1637795683609795, -6.362133537150386, 1.1293181792157319, 10.80716018211017, -6.812131373540353, 13.36488375566042, 3.7244321440807493, 25.35557333098234, 12.447401416495739, 17.190048418192116, 30.281904369111263, 21.574026373555217, 5.343578309214951, 4.046212369932724, 13.795858134636855, -7.57802399315203, -2.6884055579013495, -9.592734050703893, 0.9942970641360649, -11.789190699147746, 8.551605327361388, -6.446431822206419, 18.919330720913646, 21.523418406929757, -5.615149083359604, 5.047509837211955, 4.483343851991309, -6.553005072646988, 13.875537101521743, -2.2017175824060153, 13.362145200208719, 16.840134395518444, 7.222861048044909, 27.400109269411193, 23.5041911069668, -4.2187145840530444, 9.243062784899745, 11.867376803704417, 17.3778678387097, 30.17307211726294, 38.76197311119491, 20.817026065272845, 13.374414582220393, -3.2860411017384887, 19.93273490966466, 19.57811180948149, 15.197042636692657, 14.672525449453998, -6.212114036453382, 18.403032591421578, 8.796574082580834, -7.5818239855436165, 19.85350545778693, 3.2068195711716037, 40.6781592344649, 23.285218457415063, 10.500319189856839, 30.69497950071287, 21.266081413690266, 8.41138193770008, 5.23742018971979, 16.349796731904352, 13.054564476719037, 10.388016770418293, -2.0263475575457908, 22.229568992777125, 35.32005463329589, 20.954141075087506, -7.1060613772793335, -9.016223456571309, 9.440094201021882, 5.994748352219606, 22.945497107689416, 35.07160412329662, 24.12169283385122, 8.966380613867955, 15.990576667870798, 41.801546758950714, 10.214538817372507, 18.27732201093617, -2.8725579119733298, 27.50624105309893, 2.6215708044610615, -1.9008185087062568, -8.144497936199866, -0.7735688969349228, -7.709980846212421, 8.765202759992158, 36.054406203135805, 38.792870725661714, 43.0633647551149, 39.388801452856086, 15.441229574411683, 22.805576009370093, -4.4547546004292276, -0.9677398311855292, 34.135737939100125, 33.35648088197661, 16.14065267108048, 35.42479202670363, 15.447964634342695, 9.846376863060309, 23.09211050044147, 38.29452103103182, -3.825035501401139, 11.28665971461179, 1.0308762681935377, 18.15301137264281, 1.8110547969103141, -7.25780898838347, 9.661081298361832, 21.000232751099638, 31.198457665855702, 46.67073523820911, 30.229623776794806, -1.1039994480051316, 5.810540566605937, 3.8051883496699155, 11.853221290467662, 7.938533175327322, -20.230849351641705, -14.394304990066196, -3.555754863977839, 13.985687404408125, 32.878883242329394, 24.88500348248586, 20.18487791473065, 6.461486395114202, 19.5136426996196, 20.00364462613809, -0.21290588968299495, 27.506768891416726, 27.703613484263016, 3.9765727172291356, 29.191084347004594, 19.48964596060523, 22.703008309844968, 20.184802912682432, 29.843256693739672, 25.15430767645035, 5.391417471488932, 13.605906827535238, 9.387493641039832, -3.0549355671506238, 23.55340266370716, -1.2256447576421463, 33.43671113123101, 38.19116629816121, 30.196028163322058, 20.152267931596413, 1.5566025164939785, 16.064528412945045, 22.788409930912966, 10.441841104363288, 15.980877189850588, -11.55148644612304, 10.041520975061093, 32.00328696229162, -11.305992843957167, 16.17884752674217, 19.565428752646238, 0.7020785652857455, 7.646719916190017, -3.9096248897142942, 16.992010063987415, 29.646221862977317, 6.223303458445775, 10.253976261388502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.625263189090893, "mean_inference_ms": 1.6648597441869857, "mean_action_processing_ms": 0.25697176458206067, "mean_env_wait_ms": 0.14460015538676912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051000118255615234, "StateBufferConnector_ms": 0.0041408538818359375, "ViewRequirementAgentConnector_ms": 0.12375342845916748}, "num_episodes": 18, "episode_return_max": 41.226083103985516, "episode_return_min": -17.312577170853945, "episode_return_mean": 12.966264367068169, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.72987576303075, "num_env_steps_trained_throughput_per_sec": 343.72987576303075, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 11004.028, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11003.864, "sample_time_ms": 1547.316, "learn_time_ms": 9431.575, "learn_throughput": 424.107, "synch_weights_time_ms": 22.614}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 144, "trial_id": "06536_00000", "date": "2024-08-11_17-40-22", "timestamp": 1723412422, "time_this_iter_s": 11.698754072189331, "time_total_s": 3962.5893683433533, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316ab820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3962.5893683433533, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 50.817647058823525, "ram_util_percent": 83.28823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.559316361074646, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.616928989564379, "policy_loss": -0.0050426993785852876, "vf_loss": 1.6219716904064019, "vf_explained_var": 0.9597156807780266, "kl": 0.005100931946088201, "entropy": 0.31016197476225593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5668125718043595, "cur_kl_coeff": 3.8774091213423164e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4548290778720188, "policy_loss": -0.0016569025882904136, "vf_loss": 2.4564859779423505, "vf_explained_var": 0.9193512534969067, "kl": 0.002745613699906613, "entropy": 0.2098177507598564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "env_runners": {"episode_reward_max": 41.226083103985516, "episode_reward_min": -17.312577170853945, "episode_reward_mean": 13.712730810776907, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.22608310398548, "predator_policy": -20.230849351641705}, "policy_reward_max": {"prey_policy": 17.31257717085395, "predator_policy": 47.28311002643929}, "policy_reward_mean": {"prey_policy": -13.712730810776907, "predator_policy": 13.712730810776904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.276376191060013, 14.540002737531527, 14.818724917343916, 25.92796537133329, 4.694895339573837, 3.108917070742411, -6.140569804302637, -5.39744681750584, 1.0525867525774544, 20.221374563921696, -0.28381962307382036, -1.0348306103278455, 5.8369097595578685, 15.101139797863596, 17.31148515872806, 9.642738261456868, 10.555219794302063, 23.775469977986294, 29.78949958823387, 5.044186740240957, 19.755423359573058, 14.93478404307333, 6.0954592774840854, 0.607375048518624, 11.530162514479278, 31.981688845939985, 20.59764934528485, 14.838731675695156, 10.793608460812083, 11.72129062356866, 10.101610717615676, 28.137097854191666, -8.061142416925323, 7.717421276620719, 29.00855061549303, 16.544036723859584, 28.896061713410766, 14.245930414154332, 12.31684157056281, 0.3603761478774006, -4.459033416567384, 0.5276109568898777, 37.423638464398756, 41.226083103985516, 19.123402791890904, -2.711247215807388, 33.74610941053836, 25.78272234889207, 12.6471707487015, 30.693315765736656, 3.7308121066053275, 9.591943820418166, -2.7233770957365726, 15.330657024730753, 38.93459645203237, 14.562812164394822, 4.807864458137944, 9.895877232897497, -17.312577170853945, 5.214966270215163, 28.88194336240765, 13.323182154922437, 19.75864366287885, 13.646931500866863, 15.840093100746065, 24.340365153804917, 21.44390561126372, 27.498782185095006, 9.498662149512073, 3.1662790369446014, 11.163878953032475, 35.8139387146961, 25.17414804745923, 8.810565464719513, 16.61512551763813, 2.2146953718637796, 21.02240396867635, 2.436427341392495, 10.133753658965986, 1.8685475132378517, 23.319115963482357, 8.23863985991713, 5.205734574943644, 19.49065191294056, 6.762586801405842, 14.892117179966073, 26.78747199296192, 32.039663186369786, 4.544167753626659, 27.00929261022487, 30.02867243718392, 26.481071843023088, -13.522864755291797, 17.926639472635312, 26.05527022439991, 10.296351993576279, 2.4174385637956455, 10.995067202506972, -0.48590094430664443, 30.142489534170977], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.276376191060036, -14.540002737531541, -14.818724917343925, -25.927965371333208, -4.694895339573836, -3.1089170707424056, 6.140569804302634, 5.397446817505843, -1.0525867525774943, -20.221374563921714, 0.2838196230738266, 1.0348306103278357, -5.83690975955786, -15.101139797863604, -17.311485158728065, -9.642738261456877, -10.55521979430208, -23.77546997798632, -29.78949958823386, -5.044186740240953, -19.75542335957308, -14.934784043073304, -6.095459277484102, -0.6073750485186107, -11.530162514479269, -31.981688845940006, -20.597649345284843, -14.838731675695183, -10.793608460812091, -11.72129062356866, -10.101610717615678, -28.137097854191676, 8.061142416925321, -7.717421276620735, -29.00855061549301, -16.54403672385959, -28.89606171341076, -14.245930414154316, -12.316841570562815, -0.3603761478774068, 4.459033416567392, -0.5276109568898679, -37.42363846439876, -41.22608310398548, -19.123402791890864, 2.7112472158074086, -33.74610941053838, -25.78272234889206, -12.647170748701502, -30.693315765736642, -3.7308121066053186, -9.59194382041816, 2.7233770957365886, -15.330657024730737, -38.93459645203239, -14.562812164394835, -4.807864458137907, -9.895877232897508, 17.31257717085395, -5.214966270215143, -28.881943362407604, -13.323182154922417, -19.75864366287886, -13.646931500866879, -15.840093100746074, -24.3403651538049, -21.44390561126371, -27.49878218509501, -9.498662149512082, -3.1662790369446157, -11.163878953032496, -35.81393871469611, -25.174148047459234, -8.81056546471951, -16.61512551763814, -2.2146953718637725, -21.022403968676354, -2.436427341392519, -10.133753658965988, -1.868547513237881, -23.31911596348236, -8.238639859917132, -5.205734574943624, -19.490651912940624, -6.762586801405837, -14.892117179966071, -26.787471992961976, -32.03966318636978, -4.544167753626649, -27.00929261022487, -30.02867243718392, -26.481071843023084, 13.522864755291804, -17.926639472635348, -26.055270224399905, -10.296351993576298, -2.417438563795672, -10.995067202506949, 0.48590094430664754, -30.14248953417102], "policy_predator_policy_reward": [-6.812131373540353, 13.36488375566042, 3.7244321440807493, 25.35557333098234, 12.447401416495739, 17.190048418192116, 30.281904369111263, 21.574026373555217, 5.343578309214951, 4.046212369932724, 13.795858134636855, -7.57802399315203, -2.6884055579013495, -9.592734050703893, 0.9942970641360649, -11.789190699147746, 8.551605327361388, -6.446431822206419, 18.919330720913646, 21.523418406929757, -5.615149083359604, 5.047509837211955, 4.483343851991309, -6.553005072646988, 13.875537101521743, -2.2017175824060153, 13.362145200208719, 16.840134395518444, 7.222861048044909, 27.400109269411193, 23.5041911069668, -4.2187145840530444, 9.243062784899745, 11.867376803704417, 17.3778678387097, 30.17307211726294, 38.76197311119491, 20.817026065272845, 13.374414582220393, -3.2860411017384887, 19.93273490966466, 19.57811180948149, 15.197042636692657, 14.672525449453998, -6.212114036453382, 18.403032591421578, 8.796574082580834, -7.5818239855436165, 19.85350545778693, 3.2068195711716037, 40.6781592344649, 23.285218457415063, 10.500319189856839, 30.69497950071287, 21.266081413690266, 8.41138193770008, 5.23742018971979, 16.349796731904352, 13.054564476719037, 10.388016770418293, -2.0263475575457908, 22.229568992777125, 35.32005463329589, 20.954141075087506, -7.1060613772793335, -9.016223456571309, 9.440094201021882, 5.994748352219606, 22.945497107689416, 35.07160412329662, 24.12169283385122, 8.966380613867955, 15.990576667870798, 41.801546758950714, 10.214538817372507, 18.27732201093617, -2.8725579119733298, 27.50624105309893, 2.6215708044610615, -1.9008185087062568, -8.144497936199866, -0.7735688969349228, -7.709980846212421, 8.765202759992158, 36.054406203135805, 38.792870725661714, 43.0633647551149, 39.388801452856086, 15.441229574411683, 22.805576009370093, -4.4547546004292276, -0.9677398311855292, 34.135737939100125, 33.35648088197661, 16.14065267108048, 35.42479202670363, 15.447964634342695, 9.846376863060309, 23.09211050044147, 38.29452103103182, -3.825035501401139, 11.28665971461179, 1.0308762681935377, 18.15301137264281, 1.8110547969103141, -7.25780898838347, 9.661081298361832, 21.000232751099638, 31.198457665855702, 46.67073523820911, 30.229623776794806, -1.1039994480051316, 5.810540566605937, 3.8051883496699155, 11.853221290467662, 7.938533175327322, -20.230849351641705, -14.394304990066196, -3.555754863977839, 13.985687404408125, 32.878883242329394, 24.88500348248586, 20.18487791473065, 6.461486395114202, 19.5136426996196, 20.00364462613809, -0.21290588968299495, 27.506768891416726, 27.703613484263016, 3.9765727172291356, 29.191084347004594, 19.48964596060523, 22.703008309844968, 20.184802912682432, 29.843256693739672, 25.15430767645035, 5.391417471488932, 13.605906827535238, 9.387493641039832, -3.0549355671506238, 23.55340266370716, -1.2256447576421463, 33.43671113123101, 38.19116629816121, 30.196028163322058, 20.152267931596413, 1.5566025164939785, 16.064528412945045, 22.788409930912966, 10.441841104363288, 15.980877189850588, -11.55148644612304, 10.041520975061093, 32.00328696229162, -11.305992843957167, 16.17884752674217, 19.565428752646238, 0.7020785652857455, 7.646719916190017, -3.9096248897142942, 16.992010063987415, 29.646221862977317, 6.223303458445775, 10.253976261388502, 14.188785003911068, -3.7773158540237937, 24.938876911222945, 14.04242691465823, 3.056688279927858, 10.46848532288382, 11.307492253045917, 18.476742106886224, 17.27869101816664, 36.29625296775721, 21.930401658528982, 42.14892471421058, 0.0002800962668096929, 9.08805541098649, 20.27018452249657, 33.74840069795315, 15.06127378615332, 44.99607108821452, 5.679033659606873, 47.28311002643929, -7.856636075109183, -19.189093435474422, 34.216798284208856, 1.6364806610618334, 32.51089554331621, 19.59964490548362, 24.601095722301785, -4.008391735149203, 14.078742711453298, -9.243865583861957, 12.169926484849086, 9.820207920164831, -0.16623645266891351, -0.8055654359443984, 30.0458980131622, 30.239081055179792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6251388472070294, "mean_inference_ms": 1.6672271944036872, "mean_action_processing_ms": 0.2569273272635394, "mean_env_wait_ms": 0.1446535973091514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042612552642822266, "StateBufferConnector_ms": 0.004066824913024902, "ViewRequirementAgentConnector_ms": 0.12369143962860107}, "num_episodes": 18, "episode_return_max": 41.226083103985516, "episode_return_min": -17.312577170853945, "episode_return_mean": 13.712730810776907, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.56433130815964, "num_env_steps_trained_throughput_per_sec": 322.56433130815964, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1740000, "timers": {"training_iteration_time_ms": 11161.307, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11161.148, "sample_time_ms": 1507.785, "learn_time_ms": 9629.227, "learn_throughput": 415.402, "synch_weights_time_ms": 21.698}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "done": false, "training_iteration": 145, "trial_id": "06536_00000", "date": "2024-08-11_17-40-35", "timestamp": 1723412435, "time_this_iter_s": 12.43869686126709, "time_total_s": 3975.0280652046204, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317ee790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3975.0280652046204, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 55.57058823529412, "ram_util_percent": 83.22941176470587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.946747641265392, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5357863653451203, "policy_loss": -0.00521976924695385, "vf_loss": 2.541006138299902, "vf_explained_var": 0.9321626403058568, "kl": 0.006281267888539347, "entropy": 0.3110279887293776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.00032251511932, "cur_kl_coeff": 1.9387045606711582e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1460192680358885, "policy_loss": -0.002837400779955917, "vf_loss": 3.148856668623667, "vf_explained_var": 0.918853019375019, "kl": 0.002684678605522414, "entropy": 0.1766970756271529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "env_runners": {"episode_reward_max": 41.226083103985516, "episode_reward_min": -17.312577170853945, "episode_reward_mean": 14.84262961302589, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.22608310398548, "predator_policy": -20.230849351641705}, "policy_reward_max": {"prey_policy": 17.31257717085395, "predator_policy": 47.28311002643929}, "policy_reward_mean": {"prey_policy": -14.842629613025892, "predator_policy": 14.842629613025892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.607375048518624, 11.530162514479278, 31.981688845939985, 20.59764934528485, 14.838731675695156, 10.793608460812083, 11.72129062356866, 10.101610717615676, 28.137097854191666, -8.061142416925323, 7.717421276620719, 29.00855061549303, 16.544036723859584, 28.896061713410766, 14.245930414154332, 12.31684157056281, 0.3603761478774006, -4.459033416567384, 0.5276109568898777, 37.423638464398756, 41.226083103985516, 19.123402791890904, -2.711247215807388, 33.74610941053836, 25.78272234889207, 12.6471707487015, 30.693315765736656, 3.7308121066053275, 9.591943820418166, -2.7233770957365726, 15.330657024730753, 38.93459645203237, 14.562812164394822, 4.807864458137944, 9.895877232897497, -17.312577170853945, 5.214966270215163, 28.88194336240765, 13.323182154922437, 19.75864366287885, 13.646931500866863, 15.840093100746065, 24.340365153804917, 21.44390561126372, 27.498782185095006, 9.498662149512073, 3.1662790369446014, 11.163878953032475, 35.8139387146961, 25.17414804745923, 8.810565464719513, 16.61512551763813, 2.2146953718637796, 21.02240396867635, 2.436427341392495, 10.133753658965986, 1.8685475132378517, 23.319115963482357, 8.23863985991713, 5.205734574943644, 19.49065191294056, 6.762586801405842, 14.892117179966073, 26.78747199296192, 32.039663186369786, 4.544167753626659, 27.00929261022487, 30.02867243718392, 26.481071843023088, -13.522864755291797, 17.926639472635312, 26.05527022439991, 10.296351993576279, 2.4174385637956455, 10.995067202506972, -0.48590094430664443, 30.142489534170977, 8.67912297504563, 34.16377138310205, -3.7468091605116665, 3.0893117218706863, 29.92718920696432, 25.95962059639919, 14.958539245103449, -1.1712361421961646, -2.986586642766788, 16.66210320895752, 30.784033736407157, 3.8234771435048183, -4.008139734085231, 4.247870679905406, 27.35716304573493, 15.60435713901248, 40.69656964725688, 3.096573574339846, 16.919642213211716, 32.62593492064532, 27.219662015175828, 8.671987502076517, 13.042213797119091], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.6073750485186107, -11.530162514479269, -31.981688845940006, -20.597649345284843, -14.838731675695183, -10.793608460812091, -11.72129062356866, -10.101610717615678, -28.137097854191676, 8.061142416925321, -7.717421276620735, -29.00855061549301, -16.54403672385959, -28.89606171341076, -14.245930414154316, -12.316841570562815, -0.3603761478774068, 4.459033416567392, -0.5276109568898679, -37.42363846439876, -41.22608310398548, -19.123402791890864, 2.7112472158074086, -33.74610941053838, -25.78272234889206, -12.647170748701502, -30.693315765736642, -3.7308121066053186, -9.59194382041816, 2.7233770957365886, -15.330657024730737, -38.93459645203239, -14.562812164394835, -4.807864458137907, -9.895877232897508, 17.31257717085395, -5.214966270215143, -28.881943362407604, -13.323182154922417, -19.75864366287886, -13.646931500866879, -15.840093100746074, -24.3403651538049, -21.44390561126371, -27.49878218509501, -9.498662149512082, -3.1662790369446157, -11.163878953032496, -35.81393871469611, -25.174148047459234, -8.81056546471951, -16.61512551763814, -2.2146953718637725, -21.022403968676354, -2.436427341392519, -10.133753658965988, -1.868547513237881, -23.31911596348236, -8.238639859917132, -5.205734574943624, -19.490651912940624, -6.762586801405837, -14.892117179966071, -26.787471992961976, -32.03966318636978, -4.544167753626649, -27.00929261022487, -30.02867243718392, -26.481071843023084, 13.522864755291804, -17.926639472635348, -26.055270224399905, -10.296351993576298, -2.417438563795672, -10.995067202506949, 0.48590094430664754, -30.14248953417102, -8.67912297504563, -34.16377138310204, 3.7468091605116687, -3.089311721870679, -29.927189206964247, -25.959620596399194, -14.958539245103445, 1.17123614219617, 2.98658664276679, -16.662103208957546, -30.78403373640709, -3.8234771435048165, 4.008139734085232, -4.247870679905406, -27.357163045734925, -15.604357139012492, -40.69656964725687, -3.096573574339864, -16.91964221321175, -32.62593492064531, -27.21966201517582, -8.671987502076508, -13.042213797119093], "policy_predator_policy_reward": [8.796574082580834, -7.5818239855436165, 19.85350545778693, 3.2068195711716037, 40.6781592344649, 23.285218457415063, 10.500319189856839, 30.69497950071287, 21.266081413690266, 8.41138193770008, 5.23742018971979, 16.349796731904352, 13.054564476719037, 10.388016770418293, -2.0263475575457908, 22.229568992777125, 35.32005463329589, 20.954141075087506, -7.1060613772793335, -9.016223456571309, 9.440094201021882, 5.994748352219606, 22.945497107689416, 35.07160412329662, 24.12169283385122, 8.966380613867955, 15.990576667870798, 41.801546758950714, 10.214538817372507, 18.27732201093617, -2.8725579119733298, 27.50624105309893, 2.6215708044610615, -1.9008185087062568, -8.144497936199866, -0.7735688969349228, -7.709980846212421, 8.765202759992158, 36.054406203135805, 38.792870725661714, 43.0633647551149, 39.388801452856086, 15.441229574411683, 22.805576009370093, -4.4547546004292276, -0.9677398311855292, 34.135737939100125, 33.35648088197661, 16.14065267108048, 35.42479202670363, 15.447964634342695, 9.846376863060309, 23.09211050044147, 38.29452103103182, -3.825035501401139, 11.28665971461179, 1.0308762681935377, 18.15301137264281, 1.8110547969103141, -7.25780898838347, 9.661081298361832, 21.000232751099638, 31.198457665855702, 46.67073523820911, 30.229623776794806, -1.1039994480051316, 5.810540566605937, 3.8051883496699155, 11.853221290467662, 7.938533175327322, -20.230849351641705, -14.394304990066196, -3.555754863977839, 13.985687404408125, 32.878883242329394, 24.88500348248586, 20.18487791473065, 6.461486395114202, 19.5136426996196, 20.00364462613809, -0.21290588968299495, 27.506768891416726, 27.703613484263016, 3.9765727172291356, 29.191084347004594, 19.48964596060523, 22.703008309844968, 20.184802912682432, 29.843256693739672, 25.15430767645035, 5.391417471488932, 13.605906827535238, 9.387493641039832, -3.0549355671506238, 23.55340266370716, -1.2256447576421463, 33.43671113123101, 38.19116629816121, 30.196028163322058, 20.152267931596413, 1.5566025164939785, 16.064528412945045, 22.788409930912966, 10.441841104363288, 15.980877189850588, -11.55148644612304, 10.041520975061093, 32.00328696229162, -11.305992843957167, 16.17884752674217, 19.565428752646238, 0.7020785652857455, 7.646719916190017, -3.9096248897142942, 16.992010063987415, 29.646221862977317, 6.223303458445775, 10.253976261388502, 14.188785003911068, -3.7773158540237937, 24.938876911222945, 14.04242691465823, 3.056688279927858, 10.46848532288382, 11.307492253045917, 18.476742106886224, 17.27869101816664, 36.29625296775721, 21.930401658528982, 42.14892471421058, 0.0002800962668096929, 9.08805541098649, 20.27018452249657, 33.74840069795315, 15.06127378615332, 44.99607108821452, 5.679033659606873, 47.28311002643929, -7.856636075109183, -19.189093435474422, 34.216798284208856, 1.6364806610618334, 32.51089554331621, 19.59964490548362, 24.601095722301785, -4.008391735149203, 14.078742711453298, -9.243865583861957, 12.169926484849086, 9.820207920164831, -0.16623645266891351, -0.8055654359443984, 30.0458980131622, 30.239081055179792, 2.2676115161076584, 15.090634433983602, 38.37853097601772, 29.949011790186336, -4.520167277192856, -2.973451043830467, 14.604826737151239, -8.42620329340987, 36.225466568965274, 23.628911844963326, 7.73808771608765, 44.181153476710755, 22.896003406555906, 7.02107508365099, 2.868984673701389, -5.211456958093713, -0.4309926489387621, -5.542180636594814, 22.652058389802527, 10.67214802811253, 33.80846058059422, 27.759606892219995, 15.55920113890696, -7.912246851897336, -1.979459874000879, -6.036819594169588, 4.4912520064660235, 4.0044893533447885, 24.81209232609047, 29.90223376537938, 28.371911639850264, 2.8368026381746905, 35.11972742180475, 46.27341187270901, 0.6543733285194868, 5.538773820160241, 19.5519556429051, 14.287328783518399, 27.77674140730918, 37.47512843398143, 34.26863310140458, 20.170690928947067, 19.502114530568637, -2.158139526415615, 4.289485663747808, 21.794941930490424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.624587833743732, "mean_inference_ms": 1.6692852097961088, "mean_action_processing_ms": 0.256726204361184, "mean_env_wait_ms": 0.14459226870254763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036246776580810547, "StateBufferConnector_ms": 0.0030802488327026367, "ViewRequirementAgentConnector_ms": 0.10981273651123047}, "num_episodes": 23, "episode_return_max": 41.226083103985516, "episode_return_min": -17.312577170853945, "episode_return_mean": 14.84262961302589, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.58287116791666, "num_env_steps_trained_throughput_per_sec": 329.58287116791666, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 11244.589, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11244.418, "sample_time_ms": 1406.658, "learn_time_ms": 9811.281, "learn_throughput": 407.694, "synch_weights_time_ms": 24.177}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "training_iteration": 146, "trial_id": "06536_00000", "date": "2024-08-11_17-40-47", "timestamp": 1723412447, "time_this_iter_s": 12.167150020599365, "time_total_s": 3987.1952152252197, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331792ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3987.1952152252197, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 48.75555555555556, "ram_util_percent": 83.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9605899528910715, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2062800689289968, "policy_loss": -0.008403627455603175, "vf_loss": 2.214683700228731, "vf_explained_var": 0.9421155530338486, "kl": 0.006473966651160973, "entropy": 0.30662733249676727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9331107658683937, "cur_kl_coeff": 9.693522803355791e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0599840846641984, "policy_loss": -0.0017019823548339661, "vf_loss": 3.0616860673541115, "vf_explained_var": 0.9205639690633804, "kl": 0.0030220269802828477, "entropy": 0.20834822076811363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "env_runners": {"episode_reward_max": 40.69656964725688, "episode_reward_min": -17.312577170853945, "episode_reward_mean": 15.92161756902179, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.69656964725687, "predator_policy": -20.230849351641705}, "policy_reward_max": {"prey_policy": 17.31257717085395, "predator_policy": 47.28311002643929}, "policy_reward_mean": {"prey_policy": -15.921617569021791, "predator_policy": 15.921617569021791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.711247215807388, 33.74610941053836, 25.78272234889207, 12.6471707487015, 30.693315765736656, 3.7308121066053275, 9.591943820418166, -2.7233770957365726, 15.330657024730753, 38.93459645203237, 14.562812164394822, 4.807864458137944, 9.895877232897497, -17.312577170853945, 5.214966270215163, 28.88194336240765, 13.323182154922437, 19.75864366287885, 13.646931500866863, 15.840093100746065, 24.340365153804917, 21.44390561126372, 27.498782185095006, 9.498662149512073, 3.1662790369446014, 11.163878953032475, 35.8139387146961, 25.17414804745923, 8.810565464719513, 16.61512551763813, 2.2146953718637796, 21.02240396867635, 2.436427341392495, 10.133753658965986, 1.8685475132378517, 23.319115963482357, 8.23863985991713, 5.205734574943644, 19.49065191294056, 6.762586801405842, 14.892117179966073, 26.78747199296192, 32.039663186369786, 4.544167753626659, 27.00929261022487, 30.02867243718392, 26.481071843023088, -13.522864755291797, 17.926639472635312, 26.05527022439991, 10.296351993576279, 2.4174385637956455, 10.995067202506972, -0.48590094430664443, 30.142489534170977, 8.67912297504563, 34.16377138310205, -3.7468091605116665, 3.0893117218706863, 29.92718920696432, 25.95962059639919, 14.958539245103449, -1.1712361421961646, -2.986586642766788, 16.66210320895752, 30.784033736407157, 3.8234771435048183, -4.008139734085231, 4.247870679905406, 27.35716304573493, 15.60435713901248, 40.69656964725688, 3.096573574339846, 16.919642213211716, 32.62593492064532, 27.219662015175828, 8.671987502076517, 13.042213797119091, 26.901744090096834, 1.1638926308030033, 30.511177700190174, 31.251264998552315, 20.68792272927812, 16.964068410093862, 24.373723333095747, 20.516707539251176, 30.90907016893189, 13.920775410633489, 10.230969325456705, 11.815205494143392, 18.76136250665913, 22.147662607153688, 18.77189544437484, 22.59168931660407, 28.016664681741993, 14.617804227363564, 6.612461539681542, 24.11308897667233, 36.83554729034797, 11.36309021022086], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.7112472158074086, -33.74610941053838, -25.78272234889206, -12.647170748701502, -30.693315765736642, -3.7308121066053186, -9.59194382041816, 2.7233770957365886, -15.330657024730737, -38.93459645203239, -14.562812164394835, -4.807864458137907, -9.895877232897508, 17.31257717085395, -5.214966270215143, -28.881943362407604, -13.323182154922417, -19.75864366287886, -13.646931500866879, -15.840093100746074, -24.3403651538049, -21.44390561126371, -27.49878218509501, -9.498662149512082, -3.1662790369446157, -11.163878953032496, -35.81393871469611, -25.174148047459234, -8.81056546471951, -16.61512551763814, -2.2146953718637725, -21.022403968676354, -2.436427341392519, -10.133753658965988, -1.868547513237881, -23.31911596348236, -8.238639859917132, -5.205734574943624, -19.490651912940624, -6.762586801405837, -14.892117179966071, -26.787471992961976, -32.03966318636978, -4.544167753626649, -27.00929261022487, -30.02867243718392, -26.481071843023084, 13.522864755291804, -17.926639472635348, -26.055270224399905, -10.296351993576298, -2.417438563795672, -10.995067202506949, 0.48590094430664754, -30.14248953417102, -8.67912297504563, -34.16377138310204, 3.7468091605116687, -3.089311721870679, -29.927189206964247, -25.959620596399194, -14.958539245103445, 1.17123614219617, 2.98658664276679, -16.662103208957546, -30.78403373640709, -3.8234771435048165, 4.008139734085232, -4.247870679905406, -27.357163045734925, -15.604357139012492, -40.69656964725687, -3.096573574339864, -16.91964221321175, -32.62593492064531, -27.21966201517582, -8.671987502076508, -13.042213797119093, -26.901744090096823, -1.1638926308029962, -30.51117770019018, -31.25126499855233, -20.687922729278167, -16.96406841009386, -24.373723333095764, -20.516707539251176, -30.909070168931827, -13.920775410633484, -10.230969325456721, -11.815205494143386, -18.761362506659136, -22.14766260715369, -18.77189544437493, -22.591689316604054, -28.016664681741947, -14.617804227363548, -6.612461539681562, -24.113088976672326, -36.83554729034796, -11.363090210220863], "policy_predator_policy_reward": [-4.4547546004292276, -0.9677398311855292, 34.135737939100125, 33.35648088197661, 16.14065267108048, 35.42479202670363, 15.447964634342695, 9.846376863060309, 23.09211050044147, 38.29452103103182, -3.825035501401139, 11.28665971461179, 1.0308762681935377, 18.15301137264281, 1.8110547969103141, -7.25780898838347, 9.661081298361832, 21.000232751099638, 31.198457665855702, 46.67073523820911, 30.229623776794806, -1.1039994480051316, 5.810540566605937, 3.8051883496699155, 11.853221290467662, 7.938533175327322, -20.230849351641705, -14.394304990066196, -3.555754863977839, 13.985687404408125, 32.878883242329394, 24.88500348248586, 20.18487791473065, 6.461486395114202, 19.5136426996196, 20.00364462613809, -0.21290588968299495, 27.506768891416726, 27.703613484263016, 3.9765727172291356, 29.191084347004594, 19.48964596060523, 22.703008309844968, 20.184802912682432, 29.843256693739672, 25.15430767645035, 5.391417471488932, 13.605906827535238, 9.387493641039832, -3.0549355671506238, 23.55340266370716, -1.2256447576421463, 33.43671113123101, 38.19116629816121, 30.196028163322058, 20.152267931596413, 1.5566025164939785, 16.064528412945045, 22.788409930912966, 10.441841104363288, 15.980877189850588, -11.55148644612304, 10.041520975061093, 32.00328696229162, -11.305992843957167, 16.17884752674217, 19.565428752646238, 0.7020785652857455, 7.646719916190017, -3.9096248897142942, 16.992010063987415, 29.646221862977317, 6.223303458445775, 10.253976261388502, 14.188785003911068, -3.7773158540237937, 24.938876911222945, 14.04242691465823, 3.056688279927858, 10.46848532288382, 11.307492253045917, 18.476742106886224, 17.27869101816664, 36.29625296775721, 21.930401658528982, 42.14892471421058, 0.0002800962668096929, 9.08805541098649, 20.27018452249657, 33.74840069795315, 15.06127378615332, 44.99607108821452, 5.679033659606873, 47.28311002643929, -7.856636075109183, -19.189093435474422, 34.216798284208856, 1.6364806610618334, 32.51089554331621, 19.59964490548362, 24.601095722301785, -4.008391735149203, 14.078742711453298, -9.243865583861957, 12.169926484849086, 9.820207920164831, -0.16623645266891351, -0.8055654359443984, 30.0458980131622, 30.239081055179792, 2.2676115161076584, 15.090634433983602, 38.37853097601772, 29.949011790186336, -4.520167277192856, -2.973451043830467, 14.604826737151239, -8.42620329340987, 36.225466568965274, 23.628911844963326, 7.73808771608765, 44.181153476710755, 22.896003406555906, 7.02107508365099, 2.868984673701389, -5.211456958093713, -0.4309926489387621, -5.542180636594814, 22.652058389802527, 10.67214802811253, 33.80846058059422, 27.759606892219995, 15.55920113890696, -7.912246851897336, -1.979459874000879, -6.036819594169588, 4.4912520064660235, 4.0044893533447885, 24.81209232609047, 29.90223376537938, 28.371911639850264, 2.8368026381746905, 35.11972742180475, 46.27341187270901, 0.6543733285194868, 5.538773820160241, 19.5519556429051, 14.287328783518399, 27.77674140730918, 37.47512843398143, 34.26863310140458, 20.170690928947067, 19.502114530568637, -2.158139526415615, 4.289485663747808, 21.794941930490424, 12.142923582071912, 41.66056459812171, -3.5943328385380546, 5.922118100144054, 40.94043289557404, 20.081922504806336, 31.835114782678893, 30.667415214425787, 27.996885652004487, 13.378959806551777, 10.400853881200083, 23.527282938987614, 24.74131050782302, 24.006136158368484, 13.568539692289868, 27.464875386212487, 24.815739505850146, 37.002400832013585, 15.320034097346229, 12.521516723920737, -0.2524273214353272, 20.71436597234875, 13.343702069005014, 10.286708919281775, 18.861602916082205, 18.661122097236056, 20.37349130997223, 23.921833904335127, 9.730004760987466, 27.813786127762334, 18.145922864104733, 27.037455769103367, 27.692583371921785, 28.34074599156211, 18.929044079107165, 10.306564375619946, 17.91447392289158, -4.689550843528444, 9.35525088872863, 38.870927064616026, 39.04784910385533, 34.62324547684063, 22.450606819680143, 0.2755736007615681]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6238250634925672, "mean_inference_ms": 1.6696658894422711, "mean_action_processing_ms": 0.2563664274485684, "mean_env_wait_ms": 0.14449337691846414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036443471908569336, "StateBufferConnector_ms": 0.00303804874420166, "ViewRequirementAgentConnector_ms": 0.10961389541625977}, "num_episodes": 22, "episode_return_max": 40.69656964725688, "episode_return_min": -17.312577170853945, "episode_return_mean": 15.92161756902179, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.95290445161334, "num_env_steps_trained_throughput_per_sec": 330.95290445161334, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1764000, "timers": {"training_iteration_time_ms": 11424.141, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11423.965, "sample_time_ms": 1406.332, "learn_time_ms": 9990.826, "learn_throughput": 400.367, "synch_weights_time_ms": 24.422}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "done": false, "training_iteration": 147, "trial_id": "06536_00000", "date": "2024-08-11_17-40-59", "timestamp": 1723412459, "time_this_iter_s": 12.123842239379883, "time_total_s": 3999.3190574645996, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317c1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3999.3190574645996, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 46.0, "ram_util_percent": 83.05882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8775622874498366, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.291447862734397, "policy_loss": -0.003663881472311914, "vf_loss": 2.2951117429882286, "vf_explained_var": 0.9421191126108169, "kl": 0.0038302354643159416, "entropy": 0.2880313573870808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.115891533301621, "cur_kl_coeff": 4.8467614016778955e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.713405866219253, "policy_loss": -0.002787466928678215, "vf_loss": 2.716193334955387, "vf_explained_var": 0.9376878777824381, "kl": 0.004886233624132665, "entropy": 0.1966137175955785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 42.17752302028625, "episode_reward_min": -13.522864755291797, "episode_reward_mean": 17.6341853108548, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.17752302028611, "predator_policy": -19.189093435474422}, "policy_reward_max": {"prey_policy": 13.522864755291804, "predator_policy": 47.28311002643929}, "policy_reward_mean": {"prey_policy": -17.6341853108548, "predator_policy": 17.6341853108548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.646931500866863, 15.840093100746065, 24.340365153804917, 21.44390561126372, 27.498782185095006, 9.498662149512073, 3.1662790369446014, 11.163878953032475, 35.8139387146961, 25.17414804745923, 8.810565464719513, 16.61512551763813, 2.2146953718637796, 21.02240396867635, 2.436427341392495, 10.133753658965986, 1.8685475132378517, 23.319115963482357, 8.23863985991713, 5.205734574943644, 19.49065191294056, 6.762586801405842, 14.892117179966073, 26.78747199296192, 32.039663186369786, 4.544167753626659, 27.00929261022487, 30.02867243718392, 26.481071843023088, -13.522864755291797, 17.926639472635312, 26.05527022439991, 10.296351993576279, 2.4174385637956455, 10.995067202506972, -0.48590094430664443, 30.142489534170977, 8.67912297504563, 34.16377138310205, -3.7468091605116665, 3.0893117218706863, 29.92718920696432, 25.95962059639919, 14.958539245103449, -1.1712361421961646, -2.986586642766788, 16.66210320895752, 30.784033736407157, 3.8234771435048183, -4.008139734085231, 4.247870679905406, 27.35716304573493, 15.60435713901248, 40.69656964725688, 3.096573574339846, 16.919642213211716, 32.62593492064532, 27.219662015175828, 8.671987502076517, 13.042213797119091, 26.901744090096834, 1.1638926308030033, 30.511177700190174, 31.251264998552315, 20.68792272927812, 16.964068410093862, 24.373723333095747, 20.516707539251176, 30.90907016893189, 13.920775410633489, 10.230969325456705, 11.815205494143392, 18.76136250665913, 22.147662607153688, 18.77189544437484, 22.59168931660407, 28.016664681741993, 14.617804227363564, 6.612461539681542, 24.11308897667233, 36.83554729034797, 11.36309021022086, 32.311169419832595, 33.038043890747716, 30.779689992541744, 25.48270659758169, 17.590656299689947, 5.715067275295854, 20.81410572925349, -5.231065871973721, 20.162650391510383, 36.97430638938127, 42.17752302028625, 26.36898346573286, 15.885221947106325, 24.622276934262402, 17.045166817713643, 28.375362041988552, 32.65879581110238, 10.641529532359334], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.646931500866879, -15.840093100746074, -24.3403651538049, -21.44390561126371, -27.49878218509501, -9.498662149512082, -3.1662790369446157, -11.163878953032496, -35.81393871469611, -25.174148047459234, -8.81056546471951, -16.61512551763814, -2.2146953718637725, -21.022403968676354, -2.436427341392519, -10.133753658965988, -1.868547513237881, -23.31911596348236, -8.238639859917132, -5.205734574943624, -19.490651912940624, -6.762586801405837, -14.892117179966071, -26.787471992961976, -32.03966318636978, -4.544167753626649, -27.00929261022487, -30.02867243718392, -26.481071843023084, 13.522864755291804, -17.926639472635348, -26.055270224399905, -10.296351993576298, -2.417438563795672, -10.995067202506949, 0.48590094430664754, -30.14248953417102, -8.67912297504563, -34.16377138310204, 3.7468091605116687, -3.089311721870679, -29.927189206964247, -25.959620596399194, -14.958539245103445, 1.17123614219617, 2.98658664276679, -16.662103208957546, -30.78403373640709, -3.8234771435048165, 4.008139734085232, -4.247870679905406, -27.357163045734925, -15.604357139012492, -40.69656964725687, -3.096573574339864, -16.91964221321175, -32.62593492064531, -27.21966201517582, -8.671987502076508, -13.042213797119093, -26.901744090096823, -1.1638926308029962, -30.51117770019018, -31.25126499855233, -20.687922729278167, -16.96406841009386, -24.373723333095764, -20.516707539251176, -30.909070168931827, -13.920775410633484, -10.230969325456721, -11.815205494143386, -18.761362506659136, -22.14766260715369, -18.77189544437493, -22.591689316604054, -28.016664681741947, -14.617804227363548, -6.612461539681562, -24.113088976672326, -36.83554729034796, -11.363090210220863, -32.31116941983257, -33.03804389074773, -30.779689992541744, -25.482706597581714, -17.590656299689932, -5.715067275295848, -20.814105729253498, 5.231065871973728, -20.162650391510372, -36.97430638938131, -42.17752302028611, -26.368983465732878, -15.885221947106299, -24.622276934262363, -17.045166817713643, -28.375362041988602, -32.65879581110239, -10.641529532359321], "policy_predator_policy_reward": [-0.21290588968299495, 27.506768891416726, 27.703613484263016, 3.9765727172291356, 29.191084347004594, 19.48964596060523, 22.703008309844968, 20.184802912682432, 29.843256693739672, 25.15430767645035, 5.391417471488932, 13.605906827535238, 9.387493641039832, -3.0549355671506238, 23.55340266370716, -1.2256447576421463, 33.43671113123101, 38.19116629816121, 30.196028163322058, 20.152267931596413, 1.5566025164939785, 16.064528412945045, 22.788409930912966, 10.441841104363288, 15.980877189850588, -11.55148644612304, 10.041520975061093, 32.00328696229162, -11.305992843957167, 16.17884752674217, 19.565428752646238, 0.7020785652857455, 7.646719916190017, -3.9096248897142942, 16.992010063987415, 29.646221862977317, 6.223303458445775, 10.253976261388502, 14.188785003911068, -3.7773158540237937, 24.938876911222945, 14.04242691465823, 3.056688279927858, 10.46848532288382, 11.307492253045917, 18.476742106886224, 17.27869101816664, 36.29625296775721, 21.930401658528982, 42.14892471421058, 0.0002800962668096929, 9.08805541098649, 20.27018452249657, 33.74840069795315, 15.06127378615332, 44.99607108821452, 5.679033659606873, 47.28311002643929, -7.856636075109183, -19.189093435474422, 34.216798284208856, 1.6364806610618334, 32.51089554331621, 19.59964490548362, 24.601095722301785, -4.008391735149203, 14.078742711453298, -9.243865583861957, 12.169926484849086, 9.820207920164831, -0.16623645266891351, -0.8055654359443984, 30.0458980131622, 30.239081055179792, 2.2676115161076584, 15.090634433983602, 38.37853097601772, 29.949011790186336, -4.520167277192856, -2.973451043830467, 14.604826737151239, -8.42620329340987, 36.225466568965274, 23.628911844963326, 7.73808771608765, 44.181153476710755, 22.896003406555906, 7.02107508365099, 2.868984673701389, -5.211456958093713, -0.4309926489387621, -5.542180636594814, 22.652058389802527, 10.67214802811253, 33.80846058059422, 27.759606892219995, 15.55920113890696, -7.912246851897336, -1.979459874000879, -6.036819594169588, 4.4912520064660235, 4.0044893533447885, 24.81209232609047, 29.90223376537938, 28.371911639850264, 2.8368026381746905, 35.11972742180475, 46.27341187270901, 0.6543733285194868, 5.538773820160241, 19.5519556429051, 14.287328783518399, 27.77674140730918, 37.47512843398143, 34.26863310140458, 20.170690928947067, 19.502114530568637, -2.158139526415615, 4.289485663747808, 21.794941930490424, 12.142923582071912, 41.66056459812171, -3.5943328385380546, 5.922118100144054, 40.94043289557404, 20.081922504806336, 31.835114782678893, 30.667415214425787, 27.996885652004487, 13.378959806551777, 10.400853881200083, 23.527282938987614, 24.74131050782302, 24.006136158368484, 13.568539692289868, 27.464875386212487, 24.815739505850146, 37.002400832013585, 15.320034097346229, 12.521516723920737, -0.2524273214353272, 20.71436597234875, 13.343702069005014, 10.286708919281775, 18.861602916082205, 18.661122097236056, 20.37349130997223, 23.921833904335127, 9.730004760987466, 27.813786127762334, 18.145922864104733, 27.037455769103367, 27.692583371921785, 28.34074599156211, 18.929044079107165, 10.306564375619946, 17.91447392289158, -4.689550843528444, 9.35525088872863, 38.870927064616026, 39.04784910385533, 34.62324547684063, 22.450606819680143, 0.2755736007615681, 19.657170921305102, 44.96516791836007, 22.844494514958637, 43.23159326653682, 34.249294881686225, 27.310085103397288, 25.80290457305561, 25.162508622107822, 24.273186555952897, 10.908126043426982, -2.670141764452623, 14.100276315044308, 19.209715932644944, 22.418495525862035, 0.46189060848140073, -10.92402235242886, 20.067894740118454, 20.25740604290226, 35.73987620340104, 38.20873657536153, 42.89140470795101, 41.46364133262129, 21.773973934080615, 30.963992997385105, 12.629555033801024, 19.140888860411557, 14.052898708685198, 35.19165515983956, 19.06754733425085, 15.022786301176431, 24.61618165528118, 32.13454242869596, 22.541508087424432, 42.77608353478034, 3.1957101373850607, 18.08734892733359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6235696072844681, "mean_inference_ms": 1.672210267208332, "mean_action_processing_ms": 0.25632117542806826, "mean_env_wait_ms": 0.14444613671963624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033833980560302734, "StateBufferConnector_ms": 0.00293731689453125, "ViewRequirementAgentConnector_ms": 0.09557604789733887}, "num_episodes": 18, "episode_return_max": 42.17752302028625, "episode_return_min": -13.522864755291797, "episode_return_mean": 17.6341853108548, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.6358090889975, "num_env_steps_trained_throughput_per_sec": 329.6358090889975, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 11553.109, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11552.98, "sample_time_ms": 1340.083, "learn_time_ms": 10188.949, "learn_throughput": 392.582, "synch_weights_time_ms": 21.881}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 148, "trial_id": "06536_00000", "date": "2024-08-11_17-41-11", "timestamp": 1723412471, "time_this_iter_s": 12.161540031433105, "time_total_s": 4011.4805974960327, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58e5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4011.4805974960327, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 48.17058823529412, "ram_util_percent": 83.18823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.826575463016828, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.142372823258241, "policy_loss": -0.0038672054378063574, "vf_loss": 2.1462400204191607, "vf_explained_var": 0.9260150988896688, "kl": 0.0031729260477533217, "entropy": 0.25679263967710236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6652015853180457, "cur_kl_coeff": 2.4233807008389477e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6510359836633874, "policy_loss": -0.001191529280151285, "vf_loss": 2.6522275061834426, "vf_explained_var": 0.9017865490345728, "kl": 0.0020881127979130894, "entropy": 0.169375260343785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "env_runners": {"episode_reward_max": 42.17752302028625, "episode_reward_min": -13.522864755291797, "episode_reward_mean": 18.503015837822453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -42.17752302028611, "predator_policy": -19.189093435474422}, "policy_reward_max": {"prey_policy": 13.522864755291804, "predator_policy": 47.28311002643929}, "policy_reward_mean": {"prey_policy": -18.50301583782245, "predator_policy": 18.50301583782245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.23863985991713, 5.205734574943644, 19.49065191294056, 6.762586801405842, 14.892117179966073, 26.78747199296192, 32.039663186369786, 4.544167753626659, 27.00929261022487, 30.02867243718392, 26.481071843023088, -13.522864755291797, 17.926639472635312, 26.05527022439991, 10.296351993576279, 2.4174385637956455, 10.995067202506972, -0.48590094430664443, 30.142489534170977, 8.67912297504563, 34.16377138310205, -3.7468091605116665, 3.0893117218706863, 29.92718920696432, 25.95962059639919, 14.958539245103449, -1.1712361421961646, -2.986586642766788, 16.66210320895752, 30.784033736407157, 3.8234771435048183, -4.008139734085231, 4.247870679905406, 27.35716304573493, 15.60435713901248, 40.69656964725688, 3.096573574339846, 16.919642213211716, 32.62593492064532, 27.219662015175828, 8.671987502076517, 13.042213797119091, 26.901744090096834, 1.1638926308030033, 30.511177700190174, 31.251264998552315, 20.68792272927812, 16.964068410093862, 24.373723333095747, 20.516707539251176, 30.90907016893189, 13.920775410633489, 10.230969325456705, 11.815205494143392, 18.76136250665913, 22.147662607153688, 18.77189544437484, 22.59168931660407, 28.016664681741993, 14.617804227363564, 6.612461539681542, 24.11308897667233, 36.83554729034797, 11.36309021022086, 32.311169419832595, 33.038043890747716, 30.779689992541744, 25.48270659758169, 17.590656299689947, 5.715067275295854, 20.81410572925349, -5.231065871973721, 20.162650391510383, 36.97430638938127, 42.17752302028625, 26.36898346573286, 15.885221947106325, 24.622276934262402, 17.045166817713643, 28.375362041988552, 32.65879581110238, 10.641529532359334, 13.243318619713136, 28.583729447542886, 32.73070978283569, 13.603678071271869, 2.257358909213865, 3.98581687788191, 22.544476245057155, 8.073600083400546, 3.8080194527652838, 10.051710129530946, 38.186632225286566, 27.518709229321082, 38.113755810921646, 19.64993159181315, 16.033154538056237, 30.092493509210342, 28.9081288750262, 23.505448551314245], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.238639859917132, -5.205734574943624, -19.490651912940624, -6.762586801405837, -14.892117179966071, -26.787471992961976, -32.03966318636978, -4.544167753626649, -27.00929261022487, -30.02867243718392, -26.481071843023084, 13.522864755291804, -17.926639472635348, -26.055270224399905, -10.296351993576298, -2.417438563795672, -10.995067202506949, 0.48590094430664754, -30.14248953417102, -8.67912297504563, -34.16377138310204, 3.7468091605116687, -3.089311721870679, -29.927189206964247, -25.959620596399194, -14.958539245103445, 1.17123614219617, 2.98658664276679, -16.662103208957546, -30.78403373640709, -3.8234771435048165, 4.008139734085232, -4.247870679905406, -27.357163045734925, -15.604357139012492, -40.69656964725687, -3.096573574339864, -16.91964221321175, -32.62593492064531, -27.21966201517582, -8.671987502076508, -13.042213797119093, -26.901744090096823, -1.1638926308029962, -30.51117770019018, -31.25126499855233, -20.687922729278167, -16.96406841009386, -24.373723333095764, -20.516707539251176, -30.909070168931827, -13.920775410633484, -10.230969325456721, -11.815205494143386, -18.761362506659136, -22.14766260715369, -18.77189544437493, -22.591689316604054, -28.016664681741947, -14.617804227363548, -6.612461539681562, -24.113088976672326, -36.83554729034796, -11.363090210220863, -32.31116941983257, -33.03804389074773, -30.779689992541744, -25.482706597581714, -17.590656299689932, -5.715067275295848, -20.814105729253498, 5.231065871973728, -20.162650391510372, -36.97430638938131, -42.17752302028611, -26.368983465732878, -15.885221947106299, -24.622276934262363, -17.045166817713643, -28.375362041988602, -32.65879581110239, -10.641529532359321, -13.243318619713156, -28.58372944754283, -32.73070978283569, -13.603678071271869, -2.257358909213865, -3.9858168778819194, -22.54447624505718, -8.073600083400546, -3.8080194527652864, -10.05171012953095, -38.1866322252866, -27.518709229321082, -38.113755810921596, -19.649931591813154, -16.033154538056245, -30.092493509210325, -28.908128875026133, -23.505448551314228], "policy_predator_policy_reward": [6.223303458445775, 10.253976261388502, 14.188785003911068, -3.7773158540237937, 24.938876911222945, 14.04242691465823, 3.056688279927858, 10.46848532288382, 11.307492253045917, 18.476742106886224, 17.27869101816664, 36.29625296775721, 21.930401658528982, 42.14892471421058, 0.0002800962668096929, 9.08805541098649, 20.27018452249657, 33.74840069795315, 15.06127378615332, 44.99607108821452, 5.679033659606873, 47.28311002643929, -7.856636075109183, -19.189093435474422, 34.216798284208856, 1.6364806610618334, 32.51089554331621, 19.59964490548362, 24.601095722301785, -4.008391735149203, 14.078742711453298, -9.243865583861957, 12.169926484849086, 9.820207920164831, -0.16623645266891351, -0.8055654359443984, 30.0458980131622, 30.239081055179792, 2.2676115161076584, 15.090634433983602, 38.37853097601772, 29.949011790186336, -4.520167277192856, -2.973451043830467, 14.604826737151239, -8.42620329340987, 36.225466568965274, 23.628911844963326, 7.73808771608765, 44.181153476710755, 22.896003406555906, 7.02107508365099, 2.868984673701389, -5.211456958093713, -0.4309926489387621, -5.542180636594814, 22.652058389802527, 10.67214802811253, 33.80846058059422, 27.759606892219995, 15.55920113890696, -7.912246851897336, -1.979459874000879, -6.036819594169588, 4.4912520064660235, 4.0044893533447885, 24.81209232609047, 29.90223376537938, 28.371911639850264, 2.8368026381746905, 35.11972742180475, 46.27341187270901, 0.6543733285194868, 5.538773820160241, 19.5519556429051, 14.287328783518399, 27.77674140730918, 37.47512843398143, 34.26863310140458, 20.170690928947067, 19.502114530568637, -2.158139526415615, 4.289485663747808, 21.794941930490424, 12.142923582071912, 41.66056459812171, -3.5943328385380546, 5.922118100144054, 40.94043289557404, 20.081922504806336, 31.835114782678893, 30.667415214425787, 27.996885652004487, 13.378959806551777, 10.400853881200083, 23.527282938987614, 24.74131050782302, 24.006136158368484, 13.568539692289868, 27.464875386212487, 24.815739505850146, 37.002400832013585, 15.320034097346229, 12.521516723920737, -0.2524273214353272, 20.71436597234875, 13.343702069005014, 10.286708919281775, 18.861602916082205, 18.661122097236056, 20.37349130997223, 23.921833904335127, 9.730004760987466, 27.813786127762334, 18.145922864104733, 27.037455769103367, 27.692583371921785, 28.34074599156211, 18.929044079107165, 10.306564375619946, 17.91447392289158, -4.689550843528444, 9.35525088872863, 38.870927064616026, 39.04784910385533, 34.62324547684063, 22.450606819680143, 0.2755736007615681, 19.657170921305102, 44.96516791836007, 22.844494514958637, 43.23159326653682, 34.249294881686225, 27.310085103397288, 25.80290457305561, 25.162508622107822, 24.273186555952897, 10.908126043426982, -2.670141764452623, 14.100276315044308, 19.209715932644944, 22.418495525862035, 0.46189060848140073, -10.92402235242886, 20.067894740118454, 20.25740604290226, 35.73987620340104, 38.20873657536153, 42.89140470795101, 41.46364133262129, 21.773973934080615, 30.963992997385105, 12.629555033801024, 19.140888860411557, 14.052898708685198, 35.19165515983956, 19.06754733425085, 15.022786301176431, 24.61618165528118, 32.13454242869596, 22.541508087424432, 42.77608353478034, 3.1957101373850607, 18.08734892733359, -4.988946195624722, 31.475583435051, 33.01035022594221, 24.157108669143483, 24.698610378783975, 40.76280918688741, 12.310929009979295, 14.896427132564435, -5.73548160148337, 10.250199419911107, -2.7628438894651843, 10.73447764522901, 26.63055053758833, 18.458401952526025, 4.016125063797493, 12.131075103003598, 3.1624422700740524, 4.4535966354565275, 5.6135597476270185, 14.48986051143487, 34.51333427382479, 41.85993017674843, 19.754365826392206, 35.28305263224997, 41.84107246386535, 34.38643915797789, 3.9771114047236242, 35.32275177890269, 35.50636116939571, -3.4400520932832155, 36.74622967381819, 23.438757344602493, 31.629873162849268, 26.18638458720298, 21.355439808913403, 25.655457293715067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6227227392542557, "mean_inference_ms": 1.670028858452775, "mean_action_processing_ms": 0.25596940929062667, "mean_env_wait_ms": 0.14426021870928185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003208637237548828, "StateBufferConnector_ms": 0.002869248390197754, "ViewRequirementAgentConnector_ms": 0.07557940483093262}, "num_episodes": 18, "episode_return_max": 42.17752302028625, "episode_return_min": -13.522864755291797, "episode_return_mean": 18.503015837822453, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.7452324024948, "num_env_steps_trained_throughput_per_sec": 344.7452324024948, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1788000, "timers": {"training_iteration_time_ms": 11648.839, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11648.71, "sample_time_ms": 1344.382, "learn_time_ms": 10281.247, "learn_throughput": 389.058, "synch_weights_time_ms": 21.031}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "done": false, "training_iteration": 149, "trial_id": "06536_00000", "date": "2024-08-11_17-41-23", "timestamp": 1723412483, "time_this_iter_s": 11.619006156921387, "time_total_s": 4023.099603652954, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317c1ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4023.099603652954, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 45.79375, "ram_util_percent": 83.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5374771090845267, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.447190734061102, "policy_loss": -0.012847945561710124, "vf_loss": 1.4600386769821248, "vf_explained_var": 0.9659373311325907, "kl": 0.00970803845909374, "entropy": 0.35157673995321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.766575769204942, "cur_kl_coeff": 1.2116903504194739e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0198025963293813, "policy_loss": -0.0022146391673703437, "vf_loss": 2.0220172328293007, "vf_explained_var": 0.9555134920216112, "kl": 0.004429981383131984, "entropy": 0.22324609516789673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 49.88621874256694, "episode_reward_min": -11.8167324376113, "episode_reward_mean": 18.708937039861453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.88621874256693, "predator_policy": -17.607713475482996}, "policy_reward_max": {"prey_policy": 11.816732437611286, "predator_policy": 53.559112864587455}, "policy_reward_mean": {"prey_policy": -18.708937039861453, "predator_policy": 18.70893703986145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.92718920696432, 25.95962059639919, 14.958539245103449, -1.1712361421961646, -2.986586642766788, 16.66210320895752, 30.784033736407157, 3.8234771435048183, -4.008139734085231, 4.247870679905406, 27.35716304573493, 15.60435713901248, 40.69656964725688, 3.096573574339846, 16.919642213211716, 32.62593492064532, 27.219662015175828, 8.671987502076517, 13.042213797119091, 26.901744090096834, 1.1638926308030033, 30.511177700190174, 31.251264998552315, 20.68792272927812, 16.964068410093862, 24.373723333095747, 20.516707539251176, 30.90907016893189, 13.920775410633489, 10.230969325456705, 11.815205494143392, 18.76136250665913, 22.147662607153688, 18.77189544437484, 22.59168931660407, 28.016664681741993, 14.617804227363564, 6.612461539681542, 24.11308897667233, 36.83554729034797, 11.36309021022086, 32.311169419832595, 33.038043890747716, 30.779689992541744, 25.48270659758169, 17.590656299689947, 5.715067275295854, 20.81410572925349, -5.231065871973721, 20.162650391510383, 36.97430638938127, 42.17752302028625, 26.36898346573286, 15.885221947106325, 24.622276934262402, 17.045166817713643, 28.375362041988552, 32.65879581110238, 10.641529532359334, 13.243318619713136, 28.583729447542886, 32.73070978283569, 13.603678071271869, 2.257358909213865, 3.98581687788191, 22.544476245057155, 8.073600083400546, 3.8080194527652838, 10.051710129530946, 38.186632225286566, 27.518709229321082, 38.113755810921646, 19.64993159181315, 16.033154538056237, 30.092493509210342, 28.9081288750262, 23.505448551314245, 21.856836283944144, 13.94898977356832, 30.54573023074891, 7.835239425372378, 24.05764484253141, 49.88621874256694, -1.9760745034831073, 18.7653408205797, 35.605139534356454, 18.085723770211644, -11.8167324376113, 15.430803351703386, 7.464989604607727, 20.469039753580716, -1.587948855955843, 9.461283039250123, 6.298004128959446, 13.913442978307877, 17.14408050958905, -5.1234292090842075, 11.170166805543102, 11.703076997832698, 34.94451298033698], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.927189206964247, -25.959620596399194, -14.958539245103445, 1.17123614219617, 2.98658664276679, -16.662103208957546, -30.78403373640709, -3.8234771435048165, 4.008139734085232, -4.247870679905406, -27.357163045734925, -15.604357139012492, -40.69656964725687, -3.096573574339864, -16.91964221321175, -32.62593492064531, -27.21966201517582, -8.671987502076508, -13.042213797119093, -26.901744090096823, -1.1638926308029962, -30.51117770019018, -31.25126499855233, -20.687922729278167, -16.96406841009386, -24.373723333095764, -20.516707539251176, -30.909070168931827, -13.920775410633484, -10.230969325456721, -11.815205494143386, -18.761362506659136, -22.14766260715369, -18.77189544437493, -22.591689316604054, -28.016664681741947, -14.617804227363548, -6.612461539681562, -24.113088976672326, -36.83554729034796, -11.363090210220863, -32.31116941983257, -33.03804389074773, -30.779689992541744, -25.482706597581714, -17.590656299689932, -5.715067275295848, -20.814105729253498, 5.231065871973728, -20.162650391510372, -36.97430638938131, -42.17752302028611, -26.368983465732878, -15.885221947106299, -24.622276934262363, -17.045166817713643, -28.375362041988602, -32.65879581110239, -10.641529532359321, -13.243318619713156, -28.58372944754283, -32.73070978283569, -13.603678071271869, -2.257358909213865, -3.9858168778819194, -22.54447624505718, -8.073600083400546, -3.8080194527652864, -10.05171012953095, -38.1866322252866, -27.518709229321082, -38.113755810921596, -19.649931591813154, -16.033154538056245, -30.092493509210325, -28.908128875026133, -23.505448551314228, -21.856836283944144, -13.948989773568336, -30.545730230748912, -7.835239425372371, -24.057644842531403, -49.88621874256693, 1.9760745034830958, -18.765340820579688, -35.605139534356454, -18.08572377021168, 11.816732437611286, -15.430803351703382, -7.464989604607693, -20.469039753580716, 1.587948855955858, -9.461283039250118, -6.298004128959402, -13.913442978307913, -17.144080509589067, 5.1234292090842075, -11.17016680554315, -11.703076997832703, -34.94451298033701], "policy_predator_policy_reward": [36.225466568965274, 23.628911844963326, 7.73808771608765, 44.181153476710755, 22.896003406555906, 7.02107508365099, 2.868984673701389, -5.211456958093713, -0.4309926489387621, -5.542180636594814, 22.652058389802527, 10.67214802811253, 33.80846058059422, 27.759606892219995, 15.55920113890696, -7.912246851897336, -1.979459874000879, -6.036819594169588, 4.4912520064660235, 4.0044893533447885, 24.81209232609047, 29.90223376537938, 28.371911639850264, 2.8368026381746905, 35.11972742180475, 46.27341187270901, 0.6543733285194868, 5.538773820160241, 19.5519556429051, 14.287328783518399, 27.77674140730918, 37.47512843398143, 34.26863310140458, 20.170690928947067, 19.502114530568637, -2.158139526415615, 4.289485663747808, 21.794941930490424, 12.142923582071912, 41.66056459812171, -3.5943328385380546, 5.922118100144054, 40.94043289557404, 20.081922504806336, 31.835114782678893, 30.667415214425787, 27.996885652004487, 13.378959806551777, 10.400853881200083, 23.527282938987614, 24.74131050782302, 24.006136158368484, 13.568539692289868, 27.464875386212487, 24.815739505850146, 37.002400832013585, 15.320034097346229, 12.521516723920737, -0.2524273214353272, 20.71436597234875, 13.343702069005014, 10.286708919281775, 18.861602916082205, 18.661122097236056, 20.37349130997223, 23.921833904335127, 9.730004760987466, 27.813786127762334, 18.145922864104733, 27.037455769103367, 27.692583371921785, 28.34074599156211, 18.929044079107165, 10.306564375619946, 17.91447392289158, -4.689550843528444, 9.35525088872863, 38.870927064616026, 39.04784910385533, 34.62324547684063, 22.450606819680143, 0.2755736007615681, 19.657170921305102, 44.96516791836007, 22.844494514958637, 43.23159326653682, 34.249294881686225, 27.310085103397288, 25.80290457305561, 25.162508622107822, 24.273186555952897, 10.908126043426982, -2.670141764452623, 14.100276315044308, 19.209715932644944, 22.418495525862035, 0.46189060848140073, -10.92402235242886, 20.067894740118454, 20.25740604290226, 35.73987620340104, 38.20873657536153, 42.89140470795101, 41.46364133262129, 21.773973934080615, 30.963992997385105, 12.629555033801024, 19.140888860411557, 14.052898708685198, 35.19165515983956, 19.06754733425085, 15.022786301176431, 24.61618165528118, 32.13454242869596, 22.541508087424432, 42.77608353478034, 3.1957101373850607, 18.08734892733359, -4.988946195624722, 31.475583435051, 33.01035022594221, 24.157108669143483, 24.698610378783975, 40.76280918688741, 12.310929009979295, 14.896427132564435, -5.73548160148337, 10.250199419911107, -2.7628438894651843, 10.73447764522901, 26.63055053758833, 18.458401952526025, 4.016125063797493, 12.131075103003598, 3.1624422700740524, 4.4535966354565275, 5.6135597476270185, 14.48986051143487, 34.51333427382479, 41.85993017674843, 19.754365826392206, 35.28305263224997, 41.84107246386535, 34.38643915797789, 3.9771114047236242, 35.32275177890269, 35.50636116939571, -3.4400520932832155, 36.74622967381819, 23.438757344602493, 31.629873162849268, 26.18638458720298, 21.355439808913403, 25.655457293715067, 31.59120947249683, 12.12246309539146, 32.205409430258946, -4.307429883122272, 27.74323398786743, 33.348226473630376, 9.880964724652785, 5.789514126091965, 16.930819001657145, 31.184470683405664, 46.213324620546395, 53.559112864587455, -4.023297115758669, 0.07114810879250832, 11.718563866120036, 25.81211777503935, 25.811822763132085, 45.39845630558082, 19.48212126404492, 16.689326276378374, -17.607713475482996, -6.025751399739585, 17.601897012704352, 13.259709690702408, 3.2218994543279997, 11.70807975488742, 20.73306631880839, 20.20501318835305, -4.984585109628384, 1.8086873977166942, -6.715152662267641, 25.63771874076786, 23.320405393733004, -10.724397135814186, 4.090299731478, 23.73658622513784, 28.393602079433045, 5.894558939745117, -10.764422505300528, 0.5175640871321256, 16.71751606933303, 5.622817541753227, 8.239665088372785, 15.166488907292662, 40.45782736783156, 29.431198592842403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6220344961322717, "mean_inference_ms": 1.6695309056946506, "mean_action_processing_ms": 0.25584911552216083, "mean_env_wait_ms": 0.14416582873870293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003167390823364258, "StateBufferConnector_ms": 0.0026874542236328125, "ViewRequirementAgentConnector_ms": 0.07618999481201172}, "num_episodes": 23, "episode_return_max": 49.88621874256694, "episode_return_min": -11.8167324376113, "episode_return_mean": 18.708937039861453, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.5471428975493, "num_env_steps_trained_throughput_per_sec": 306.5471428975493, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 11855.925, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11855.708, "sample_time_ms": 1329.36, "learn_time_ms": 10501.704, "learn_throughput": 380.891, "synch_weights_time_ms": 22.216}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 150, "trial_id": "06536_00000", "date": "2024-08-11_17-41-36", "timestamp": 1723412496, "time_this_iter_s": 13.090808153152466, "time_total_s": 4036.1904118061066, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3316abb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4036.1904118061066, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 52.994736842105254, "ram_util_percent": 82.97894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8430590173850456, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.276066263020039, "policy_loss": -0.00372236235125456, "vf_loss": 2.279788623377681, "vf_explained_var": 0.942425925967594, "kl": 0.005339441255852396, "entropy": 0.3272396451638391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.087498474877978, "cur_kl_coeff": 6.058451752097369e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.785018699762052, "policy_loss": -0.002511494525673765, "vf_loss": 2.787530184864367, "vf_explained_var": 0.9399317668228553, "kl": 0.00412221973375647, "entropy": 0.17699363255705783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "env_runners": {"episode_reward_max": 49.88621874256694, "episode_reward_min": -11.8167324376113, "episode_reward_mean": 19.122153861090766, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.88621874256693, "predator_policy": -17.607713475482996}, "policy_reward_max": {"prey_policy": 11.816732437611286, "predator_policy": 53.559112864587455}, "policy_reward_mean": {"prey_policy": -19.122153861090766, "predator_policy": 19.122153861090766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.042213797119091, 26.901744090096834, 1.1638926308030033, 30.511177700190174, 31.251264998552315, 20.68792272927812, 16.964068410093862, 24.373723333095747, 20.516707539251176, 30.90907016893189, 13.920775410633489, 10.230969325456705, 11.815205494143392, 18.76136250665913, 22.147662607153688, 18.77189544437484, 22.59168931660407, 28.016664681741993, 14.617804227363564, 6.612461539681542, 24.11308897667233, 36.83554729034797, 11.36309021022086, 32.311169419832595, 33.038043890747716, 30.779689992541744, 25.48270659758169, 17.590656299689947, 5.715067275295854, 20.81410572925349, -5.231065871973721, 20.162650391510383, 36.97430638938127, 42.17752302028625, 26.36898346573286, 15.885221947106325, 24.622276934262402, 17.045166817713643, 28.375362041988552, 32.65879581110238, 10.641529532359334, 13.243318619713136, 28.583729447542886, 32.73070978283569, 13.603678071271869, 2.257358909213865, 3.98581687788191, 22.544476245057155, 8.073600083400546, 3.8080194527652838, 10.051710129530946, 38.186632225286566, 27.518709229321082, 38.113755810921646, 19.64993159181315, 16.033154538056237, 30.092493509210342, 28.9081288750262, 23.505448551314245, 21.856836283944144, 13.94898977356832, 30.54573023074891, 7.835239425372378, 24.05764484253141, 49.88621874256694, -1.9760745034831073, 18.7653408205797, 35.605139534356454, 18.085723770211644, -11.8167324376113, 15.430803351703386, 7.464989604607727, 20.469039753580716, -1.587948855955843, 9.461283039250123, 6.298004128959446, 13.913442978307877, 17.14408050958905, -5.1234292090842075, 11.170166805543102, 11.703076997832698, 34.94451298033698, 16.318305190414943, 20.244878382112027, 15.348826542036175, 14.902175073973286, 11.852251725229108, 26.777920020132942, 29.35356219324231, -0.7217324497044793, 28.201587783644097, 21.057516216678522, 5.860561452040981, 41.25021623275366, 2.188438392084901, 14.998191275479682, 14.505648184804134, 25.46762073911004, 11.199571394969313, 32.90490512957689], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.042213797119093, -26.901744090096823, -1.1638926308029962, -30.51117770019018, -31.25126499855233, -20.687922729278167, -16.96406841009386, -24.373723333095764, -20.516707539251176, -30.909070168931827, -13.920775410633484, -10.230969325456721, -11.815205494143386, -18.761362506659136, -22.14766260715369, -18.77189544437493, -22.591689316604054, -28.016664681741947, -14.617804227363548, -6.612461539681562, -24.113088976672326, -36.83554729034796, -11.363090210220863, -32.31116941983257, -33.03804389074773, -30.779689992541744, -25.482706597581714, -17.590656299689932, -5.715067275295848, -20.814105729253498, 5.231065871973728, -20.162650391510372, -36.97430638938131, -42.17752302028611, -26.368983465732878, -15.885221947106299, -24.622276934262363, -17.045166817713643, -28.375362041988602, -32.65879581110239, -10.641529532359321, -13.243318619713156, -28.58372944754283, -32.73070978283569, -13.603678071271869, -2.257358909213865, -3.9858168778819194, -22.54447624505718, -8.073600083400546, -3.8080194527652864, -10.05171012953095, -38.1866322252866, -27.518709229321082, -38.113755810921596, -19.649931591813154, -16.033154538056245, -30.092493509210325, -28.908128875026133, -23.505448551314228, -21.856836283944144, -13.948989773568336, -30.545730230748912, -7.835239425372371, -24.057644842531403, -49.88621874256693, 1.9760745034830958, -18.765340820579688, -35.605139534356454, -18.08572377021168, 11.816732437611286, -15.430803351703382, -7.464989604607693, -20.469039753580716, 1.587948855955858, -9.461283039250118, -6.298004128959402, -13.913442978307913, -17.144080509589067, 5.1234292090842075, -11.17016680554315, -11.703076997832703, -34.94451298033701, -16.31830519041495, -20.24487838211207, -15.348826542036175, -14.902175073973297, -11.85225172522912, -26.77792002013294, -29.353562193242276, 0.7217324497044739, -28.20158778364409, -21.057516216678522, -5.86056145204098, -41.250216232753694, -2.1884383920849, -14.998191275479698, -14.505648184804132, -25.46762073911005, -11.199571394969313, -32.90490512957692], "policy_predator_policy_reward": [4.289485663747808, 21.794941930490424, 12.142923582071912, 41.66056459812171, -3.5943328385380546, 5.922118100144054, 40.94043289557404, 20.081922504806336, 31.835114782678893, 30.667415214425787, 27.996885652004487, 13.378959806551777, 10.400853881200083, 23.527282938987614, 24.74131050782302, 24.006136158368484, 13.568539692289868, 27.464875386212487, 24.815739505850146, 37.002400832013585, 15.320034097346229, 12.521516723920737, -0.2524273214353272, 20.71436597234875, 13.343702069005014, 10.286708919281775, 18.861602916082205, 18.661122097236056, 20.37349130997223, 23.921833904335127, 9.730004760987466, 27.813786127762334, 18.145922864104733, 27.037455769103367, 27.692583371921785, 28.34074599156211, 18.929044079107165, 10.306564375619946, 17.91447392289158, -4.689550843528444, 9.35525088872863, 38.870927064616026, 39.04784910385533, 34.62324547684063, 22.450606819680143, 0.2755736007615681, 19.657170921305102, 44.96516791836007, 22.844494514958637, 43.23159326653682, 34.249294881686225, 27.310085103397288, 25.80290457305561, 25.162508622107822, 24.273186555952897, 10.908126043426982, -2.670141764452623, 14.100276315044308, 19.209715932644944, 22.418495525862035, 0.46189060848140073, -10.92402235242886, 20.067894740118454, 20.25740604290226, 35.73987620340104, 38.20873657536153, 42.89140470795101, 41.46364133262129, 21.773973934080615, 30.963992997385105, 12.629555033801024, 19.140888860411557, 14.052898708685198, 35.19165515983956, 19.06754733425085, 15.022786301176431, 24.61618165528118, 32.13454242869596, 22.541508087424432, 42.77608353478034, 3.1957101373850607, 18.08734892733359, -4.988946195624722, 31.475583435051, 33.01035022594221, 24.157108669143483, 24.698610378783975, 40.76280918688741, 12.310929009979295, 14.896427132564435, -5.73548160148337, 10.250199419911107, -2.7628438894651843, 10.73447764522901, 26.63055053758833, 18.458401952526025, 4.016125063797493, 12.131075103003598, 3.1624422700740524, 4.4535966354565275, 5.6135597476270185, 14.48986051143487, 34.51333427382479, 41.85993017674843, 19.754365826392206, 35.28305263224997, 41.84107246386535, 34.38643915797789, 3.9771114047236242, 35.32275177890269, 35.50636116939571, -3.4400520932832155, 36.74622967381819, 23.438757344602493, 31.629873162849268, 26.18638458720298, 21.355439808913403, 25.655457293715067, 31.59120947249683, 12.12246309539146, 32.205409430258946, -4.307429883122272, 27.74323398786743, 33.348226473630376, 9.880964724652785, 5.789514126091965, 16.930819001657145, 31.184470683405664, 46.213324620546395, 53.559112864587455, -4.023297115758669, 0.07114810879250832, 11.718563866120036, 25.81211777503935, 25.811822763132085, 45.39845630558082, 19.48212126404492, 16.689326276378374, -17.607713475482996, -6.025751399739585, 17.601897012704352, 13.259709690702408, 3.2218994543279997, 11.70807975488742, 20.73306631880839, 20.20501318835305, -4.984585109628384, 1.8086873977166942, -6.715152662267641, 25.63771874076786, 23.320405393733004, -10.724397135814186, 4.090299731478, 23.73658622513784, 28.393602079433045, 5.894558939745117, -10.764422505300528, 0.5175640871321256, 16.71751606933303, 5.622817541753227, 8.239665088372785, 15.166488907292662, 40.45782736783156, 29.431198592842403, 16.8097520917375, 15.826858289092371, 14.423449128229215, 26.066307635994896, 28.843514529739046, 1.8541385543333178, 13.786724891613794, 16.017625256332767, 9.385658469416562, 14.318844981041671, 33.59984127257245, 19.95599876769344, 39.5323093965233, 19.174814989961277, 0.5930377478716435, -2.036502647280603, 36.86056805368267, 19.54260751360554, 5.833075173143953, 36.28195726021309, 15.70677753741641, -3.985654633334473, 43.45056904572176, 39.04986341978557, 5.544318701861952, -1.1674419176921482, 19.893023501895776, 10.10335904906361, 12.592000449223349, 16.419295920384904, 29.215074955078762, 21.72016652314131, 8.84991468654529, 13.549228103393336, 32.423582364322314, 33.3862278948315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6211125789882153, "mean_inference_ms": 1.6651939129055382, "mean_action_processing_ms": 0.2553059164140917, "mean_env_wait_ms": 0.14380697445600954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003209829330444336, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.0790795087814331}, "num_episodes": 18, "episode_return_max": 49.88621874256694, "episode_return_min": -11.8167324376113, "episode_return_mean": 19.122153861090766, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.1252443082031, "num_env_steps_trained_throughput_per_sec": 347.1252443082031, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1812000, "timers": {"training_iteration_time_ms": 11887.426, "restore_workers_time_ms": 0.036, "training_step_time_ms": 11887.207, "sample_time_ms": 1292.39, "learn_time_ms": 10567.741, "learn_throughput": 378.51, "synch_weights_time_ms": 24.659}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "done": false, "training_iteration": 151, "trial_id": "06536_00000", "date": "2024-08-11_17-41-48", "timestamp": 1723412508, "time_this_iter_s": 11.5680091381073, "time_total_s": 4047.758420944214, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317a1b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4047.758420944214, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 44.51875, "ram_util_percent": 83.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7606662212560575, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.94276494688044, "policy_loss": -0.008501707295605836, "vf_loss": 1.9512666448950768, "vf_explained_var": 0.9397770455727975, "kl": 0.006998860566024798, "entropy": 0.3390653978101909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.812572620722352, "cur_kl_coeff": 3.0292258760486847e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.562868869241583, "policy_loss": -0.0016677370639862838, "vf_loss": 2.5645366040487136, "vf_explained_var": 0.9291593657284186, "kl": 0.0035296185485460185, "entropy": 0.20398177077609395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 49.88621874256694, "episode_reward_min": -11.8167324376113, "episode_reward_mean": 18.440945542552562, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.88621874256693, "predator_policy": -17.607713475482996}, "policy_reward_max": {"prey_policy": 11.816732437611286, "predator_policy": 53.559112864587455}, "policy_reward_mean": {"prey_policy": -18.440945542552562, "predator_policy": 18.440945542552562}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.36309021022086, 32.311169419832595, 33.038043890747716, 30.779689992541744, 25.48270659758169, 17.590656299689947, 5.715067275295854, 20.81410572925349, -5.231065871973721, 20.162650391510383, 36.97430638938127, 42.17752302028625, 26.36898346573286, 15.885221947106325, 24.622276934262402, 17.045166817713643, 28.375362041988552, 32.65879581110238, 10.641529532359334, 13.243318619713136, 28.583729447542886, 32.73070978283569, 13.603678071271869, 2.257358909213865, 3.98581687788191, 22.544476245057155, 8.073600083400546, 3.8080194527652838, 10.051710129530946, 38.186632225286566, 27.518709229321082, 38.113755810921646, 19.64993159181315, 16.033154538056237, 30.092493509210342, 28.9081288750262, 23.505448551314245, 21.856836283944144, 13.94898977356832, 30.54573023074891, 7.835239425372378, 24.05764484253141, 49.88621874256694, -1.9760745034831073, 18.7653408205797, 35.605139534356454, 18.085723770211644, -11.8167324376113, 15.430803351703386, 7.464989604607727, 20.469039753580716, -1.587948855955843, 9.461283039250123, 6.298004128959446, 13.913442978307877, 17.14408050958905, -5.1234292090842075, 11.170166805543102, 11.703076997832698, 34.94451298033698, 16.318305190414943, 20.244878382112027, 15.348826542036175, 14.902175073973286, 11.852251725229108, 26.777920020132942, 29.35356219324231, -0.7217324497044793, 28.201587783644097, 21.057516216678522, 5.860561452040981, 41.25021623275366, 2.188438392084901, 14.998191275479682, 14.505648184804134, 25.46762073911004, 11.199571394969313, 32.90490512957689, 34.79092832494589, 4.193157856983582, 10.413640750099733, 1.772277926411757, 35.82568893909585, 21.692394926505752, 13.99569366308074, 31.81571653701709, 16.37514210359926, 27.06944270352622, 29.335821442191094, 13.106299513034342, 19.4202622531114, 12.679653389209312, 8.92429235009724, 14.763433340868481, 3.9470420171011256, 13.864488598115779, 19.29870200589278, 0.2554548777159136, 23.3380420246072, 19.758504821214615], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.363090210220863, -32.31116941983257, -33.03804389074773, -30.779689992541744, -25.482706597581714, -17.590656299689932, -5.715067275295848, -20.814105729253498, 5.231065871973728, -20.162650391510372, -36.97430638938131, -42.17752302028611, -26.368983465732878, -15.885221947106299, -24.622276934262363, -17.045166817713643, -28.375362041988602, -32.65879581110239, -10.641529532359321, -13.243318619713156, -28.58372944754283, -32.73070978283569, -13.603678071271869, -2.257358909213865, -3.9858168778819194, -22.54447624505718, -8.073600083400546, -3.8080194527652864, -10.05171012953095, -38.1866322252866, -27.518709229321082, -38.113755810921596, -19.649931591813154, -16.033154538056245, -30.092493509210325, -28.908128875026133, -23.505448551314228, -21.856836283944144, -13.948989773568336, -30.545730230748912, -7.835239425372371, -24.057644842531403, -49.88621874256693, 1.9760745034830958, -18.765340820579688, -35.605139534356454, -18.08572377021168, 11.816732437611286, -15.430803351703382, -7.464989604607693, -20.469039753580716, 1.587948855955858, -9.461283039250118, -6.298004128959402, -13.913442978307913, -17.144080509589067, 5.1234292090842075, -11.17016680554315, -11.703076997832703, -34.94451298033701, -16.31830519041495, -20.24487838211207, -15.348826542036175, -14.902175073973297, -11.85225172522912, -26.77792002013294, -29.353562193242276, 0.7217324497044739, -28.20158778364409, -21.057516216678522, -5.86056145204098, -41.250216232753694, -2.1884383920849, -14.998191275479698, -14.505648184804132, -25.46762073911005, -11.199571394969313, -32.90490512957692, -34.79092832494591, -4.19315785698355, -10.413640750099717, -1.7722779264117587, -35.82568893909579, -21.69239492650575, -13.995693663080711, -31.815716537017064, -16.375142103599266, -27.069442703526196, -29.335821442191097, -13.10629951303433, -19.420262253111407, -12.679653389209307, -8.92429235009723, -14.763433340868467, -3.947042017101137, -13.864488598115763, -19.298702005892775, -0.255454877715926, -23.338042024607205, -19.758504821214608], "policy_predator_policy_reward": [22.450606819680143, 0.2755736007615681, 19.657170921305102, 44.96516791836007, 22.844494514958637, 43.23159326653682, 34.249294881686225, 27.310085103397288, 25.80290457305561, 25.162508622107822, 24.273186555952897, 10.908126043426982, -2.670141764452623, 14.100276315044308, 19.209715932644944, 22.418495525862035, 0.46189060848140073, -10.92402235242886, 20.067894740118454, 20.25740604290226, 35.73987620340104, 38.20873657536153, 42.89140470795101, 41.46364133262129, 21.773973934080615, 30.963992997385105, 12.629555033801024, 19.140888860411557, 14.052898708685198, 35.19165515983956, 19.06754733425085, 15.022786301176431, 24.61618165528118, 32.13454242869596, 22.541508087424432, 42.77608353478034, 3.1957101373850607, 18.08734892733359, -4.988946195624722, 31.475583435051, 33.01035022594221, 24.157108669143483, 24.698610378783975, 40.76280918688741, 12.310929009979295, 14.896427132564435, -5.73548160148337, 10.250199419911107, -2.7628438894651843, 10.73447764522901, 26.63055053758833, 18.458401952526025, 4.016125063797493, 12.131075103003598, 3.1624422700740524, 4.4535966354565275, 5.6135597476270185, 14.48986051143487, 34.51333427382479, 41.85993017674843, 19.754365826392206, 35.28305263224997, 41.84107246386535, 34.38643915797789, 3.9771114047236242, 35.32275177890269, 35.50636116939571, -3.4400520932832155, 36.74622967381819, 23.438757344602493, 31.629873162849268, 26.18638458720298, 21.355439808913403, 25.655457293715067, 31.59120947249683, 12.12246309539146, 32.205409430258946, -4.307429883122272, 27.74323398786743, 33.348226473630376, 9.880964724652785, 5.789514126091965, 16.930819001657145, 31.184470683405664, 46.213324620546395, 53.559112864587455, -4.023297115758669, 0.07114810879250832, 11.718563866120036, 25.81211777503935, 25.811822763132085, 45.39845630558082, 19.48212126404492, 16.689326276378374, -17.607713475482996, -6.025751399739585, 17.601897012704352, 13.259709690702408, 3.2218994543279997, 11.70807975488742, 20.73306631880839, 20.20501318835305, -4.984585109628384, 1.8086873977166942, -6.715152662267641, 25.63771874076786, 23.320405393733004, -10.724397135814186, 4.090299731478, 23.73658622513784, 28.393602079433045, 5.894558939745117, -10.764422505300528, 0.5175640871321256, 16.71751606933303, 5.622817541753227, 8.239665088372785, 15.166488907292662, 40.45782736783156, 29.431198592842403, 16.8097520917375, 15.826858289092371, 14.423449128229215, 26.066307635994896, 28.843514529739046, 1.8541385543333178, 13.786724891613794, 16.017625256332767, 9.385658469416562, 14.318844981041671, 33.59984127257245, 19.95599876769344, 39.5323093965233, 19.174814989961277, 0.5930377478716435, -2.036502647280603, 36.86056805368267, 19.54260751360554, 5.833075173143953, 36.28195726021309, 15.70677753741641, -3.985654633334473, 43.45056904572176, 39.04986341978557, 5.544318701861952, -1.1674419176921482, 19.893023501895776, 10.10335904906361, 12.592000449223349, 16.419295920384904, 29.215074955078762, 21.72016652314131, 8.84991468654529, 13.549228103393336, 32.423582364322314, 33.3862278948315, 30.52650202407265, 39.05535462581919, 8.535347308970515, -0.14903159500340202, 30.91713157682614, -10.089850076626714, 7.024956318627762, -3.4804004658042498, 44.41328336008646, 27.23809451810515, 17.623437303944993, 25.761352549066505, 13.909559387802801, 14.08182793835865, 22.626121686980856, 41.00531138705334, 11.385435146106152, 21.36484906109237, 26.31455760857017, 27.824327798482194, 11.270787148930195, 47.400855735452, 14.6844714553226, 11.528127570746062, 9.307580808863342, 29.53294369735947, 15.456311241486492, 9.902995536932112, 5.472246904561562, 12.376337795632896, 8.865061242406036, 20.66180543933089, 7.8677244420450485, 0.02635959215722128, 18.888403967972536, 8.840573228259027, 9.627525013903332, 28.969878997882212, -9.11287366514346, 9.623783420575322, 12.134968877947376, 34.54111517126702, 20.073625714702757, 19.443383927726465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6201506066415952, "mean_inference_ms": 1.6623464956621155, "mean_action_processing_ms": 0.2549267302839878, "mean_env_wait_ms": 0.14354513349664944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038857460021972656, "StateBufferConnector_ms": 0.002894878387451172, "ViewRequirementAgentConnector_ms": 0.08625757694244385}, "num_episodes": 22, "episode_return_max": 49.88621874256694, "episode_return_min": -11.8167324376113, "episode_return_mean": 18.440945542552562, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.3555319883065, "num_env_steps_trained_throughput_per_sec": 349.3555319883065, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 11943.535, "restore_workers_time_ms": 0.037, "training_step_time_ms": 11943.319, "sample_time_ms": 1280.062, "learn_time_ms": 10636.327, "learn_throughput": 376.07, "synch_weights_time_ms": 24.522}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 152, "trial_id": "06536_00000", "date": "2024-08-11_17-41-59", "timestamp": 1723412519, "time_this_iter_s": 11.493053913116455, "time_total_s": 4059.2514748573303, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317f7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4059.2514748573303, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 45.629411764705885, "ram_util_percent": 83.04705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.782925434162219, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.172832735689978, "policy_loss": -0.004077550837488768, "vf_loss": 2.176910286520918, "vf_explained_var": 0.9316469167048732, "kl": 0.004465198589484165, "entropy": 0.31786859937322637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.863142398551658, "cur_kl_coeff": 1.5146129380243423e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8277281687373206, "policy_loss": -0.0010527909876256393, "vf_loss": 2.8287809614151245, "vf_explained_var": 0.9092528192139177, "kl": 0.0019912169002305425, "entropy": 0.16718846856365127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "env_runners": {"episode_reward_max": 49.88621874256694, "episode_reward_min": -11.8167324376113, "episode_reward_mean": 17.327073227588034, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.88621874256693, "predator_policy": -17.607713475482996}, "policy_reward_max": {"prey_policy": 11.816732437611286, "predator_policy": 53.559112864587455}, "policy_reward_mean": {"prey_policy": -17.327073227588038, "predator_policy": 17.327073227588034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.641529532359334, 13.243318619713136, 28.583729447542886, 32.73070978283569, 13.603678071271869, 2.257358909213865, 3.98581687788191, 22.544476245057155, 8.073600083400546, 3.8080194527652838, 10.051710129530946, 38.186632225286566, 27.518709229321082, 38.113755810921646, 19.64993159181315, 16.033154538056237, 30.092493509210342, 28.9081288750262, 23.505448551314245, 21.856836283944144, 13.94898977356832, 30.54573023074891, 7.835239425372378, 24.05764484253141, 49.88621874256694, -1.9760745034831073, 18.7653408205797, 35.605139534356454, 18.085723770211644, -11.8167324376113, 15.430803351703386, 7.464989604607727, 20.469039753580716, -1.587948855955843, 9.461283039250123, 6.298004128959446, 13.913442978307877, 17.14408050958905, -5.1234292090842075, 11.170166805543102, 11.703076997832698, 34.94451298033698, 16.318305190414943, 20.244878382112027, 15.348826542036175, 14.902175073973286, 11.852251725229108, 26.777920020132942, 29.35356219324231, -0.7217324497044793, 28.201587783644097, 21.057516216678522, 5.860561452040981, 41.25021623275366, 2.188438392084901, 14.998191275479682, 14.505648184804134, 25.46762073911004, 11.199571394969313, 32.90490512957689, 34.79092832494589, 4.193157856983582, 10.413640750099733, 1.772277926411757, 35.82568893909585, 21.692394926505752, 13.99569366308074, 31.81571653701709, 16.37514210359926, 27.06944270352622, 29.335821442191094, 13.106299513034342, 19.4202622531114, 12.679653389209312, 8.92429235009724, 14.763433340868481, 3.9470420171011256, 13.864488598115779, 19.29870200589278, 0.2554548777159136, 23.3380420246072, 19.758504821214615, 11.256441164073191, 14.764034419739035, 13.88752772271811, 21.54517538433297, 23.72429965891074, 27.90694189560996, 25.14381553935288, 33.57977991526707, 13.630177265537405, 15.981136699430476, -0.4179029498128868, 21.111239967481204, -1.155146490558014, 21.853112738540506, 15.770312757836255, 16.747639270268778, 2.784908336023868, 26.633025571069467], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.641529532359321, -13.243318619713156, -28.58372944754283, -32.73070978283569, -13.603678071271869, -2.257358909213865, -3.9858168778819194, -22.54447624505718, -8.073600083400546, -3.8080194527652864, -10.05171012953095, -38.1866322252866, -27.518709229321082, -38.113755810921596, -19.649931591813154, -16.033154538056245, -30.092493509210325, -28.908128875026133, -23.505448551314228, -21.856836283944144, -13.948989773568336, -30.545730230748912, -7.835239425372371, -24.057644842531403, -49.88621874256693, 1.9760745034830958, -18.765340820579688, -35.605139534356454, -18.08572377021168, 11.816732437611286, -15.430803351703382, -7.464989604607693, -20.469039753580716, 1.587948855955858, -9.461283039250118, -6.298004128959402, -13.913442978307913, -17.144080509589067, 5.1234292090842075, -11.17016680554315, -11.703076997832703, -34.94451298033701, -16.31830519041495, -20.24487838211207, -15.348826542036175, -14.902175073973297, -11.85225172522912, -26.77792002013294, -29.353562193242276, 0.7217324497044739, -28.20158778364409, -21.057516216678522, -5.86056145204098, -41.250216232753694, -2.1884383920849, -14.998191275479698, -14.505648184804132, -25.46762073911005, -11.199571394969313, -32.90490512957692, -34.79092832494591, -4.19315785698355, -10.413640750099717, -1.7722779264117587, -35.82568893909579, -21.69239492650575, -13.995693663080711, -31.815716537017064, -16.375142103599266, -27.069442703526196, -29.335821442191097, -13.10629951303433, -19.420262253111407, -12.679653389209307, -8.92429235009723, -14.763433340868467, -3.947042017101137, -13.864488598115763, -19.298702005892775, -0.255454877715926, -23.338042024607205, -19.758504821214608, -11.256441164073193, -14.764034419739042, -13.887527722718136, -21.545175384332953, -23.72429965891076, -27.90694189561, -25.143815539352925, -33.579779915267075, -13.630177265537384, -15.981136699430472, 0.4179029498128912, -21.11123996748123, 1.1551464905580158, -21.85311273854053, -15.770312757836257, -16.747639270268778, -2.7849083360238613, -26.63302557106948], "policy_predator_policy_reward": [3.1957101373850607, 18.08734892733359, -4.988946195624722, 31.475583435051, 33.01035022594221, 24.157108669143483, 24.698610378783975, 40.76280918688741, 12.310929009979295, 14.896427132564435, -5.73548160148337, 10.250199419911107, -2.7628438894651843, 10.73447764522901, 26.63055053758833, 18.458401952526025, 4.016125063797493, 12.131075103003598, 3.1624422700740524, 4.4535966354565275, 5.6135597476270185, 14.48986051143487, 34.51333427382479, 41.85993017674843, 19.754365826392206, 35.28305263224997, 41.84107246386535, 34.38643915797789, 3.9771114047236242, 35.32275177890269, 35.50636116939571, -3.4400520932832155, 36.74622967381819, 23.438757344602493, 31.629873162849268, 26.18638458720298, 21.355439808913403, 25.655457293715067, 31.59120947249683, 12.12246309539146, 32.205409430258946, -4.307429883122272, 27.74323398786743, 33.348226473630376, 9.880964724652785, 5.789514126091965, 16.930819001657145, 31.184470683405664, 46.213324620546395, 53.559112864587455, -4.023297115758669, 0.07114810879250832, 11.718563866120036, 25.81211777503935, 25.811822763132085, 45.39845630558082, 19.48212126404492, 16.689326276378374, -17.607713475482996, -6.025751399739585, 17.601897012704352, 13.259709690702408, 3.2218994543279997, 11.70807975488742, 20.73306631880839, 20.20501318835305, -4.984585109628384, 1.8086873977166942, -6.715152662267641, 25.63771874076786, 23.320405393733004, -10.724397135814186, 4.090299731478, 23.73658622513784, 28.393602079433045, 5.894558939745117, -10.764422505300528, 0.5175640871321256, 16.71751606933303, 5.622817541753227, 8.239665088372785, 15.166488907292662, 40.45782736783156, 29.431198592842403, 16.8097520917375, 15.826858289092371, 14.423449128229215, 26.066307635994896, 28.843514529739046, 1.8541385543333178, 13.786724891613794, 16.017625256332767, 9.385658469416562, 14.318844981041671, 33.59984127257245, 19.95599876769344, 39.5323093965233, 19.174814989961277, 0.5930377478716435, -2.036502647280603, 36.86056805368267, 19.54260751360554, 5.833075173143953, 36.28195726021309, 15.70677753741641, -3.985654633334473, 43.45056904572176, 39.04986341978557, 5.544318701861952, -1.1674419176921482, 19.893023501895776, 10.10335904906361, 12.592000449223349, 16.419295920384904, 29.215074955078762, 21.72016652314131, 8.84991468654529, 13.549228103393336, 32.423582364322314, 33.3862278948315, 30.52650202407265, 39.05535462581919, 8.535347308970515, -0.14903159500340202, 30.91713157682614, -10.089850076626714, 7.024956318627762, -3.4804004658042498, 44.41328336008646, 27.23809451810515, 17.623437303944993, 25.761352549066505, 13.909559387802801, 14.08182793835865, 22.626121686980856, 41.00531138705334, 11.385435146106152, 21.36484906109237, 26.31455760857017, 27.824327798482194, 11.270787148930195, 47.400855735452, 14.6844714553226, 11.528127570746062, 9.307580808863342, 29.53294369735947, 15.456311241486492, 9.902995536932112, 5.472246904561562, 12.376337795632896, 8.865061242406036, 20.66180543933089, 7.8677244420450485, 0.02635959215722128, 18.888403967972536, 8.840573228259027, 9.627525013903332, 28.969878997882212, -9.11287366514346, 9.623783420575322, 12.134968877947376, 34.54111517126702, 20.073625714702757, 19.443383927726465, 19.989419886097163, 2.5234624420492215, 12.215253435360838, 17.31281540411723, 23.289949530653683, 4.48510591478259, 15.214290821236656, 27.876059947429265, 36.107308743258145, 11.341290574563363, 27.471583264223487, 28.342300526996482, 27.789377372894595, 22.4982537058112, 18.09164295039868, 49.067916880135456, 20.213802571555977, 7.046551959518812, 9.631376426153288, 22.330896972707656, 5.458196923989251, -6.294002823615023, 14.557237485788688, 27.665242449173764, 4.293431097647053, -6.603724078763079, 19.37239293843598, 24.3338325386451, -5.0338250555198165, 36.574450571192344, 27.549311292833366, 5.945967247704166, 3.1755506345255617, 2.3942660375221605, 16.265936167319992, 37.000114974818956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6195544954891363, "mean_inference_ms": 1.6609381017045834, "mean_action_processing_ms": 0.2547405290478926, "mean_env_wait_ms": 0.1433916060579128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00406193733215332, "StateBufferConnector_ms": 0.003037571907043457, "ViewRequirementAgentConnector_ms": 0.09895563125610352}, "num_episodes": 18, "episode_return_max": 49.88621874256694, "episode_return_min": -11.8167324376113, "episode_return_mean": 17.327073227588034, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.19604055957257, "num_env_steps_trained_throughput_per_sec": 331.19604055957257, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1836000, "timers": {"training_iteration_time_ms": 12009.696, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12009.49, "sample_time_ms": 1285.229, "learn_time_ms": 10697.602, "learn_throughput": 373.916, "synch_weights_time_ms": 24.556}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "done": false, "training_iteration": 153, "trial_id": "06536_00000", "date": "2024-08-11_17-42-12", "timestamp": 1723412532, "time_this_iter_s": 12.138840913772583, "time_total_s": 4071.390315771103, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5932700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4071.390315771103, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 48.2235294117647, "ram_util_percent": 83.2235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9900135868539413, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.503302432099978, "policy_loss": -0.007225703253061511, "vf_loss": 2.51052813505133, "vf_explained_var": 0.9383482412124674, "kl": 0.0063604440785105815, "entropy": 0.3600216669340928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.016214086643602, "cur_kl_coeff": 7.573064690121712e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.055945438178128, "policy_loss": -0.0014903139874890999, "vf_loss": 3.0574357510874512, "vf_explained_var": 0.922124389649699, "kl": 0.002438857303500601, "entropy": 0.1834021008795216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "env_runners": {"episode_reward_max": 49.88621874256694, "episode_reward_min": -11.8167324376113, "episode_reward_mean": 16.944127502367355, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -49.88621874256693, "predator_policy": -17.607713475482996}, "policy_reward_max": {"prey_policy": 11.816732437611286, "predator_policy": 53.559112864587455}, "policy_reward_mean": {"prey_policy": -16.94412750236736, "predator_policy": 16.94412750236736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.505448551314245, 21.856836283944144, 13.94898977356832, 30.54573023074891, 7.835239425372378, 24.05764484253141, 49.88621874256694, -1.9760745034831073, 18.7653408205797, 35.605139534356454, 18.085723770211644, -11.8167324376113, 15.430803351703386, 7.464989604607727, 20.469039753580716, -1.587948855955843, 9.461283039250123, 6.298004128959446, 13.913442978307877, 17.14408050958905, -5.1234292090842075, 11.170166805543102, 11.703076997832698, 34.94451298033698, 16.318305190414943, 20.244878382112027, 15.348826542036175, 14.902175073973286, 11.852251725229108, 26.777920020132942, 29.35356219324231, -0.7217324497044793, 28.201587783644097, 21.057516216678522, 5.860561452040981, 41.25021623275366, 2.188438392084901, 14.998191275479682, 14.505648184804134, 25.46762073911004, 11.199571394969313, 32.90490512957689, 34.79092832494589, 4.193157856983582, 10.413640750099733, 1.772277926411757, 35.82568893909585, 21.692394926505752, 13.99569366308074, 31.81571653701709, 16.37514210359926, 27.06944270352622, 29.335821442191094, 13.106299513034342, 19.4202622531114, 12.679653389209312, 8.92429235009724, 14.763433340868481, 3.9470420171011256, 13.864488598115779, 19.29870200589278, 0.2554548777159136, 23.3380420246072, 19.758504821214615, 11.256441164073191, 14.764034419739035, 13.88752772271811, 21.54517538433297, 23.72429965891074, 27.90694189560996, 25.14381553935288, 33.57977991526707, 13.630177265537405, 15.981136699430476, -0.4179029498128868, 21.111239967481204, -1.155146490558014, 21.853112738540506, 15.770312757836255, 16.747639270268778, 2.784908336023868, 26.633025571069467, 31.69494268535272, 18.00374608836377, -8.258492123752532, 42.782292059997424, 9.344109635316073, 13.06410844483677, 7.487965813086816, 17.823752672597205, 18.652812675702023, 2.2676282925924163, 36.9674662661456, 4.71065589381959, 26.01775482470281, 33.92680898916256, 18.326065485938656, 12.74052438069349, 0.22697126498934939, 23.95306705959548], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.505448551314228, -21.856836283944144, -13.948989773568336, -30.545730230748912, -7.835239425372371, -24.057644842531403, -49.88621874256693, 1.9760745034830958, -18.765340820579688, -35.605139534356454, -18.08572377021168, 11.816732437611286, -15.430803351703382, -7.464989604607693, -20.469039753580716, 1.587948855955858, -9.461283039250118, -6.298004128959402, -13.913442978307913, -17.144080509589067, 5.1234292090842075, -11.17016680554315, -11.703076997832703, -34.94451298033701, -16.31830519041495, -20.24487838211207, -15.348826542036175, -14.902175073973297, -11.85225172522912, -26.77792002013294, -29.353562193242276, 0.7217324497044739, -28.20158778364409, -21.057516216678522, -5.86056145204098, -41.250216232753694, -2.1884383920849, -14.998191275479698, -14.505648184804132, -25.46762073911005, -11.199571394969313, -32.90490512957692, -34.79092832494591, -4.19315785698355, -10.413640750099717, -1.7722779264117587, -35.82568893909579, -21.69239492650575, -13.995693663080711, -31.815716537017064, -16.375142103599266, -27.069442703526196, -29.335821442191097, -13.10629951303433, -19.420262253111407, -12.679653389209307, -8.92429235009723, -14.763433340868467, -3.947042017101137, -13.864488598115763, -19.298702005892775, -0.255454877715926, -23.338042024607205, -19.758504821214608, -11.256441164073193, -14.764034419739042, -13.887527722718136, -21.545175384332953, -23.72429965891076, -27.90694189561, -25.143815539352925, -33.579779915267075, -13.630177265537384, -15.981136699430472, 0.4179029498128912, -21.11123996748123, 1.1551464905580158, -21.85311273854053, -15.770312757836257, -16.747639270268778, -2.7849083360238613, -26.63302557106948, -31.694942685352714, -18.003746088363776, 8.25849212375253, -42.782292059997474, -9.344109635316073, -13.064108444836764, -7.487965813086802, -17.82375267259718, -18.652812675702002, -2.267628292592418, -36.96746626614565, -4.710655893819581, -26.017754824702802, -33.92680898916253, -18.32606548593864, -12.740524380693486, -0.22697126498935294, -23.953067059595483], "policy_predator_policy_reward": [21.355439808913403, 25.655457293715067, 31.59120947249683, 12.12246309539146, 32.205409430258946, -4.307429883122272, 27.74323398786743, 33.348226473630376, 9.880964724652785, 5.789514126091965, 16.930819001657145, 31.184470683405664, 46.213324620546395, 53.559112864587455, -4.023297115758669, 0.07114810879250832, 11.718563866120036, 25.81211777503935, 25.811822763132085, 45.39845630558082, 19.48212126404492, 16.689326276378374, -17.607713475482996, -6.025751399739585, 17.601897012704352, 13.259709690702408, 3.2218994543279997, 11.70807975488742, 20.73306631880839, 20.20501318835305, -4.984585109628384, 1.8086873977166942, -6.715152662267641, 25.63771874076786, 23.320405393733004, -10.724397135814186, 4.090299731478, 23.73658622513784, 28.393602079433045, 5.894558939745117, -10.764422505300528, 0.5175640871321256, 16.71751606933303, 5.622817541753227, 8.239665088372785, 15.166488907292662, 40.45782736783156, 29.431198592842403, 16.8097520917375, 15.826858289092371, 14.423449128229215, 26.066307635994896, 28.843514529739046, 1.8541385543333178, 13.786724891613794, 16.017625256332767, 9.385658469416562, 14.318844981041671, 33.59984127257245, 19.95599876769344, 39.5323093965233, 19.174814989961277, 0.5930377478716435, -2.036502647280603, 36.86056805368267, 19.54260751360554, 5.833075173143953, 36.28195726021309, 15.70677753741641, -3.985654633334473, 43.45056904572176, 39.04986341978557, 5.544318701861952, -1.1674419176921482, 19.893023501895776, 10.10335904906361, 12.592000449223349, 16.419295920384904, 29.215074955078762, 21.72016652314131, 8.84991468654529, 13.549228103393336, 32.423582364322314, 33.3862278948315, 30.52650202407265, 39.05535462581919, 8.535347308970515, -0.14903159500340202, 30.91713157682614, -10.089850076626714, 7.024956318627762, -3.4804004658042498, 44.41328336008646, 27.23809451810515, 17.623437303944993, 25.761352549066505, 13.909559387802801, 14.08182793835865, 22.626121686980856, 41.00531138705334, 11.385435146106152, 21.36484906109237, 26.31455760857017, 27.824327798482194, 11.270787148930195, 47.400855735452, 14.6844714553226, 11.528127570746062, 9.307580808863342, 29.53294369735947, 15.456311241486492, 9.902995536932112, 5.472246904561562, 12.376337795632896, 8.865061242406036, 20.66180543933089, 7.8677244420450485, 0.02635959215722128, 18.888403967972536, 8.840573228259027, 9.627525013903332, 28.969878997882212, -9.11287366514346, 9.623783420575322, 12.134968877947376, 34.54111517126702, 20.073625714702757, 19.443383927726465, 19.989419886097163, 2.5234624420492215, 12.215253435360838, 17.31281540411723, 23.289949530653683, 4.48510591478259, 15.214290821236656, 27.876059947429265, 36.107308743258145, 11.341290574563363, 27.471583264223487, 28.342300526996482, 27.789377372894595, 22.4982537058112, 18.09164295039868, 49.067916880135456, 20.213802571555977, 7.046551959518812, 9.631376426153288, 22.330896972707656, 5.458196923989251, -6.294002823615023, 14.557237485788688, 27.665242449173764, 4.293431097647053, -6.603724078763079, 19.37239293843598, 24.3338325386451, -5.0338250555198165, 36.574450571192344, 27.549311292833366, 5.945967247704166, 3.1755506345255617, 2.3942660375221605, 16.265936167319992, 37.000114974818956, 36.54620119857861, 26.843684172126842, 15.617039943265567, 20.39045223346198, -10.21348231555368, -6.3035019319513825, 36.340949819021816, 49.2236343009731, 2.056232433579023, 16.631986837053123, 12.876335439590587, 13.25188145008294, 6.725793318625034, 8.25013830754858, 7.4484099134085415, 28.199095431785835, 14.65844076832856, 22.64718458307548, 4.358396976530752, 0.17685960865409278, 33.99220826820751, 39.94272426408373, 14.687059855318157, -5.265748067678988, 24.67342023244832, 27.362089416957275, 30.65031510962833, 37.20330286869674, 9.674776406767476, 26.977354565109778, 12.114336839514593, 13.366711921872366, -0.6334328652521934, 1.0873753952308896, 20.145610152367322, 27.760523966823648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6190634748736821, "mean_inference_ms": 1.6599910274348637, "mean_action_processing_ms": 0.25462583211649387, "mean_env_wait_ms": 0.14326649712284356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004086971282958984, "StateBufferConnector_ms": 0.0034090280532836914, "ViewRequirementAgentConnector_ms": 0.09464073181152344}, "num_episodes": 18, "episode_return_max": 49.88621874256694, "episode_return_min": -11.8167324376113, "episode_return_mean": 16.944127502367355, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.08793350031794, "num_env_steps_trained_throughput_per_sec": 341.08793350031794, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 12018.719, "restore_workers_time_ms": 0.046, "training_step_time_ms": 12018.494, "sample_time_ms": 1180.576, "learn_time_ms": 10811.598, "learn_throughput": 369.973, "synch_weights_time_ms": 24.376}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "training_iteration": 154, "trial_id": "06536_00000", "date": "2024-08-11_17-42-23", "timestamp": 1723412543, "time_this_iter_s": 11.751585006713867, "time_total_s": 4083.1419007778168, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b586cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4083.1419007778168, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 45.12941176470588, "ram_util_percent": 82.89411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.879177678003907, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9154442832494776, "policy_loss": -0.006977995130970764, "vf_loss": 1.9224222756922245, "vf_explained_var": 0.9539123378694058, "kl": 0.005740673455445678, "entropy": 0.3413252174854279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6388834173086457, "cur_kl_coeff": 3.786532345060856e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.423251898957308, "policy_loss": -0.0014121026664272581, "vf_loss": 2.424664000670115, "vf_explained_var": 0.9420466058153324, "kl": 0.003109582400508751, "entropy": 0.20631272962326727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "env_runners": {"episode_reward_max": 46.10310287183955, "episode_reward_min": -8.317190260735297, "episode_reward_mean": 17.301566232618235, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.10310287183959, "predator_policy": -12.930240703168455}, "policy_reward_max": {"prey_policy": 8.317190260735293, "predator_policy": 49.2236343009731}, "policy_reward_mean": {"prey_policy": -17.301566232618228, "predator_policy": 17.30156623261823}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.94451298033698, 16.318305190414943, 20.244878382112027, 15.348826542036175, 14.902175073973286, 11.852251725229108, 26.777920020132942, 29.35356219324231, -0.7217324497044793, 28.201587783644097, 21.057516216678522, 5.860561452040981, 41.25021623275366, 2.188438392084901, 14.998191275479682, 14.505648184804134, 25.46762073911004, 11.199571394969313, 32.90490512957689, 34.79092832494589, 4.193157856983582, 10.413640750099733, 1.772277926411757, 35.82568893909585, 21.692394926505752, 13.99569366308074, 31.81571653701709, 16.37514210359926, 27.06944270352622, 29.335821442191094, 13.106299513034342, 19.4202622531114, 12.679653389209312, 8.92429235009724, 14.763433340868481, 3.9470420171011256, 13.864488598115779, 19.29870200589278, 0.2554548777159136, 23.3380420246072, 19.758504821214615, 11.256441164073191, 14.764034419739035, 13.88752772271811, 21.54517538433297, 23.72429965891074, 27.90694189560996, 25.14381553935288, 33.57977991526707, 13.630177265537405, 15.981136699430476, -0.4179029498128868, 21.111239967481204, -1.155146490558014, 21.853112738540506, 15.770312757836255, 16.747639270268778, 2.784908336023868, 26.633025571069467, 31.69494268535272, 18.00374608836377, -8.258492123752532, 42.782292059997424, 9.344109635316073, 13.06410844483677, 7.487965813086816, 17.823752672597205, 18.652812675702023, 2.2676282925924163, 36.9674662661456, 4.71065589381959, 26.01775482470281, 33.92680898916256, 18.326065485938656, 12.74052438069349, 0.22697126498934939, 23.95306705959548, 19.373137759514435, -8.317190260735297, 29.672471214875607, 17.5335348728637, 1.3931695246919498, 30.059182895110876, 11.861768576862975, 19.14565639262157, 18.679135022616304, 19.62884442648057, 4.536518217415133, 9.205933519179666, 9.143200315669263, 18.138203844119758, 22.06852965393, 6.878988729512588, 18.320113725165115, 46.10310287183955, 4.1899292214866986, 14.604859953421768, 27.831107072048898, 17.499153835485235, 14.837535779345103], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.94451298033701, -16.31830519041495, -20.24487838211207, -15.348826542036175, -14.902175073973297, -11.85225172522912, -26.77792002013294, -29.353562193242276, 0.7217324497044739, -28.20158778364409, -21.057516216678522, -5.86056145204098, -41.250216232753694, -2.1884383920849, -14.998191275479698, -14.505648184804132, -25.46762073911005, -11.199571394969313, -32.90490512957692, -34.79092832494591, -4.19315785698355, -10.413640750099717, -1.7722779264117587, -35.82568893909579, -21.69239492650575, -13.995693663080711, -31.815716537017064, -16.375142103599266, -27.069442703526196, -29.335821442191097, -13.10629951303433, -19.420262253111407, -12.679653389209307, -8.92429235009723, -14.763433340868467, -3.947042017101137, -13.864488598115763, -19.298702005892775, -0.255454877715926, -23.338042024607205, -19.758504821214608, -11.256441164073193, -14.764034419739042, -13.887527722718136, -21.545175384332953, -23.72429965891076, -27.90694189561, -25.143815539352925, -33.579779915267075, -13.630177265537384, -15.981136699430472, 0.4179029498128912, -21.11123996748123, 1.1551464905580158, -21.85311273854053, -15.770312757836257, -16.747639270268778, -2.7849083360238613, -26.63302557106948, -31.694942685352714, -18.003746088363776, 8.25849212375253, -42.782292059997474, -9.344109635316073, -13.064108444836764, -7.487965813086802, -17.82375267259718, -18.652812675702002, -2.267628292592418, -36.96746626614565, -4.710655893819581, -26.017754824702802, -33.92680898916253, -18.32606548593864, -12.740524380693486, -0.22697126498935294, -23.953067059595483, -19.373137759514428, 8.317190260735293, -29.67247121487553, -17.533534872863683, -1.3931695246919453, -30.05918289511088, -11.861768576862982, -19.145656392621603, -18.67913502261631, -19.628844426480526, -4.536518217415119, -9.205933519179675, -9.143200315669262, -18.138203844119698, -22.068529653929993, -6.878988729512585, -18.320113725165122, -46.10310287183959, -4.18992922148674, -14.604859953421759, -27.83110707204886, -17.49915383548528, -14.837535779345078], "policy_predator_policy_reward": [40.45782736783156, 29.431198592842403, 16.8097520917375, 15.826858289092371, 14.423449128229215, 26.066307635994896, 28.843514529739046, 1.8541385543333178, 13.786724891613794, 16.017625256332767, 9.385658469416562, 14.318844981041671, 33.59984127257245, 19.95599876769344, 39.5323093965233, 19.174814989961277, 0.5930377478716435, -2.036502647280603, 36.86056805368267, 19.54260751360554, 5.833075173143953, 36.28195726021309, 15.70677753741641, -3.985654633334473, 43.45056904572176, 39.04986341978557, 5.544318701861952, -1.1674419176921482, 19.893023501895776, 10.10335904906361, 12.592000449223349, 16.419295920384904, 29.215074955078762, 21.72016652314131, 8.84991468654529, 13.549228103393336, 32.423582364322314, 33.3862278948315, 30.52650202407265, 39.05535462581919, 8.535347308970515, -0.14903159500340202, 30.91713157682614, -10.089850076626714, 7.024956318627762, -3.4804004658042498, 44.41328336008646, 27.23809451810515, 17.623437303944993, 25.761352549066505, 13.909559387802801, 14.08182793835865, 22.626121686980856, 41.00531138705334, 11.385435146106152, 21.36484906109237, 26.31455760857017, 27.824327798482194, 11.270787148930195, 47.400855735452, 14.6844714553226, 11.528127570746062, 9.307580808863342, 29.53294369735947, 15.456311241486492, 9.902995536932112, 5.472246904561562, 12.376337795632896, 8.865061242406036, 20.66180543933089, 7.8677244420450485, 0.02635959215722128, 18.888403967972536, 8.840573228259027, 9.627525013903332, 28.969878997882212, -9.11287366514346, 9.623783420575322, 12.134968877947376, 34.54111517126702, 20.073625714702757, 19.443383927726465, 19.989419886097163, 2.5234624420492215, 12.215253435360838, 17.31281540411723, 23.289949530653683, 4.48510591478259, 15.214290821236656, 27.876059947429265, 36.107308743258145, 11.341290574563363, 27.471583264223487, 28.342300526996482, 27.789377372894595, 22.4982537058112, 18.09164295039868, 49.067916880135456, 20.213802571555977, 7.046551959518812, 9.631376426153288, 22.330896972707656, 5.458196923989251, -6.294002823615023, 14.557237485788688, 27.665242449173764, 4.293431097647053, -6.603724078763079, 19.37239293843598, 24.3338325386451, -5.0338250555198165, 36.574450571192344, 27.549311292833366, 5.945967247704166, 3.1755506345255617, 2.3942660375221605, 16.265936167319992, 37.000114974818956, 36.54620119857861, 26.843684172126842, 15.617039943265567, 20.39045223346198, -10.21348231555368, -6.3035019319513825, 36.340949819021816, 49.2236343009731, 2.056232433579023, 16.631986837053123, 12.876335439590587, 13.25188145008294, 6.725793318625034, 8.25013830754858, 7.4484099134085415, 28.199095431785835, 14.65844076832856, 22.64718458307548, 4.358396976530752, 0.17685960865409278, 33.99220826820751, 39.94272426408373, 14.687059855318157, -5.265748067678988, 24.67342023244832, 27.362089416957275, 30.65031510962833, 37.20330286869674, 9.674776406767476, 26.977354565109778, 12.114336839514593, 13.366711921872366, -0.6334328652521934, 1.0873753952308896, 20.145610152367322, 27.760523966823648, 18.04507624553135, 20.70119927349754, -11.967257593965964, -4.667122927504627, 37.50885564603507, 21.83608678371607, 34.572609640665576, 0.49446010506187044, 3.022943261568619, -0.2366042121847176, 35.62840511007332, 24.489960680148425, 22.11160275812247, 1.6119343956035062, 36.16544273707122, 2.1258700481719717, 6.874507017074085, 30.483763028158503, 16.46201086616111, 22.795677986799987, -0.14990183200437457, 9.222938266834603, 31.34210774152778, -12.930240703168455, 15.60356033329943, 2.6828402980390944, 13.971252594208842, 22.305155094030553, 22.73461344120453, 21.402445866655455, 22.635787537496043, -8.877810078470828, 19.27812884003295, 17.362098610297295, 48.834581438054265, 43.371624305624835, 8.974838007582196, -0.5949795646087406, 20.008596672329528, 9.20112323451401, 29.250997357678614, 26.411216786419143, 20.522358301632565, 14.475949369337956, 23.428537044993977, 6.2465345136962025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6186774663703238, "mean_inference_ms": 1.658995536153889, "mean_action_processing_ms": 0.2545185026298267, "mean_env_wait_ms": 0.14316825092073276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043076276779174805, "StateBufferConnector_ms": 0.003446817398071289, "ViewRequirementAgentConnector_ms": 0.10029888153076172}, "num_episodes": 23, "episode_return_max": 46.10310287183955, "episode_return_min": -8.317190260735297, "episode_return_mean": 17.301566232618235, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.3655436671863, "num_env_steps_trained_throughput_per_sec": 321.3655436671863, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1860000, "timers": {"training_iteration_time_ms": 12023.345, "restore_workers_time_ms": 0.046, "training_step_time_ms": 12023.12, "sample_time_ms": 1202.942, "learn_time_ms": 10792.431, "learn_throughput": 370.63, "synch_weights_time_ms": 26.003}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "done": false, "training_iteration": 155, "trial_id": "06536_00000", "date": "2024-08-11_17-42-36", "timestamp": 1723412556, "time_this_iter_s": 12.506580114364624, "time_total_s": 4095.6484808921814, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317f7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4095.6484808921814, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 49.59411764705882, "ram_util_percent": 82.78235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.639467372993628, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5697356400700906, "policy_loss": -0.009679689139011316, "vf_loss": 1.5794153312842052, "vf_explained_var": 0.9658534357324242, "kl": 0.00706543174180723, "entropy": 0.36048081138481697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8162574793926622, "cur_kl_coeff": 1.893266172530428e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8594516561775611, "policy_loss": -0.0012469872781790043, "vf_loss": 1.8606986448247598, "vf_explained_var": 0.9667365759768815, "kl": 0.002974519895315808, "entropy": 0.19516966279852327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 46.10310287183955, "episode_reward_min": -8.317190260735297, "episode_reward_mean": 16.503669897881153, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.10310287183959, "predator_policy": -12.930240703168455}, "policy_reward_max": {"prey_policy": 8.317190260735293, "predator_policy": 49.2236343009731}, "policy_reward_mean": {"prey_policy": -16.503669897881153, "predator_policy": 16.503669897881153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.772277926411757, 35.82568893909585, 21.692394926505752, 13.99569366308074, 31.81571653701709, 16.37514210359926, 27.06944270352622, 29.335821442191094, 13.106299513034342, 19.4202622531114, 12.679653389209312, 8.92429235009724, 14.763433340868481, 3.9470420171011256, 13.864488598115779, 19.29870200589278, 0.2554548777159136, 23.3380420246072, 19.758504821214615, 11.256441164073191, 14.764034419739035, 13.88752772271811, 21.54517538433297, 23.72429965891074, 27.90694189560996, 25.14381553935288, 33.57977991526707, 13.630177265537405, 15.981136699430476, -0.4179029498128868, 21.111239967481204, -1.155146490558014, 21.853112738540506, 15.770312757836255, 16.747639270268778, 2.784908336023868, 26.633025571069467, 31.69494268535272, 18.00374608836377, -8.258492123752532, 42.782292059997424, 9.344109635316073, 13.06410844483677, 7.487965813086816, 17.823752672597205, 18.652812675702023, 2.2676282925924163, 36.9674662661456, 4.71065589381959, 26.01775482470281, 33.92680898916256, 18.326065485938656, 12.74052438069349, 0.22697126498934939, 23.95306705959548, 19.373137759514435, -8.317190260735297, 29.672471214875607, 17.5335348728637, 1.3931695246919498, 30.059182895110876, 11.861768576862975, 19.14565639262157, 18.679135022616304, 19.62884442648057, 4.536518217415133, 9.205933519179666, 9.143200315669263, 18.138203844119758, 22.06852965393, 6.878988729512588, 18.320113725165115, 46.10310287183955, 4.1899292214866986, 14.604859953421768, 27.831107072048898, 17.499153835485235, 14.837535779345103, 28.271300592065167, 15.119859530735777, -5.257230512677635, 24.06883074302904, -3.4226756576584627, 7.470039191519616, 10.552162399575318, 2.0641178488184506, 13.88766155825098, -0.20128306045573918, 13.624156027666018, 18.27405110477355, -0.7363147196755673, -2.354403994293289, -0.054527982004947795, 35.98501040203877, 30.931860513926726, 28.06520043366657, 28.520232177458396, 43.24728189226095, 44.89237182039791, 3.3153496078189972], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.7722779264117587, -35.82568893909579, -21.69239492650575, -13.995693663080711, -31.815716537017064, -16.375142103599266, -27.069442703526196, -29.335821442191097, -13.10629951303433, -19.420262253111407, -12.679653389209307, -8.92429235009723, -14.763433340868467, -3.947042017101137, -13.864488598115763, -19.298702005892775, -0.255454877715926, -23.338042024607205, -19.758504821214608, -11.256441164073193, -14.764034419739042, -13.887527722718136, -21.545175384332953, -23.72429965891076, -27.90694189561, -25.143815539352925, -33.579779915267075, -13.630177265537384, -15.981136699430472, 0.4179029498128912, -21.11123996748123, 1.1551464905580158, -21.85311273854053, -15.770312757836257, -16.747639270268778, -2.7849083360238613, -26.63302557106948, -31.694942685352714, -18.003746088363776, 8.25849212375253, -42.782292059997474, -9.344109635316073, -13.064108444836764, -7.487965813086802, -17.82375267259718, -18.652812675702002, -2.267628292592418, -36.96746626614565, -4.710655893819581, -26.017754824702802, -33.92680898916253, -18.32606548593864, -12.740524380693486, -0.22697126498935294, -23.953067059595483, -19.373137759514428, 8.317190260735293, -29.67247121487553, -17.533534872863683, -1.3931695246919453, -30.05918289511088, -11.861768576862982, -19.145656392621603, -18.67913502261631, -19.628844426480526, -4.536518217415119, -9.205933519179675, -9.143200315669262, -18.138203844119698, -22.068529653929993, -6.878988729512585, -18.320113725165122, -46.10310287183959, -4.18992922148674, -14.604859953421759, -27.83110707204886, -17.49915383548528, -14.837535779345078, -28.271300592065195, -15.119859530735795, 5.2572305126776335, -24.06883074302902, 3.422675657658453, -7.47003919151962, -10.552162399575362, -2.0641178488184577, -13.887661558250981, 0.20128306045573208, -13.624156027665999, -18.274051104773534, 0.736314719675569, 2.3544039942932873, 0.05452798200496112, -35.98501040203875, -30.931860513926758, -28.065200433666575, -28.520232177458368, -43.24728189226111, -44.892371820397905, -3.3153496078189937], "policy_predator_policy_reward": [7.024956318627762, -3.4804004658042498, 44.41328336008646, 27.23809451810515, 17.623437303944993, 25.761352549066505, 13.909559387802801, 14.08182793835865, 22.626121686980856, 41.00531138705334, 11.385435146106152, 21.36484906109237, 26.31455760857017, 27.824327798482194, 11.270787148930195, 47.400855735452, 14.6844714553226, 11.528127570746062, 9.307580808863342, 29.53294369735947, 15.456311241486492, 9.902995536932112, 5.472246904561562, 12.376337795632896, 8.865061242406036, 20.66180543933089, 7.8677244420450485, 0.02635959215722128, 18.888403967972536, 8.840573228259027, 9.627525013903332, 28.969878997882212, -9.11287366514346, 9.623783420575322, 12.134968877947376, 34.54111517126702, 20.073625714702757, 19.443383927726465, 19.989419886097163, 2.5234624420492215, 12.215253435360838, 17.31281540411723, 23.289949530653683, 4.48510591478259, 15.214290821236656, 27.876059947429265, 36.107308743258145, 11.341290574563363, 27.471583264223487, 28.342300526996482, 27.789377372894595, 22.4982537058112, 18.09164295039868, 49.067916880135456, 20.213802571555977, 7.046551959518812, 9.631376426153288, 22.330896972707656, 5.458196923989251, -6.294002823615023, 14.557237485788688, 27.665242449173764, 4.293431097647053, -6.603724078763079, 19.37239293843598, 24.3338325386451, -5.0338250555198165, 36.574450571192344, 27.549311292833366, 5.945967247704166, 3.1755506345255617, 2.3942660375221605, 16.265936167319992, 37.000114974818956, 36.54620119857861, 26.843684172126842, 15.617039943265567, 20.39045223346198, -10.21348231555368, -6.3035019319513825, 36.340949819021816, 49.2236343009731, 2.056232433579023, 16.631986837053123, 12.876335439590587, 13.25188145008294, 6.725793318625034, 8.25013830754858, 7.4484099134085415, 28.199095431785835, 14.65844076832856, 22.64718458307548, 4.358396976530752, 0.17685960865409278, 33.99220826820751, 39.94272426408373, 14.687059855318157, -5.265748067678988, 24.67342023244832, 27.362089416957275, 30.65031510962833, 37.20330286869674, 9.674776406767476, 26.977354565109778, 12.114336839514593, 13.366711921872366, -0.6334328652521934, 1.0873753952308896, 20.145610152367322, 27.760523966823648, 18.04507624553135, 20.70119927349754, -11.967257593965964, -4.667122927504627, 37.50885564603507, 21.83608678371607, 34.572609640665576, 0.49446010506187044, 3.022943261568619, -0.2366042121847176, 35.62840511007332, 24.489960680148425, 22.11160275812247, 1.6119343956035062, 36.16544273707122, 2.1258700481719717, 6.874507017074085, 30.483763028158503, 16.46201086616111, 22.795677986799987, -0.14990183200437457, 9.222938266834603, 31.34210774152778, -12.930240703168455, 15.60356033329943, 2.6828402980390944, 13.971252594208842, 22.305155094030553, 22.73461344120453, 21.402445866655455, 22.635787537496043, -8.877810078470828, 19.27812884003295, 17.362098610297295, 48.834581438054265, 43.371624305624835, 8.974838007582196, -0.5949795646087406, 20.008596672329528, 9.20112323451401, 29.250997357678614, 26.411216786419143, 20.522358301632565, 14.475949369337956, 23.428537044993977, 6.2465345136962025, 32.809582174820804, 23.73301900930958, 8.958809394887211, 21.28090966658435, -8.887057211056643, -1.6274038142986171, 33.47373652748752, 14.663924958570508, -7.814642765524829, 0.9692914502079226, 18.606494712737437, -3.6664163296981975, -1.3708728902217207, 22.47519768937244, 3.3834593465238516, 0.744776351113055, 23.571803879553553, 4.203519236948399, 0.48958914018173694, -0.8921552610932082, 13.985709804359358, 13.262602250972638, 25.28681875137878, 11.261283458168286, 3.5272249908273423, -4.99985443017848, -2.217210998133284, -2.491596990453292, -6.715277237222622, 6.606221273212725, 34.22935172754235, 37.74066907653517, 33.4095755774115, 28.45414545044199, 32.00877994091029, 24.12162092642282, 25.08289879929185, 31.957565555624882, 38.44345972998454, 48.05110405453757, 46.80467364278868, 42.980069998007146, 15.381675544861908, -8.750976329223917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6182939720115269, "mean_inference_ms": 1.657006751239257, "mean_action_processing_ms": 0.2542726658013806, "mean_env_wait_ms": 0.14307411239176218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043621063232421875, "StateBufferConnector_ms": 0.003538370132446289, "ViewRequirementAgentConnector_ms": 0.11159002780914307}, "num_episodes": 22, "episode_return_max": 46.10310287183955, "episode_return_min": -8.317190260735297, "episode_return_mean": 16.503669897881153, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.20093345974516, "num_env_steps_trained_throughput_per_sec": 335.20093345974516, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 12003.004, "restore_workers_time_ms": 0.048, "training_step_time_ms": 12002.8, "sample_time_ms": 1254.23, "learn_time_ms": 10720.337, "learn_throughput": 373.123, "synch_weights_time_ms": 26.776}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 156, "trial_id": "06536_00000", "date": "2024-08-11_17-42-48", "timestamp": 1723412568, "time_this_iter_s": 11.966274976730347, "time_total_s": 4107.614755868912, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317f7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4107.614755868912, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 48.58823529411765, "ram_util_percent": 83.17058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.935643027474483, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2065044100706777, "policy_loss": -0.004841047525405884, "vf_loss": 2.211345461010933, "vf_explained_var": 0.9441010606164734, "kl": 0.006231182343886635, "entropy": 0.3509177576440076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.058400975648688, "cur_kl_coeff": 9.46633086265214e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7405684068720175, "policy_loss": -0.0011219791307917268, "vf_loss": 2.7416903850893495, "vf_explained_var": 0.9319458492849239, "kl": 0.0028347125582615655, "entropy": 0.22342273683617356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "env_runners": {"episode_reward_max": 46.83104615481807, "episode_reward_min": -13.25688527672766, "episode_reward_mean": 16.738002679733448, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.83104615481812, "predator_policy": -13.788719204515443}, "policy_reward_max": {"prey_policy": 13.25688527672766, "predator_policy": 57.255668521697}, "policy_reward_mean": {"prey_policy": -16.738002679733444, "predator_policy": 16.738002679733444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.758504821214615, 11.256441164073191, 14.764034419739035, 13.88752772271811, 21.54517538433297, 23.72429965891074, 27.90694189560996, 25.14381553935288, 33.57977991526707, 13.630177265537405, 15.981136699430476, -0.4179029498128868, 21.111239967481204, -1.155146490558014, 21.853112738540506, 15.770312757836255, 16.747639270268778, 2.784908336023868, 26.633025571069467, 31.69494268535272, 18.00374608836377, -8.258492123752532, 42.782292059997424, 9.344109635316073, 13.06410844483677, 7.487965813086816, 17.823752672597205, 18.652812675702023, 2.2676282925924163, 36.9674662661456, 4.71065589381959, 26.01775482470281, 33.92680898916256, 18.326065485938656, 12.74052438069349, 0.22697126498934939, 23.95306705959548, 19.373137759514435, -8.317190260735297, 29.672471214875607, 17.5335348728637, 1.3931695246919498, 30.059182895110876, 11.861768576862975, 19.14565639262157, 18.679135022616304, 19.62884442648057, 4.536518217415133, 9.205933519179666, 9.143200315669263, 18.138203844119758, 22.06852965393, 6.878988729512588, 18.320113725165115, 46.10310287183955, 4.1899292214866986, 14.604859953421768, 27.831107072048898, 17.499153835485235, 14.837535779345103, 28.271300592065167, 15.119859530735777, -5.257230512677635, 24.06883074302904, -3.4226756576584627, 7.470039191519616, 10.552162399575318, 2.0641178488184506, 13.88766155825098, -0.20128306045573918, 13.624156027666018, 18.27405110477355, -0.7363147196755673, -2.354403994293289, -0.054527982004947795, 35.98501040203877, 30.931860513926726, 28.06520043366657, 28.520232177458396, 43.24728189226095, 44.89237182039791, 3.3153496078189972, 18.912348050494263, 18.54356637739389, 11.319680544599544, 17.75680914522727, 28.770519579378217, 33.62926954926284, 31.611030647170413, -13.25688527672766, 5.273426951012405, 46.83104615481807, 8.784129565543866, 18.8929329310921, 18.869162106262877, 11.206016825223617, 17.957665720844446, 20.644197074659704, 3.316704096874867, 31.85150675327965], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.758504821214608, -11.256441164073193, -14.764034419739042, -13.887527722718136, -21.545175384332953, -23.72429965891076, -27.90694189561, -25.143815539352925, -33.579779915267075, -13.630177265537384, -15.981136699430472, 0.4179029498128912, -21.11123996748123, 1.1551464905580158, -21.85311273854053, -15.770312757836257, -16.747639270268778, -2.7849083360238613, -26.63302557106948, -31.694942685352714, -18.003746088363776, 8.25849212375253, -42.782292059997474, -9.344109635316073, -13.064108444836764, -7.487965813086802, -17.82375267259718, -18.652812675702002, -2.267628292592418, -36.96746626614565, -4.710655893819581, -26.017754824702802, -33.92680898916253, -18.32606548593864, -12.740524380693486, -0.22697126498935294, -23.953067059595483, -19.373137759514428, 8.317190260735293, -29.67247121487553, -17.533534872863683, -1.3931695246919453, -30.05918289511088, -11.861768576862982, -19.145656392621603, -18.67913502261631, -19.628844426480526, -4.536518217415119, -9.205933519179675, -9.143200315669262, -18.138203844119698, -22.068529653929993, -6.878988729512585, -18.320113725165122, -46.10310287183959, -4.18992922148674, -14.604859953421759, -27.83110707204886, -17.49915383548528, -14.837535779345078, -28.271300592065195, -15.119859530735795, 5.2572305126776335, -24.06883074302902, 3.422675657658453, -7.47003919151962, -10.552162399575362, -2.0641178488184577, -13.887661558250981, 0.20128306045573208, -13.624156027665999, -18.274051104773534, 0.736314719675569, 2.3544039942932873, 0.05452798200496112, -35.98501040203875, -30.931860513926758, -28.065200433666575, -28.520232177458368, -43.24728189226111, -44.892371820397905, -3.3153496078189937, -18.912348050494263, -18.543566377393915, -11.31968054459951, -17.756809145227265, -28.770519579378213, -33.62926954926287, -31.611030647170505, 13.25688527672766, -5.273426951012399, -46.83104615481812, -8.784129565543854, -18.89293293109211, -18.869162106262852, -11.206016825223616, -17.957665720844457, -20.644197074659672, -3.316704096874877, -31.851506753279573], "policy_predator_policy_reward": [20.073625714702757, 19.443383927726465, 19.989419886097163, 2.5234624420492215, 12.215253435360838, 17.31281540411723, 23.289949530653683, 4.48510591478259, 15.214290821236656, 27.876059947429265, 36.107308743258145, 11.341290574563363, 27.471583264223487, 28.342300526996482, 27.789377372894595, 22.4982537058112, 18.09164295039868, 49.067916880135456, 20.213802571555977, 7.046551959518812, 9.631376426153288, 22.330896972707656, 5.458196923989251, -6.294002823615023, 14.557237485788688, 27.665242449173764, 4.293431097647053, -6.603724078763079, 19.37239293843598, 24.3338325386451, -5.0338250555198165, 36.574450571192344, 27.549311292833366, 5.945967247704166, 3.1755506345255617, 2.3942660375221605, 16.265936167319992, 37.000114974818956, 36.54620119857861, 26.843684172126842, 15.617039943265567, 20.39045223346198, -10.21348231555368, -6.3035019319513825, 36.340949819021816, 49.2236343009731, 2.056232433579023, 16.631986837053123, 12.876335439590587, 13.25188145008294, 6.725793318625034, 8.25013830754858, 7.4484099134085415, 28.199095431785835, 14.65844076832856, 22.64718458307548, 4.358396976530752, 0.17685960865409278, 33.99220826820751, 39.94272426408373, 14.687059855318157, -5.265748067678988, 24.67342023244832, 27.362089416957275, 30.65031510962833, 37.20330286869674, 9.674776406767476, 26.977354565109778, 12.114336839514593, 13.366711921872366, -0.6334328652521934, 1.0873753952308896, 20.145610152367322, 27.760523966823648, 18.04507624553135, 20.70119927349754, -11.967257593965964, -4.667122927504627, 37.50885564603507, 21.83608678371607, 34.572609640665576, 0.49446010506187044, 3.022943261568619, -0.2366042121847176, 35.62840511007332, 24.489960680148425, 22.11160275812247, 1.6119343956035062, 36.16544273707122, 2.1258700481719717, 6.874507017074085, 30.483763028158503, 16.46201086616111, 22.795677986799987, -0.14990183200437457, 9.222938266834603, 31.34210774152778, -12.930240703168455, 15.60356033329943, 2.6828402980390944, 13.971252594208842, 22.305155094030553, 22.73461344120453, 21.402445866655455, 22.635787537496043, -8.877810078470828, 19.27812884003295, 17.362098610297295, 48.834581438054265, 43.371624305624835, 8.974838007582196, -0.5949795646087406, 20.008596672329528, 9.20112323451401, 29.250997357678614, 26.411216786419143, 20.522358301632565, 14.475949369337956, 23.428537044993977, 6.2465345136962025, 32.809582174820804, 23.73301900930958, 8.958809394887211, 21.28090966658435, -8.887057211056643, -1.6274038142986171, 33.47373652748752, 14.663924958570508, -7.814642765524829, 0.9692914502079226, 18.606494712737437, -3.6664163296981975, -1.3708728902217207, 22.47519768937244, 3.3834593465238516, 0.744776351113055, 23.571803879553553, 4.203519236948399, 0.48958914018173694, -0.8921552610932082, 13.985709804359358, 13.262602250972638, 25.28681875137878, 11.261283458168286, 3.5272249908273423, -4.99985443017848, -2.217210998133284, -2.491596990453292, -6.715277237222622, 6.606221273212725, 34.22935172754235, 37.74066907653517, 33.4095755774115, 28.45414545044199, 32.00877994091029, 24.12162092642282, 25.08289879929185, 31.957565555624882, 38.44345972998454, 48.05110405453757, 46.80467364278868, 42.980069998007146, 15.381675544861908, -8.750976329223917, 6.424762458827091, 31.399933642161418, 18.68272809272161, 18.40440466206621, 0.2360204493617859, 22.403340639837225, 4.449589029258881, 31.064029261195678, 42.490925073371336, 15.050114085385086, 35.923410385695774, 31.33512871282998, 29.57760327494777, 33.64445801939319, -12.725051348939875, -13.788719204515443, 10.982553941388586, -0.4357000393637911, 36.40642378793916, 57.255668521697, 23.954700786368228, -6.3864416552805245, 28.94102921155603, 8.844836650628162, 7.530503754519602, 30.20782045800612, 6.310559156582683, 16.10147449386455, -0.6661889181980554, 36.581520359886966, 2.9965879816013263, 38.291806167717986, 9.006827660637843, -2.373419466888095, 40.3932905778188, 23.309722928740435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6188681539899907, "mean_inference_ms": 1.659176534813355, "mean_action_processing_ms": 0.2546473703813281, "mean_env_wait_ms": 0.14320321025582247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003970980644226074, "StateBufferConnector_ms": 0.003525853157043457, "ViewRequirementAgentConnector_ms": 0.1242755651473999}, "num_episodes": 18, "episode_return_max": 46.83104615481807, "episode_return_min": -13.25688527672766, "episode_return_mean": 16.738002679733448, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.2936087903668, "num_env_steps_trained_throughput_per_sec": 341.2936087903668, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1884000, "timers": {"training_iteration_time_ms": 11966.384, "restore_workers_time_ms": 0.047, "training_step_time_ms": 11966.181, "sample_time_ms": 1281.376, "learn_time_ms": 10656.089, "learn_throughput": 375.372, "synch_weights_time_ms": 26.998}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "done": false, "training_iteration": 157, "trial_id": "06536_00000", "date": "2024-08-11_17-43-00", "timestamp": 1723412580, "time_this_iter_s": 11.772090196609497, "time_total_s": 4119.386846065521, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317a1040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4119.386846065521, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 45.61764705882353, "ram_util_percent": 82.97647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7279551227887473, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.351450075705846, "policy_loss": -0.006772560934041394, "vf_loss": 1.3582226337244114, "vf_explained_var": 0.968103224473695, "kl": 0.005335465728926205, "entropy": 0.35515792495571075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8717508889379957, "cur_kl_coeff": 4.73316543132607e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.976701656914262, "policy_loss": -0.0018604629745746337, "vf_loss": 1.9785621200919783, "vf_explained_var": 0.9564822676951292, "kl": 0.0030056958386566256, "entropy": 0.18149456782315773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "env_runners": {"episode_reward_max": 46.83104615481807, "episode_reward_min": -13.25688527672766, "episode_reward_mean": 15.710318877389431, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.83104615481812, "predator_policy": -18.22631639039236}, "policy_reward_max": {"prey_policy": 13.25688527672766, "predator_policy": 57.255668521697}, "policy_reward_mean": {"prey_policy": -15.71031887738943, "predator_policy": 15.710318877389428}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.633025571069467, 31.69494268535272, 18.00374608836377, -8.258492123752532, 42.782292059997424, 9.344109635316073, 13.06410844483677, 7.487965813086816, 17.823752672597205, 18.652812675702023, 2.2676282925924163, 36.9674662661456, 4.71065589381959, 26.01775482470281, 33.92680898916256, 18.326065485938656, 12.74052438069349, 0.22697126498934939, 23.95306705959548, 19.373137759514435, -8.317190260735297, 29.672471214875607, 17.5335348728637, 1.3931695246919498, 30.059182895110876, 11.861768576862975, 19.14565639262157, 18.679135022616304, 19.62884442648057, 4.536518217415133, 9.205933519179666, 9.143200315669263, 18.138203844119758, 22.06852965393, 6.878988729512588, 18.320113725165115, 46.10310287183955, 4.1899292214866986, 14.604859953421768, 27.831107072048898, 17.499153835485235, 14.837535779345103, 28.271300592065167, 15.119859530735777, -5.257230512677635, 24.06883074302904, -3.4226756576584627, 7.470039191519616, 10.552162399575318, 2.0641178488184506, 13.88766155825098, -0.20128306045573918, 13.624156027666018, 18.27405110477355, -0.7363147196755673, -2.354403994293289, -0.054527982004947795, 35.98501040203877, 30.931860513926726, 28.06520043366657, 28.520232177458396, 43.24728189226095, 44.89237182039791, 3.3153496078189972, 18.912348050494263, 18.54356637739389, 11.319680544599544, 17.75680914522727, 28.770519579378217, 33.62926954926284, 31.611030647170413, -13.25688527672766, 5.273426951012405, 46.83104615481807, 8.784129565543866, 18.8929329310921, 18.869162106262877, 11.206016825223617, 17.957665720844446, 20.644197074659704, 3.316704096874867, 31.85150675327965, 1.0833229603344563, 15.844234505554223, 22.63333265651336, -9.298819319189823, 9.491569831618676, 16.13949797593046, 10.195182919531554, 17.799996260252858, 12.029179855594995, 21.131708892106467, 11.47044767708209, 24.756613673092755, 10.144633932994092, 4.211295072717315, 1.9212730853895508, 13.459093369711288, -6.772291290879617, 18.863345823209972], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.63302557106948, -31.694942685352714, -18.003746088363776, 8.25849212375253, -42.782292059997474, -9.344109635316073, -13.064108444836764, -7.487965813086802, -17.82375267259718, -18.652812675702002, -2.267628292592418, -36.96746626614565, -4.710655893819581, -26.017754824702802, -33.92680898916253, -18.32606548593864, -12.740524380693486, -0.22697126498935294, -23.953067059595483, -19.373137759514428, 8.317190260735293, -29.67247121487553, -17.533534872863683, -1.3931695246919453, -30.05918289511088, -11.861768576862982, -19.145656392621603, -18.67913502261631, -19.628844426480526, -4.536518217415119, -9.205933519179675, -9.143200315669262, -18.138203844119698, -22.068529653929993, -6.878988729512585, -18.320113725165122, -46.10310287183959, -4.18992922148674, -14.604859953421759, -27.83110707204886, -17.49915383548528, -14.837535779345078, -28.271300592065195, -15.119859530735795, 5.2572305126776335, -24.06883074302902, 3.422675657658453, -7.47003919151962, -10.552162399575362, -2.0641178488184577, -13.887661558250981, 0.20128306045573208, -13.624156027665999, -18.274051104773534, 0.736314719675569, 2.3544039942932873, 0.05452798200496112, -35.98501040203875, -30.931860513926758, -28.065200433666575, -28.520232177458368, -43.24728189226111, -44.892371820397905, -3.3153496078189937, -18.912348050494263, -18.543566377393915, -11.31968054459951, -17.756809145227265, -28.770519579378213, -33.62926954926287, -31.611030647170505, 13.25688527672766, -5.273426951012399, -46.83104615481812, -8.784129565543854, -18.89293293109211, -18.869162106262852, -11.206016825223616, -17.957665720844457, -20.644197074659672, -3.316704096874877, -31.851506753279573, -1.0833229603344865, -15.844234505554192, -22.63333265651334, 9.298819319189825, -9.491569831618694, -16.13949797593046, -10.195182919531545, -17.799996260252847, -12.029179855594993, -21.131708892106474, -11.470447677082053, -24.756613673092694, -10.144633932994115, -4.211295072717302, -1.9212730853895374, -13.459093369711265, 6.772291290879633, -18.863345823209986], "policy_predator_policy_reward": [16.265936167319992, 37.000114974818956, 36.54620119857861, 26.843684172126842, 15.617039943265567, 20.39045223346198, -10.21348231555368, -6.3035019319513825, 36.340949819021816, 49.2236343009731, 2.056232433579023, 16.631986837053123, 12.876335439590587, 13.25188145008294, 6.725793318625034, 8.25013830754858, 7.4484099134085415, 28.199095431785835, 14.65844076832856, 22.64718458307548, 4.358396976530752, 0.17685960865409278, 33.99220826820751, 39.94272426408373, 14.687059855318157, -5.265748067678988, 24.67342023244832, 27.362089416957275, 30.65031510962833, 37.20330286869674, 9.674776406767476, 26.977354565109778, 12.114336839514593, 13.366711921872366, -0.6334328652521934, 1.0873753952308896, 20.145610152367322, 27.760523966823648, 18.04507624553135, 20.70119927349754, -11.967257593965964, -4.667122927504627, 37.50885564603507, 21.83608678371607, 34.572609640665576, 0.49446010506187044, 3.022943261568619, -0.2366042121847176, 35.62840511007332, 24.489960680148425, 22.11160275812247, 1.6119343956035062, 36.16544273707122, 2.1258700481719717, 6.874507017074085, 30.483763028158503, 16.46201086616111, 22.795677986799987, -0.14990183200437457, 9.222938266834603, 31.34210774152778, -12.930240703168455, 15.60356033329943, 2.6828402980390944, 13.971252594208842, 22.305155094030553, 22.73461344120453, 21.402445866655455, 22.635787537496043, -8.877810078470828, 19.27812884003295, 17.362098610297295, 48.834581438054265, 43.371624305624835, 8.974838007582196, -0.5949795646087406, 20.008596672329528, 9.20112323451401, 29.250997357678614, 26.411216786419143, 20.522358301632565, 14.475949369337956, 23.428537044993977, 6.2465345136962025, 32.809582174820804, 23.73301900930958, 8.958809394887211, 21.28090966658435, -8.887057211056643, -1.6274038142986171, 33.47373652748752, 14.663924958570508, -7.814642765524829, 0.9692914502079226, 18.606494712737437, -3.6664163296981975, -1.3708728902217207, 22.47519768937244, 3.3834593465238516, 0.744776351113055, 23.571803879553553, 4.203519236948399, 0.48958914018173694, -0.8921552610932082, 13.985709804359358, 13.262602250972638, 25.28681875137878, 11.261283458168286, 3.5272249908273423, -4.99985443017848, -2.217210998133284, -2.491596990453292, -6.715277237222622, 6.606221273212725, 34.22935172754235, 37.74066907653517, 33.4095755774115, 28.45414545044199, 32.00877994091029, 24.12162092642282, 25.08289879929185, 31.957565555624882, 38.44345972998454, 48.05110405453757, 46.80467364278868, 42.980069998007146, 15.381675544861908, -8.750976329223917, 6.424762458827091, 31.399933642161418, 18.68272809272161, 18.40440466206621, 0.2360204493617859, 22.403340639837225, 4.449589029258881, 31.064029261195678, 42.490925073371336, 15.050114085385086, 35.923410385695774, 31.33512871282998, 29.57760327494777, 33.64445801939319, -12.725051348939875, -13.788719204515443, 10.982553941388586, -0.4357000393637911, 36.40642378793916, 57.255668521697, 23.954700786368228, -6.3864416552805245, 28.94102921155603, 8.844836650628162, 7.530503754519602, 30.20782045800612, 6.310559156582683, 16.10147449386455, -0.6661889181980554, 36.581520359886966, 2.9965879816013263, 38.291806167717986, 9.006827660637843, -2.373419466888095, 40.3932905778188, 23.309722928740435, -4.894778514009564, 7.061424434678507, 5.688641079551159, 25.999827931557206, 28.116089130970316, 17.150576182056344, -10.093223546716263, -8.50441509166338, 8.877702188015686, 10.105437475221692, 8.022734841710168, 24.25626111015075, 23.91748202283648, -3.5271161837733462, 25.399368413481685, 10.200624107024028, 18.26446178385337, 5.793897927336621, 27.265521244620906, 14.997896539592016, 19.898736034103116, 3.042159320060991, 32.52005200845952, 16.99317533772593, 15.810981818989827, 4.478286046998409, 8.695865978638833, -0.2732758332042202, 0.6983516842224979, 3.1441944865565823, 19.999424792980754, 6.9187619464417995, -18.22631639039236, 4.681733808633087, 19.87426459937292, 17.852427047046994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6190253168448133, "mean_inference_ms": 1.659145025357771, "mean_action_processing_ms": 0.25473156017135146, "mean_env_wait_ms": 0.14321146632201548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038716793060302734, "StateBufferConnector_ms": 0.0033805370330810547, "ViewRequirementAgentConnector_ms": 0.11391985416412354}, "num_episodes": 18, "episode_return_max": 46.83104615481807, "episode_return_min": -13.25688527672766, "episode_return_mean": 15.710318877389431, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.24937486206227, "num_env_steps_trained_throughput_per_sec": 329.24937486206227, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1896000, "timers": {"training_iteration_time_ms": 11967.807, "restore_workers_time_ms": 0.046, "training_step_time_ms": 11967.607, "sample_time_ms": 1330.578, "learn_time_ms": 10608.274, "learn_throughput": 377.064, "synch_weights_time_ms": 27.013}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "done": false, "training_iteration": 158, "trial_id": "06536_00000", "date": "2024-08-11_17-43-12", "timestamp": 1723412592, "time_this_iter_s": 12.189885139465332, "time_total_s": 4131.576731204987, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b589a1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4131.576731204987, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 47.647058823529406, "ram_util_percent": 83.12352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5778880746414266, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0731786843389273, "policy_loss": -0.005639933829176395, "vf_loss": 2.078818615525961, "vf_explained_var": 0.9181309953331948, "kl": 0.005853743072029498, "entropy": 0.3775287103839219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.781571055720092, "cur_kl_coeff": 2.366582715663035e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5793509041821516, "policy_loss": -0.0019156124292522983, "vf_loss": 2.581266516730899, "vf_explained_var": 0.9191071850597543, "kl": 0.0035414882993547486, "entropy": 0.22836392870340397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "env_runners": {"episode_reward_max": 46.83104615481807, "episode_reward_min": -13.25688527672766, "episode_reward_mean": 14.749202734427605, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.83104615481812, "predator_policy": -18.22631639039236}, "policy_reward_max": {"prey_policy": 13.25688527672766, "predator_policy": 57.255668521697}, "policy_reward_mean": {"prey_policy": -14.749202734427605, "predator_policy": 14.749202734427605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.95306705959548, 19.373137759514435, -8.317190260735297, 29.672471214875607, 17.5335348728637, 1.3931695246919498, 30.059182895110876, 11.861768576862975, 19.14565639262157, 18.679135022616304, 19.62884442648057, 4.536518217415133, 9.205933519179666, 9.143200315669263, 18.138203844119758, 22.06852965393, 6.878988729512588, 18.320113725165115, 46.10310287183955, 4.1899292214866986, 14.604859953421768, 27.831107072048898, 17.499153835485235, 14.837535779345103, 28.271300592065167, 15.119859530735777, -5.257230512677635, 24.06883074302904, -3.4226756576584627, 7.470039191519616, 10.552162399575318, 2.0641178488184506, 13.88766155825098, -0.20128306045573918, 13.624156027666018, 18.27405110477355, -0.7363147196755673, -2.354403994293289, -0.054527982004947795, 35.98501040203877, 30.931860513926726, 28.06520043366657, 28.520232177458396, 43.24728189226095, 44.89237182039791, 3.3153496078189972, 18.912348050494263, 18.54356637739389, 11.319680544599544, 17.75680914522727, 28.770519579378217, 33.62926954926284, 31.611030647170413, -13.25688527672766, 5.273426951012405, 46.83104615481807, 8.784129565543866, 18.8929329310921, 18.869162106262877, 11.206016825223617, 17.957665720844446, 20.644197074659704, 3.316704096874867, 31.85150675327965, 1.0833229603344563, 15.844234505554223, 22.63333265651336, -9.298819319189823, 9.491569831618676, 16.13949797593046, 10.195182919531554, 17.799996260252858, 12.029179855594995, 21.131708892106467, 11.47044767708209, 24.756613673092755, 10.144633932994092, 4.211295072717315, 1.9212730853895508, 13.459093369711288, -6.772291290879617, 18.863345823209972, -0.8910658454463514, -13.067902080948206, 18.350586037243417, 12.811843110378364, 2.1729611095405703, 8.1685894050747, 15.7179382132489, 40.38844969786982, 18.51789025103478, 7.280364248606562, 22.49200116974265, 4.860030321970719, 11.958002844136331, 9.814318041781998, 10.147874850689783, 10.55263984539664, 19.33315953992767, 17.692843864183605], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.953067059595483, -19.373137759514428, 8.317190260735293, -29.67247121487553, -17.533534872863683, -1.3931695246919453, -30.05918289511088, -11.861768576862982, -19.145656392621603, -18.67913502261631, -19.628844426480526, -4.536518217415119, -9.205933519179675, -9.143200315669262, -18.138203844119698, -22.068529653929993, -6.878988729512585, -18.320113725165122, -46.10310287183959, -4.18992922148674, -14.604859953421759, -27.83110707204886, -17.49915383548528, -14.837535779345078, -28.271300592065195, -15.119859530735795, 5.2572305126776335, -24.06883074302902, 3.422675657658453, -7.47003919151962, -10.552162399575362, -2.0641178488184577, -13.887661558250981, 0.20128306045573208, -13.624156027665999, -18.274051104773534, 0.736314719675569, 2.3544039942932873, 0.05452798200496112, -35.98501040203875, -30.931860513926758, -28.065200433666575, -28.520232177458368, -43.24728189226111, -44.892371820397905, -3.3153496078189937, -18.912348050494263, -18.543566377393915, -11.31968054459951, -17.756809145227265, -28.770519579378213, -33.62926954926287, -31.611030647170505, 13.25688527672766, -5.273426951012399, -46.83104615481812, -8.784129565543854, -18.89293293109211, -18.869162106262852, -11.206016825223616, -17.957665720844457, -20.644197074659672, -3.316704096874877, -31.851506753279573, -1.0833229603344865, -15.844234505554192, -22.63333265651334, 9.298819319189825, -9.491569831618694, -16.13949797593046, -10.195182919531545, -17.799996260252847, -12.029179855594993, -21.131708892106474, -11.470447677082053, -24.756613673092694, -10.144633932994115, -4.211295072717302, -1.9212730853895374, -13.459093369711265, 6.772291290879633, -18.863345823209986, 0.8910658454463567, 13.067902080948205, -18.35058603724341, -12.811843110378359, -2.1729611095405543, -8.168589405074679, -15.717938213248885, -40.38844969786978, -18.517890251034782, -7.280364248606606, -22.49200116974264, -4.860030321970718, -11.958002844136347, -9.814318041781998, -10.147874850689789, -10.552639845396628, -19.333159539927685, -17.692843864183608], "policy_predator_policy_reward": [20.145610152367322, 27.760523966823648, 18.04507624553135, 20.70119927349754, -11.967257593965964, -4.667122927504627, 37.50885564603507, 21.83608678371607, 34.572609640665576, 0.49446010506187044, 3.022943261568619, -0.2366042121847176, 35.62840511007332, 24.489960680148425, 22.11160275812247, 1.6119343956035062, 36.16544273707122, 2.1258700481719717, 6.874507017074085, 30.483763028158503, 16.46201086616111, 22.795677986799987, -0.14990183200437457, 9.222938266834603, 31.34210774152778, -12.930240703168455, 15.60356033329943, 2.6828402980390944, 13.971252594208842, 22.305155094030553, 22.73461344120453, 21.402445866655455, 22.635787537496043, -8.877810078470828, 19.27812884003295, 17.362098610297295, 48.834581438054265, 43.371624305624835, 8.974838007582196, -0.5949795646087406, 20.008596672329528, 9.20112323451401, 29.250997357678614, 26.411216786419143, 20.522358301632565, 14.475949369337956, 23.428537044993977, 6.2465345136962025, 32.809582174820804, 23.73301900930958, 8.958809394887211, 21.28090966658435, -8.887057211056643, -1.6274038142986171, 33.47373652748752, 14.663924958570508, -7.814642765524829, 0.9692914502079226, 18.606494712737437, -3.6664163296981975, -1.3708728902217207, 22.47519768937244, 3.3834593465238516, 0.744776351113055, 23.571803879553553, 4.203519236948399, 0.48958914018173694, -0.8921552610932082, 13.985709804359358, 13.262602250972638, 25.28681875137878, 11.261283458168286, 3.5272249908273423, -4.99985443017848, -2.217210998133284, -2.491596990453292, -6.715277237222622, 6.606221273212725, 34.22935172754235, 37.74066907653517, 33.4095755774115, 28.45414545044199, 32.00877994091029, 24.12162092642282, 25.08289879929185, 31.957565555624882, 38.44345972998454, 48.05110405453757, 46.80467364278868, 42.980069998007146, 15.381675544861908, -8.750976329223917, 6.424762458827091, 31.399933642161418, 18.68272809272161, 18.40440466206621, 0.2360204493617859, 22.403340639837225, 4.449589029258881, 31.064029261195678, 42.490925073371336, 15.050114085385086, 35.923410385695774, 31.33512871282998, 29.57760327494777, 33.64445801939319, -12.725051348939875, -13.788719204515443, 10.982553941388586, -0.4357000393637911, 36.40642378793916, 57.255668521697, 23.954700786368228, -6.3864416552805245, 28.94102921155603, 8.844836650628162, 7.530503754519602, 30.20782045800612, 6.310559156582683, 16.10147449386455, -0.6661889181980554, 36.581520359886966, 2.9965879816013263, 38.291806167717986, 9.006827660637843, -2.373419466888095, 40.3932905778188, 23.309722928740435, -4.894778514009564, 7.061424434678507, 5.688641079551159, 25.999827931557206, 28.116089130970316, 17.150576182056344, -10.093223546716263, -8.50441509166338, 8.877702188015686, 10.105437475221692, 8.022734841710168, 24.25626111015075, 23.91748202283648, -3.5271161837733462, 25.399368413481685, 10.200624107024028, 18.26446178385337, 5.793897927336621, 27.265521244620906, 14.997896539592016, 19.898736034103116, 3.042159320060991, 32.52005200845952, 16.99317533772593, 15.810981818989827, 4.478286046998409, 8.695865978638833, -0.2732758332042202, 0.6983516842224979, 3.1441944865565823, 19.999424792980754, 6.9187619464417995, -18.22631639039236, 4.681733808633087, 19.87426459937292, 17.852427047046994, 12.569309319117881, -14.351441010010568, -13.19732411543297, -12.938480046463452, 18.410733996146984, 18.290438078339832, 18.780158542303496, 6.843527678453237, -9.322957908892155, 13.6688801279733, 2.1244576117184284, 14.212721198430929, 17.336511075005745, 14.099365351492043, 28.194416765758373, 52.582482629981214, 11.75108498854789, 25.28469551352172, 19.695826264636388, -5.135097767423179, 20.9869729835223, 23.997029355963, 2.5051669200188584, 7.214893723922572, -3.0778038963701455, 26.993809584642904, 12.873614810345355, 6.755021273218647, 1.1954507215091628, 19.100298979870416, 28.459626507104804, -7.354346816311544, 15.261240533493668, 23.40507854636168, 4.834440599722429, 30.551247128644775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6193263787708811, "mean_inference_ms": 1.6593868394544125, "mean_action_processing_ms": 0.25481454936134773, "mean_env_wait_ms": 0.1432359747997325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050601959228515625, "StateBufferConnector_ms": 0.0031551122665405273, "ViewRequirementAgentConnector_ms": 0.11842572689056396}, "num_episodes": 18, "episode_return_max": 46.83104615481807, "episode_return_min": -13.25688527672766, "episode_return_mean": 14.749202734427605, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.3616709541327, "num_env_steps_trained_throughput_per_sec": 326.3616709541327, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1908000, "timers": {"training_iteration_time_ms": 12033.164, "restore_workers_time_ms": 0.046, "training_step_time_ms": 12032.972, "sample_time_ms": 1365.403, "learn_time_ms": 10639.251, "learn_throughput": 375.966, "synch_weights_time_ms": 25.78}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "done": false, "training_iteration": 159, "trial_id": "06536_00000", "date": "2024-08-11_17-43-24", "timestamp": 1723412604, "time_this_iter_s": 12.29446291923523, "time_total_s": 4143.871194124222, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317f7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4143.871194124222, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 48.72222222222222, "ram_util_percent": 83.1222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8645970073218145, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9949252379437288, "policy_loss": -0.011519839471535913, "vf_loss": 2.00644507308801, "vf_explained_var": 0.9473133323714137, "kl": 0.010950532694606826, "entropy": 0.4120768736116588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.066987572523652, "cur_kl_coeff": 1.1832913578315174e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6233535244351343, "policy_loss": -0.0019028779181464522, "vf_loss": 2.625256404737947, "vf_explained_var": 0.9460427933269077, "kl": 0.003161530759164044, "entropy": 0.19451071982661253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 46.83104615481807, "episode_reward_min": -13.25688527672766, "episode_reward_mean": 15.057110705415603, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.83104615481812, "predator_policy": -18.22631639039236}, "policy_reward_max": {"prey_policy": 13.25688527672766, "predator_policy": 57.255668521697}, "policy_reward_mean": {"prey_policy": -15.057110705415603, "predator_policy": 15.057110705415603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.06883074302904, -3.4226756576584627, 7.470039191519616, 10.552162399575318, 2.0641178488184506, 13.88766155825098, -0.20128306045573918, 13.624156027666018, 18.27405110477355, -0.7363147196755673, -2.354403994293289, -0.054527982004947795, 35.98501040203877, 30.931860513926726, 28.06520043366657, 28.520232177458396, 43.24728189226095, 44.89237182039791, 3.3153496078189972, 18.912348050494263, 18.54356637739389, 11.319680544599544, 17.75680914522727, 28.770519579378217, 33.62926954926284, 31.611030647170413, -13.25688527672766, 5.273426951012405, 46.83104615481807, 8.784129565543866, 18.8929329310921, 18.869162106262877, 11.206016825223617, 17.957665720844446, 20.644197074659704, 3.316704096874867, 31.85150675327965, 1.0833229603344563, 15.844234505554223, 22.63333265651336, -9.298819319189823, 9.491569831618676, 16.13949797593046, 10.195182919531554, 17.799996260252858, 12.029179855594995, 21.131708892106467, 11.47044767708209, 24.756613673092755, 10.144633932994092, 4.211295072717315, 1.9212730853895508, 13.459093369711288, -6.772291290879617, 18.863345823209972, -0.8910658454463514, -13.067902080948206, 18.350586037243417, 12.811843110378364, 2.1729611095405703, 8.1685894050747, 15.7179382132489, 40.38844969786982, 18.51789025103478, 7.280364248606562, 22.49200116974265, 4.860030321970719, 11.958002844136331, 9.814318041781998, 10.147874850689783, 10.55263984539664, 19.33315953992767, 17.692843864183605, 2.1906205545331208, 10.530977668118622, 43.85963878208208, -2.823870109972665, 14.307691093089234, 22.03398609105136, 25.06402460928122, 9.977983470238971, 13.563203093042334, 17.176349172735925, 32.44046590744536, 8.119328371678538, 18.055915185417, 13.39026926412391, 3.104229365858931, 27.09728614699356, 21.840284327972494, 14.510683436261795, 17.935683629261867, 7.772928022094456, 36.92084235421516, 10.683590960950188, 32.75458816229266, 26.025924892393647, 18.836615746519406, 6.823048748115363, 13.072391986245474], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.06883074302902, 3.422675657658453, -7.47003919151962, -10.552162399575362, -2.0641178488184577, -13.887661558250981, 0.20128306045573208, -13.624156027665999, -18.274051104773534, 0.736314719675569, 2.3544039942932873, 0.05452798200496112, -35.98501040203875, -30.931860513926758, -28.065200433666575, -28.520232177458368, -43.24728189226111, -44.892371820397905, -3.3153496078189937, -18.912348050494263, -18.543566377393915, -11.31968054459951, -17.756809145227265, -28.770519579378213, -33.62926954926287, -31.611030647170505, 13.25688527672766, -5.273426951012399, -46.83104615481812, -8.784129565543854, -18.89293293109211, -18.869162106262852, -11.206016825223616, -17.957665720844457, -20.644197074659672, -3.316704096874877, -31.851506753279573, -1.0833229603344865, -15.844234505554192, -22.63333265651334, 9.298819319189825, -9.491569831618694, -16.13949797593046, -10.195182919531545, -17.799996260252847, -12.029179855594993, -21.131708892106474, -11.470447677082053, -24.756613673092694, -10.144633932994115, -4.211295072717302, -1.9212730853895374, -13.459093369711265, 6.772291290879633, -18.863345823209986, 0.8910658454463567, 13.067902080948205, -18.35058603724341, -12.811843110378359, -2.1729611095405543, -8.168589405074679, -15.717938213248885, -40.38844969786978, -18.517890251034782, -7.280364248606606, -22.49200116974264, -4.860030321970718, -11.958002844136347, -9.814318041781998, -10.147874850689789, -10.552639845396628, -19.333159539927685, -17.692843864183608, -2.190620554533126, -10.530977668118638, -43.85963878208213, 2.823870109972665, -14.30769109308923, -22.03398609105137, -25.06402460928122, -9.977983470238971, -13.563203093042297, -17.17634917273591, -32.44046590744531, -8.11932837167855, -18.05591518541699, -13.390269264123903, -3.104229365858944, -27.097286146993575, -21.840284327972526, -14.5106834362618, -17.935683629261884, -7.772928022094469, -36.920842354215125, -10.68359096095019, -32.75458816229264, -26.02592489239364, -18.836615746519403, -6.823048748115369, -13.072391986245483], "policy_predator_policy_reward": [33.47373652748752, 14.663924958570508, -7.814642765524829, 0.9692914502079226, 18.606494712737437, -3.6664163296981975, -1.3708728902217207, 22.47519768937244, 3.3834593465238516, 0.744776351113055, 23.571803879553553, 4.203519236948399, 0.48958914018173694, -0.8921552610932082, 13.985709804359358, 13.262602250972638, 25.28681875137878, 11.261283458168286, 3.5272249908273423, -4.99985443017848, -2.217210998133284, -2.491596990453292, -6.715277237222622, 6.606221273212725, 34.22935172754235, 37.74066907653517, 33.4095755774115, 28.45414545044199, 32.00877994091029, 24.12162092642282, 25.08289879929185, 31.957565555624882, 38.44345972998454, 48.05110405453757, 46.80467364278868, 42.980069998007146, 15.381675544861908, -8.750976329223917, 6.424762458827091, 31.399933642161418, 18.68272809272161, 18.40440466206621, 0.2360204493617859, 22.403340639837225, 4.449589029258881, 31.064029261195678, 42.490925073371336, 15.050114085385086, 35.923410385695774, 31.33512871282998, 29.57760327494777, 33.64445801939319, -12.725051348939875, -13.788719204515443, 10.982553941388586, -0.4357000393637911, 36.40642378793916, 57.255668521697, 23.954700786368228, -6.3864416552805245, 28.94102921155603, 8.844836650628162, 7.530503754519602, 30.20782045800612, 6.310559156582683, 16.10147449386455, -0.6661889181980554, 36.581520359886966, 2.9965879816013263, 38.291806167717986, 9.006827660637843, -2.373419466888095, 40.3932905778188, 23.309722928740435, -4.894778514009564, 7.061424434678507, 5.688641079551159, 25.999827931557206, 28.116089130970316, 17.150576182056344, -10.093223546716263, -8.50441509166338, 8.877702188015686, 10.105437475221692, 8.022734841710168, 24.25626111015075, 23.91748202283648, -3.5271161837733462, 25.399368413481685, 10.200624107024028, 18.26446178385337, 5.793897927336621, 27.265521244620906, 14.997896539592016, 19.898736034103116, 3.042159320060991, 32.52005200845952, 16.99317533772593, 15.810981818989827, 4.478286046998409, 8.695865978638833, -0.2732758332042202, 0.6983516842224979, 3.1441944865565823, 19.999424792980754, 6.9187619464417995, -18.22631639039236, 4.681733808633087, 19.87426459937292, 17.852427047046994, 12.569309319117881, -14.351441010010568, -13.19732411543297, -12.938480046463452, 18.410733996146984, 18.290438078339832, 18.780158542303496, 6.843527678453237, -9.322957908892155, 13.6688801279733, 2.1244576117184284, 14.212721198430929, 17.336511075005745, 14.099365351492043, 28.194416765758373, 52.582482629981214, 11.75108498854789, 25.28469551352172, 19.695826264636388, -5.135097767423179, 20.9869729835223, 23.997029355963, 2.5051669200188584, 7.214893723922572, -3.0778038963701455, 26.993809584642904, 12.873614810345355, 6.755021273218647, 1.1954507215091628, 19.100298979870416, 28.459626507104804, -7.354346816311544, 15.261240533493668, 23.40507854636168, 4.834440599722429, 30.551247128644775, 3.0820637001535918, 1.2991774089126515, 10.451701477711708, 10.610253858525631, 30.850717219850342, 56.8685603443139, 2.384369043776106, -8.03210926372143, 13.834752687598579, 14.780629498579883, 30.79220448914887, 13.27576769295381, 28.016062958621475, 22.111986259941013, 12.98912259397741, 6.966844346500526, 3.0470720911947513, 24.07933409488986, 27.016190358580836, 7.336507986891025, 29.20502685441945, 35.67590496047117, 8.114474085315537, 8.124182658041562, 7.154038835303899, 28.95779153553009, 7.432702037356719, 19.34783649089109, 8.189224015625143, -1.9807652839072691, 31.728318395957885, 22.46625389802926, 9.021068958033087, 34.65949969791194, 14.46950707760348, 14.551859794920144, 26.50155807286027, 9.369809185663492, 15.881478309303617, -0.33562226511469184, 35.746230745305766, 38.09545396312452, 9.687263179123187, 11.67991874277719, 32.02464627011959, 33.48453005446571, 38.07936384581484, 13.972485938972431, 13.82187604213065, 23.851355450908173, 9.613507867411036, 4.032589628819704, 1.6159004758684254, 24.52888349662254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6194077014815227, "mean_inference_ms": 1.6587684650994285, "mean_action_processing_ms": 0.2547595294541413, "mean_env_wait_ms": 0.14325219747774504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071392059326171875, "StateBufferConnector_ms": 0.003724336624145508, "ViewRequirementAgentConnector_ms": 0.11270368099212646}, "num_episodes": 27, "episode_return_max": 46.83104615481807, "episode_return_min": -13.25688527672766, "episode_return_mean": 15.057110705415603, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.6179897370845, "num_env_steps_trained_throughput_per_sec": 247.6179897370845, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 12343.698, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12343.56, "sample_time_ms": 1411.343, "learn_time_ms": 10903.947, "learn_throughput": 366.84, "synch_weights_time_ms": 26.123}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 160, "trial_id": "06536_00000", "date": "2024-08-11_17-43-40", "timestamp": 1723412620, "time_this_iter_s": 16.19923734664917, "time_total_s": 4160.070431470871, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b589a430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4160.070431470871, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 63.665217391304346, "ram_util_percent": 82.97826086956523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8000988251219194, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5341514982283115, "policy_loss": -0.005808180782575316, "vf_loss": 1.5399596839522323, "vf_explained_var": 0.9664704689756036, "kl": 0.006790660379083398, "entropy": 0.4114761876873672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.067252239537617, "cur_kl_coeff": 5.916456789157587e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1997269710535727, "policy_loss": -0.01273159592870682, "vf_loss": 2.2124585686537324, "vf_explained_var": 0.9543532237489387, "kl": 0.04264850999438852, "entropy": 0.265688212200132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "env_runners": {"episode_reward_max": 46.83104615481807, "episode_reward_min": -13.25688527672766, "episode_reward_mean": 14.848917268969412, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.83104615481812, "predator_policy": -18.22631639039236}, "policy_reward_max": {"prey_policy": 13.25688527672766, "predator_policy": 57.255668521697}, "policy_reward_mean": {"prey_policy": -14.848917268969409, "predator_policy": 14.84891726896941}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.3153496078189972, 18.912348050494263, 18.54356637739389, 11.319680544599544, 17.75680914522727, 28.770519579378217, 33.62926954926284, 31.611030647170413, -13.25688527672766, 5.273426951012405, 46.83104615481807, 8.784129565543866, 18.8929329310921, 18.869162106262877, 11.206016825223617, 17.957665720844446, 20.644197074659704, 3.316704096874867, 31.85150675327965, 1.0833229603344563, 15.844234505554223, 22.63333265651336, -9.298819319189823, 9.491569831618676, 16.13949797593046, 10.195182919531554, 17.799996260252858, 12.029179855594995, 21.131708892106467, 11.47044767708209, 24.756613673092755, 10.144633932994092, 4.211295072717315, 1.9212730853895508, 13.459093369711288, -6.772291290879617, 18.863345823209972, -0.8910658454463514, -13.067902080948206, 18.350586037243417, 12.811843110378364, 2.1729611095405703, 8.1685894050747, 15.7179382132489, 40.38844969786982, 18.51789025103478, 7.280364248606562, 22.49200116974265, 4.860030321970719, 11.958002844136331, 9.814318041781998, 10.147874850689783, 10.55263984539664, 19.33315953992767, 17.692843864183605, 2.1906205545331208, 10.530977668118622, 43.85963878208208, -2.823870109972665, 14.307691093089234, 22.03398609105136, 25.06402460928122, 9.977983470238971, 13.563203093042334, 17.176349172735925, 32.44046590744536, 8.119328371678538, 18.055915185417, 13.39026926412391, 3.104229365858931, 27.09728614699356, 21.840284327972494, 14.510683436261795, 17.935683629261867, 7.772928022094456, 36.92084235421516, 10.683590960950188, 32.75458816229266, 26.025924892393647, 18.836615746519406, 6.823048748115363, 13.072391986245474, 12.967765030406573, 25.8555702313086, 18.977348092571045, 20.903418992009215, 2.1334568337072684, 15.790798957665068, 25.145704894140977, 13.413174132762217, 6.95992414279544, 30.636343152895602, 32.16955163311491, 22.70930317745229, 10.227237957193859, 20.73266683321936, 13.011993877712845, 12.787525933474056, -3.5432177387944543, -6.884139078959825], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.3153496078189937, -18.912348050494263, -18.543566377393915, -11.31968054459951, -17.756809145227265, -28.770519579378213, -33.62926954926287, -31.611030647170505, 13.25688527672766, -5.273426951012399, -46.83104615481812, -8.784129565543854, -18.89293293109211, -18.869162106262852, -11.206016825223616, -17.957665720844457, -20.644197074659672, -3.316704096874877, -31.851506753279573, -1.0833229603344865, -15.844234505554192, -22.63333265651334, 9.298819319189825, -9.491569831618694, -16.13949797593046, -10.195182919531545, -17.799996260252847, -12.029179855594993, -21.131708892106474, -11.470447677082053, -24.756613673092694, -10.144633932994115, -4.211295072717302, -1.9212730853895374, -13.459093369711265, 6.772291290879633, -18.863345823209986, 0.8910658454463567, 13.067902080948205, -18.35058603724341, -12.811843110378359, -2.1729611095405543, -8.168589405074679, -15.717938213248885, -40.38844969786978, -18.517890251034782, -7.280364248606606, -22.49200116974264, -4.860030321970718, -11.958002844136347, -9.814318041781998, -10.147874850689789, -10.552639845396628, -19.333159539927685, -17.692843864183608, -2.190620554533126, -10.530977668118638, -43.85963878208213, 2.823870109972665, -14.30769109308923, -22.03398609105137, -25.06402460928122, -9.977983470238971, -13.563203093042297, -17.17634917273591, -32.44046590744531, -8.11932837167855, -18.05591518541699, -13.390269264123903, -3.104229365858944, -27.097286146993575, -21.840284327972526, -14.5106834362618, -17.935683629261884, -7.772928022094469, -36.920842354215125, -10.68359096095019, -32.75458816229264, -26.02592489239364, -18.836615746519403, -6.823048748115369, -13.072391986245483, -12.967765030406587, -25.85557023130861, -18.97734809257106, -20.9034189920092, -2.1334568337072524, -15.790798957665032, -25.145704894141005, -13.413174132762212, -6.959924142795439, -30.636343152895584, -32.16955163311486, -22.7093031774523, -10.22723795719387, -20.732666833219362, -13.011993877712847, -12.787525933474033, 3.543217738794456, 6.884139078959831], "policy_predator_policy_reward": [15.381675544861908, -8.750976329223917, 6.424762458827091, 31.399933642161418, 18.68272809272161, 18.40440466206621, 0.2360204493617859, 22.403340639837225, 4.449589029258881, 31.064029261195678, 42.490925073371336, 15.050114085385086, 35.923410385695774, 31.33512871282998, 29.57760327494777, 33.64445801939319, -12.725051348939875, -13.788719204515443, 10.982553941388586, -0.4357000393637911, 36.40642378793916, 57.255668521697, 23.954700786368228, -6.3864416552805245, 28.94102921155603, 8.844836650628162, 7.530503754519602, 30.20782045800612, 6.310559156582683, 16.10147449386455, -0.6661889181980554, 36.581520359886966, 2.9965879816013263, 38.291806167717986, 9.006827660637843, -2.373419466888095, 40.3932905778188, 23.309722928740435, -4.894778514009564, 7.061424434678507, 5.688641079551159, 25.999827931557206, 28.116089130970316, 17.150576182056344, -10.093223546716263, -8.50441509166338, 8.877702188015686, 10.105437475221692, 8.022734841710168, 24.25626111015075, 23.91748202283648, -3.5271161837733462, 25.399368413481685, 10.200624107024028, 18.26446178385337, 5.793897927336621, 27.265521244620906, 14.997896539592016, 19.898736034103116, 3.042159320060991, 32.52005200845952, 16.99317533772593, 15.810981818989827, 4.478286046998409, 8.695865978638833, -0.2732758332042202, 0.6983516842224979, 3.1441944865565823, 19.999424792980754, 6.9187619464417995, -18.22631639039236, 4.681733808633087, 19.87426459937292, 17.852427047046994, 12.569309319117881, -14.351441010010568, -13.19732411543297, -12.938480046463452, 18.410733996146984, 18.290438078339832, 18.780158542303496, 6.843527678453237, -9.322957908892155, 13.6688801279733, 2.1244576117184284, 14.212721198430929, 17.336511075005745, 14.099365351492043, 28.194416765758373, 52.582482629981214, 11.75108498854789, 25.28469551352172, 19.695826264636388, -5.135097767423179, 20.9869729835223, 23.997029355963, 2.5051669200188584, 7.214893723922572, -3.0778038963701455, 26.993809584642904, 12.873614810345355, 6.755021273218647, 1.1954507215091628, 19.100298979870416, 28.459626507104804, -7.354346816311544, 15.261240533493668, 23.40507854636168, 4.834440599722429, 30.551247128644775, 3.0820637001535918, 1.2991774089126515, 10.451701477711708, 10.610253858525631, 30.850717219850342, 56.8685603443139, 2.384369043776106, -8.03210926372143, 13.834752687598579, 14.780629498579883, 30.79220448914887, 13.27576769295381, 28.016062958621475, 22.111986259941013, 12.98912259397741, 6.966844346500526, 3.0470720911947513, 24.07933409488986, 27.016190358580836, 7.336507986891025, 29.20502685441945, 35.67590496047117, 8.114474085315537, 8.124182658041562, 7.154038835303899, 28.95779153553009, 7.432702037356719, 19.34783649089109, 8.189224015625143, -1.9807652839072691, 31.728318395957885, 22.46625389802926, 9.021068958033087, 34.65949969791194, 14.46950707760348, 14.551859794920144, 26.50155807286027, 9.369809185663492, 15.881478309303617, -0.33562226511469184, 35.746230745305766, 38.09545396312452, 9.687263179123187, 11.67991874277719, 32.02464627011959, 33.48453005446571, 38.07936384581484, 13.972485938972431, 13.82187604213065, 23.851355450908173, 9.613507867411036, 4.032589628819704, 1.6159004758684254, 24.52888349662254, 1.4538725922389721, 24.48165746857419, 21.16794178307104, 30.54319867954618, 12.963453684325277, 24.991242500816846, 26.3762545582402, 15.430583425778218, 2.2924680173738885, 1.9744456500406233, -0.9545244490686287, 32.536122364398736, 23.96870921683472, 26.322700571447285, 9.855012335973761, 16.97133592955068, 9.681139820813659, 4.238708464777222, 27.617646665658576, 33.65503964013257, 24.588623187611997, 39.750480078617834, 31.056122314665124, 14.362484040239464, 7.172624958785802, 13.281850955601923, 22.841666701793848, 18.623666964644894, -0.7714620224635027, 26.79544977788919, 5.432129209088936, 20.142922657859156, -6.690705944254365, -0.39572953333454564, -5.437283762321621, -8.330994395598037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6200317247501271, "mean_inference_ms": 1.6615732351527481, "mean_action_processing_ms": 0.25519779407474025, "mean_env_wait_ms": 0.14343086253985182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007258176803588867, "StateBufferConnector_ms": 0.0036410093307495117, "ViewRequirementAgentConnector_ms": 0.0998837947845459}, "num_episodes": 18, "episode_return_max": 46.83104615481807, "episode_return_min": -13.25688527672766, "episode_return_mean": 14.848917268969412, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 23.334521565412214, "num_env_steps_trained_throughput_per_sec": 23.334521565412214, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1932000, "timers": {"training_iteration_time_ms": 28333.36, "restore_workers_time_ms": 0.036, "training_step_time_ms": 28333.062, "sample_time_ms": 1445.149, "learn_time_ms": 26858.072, "learn_throughput": 148.931, "synch_weights_time_ms": 27.396}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "done": false, "training_iteration": 161, "trial_id": "06536_00000", "date": "2024-08-11_17-46-32", "timestamp": 1723412792, "time_this_iter_s": 171.7157039642334, "time_total_s": 4331.786135435104, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331792dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4331.786135435104, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 59.904761904761905, "ram_util_percent": 82.44285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.143804035832485, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3274489964048066, "policy_loss": -0.004601254053704906, "vf_loss": 3.3320502436409396, "vf_explained_var": 0.9317804761851828, "kl": 0.007311663064320029, "entropy": 0.4095958817439775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.084312990796629, "cur_kl_coeff": 8.874685183736385e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5760205618288152, "policy_loss": -0.002745569303198151, "vf_loss": 3.578766131274915, "vf_explained_var": 0.9226553638145406, "kl": 0.004309888883061176, "entropy": 0.3009164203727056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "env_runners": {"episode_reward_max": 58.951882824419386, "episode_reward_min": -13.067902080948206, "episode_reward_mean": 15.173291573107399, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.95188282441941, "predator_policy": -18.22631639039236}, "policy_reward_max": {"prey_policy": 13.067902080948205, "predator_policy": 59.758372879406636}, "policy_reward_mean": {"prey_policy": -15.173291573107395, "predator_policy": 15.173291573107399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.85150675327965, 1.0833229603344563, 15.844234505554223, 22.63333265651336, -9.298819319189823, 9.491569831618676, 16.13949797593046, 10.195182919531554, 17.799996260252858, 12.029179855594995, 21.131708892106467, 11.47044767708209, 24.756613673092755, 10.144633932994092, 4.211295072717315, 1.9212730853895508, 13.459093369711288, -6.772291290879617, 18.863345823209972, -0.8910658454463514, -13.067902080948206, 18.350586037243417, 12.811843110378364, 2.1729611095405703, 8.1685894050747, 15.7179382132489, 40.38844969786982, 18.51789025103478, 7.280364248606562, 22.49200116974265, 4.860030321970719, 11.958002844136331, 9.814318041781998, 10.147874850689783, 10.55263984539664, 19.33315953992767, 17.692843864183605, 2.1906205545331208, 10.530977668118622, 43.85963878208208, -2.823870109972665, 14.307691093089234, 22.03398609105136, 25.06402460928122, 9.977983470238971, 13.563203093042334, 17.176349172735925, 32.44046590744536, 8.119328371678538, 18.055915185417, 13.39026926412391, 3.104229365858931, 27.09728614699356, 21.840284327972494, 14.510683436261795, 17.935683629261867, 7.772928022094456, 36.92084235421516, 10.683590960950188, 32.75458816229266, 26.025924892393647, 18.836615746519406, 6.823048748115363, 13.072391986245474, 12.967765030406573, 25.8555702313086, 18.977348092571045, 20.903418992009215, 2.1334568337072684, 15.790798957665068, 25.145704894140977, 13.413174132762217, 6.95992414279544, 30.636343152895602, 32.16955163311491, 22.70930317745229, 10.227237957193859, 20.73266683321936, 13.011993877712845, 12.787525933474056, -3.5432177387944543, -6.884139078959825, 33.101899541808294, 13.263548196252419, 29.48161537958697, 15.21494100304105, -2.8236837293657207, 5.739632912850131, 27.12470475130514, 32.11290051302987, 21.23794063250831, -5.878390558546576, 19.49711270438889, -1.260548932540983, 8.86505802050308, 58.951882824419386, 30.179362081428682, 1.1947782018468978, 21.794055486689164, 27.017591035543443], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.851506753279573, -1.0833229603344865, -15.844234505554192, -22.63333265651334, 9.298819319189825, -9.491569831618694, -16.13949797593046, -10.195182919531545, -17.799996260252847, -12.029179855594993, -21.131708892106474, -11.470447677082053, -24.756613673092694, -10.144633932994115, -4.211295072717302, -1.9212730853895374, -13.459093369711265, 6.772291290879633, -18.863345823209986, 0.8910658454463567, 13.067902080948205, -18.35058603724341, -12.811843110378359, -2.1729611095405543, -8.168589405074679, -15.717938213248885, -40.38844969786978, -18.517890251034782, -7.280364248606606, -22.49200116974264, -4.860030321970718, -11.958002844136347, -9.814318041781998, -10.147874850689789, -10.552639845396628, -19.333159539927685, -17.692843864183608, -2.190620554533126, -10.530977668118638, -43.85963878208213, 2.823870109972665, -14.30769109308923, -22.03398609105137, -25.06402460928122, -9.977983470238971, -13.563203093042297, -17.17634917273591, -32.44046590744531, -8.11932837167855, -18.05591518541699, -13.390269264123903, -3.104229365858944, -27.097286146993575, -21.840284327972526, -14.5106834362618, -17.935683629261884, -7.772928022094469, -36.920842354215125, -10.68359096095019, -32.75458816229264, -26.02592489239364, -18.836615746519403, -6.823048748115369, -13.072391986245483, -12.967765030406587, -25.85557023130861, -18.97734809257106, -20.9034189920092, -2.1334568337072524, -15.790798957665032, -25.145704894141005, -13.413174132762212, -6.959924142795439, -30.636343152895584, -32.16955163311486, -22.7093031774523, -10.22723795719387, -20.732666833219362, -13.011993877712847, -12.787525933474033, 3.543217738794456, 6.884139078959831, -33.10189954180825, -13.263548196252431, -29.48161537958693, -15.214941003041051, 2.823683729365726, -5.739632912850141, -27.12470475130516, -32.11290051302987, -21.23794063250834, 5.878390558546556, -19.497112704388872, 1.2605489325409822, -8.865058020503081, -58.95188282441941, -30.179362081428707, -1.1947782018468853, -21.794055486689146, -27.017591035543433], "policy_predator_policy_reward": [40.3932905778188, 23.309722928740435, -4.894778514009564, 7.061424434678507, 5.688641079551159, 25.999827931557206, 28.116089130970316, 17.150576182056344, -10.093223546716263, -8.50441509166338, 8.877702188015686, 10.105437475221692, 8.022734841710168, 24.25626111015075, 23.91748202283648, -3.5271161837733462, 25.399368413481685, 10.200624107024028, 18.26446178385337, 5.793897927336621, 27.265521244620906, 14.997896539592016, 19.898736034103116, 3.042159320060991, 32.52005200845952, 16.99317533772593, 15.810981818989827, 4.478286046998409, 8.695865978638833, -0.2732758332042202, 0.6983516842224979, 3.1441944865565823, 19.999424792980754, 6.9187619464417995, -18.22631639039236, 4.681733808633087, 19.87426459937292, 17.852427047046994, 12.569309319117881, -14.351441010010568, -13.19732411543297, -12.938480046463452, 18.410733996146984, 18.290438078339832, 18.780158542303496, 6.843527678453237, -9.322957908892155, 13.6688801279733, 2.1244576117184284, 14.212721198430929, 17.336511075005745, 14.099365351492043, 28.194416765758373, 52.582482629981214, 11.75108498854789, 25.28469551352172, 19.695826264636388, -5.135097767423179, 20.9869729835223, 23.997029355963, 2.5051669200188584, 7.214893723922572, -3.0778038963701455, 26.993809584642904, 12.873614810345355, 6.755021273218647, 1.1954507215091628, 19.100298979870416, 28.459626507104804, -7.354346816311544, 15.261240533493668, 23.40507854636168, 4.834440599722429, 30.551247128644775, 3.0820637001535918, 1.2991774089126515, 10.451701477711708, 10.610253858525631, 30.850717219850342, 56.8685603443139, 2.384369043776106, -8.03210926372143, 13.834752687598579, 14.780629498579883, 30.79220448914887, 13.27576769295381, 28.016062958621475, 22.111986259941013, 12.98912259397741, 6.966844346500526, 3.0470720911947513, 24.07933409488986, 27.016190358580836, 7.336507986891025, 29.20502685441945, 35.67590496047117, 8.114474085315537, 8.124182658041562, 7.154038835303899, 28.95779153553009, 7.432702037356719, 19.34783649089109, 8.189224015625143, -1.9807652839072691, 31.728318395957885, 22.46625389802926, 9.021068958033087, 34.65949969791194, 14.46950707760348, 14.551859794920144, 26.50155807286027, 9.369809185663492, 15.881478309303617, -0.33562226511469184, 35.746230745305766, 38.09545396312452, 9.687263179123187, 11.67991874277719, 32.02464627011959, 33.48453005446571, 38.07936384581484, 13.972485938972431, 13.82187604213065, 23.851355450908173, 9.613507867411036, 4.032589628819704, 1.6159004758684254, 24.52888349662254, 1.4538725922389721, 24.48165746857419, 21.16794178307104, 30.54319867954618, 12.963453684325277, 24.991242500816846, 26.3762545582402, 15.430583425778218, 2.2924680173738885, 1.9744456500406233, -0.9545244490686287, 32.536122364398736, 23.96870921683472, 26.322700571447285, 9.855012335973761, 16.97133592955068, 9.681139820813659, 4.238708464777222, 27.617646665658576, 33.65503964013257, 24.588623187611997, 39.750480078617834, 31.056122314665124, 14.362484040239464, 7.172624958785802, 13.281850955601923, 22.841666701793848, 18.623666964644894, -0.7714620224635027, 26.79544977788919, 5.432129209088936, 20.142922657859156, -6.690705944254365, -0.39572953333454564, -5.437283762321621, -8.330994395598037, 39.88928462039714, 26.314514463219403, 19.167625596130506, 7.35947079637434, 31.324567475158155, 27.63866328401571, 3.839072163370174, 26.59080984271197, -2.0619521755756693, -3.585415283155765, 7.744580630433415, 3.734685195266856, 17.830981300014777, 36.4184282025955, 26.772210115695348, 37.453590910364404, 14.381958209323916, 28.09392305569278, -16.3420776773429, 4.585296560249791, 19.603196195074695, 19.39102921370307, 2.2442362771345277, -4.7653341422164885, 15.642133637415535, 2.0879824035906314, 58.14539276943214, 59.758372879406636, 26.049579231533414, 34.309144931323964, 2.7422839526392053, -0.3527275489454258, 40.47008318482112, 3.1180277885571597, 28.2623893102293, 25.772792760857577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6212168822059443, "mean_inference_ms": 1.665190964097626, "mean_action_processing_ms": 0.255754587411897, "mean_env_wait_ms": 0.14382058015097485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008369207382202148, "StateBufferConnector_ms": 0.0036777257919311523, "ViewRequirementAgentConnector_ms": 0.12414419651031494}, "num_episodes": 18, "episode_return_max": 58.951882824419386, "episode_return_min": -13.067902080948206, "episode_return_mean": 15.173291573107399, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.30655829649322, "num_env_steps_trained_throughput_per_sec": 240.30655829649322, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1944000, "timers": {"training_iteration_time_ms": 28852.939, "restore_workers_time_ms": 0.042, "training_step_time_ms": 28852.632, "sample_time_ms": 1815.969, "learn_time_ms": 27007.005, "learn_throughput": 148.11, "synch_weights_time_ms": 27.06}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "done": false, "training_iteration": 162, "trial_id": "06536_00000", "date": "2024-08-11_17-46-49", "timestamp": 1723412809, "time_this_iter_s": 16.680079221725464, "time_total_s": 4348.46621465683, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317f7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4348.46621465683, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 72.21304347826086, "ram_util_percent": 83.9391304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.974586283912261, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.880556544413169, "policy_loss": -0.008083896155585534, "vf_loss": 2.8886404419938723, "vf_explained_var": 0.9291379682719707, "kl": 0.005930060182222861, "entropy": 0.40005142965043583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9983745438711984, "cur_kl_coeff": 4.4373425918681926e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.335894121316375, "policy_loss": -0.0025164516795446318, "vf_loss": 3.338410564326735, "vf_explained_var": 0.9160441756879211, "kl": 0.005235608873613559, "entropy": 0.2953989188349436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "env_runners": {"episode_reward_max": 58.951882824419386, "episode_reward_min": -13.067902080948206, "episode_reward_mean": 16.18720065080319, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.95188282441941, "predator_policy": -22.95232134872707}, "policy_reward_max": {"prey_policy": 13.067902080948205, "predator_policy": 59.758372879406636}, "policy_reward_mean": {"prey_policy": -16.18720065080319, "predator_policy": 16.1872006508032}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.863345823209972, -0.8910658454463514, -13.067902080948206, 18.350586037243417, 12.811843110378364, 2.1729611095405703, 8.1685894050747, 15.7179382132489, 40.38844969786982, 18.51789025103478, 7.280364248606562, 22.49200116974265, 4.860030321970719, 11.958002844136331, 9.814318041781998, 10.147874850689783, 10.55263984539664, 19.33315953992767, 17.692843864183605, 2.1906205545331208, 10.530977668118622, 43.85963878208208, -2.823870109972665, 14.307691093089234, 22.03398609105136, 25.06402460928122, 9.977983470238971, 13.563203093042334, 17.176349172735925, 32.44046590744536, 8.119328371678538, 18.055915185417, 13.39026926412391, 3.104229365858931, 27.09728614699356, 21.840284327972494, 14.510683436261795, 17.935683629261867, 7.772928022094456, 36.92084235421516, 10.683590960950188, 32.75458816229266, 26.025924892393647, 18.836615746519406, 6.823048748115363, 13.072391986245474, 12.967765030406573, 25.8555702313086, 18.977348092571045, 20.903418992009215, 2.1334568337072684, 15.790798957665068, 25.145704894140977, 13.413174132762217, 6.95992414279544, 30.636343152895602, 32.16955163311491, 22.70930317745229, 10.227237957193859, 20.73266683321936, 13.011993877712845, 12.787525933474056, -3.5432177387944543, -6.884139078959825, 33.101899541808294, 13.263548196252419, 29.48161537958697, 15.21494100304105, -2.8236837293657207, 5.739632912850131, 27.12470475130514, 32.11290051302987, 21.23794063250831, -5.878390558546576, 19.49711270438889, -1.260548932540983, 8.86505802050308, 58.951882824419386, 30.179362081428682, 1.1947782018468978, 21.794055486689164, 27.017591035543443, 26.487759981175248, 3.024560873415327, 22.286327968118943, 6.5368808686333555, -8.24381025096565, 38.73540603627845, 6.988413593000326, -3.773198298159098, 39.76365252853677, 35.58541296144559, 35.069099958566675, 5.651439848153627, 23.400162776838044, -8.475658103599736, 24.09681768545698, 13.462660324799401, 33.74032604739313, 15.146431782126466], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.863345823209986, 0.8910658454463567, 13.067902080948205, -18.35058603724341, -12.811843110378359, -2.1729611095405543, -8.168589405074679, -15.717938213248885, -40.38844969786978, -18.517890251034782, -7.280364248606606, -22.49200116974264, -4.860030321970718, -11.958002844136347, -9.814318041781998, -10.147874850689789, -10.552639845396628, -19.333159539927685, -17.692843864183608, -2.190620554533126, -10.530977668118638, -43.85963878208213, 2.823870109972665, -14.30769109308923, -22.03398609105137, -25.06402460928122, -9.977983470238971, -13.563203093042297, -17.17634917273591, -32.44046590744531, -8.11932837167855, -18.05591518541699, -13.390269264123903, -3.104229365858944, -27.097286146993575, -21.840284327972526, -14.5106834362618, -17.935683629261884, -7.772928022094469, -36.920842354215125, -10.68359096095019, -32.75458816229264, -26.02592489239364, -18.836615746519403, -6.823048748115369, -13.072391986245483, -12.967765030406587, -25.85557023130861, -18.97734809257106, -20.9034189920092, -2.1334568337072524, -15.790798957665032, -25.145704894141005, -13.413174132762212, -6.959924142795439, -30.636343152895584, -32.16955163311486, -22.7093031774523, -10.22723795719387, -20.732666833219362, -13.011993877712847, -12.787525933474033, 3.543217738794456, 6.884139078959831, -33.10189954180825, -13.263548196252431, -29.48161537958693, -15.214941003041051, 2.823683729365726, -5.739632912850141, -27.12470475130516, -32.11290051302987, -21.23794063250834, 5.878390558546556, -19.497112704388872, 1.2605489325409822, -8.865058020503081, -58.95188282441941, -30.179362081428707, -1.1947782018468853, -21.794055486689146, -27.017591035543433, -26.487759981175245, -3.0245608734153357, -22.286327968118968, -6.5368808686333795, 8.243810250965653, -38.73540603627846, -6.988413593000313, 3.7731982981591035, -39.76365252853671, -35.58541296144558, -35.069099958566746, -5.651439848153636, -23.400162776838066, 8.475658103599725, -24.09681768545702, -13.462660324799407, -33.74032604739313, -15.146431782126498], "policy_predator_policy_reward": [19.87426459937292, 17.852427047046994, 12.569309319117881, -14.351441010010568, -13.19732411543297, -12.938480046463452, 18.410733996146984, 18.290438078339832, 18.780158542303496, 6.843527678453237, -9.322957908892155, 13.6688801279733, 2.1244576117184284, 14.212721198430929, 17.336511075005745, 14.099365351492043, 28.194416765758373, 52.582482629981214, 11.75108498854789, 25.28469551352172, 19.695826264636388, -5.135097767423179, 20.9869729835223, 23.997029355963, 2.5051669200188584, 7.214893723922572, -3.0778038963701455, 26.993809584642904, 12.873614810345355, 6.755021273218647, 1.1954507215091628, 19.100298979870416, 28.459626507104804, -7.354346816311544, 15.261240533493668, 23.40507854636168, 4.834440599722429, 30.551247128644775, 3.0820637001535918, 1.2991774089126515, 10.451701477711708, 10.610253858525631, 30.850717219850342, 56.8685603443139, 2.384369043776106, -8.03210926372143, 13.834752687598579, 14.780629498579883, 30.79220448914887, 13.27576769295381, 28.016062958621475, 22.111986259941013, 12.98912259397741, 6.966844346500526, 3.0470720911947513, 24.07933409488986, 27.016190358580836, 7.336507986891025, 29.20502685441945, 35.67590496047117, 8.114474085315537, 8.124182658041562, 7.154038835303899, 28.95779153553009, 7.432702037356719, 19.34783649089109, 8.189224015625143, -1.9807652839072691, 31.728318395957885, 22.46625389802926, 9.021068958033087, 34.65949969791194, 14.46950707760348, 14.551859794920144, 26.50155807286027, 9.369809185663492, 15.881478309303617, -0.33562226511469184, 35.746230745305766, 38.09545396312452, 9.687263179123187, 11.67991874277719, 32.02464627011959, 33.48453005446571, 38.07936384581484, 13.972485938972431, 13.82187604213065, 23.851355450908173, 9.613507867411036, 4.032589628819704, 1.6159004758684254, 24.52888349662254, 1.4538725922389721, 24.48165746857419, 21.16794178307104, 30.54319867954618, 12.963453684325277, 24.991242500816846, 26.3762545582402, 15.430583425778218, 2.2924680173738885, 1.9744456500406233, -0.9545244490686287, 32.536122364398736, 23.96870921683472, 26.322700571447285, 9.855012335973761, 16.97133592955068, 9.681139820813659, 4.238708464777222, 27.617646665658576, 33.65503964013257, 24.588623187611997, 39.750480078617834, 31.056122314665124, 14.362484040239464, 7.172624958785802, 13.281850955601923, 22.841666701793848, 18.623666964644894, -0.7714620224635027, 26.79544977788919, 5.432129209088936, 20.142922657859156, -6.690705944254365, -0.39572953333454564, -5.437283762321621, -8.330994395598037, 39.88928462039714, 26.314514463219403, 19.167625596130506, 7.35947079637434, 31.324567475158155, 27.63866328401571, 3.839072163370174, 26.59080984271197, -2.0619521755756693, -3.585415283155765, 7.744580630433415, 3.734685195266856, 17.830981300014777, 36.4184282025955, 26.772210115695348, 37.453590910364404, 14.381958209323916, 28.09392305569278, -16.3420776773429, 4.585296560249791, 19.603196195074695, 19.39102921370307, 2.2442362771345277, -4.7653341422164885, 15.642133637415535, 2.0879824035906314, 58.14539276943214, 59.758372879406636, 26.049579231533414, 34.309144931323964, 2.7422839526392053, -0.3527275489454258, 40.47008318482112, 3.1180277885571597, 28.2623893102293, 25.772792760857577, 15.767069266008882, 37.208450696341615, -1.1146332955972404, 7.163755042427885, 5.466962920152291, 39.10569301608565, 14.24798623535785, -1.1742244980910854, -0.5174755436759737, -15.970144958255347, 36.95271615361838, 40.51809591893858, 11.783154730752775, 2.193672455247869, -22.95232134872707, 15.405924752408861, 37.57513640878236, 41.95216864829118, 43.624382859309094, 27.546443063582064, 35.544805479251906, 34.59339443788156, 2.1862692459681323, 9.116610450339135, 20.5497502868311, 26.250575266845004, -19.700775632851055, 2.749459425651601, 25.191794404719847, 23.00184096619416, 17.910138081414402, 9.0151825681844, 40.019787923372846, 27.460864171413462, 19.421388990482928, 10.87147457377004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6222091743740404, "mean_inference_ms": 1.6683153458737296, "mean_action_processing_ms": 0.2561973989934675, "mean_env_wait_ms": 0.14418471851499912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008365511894226074, "StateBufferConnector_ms": 0.0036852359771728516, "ViewRequirementAgentConnector_ms": 0.12232553958892822}, "num_episodes": 18, "episode_return_max": 58.951882824419386, "episode_return_min": -13.067902080948206, "episode_return_mean": 16.18720065080319, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.57934918282945, "num_env_steps_trained_throughput_per_sec": 396.57934918282945, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1956000, "timers": {"training_iteration_time_ms": 28653.821, "restore_workers_time_ms": 0.042, "training_step_time_ms": 28653.52, "sample_time_ms": 1754.384, "learn_time_ms": 26872.246, "learn_throughput": 148.852, "synch_weights_time_ms": 24.324}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "done": false, "training_iteration": 163, "trial_id": "06536_00000", "date": "2024-08-11_17-46-59", "timestamp": 1723412819, "time_this_iter_s": 10.145896911621094, "time_total_s": 4358.612111568451, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b586c160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4358.612111568451, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 44.72, "ram_util_percent": 80.90666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.234733146553238, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.725880554318428, "policy_loss": -0.00936032441095449, "vf_loss": 2.735240865747134, "vf_explained_var": 0.9299876338491837, "kl": 0.010179146061695092, "entropy": 0.3824619472026825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.035955660746842, "cur_kl_coeff": 4.4373425918681926e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5023176981658533, "policy_loss": -0.003243051604096773, "vf_loss": 3.5055607533328748, "vf_explained_var": 0.9032188656153503, "kl": 0.004934142533651149, "entropy": 0.23537962161517018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 58.951882824419386, "episode_reward_min": -12.911734461108722, "episode_reward_mean": 16.66575362340136, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.95188282441941, "predator_policy": -22.95232134872707}, "policy_reward_max": {"prey_policy": 12.911734461108724, "predator_policy": 59.758372879406636}, "policy_reward_mean": {"prey_policy": -16.66575362340136, "predator_policy": 16.66575362340136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.307691093089234, 22.03398609105136, 25.06402460928122, 9.977983470238971, 13.563203093042334, 17.176349172735925, 32.44046590744536, 8.119328371678538, 18.055915185417, 13.39026926412391, 3.104229365858931, 27.09728614699356, 21.840284327972494, 14.510683436261795, 17.935683629261867, 7.772928022094456, 36.92084235421516, 10.683590960950188, 32.75458816229266, 26.025924892393647, 18.836615746519406, 6.823048748115363, 13.072391986245474, 12.967765030406573, 25.8555702313086, 18.977348092571045, 20.903418992009215, 2.1334568337072684, 15.790798957665068, 25.145704894140977, 13.413174132762217, 6.95992414279544, 30.636343152895602, 32.16955163311491, 22.70930317745229, 10.227237957193859, 20.73266683321936, 13.011993877712845, 12.787525933474056, -3.5432177387944543, -6.884139078959825, 33.101899541808294, 13.263548196252419, 29.48161537958697, 15.21494100304105, -2.8236837293657207, 5.739632912850131, 27.12470475130514, 32.11290051302987, 21.23794063250831, -5.878390558546576, 19.49711270438889, -1.260548932540983, 8.86505802050308, 58.951882824419386, 30.179362081428682, 1.1947782018468978, 21.794055486689164, 27.017591035543443, 26.487759981175248, 3.024560873415327, 22.286327968118943, 6.5368808686333555, -8.24381025096565, 38.73540603627845, 6.988413593000326, -3.773198298159098, 39.76365252853677, 35.58541296144559, 35.069099958566675, 5.651439848153627, 23.400162776838044, -8.475658103599736, 24.09681768545698, 13.462660324799401, 33.74032604739313, 15.146431782126466, 16.14187628572431, -1.4519495893128358, 35.5918652355941, 12.089027757134344, 19.05699178616239, 14.464825224791825, 13.024986193881949, 18.90405692589215, 6.745243515762993, 14.714241409532226, 36.291504972824846, -7.323285094260015, -12.911734461108722, 18.618322707946135, 8.56535704807136, 14.413687011171046, 16.03802612825531, 23.3097121214878, 32.51243272991402, 18.872107893972863, 13.991159642416012, -0.08522421473898589, 25.203303371104525], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.30769109308923, -22.03398609105137, -25.06402460928122, -9.977983470238971, -13.563203093042297, -17.17634917273591, -32.44046590744531, -8.11932837167855, -18.05591518541699, -13.390269264123903, -3.104229365858944, -27.097286146993575, -21.840284327972526, -14.5106834362618, -17.935683629261884, -7.772928022094469, -36.920842354215125, -10.68359096095019, -32.75458816229264, -26.02592489239364, -18.836615746519403, -6.823048748115369, -13.072391986245483, -12.967765030406587, -25.85557023130861, -18.97734809257106, -20.9034189920092, -2.1334568337072524, -15.790798957665032, -25.145704894141005, -13.413174132762212, -6.959924142795439, -30.636343152895584, -32.16955163311486, -22.7093031774523, -10.22723795719387, -20.732666833219362, -13.011993877712847, -12.787525933474033, 3.543217738794456, 6.884139078959831, -33.10189954180825, -13.263548196252431, -29.48161537958693, -15.214941003041051, 2.823683729365726, -5.739632912850141, -27.12470475130516, -32.11290051302987, -21.23794063250834, 5.878390558546556, -19.497112704388872, 1.2605489325409822, -8.865058020503081, -58.95188282441941, -30.179362081428707, -1.1947782018468853, -21.794055486689146, -27.017591035543433, -26.487759981175245, -3.0245608734153357, -22.286327968118968, -6.5368808686333795, 8.243810250965653, -38.73540603627846, -6.988413593000313, 3.7731982981591035, -39.76365252853671, -35.58541296144558, -35.069099958566746, -5.651439848153636, -23.400162776838066, 8.475658103599725, -24.09681768545702, -13.462660324799407, -33.74032604739313, -15.146431782126498, -16.141876285724283, 1.4519495893128465, -35.59186523559408, -12.089027757134346, -19.056991786162392, -14.46482522479181, -13.024986193881968, -18.90405692589217, -6.745243515763003, -14.714241409532239, -36.29150497282481, 7.323285094260019, 12.911734461108724, -18.618322707946152, -8.565357048071338, -14.41368701117104, -16.03802612825528, -23.309712121487838, -32.51243272991404, -18.87210789397284, -13.991159642416019, 0.08522421473896458, -25.203303371104568], "policy_predator_policy_reward": [13.834752687598579, 14.780629498579883, 30.79220448914887, 13.27576769295381, 28.016062958621475, 22.111986259941013, 12.98912259397741, 6.966844346500526, 3.0470720911947513, 24.07933409488986, 27.016190358580836, 7.336507986891025, 29.20502685441945, 35.67590496047117, 8.114474085315537, 8.124182658041562, 7.154038835303899, 28.95779153553009, 7.432702037356719, 19.34783649089109, 8.189224015625143, -1.9807652839072691, 31.728318395957885, 22.46625389802926, 9.021068958033087, 34.65949969791194, 14.46950707760348, 14.551859794920144, 26.50155807286027, 9.369809185663492, 15.881478309303617, -0.33562226511469184, 35.746230745305766, 38.09545396312452, 9.687263179123187, 11.67991874277719, 32.02464627011959, 33.48453005446571, 38.07936384581484, 13.972485938972431, 13.82187604213065, 23.851355450908173, 9.613507867411036, 4.032589628819704, 1.6159004758684254, 24.52888349662254, 1.4538725922389721, 24.48165746857419, 21.16794178307104, 30.54319867954618, 12.963453684325277, 24.991242500816846, 26.3762545582402, 15.430583425778218, 2.2924680173738885, 1.9744456500406233, -0.9545244490686287, 32.536122364398736, 23.96870921683472, 26.322700571447285, 9.855012335973761, 16.97133592955068, 9.681139820813659, 4.238708464777222, 27.617646665658576, 33.65503964013257, 24.588623187611997, 39.750480078617834, 31.056122314665124, 14.362484040239464, 7.172624958785802, 13.281850955601923, 22.841666701793848, 18.623666964644894, -0.7714620224635027, 26.79544977788919, 5.432129209088936, 20.142922657859156, -6.690705944254365, -0.39572953333454564, -5.437283762321621, -8.330994395598037, 39.88928462039714, 26.314514463219403, 19.167625596130506, 7.35947079637434, 31.324567475158155, 27.63866328401571, 3.839072163370174, 26.59080984271197, -2.0619521755756693, -3.585415283155765, 7.744580630433415, 3.734685195266856, 17.830981300014777, 36.4184282025955, 26.772210115695348, 37.453590910364404, 14.381958209323916, 28.09392305569278, -16.3420776773429, 4.585296560249791, 19.603196195074695, 19.39102921370307, 2.2442362771345277, -4.7653341422164885, 15.642133637415535, 2.0879824035906314, 58.14539276943214, 59.758372879406636, 26.049579231533414, 34.309144931323964, 2.7422839526392053, -0.3527275489454258, 40.47008318482112, 3.1180277885571597, 28.2623893102293, 25.772792760857577, 15.767069266008882, 37.208450696341615, -1.1146332955972404, 7.163755042427885, 5.466962920152291, 39.10569301608565, 14.24798623535785, -1.1742244980910854, -0.5174755436759737, -15.970144958255347, 36.95271615361838, 40.51809591893858, 11.783154730752775, 2.193672455247869, -22.95232134872707, 15.405924752408861, 37.57513640878236, 41.95216864829118, 43.624382859309094, 27.546443063582064, 35.544805479251906, 34.59339443788156, 2.1862692459681323, 9.116610450339135, 20.5497502868311, 26.250575266845004, -19.700775632851055, 2.749459425651601, 25.191794404719847, 23.00184096619416, 17.910138081414402, 9.0151825681844, 40.019787923372846, 27.460864171413462, 19.421388990482928, 10.87147457377004, 13.810734297994465, 18.473018273454144, 0.4018991664356708, -3.305798345061355, 39.12077761667049, 32.062952854517704, 5.914590275146603, 18.263465239122105, 27.65415453888532, 10.459829033439496, 12.965067620922166, 15.964582828661461, 13.021463165120018, 13.02850922264391, -3.044279674552188, 40.85239352633653, -5.593640014946843, 19.084127046472844, 0.42109459630788404, 29.007388222756603, 34.556029267217646, 38.026980678432, -6.638652226407697, -8.00791796211234, -15.815847802725148, -10.007621119492272, 1.8727430682499624, 35.36390234764231, -0.21752555104177418, 17.348239647184467, 17.447024410408037, 11.380349611934044, 15.361075715968399, 16.714976540542192, 23.986209235410968, 22.6332150075647, 34.28811890205502, 30.73674655777306, 6.514885133230754, 31.229330654714904, 20.80178523037024, 7.180534054461793, 4.784536645934364, -4.954985075412299, 18.22994779759953, 32.17665894460957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6231926989509452, "mean_inference_ms": 1.6721172901878427, "mean_action_processing_ms": 0.256656121575725, "mean_env_wait_ms": 0.14460560812755252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144331932067871, "StateBufferConnector_ms": 0.0035048723220825195, "ViewRequirementAgentConnector_ms": 0.13113343715667725}, "num_episodes": 23, "episode_return_max": 58.951882824419386, "episode_return_min": -12.911734461108722, "episode_return_mean": 16.66575362340136, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.81487539660503, "num_env_steps_trained_throughput_per_sec": 356.81487539660503, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 28602.119, "restore_workers_time_ms": 0.025, "training_step_time_ms": 28601.801, "sample_time_ms": 1736.816, "learn_time_ms": 26836.026, "learn_throughput": 149.053, "synch_weights_time_ms": 26.342}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 164, "trial_id": "06536_00000", "date": "2024-08-11_17-47-11", "timestamp": 1723412831, "time_this_iter_s": 11.243507862091064, "time_total_s": 4369.855619430542, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63a83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4369.855619430542, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 46.9875, "ram_util_percent": 81.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.256480683386326, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.353175417209665, "policy_loss": -0.005363591955877685, "vf_loss": 2.3585390098392964, "vf_explained_var": 0.9437929213667909, "kl": 0.007345943063995867, "entropy": 0.394509379658848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.484780847017096, "cur_kl_coeff": 2.2186712959340963e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.01712303432838, "policy_loss": -0.0014161358456861563, "vf_loss": 3.018539164936732, "vf_explained_var": 0.9345005402489314, "kl": 0.0036119681180879796, "entropy": 0.2743991719667243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "env_runners": {"episode_reward_max": 58.951882824419386, "episode_reward_min": -12.911734461108722, "episode_reward_mean": 16.066445552367853, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.95188282441941, "predator_policy": -22.95232134872707}, "policy_reward_max": {"prey_policy": 12.911734461108724, "predator_policy": 59.758372879406636}, "policy_reward_mean": {"prey_policy": -16.066445552367856, "predator_policy": 16.06644555236786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.072391986245474, 12.967765030406573, 25.8555702313086, 18.977348092571045, 20.903418992009215, 2.1334568337072684, 15.790798957665068, 25.145704894140977, 13.413174132762217, 6.95992414279544, 30.636343152895602, 32.16955163311491, 22.70930317745229, 10.227237957193859, 20.73266683321936, 13.011993877712845, 12.787525933474056, -3.5432177387944543, -6.884139078959825, 33.101899541808294, 13.263548196252419, 29.48161537958697, 15.21494100304105, -2.8236837293657207, 5.739632912850131, 27.12470475130514, 32.11290051302987, 21.23794063250831, -5.878390558546576, 19.49711270438889, -1.260548932540983, 8.86505802050308, 58.951882824419386, 30.179362081428682, 1.1947782018468978, 21.794055486689164, 27.017591035543443, 26.487759981175248, 3.024560873415327, 22.286327968118943, 6.5368808686333555, -8.24381025096565, 38.73540603627845, 6.988413593000326, -3.773198298159098, 39.76365252853677, 35.58541296144559, 35.069099958566675, 5.651439848153627, 23.400162776838044, -8.475658103599736, 24.09681768545698, 13.462660324799401, 33.74032604739313, 15.146431782126466, 16.14187628572431, -1.4519495893128358, 35.5918652355941, 12.089027757134344, 19.05699178616239, 14.464825224791825, 13.024986193881949, 18.90405692589215, 6.745243515762993, 14.714241409532226, 36.291504972824846, -7.323285094260015, -12.911734461108722, 18.618322707946135, 8.56535704807136, 14.413687011171046, 16.03802612825531, 23.3097121214878, 32.51243272991402, 18.872107893972863, 13.991159642416012, -0.08522421473898589, 25.203303371104525, 3.480646632469118, 20.4905040794397, 32.08416882299861, 20.415220871737297, 19.644759440517014, 22.29933647942609, 6.421281120751872, 5.5995298712096995, 5.209195106800564, 17.98162471212312, 7.989744462782856, 25.703992930862643, 17.934008511879004, 5.338904050729491, -2.4862779528451533, 19.86797717582041, 13.988172312995216, 23.97131284233061, 20.7805665078574, 18.981457611963997, 11.163791222154762, 21.644198133678735], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.072391986245483, -12.967765030406587, -25.85557023130861, -18.97734809257106, -20.9034189920092, -2.1334568337072524, -15.790798957665032, -25.145704894141005, -13.413174132762212, -6.959924142795439, -30.636343152895584, -32.16955163311486, -22.7093031774523, -10.22723795719387, -20.732666833219362, -13.011993877712847, -12.787525933474033, 3.543217738794456, 6.884139078959831, -33.10189954180825, -13.263548196252431, -29.48161537958693, -15.214941003041051, 2.823683729365726, -5.739632912850141, -27.12470475130516, -32.11290051302987, -21.23794063250834, 5.878390558546556, -19.497112704388872, 1.2605489325409822, -8.865058020503081, -58.95188282441941, -30.179362081428707, -1.1947782018468853, -21.794055486689146, -27.017591035543433, -26.487759981175245, -3.0245608734153357, -22.286327968118968, -6.5368808686333795, 8.243810250965653, -38.73540603627846, -6.988413593000313, 3.7731982981591035, -39.76365252853671, -35.58541296144558, -35.069099958566746, -5.651439848153636, -23.400162776838066, 8.475658103599725, -24.09681768545702, -13.462660324799407, -33.74032604739313, -15.146431782126498, -16.141876285724283, 1.4519495893128465, -35.59186523559408, -12.089027757134346, -19.056991786162392, -14.46482522479181, -13.024986193881968, -18.90405692589217, -6.745243515763003, -14.714241409532239, -36.29150497282481, 7.323285094260019, 12.911734461108724, -18.618322707946152, -8.565357048071338, -14.41368701117104, -16.03802612825528, -23.309712121487838, -32.51243272991404, -18.87210789397284, -13.991159642416019, 0.08522421473896458, -25.203303371104568, -3.4806466324691545, -20.490504079439695, -32.0841688229986, -20.41522087173729, -19.644759440517, -22.299336479426078, -6.4212811207518605, -5.599529871209704, -5.209195106800555, -17.98162471212313, -7.989744462782864, -25.70399293086267, -17.934008511879014, -5.338904050729494, 2.4862779528451515, -19.867977175820403, -13.988172312995212, -23.97131284233058, -20.780566507857433, -18.981457611963993, -11.163791222154778, -21.644198133678838], "policy_predator_policy_reward": [1.6159004758684254, 24.52888349662254, 1.4538725922389721, 24.48165746857419, 21.16794178307104, 30.54319867954618, 12.963453684325277, 24.991242500816846, 26.3762545582402, 15.430583425778218, 2.2924680173738885, 1.9744456500406233, -0.9545244490686287, 32.536122364398736, 23.96870921683472, 26.322700571447285, 9.855012335973761, 16.97133592955068, 9.681139820813659, 4.238708464777222, 27.617646665658576, 33.65503964013257, 24.588623187611997, 39.750480078617834, 31.056122314665124, 14.362484040239464, 7.172624958785802, 13.281850955601923, 22.841666701793848, 18.623666964644894, -0.7714620224635027, 26.79544977788919, 5.432129209088936, 20.142922657859156, -6.690705944254365, -0.39572953333454564, -5.437283762321621, -8.330994395598037, 39.88928462039714, 26.314514463219403, 19.167625596130506, 7.35947079637434, 31.324567475158155, 27.63866328401571, 3.839072163370174, 26.59080984271197, -2.0619521755756693, -3.585415283155765, 7.744580630433415, 3.734685195266856, 17.830981300014777, 36.4184282025955, 26.772210115695348, 37.453590910364404, 14.381958209323916, 28.09392305569278, -16.3420776773429, 4.585296560249791, 19.603196195074695, 19.39102921370307, 2.2442362771345277, -4.7653341422164885, 15.642133637415535, 2.0879824035906314, 58.14539276943214, 59.758372879406636, 26.049579231533414, 34.309144931323964, 2.7422839526392053, -0.3527275489454258, 40.47008318482112, 3.1180277885571597, 28.2623893102293, 25.772792760857577, 15.767069266008882, 37.208450696341615, -1.1146332955972404, 7.163755042427885, 5.466962920152291, 39.10569301608565, 14.24798623535785, -1.1742244980910854, -0.5174755436759737, -15.970144958255347, 36.95271615361838, 40.51809591893858, 11.783154730752775, 2.193672455247869, -22.95232134872707, 15.405924752408861, 37.57513640878236, 41.95216864829118, 43.624382859309094, 27.546443063582064, 35.544805479251906, 34.59339443788156, 2.1862692459681323, 9.116610450339135, 20.5497502868311, 26.250575266845004, -19.700775632851055, 2.749459425651601, 25.191794404719847, 23.00184096619416, 17.910138081414402, 9.0151825681844, 40.019787923372846, 27.460864171413462, 19.421388990482928, 10.87147457377004, 13.810734297994465, 18.473018273454144, 0.4018991664356708, -3.305798345061355, 39.12077761667049, 32.062952854517704, 5.914590275146603, 18.263465239122105, 27.65415453888532, 10.459829033439496, 12.965067620922166, 15.964582828661461, 13.021463165120018, 13.02850922264391, -3.044279674552188, 40.85239352633653, -5.593640014946843, 19.084127046472844, 0.42109459630788404, 29.007388222756603, 34.556029267217646, 38.026980678432, -6.638652226407697, -8.00791796211234, -15.815847802725148, -10.007621119492272, 1.8727430682499624, 35.36390234764231, -0.21752555104177418, 17.348239647184467, 17.447024410408037, 11.380349611934044, 15.361075715968399, 16.714976540542192, 23.986209235410968, 22.6332150075647, 34.28811890205502, 30.73674655777306, 6.514885133230754, 31.229330654714904, 20.80178523037024, 7.180534054461793, 4.784536645934364, -4.954985075412299, 18.22994779759953, 32.17665894460957, -7.249016054597893, 14.210309319536188, 9.48346224212302, 31.497545916756366, 44.8045791066685, 19.36375853932868, 19.65796528092433, 21.17247646255027, 7.163360132235223, 32.12615874879879, 27.460307849144396, 17.138365109707728, 5.758533594106808, 7.084028647396933, 13.818219131534006, -2.6191593891146034, -5.07217780480199, 15.490568018403092, 12.811919291068435, 23.15133013317783, 7.71852697140893, 8.260961954156791, 18.387082636802855, 33.02090322492248, 16.9799596255498, 18.88805739820823, -8.043604084837972, 18.721412186296966, -5.829755764542636, 0.8571998588523364, 25.46701717166747, 14.26893717997331, 9.505268696263954, 18.471075929726474, 35.12964877042788, 12.812976914233285, 30.373647404511757, 11.187485611203059, 23.630681331258906, 14.33223389266909, 9.763945402220584, 12.563637042088985, 16.16643006368675, 27.12196620367088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6239159434988673, "mean_inference_ms": 1.6732283293038648, "mean_action_processing_ms": 0.25700217948190807, "mean_env_wait_ms": 0.14487109632188677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005808115005493164, "StateBufferConnector_ms": 0.0027576684951782227, "ViewRequirementAgentConnector_ms": 0.12379562854766846}, "num_episodes": 22, "episode_return_max": 58.951882824419386, "episode_return_min": -12.911734461108722, "episode_return_mean": 16.066445552367853, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.60604635498987, "num_env_steps_trained_throughput_per_sec": 391.60604635498987, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1980000, "timers": {"training_iteration_time_ms": 28378.867, "restore_workers_time_ms": 0.03, "training_step_time_ms": 28378.543, "sample_time_ms": 1707.161, "learn_time_ms": 26644.158, "learn_throughput": 150.127, "synch_weights_time_ms": 24.577}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "done": false, "training_iteration": 165, "trial_id": "06536_00000", "date": "2024-08-11_17-47-21", "timestamp": 1723412841, "time_this_iter_s": 10.258507013320923, "time_total_s": 4380.114126443863, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63a8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4380.114126443863, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 42.32142857142857, "ram_util_percent": 82.4142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7863437409202256, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8260671839118003, "policy_loss": -0.005279920019772059, "vf_loss": 1.831347106024623, "vf_explained_var": 0.9598394788180789, "kl": 0.0048567100645195834, "entropy": 0.37522879398117465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7357185983783983, "cur_kl_coeff": 1.1093356479670482e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1961261198003457, "policy_loss": -0.0029924241986086287, "vf_loss": 2.1991185433650142, "vf_explained_var": 0.9563368458911855, "kl": 0.005027683394095593, "entropy": 0.30293105886411414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "env_runners": {"episode_reward_max": 58.951882824419386, "episode_reward_min": -12.911734461108722, "episode_reward_mean": 16.57050889840464, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -58.95188282441941, "predator_policy": -22.95232134872707}, "policy_reward_max": {"prey_policy": 12.911734461108724, "predator_policy": 59.758372879406636}, "policy_reward_mean": {"prey_policy": -16.57050889840464, "predator_policy": 16.57050889840464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.884139078959825, 33.101899541808294, 13.263548196252419, 29.48161537958697, 15.21494100304105, -2.8236837293657207, 5.739632912850131, 27.12470475130514, 32.11290051302987, 21.23794063250831, -5.878390558546576, 19.49711270438889, -1.260548932540983, 8.86505802050308, 58.951882824419386, 30.179362081428682, 1.1947782018468978, 21.794055486689164, 27.017591035543443, 26.487759981175248, 3.024560873415327, 22.286327968118943, 6.5368808686333555, -8.24381025096565, 38.73540603627845, 6.988413593000326, -3.773198298159098, 39.76365252853677, 35.58541296144559, 35.069099958566675, 5.651439848153627, 23.400162776838044, -8.475658103599736, 24.09681768545698, 13.462660324799401, 33.74032604739313, 15.146431782126466, 16.14187628572431, -1.4519495893128358, 35.5918652355941, 12.089027757134344, 19.05699178616239, 14.464825224791825, 13.024986193881949, 18.90405692589215, 6.745243515762993, 14.714241409532226, 36.291504972824846, -7.323285094260015, -12.911734461108722, 18.618322707946135, 8.56535704807136, 14.413687011171046, 16.03802612825531, 23.3097121214878, 32.51243272991402, 18.872107893972863, 13.991159642416012, -0.08522421473898589, 25.203303371104525, 3.480646632469118, 20.4905040794397, 32.08416882299861, 20.415220871737297, 19.644759440517014, 22.29933647942609, 6.421281120751872, 5.5995298712096995, 5.209195106800564, 17.98162471212312, 7.989744462782856, 25.703992930862643, 17.934008511879004, 5.338904050729491, -2.4862779528451533, 19.86797717582041, 13.988172312995216, 23.97131284233061, 20.7805665078574, 18.981457611963997, 11.163791222154762, 21.644198133678735, -9.072973964699422, 16.48520472879675, 3.9912818700171124, 17.453308424541323, 24.91103682189659, 25.105991566940784, 29.987753574144158, 26.17240446305703, 25.040365641020806, 13.696640399821517, 18.860187279833028, 25.102225295897735, 20.663009849203245, 14.047168951119465, 14.6146026134473, 16.925518765441527, 24.894969229817757, 35.47859721326213], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.884139078959831, -33.10189954180825, -13.263548196252431, -29.48161537958693, -15.214941003041051, 2.823683729365726, -5.739632912850141, -27.12470475130516, -32.11290051302987, -21.23794063250834, 5.878390558546556, -19.497112704388872, 1.2605489325409822, -8.865058020503081, -58.95188282441941, -30.179362081428707, -1.1947782018468853, -21.794055486689146, -27.017591035543433, -26.487759981175245, -3.0245608734153357, -22.286327968118968, -6.5368808686333795, 8.243810250965653, -38.73540603627846, -6.988413593000313, 3.7731982981591035, -39.76365252853671, -35.58541296144558, -35.069099958566746, -5.651439848153636, -23.400162776838066, 8.475658103599725, -24.09681768545702, -13.462660324799407, -33.74032604739313, -15.146431782126498, -16.141876285724283, 1.4519495893128465, -35.59186523559408, -12.089027757134346, -19.056991786162392, -14.46482522479181, -13.024986193881968, -18.90405692589217, -6.745243515763003, -14.714241409532239, -36.29150497282481, 7.323285094260019, 12.911734461108724, -18.618322707946152, -8.565357048071338, -14.41368701117104, -16.03802612825528, -23.309712121487838, -32.51243272991404, -18.87210789397284, -13.991159642416019, 0.08522421473896458, -25.203303371104568, -3.4806466324691545, -20.490504079439695, -32.0841688229986, -20.41522087173729, -19.644759440517, -22.299336479426078, -6.4212811207518605, -5.599529871209704, -5.209195106800555, -17.98162471212313, -7.989744462782864, -25.70399293086267, -17.934008511879014, -5.338904050729494, 2.4862779528451515, -19.867977175820403, -13.988172312995212, -23.97131284233058, -20.780566507857433, -18.981457611963993, -11.163791222154778, -21.644198133678838, 9.072973964699413, -16.485204728796713, -3.991281870017114, -17.45330842454132, -24.911036821896552, -25.10599156694078, -29.9877535741442, -26.172404463057052, -25.04036564102079, -13.69664039982154, -18.860187279833028, -25.10222529589771, -20.66300984920325, -14.047168951119453, -14.614602613447307, -16.925518765441513, -24.89496922981778, -35.4785972132621], "policy_predator_policy_reward": [-5.437283762321621, -8.330994395598037, 39.88928462039714, 26.314514463219403, 19.167625596130506, 7.35947079637434, 31.324567475158155, 27.63866328401571, 3.839072163370174, 26.59080984271197, -2.0619521755756693, -3.585415283155765, 7.744580630433415, 3.734685195266856, 17.830981300014777, 36.4184282025955, 26.772210115695348, 37.453590910364404, 14.381958209323916, 28.09392305569278, -16.3420776773429, 4.585296560249791, 19.603196195074695, 19.39102921370307, 2.2442362771345277, -4.7653341422164885, 15.642133637415535, 2.0879824035906314, 58.14539276943214, 59.758372879406636, 26.049579231533414, 34.309144931323964, 2.7422839526392053, -0.3527275489454258, 40.47008318482112, 3.1180277885571597, 28.2623893102293, 25.772792760857577, 15.767069266008882, 37.208450696341615, -1.1146332955972404, 7.163755042427885, 5.466962920152291, 39.10569301608565, 14.24798623535785, -1.1742244980910854, -0.5174755436759737, -15.970144958255347, 36.95271615361838, 40.51809591893858, 11.783154730752775, 2.193672455247869, -22.95232134872707, 15.405924752408861, 37.57513640878236, 41.95216864829118, 43.624382859309094, 27.546443063582064, 35.544805479251906, 34.59339443788156, 2.1862692459681323, 9.116610450339135, 20.5497502868311, 26.250575266845004, -19.700775632851055, 2.749459425651601, 25.191794404719847, 23.00184096619416, 17.910138081414402, 9.0151825681844, 40.019787923372846, 27.460864171413462, 19.421388990482928, 10.87147457377004, 13.810734297994465, 18.473018273454144, 0.4018991664356708, -3.305798345061355, 39.12077761667049, 32.062952854517704, 5.914590275146603, 18.263465239122105, 27.65415453888532, 10.459829033439496, 12.965067620922166, 15.964582828661461, 13.021463165120018, 13.02850922264391, -3.044279674552188, 40.85239352633653, -5.593640014946843, 19.084127046472844, 0.42109459630788404, 29.007388222756603, 34.556029267217646, 38.026980678432, -6.638652226407697, -8.00791796211234, -15.815847802725148, -10.007621119492272, 1.8727430682499624, 35.36390234764231, -0.21752555104177418, 17.348239647184467, 17.447024410408037, 11.380349611934044, 15.361075715968399, 16.714976540542192, 23.986209235410968, 22.6332150075647, 34.28811890205502, 30.73674655777306, 6.514885133230754, 31.229330654714904, 20.80178523037024, 7.180534054461793, 4.784536645934364, -4.954985075412299, 18.22994779759953, 32.17665894460957, -7.249016054597893, 14.210309319536188, 9.48346224212302, 31.497545916756366, 44.8045791066685, 19.36375853932868, 19.65796528092433, 21.17247646255027, 7.163360132235223, 32.12615874879879, 27.460307849144396, 17.138365109707728, 5.758533594106808, 7.084028647396933, 13.818219131534006, -2.6191593891146034, -5.07217780480199, 15.490568018403092, 12.811919291068435, 23.15133013317783, 7.71852697140893, 8.260961954156791, 18.387082636802855, 33.02090322492248, 16.9799596255498, 18.88805739820823, -8.043604084837972, 18.721412186296966, -5.829755764542636, 0.8571998588523364, 25.46701717166747, 14.26893717997331, 9.505268696263954, 18.471075929726474, 35.12964877042788, 12.812976914233285, 30.373647404511757, 11.187485611203059, 23.630681331258906, 14.33223389266909, 9.763945402220584, 12.563637042088985, 16.16643006368675, 27.12196620367088, -8.426732333815698, -9.719215595583133, 8.72768756863926, 24.242721888954197, 6.3806949773735315, 1.6018687626607004, 21.804968848650212, 13.101648000432416, 37.43167147197697, 12.39040217181612, 14.226809427530277, 35.985173706351276, 38.383371836369626, 21.592135311918724, 22.86544232927814, 29.479366596835938, 33.04809887788069, 17.03263240416089, -5.15022827547119, 32.54350907511424, 18.994367246501714, 18.726007313164345, 19.865208311445738, 30.339242280349712, 28.61807160653003, 12.707948091876467, 32.25908790946679, -4.164750007227864, 11.224467339631431, 18.004737887263197, 18.913911701216524, 14.937125829666495, 28.927607268951757, 20.862331190683783, 34.46677562907408, 36.49041879745013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6242590689317723, "mean_inference_ms": 1.6738649914784065, "mean_action_processing_ms": 0.25713035478839197, "mean_env_wait_ms": 0.1450177265821768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005668520927429199, "StateBufferConnector_ms": 0.0027278661727905273, "ViewRequirementAgentConnector_ms": 0.12494933605194092}, "num_episodes": 18, "episode_return_max": 58.951882824419386, "episode_return_min": -12.911734461108722, "episode_return_mean": 16.57050889840464, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.9016952986719, "num_env_steps_trained_throughput_per_sec": 440.9016952986719, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1992000, "timers": {"training_iteration_time_ms": 28092.785, "restore_workers_time_ms": 0.027, "training_step_time_ms": 28092.469, "sample_time_ms": 1649.712, "learn_time_ms": 26419.073, "learn_throughput": 151.406, "synch_weights_time_ms": 21.106}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "done": false, "training_iteration": 166, "trial_id": "06536_00000", "date": "2024-08-11_17-47-30", "timestamp": 1723412850, "time_this_iter_s": 9.076796054840088, "time_total_s": 4389.190922498703, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b586cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4389.190922498703, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 30.623076923076916, "ram_util_percent": 81.66923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0055653112630045, "cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1671472270041705, "policy_loss": -0.005290181456075516, "vf_loss": 2.1724374049653608, "vf_explained_var": 0.9390670090913773, "kl": 0.004730815134124923, "entropy": 0.38782150093466045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.207418736011263, "cur_kl_coeff": 1.1093356479670482e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5026973492884763, "policy_loss": -0.002146923072912075, "vf_loss": 2.504844275290373, "vf_explained_var": 0.935704817216863, "kl": 0.003948416222754896, "entropy": 0.22223857161071564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "env_runners": {"episode_reward_max": 47.69791091218162, "episode_reward_min": -12.911734461108722, "episode_reward_mean": 16.51710237421012, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.69791091218154, "predator_policy": -22.95232134872707}, "policy_reward_max": {"prey_policy": 12.911734461108724, "predator_policy": 60.48443668790487}, "policy_reward_mean": {"prey_policy": -16.51710237421012, "predator_policy": 16.517102374210122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.017591035543443, 26.487759981175248, 3.024560873415327, 22.286327968118943, 6.5368808686333555, -8.24381025096565, 38.73540603627845, 6.988413593000326, -3.773198298159098, 39.76365252853677, 35.58541296144559, 35.069099958566675, 5.651439848153627, 23.400162776838044, -8.475658103599736, 24.09681768545698, 13.462660324799401, 33.74032604739313, 15.146431782126466, 16.14187628572431, -1.4519495893128358, 35.5918652355941, 12.089027757134344, 19.05699178616239, 14.464825224791825, 13.024986193881949, 18.90405692589215, 6.745243515762993, 14.714241409532226, 36.291504972824846, -7.323285094260015, -12.911734461108722, 18.618322707946135, 8.56535704807136, 14.413687011171046, 16.03802612825531, 23.3097121214878, 32.51243272991402, 18.872107893972863, 13.991159642416012, -0.08522421473898589, 25.203303371104525, 3.480646632469118, 20.4905040794397, 32.08416882299861, 20.415220871737297, 19.644759440517014, 22.29933647942609, 6.421281120751872, 5.5995298712096995, 5.209195106800564, 17.98162471212312, 7.989744462782856, 25.703992930862643, 17.934008511879004, 5.338904050729491, -2.4862779528451533, 19.86797717582041, 13.988172312995216, 23.97131284233061, 20.7805665078574, 18.981457611963997, 11.163791222154762, 21.644198133678735, -9.072973964699422, 16.48520472879675, 3.9912818700171124, 17.453308424541323, 24.91103682189659, 25.105991566940784, 29.987753574144158, 26.17240446305703, 25.040365641020806, 13.696640399821517, 18.860187279833028, 25.102225295897735, 20.663009849203245, 14.047168951119465, 14.6146026134473, 16.925518765441527, 24.894969229817757, 35.47859721326213, 7.089703381536215, 34.90530441379248, 45.56339720369814, 24.270222407877505, 9.263137860879443, 9.539007761599082, 47.69791091218162, 17.10742974287006, 9.551638137382474, 6.879882011101827, 21.30399204842167, 13.317260782497053, 16.416535098827644, 8.805386909521518, 9.808595874003407, 0.6447642064884276, 8.638243359221711, 4.76960541889284], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.017591035543433, -26.487759981175245, -3.0245608734153357, -22.286327968118968, -6.5368808686333795, 8.243810250965653, -38.73540603627846, -6.988413593000313, 3.7731982981591035, -39.76365252853671, -35.58541296144558, -35.069099958566746, -5.651439848153636, -23.400162776838066, 8.475658103599725, -24.09681768545702, -13.462660324799407, -33.74032604739313, -15.146431782126498, -16.141876285724283, 1.4519495893128465, -35.59186523559408, -12.089027757134346, -19.056991786162392, -14.46482522479181, -13.024986193881968, -18.90405692589217, -6.745243515763003, -14.714241409532239, -36.29150497282481, 7.323285094260019, 12.911734461108724, -18.618322707946152, -8.565357048071338, -14.41368701117104, -16.03802612825528, -23.309712121487838, -32.51243272991404, -18.87210789397284, -13.991159642416019, 0.08522421473896458, -25.203303371104568, -3.4806466324691545, -20.490504079439695, -32.0841688229986, -20.41522087173729, -19.644759440517, -22.299336479426078, -6.4212811207518605, -5.599529871209704, -5.209195106800555, -17.98162471212313, -7.989744462782864, -25.70399293086267, -17.934008511879014, -5.338904050729494, 2.4862779528451515, -19.867977175820403, -13.988172312995212, -23.97131284233058, -20.780566507857433, -18.981457611963993, -11.163791222154778, -21.644198133678838, 9.072973964699413, -16.485204728796713, -3.991281870017114, -17.45330842454132, -24.911036821896552, -25.10599156694078, -29.9877535741442, -26.172404463057052, -25.04036564102079, -13.69664039982154, -18.860187279833028, -25.10222529589771, -20.66300984920325, -14.047168951119453, -14.614602613447307, -16.925518765441513, -24.89496922981778, -35.4785972132621, -7.089703381536221, -34.905304413792436, -45.56339720369808, -24.270222407877505, -9.263137860879434, -9.53900776159908, -47.69791091218154, -17.1074297428701, -9.551638137382485, -6.879882011101832, -21.30399204842168, -13.317260782497065, -16.416535098827644, -8.805386909521529, -9.808595874003402, -0.6447642064884471, -8.638243359221713, -4.7696054188928345], "policy_predator_policy_reward": [28.2623893102293, 25.772792760857577, 15.767069266008882, 37.208450696341615, -1.1146332955972404, 7.163755042427885, 5.466962920152291, 39.10569301608565, 14.24798623535785, -1.1742244980910854, -0.5174755436759737, -15.970144958255347, 36.95271615361838, 40.51809591893858, 11.783154730752775, 2.193672455247869, -22.95232134872707, 15.405924752408861, 37.57513640878236, 41.95216864829118, 43.624382859309094, 27.546443063582064, 35.544805479251906, 34.59339443788156, 2.1862692459681323, 9.116610450339135, 20.5497502868311, 26.250575266845004, -19.700775632851055, 2.749459425651601, 25.191794404719847, 23.00184096619416, 17.910138081414402, 9.0151825681844, 40.019787923372846, 27.460864171413462, 19.421388990482928, 10.87147457377004, 13.810734297994465, 18.473018273454144, 0.4018991664356708, -3.305798345061355, 39.12077761667049, 32.062952854517704, 5.914590275146603, 18.263465239122105, 27.65415453888532, 10.459829033439496, 12.965067620922166, 15.964582828661461, 13.021463165120018, 13.02850922264391, -3.044279674552188, 40.85239352633653, -5.593640014946843, 19.084127046472844, 0.42109459630788404, 29.007388222756603, 34.556029267217646, 38.026980678432, -6.638652226407697, -8.00791796211234, -15.815847802725148, -10.007621119492272, 1.8727430682499624, 35.36390234764231, -0.21752555104177418, 17.348239647184467, 17.447024410408037, 11.380349611934044, 15.361075715968399, 16.714976540542192, 23.986209235410968, 22.6332150075647, 34.28811890205502, 30.73674655777306, 6.514885133230754, 31.229330654714904, 20.80178523037024, 7.180534054461793, 4.784536645934364, -4.954985075412299, 18.22994779759953, 32.17665894460957, -7.249016054597893, 14.210309319536188, 9.48346224212302, 31.497545916756366, 44.8045791066685, 19.36375853932868, 19.65796528092433, 21.17247646255027, 7.163360132235223, 32.12615874879879, 27.460307849144396, 17.138365109707728, 5.758533594106808, 7.084028647396933, 13.818219131534006, -2.6191593891146034, -5.07217780480199, 15.490568018403092, 12.811919291068435, 23.15133013317783, 7.71852697140893, 8.260961954156791, 18.387082636802855, 33.02090322492248, 16.9799596255498, 18.88805739820823, -8.043604084837972, 18.721412186296966, -5.829755764542636, 0.8571998588523364, 25.46701717166747, 14.26893717997331, 9.505268696263954, 18.471075929726474, 35.12964877042788, 12.812976914233285, 30.373647404511757, 11.187485611203059, 23.630681331258906, 14.33223389266909, 9.763945402220584, 12.563637042088985, 16.16643006368675, 27.12196620367088, -8.426732333815698, -9.719215595583133, 8.72768756863926, 24.242721888954197, 6.3806949773735315, 1.6018687626607004, 21.804968848650212, 13.101648000432416, 37.43167147197697, 12.39040217181612, 14.226809427530277, 35.985173706351276, 38.383371836369626, 21.592135311918724, 22.86544232927814, 29.479366596835938, 33.04809887788069, 17.03263240416089, -5.15022827547119, 32.54350907511424, 18.994367246501714, 18.726007313164345, 19.865208311445738, 30.339242280349712, 28.61807160653003, 12.707948091876467, 32.25908790946679, -4.164750007227864, 11.224467339631431, 18.004737887263197, 18.913911701216524, 14.937125829666495, 28.927607268951757, 20.862331190683783, 34.46677562907408, 36.49041879745013, 3.9165419410599926, 10.262864822012443, 35.61451552773406, 34.19609329985083, 48.76645699585574, 42.36033741154039, 18.138500360883448, 30.401944454871582, 2.44436745556515, 16.08190826619374, 11.710521552630421, 7.367493970567747, 34.91138513645825, 60.48443668790487, 13.120225033141034, 21.094634452599145, 10.893746950735455, 8.2095293240295, 11.899834627811286, 1.8599293943923687, 32.24086386196281, 10.367120234880526, 11.809070901483903, 14.825450663510217, 0.6777693085225707, 32.155300889132725, 13.570762199920091, 4.040011619122957, 9.099214692741153, 10.517977055265652, -0.9524620983672492, 2.2419905113441203, -3.117903312425076, 20.3943900308685, 12.266472090762, -2.7272612529763336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6233658206715859, "mean_inference_ms": 1.6710997375508128, "mean_action_processing_ms": 0.2567484806766236, "mean_env_wait_ms": 0.14475674598661656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004369497299194336, "StateBufferConnector_ms": 0.002592802047729492, "ViewRequirementAgentConnector_ms": 0.08192312717437744}, "num_episodes": 18, "episode_return_max": 47.69791091218162, "episode_return_min": -12.911734461108722, "episode_return_mean": 16.51710237421012, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.7122529318284, "num_env_steps_trained_throughput_per_sec": 450.7122529318284, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2004000, "timers": {"training_iteration_time_ms": 27808.256, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27807.943, "sample_time_ms": 1586.052, "learn_time_ms": 26197.412, "learn_throughput": 152.687, "synch_weights_time_ms": 22.171}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "done": false, "training_iteration": 167, "trial_id": "06536_00000", "date": "2024-08-11_17-47-39", "timestamp": 1723412859, "time_this_iter_s": 8.879791975021362, "time_total_s": 4398.070714473724, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x33179d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4398.070714473724, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 28.46153846153846, "ram_util_percent": 81.66923076923075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.050971527645985, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8755469015489021, "policy_loss": -0.0064653788159679, "vf_loss": 1.882012281815211, "vf_explained_var": 0.9494255404919386, "kl": 0.0062572159131720605, "entropy": 0.40955917599300545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.941255995520839, "cur_kl_coeff": 5.546678239835241e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2763478132152053, "policy_loss": -0.0021717495649619394, "vf_loss": 2.278519556825123, "vf_explained_var": 0.9428137917367239, "kl": 0.002979007990730785, "entropy": 0.20028516136543462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 47.69791091218162, "episode_reward_min": -12.911734461108722, "episode_reward_mean": 15.17559779324507, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.69791091218154, "predator_policy": -15.815847802725148}, "policy_reward_max": {"prey_policy": 12.911734461108724, "predator_policy": 60.48443668790487}, "policy_reward_mean": {"prey_policy": -15.175597793245071, "predator_policy": 15.17559779324507}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.146431782126466, 16.14187628572431, -1.4519495893128358, 35.5918652355941, 12.089027757134344, 19.05699178616239, 14.464825224791825, 13.024986193881949, 18.90405692589215, 6.745243515762993, 14.714241409532226, 36.291504972824846, -7.323285094260015, -12.911734461108722, 18.618322707946135, 8.56535704807136, 14.413687011171046, 16.03802612825531, 23.3097121214878, 32.51243272991402, 18.872107893972863, 13.991159642416012, -0.08522421473898589, 25.203303371104525, 3.480646632469118, 20.4905040794397, 32.08416882299861, 20.415220871737297, 19.644759440517014, 22.29933647942609, 6.421281120751872, 5.5995298712096995, 5.209195106800564, 17.98162471212312, 7.989744462782856, 25.703992930862643, 17.934008511879004, 5.338904050729491, -2.4862779528451533, 19.86797717582041, 13.988172312995216, 23.97131284233061, 20.7805665078574, 18.981457611963997, 11.163791222154762, 21.644198133678735, -9.072973964699422, 16.48520472879675, 3.9912818700171124, 17.453308424541323, 24.91103682189659, 25.105991566940784, 29.987753574144158, 26.17240446305703, 25.040365641020806, 13.696640399821517, 18.860187279833028, 25.102225295897735, 20.663009849203245, 14.047168951119465, 14.6146026134473, 16.925518765441527, 24.894969229817757, 35.47859721326213, 7.089703381536215, 34.90530441379248, 45.56339720369814, 24.270222407877505, 9.263137860879443, 9.539007761599082, 47.69791091218162, 17.10742974287006, 9.551638137382474, 6.879882011101827, 21.30399204842167, 13.317260782497053, 16.416535098827644, 8.805386909521518, 9.808595874003407, 0.6447642064884276, 8.638243359221711, 4.76960541889284, -0.517617436045402, 11.476930676389516, 19.989944615326152, 20.614289057973465, 15.936263554234145, 5.830607209787953, 23.59578273490949, 3.6296454743522277, 16.167628248791445, -0.9781524381325148, -1.871772504582517, 24.34372264857582, 2.2928259862102243, 0.34686394137945964, -3.0314085563839512, 1.3980246794281346, 28.822864160753817, 19.156945685158423], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.146431782126498, -16.141876285724283, 1.4519495893128465, -35.59186523559408, -12.089027757134346, -19.056991786162392, -14.46482522479181, -13.024986193881968, -18.90405692589217, -6.745243515763003, -14.714241409532239, -36.29150497282481, 7.323285094260019, 12.911734461108724, -18.618322707946152, -8.565357048071338, -14.41368701117104, -16.03802612825528, -23.309712121487838, -32.51243272991404, -18.87210789397284, -13.991159642416019, 0.08522421473896458, -25.203303371104568, -3.4806466324691545, -20.490504079439695, -32.0841688229986, -20.41522087173729, -19.644759440517, -22.299336479426078, -6.4212811207518605, -5.599529871209704, -5.209195106800555, -17.98162471212313, -7.989744462782864, -25.70399293086267, -17.934008511879014, -5.338904050729494, 2.4862779528451515, -19.867977175820403, -13.988172312995212, -23.97131284233058, -20.780566507857433, -18.981457611963993, -11.163791222154778, -21.644198133678838, 9.072973964699413, -16.485204728796713, -3.991281870017114, -17.45330842454132, -24.911036821896552, -25.10599156694078, -29.9877535741442, -26.172404463057052, -25.04036564102079, -13.69664039982154, -18.860187279833028, -25.10222529589771, -20.66300984920325, -14.047168951119453, -14.614602613447307, -16.925518765441513, -24.89496922981778, -35.4785972132621, -7.089703381536221, -34.905304413792436, -45.56339720369808, -24.270222407877505, -9.263137860879434, -9.53900776159908, -47.69791091218154, -17.1074297428701, -9.551638137382485, -6.879882011101832, -21.30399204842168, -13.317260782497065, -16.416535098827644, -8.805386909521529, -9.808595874003402, -0.6447642064884471, -8.638243359221713, -4.7696054188928345, 0.5176174360454069, -11.476930676389552, -19.98994461532615, -20.61428905797347, -15.936263554234166, -5.830607209787937, -23.595782734909477, -3.629645474352233, -16.167628248791495, 0.9781524381325202, 1.8717725045825189, -24.34372264857585, -2.292825986210234, -0.3468639413794605, 3.0314085563839637, -1.3980246794281266, -28.822864160753813, -19.156945685158405], "policy_predator_policy_reward": [19.421388990482928, 10.87147457377004, 13.810734297994465, 18.473018273454144, 0.4018991664356708, -3.305798345061355, 39.12077761667049, 32.062952854517704, 5.914590275146603, 18.263465239122105, 27.65415453888532, 10.459829033439496, 12.965067620922166, 15.964582828661461, 13.021463165120018, 13.02850922264391, -3.044279674552188, 40.85239352633653, -5.593640014946843, 19.084127046472844, 0.42109459630788404, 29.007388222756603, 34.556029267217646, 38.026980678432, -6.638652226407697, -8.00791796211234, -15.815847802725148, -10.007621119492272, 1.8727430682499624, 35.36390234764231, -0.21752555104177418, 17.348239647184467, 17.447024410408037, 11.380349611934044, 15.361075715968399, 16.714976540542192, 23.986209235410968, 22.6332150075647, 34.28811890205502, 30.73674655777306, 6.514885133230754, 31.229330654714904, 20.80178523037024, 7.180534054461793, 4.784536645934364, -4.954985075412299, 18.22994779759953, 32.17665894460957, -7.249016054597893, 14.210309319536188, 9.48346224212302, 31.497545916756366, 44.8045791066685, 19.36375853932868, 19.65796528092433, 21.17247646255027, 7.163360132235223, 32.12615874879879, 27.460307849144396, 17.138365109707728, 5.758533594106808, 7.084028647396933, 13.818219131534006, -2.6191593891146034, -5.07217780480199, 15.490568018403092, 12.811919291068435, 23.15133013317783, 7.71852697140893, 8.260961954156791, 18.387082636802855, 33.02090322492248, 16.9799596255498, 18.88805739820823, -8.043604084837972, 18.721412186296966, -5.829755764542636, 0.8571998588523364, 25.46701717166747, 14.26893717997331, 9.505268696263954, 18.471075929726474, 35.12964877042788, 12.812976914233285, 30.373647404511757, 11.187485611203059, 23.630681331258906, 14.33223389266909, 9.763945402220584, 12.563637042088985, 16.16643006368675, 27.12196620367088, -8.426732333815698, -9.719215595583133, 8.72768756863926, 24.242721888954197, 6.3806949773735315, 1.6018687626607004, 21.804968848650212, 13.101648000432416, 37.43167147197697, 12.39040217181612, 14.226809427530277, 35.985173706351276, 38.383371836369626, 21.592135311918724, 22.86544232927814, 29.479366596835938, 33.04809887788069, 17.03263240416089, -5.15022827547119, 32.54350907511424, 18.994367246501714, 18.726007313164345, 19.865208311445738, 30.339242280349712, 28.61807160653003, 12.707948091876467, 32.25908790946679, -4.164750007227864, 11.224467339631431, 18.004737887263197, 18.913911701216524, 14.937125829666495, 28.927607268951757, 20.862331190683783, 34.46677562907408, 36.49041879745013, 3.9165419410599926, 10.262864822012443, 35.61451552773406, 34.19609329985083, 48.76645699585574, 42.36033741154039, 18.138500360883448, 30.401944454871582, 2.44436745556515, 16.08190826619374, 11.710521552630421, 7.367493970567747, 34.91138513645825, 60.48443668790487, 13.120225033141034, 21.094634452599145, 10.893746950735455, 8.2095293240295, 11.899834627811286, 1.8599293943923687, 32.24086386196281, 10.367120234880526, 11.809070901483903, 14.825450663510217, 0.6777693085225707, 32.155300889132725, 13.570762199920091, 4.040011619122957, 9.099214692741153, 10.517977055265652, -0.9524620983672492, 2.2419905113441203, -3.117903312425076, 20.3943900308685, 12.266472090762, -2.7272612529763336, -2.1282889436295918, 1.0930540715387789, 14.046278493555274, 8.907582859223815, 4.012744896027709, 35.967144334624585, 6.529496247171329, 34.699081868775586, 1.7175084267768934, 30.15501868169138, 12.859596688856474, -1.1983822692805504, 26.235200749806893, 20.95636472001209, 16.990650105226138, -9.73135915652168, 20.669286921028935, 11.665969576554025, 2.9733904990480706, -4.929695375313107, -5.338843954686899, 1.595298945521865, 28.003793503225346, 20.683651793926344, 13.212970484536216, -8.627318512115755, 9.697858630242905, -9.00413074748397, 3.194007350001483, -9.256824462769412, 2.036615572850752, 0.7594337860055038, 38.02185118271322, 19.62387713879442, 18.967044553425183, 19.34684681689167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6224199787726644, "mean_inference_ms": 1.6680285762120126, "mean_action_processing_ms": 0.2563468594940954, "mean_env_wait_ms": 0.14446659333517317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004693150520324707, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.08115983009338379}, "num_episodes": 18, "episode_return_max": 47.69791091218162, "episode_return_min": -12.911734461108722, "episode_return_mean": 15.17559779324507, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.2731047970745, "num_env_steps_trained_throughput_per_sec": 445.2731047970745, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 27491.697, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27491.385, "sample_time_ms": 1513.063, "learn_time_ms": 25954.269, "learn_throughput": 154.117, "synch_weights_time_ms": 21.802}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 168, "trial_id": "06536_00000", "date": "2024-08-11_17-47-48", "timestamp": 1723412868, "time_this_iter_s": 8.988802671432495, "time_total_s": 4407.059517145157, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63a8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4407.059517145157, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 29.330769230769228, "ram_util_percent": 81.82307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.178717189406355, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0498784811546407, "policy_loss": -0.00649501641698104, "vf_loss": 2.0563734953602153, "vf_explained_var": 0.9606142511591316, "kl": 0.005570261250594536, "entropy": 0.38352571669965985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.022140908115125, "cur_kl_coeff": 2.7733391199176204e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.395836917307011, "policy_loss": -0.0025479290943602644, "vf_loss": 2.398384844752216, "vf_explained_var": 0.9573916866035058, "kl": 0.00354764819509528, "entropy": 0.21519504127994415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "env_runners": {"episode_reward_max": 47.69791091218162, "episode_reward_min": -9.072973964699422, "episode_reward_mean": 15.39359546861003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.69791091218154, "predator_policy": -11.821801585570793}, "policy_reward_max": {"prey_policy": 9.072973964699413, "predator_policy": 60.48443668790487}, "policy_reward_mean": {"prey_policy": -15.393595468610028, "predator_policy": 15.39359546861003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.415220871737297, 19.644759440517014, 22.29933647942609, 6.421281120751872, 5.5995298712096995, 5.209195106800564, 17.98162471212312, 7.989744462782856, 25.703992930862643, 17.934008511879004, 5.338904050729491, -2.4862779528451533, 19.86797717582041, 13.988172312995216, 23.97131284233061, 20.7805665078574, 18.981457611963997, 11.163791222154762, 21.644198133678735, -9.072973964699422, 16.48520472879675, 3.9912818700171124, 17.453308424541323, 24.91103682189659, 25.105991566940784, 29.987753574144158, 26.17240446305703, 25.040365641020806, 13.696640399821517, 18.860187279833028, 25.102225295897735, 20.663009849203245, 14.047168951119465, 14.6146026134473, 16.925518765441527, 24.894969229817757, 35.47859721326213, 7.089703381536215, 34.90530441379248, 45.56339720369814, 24.270222407877505, 9.263137860879443, 9.539007761599082, 47.69791091218162, 17.10742974287006, 9.551638137382474, 6.879882011101827, 21.30399204842167, 13.317260782497053, 16.416535098827644, 8.805386909521518, 9.808595874003407, 0.6447642064884276, 8.638243359221711, 4.76960541889284, -0.517617436045402, 11.476930676389516, 19.989944615326152, 20.614289057973465, 15.936263554234145, 5.830607209787953, 23.59578273490949, 3.6296454743522277, 16.167628248791445, -0.9781524381325148, -1.871772504582517, 24.34372264857582, 2.2928259862102243, 0.34686394137945964, -3.0314085563839512, 1.3980246794281346, 28.822864160753817, 19.156945685158423, 27.132198176463802, 13.275415937930427, 15.977507537601172, 18.238850698481166, 17.38151261411463, 12.89747634815267, 18.757906374512903, 13.02276748776732, 17.11556143068417, 21.612720861391573, 9.099669607951999, 13.886041486515982, 25.33582231284706, 5.954612174512681, 33.334053282640426, 9.38976471338996, 11.567176899371702, 23.209870879116746, 1.2422812922196638, 10.248333953518717, 20.658356975150042, 13.292537976084695, 12.110727772186301, 27.491464099536735, 11.951258503516067, 27.58976538191909, -1.995601321828146], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.41522087173729, -19.644759440517, -22.299336479426078, -6.4212811207518605, -5.599529871209704, -5.209195106800555, -17.98162471212313, -7.989744462782864, -25.70399293086267, -17.934008511879014, -5.338904050729494, 2.4862779528451515, -19.867977175820403, -13.988172312995212, -23.97131284233058, -20.780566507857433, -18.981457611963993, -11.163791222154778, -21.644198133678838, 9.072973964699413, -16.485204728796713, -3.991281870017114, -17.45330842454132, -24.911036821896552, -25.10599156694078, -29.9877535741442, -26.172404463057052, -25.04036564102079, -13.69664039982154, -18.860187279833028, -25.10222529589771, -20.66300984920325, -14.047168951119453, -14.614602613447307, -16.925518765441513, -24.89496922981778, -35.4785972132621, -7.089703381536221, -34.905304413792436, -45.56339720369808, -24.270222407877505, -9.263137860879434, -9.53900776159908, -47.69791091218154, -17.1074297428701, -9.551638137382485, -6.879882011101832, -21.30399204842168, -13.317260782497065, -16.416535098827644, -8.805386909521529, -9.808595874003402, -0.6447642064884471, -8.638243359221713, -4.7696054188928345, 0.5176174360454069, -11.476930676389552, -19.98994461532615, -20.61428905797347, -15.936263554234166, -5.830607209787937, -23.595782734909477, -3.629645474352233, -16.167628248791495, 0.9781524381325202, 1.8717725045825189, -24.34372264857585, -2.292825986210234, -0.3468639413794605, 3.0314085563839637, -1.3980246794281266, -28.822864160753813, -19.156945685158405, -27.132198176463817, -13.275415937930415, -15.977507537601156, -18.238850698481176, -17.381512614114627, -12.897476348152676, -18.757906374512913, -13.02276748776735, -17.115561430684192, -21.61272086139156, -9.09966960795202, -13.88604148651598, -25.335822312847085, -5.95461217451264, -33.33405328264041, -9.38976471338998, -11.567176899371677, -23.209870879116778, -1.2422812922196513, -10.248333953518719, -20.658356975150078, -13.292537976084704, -12.110727772186312, -27.49146409953674, -11.951258503516083, -27.58976538191911, 1.9956013218281474], "policy_predator_policy_reward": [19.65796528092433, 21.17247646255027, 7.163360132235223, 32.12615874879879, 27.460307849144396, 17.138365109707728, 5.758533594106808, 7.084028647396933, 13.818219131534006, -2.6191593891146034, -5.07217780480199, 15.490568018403092, 12.811919291068435, 23.15133013317783, 7.71852697140893, 8.260961954156791, 18.387082636802855, 33.02090322492248, 16.9799596255498, 18.88805739820823, -8.043604084837972, 18.721412186296966, -5.829755764542636, 0.8571998588523364, 25.46701717166747, 14.26893717997331, 9.505268696263954, 18.471075929726474, 35.12964877042788, 12.812976914233285, 30.373647404511757, 11.187485611203059, 23.630681331258906, 14.33223389266909, 9.763945402220584, 12.563637042088985, 16.16643006368675, 27.12196620367088, -8.426732333815698, -9.719215595583133, 8.72768756863926, 24.242721888954197, 6.3806949773735315, 1.6018687626607004, 21.804968848650212, 13.101648000432416, 37.43167147197697, 12.39040217181612, 14.226809427530277, 35.985173706351276, 38.383371836369626, 21.592135311918724, 22.86544232927814, 29.479366596835938, 33.04809887788069, 17.03263240416089, -5.15022827547119, 32.54350907511424, 18.994367246501714, 18.726007313164345, 19.865208311445738, 30.339242280349712, 28.61807160653003, 12.707948091876467, 32.25908790946679, -4.164750007227864, 11.224467339631431, 18.004737887263197, 18.913911701216524, 14.937125829666495, 28.927607268951757, 20.862331190683783, 34.46677562907408, 36.49041879745013, 3.9165419410599926, 10.262864822012443, 35.61451552773406, 34.19609329985083, 48.76645699585574, 42.36033741154039, 18.138500360883448, 30.401944454871582, 2.44436745556515, 16.08190826619374, 11.710521552630421, 7.367493970567747, 34.91138513645825, 60.48443668790487, 13.120225033141034, 21.094634452599145, 10.893746950735455, 8.2095293240295, 11.899834627811286, 1.8599293943923687, 32.24086386196281, 10.367120234880526, 11.809070901483903, 14.825450663510217, 0.6777693085225707, 32.155300889132725, 13.570762199920091, 4.040011619122957, 9.099214692741153, 10.517977055265652, -0.9524620983672492, 2.2419905113441203, -3.117903312425076, 20.3943900308685, 12.266472090762, -2.7272612529763336, -2.1282889436295918, 1.0930540715387789, 14.046278493555274, 8.907582859223815, 4.012744896027709, 35.967144334624585, 6.529496247171329, 34.699081868775586, 1.7175084267768934, 30.15501868169138, 12.859596688856474, -1.1983822692805504, 26.235200749806893, 20.95636472001209, 16.990650105226138, -9.73135915652168, 20.669286921028935, 11.665969576554025, 2.9733904990480706, -4.929695375313107, -5.338843954686899, 1.595298945521865, 28.003793503225346, 20.683651793926344, 13.212970484536216, -8.627318512115755, 9.697858630242905, -9.00413074748397, 3.194007350001483, -9.256824462769412, 2.036615572850752, 0.7594337860055038, 38.02185118271322, 19.62387713879442, 18.967044553425183, 19.34684681689167, 37.89969154273457, 16.36470481019307, 22.037069207098142, 4.5137626687626895, 28.195862182092966, 3.7591528931093823, 15.918899614220248, 20.55880178274209, 15.540993383042121, 19.222031845187146, 15.67687433733927, 10.118078358966079, 38.34134417769881, -0.8255314286729694, 7.185545257559102, 18.85998971797558, 22.669087135550175, 11.56203572581821, 9.104220319821296, 34.121221402961794, -1.6889339159479224, 19.888273131851964, 23.00124356176531, 4.770839411266653, 28.436206399438127, 22.235438226256, 3.733613953105497, 8.175610395919797, 20.80442871906736, 45.863677846213456, 7.536620052956554, 11.242909373823384, -2.7245844124428373, 25.858938211186185, 17.08870387839267, 29.331037879840924, -11.821801585570793, 14.306364170010045, 4.807170048430596, 15.689497858606867, 17.374452748582712, 23.942261201717443, 21.159334810039315, 5.425741142130107, -2.076382015861788, 26.29783756023442, 26.075780421501996, 28.90714777757149, 12.11368380708917, 11.788833199942994, 24.443139500810762, 30.736391263027482, -6.1831654696659, 2.1919628260095987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6203310890062982, "mean_inference_ms": 1.6600857331681724, "mean_action_processing_ms": 0.25528750929025634, "mean_env_wait_ms": 0.14377174469897422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.002392411231994629, "ViewRequirementAgentConnector_ms": 0.06394588947296143}, "num_episodes": 27, "episode_return_max": 47.69791091218162, "episode_return_min": -9.072973964699422, "episode_return_mean": 15.39359546861003, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.30142755915665, "num_env_steps_trained_throughput_per_sec": 444.30142755915665, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2028000, "timers": {"training_iteration_time_ms": 27166.353, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27166.042, "sample_time_ms": 1434.145, "learn_time_ms": 25708.954, "learn_throughput": 155.588, "synch_weights_time_ms": 21.61}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "done": false, "training_iteration": 169, "trial_id": "06536_00000", "date": "2024-08-11_17-47-57", "timestamp": 1723412877, "time_this_iter_s": 9.007385015487671, "time_total_s": 4416.0669021606445, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63a8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4416.0669021606445, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 29.41666666666666, "ram_util_percent": 81.88333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9299097112069528, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9339789743845661, "policy_loss": -0.005114721937085657, "vf_loss": 1.9390936952705184, "vf_explained_var": 0.9584580640618999, "kl": 0.005312209959277596, "entropy": 0.3681940782194336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.201471455639632, "cur_kl_coeff": 1.3866695599588102e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.467173847256514, "policy_loss": -0.0016405285959422745, "vf_loss": 2.4688143709349255, "vf_explained_var": 0.9542930712775578, "kl": 0.0033099431104238602, "entropy": 0.19564239467893327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 47.69791091218162, "episode_reward_min": -9.072973964699422, "episode_reward_mean": 16.288734214373484, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.69791091218154, "predator_policy": -11.862821593773795}, "policy_reward_max": {"prey_policy": 9.072973964699413, "predator_policy": 60.48443668790487}, "policy_reward_mean": {"prey_policy": -16.288734214373484, "predator_policy": 16.288734214373484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.644198133678735, -9.072973964699422, 16.48520472879675, 3.9912818700171124, 17.453308424541323, 24.91103682189659, 25.105991566940784, 29.987753574144158, 26.17240446305703, 25.040365641020806, 13.696640399821517, 18.860187279833028, 25.102225295897735, 20.663009849203245, 14.047168951119465, 14.6146026134473, 16.925518765441527, 24.894969229817757, 35.47859721326213, 7.089703381536215, 34.90530441379248, 45.56339720369814, 24.270222407877505, 9.263137860879443, 9.539007761599082, 47.69791091218162, 17.10742974287006, 9.551638137382474, 6.879882011101827, 21.30399204842167, 13.317260782497053, 16.416535098827644, 8.805386909521518, 9.808595874003407, 0.6447642064884276, 8.638243359221711, 4.76960541889284, -0.517617436045402, 11.476930676389516, 19.989944615326152, 20.614289057973465, 15.936263554234145, 5.830607209787953, 23.59578273490949, 3.6296454743522277, 16.167628248791445, -0.9781524381325148, -1.871772504582517, 24.34372264857582, 2.2928259862102243, 0.34686394137945964, -3.0314085563839512, 1.3980246794281346, 28.822864160753817, 19.156945685158423, 27.132198176463802, 13.275415937930427, 15.977507537601172, 18.238850698481166, 17.38151261411463, 12.89747634815267, 18.757906374512903, 13.02276748776732, 17.11556143068417, 21.612720861391573, 9.099669607951999, 13.886041486515982, 25.33582231284706, 5.954612174512681, 33.334053282640426, 9.38976471338996, 11.567176899371702, 23.209870879116746, 1.2422812922196638, 10.248333953518717, 20.658356975150042, 13.292537976084695, 12.110727772186301, 27.491464099536735, 11.951258503516067, 27.58976538191909, -1.995601321828146, 15.585504965141862, 16.370788471822735, 24.99982514916008, 12.891696731004092, -3.4274349235424255, 17.083217899588142, 5.29369988536684, 27.0960494301114, 38.16948671467198, 18.939816178029595, 39.73905601149949, 30.72431913841376, 7.832273816473814, 17.633306742287807, 28.89832286468669, -0.7148172440946423, 23.591896906725516, 29.61146311809559], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.644198133678838, 9.072973964699413, -16.485204728796713, -3.991281870017114, -17.45330842454132, -24.911036821896552, -25.10599156694078, -29.9877535741442, -26.172404463057052, -25.04036564102079, -13.69664039982154, -18.860187279833028, -25.10222529589771, -20.66300984920325, -14.047168951119453, -14.614602613447307, -16.925518765441513, -24.89496922981778, -35.4785972132621, -7.089703381536221, -34.905304413792436, -45.56339720369808, -24.270222407877505, -9.263137860879434, -9.53900776159908, -47.69791091218154, -17.1074297428701, -9.551638137382485, -6.879882011101832, -21.30399204842168, -13.317260782497065, -16.416535098827644, -8.805386909521529, -9.808595874003402, -0.6447642064884471, -8.638243359221713, -4.7696054188928345, 0.5176174360454069, -11.476930676389552, -19.98994461532615, -20.61428905797347, -15.936263554234166, -5.830607209787937, -23.595782734909477, -3.629645474352233, -16.167628248791495, 0.9781524381325202, 1.8717725045825189, -24.34372264857585, -2.292825986210234, -0.3468639413794605, 3.0314085563839637, -1.3980246794281266, -28.822864160753813, -19.156945685158405, -27.132198176463817, -13.275415937930415, -15.977507537601156, -18.238850698481176, -17.381512614114627, -12.897476348152676, -18.757906374512913, -13.02276748776735, -17.115561430684192, -21.61272086139156, -9.09966960795202, -13.88604148651598, -25.335822312847085, -5.95461217451264, -33.33405328264041, -9.38976471338998, -11.567176899371677, -23.209870879116778, -1.2422812922196513, -10.248333953518719, -20.658356975150078, -13.292537976084704, -12.110727772186312, -27.49146409953674, -11.951258503516083, -27.58976538191911, 1.9956013218281474, -15.585504965141839, -16.37078847182275, -24.999825149160063, -12.891696731004101, 3.4274349235424264, -17.08321789958808, -5.29369988536685, -27.096049430111403, -38.16948671467199, -18.93981617802958, -39.73905601149949, -30.724319138413733, -7.832273816473806, -17.633306742287793, -28.898322864686676, 0.7148172440946228, -23.59189690672551, -29.611463118095607], "policy_predator_policy_reward": [16.16643006368675, 27.12196620367088, -8.426732333815698, -9.719215595583133, 8.72768756863926, 24.242721888954197, 6.3806949773735315, 1.6018687626607004, 21.804968848650212, 13.101648000432416, 37.43167147197697, 12.39040217181612, 14.226809427530277, 35.985173706351276, 38.383371836369626, 21.592135311918724, 22.86544232927814, 29.479366596835938, 33.04809887788069, 17.03263240416089, -5.15022827547119, 32.54350907511424, 18.994367246501714, 18.726007313164345, 19.865208311445738, 30.339242280349712, 28.61807160653003, 12.707948091876467, 32.25908790946679, -4.164750007227864, 11.224467339631431, 18.004737887263197, 18.913911701216524, 14.937125829666495, 28.927607268951757, 20.862331190683783, 34.46677562907408, 36.49041879745013, 3.9165419410599926, 10.262864822012443, 35.61451552773406, 34.19609329985083, 48.76645699585574, 42.36033741154039, 18.138500360883448, 30.401944454871582, 2.44436745556515, 16.08190826619374, 11.710521552630421, 7.367493970567747, 34.91138513645825, 60.48443668790487, 13.120225033141034, 21.094634452599145, 10.893746950735455, 8.2095293240295, 11.899834627811286, 1.8599293943923687, 32.24086386196281, 10.367120234880526, 11.809070901483903, 14.825450663510217, 0.6777693085225707, 32.155300889132725, 13.570762199920091, 4.040011619122957, 9.099214692741153, 10.517977055265652, -0.9524620983672492, 2.2419905113441203, -3.117903312425076, 20.3943900308685, 12.266472090762, -2.7272612529763336, -2.1282889436295918, 1.0930540715387789, 14.046278493555274, 8.907582859223815, 4.012744896027709, 35.967144334624585, 6.529496247171329, 34.699081868775586, 1.7175084267768934, 30.15501868169138, 12.859596688856474, -1.1983822692805504, 26.235200749806893, 20.95636472001209, 16.990650105226138, -9.73135915652168, 20.669286921028935, 11.665969576554025, 2.9733904990480706, -4.929695375313107, -5.338843954686899, 1.595298945521865, 28.003793503225346, 20.683651793926344, 13.212970484536216, -8.627318512115755, 9.697858630242905, -9.00413074748397, 3.194007350001483, -9.256824462769412, 2.036615572850752, 0.7594337860055038, 38.02185118271322, 19.62387713879442, 18.967044553425183, 19.34684681689167, 37.89969154273457, 16.36470481019307, 22.037069207098142, 4.5137626687626895, 28.195862182092966, 3.7591528931093823, 15.918899614220248, 20.55880178274209, 15.540993383042121, 19.222031845187146, 15.67687433733927, 10.118078358966079, 38.34134417769881, -0.8255314286729694, 7.185545257559102, 18.85998971797558, 22.669087135550175, 11.56203572581821, 9.104220319821296, 34.121221402961794, -1.6889339159479224, 19.888273131851964, 23.00124356176531, 4.770839411266653, 28.436206399438127, 22.235438226256, 3.733613953105497, 8.175610395919797, 20.80442871906736, 45.863677846213456, 7.536620052956554, 11.242909373823384, -2.7245844124428373, 25.858938211186185, 17.08870387839267, 29.331037879840924, -11.821801585570793, 14.306364170010045, 4.807170048430596, 15.689497858606867, 17.374452748582712, 23.942261201717443, 21.159334810039315, 5.425741142130107, -2.076382015861788, 26.29783756023442, 26.075780421501996, 28.90714777757149, 12.11368380708917, 11.788833199942994, 24.443139500810762, 30.736391263027482, -6.1831654696659, 2.1919628260095987, 23.84400124475212, 7.327008685531549, 12.556120605439766, 20.18545633820569, 22.545649946043525, 27.454000352276616, 2.814360778000405, 22.969032684007836, -2.872901574236007, -3.9819682728488495, 25.089932616449836, 9.076503182726363, 0.8979001958214603, 9.689499574912244, 22.203384343292043, 31.988714516930706, 26.1032703130233, 50.23570311632068, 20.551522055044238, 17.328110301014938, 46.89751837180365, 32.58059365119538, 27.925532170105974, 33.523106106721464, 6.316270458510951, 9.348277174436667, 28.799031427927716, 6.467582056647856, 24.997220920289763, 32.79942480908355, 10.433187105584551, -11.862821593773795, 37.596296733390446, 9.587497080060556, 24.09140352049478, 35.13152271569645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6194356785763412, "mean_inference_ms": 1.659012374349095, "mean_action_processing_ms": 0.2551664271120442, "mean_env_wait_ms": 0.14362050145454522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506183624267578, "StateBufferConnector_ms": 0.002397775650024414, "ViewRequirementAgentConnector_ms": 0.06332993507385254}, "num_episodes": 18, "episode_return_max": 47.69791091218162, "episode_return_min": -9.072973964699422, "episode_return_mean": 16.288734214373484, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.6881745124211, "num_env_steps_trained_throughput_per_sec": 445.6881745124211, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 26448.449, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26448.18, "sample_time_ms": 1345.724, "learn_time_ms": 25081.013, "learn_throughput": 159.483, "synch_weights_time_ms": 20.179}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 170, "trial_id": "06536_00000", "date": "2024-08-11_17-48-06", "timestamp": 1723412886, "time_this_iter_s": 8.980880737304688, "time_total_s": 4425.047782897949, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x331792dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4425.047782897949, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 24.5, "ram_util_percent": 82.1846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9776143029332163, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.323796700189511, "policy_loss": -0.0059143364293656004, "vf_loss": 2.3297110490500925, "vf_explained_var": 0.931260741998752, "kl": 0.0059419555785405215, "entropy": 0.32466471114506323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.083504085629075, "cur_kl_coeff": 6.933347799794051e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4606723218367845, "policy_loss": -0.0015966049426299317, "vf_loss": 2.462268925911535, "vf_explained_var": 0.9373733619848887, "kl": 0.003226764845330601, "entropy": 0.1629421807470776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "env_runners": {"episode_reward_max": 47.69791091218162, "episode_reward_min": -6.6769730110136525, "episode_reward_mean": 15.774683363591267, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -47.69791091218154, "predator_policy": -11.862821593773795}, "policy_reward_max": {"prey_policy": 6.676973011013656, "predator_policy": 60.48443668790487}, "policy_reward_mean": {"prey_policy": -15.774683363591263, "predator_policy": 15.774683363591267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.47859721326213, 7.089703381536215, 34.90530441379248, 45.56339720369814, 24.270222407877505, 9.263137860879443, 9.539007761599082, 47.69791091218162, 17.10742974287006, 9.551638137382474, 6.879882011101827, 21.30399204842167, 13.317260782497053, 16.416535098827644, 8.805386909521518, 9.808595874003407, 0.6447642064884276, 8.638243359221711, 4.76960541889284, -0.517617436045402, 11.476930676389516, 19.989944615326152, 20.614289057973465, 15.936263554234145, 5.830607209787953, 23.59578273490949, 3.6296454743522277, 16.167628248791445, -0.9781524381325148, -1.871772504582517, 24.34372264857582, 2.2928259862102243, 0.34686394137945964, -3.0314085563839512, 1.3980246794281346, 28.822864160753817, 19.156945685158423, 27.132198176463802, 13.275415937930427, 15.977507537601172, 18.238850698481166, 17.38151261411463, 12.89747634815267, 18.757906374512903, 13.02276748776732, 17.11556143068417, 21.612720861391573, 9.099669607951999, 13.886041486515982, 25.33582231284706, 5.954612174512681, 33.334053282640426, 9.38976471338996, 11.567176899371702, 23.209870879116746, 1.2422812922196638, 10.248333953518717, 20.658356975150042, 13.292537976084695, 12.110727772186301, 27.491464099536735, 11.951258503516067, 27.58976538191909, -1.995601321828146, 15.585504965141862, 16.370788471822735, 24.99982514916008, 12.891696731004092, -3.4274349235424255, 17.083217899588142, 5.29369988536684, 27.0960494301114, 38.16948671467198, 18.939816178029595, 39.73905601149949, 30.72431913841376, 7.832273816473814, 17.633306742287807, 28.89832286468669, -0.7148172440946423, 23.591896906725516, 29.61146311809559, 11.858086635542513, 4.126115700439128, 8.833614951520909, 19.828406736537175, -6.6769730110136525, 20.24532661623041, 10.892762376107843, 20.45590508445507, 6.169454192676154, 26.225931031183784, 21.108104868684123, 6.691467166427284, 23.29388488348673, -0.0013967001540047264, 31.501282417371506, 24.465826143709556, 30.876514642440696, 19.22349483010834], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.4785972132621, -7.089703381536221, -34.905304413792436, -45.56339720369808, -24.270222407877505, -9.263137860879434, -9.53900776159908, -47.69791091218154, -17.1074297428701, -9.551638137382485, -6.879882011101832, -21.30399204842168, -13.317260782497065, -16.416535098827644, -8.805386909521529, -9.808595874003402, -0.6447642064884471, -8.638243359221713, -4.7696054188928345, 0.5176174360454069, -11.476930676389552, -19.98994461532615, -20.61428905797347, -15.936263554234166, -5.830607209787937, -23.595782734909477, -3.629645474352233, -16.167628248791495, 0.9781524381325202, 1.8717725045825189, -24.34372264857585, -2.292825986210234, -0.3468639413794605, 3.0314085563839637, -1.3980246794281266, -28.822864160753813, -19.156945685158405, -27.132198176463817, -13.275415937930415, -15.977507537601156, -18.238850698481176, -17.381512614114627, -12.897476348152676, -18.757906374512913, -13.02276748776735, -17.115561430684192, -21.61272086139156, -9.09966960795202, -13.88604148651598, -25.335822312847085, -5.95461217451264, -33.33405328264041, -9.38976471338998, -11.567176899371677, -23.209870879116778, -1.2422812922196513, -10.248333953518719, -20.658356975150078, -13.292537976084704, -12.110727772186312, -27.49146409953674, -11.951258503516083, -27.58976538191911, 1.9956013218281474, -15.585504965141839, -16.37078847182275, -24.999825149160063, -12.891696731004101, 3.4274349235424264, -17.08321789958808, -5.29369988536685, -27.096049430111403, -38.16948671467199, -18.93981617802958, -39.73905601149949, -30.724319138413733, -7.832273816473806, -17.633306742287793, -28.898322864686676, 0.7148172440946228, -23.59189690672551, -29.611463118095607, -11.85808663554249, -4.126115700439141, -8.83361495152088, -19.828406736537186, 6.676973011013656, -20.245326616230436, -10.892762376107843, -20.45590508445512, -6.169454192676163, -26.225931031183777, -21.10810486868413, -6.691467166427275, -23.293884883486704, 0.001396700154007391, -31.50128241737149, -24.46582614370952, -30.87651464244067, -19.22349483010833], "policy_predator_policy_reward": [34.46677562907408, 36.49041879745013, 3.9165419410599926, 10.262864822012443, 35.61451552773406, 34.19609329985083, 48.76645699585574, 42.36033741154039, 18.138500360883448, 30.401944454871582, 2.44436745556515, 16.08190826619374, 11.710521552630421, 7.367493970567747, 34.91138513645825, 60.48443668790487, 13.120225033141034, 21.094634452599145, 10.893746950735455, 8.2095293240295, 11.899834627811286, 1.8599293943923687, 32.24086386196281, 10.367120234880526, 11.809070901483903, 14.825450663510217, 0.6777693085225707, 32.155300889132725, 13.570762199920091, 4.040011619122957, 9.099214692741153, 10.517977055265652, -0.9524620983672492, 2.2419905113441203, -3.117903312425076, 20.3943900308685, 12.266472090762, -2.7272612529763336, -2.1282889436295918, 1.0930540715387789, 14.046278493555274, 8.907582859223815, 4.012744896027709, 35.967144334624585, 6.529496247171329, 34.699081868775586, 1.7175084267768934, 30.15501868169138, 12.859596688856474, -1.1983822692805504, 26.235200749806893, 20.95636472001209, 16.990650105226138, -9.73135915652168, 20.669286921028935, 11.665969576554025, 2.9733904990480706, -4.929695375313107, -5.338843954686899, 1.595298945521865, 28.003793503225346, 20.683651793926344, 13.212970484536216, -8.627318512115755, 9.697858630242905, -9.00413074748397, 3.194007350001483, -9.256824462769412, 2.036615572850752, 0.7594337860055038, 38.02185118271322, 19.62387713879442, 18.967044553425183, 19.34684681689167, 37.89969154273457, 16.36470481019307, 22.037069207098142, 4.5137626687626895, 28.195862182092966, 3.7591528931093823, 15.918899614220248, 20.55880178274209, 15.540993383042121, 19.222031845187146, 15.67687433733927, 10.118078358966079, 38.34134417769881, -0.8255314286729694, 7.185545257559102, 18.85998971797558, 22.669087135550175, 11.56203572581821, 9.104220319821296, 34.121221402961794, -1.6889339159479224, 19.888273131851964, 23.00124356176531, 4.770839411266653, 28.436206399438127, 22.235438226256, 3.733613953105497, 8.175610395919797, 20.80442871906736, 45.863677846213456, 7.536620052956554, 11.242909373823384, -2.7245844124428373, 25.858938211186185, 17.08870387839267, 29.331037879840924, -11.821801585570793, 14.306364170010045, 4.807170048430596, 15.689497858606867, 17.374452748582712, 23.942261201717443, 21.159334810039315, 5.425741142130107, -2.076382015861788, 26.29783756023442, 26.075780421501996, 28.90714777757149, 12.11368380708917, 11.788833199942994, 24.443139500810762, 30.736391263027482, -6.1831654696659, 2.1919628260095987, 23.84400124475212, 7.327008685531549, 12.556120605439766, 20.18545633820569, 22.545649946043525, 27.454000352276616, 2.814360778000405, 22.969032684007836, -2.872901574236007, -3.9819682728488495, 25.089932616449836, 9.076503182726363, 0.8979001958214603, 9.689499574912244, 22.203384343292043, 31.988714516930706, 26.1032703130233, 50.23570311632068, 20.551522055044238, 17.328110301014938, 46.89751837180365, 32.58059365119538, 27.925532170105974, 33.523106106721464, 6.316270458510951, 9.348277174436667, 28.799031427927716, 6.467582056647856, 24.997220920289763, 32.79942480908355, 10.433187105584551, -11.862821593773795, 37.596296733390446, 9.587497080060556, 24.09140352049478, 35.13152271569645, -3.9924327480334263, 27.708606019118424, -7.727920216834294, 15.980151617712574, 13.234449659394954, 4.4327802436468335, 36.92449445396605, 2.7323190191083135, -6.62538342909933, -6.728562592927997, 7.89106282115014, 32.59959041131072, 1.6981020703307201, 20.087422681884973, 18.5311145740208, 22.380695594889414, 4.402530060811416, 7.936378324540904, 25.563224838643695, 26.88863722372386, 27.702786793441312, 14.513422943926939, 4.184298515617325, 9.198635817237212, 23.391709451591023, 23.1960603153824, 7.566387798246577, -7.569181198554595, 38.62365650993867, 24.378908324804325, 9.901789502867995, 39.02986278455112, 34.88706204978429, 26.865967235097088, 17.12025493229566, 21.326734727920982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.618116164830276, "mean_inference_ms": 1.6551334983497599, "mean_action_processing_ms": 0.2546586791732935, "mean_env_wait_ms": 0.1432532832051489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003372669219970703, "StateBufferConnector_ms": 0.0023834705352783203, "ViewRequirementAgentConnector_ms": 0.060683250427246094}, "num_episodes": 18, "episode_return_max": 47.69791091218162, "episode_return_min": -6.6769730110136525, "episode_return_mean": 15.774683363591267, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.522253484466, "num_env_steps_trained_throughput_per_sec": 458.522253484466, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2052000, "timers": {"training_iteration_time_ms": 10178.831, "restore_workers_time_ms": 0.024, "training_step_time_ms": 10178.721, "sample_time_ms": 1280.056, "learn_time_ms": 8880.617, "learn_throughput": 450.419, "synch_weights_time_ms": 17.061}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "done": false, "training_iteration": 171, "trial_id": "06536_00000", "date": "2024-08-11_17-48-15", "timestamp": 1723412895, "time_this_iter_s": 8.730297803878784, "time_total_s": 4433.778080701828, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58fc1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4433.778080701828, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 25.73076923076923, "ram_util_percent": 82.44615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.861058627317349, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4860217195004224, "policy_loss": -0.007999248206518435, "vf_loss": 2.494020969669024, "vf_explained_var": 0.9289717502892018, "kl": 0.006157667654335706, "entropy": 0.3475178812320034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.991400339426818, "cur_kl_coeff": 3.4666738998970255e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.602745453516642, "policy_loss": -0.0032602781715689515, "vf_loss": 2.6060057368228042, "vf_explained_var": 0.9325180139491167, "kl": 0.004695588717242996, "entropy": 0.18164884123221908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 40.74481349462608, "episode_reward_min": -6.6769730110136525, "episode_reward_mean": 15.679041757828054, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.74481349462603, "predator_policy": -11.862821593773795}, "policy_reward_max": {"prey_policy": 6.676973011013656, "predator_policy": 50.23570311632068}, "policy_reward_mean": {"prey_policy": -15.679041757828053, "predator_policy": 15.679041757828053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.76960541889284, -0.517617436045402, 11.476930676389516, 19.989944615326152, 20.614289057973465, 15.936263554234145, 5.830607209787953, 23.59578273490949, 3.6296454743522277, 16.167628248791445, -0.9781524381325148, -1.871772504582517, 24.34372264857582, 2.2928259862102243, 0.34686394137945964, -3.0314085563839512, 1.3980246794281346, 28.822864160753817, 19.156945685158423, 27.132198176463802, 13.275415937930427, 15.977507537601172, 18.238850698481166, 17.38151261411463, 12.89747634815267, 18.757906374512903, 13.02276748776732, 17.11556143068417, 21.612720861391573, 9.099669607951999, 13.886041486515982, 25.33582231284706, 5.954612174512681, 33.334053282640426, 9.38976471338996, 11.567176899371702, 23.209870879116746, 1.2422812922196638, 10.248333953518717, 20.658356975150042, 13.292537976084695, 12.110727772186301, 27.491464099536735, 11.951258503516067, 27.58976538191909, -1.995601321828146, 15.585504965141862, 16.370788471822735, 24.99982514916008, 12.891696731004092, -3.4274349235424255, 17.083217899588142, 5.29369988536684, 27.0960494301114, 38.16948671467198, 18.939816178029595, 39.73905601149949, 30.72431913841376, 7.832273816473814, 17.633306742287807, 28.89832286468669, -0.7148172440946423, 23.591896906725516, 29.61146311809559, 11.858086635542513, 4.126115700439128, 8.833614951520909, 19.828406736537175, -6.6769730110136525, 20.24532661623041, 10.892762376107843, 20.45590508445507, 6.169454192676154, 26.225931031183784, 21.108104868684123, 6.691467166427284, 23.29388488348673, -0.0013967001540047264, 31.501282417371506, 24.465826143709556, 30.876514642440696, 19.22349483010834, 13.84076890911063, 31.801600993777257, 17.769189550766175, 33.737845483108885, 17.325771986463995, 24.551167072866807, 0.3706771434432463, 11.2786949242587, 16.120363665844483, 13.845152781310677, 1.806502343914362, 2.015764120353107, 40.74481349462608, 34.99013497014424, 18.34206254041307, 19.72920713926155, 16.162579336313648, 2.284552292864203], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.7696054188928345, 0.5176174360454069, -11.476930676389552, -19.98994461532615, -20.61428905797347, -15.936263554234166, -5.830607209787937, -23.595782734909477, -3.629645474352233, -16.167628248791495, 0.9781524381325202, 1.8717725045825189, -24.34372264857585, -2.292825986210234, -0.3468639413794605, 3.0314085563839637, -1.3980246794281266, -28.822864160753813, -19.156945685158405, -27.132198176463817, -13.275415937930415, -15.977507537601156, -18.238850698481176, -17.381512614114627, -12.897476348152676, -18.757906374512913, -13.02276748776735, -17.115561430684192, -21.61272086139156, -9.09966960795202, -13.88604148651598, -25.335822312847085, -5.95461217451264, -33.33405328264041, -9.38976471338998, -11.567176899371677, -23.209870879116778, -1.2422812922196513, -10.248333953518719, -20.658356975150078, -13.292537976084704, -12.110727772186312, -27.49146409953674, -11.951258503516083, -27.58976538191911, 1.9956013218281474, -15.585504965141839, -16.37078847182275, -24.999825149160063, -12.891696731004101, 3.4274349235424264, -17.08321789958808, -5.29369988536685, -27.096049430111403, -38.16948671467199, -18.93981617802958, -39.73905601149949, -30.724319138413733, -7.832273816473806, -17.633306742287793, -28.898322864686676, 0.7148172440946228, -23.59189690672551, -29.611463118095607, -11.85808663554249, -4.126115700439141, -8.83361495152088, -19.828406736537186, 6.676973011013656, -20.245326616230436, -10.892762376107843, -20.45590508445512, -6.169454192676163, -26.225931031183777, -21.10810486868413, -6.691467166427275, -23.293884883486704, 0.001396700154007391, -31.50128241737149, -24.46582614370952, -30.87651464244067, -19.22349483010833, -13.840768909110631, -31.801600993777292, -17.769189550766185, -33.73784548310887, -17.32577198646399, -24.551167072866818, -0.37067714344325164, -11.2786949242587, -16.12036366584448, -13.845152781310638, -1.8065023439143602, -2.015764120353089, -40.74481349462603, -34.99013497014424, -18.34206254041304, -19.72920713926154, -16.16257933631365, -2.2845522928642197], "policy_predator_policy_reward": [12.266472090762, -2.7272612529763336, -2.1282889436295918, 1.0930540715387789, 14.046278493555274, 8.907582859223815, 4.012744896027709, 35.967144334624585, 6.529496247171329, 34.699081868775586, 1.7175084267768934, 30.15501868169138, 12.859596688856474, -1.1983822692805504, 26.235200749806893, 20.95636472001209, 16.990650105226138, -9.73135915652168, 20.669286921028935, 11.665969576554025, 2.9733904990480706, -4.929695375313107, -5.338843954686899, 1.595298945521865, 28.003793503225346, 20.683651793926344, 13.212970484536216, -8.627318512115755, 9.697858630242905, -9.00413074748397, 3.194007350001483, -9.256824462769412, 2.036615572850752, 0.7594337860055038, 38.02185118271322, 19.62387713879442, 18.967044553425183, 19.34684681689167, 37.89969154273457, 16.36470481019307, 22.037069207098142, 4.5137626687626895, 28.195862182092966, 3.7591528931093823, 15.918899614220248, 20.55880178274209, 15.540993383042121, 19.222031845187146, 15.67687433733927, 10.118078358966079, 38.34134417769881, -0.8255314286729694, 7.185545257559102, 18.85998971797558, 22.669087135550175, 11.56203572581821, 9.104220319821296, 34.121221402961794, -1.6889339159479224, 19.888273131851964, 23.00124356176531, 4.770839411266653, 28.436206399438127, 22.235438226256, 3.733613953105497, 8.175610395919797, 20.80442871906736, 45.863677846213456, 7.536620052956554, 11.242909373823384, -2.7245844124428373, 25.858938211186185, 17.08870387839267, 29.331037879840924, -11.821801585570793, 14.306364170010045, 4.807170048430596, 15.689497858606867, 17.374452748582712, 23.942261201717443, 21.159334810039315, 5.425741142130107, -2.076382015861788, 26.29783756023442, 26.075780421501996, 28.90714777757149, 12.11368380708917, 11.788833199942994, 24.443139500810762, 30.736391263027482, -6.1831654696659, 2.1919628260095987, 23.84400124475212, 7.327008685531549, 12.556120605439766, 20.18545633820569, 22.545649946043525, 27.454000352276616, 2.814360778000405, 22.969032684007836, -2.872901574236007, -3.9819682728488495, 25.089932616449836, 9.076503182726363, 0.8979001958214603, 9.689499574912244, 22.203384343292043, 31.988714516930706, 26.1032703130233, 50.23570311632068, 20.551522055044238, 17.328110301014938, 46.89751837180365, 32.58059365119538, 27.925532170105974, 33.523106106721464, 6.316270458510951, 9.348277174436667, 28.799031427927716, 6.467582056647856, 24.997220920289763, 32.79942480908355, 10.433187105584551, -11.862821593773795, 37.596296733390446, 9.587497080060556, 24.09140352049478, 35.13152271569645, -3.9924327480334263, 27.708606019118424, -7.727920216834294, 15.980151617712574, 13.234449659394954, 4.4327802436468335, 36.92449445396605, 2.7323190191083135, -6.62538342909933, -6.728562592927997, 7.89106282115014, 32.59959041131072, 1.6981020703307201, 20.087422681884973, 18.5311145740208, 22.380695594889414, 4.402530060811416, 7.936378324540904, 25.563224838643695, 26.88863722372386, 27.702786793441312, 14.513422943926939, 4.184298515617325, 9.198635817237212, 23.391709451591023, 23.1960603153824, 7.566387798246577, -7.569181198554595, 38.62365650993867, 24.378908324804325, 9.901789502867995, 39.02986278455112, 34.88706204978429, 26.865967235097088, 17.12025493229566, 21.326734727920982, 9.205034799579387, 18.476503018641864, 25.59585227765182, 38.00734970990278, 13.277365694358151, 22.261013407174218, 34.950296192901966, 32.52539477331579, 26.460294332690115, 8.191249640237869, 35.36887263994698, 13.733461505786657, -1.1573540465445742, 1.8987083334310633, 7.852172110173308, 14.705217738344095, 15.794593709854515, 16.44613362183445, -2.6196897763843294, 30.309995339005635, 5.6355063651272115, -2.0225016772984983, -2.6937682490674364, 6.725296489773639, 42.66189322089918, 38.8277337683529, 33.81112694562938, 36.16914299465911, 29.04020625638659, 7.64391882443949, 20.59272512204678, 18.865689156476307, 19.293055735105696, 13.032102937521607, 2.4498463189955437, 2.1192582667328974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6168276153596569, "mean_inference_ms": 1.6513237701936254, "mean_action_processing_ms": 0.2541561332826008, "mean_env_wait_ms": 0.14289052245705108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003236055374145508, "StateBufferConnector_ms": 0.002362370491027832, "ViewRequirementAgentConnector_ms": 0.060488104820251465}, "num_episodes": 18, "episode_return_max": 40.74481349462608, "episode_return_min": -6.6769730110136525, "episode_return_mean": 15.679041757828054, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.4671270494333, "num_env_steps_trained_throughput_per_sec": 456.4671270494333, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 9390.583, "restore_workers_time_ms": 0.019, "training_step_time_ms": 9390.482, "sample_time_ms": 894.52, "learn_time_ms": 8478.312, "learn_throughput": 471.792, "synch_weights_time_ms": 16.878}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 172, "trial_id": "06536_00000", "date": "2024-08-11_17-48-23", "timestamp": 1723412903, "time_this_iter_s": 8.767220258712769, "time_total_s": 4442.545300960541, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58fcee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4442.545300960541, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 24.549999999999997, "ram_util_percent": 82.74166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9777477151403824, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0249276471634707, "policy_loss": -0.006036904843494994, "vf_loss": 2.0309645531078178, "vf_explained_var": 0.9493941528722644, "kl": 0.00752603783939834, "entropy": 0.34969057111690444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.093236292606939, "cur_kl_coeff": 1.7333369499485127e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4529000493584485, "policy_loss": -0.0015467862300476227, "vf_loss": 2.454446839150928, "vf_explained_var": 0.9479589143442729, "kl": 0.0023516605947446634, "entropy": 0.18555675620834033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "env_runners": {"episode_reward_max": 40.74481349462608, "episode_reward_min": -6.6769730110136525, "episode_reward_mean": 16.53691238518398, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.74481349462603, "predator_policy": -19.39741459893293}, "policy_reward_max": {"prey_policy": 6.676973011013656, "predator_policy": 50.23570311632068}, "policy_reward_mean": {"prey_policy": -16.53691238518398, "predator_policy": 16.53691238518398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.38151261411463, 12.89747634815267, 18.757906374512903, 13.02276748776732, 17.11556143068417, 21.612720861391573, 9.099669607951999, 13.886041486515982, 25.33582231284706, 5.954612174512681, 33.334053282640426, 9.38976471338996, 11.567176899371702, 23.209870879116746, 1.2422812922196638, 10.248333953518717, 20.658356975150042, 13.292537976084695, 12.110727772186301, 27.491464099536735, 11.951258503516067, 27.58976538191909, -1.995601321828146, 15.585504965141862, 16.370788471822735, 24.99982514916008, 12.891696731004092, -3.4274349235424255, 17.083217899588142, 5.29369988536684, 27.0960494301114, 38.16948671467198, 18.939816178029595, 39.73905601149949, 30.72431913841376, 7.832273816473814, 17.633306742287807, 28.89832286468669, -0.7148172440946423, 23.591896906725516, 29.61146311809559, 11.858086635542513, 4.126115700439128, 8.833614951520909, 19.828406736537175, -6.6769730110136525, 20.24532661623041, 10.892762376107843, 20.45590508445507, 6.169454192676154, 26.225931031183784, 21.108104868684123, 6.691467166427284, 23.29388488348673, -0.0013967001540047264, 31.501282417371506, 24.465826143709556, 30.876514642440696, 19.22349483010834, 13.84076890911063, 31.801600993777257, 17.769189550766175, 33.737845483108885, 17.325771986463995, 24.551167072866807, 0.3706771434432463, 11.2786949242587, 16.120363665844483, 13.845152781310677, 1.806502343914362, 2.015764120353107, 40.74481349462608, 34.99013497014424, 18.34206254041307, 19.72920713926155, 16.162579336313648, 2.284552292864203, 14.853290298681676, 19.344571687628054, 4.482826658713057, 6.210447533570308, 25.5692647212739, 19.958178624176156, -3.0140466739605944, 22.482576303442052, 22.350602350903593, 29.38785469111852, 18.394220881740097, 3.7466847282072715, 1.2838936174613478, 12.711780117452733, 40.22382718884746, 18.12120253437765, 35.876648765688756, -3.398972539323106, -2.954984145184455, 8.536266975194202, 27.541349522631975, 11.102164874074951, 19.574379526372695], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.381512614114627, -12.897476348152676, -18.757906374512913, -13.02276748776735, -17.115561430684192, -21.61272086139156, -9.09966960795202, -13.88604148651598, -25.335822312847085, -5.95461217451264, -33.33405328264041, -9.38976471338998, -11.567176899371677, -23.209870879116778, -1.2422812922196513, -10.248333953518719, -20.658356975150078, -13.292537976084704, -12.110727772186312, -27.49146409953674, -11.951258503516083, -27.58976538191911, 1.9956013218281474, -15.585504965141839, -16.37078847182275, -24.999825149160063, -12.891696731004101, 3.4274349235424264, -17.08321789958808, -5.29369988536685, -27.096049430111403, -38.16948671467199, -18.93981617802958, -39.73905601149949, -30.724319138413733, -7.832273816473806, -17.633306742287793, -28.898322864686676, 0.7148172440946228, -23.59189690672551, -29.611463118095607, -11.85808663554249, -4.126115700439141, -8.83361495152088, -19.828406736537186, 6.676973011013656, -20.245326616230436, -10.892762376107843, -20.45590508445512, -6.169454192676163, -26.225931031183777, -21.10810486868413, -6.691467166427275, -23.293884883486704, 0.001396700154007391, -31.50128241737149, -24.46582614370952, -30.87651464244067, -19.22349483010833, -13.840768909110631, -31.801600993777292, -17.769189550766185, -33.73784548310887, -17.32577198646399, -24.551167072866818, -0.37067714344325164, -11.2786949242587, -16.12036366584448, -13.845152781310638, -1.8065023439143602, -2.015764120353089, -40.74481349462603, -34.99013497014424, -18.34206254041304, -19.72920713926154, -16.16257933631365, -2.2845522928642197, -14.853290298681628, -19.344571687628086, -4.482826658713046, -6.210447533570296, -25.569264721273885, -19.9581786241761, 3.0140466739605998, -22.48257630344203, -22.35060235090355, -29.38785469111852, -18.39422088174014, -3.746684728207268, -1.2838936174613549, -12.711780117452742, -40.22382718884754, -18.12120253437762, -35.8766487656888, 3.398972539323106, 2.954984145184432, -8.53626697519419, -27.541349522631972, -11.102164874074955, -19.574379526372685], "policy_predator_policy_reward": [15.540993383042121, 19.222031845187146, 15.67687433733927, 10.118078358966079, 38.34134417769881, -0.8255314286729694, 7.185545257559102, 18.85998971797558, 22.669087135550175, 11.56203572581821, 9.104220319821296, 34.121221402961794, -1.6889339159479224, 19.888273131851964, 23.00124356176531, 4.770839411266653, 28.436206399438127, 22.235438226256, 3.733613953105497, 8.175610395919797, 20.80442871906736, 45.863677846213456, 7.536620052956554, 11.242909373823384, -2.7245844124428373, 25.858938211186185, 17.08870387839267, 29.331037879840924, -11.821801585570793, 14.306364170010045, 4.807170048430596, 15.689497858606867, 17.374452748582712, 23.942261201717443, 21.159334810039315, 5.425741142130107, -2.076382015861788, 26.29783756023442, 26.075780421501996, 28.90714777757149, 12.11368380708917, 11.788833199942994, 24.443139500810762, 30.736391263027482, -6.1831654696659, 2.1919628260095987, 23.84400124475212, 7.327008685531549, 12.556120605439766, 20.18545633820569, 22.545649946043525, 27.454000352276616, 2.814360778000405, 22.969032684007836, -2.872901574236007, -3.9819682728488495, 25.089932616449836, 9.076503182726363, 0.8979001958214603, 9.689499574912244, 22.203384343292043, 31.988714516930706, 26.1032703130233, 50.23570311632068, 20.551522055044238, 17.328110301014938, 46.89751837180365, 32.58059365119538, 27.925532170105974, 33.523106106721464, 6.316270458510951, 9.348277174436667, 28.799031427927716, 6.467582056647856, 24.997220920289763, 32.79942480908355, 10.433187105584551, -11.862821593773795, 37.596296733390446, 9.587497080060556, 24.09140352049478, 35.13152271569645, -3.9924327480334263, 27.708606019118424, -7.727920216834294, 15.980151617712574, 13.234449659394954, 4.4327802436468335, 36.92449445396605, 2.7323190191083135, -6.62538342909933, -6.728562592927997, 7.89106282115014, 32.59959041131072, 1.6981020703307201, 20.087422681884973, 18.5311145740208, 22.380695594889414, 4.402530060811416, 7.936378324540904, 25.563224838643695, 26.88863722372386, 27.702786793441312, 14.513422943926939, 4.184298515617325, 9.198635817237212, 23.391709451591023, 23.1960603153824, 7.566387798246577, -7.569181198554595, 38.62365650993867, 24.378908324804325, 9.901789502867995, 39.02986278455112, 34.88706204978429, 26.865967235097088, 17.12025493229566, 21.326734727920982, 9.205034799579387, 18.476503018641864, 25.59585227765182, 38.00734970990278, 13.277365694358151, 22.261013407174218, 34.950296192901966, 32.52539477331579, 26.460294332690115, 8.191249640237869, 35.36887263994698, 13.733461505786657, -1.1573540465445742, 1.8987083334310633, 7.852172110173308, 14.705217738344095, 15.794593709854515, 16.44613362183445, -2.6196897763843294, 30.309995339005635, 5.6355063651272115, -2.0225016772984983, -2.6937682490674364, 6.725296489773639, 42.66189322089918, 38.8277337683529, 33.81112694562938, 36.16914299465911, 29.04020625638659, 7.64391882443949, 20.59272512204678, 18.865689156476307, 19.293055735105696, 13.032102937521607, 2.4498463189955437, 2.1192582667328974, 29.067448018353765, 0.6391325790095541, 30.73389894384399, 7.955244431412121, 5.854567443362015, 3.1110858740640763, 6.84866350675898, 5.572231560381612, 20.80800159362981, 30.330527848918, 28.636729317926797, 11.279627930425448, -8.229622331639504, 2.201528983718303, 0.7536503216261035, 44.211502285257986, 22.692419870280396, 22.008784831526732, 21.263675802313607, 37.51203357992342, 13.027138539855406, 23.76130322362482, 7.865997403414687, -0.372627947000141, -1.2070261340512962, 3.774813368974007, 19.254498203508675, 6.169062031396787, 40.46194096768105, 39.98571341001394, 23.75466162722253, 12.487743441532784, 39.41873816990791, 32.33455936146965, 12.599469520286704, -19.39741459893293, -9.371340836432655, 3.461372546063771, 19.921106187016143, -2.84857223662776, 29.2212808936863, 25.861418151577666, -8.463544225118428, 30.66787397326837, 4.998325452972766, 34.150433599772576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6153049038311817, "mean_inference_ms": 1.646752800615276, "mean_action_processing_ms": 0.2534294957744837, "mean_env_wait_ms": 0.14239840009171367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028162002563476562, "StateBufferConnector_ms": 0.00235903263092041, "ViewRequirementAgentConnector_ms": 0.06039106845855713}, "num_episodes": 23, "episode_return_max": 40.74481349462608, "episode_return_min": -6.6769730110136525, "episode_return_mean": 16.53691238518398, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.3395253378321, "num_env_steps_trained_throughput_per_sec": 452.3395253378321, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2076000, "timers": {"training_iteration_time_ms": 9266.249, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9266.149, "sample_time_ms": 886.49, "learn_time_ms": 8362.057, "learn_throughput": 478.351, "synch_weights_time_ms": 16.892}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "done": false, "training_iteration": 173, "trial_id": "06536_00000", "date": "2024-08-11_17-48-32", "timestamp": 1723412912, "time_this_iter_s": 8.848582029342651, "time_total_s": 4451.393882989883, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b589aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4451.393882989883, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 22.584615384615386, "ram_util_percent": 82.56923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8951624613255262, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8574271547297636, "policy_loss": -0.008213835541876808, "vf_loss": 1.8656409924228987, "vf_explained_var": 0.9714747403437892, "kl": 0.006721932859926128, "entropy": 0.30825259182602166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.227309128153261, "cur_kl_coeff": 8.666684749742564e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.40540930303947, "policy_loss": -0.001509165579315137, "vf_loss": 2.4069184640727976, "vf_explained_var": 0.9656832186633317, "kl": 0.003499550310234844, "entropy": 0.20427746707327152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "env_runners": {"episode_reward_max": 40.74481349462608, "episode_reward_min": -6.6769730110136525, "episode_reward_mean": 17.17886906109329, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.74481349462603, "predator_policy": -19.39741459893293}, "policy_reward_max": {"prey_policy": 6.676973011013656, "predator_policy": 50.23570311632068}, "policy_reward_mean": {"prey_policy": -17.17886906109329, "predator_policy": 17.178869061093287}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.995601321828146, 15.585504965141862, 16.370788471822735, 24.99982514916008, 12.891696731004092, -3.4274349235424255, 17.083217899588142, 5.29369988536684, 27.0960494301114, 38.16948671467198, 18.939816178029595, 39.73905601149949, 30.72431913841376, 7.832273816473814, 17.633306742287807, 28.89832286468669, -0.7148172440946423, 23.591896906725516, 29.61146311809559, 11.858086635542513, 4.126115700439128, 8.833614951520909, 19.828406736537175, -6.6769730110136525, 20.24532661623041, 10.892762376107843, 20.45590508445507, 6.169454192676154, 26.225931031183784, 21.108104868684123, 6.691467166427284, 23.29388488348673, -0.0013967001540047264, 31.501282417371506, 24.465826143709556, 30.876514642440696, 19.22349483010834, 13.84076890911063, 31.801600993777257, 17.769189550766175, 33.737845483108885, 17.325771986463995, 24.551167072866807, 0.3706771434432463, 11.2786949242587, 16.120363665844483, 13.845152781310677, 1.806502343914362, 2.015764120353107, 40.74481349462608, 34.99013497014424, 18.34206254041307, 19.72920713926155, 16.162579336313648, 2.284552292864203, 14.853290298681676, 19.344571687628054, 4.482826658713057, 6.210447533570308, 25.5692647212739, 19.958178624176156, -3.0140466739605944, 22.482576303442052, 22.350602350903593, 29.38785469111852, 18.394220881740097, 3.7466847282072715, 1.2838936174613478, 12.711780117452733, 40.22382718884746, 18.12120253437765, 35.876648765688756, -3.398972539323106, -2.954984145184455, 8.536266975194202, 27.541349522631975, 11.102164874074951, 19.574379526372695, -5.313246547629468, 22.480106694081364, 24.21073871289246, 5.515224052121585, 4.708860150275361, 27.423549196406498, 2.5423904252975476, 29.902720972284754, 24.172978075411905, 28.286145380088243, 21.75768166805712, 16.057842297151538, 33.47564332254942, 1.4871411516011692, 28.973597004995852, 34.98047491314093, 5.1255023425413935, 23.76176810301526, 10.82003358302277, 23.57572994194502, 33.0159365168262, 24.38453206195476], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.9956013218281474, -15.585504965141839, -16.37078847182275, -24.999825149160063, -12.891696731004101, 3.4274349235424264, -17.08321789958808, -5.29369988536685, -27.096049430111403, -38.16948671467199, -18.93981617802958, -39.73905601149949, -30.724319138413733, -7.832273816473806, -17.633306742287793, -28.898322864686676, 0.7148172440946228, -23.59189690672551, -29.611463118095607, -11.85808663554249, -4.126115700439141, -8.83361495152088, -19.828406736537186, 6.676973011013656, -20.245326616230436, -10.892762376107843, -20.45590508445512, -6.169454192676163, -26.225931031183777, -21.10810486868413, -6.691467166427275, -23.293884883486704, 0.001396700154007391, -31.50128241737149, -24.46582614370952, -30.87651464244067, -19.22349483010833, -13.840768909110631, -31.801600993777292, -17.769189550766185, -33.73784548310887, -17.32577198646399, -24.551167072866818, -0.37067714344325164, -11.2786949242587, -16.12036366584448, -13.845152781310638, -1.8065023439143602, -2.015764120353089, -40.74481349462603, -34.99013497014424, -18.34206254041304, -19.72920713926154, -16.16257933631365, -2.2845522928642197, -14.853290298681628, -19.344571687628086, -4.482826658713046, -6.210447533570296, -25.569264721273885, -19.9581786241761, 3.0140466739605998, -22.48257630344203, -22.35060235090355, -29.38785469111852, -18.39422088174014, -3.746684728207268, -1.2838936174613549, -12.711780117452742, -40.22382718884754, -18.12120253437762, -35.8766487656888, 3.398972539323106, 2.954984145184432, -8.53626697519419, -27.541349522631972, -11.102164874074955, -19.574379526372685, 5.313246547629468, -22.480106694081364, -24.210738712892496, -5.515224052121576, -4.708860150275372, -27.42354919640647, -2.542390425297592, -29.902720972284754, -24.172978075411915, -28.286145380088257, -21.757681668057113, -16.05784229715155, -33.475643322549516, -1.4871411516011817, -28.97359700499584, -34.98047491314088, -5.125502342541402, -23.761768103015307, -10.820033583022784, -23.575729941945042, -33.01593651682621, -24.384532061954722], "policy_predator_policy_reward": [-6.1831654696659, 2.1919628260095987, 23.84400124475212, 7.327008685531549, 12.556120605439766, 20.18545633820569, 22.545649946043525, 27.454000352276616, 2.814360778000405, 22.969032684007836, -2.872901574236007, -3.9819682728488495, 25.089932616449836, 9.076503182726363, 0.8979001958214603, 9.689499574912244, 22.203384343292043, 31.988714516930706, 26.1032703130233, 50.23570311632068, 20.551522055044238, 17.328110301014938, 46.89751837180365, 32.58059365119538, 27.925532170105974, 33.523106106721464, 6.316270458510951, 9.348277174436667, 28.799031427927716, 6.467582056647856, 24.997220920289763, 32.79942480908355, 10.433187105584551, -11.862821593773795, 37.596296733390446, 9.587497080060556, 24.09140352049478, 35.13152271569645, -3.9924327480334263, 27.708606019118424, -7.727920216834294, 15.980151617712574, 13.234449659394954, 4.4327802436468335, 36.92449445396605, 2.7323190191083135, -6.62538342909933, -6.728562592927997, 7.89106282115014, 32.59959041131072, 1.6981020703307201, 20.087422681884973, 18.5311145740208, 22.380695594889414, 4.402530060811416, 7.936378324540904, 25.563224838643695, 26.88863722372386, 27.702786793441312, 14.513422943926939, 4.184298515617325, 9.198635817237212, 23.391709451591023, 23.1960603153824, 7.566387798246577, -7.569181198554595, 38.62365650993867, 24.378908324804325, 9.901789502867995, 39.02986278455112, 34.88706204978429, 26.865967235097088, 17.12025493229566, 21.326734727920982, 9.205034799579387, 18.476503018641864, 25.59585227765182, 38.00734970990278, 13.277365694358151, 22.261013407174218, 34.950296192901966, 32.52539477331579, 26.460294332690115, 8.191249640237869, 35.36887263994698, 13.733461505786657, -1.1573540465445742, 1.8987083334310633, 7.852172110173308, 14.705217738344095, 15.794593709854515, 16.44613362183445, -2.6196897763843294, 30.309995339005635, 5.6355063651272115, -2.0225016772984983, -2.6937682490674364, 6.725296489773639, 42.66189322089918, 38.8277337683529, 33.81112694562938, 36.16914299465911, 29.04020625638659, 7.64391882443949, 20.59272512204678, 18.865689156476307, 19.293055735105696, 13.032102937521607, 2.4498463189955437, 2.1192582667328974, 29.067448018353765, 0.6391325790095541, 30.73389894384399, 7.955244431412121, 5.854567443362015, 3.1110858740640763, 6.84866350675898, 5.572231560381612, 20.80800159362981, 30.330527848918, 28.636729317926797, 11.279627930425448, -8.229622331639504, 2.201528983718303, 0.7536503216261035, 44.211502285257986, 22.692419870280396, 22.008784831526732, 21.263675802313607, 37.51203357992342, 13.027138539855406, 23.76130322362482, 7.865997403414687, -0.372627947000141, -1.2070261340512962, 3.774813368974007, 19.254498203508675, 6.169062031396787, 40.46194096768105, 39.98571341001394, 23.75466162722253, 12.487743441532784, 39.41873816990791, 32.33455936146965, 12.599469520286704, -19.39741459893293, -9.371340836432655, 3.461372546063771, 19.921106187016143, -2.84857223662776, 29.2212808936863, 25.861418151577666, -8.463544225118428, 30.66787397326837, 4.998325452972766, 34.150433599772576, -6.680728288761294, -3.9457648064976425, 38.850853684106674, 6.109359704056023, 25.95945672119101, 22.462020704593947, 3.4174705773109224, 7.612977526932234, 4.621218223264857, 4.796502077285871, 24.629580874985788, 30.21751751782719, 16.54929979575997, -11.464518945164812, 31.525593359111845, 28.27984858545767, 17.92868845479717, 30.417267696026663, 19.29253329060885, 37.27975746956764, 9.676644745620349, 33.83871859049387, 1.2894544109254502, 30.826230183377625, 36.48977015906143, 30.46151648603749, 2.48827521472211, 0.48600708848024965, 27.719284115449895, 30.22790989454178, 31.08602379134915, 38.87492603493267, 11.521932621613121, -1.2709279365303132, 35.46909750639818, 12.05443869963242, 10.858417374881174, 10.78164979116438, 20.633555621036948, 26.51790426285311, 38.60774076008155, 27.42413227357089, 12.423602796481777, 36.34546132742771]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6137808100485309, "mean_inference_ms": 1.6421253363937343, "mean_action_processing_ms": 0.25292721685668185, "mean_env_wait_ms": 0.14201085215778886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028498172760009766, "StateBufferConnector_ms": 0.002369999885559082, "ViewRequirementAgentConnector_ms": 0.06157732009887695}, "num_episodes": 22, "episode_return_max": 40.74481349462608, "episode_return_min": -6.6769730110136525, "episode_return_mean": 17.17886906109329, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.0558507007068, "num_env_steps_trained_throughput_per_sec": 466.0558507007068, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2088000, "timers": {"training_iteration_time_ms": 9003.485, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9003.433, "sample_time_ms": 841.737, "learn_time_ms": 8146.332, "learn_throughput": 491.019, "synch_weights_time_ms": 14.722}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "done": false, "training_iteration": 174, "trial_id": "06536_00000", "date": "2024-08-11_17-48-41", "timestamp": 1723412921, "time_this_iter_s": 8.587738037109375, "time_total_s": 4459.981621026993, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58e5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4459.981621026993, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 23.291666666666668, "ram_util_percent": 82.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8102578443785506, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5832073700924714, "policy_loss": -0.004481335959280841, "vf_loss": 1.587688702965776, "vf_explained_var": 0.9627580313632885, "kl": 0.004546733380792452, "entropy": 0.32679764631514746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8791155473895804, "cur_kl_coeff": 4.333342374871282e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9322867963049146, "policy_loss": -0.0009520568971142725, "vf_loss": 1.9332388488703935, "vf_explained_var": 0.9593004360400811, "kl": 0.0026857025359065204, "entropy": 0.21945046538477223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "env_runners": {"episode_reward_max": 40.74481349462608, "episode_reward_min": -6.6769730110136525, "episode_reward_mean": 17.469345148498313, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.74481349462603, "predator_policy": -19.39741459893293}, "policy_reward_max": {"prey_policy": 6.676973011013656, "predator_policy": 44.211502285257986}, "policy_reward_mean": {"prey_policy": -17.469345148498316, "predator_policy": 17.46934514849832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.61146311809559, 11.858086635542513, 4.126115700439128, 8.833614951520909, 19.828406736537175, -6.6769730110136525, 20.24532661623041, 10.892762376107843, 20.45590508445507, 6.169454192676154, 26.225931031183784, 21.108104868684123, 6.691467166427284, 23.29388488348673, -0.0013967001540047264, 31.501282417371506, 24.465826143709556, 30.876514642440696, 19.22349483010834, 13.84076890911063, 31.801600993777257, 17.769189550766175, 33.737845483108885, 17.325771986463995, 24.551167072866807, 0.3706771434432463, 11.2786949242587, 16.120363665844483, 13.845152781310677, 1.806502343914362, 2.015764120353107, 40.74481349462608, 34.99013497014424, 18.34206254041307, 19.72920713926155, 16.162579336313648, 2.284552292864203, 14.853290298681676, 19.344571687628054, 4.482826658713057, 6.210447533570308, 25.5692647212739, 19.958178624176156, -3.0140466739605944, 22.482576303442052, 22.350602350903593, 29.38785469111852, 18.394220881740097, 3.7466847282072715, 1.2838936174613478, 12.711780117452733, 40.22382718884746, 18.12120253437765, 35.876648765688756, -3.398972539323106, -2.954984145184455, 8.536266975194202, 27.541349522631975, 11.102164874074951, 19.574379526372695, -5.313246547629468, 22.480106694081364, 24.21073871289246, 5.515224052121585, 4.708860150275361, 27.423549196406498, 2.5423904252975476, 29.902720972284754, 24.172978075411905, 28.286145380088243, 21.75768166805712, 16.057842297151538, 33.47564332254942, 1.4871411516011692, 28.973597004995852, 34.98047491314093, 5.1255023425413935, 23.76176810301526, 10.82003358302277, 23.57572994194502, 33.0159365168262, 24.38453206195476, 36.28133011684772, 33.166458018048765, 5.369699059114519, 21.16819583297871, 12.590050880962016, 10.326834738560613, 16.45233836996691, 16.469558770641378, 21.128923798441544, 22.108793989969012, 19.772737414778724, 16.68311617367891, 13.646253055293293, 14.557613336587748, 38.137623905643956, 14.435377629912702, 32.791678548192614, 2.6724325164023846], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.611463118095607, -11.85808663554249, -4.126115700439141, -8.83361495152088, -19.828406736537186, 6.676973011013656, -20.245326616230436, -10.892762376107843, -20.45590508445512, -6.169454192676163, -26.225931031183777, -21.10810486868413, -6.691467166427275, -23.293884883486704, 0.001396700154007391, -31.50128241737149, -24.46582614370952, -30.87651464244067, -19.22349483010833, -13.840768909110631, -31.801600993777292, -17.769189550766185, -33.73784548310887, -17.32577198646399, -24.551167072866818, -0.37067714344325164, -11.2786949242587, -16.12036366584448, -13.845152781310638, -1.8065023439143602, -2.015764120353089, -40.74481349462603, -34.99013497014424, -18.34206254041304, -19.72920713926154, -16.16257933631365, -2.2845522928642197, -14.853290298681628, -19.344571687628086, -4.482826658713046, -6.210447533570296, -25.569264721273885, -19.9581786241761, 3.0140466739605998, -22.48257630344203, -22.35060235090355, -29.38785469111852, -18.39422088174014, -3.746684728207268, -1.2838936174613549, -12.711780117452742, -40.22382718884754, -18.12120253437762, -35.8766487656888, 3.398972539323106, 2.954984145184432, -8.53626697519419, -27.541349522631972, -11.102164874074955, -19.574379526372685, 5.313246547629468, -22.480106694081364, -24.210738712892496, -5.515224052121576, -4.708860150275372, -27.42354919640647, -2.542390425297592, -29.902720972284754, -24.172978075411915, -28.286145380088257, -21.757681668057113, -16.05784229715155, -33.475643322549516, -1.4871411516011817, -28.97359700499584, -34.98047491314088, -5.125502342541402, -23.761768103015307, -10.820033583022784, -23.575729941945042, -33.01593651682621, -24.384532061954722, -36.28133011684777, -33.16645801804879, -5.369699059114519, -21.168195832978736, -12.590050880962025, -10.32683473856061, -16.452338369966967, -16.469558770641378, -21.128923798441566, -22.108793989969016, -19.772737414778707, -16.683116173678872, -13.646253055293306, -14.557613336587735, -38.13762390564402, -14.435377629912686, -32.79167854819261, -2.672432516402404], "policy_predator_policy_reward": [24.09140352049478, 35.13152271569645, -3.9924327480334263, 27.708606019118424, -7.727920216834294, 15.980151617712574, 13.234449659394954, 4.4327802436468335, 36.92449445396605, 2.7323190191083135, -6.62538342909933, -6.728562592927997, 7.89106282115014, 32.59959041131072, 1.6981020703307201, 20.087422681884973, 18.5311145740208, 22.380695594889414, 4.402530060811416, 7.936378324540904, 25.563224838643695, 26.88863722372386, 27.702786793441312, 14.513422943926939, 4.184298515617325, 9.198635817237212, 23.391709451591023, 23.1960603153824, 7.566387798246577, -7.569181198554595, 38.62365650993867, 24.378908324804325, 9.901789502867995, 39.02986278455112, 34.88706204978429, 26.865967235097088, 17.12025493229566, 21.326734727920982, 9.205034799579387, 18.476503018641864, 25.59585227765182, 38.00734970990278, 13.277365694358151, 22.261013407174218, 34.950296192901966, 32.52539477331579, 26.460294332690115, 8.191249640237869, 35.36887263994698, 13.733461505786657, -1.1573540465445742, 1.8987083334310633, 7.852172110173308, 14.705217738344095, 15.794593709854515, 16.44613362183445, -2.6196897763843294, 30.309995339005635, 5.6355063651272115, -2.0225016772984983, -2.6937682490674364, 6.725296489773639, 42.66189322089918, 38.8277337683529, 33.81112694562938, 36.16914299465911, 29.04020625638659, 7.64391882443949, 20.59272512204678, 18.865689156476307, 19.293055735105696, 13.032102937521607, 2.4498463189955437, 2.1192582667328974, 29.067448018353765, 0.6391325790095541, 30.73389894384399, 7.955244431412121, 5.854567443362015, 3.1110858740640763, 6.84866350675898, 5.572231560381612, 20.80800159362981, 30.330527848918, 28.636729317926797, 11.279627930425448, -8.229622331639504, 2.201528983718303, 0.7536503216261035, 44.211502285257986, 22.692419870280396, 22.008784831526732, 21.263675802313607, 37.51203357992342, 13.027138539855406, 23.76130322362482, 7.865997403414687, -0.372627947000141, -1.2070261340512962, 3.774813368974007, 19.254498203508675, 6.169062031396787, 40.46194096768105, 39.98571341001394, 23.75466162722253, 12.487743441532784, 39.41873816990791, 32.33455936146965, 12.599469520286704, -19.39741459893293, -9.371340836432655, 3.461372546063771, 19.921106187016143, -2.84857223662776, 29.2212808936863, 25.861418151577666, -8.463544225118428, 30.66787397326837, 4.998325452972766, 34.150433599772576, -6.680728288761294, -3.9457648064976425, 38.850853684106674, 6.109359704056023, 25.95945672119101, 22.462020704593947, 3.4174705773109224, 7.612977526932234, 4.621218223264857, 4.796502077285871, 24.629580874985788, 30.21751751782719, 16.54929979575997, -11.464518945164812, 31.525593359111845, 28.27984858545767, 17.92868845479717, 30.417267696026663, 19.29253329060885, 37.27975746956764, 9.676644745620349, 33.83871859049387, 1.2894544109254502, 30.826230183377625, 36.48977015906143, 30.46151648603749, 2.48827521472211, 0.48600708848024965, 27.719284115449895, 30.22790989454178, 31.08602379134915, 38.87492603493267, 11.521932621613121, -1.2709279365303132, 35.46909750639818, 12.05443869963242, 10.858417374881174, 10.78164979116438, 20.633555621036948, 26.51790426285311, 38.60774076008155, 27.42413227357089, 12.423602796481777, 36.34546132742771, 35.975666100102245, 36.58699413359326, 29.106418392832055, 37.22649764326553, 4.430943489052343, 6.308454629176685, 10.965216103009702, 31.37117556294775, 19.53522901872278, 5.644872743201292, 21.03131438567122, -0.3776449085500033, 20.44276739228225, 12.461909347651677, 24.345462314281157, 8.593655227001609, 37.8889414827854, 4.3689061140977135, 13.163361782352277, 31.05422619758575, 24.473425412162953, 15.072049417394497, 13.474823107600907, 19.891409239756854, 21.736153741153263, 5.5563523694333705, 10.31645445709375, 18.798772216081737, 37.08647942190593, 39.18876838938205, 16.981636336557173, 11.889118923268203, 33.371642591911716, 32.2117145044735, 5.3474776131084365, -0.002612580303626544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.612534507423503, "mean_inference_ms": 1.6383786908072233, "mean_action_processing_ms": 0.2524305780930606, "mean_env_wait_ms": 0.14164914795181022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028841495513916016, "StateBufferConnector_ms": 0.0023702383041381836, "ViewRequirementAgentConnector_ms": 0.06257522106170654}, "num_episodes": 18, "episode_return_max": 40.74481349462608, "episode_return_min": -6.6769730110136525, "episode_return_mean": 17.469345148498313, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.24752954254495, "num_env_steps_trained_throughput_per_sec": 471.24752954254495, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2100000, "timers": {"training_iteration_time_ms": 8830.859, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8830.815, "sample_time_ms": 807.735, "learn_time_ms": 8007.543, "learn_throughput": 499.529, "synch_weights_time_ms": 14.934}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "done": false, "training_iteration": 175, "trial_id": "06536_00000", "date": "2024-08-11_17-48-49", "timestamp": 1723412929, "time_this_iter_s": 8.493762016296387, "time_total_s": 4468.475383043289, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3317f7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4468.475383043289, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 22.625, "ram_util_percent": 82.34166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9554475800444684, "cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8279375529537598, "policy_loss": -0.0065517726696270985, "vf_loss": 1.834489324192206, "vf_explained_var": 0.9526538878679276, "kl": 0.007257189088861421, "entropy": 0.3347476282622665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8452741349815693, "cur_kl_coeff": 2.166671187435641e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3983673356828237, "policy_loss": -0.0015771935494350536, "vf_loss": 2.399944533809783, "vf_explained_var": 0.9411790517902879, "kl": 0.003380186442906726, "entropy": 0.2005294022027147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 40.74481349462608, "episode_reward_min": -5.313246547629468, "episode_reward_mean": 17.990756847964736, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -40.74481349462603, "predator_policy": -19.39741459893293}, "policy_reward_max": {"prey_policy": 5.313246547629468, "predator_policy": 44.211502285257986}, "policy_reward_mean": {"prey_policy": -17.990756847964743, "predator_policy": 17.99075684796474}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.22349483010834, 13.84076890911063, 31.801600993777257, 17.769189550766175, 33.737845483108885, 17.325771986463995, 24.551167072866807, 0.3706771434432463, 11.2786949242587, 16.120363665844483, 13.845152781310677, 1.806502343914362, 2.015764120353107, 40.74481349462608, 34.99013497014424, 18.34206254041307, 19.72920713926155, 16.162579336313648, 2.284552292864203, 14.853290298681676, 19.344571687628054, 4.482826658713057, 6.210447533570308, 25.5692647212739, 19.958178624176156, -3.0140466739605944, 22.482576303442052, 22.350602350903593, 29.38785469111852, 18.394220881740097, 3.7466847282072715, 1.2838936174613478, 12.711780117452733, 40.22382718884746, 18.12120253437765, 35.876648765688756, -3.398972539323106, -2.954984145184455, 8.536266975194202, 27.541349522631975, 11.102164874074951, 19.574379526372695, -5.313246547629468, 22.480106694081364, 24.21073871289246, 5.515224052121585, 4.708860150275361, 27.423549196406498, 2.5423904252975476, 29.902720972284754, 24.172978075411905, 28.286145380088243, 21.75768166805712, 16.057842297151538, 33.47564332254942, 1.4871411516011692, 28.973597004995852, 34.98047491314093, 5.1255023425413935, 23.76176810301526, 10.82003358302277, 23.57572994194502, 33.0159365168262, 24.38453206195476, 36.28133011684772, 33.166458018048765, 5.369699059114519, 21.16819583297871, 12.590050880962016, 10.326834738560613, 16.45233836996691, 16.469558770641378, 21.128923798441544, 22.108793989969012, 19.772737414778724, 16.68311617367891, 13.646253055293293, 14.557613336587748, 38.137623905643956, 14.435377629912702, 32.791678548192614, 2.6724325164023846, 12.95339163807617, 24.93378311646982, 4.70731083057579, 37.845051283058865, 26.164093824064487, 12.072020614100564, 19.805309248149666, 17.713020596084636, 25.673301412957336, 13.794573812836125, 20.56843547245003, 27.421624060828634, 6.759996044690361, 19.495226229567237, 12.762390861128393, 12.378713950835543, 32.1294899907163, 14.469213813793056], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.22349483010833, -13.840768909110631, -31.801600993777292, -17.769189550766185, -33.73784548310887, -17.32577198646399, -24.551167072866818, -0.37067714344325164, -11.2786949242587, -16.12036366584448, -13.845152781310638, -1.8065023439143602, -2.015764120353089, -40.74481349462603, -34.99013497014424, -18.34206254041304, -19.72920713926154, -16.16257933631365, -2.2845522928642197, -14.853290298681628, -19.344571687628086, -4.482826658713046, -6.210447533570296, -25.569264721273885, -19.9581786241761, 3.0140466739605998, -22.48257630344203, -22.35060235090355, -29.38785469111852, -18.39422088174014, -3.746684728207268, -1.2838936174613549, -12.711780117452742, -40.22382718884754, -18.12120253437762, -35.8766487656888, 3.398972539323106, 2.954984145184432, -8.53626697519419, -27.541349522631972, -11.102164874074955, -19.574379526372685, 5.313246547629468, -22.480106694081364, -24.210738712892496, -5.515224052121576, -4.708860150275372, -27.42354919640647, -2.542390425297592, -29.902720972284754, -24.172978075411915, -28.286145380088257, -21.757681668057113, -16.05784229715155, -33.475643322549516, -1.4871411516011817, -28.97359700499584, -34.98047491314088, -5.125502342541402, -23.761768103015307, -10.820033583022784, -23.575729941945042, -33.01593651682621, -24.384532061954722, -36.28133011684777, -33.16645801804879, -5.369699059114519, -21.168195832978736, -12.590050880962025, -10.32683473856061, -16.452338369966967, -16.469558770641378, -21.128923798441566, -22.108793989969016, -19.772737414778707, -16.683116173678872, -13.646253055293306, -14.557613336587735, -38.13762390564402, -14.435377629912686, -32.79167854819261, -2.672432516402404, -12.953391638076162, -24.933783116469783, -4.707310830575793, -37.84505128305884, -26.164093824064523, -12.072020614100522, -19.805309248149662, -17.713020596084636, -25.673301412957365, -13.794573812836116, -20.56843547245003, -27.421624060828595, -6.759996044690366, -19.495226229567272, -12.762390861128374, -12.37871395083554, -32.12948999071634, -14.469213813793047], "policy_predator_policy_reward": [17.12025493229566, 21.326734727920982, 9.205034799579387, 18.476503018641864, 25.59585227765182, 38.00734970990278, 13.277365694358151, 22.261013407174218, 34.950296192901966, 32.52539477331579, 26.460294332690115, 8.191249640237869, 35.36887263994698, 13.733461505786657, -1.1573540465445742, 1.8987083334310633, 7.852172110173308, 14.705217738344095, 15.794593709854515, 16.44613362183445, -2.6196897763843294, 30.309995339005635, 5.6355063651272115, -2.0225016772984983, -2.6937682490674364, 6.725296489773639, 42.66189322089918, 38.8277337683529, 33.81112694562938, 36.16914299465911, 29.04020625638659, 7.64391882443949, 20.59272512204678, 18.865689156476307, 19.293055735105696, 13.032102937521607, 2.4498463189955437, 2.1192582667328974, 29.067448018353765, 0.6391325790095541, 30.73389894384399, 7.955244431412121, 5.854567443362015, 3.1110858740640763, 6.84866350675898, 5.572231560381612, 20.80800159362981, 30.330527848918, 28.636729317926797, 11.279627930425448, -8.229622331639504, 2.201528983718303, 0.7536503216261035, 44.211502285257986, 22.692419870280396, 22.008784831526732, 21.263675802313607, 37.51203357992342, 13.027138539855406, 23.76130322362482, 7.865997403414687, -0.372627947000141, -1.2070261340512962, 3.774813368974007, 19.254498203508675, 6.169062031396787, 40.46194096768105, 39.98571341001394, 23.75466162722253, 12.487743441532784, 39.41873816990791, 32.33455936146965, 12.599469520286704, -19.39741459893293, -9.371340836432655, 3.461372546063771, 19.921106187016143, -2.84857223662776, 29.2212808936863, 25.861418151577666, -8.463544225118428, 30.66787397326837, 4.998325452972766, 34.150433599772576, -6.680728288761294, -3.9457648064976425, 38.850853684106674, 6.109359704056023, 25.95945672119101, 22.462020704593947, 3.4174705773109224, 7.612977526932234, 4.621218223264857, 4.796502077285871, 24.629580874985788, 30.21751751782719, 16.54929979575997, -11.464518945164812, 31.525593359111845, 28.27984858545767, 17.92868845479717, 30.417267696026663, 19.29253329060885, 37.27975746956764, 9.676644745620349, 33.83871859049387, 1.2894544109254502, 30.826230183377625, 36.48977015906143, 30.46151648603749, 2.48827521472211, 0.48600708848024965, 27.719284115449895, 30.22790989454178, 31.08602379134915, 38.87492603493267, 11.521932621613121, -1.2709279365303132, 35.46909750639818, 12.05443869963242, 10.858417374881174, 10.78164979116438, 20.633555621036948, 26.51790426285311, 38.60774076008155, 27.42413227357089, 12.423602796481777, 36.34546132742771, 35.975666100102245, 36.58699413359326, 29.106418392832055, 37.22649764326553, 4.430943489052343, 6.308454629176685, 10.965216103009702, 31.37117556294775, 19.53522901872278, 5.644872743201292, 21.03131438567122, -0.3776449085500033, 20.44276739228225, 12.461909347651677, 24.345462314281157, 8.593655227001609, 37.8889414827854, 4.3689061140977135, 13.163361782352277, 31.05422619758575, 24.473425412162953, 15.072049417394497, 13.474823107600907, 19.891409239756854, 21.736153741153263, 5.5563523694333705, 10.31645445709375, 18.798772216081737, 37.08647942190593, 39.18876838938205, 16.981636336557173, 11.889118923268203, 33.371642591911716, 32.2117145044735, 5.3474776131084365, -0.002612580303626544, 21.5830695140174, 4.323713762134897, 29.692046338363582, 20.175519894576006, 17.442923517148614, -8.02830185599703, 36.41646276281051, 39.27363980330719, 28.35888934042556, 23.969298307703443, 1.6494327551672612, 22.49460847303381, 5.678316095126814, 33.93230240117251, 2.860181758975184, 32.56585943319407, 18.97438695352376, 32.37221587239096, 13.808790343484464, 13.780357282187792, 32.80483708531432, 8.332033859585767, 14.941959240451297, 39.901288881205936, -3.1726551386176647, 16.692647227998368, 12.647299368605687, 26.343153090528908, 19.522301856587767, 6.002479865669004, 6.160626267709539, 18.596801633961544, 30.802470554371393, 33.45650942706133, 10.092466882192298, 18.845960745393803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6113071587417461, "mean_inference_ms": 1.6346650628026027, "mean_action_processing_ms": 0.25193856219330873, "mean_env_wait_ms": 0.14128994087655086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028094053268432617, "StateBufferConnector_ms": 0.0022946596145629883, "ViewRequirementAgentConnector_ms": 0.061461567878723145}, "num_episodes": 18, "episode_return_max": 40.74481349462608, "episode_return_min": -5.313246547629468, "episode_return_mean": 17.990756847964736, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.3721238194528, "num_env_steps_trained_throughput_per_sec": 467.3721238194528, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 8779.476, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8779.433, "sample_time_ms": 799.035, "learn_time_ms": 7964.867, "learn_throughput": 502.206, "synch_weights_time_ms": 14.928}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 176, "trial_id": "06536_00000", "date": "2024-08-11_17-48-58", "timestamp": 1723412938, "time_this_iter_s": 8.563369035720825, "time_total_s": 4477.03875207901, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58fcee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4477.03875207901, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 23.458333333333332, "ram_util_percent": 82.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.944599769388636, "cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9838730869193872, "policy_loss": -0.014118637973054623, "vf_loss": 1.9979917202144861, "vf_explained_var": 0.9468232304478685, "kl": 0.0071225879177922264, "entropy": 0.35945172791058816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6675300956403136, "cur_kl_coeff": 1.0833355937178205e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.534966546770126, "policy_loss": -0.0016516067363597728, "vf_loss": 2.536618155587918, "vf_explained_var": 0.9392093428859004, "kl": 0.0023211916083046556, "entropy": 0.17134510837692432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "env_runners": {"episode_reward_max": 46.742132154747594, "episode_reward_min": -5.563466532334592, "episode_reward_mean": 17.769084223591182, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.7421321547476, "predator_policy": -19.39741459893293}, "policy_reward_max": {"prey_policy": 5.563466532334598, "predator_policy": 55.471656522292186}, "policy_reward_mean": {"prey_policy": -17.769084223591186, "predator_policy": 17.769084223591186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.284552292864203, 14.853290298681676, 19.344571687628054, 4.482826658713057, 6.210447533570308, 25.5692647212739, 19.958178624176156, -3.0140466739605944, 22.482576303442052, 22.350602350903593, 29.38785469111852, 18.394220881740097, 3.7466847282072715, 1.2838936174613478, 12.711780117452733, 40.22382718884746, 18.12120253437765, 35.876648765688756, -3.398972539323106, -2.954984145184455, 8.536266975194202, 27.541349522631975, 11.102164874074951, 19.574379526372695, -5.313246547629468, 22.480106694081364, 24.21073871289246, 5.515224052121585, 4.708860150275361, 27.423549196406498, 2.5423904252975476, 29.902720972284754, 24.172978075411905, 28.286145380088243, 21.75768166805712, 16.057842297151538, 33.47564332254942, 1.4871411516011692, 28.973597004995852, 34.98047491314093, 5.1255023425413935, 23.76176810301526, 10.82003358302277, 23.57572994194502, 33.0159365168262, 24.38453206195476, 36.28133011684772, 33.166458018048765, 5.369699059114519, 21.16819583297871, 12.590050880962016, 10.326834738560613, 16.45233836996691, 16.469558770641378, 21.128923798441544, 22.108793989969012, 19.772737414778724, 16.68311617367891, 13.646253055293293, 14.557613336587748, 38.137623905643956, 14.435377629912702, 32.791678548192614, 2.6724325164023846, 12.95339163807617, 24.93378311646982, 4.70731083057579, 37.845051283058865, 26.164093824064487, 12.072020614100564, 19.805309248149666, 17.713020596084636, 25.673301412957336, 13.794573812836125, 20.56843547245003, 27.421624060828634, 6.759996044690361, 19.495226229567237, 12.762390861128393, 12.378713950835543, 32.1294899907163, 14.469213813793056, 12.81745546552797, 21.864851026727184, 18.695674413752286, 9.065051402473657, 35.12866004300569, 20.060798763612556, 17.102528595410792, 28.066611273253493, 14.14216084708808, 46.742132154747594, 23.956626214687642, 3.05093520719882, 16.06481101024887, 18.51489032118529, 3.4960440181647794, -5.563466532334592, 24.584018949132204, 3.6987456748471947], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.2845522928642197, -14.853290298681628, -19.344571687628086, -4.482826658713046, -6.210447533570296, -25.569264721273885, -19.9581786241761, 3.0140466739605998, -22.48257630344203, -22.35060235090355, -29.38785469111852, -18.39422088174014, -3.746684728207268, -1.2838936174613549, -12.711780117452742, -40.22382718884754, -18.12120253437762, -35.8766487656888, 3.398972539323106, 2.954984145184432, -8.53626697519419, -27.541349522631972, -11.102164874074955, -19.574379526372685, 5.313246547629468, -22.480106694081364, -24.210738712892496, -5.515224052121576, -4.708860150275372, -27.42354919640647, -2.542390425297592, -29.902720972284754, -24.172978075411915, -28.286145380088257, -21.757681668057113, -16.05784229715155, -33.475643322549516, -1.4871411516011817, -28.97359700499584, -34.98047491314088, -5.125502342541402, -23.761768103015307, -10.820033583022784, -23.575729941945042, -33.01593651682621, -24.384532061954722, -36.28133011684777, -33.16645801804879, -5.369699059114519, -21.168195832978736, -12.590050880962025, -10.32683473856061, -16.452338369966967, -16.469558770641378, -21.128923798441566, -22.108793989969016, -19.772737414778707, -16.683116173678872, -13.646253055293306, -14.557613336587735, -38.13762390564402, -14.435377629912686, -32.79167854819261, -2.672432516402404, -12.953391638076162, -24.933783116469783, -4.707310830575793, -37.84505128305884, -26.164093824064523, -12.072020614100522, -19.805309248149662, -17.713020596084636, -25.673301412957365, -13.794573812836116, -20.56843547245003, -27.421624060828595, -6.759996044690366, -19.495226229567272, -12.762390861128374, -12.37871395083554, -32.12948999071634, -14.469213813793047, -12.817455465527944, -21.864851026727184, -18.69567441375228, -9.065051402473653, -35.12866004300564, -20.060798763612574, -17.102528595410785, -28.066611273253482, -14.142160847088073, -46.7421321547476, -23.956626214687656, -3.05093520719882, -16.064811010248867, -18.514890321185288, -3.4960440181647945, 5.563466532334598, -24.584018949132194, -3.698745674847194], "policy_predator_policy_reward": [2.4498463189955437, 2.1192582667328974, 29.067448018353765, 0.6391325790095541, 30.73389894384399, 7.955244431412121, 5.854567443362015, 3.1110858740640763, 6.84866350675898, 5.572231560381612, 20.80800159362981, 30.330527848918, 28.636729317926797, 11.279627930425448, -8.229622331639504, 2.201528983718303, 0.7536503216261035, 44.211502285257986, 22.692419870280396, 22.008784831526732, 21.263675802313607, 37.51203357992342, 13.027138539855406, 23.76130322362482, 7.865997403414687, -0.372627947000141, -1.2070261340512962, 3.774813368974007, 19.254498203508675, 6.169062031396787, 40.46194096768105, 39.98571341001394, 23.75466162722253, 12.487743441532784, 39.41873816990791, 32.33455936146965, 12.599469520286704, -19.39741459893293, -9.371340836432655, 3.461372546063771, 19.921106187016143, -2.84857223662776, 29.2212808936863, 25.861418151577666, -8.463544225118428, 30.66787397326837, 4.998325452972766, 34.150433599772576, -6.680728288761294, -3.9457648064976425, 38.850853684106674, 6.109359704056023, 25.95945672119101, 22.462020704593947, 3.4174705773109224, 7.612977526932234, 4.621218223264857, 4.796502077285871, 24.629580874985788, 30.21751751782719, 16.54929979575997, -11.464518945164812, 31.525593359111845, 28.27984858545767, 17.92868845479717, 30.417267696026663, 19.29253329060885, 37.27975746956764, 9.676644745620349, 33.83871859049387, 1.2894544109254502, 30.826230183377625, 36.48977015906143, 30.46151648603749, 2.48827521472211, 0.48600708848024965, 27.719284115449895, 30.22790989454178, 31.08602379134915, 38.87492603493267, 11.521932621613121, -1.2709279365303132, 35.46909750639818, 12.05443869963242, 10.858417374881174, 10.78164979116438, 20.633555621036948, 26.51790426285311, 38.60774076008155, 27.42413227357089, 12.423602796481777, 36.34546132742771, 35.975666100102245, 36.58699413359326, 29.106418392832055, 37.22649764326553, 4.430943489052343, 6.308454629176685, 10.965216103009702, 31.37117556294775, 19.53522901872278, 5.644872743201292, 21.03131438567122, -0.3776449085500033, 20.44276739228225, 12.461909347651677, 24.345462314281157, 8.593655227001609, 37.8889414827854, 4.3689061140977135, 13.163361782352277, 31.05422619758575, 24.473425412162953, 15.072049417394497, 13.474823107600907, 19.891409239756854, 21.736153741153263, 5.5563523694333705, 10.31645445709375, 18.798772216081737, 37.08647942190593, 39.18876838938205, 16.981636336557173, 11.889118923268203, 33.371642591911716, 32.2117145044735, 5.3474776131084365, -0.002612580303626544, 21.5830695140174, 4.323713762134897, 29.692046338363582, 20.175519894576006, 17.442923517148614, -8.02830185599703, 36.41646276281051, 39.27363980330719, 28.35888934042556, 23.969298307703443, 1.6494327551672612, 22.49460847303381, 5.678316095126814, 33.93230240117251, 2.860181758975184, 32.56585943319407, 18.97438695352376, 32.37221587239096, 13.808790343484464, 13.780357282187792, 32.80483708531432, 8.332033859585767, 14.941959240451297, 39.901288881205936, -3.1726551386176647, 16.692647227998368, 12.647299368605687, 26.343153090528908, 19.522301856587767, 6.002479865669004, 6.160626267709539, 18.596801633961544, 30.802470554371393, 33.45650942706133, 10.092466882192298, 18.845960745393803, 14.253264284407573, 11.381646646648324, 32.077898631843304, 11.651803421611067, 35.293941804299074, 2.0974070232055064, 17.78171604188614, 0.34838676306116145, 38.78750714732872, 31.469812938682544, 12.938450845418023, 27.18314668180712, 21.009522072342747, 13.195535118478823, 29.25101178238167, 26.882210764125308, 6.6996892877434835, 21.584632406432654, 55.471656522292186, 38.01260778720302, 37.71355194393295, 10.199700485442357, 12.764367545465863, -6.662497131068211, 8.453984771288578, 23.675637249209117, 29.25462849724372, 7.775152145126842, 11.899697890569758, -4.9076098542401745, -11.628450489973726, 0.501517425304538, 39.020799008071535, 10.147238890192874, 5.660284547668622, 1.7372068020257707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6100593258739453, "mean_inference_ms": 1.6309308931624384, "mean_action_processing_ms": 0.2514484890285413, "mean_env_wait_ms": 0.1409271446173372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002815723419189453, "StateBufferConnector_ms": 0.0022995471954345703, "ViewRequirementAgentConnector_ms": 0.06179308891296387}, "num_episodes": 18, "episode_return_max": 46.742132154747594, "episode_return_min": -5.563466532334592, "episode_return_mean": 17.769084223591182, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.78371799079576, "num_env_steps_trained_throughput_per_sec": 447.78371799079576, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2124000, "timers": {"training_iteration_time_ms": 8785.281, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8785.239, "sample_time_ms": 792.168, "learn_time_ms": 7979.351, "learn_throughput": 501.294, "synch_weights_time_ms": 13.196}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "done": false, "training_iteration": 177, "trial_id": "06536_00000", "date": "2024-08-11_17-49-07", "timestamp": 1723412947, "time_this_iter_s": 8.940375804901123, "time_total_s": 4485.979127883911, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b589aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4485.979127883911, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 25.784615384615385, "ram_util_percent": 82.11538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.361884007727107, "cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4669403882697223, "policy_loss": -0.008119032564475976, "vf_loss": 2.475059417138497, "vf_explained_var": 0.9511918276548386, "kl": 0.004960575114065789, "entropy": 0.3718394751039644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.065977974165054, "cur_kl_coeff": 5.416677968589102e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0022402924835365, "policy_loss": -0.0023559617110227465, "vf_loss": 3.0045962476225756, "vf_explained_var": 0.9426322998508575, "kl": 0.002469021569686926, "entropy": 0.1788323898124632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "env_runners": {"episode_reward_max": 50.62201798035526, "episode_reward_min": -5.563466532334592, "episode_reward_mean": 19.905746514409483, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.622017980355245, "predator_policy": -11.628450489973726}, "policy_reward_max": {"prey_policy": 5.563466532334598, "predator_policy": 55.471656522292186}, "policy_reward_mean": {"prey_policy": -19.905746514409483, "predator_policy": 19.905746514409486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.515224052121585, 4.708860150275361, 27.423549196406498, 2.5423904252975476, 29.902720972284754, 24.172978075411905, 28.286145380088243, 21.75768166805712, 16.057842297151538, 33.47564332254942, 1.4871411516011692, 28.973597004995852, 34.98047491314093, 5.1255023425413935, 23.76176810301526, 10.82003358302277, 23.57572994194502, 33.0159365168262, 24.38453206195476, 36.28133011684772, 33.166458018048765, 5.369699059114519, 21.16819583297871, 12.590050880962016, 10.326834738560613, 16.45233836996691, 16.469558770641378, 21.128923798441544, 22.108793989969012, 19.772737414778724, 16.68311617367891, 13.646253055293293, 14.557613336587748, 38.137623905643956, 14.435377629912702, 32.791678548192614, 2.6724325164023846, 12.95339163807617, 24.93378311646982, 4.70731083057579, 37.845051283058865, 26.164093824064487, 12.072020614100564, 19.805309248149666, 17.713020596084636, 25.673301412957336, 13.794573812836125, 20.56843547245003, 27.421624060828634, 6.759996044690361, 19.495226229567237, 12.762390861128393, 12.378713950835543, 32.1294899907163, 14.469213813793056, 12.81745546552797, 21.864851026727184, 18.695674413752286, 9.065051402473657, 35.12866004300569, 20.060798763612556, 17.102528595410792, 28.066611273253493, 14.14216084708808, 46.742132154747594, 23.956626214687642, 3.05093520719882, 16.06481101024887, 18.51489032118529, 3.4960440181647794, -5.563466532334592, 24.584018949132204, 3.6987456748471947, 5.579484367110439, 30.82062087045793, 27.97141860790387, 7.967542354773149, 16.788597475728686, 27.24589000006315, 26.72109380172752, 36.2785006645, 17.989159428465836, 20.050258191039966, 17.699641400909996, 29.634826798600237, 24.478410128452534, 16.251823199558622, 18.14987158870926, 15.118651479501134, 12.078159622575676, 42.25673550675619, 15.787379883784178, 31.323493278457896, 5.708557343370131, 50.62201798035526, 25.923513919320133, 13.89728936550213, 32.94345299528792, 13.027490007197283, 27.398528217017947], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.515224052121576, -4.708860150275372, -27.42354919640647, -2.542390425297592, -29.902720972284754, -24.172978075411915, -28.286145380088257, -21.757681668057113, -16.05784229715155, -33.475643322549516, -1.4871411516011817, -28.97359700499584, -34.98047491314088, -5.125502342541402, -23.761768103015307, -10.820033583022784, -23.575729941945042, -33.01593651682621, -24.384532061954722, -36.28133011684777, -33.16645801804879, -5.369699059114519, -21.168195832978736, -12.590050880962025, -10.32683473856061, -16.452338369966967, -16.469558770641378, -21.128923798441566, -22.108793989969016, -19.772737414778707, -16.683116173678872, -13.646253055293306, -14.557613336587735, -38.13762390564402, -14.435377629912686, -32.79167854819261, -2.672432516402404, -12.953391638076162, -24.933783116469783, -4.707310830575793, -37.84505128305884, -26.164093824064523, -12.072020614100522, -19.805309248149662, -17.713020596084636, -25.673301412957365, -13.794573812836116, -20.56843547245003, -27.421624060828595, -6.759996044690366, -19.495226229567272, -12.762390861128374, -12.37871395083554, -32.12948999071634, -14.469213813793047, -12.817455465527944, -21.864851026727184, -18.69567441375228, -9.065051402473653, -35.12866004300564, -20.060798763612574, -17.102528595410785, -28.066611273253482, -14.142160847088073, -46.7421321547476, -23.956626214687656, -3.05093520719882, -16.064811010248867, -18.514890321185288, -3.4960440181647945, 5.563466532334598, -24.584018949132194, -3.698745674847194, -5.579484367110437, -30.820620870457937, -27.97141860790382, -7.967542354773142, -16.788597475728704, -27.245890000063167, -26.721093801727516, -36.27850066450011, -17.98915942846584, -20.05025819103998, -17.699641400909982, -29.634826798600237, -24.478410128452552, -16.25182319955859, -18.149871588709257, -15.118651479501175, -12.078159622575642, -42.256735506756165, -15.787379883784169, -31.323493278457885, -5.708557343370144, -50.622017980355245, -25.923513919320143, -13.897289365502118, -32.94345299528795, -13.027490007197285, -27.398528217017937], "policy_predator_policy_reward": [3.4174705773109224, 7.612977526932234, 4.621218223264857, 4.796502077285871, 24.629580874985788, 30.21751751782719, 16.54929979575997, -11.464518945164812, 31.525593359111845, 28.27984858545767, 17.92868845479717, 30.417267696026663, 19.29253329060885, 37.27975746956764, 9.676644745620349, 33.83871859049387, 1.2894544109254502, 30.826230183377625, 36.48977015906143, 30.46151648603749, 2.48827521472211, 0.48600708848024965, 27.719284115449895, 30.22790989454178, 31.08602379134915, 38.87492603493267, 11.521932621613121, -1.2709279365303132, 35.46909750639818, 12.05443869963242, 10.858417374881174, 10.78164979116438, 20.633555621036948, 26.51790426285311, 38.60774076008155, 27.42413227357089, 12.423602796481777, 36.34546132742771, 35.975666100102245, 36.58699413359326, 29.106418392832055, 37.22649764326553, 4.430943489052343, 6.308454629176685, 10.965216103009702, 31.37117556294775, 19.53522901872278, 5.644872743201292, 21.03131438567122, -0.3776449085500033, 20.44276739228225, 12.461909347651677, 24.345462314281157, 8.593655227001609, 37.8889414827854, 4.3689061140977135, 13.163361782352277, 31.05422619758575, 24.473425412162953, 15.072049417394497, 13.474823107600907, 19.891409239756854, 21.736153741153263, 5.5563523694333705, 10.31645445709375, 18.798772216081737, 37.08647942190593, 39.18876838938205, 16.981636336557173, 11.889118923268203, 33.371642591911716, 32.2117145044735, 5.3474776131084365, -0.002612580303626544, 21.5830695140174, 4.323713762134897, 29.692046338363582, 20.175519894576006, 17.442923517148614, -8.02830185599703, 36.41646276281051, 39.27363980330719, 28.35888934042556, 23.969298307703443, 1.6494327551672612, 22.49460847303381, 5.678316095126814, 33.93230240117251, 2.860181758975184, 32.56585943319407, 18.97438695352376, 32.37221587239096, 13.808790343484464, 13.780357282187792, 32.80483708531432, 8.332033859585767, 14.941959240451297, 39.901288881205936, -3.1726551386176647, 16.692647227998368, 12.647299368605687, 26.343153090528908, 19.522301856587767, 6.002479865669004, 6.160626267709539, 18.596801633961544, 30.802470554371393, 33.45650942706133, 10.092466882192298, 18.845960745393803, 14.253264284407573, 11.381646646648324, 32.077898631843304, 11.651803421611067, 35.293941804299074, 2.0974070232055064, 17.78171604188614, 0.34838676306116145, 38.78750714732872, 31.469812938682544, 12.938450845418023, 27.18314668180712, 21.009522072342747, 13.195535118478823, 29.25101178238167, 26.882210764125308, 6.6996892877434835, 21.584632406432654, 55.471656522292186, 38.01260778720302, 37.71355194393295, 10.199700485442357, 12.764367545465863, -6.662497131068211, 8.453984771288578, 23.675637249209117, 29.25462849724372, 7.775152145126842, 11.899697890569758, -4.9076098542401745, -11.628450489973726, 0.501517425304538, 39.020799008071535, 10.147238890192874, 5.660284547668622, 1.7372068020257707, -8.735702370863072, 19.894671105083965, 19.923416797328738, 41.71782494358713, 39.137222106580495, 16.805615109227134, 5.161714123595697, 10.773370585950591, 6.639288658644757, 26.93790629281264, 16.846807036494315, 37.64497296363201, 12.695764221296997, 40.746423382158014, 35.699036306317296, 36.8579650226828, 15.757815286133368, 20.220503570798293, 12.923581906428776, 27.176934475651166, 19.331294469159666, 16.067988332660292, 27.50479971576919, 31.76485388143128, 36.00857138590966, 12.948248870995423, 6.223052944329519, 26.280593454787684, 26.57345316885886, 9.726290008559666, 7.570784202711449, 22.666518756290845, 4.7897118855323555, 19.366607359618975, 45.27698883657449, 39.23648217693792, 1.7363900298942916, 29.838369737674043, 18.548574842682882, 44.09841171423292, 13.302256660082058, -1.885141973341776, 49.176173543985314, 52.0678624167252, 19.573597251716862, 32.27343058692341, 15.588196712885816, 12.20638201811841, 44.155746635229534, 21.731159355346314, -6.1449795482926, 32.19995956268715, 28.148123128350374, 26.64893330568551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6077723896856078, "mean_inference_ms": 1.6228055472767293, "mean_action_processing_ms": 0.2503679735953875, "mean_env_wait_ms": 0.14020106175648617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027979612350463867, "StateBufferConnector_ms": 0.0022679567337036133, "ViewRequirementAgentConnector_ms": 0.061479926109313965}, "num_episodes": 27, "episode_return_max": 50.62201798035526, "episode_return_min": -5.563466532334592, "episode_return_mean": 19.905746514409483, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.4232969036527, "num_env_steps_trained_throughput_per_sec": 374.4232969036527, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2136000, "timers": {"training_iteration_time_ms": 8955.265, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8955.216, "sample_time_ms": 792.734, "learn_time_ms": 8147.368, "learn_throughput": 490.956, "synch_weights_time_ms": 14.332}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "done": false, "training_iteration": 178, "trial_id": "06536_00000", "date": "2024-08-11_17-49-18", "timestamp": 1723412958, "time_this_iter_s": 10.70706820487976, "time_total_s": 4496.686196088791, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63a8ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4496.686196088791, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 39.07333333333334, "ram_util_percent": 82.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.98153874874115, "cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8741237954547008, "policy_loss": -0.00887954191857716, "vf_loss": 1.8830033354461193, "vf_explained_var": 0.9541571168228984, "kl": 0.00842996909554613, "entropy": 0.3767761970870197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8806708697919494, "cur_kl_coeff": 2.708338984294551e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3766057756212025, "policy_loss": -0.0007220210933752318, "vf_loss": 2.377327796958742, "vf_explained_var": 0.9469209015684784, "kl": 0.002617746345948465, "entropy": 0.21726198986409204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "env_runners": {"episode_reward_max": 50.62201798035526, "episode_reward_min": -5.563466532334592, "episode_reward_mean": 19.22758869723453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.622017980355245, "predator_policy": -12.380529678274268}, "policy_reward_max": {"prey_policy": 5.563466532334598, "predator_policy": 55.471656522292186}, "policy_reward_mean": {"prey_policy": -19.227588697234534, "predator_policy": 19.227588697234534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.38453206195476, 36.28133011684772, 33.166458018048765, 5.369699059114519, 21.16819583297871, 12.590050880962016, 10.326834738560613, 16.45233836996691, 16.469558770641378, 21.128923798441544, 22.108793989969012, 19.772737414778724, 16.68311617367891, 13.646253055293293, 14.557613336587748, 38.137623905643956, 14.435377629912702, 32.791678548192614, 2.6724325164023846, 12.95339163807617, 24.93378311646982, 4.70731083057579, 37.845051283058865, 26.164093824064487, 12.072020614100564, 19.805309248149666, 17.713020596084636, 25.673301412957336, 13.794573812836125, 20.56843547245003, 27.421624060828634, 6.759996044690361, 19.495226229567237, 12.762390861128393, 12.378713950835543, 32.1294899907163, 14.469213813793056, 12.81745546552797, 21.864851026727184, 18.695674413752286, 9.065051402473657, 35.12866004300569, 20.060798763612556, 17.102528595410792, 28.066611273253493, 14.14216084708808, 46.742132154747594, 23.956626214687642, 3.05093520719882, 16.06481101024887, 18.51489032118529, 3.4960440181647794, -5.563466532334592, 24.584018949132204, 3.6987456748471947, 5.579484367110439, 30.82062087045793, 27.97141860790387, 7.967542354773149, 16.788597475728686, 27.24589000006315, 26.72109380172752, 36.2785006645, 17.989159428465836, 20.050258191039966, 17.699641400909996, 29.634826798600237, 24.478410128452534, 16.251823199558622, 18.14987158870926, 15.118651479501134, 12.078159622575676, 42.25673550675619, 15.787379883784178, 31.323493278457896, 5.708557343370131, 50.62201798035526, 25.923513919320133, 13.89728936550213, 32.94345299528792, 13.027490007197283, 27.398528217017947, 17.515452286021443, 23.871442390382818, 16.286687597371216, 23.04628967258302, 9.242702856667906, 1.3788385586904903, 5.367585807926844, 33.770204838568205, 7.944808480333416, 20.307270770920436, 21.55029739287568, -2.3559251857551207, 40.56627489594184, 1.550088679767959, 7.28250099220701, 9.546326201473832, 35.01974622633587, 15.876844916924473], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.384532061954722, -36.28133011684777, -33.16645801804879, -5.369699059114519, -21.168195832978736, -12.590050880962025, -10.32683473856061, -16.452338369966967, -16.469558770641378, -21.128923798441566, -22.108793989969016, -19.772737414778707, -16.683116173678872, -13.646253055293306, -14.557613336587735, -38.13762390564402, -14.435377629912686, -32.79167854819261, -2.672432516402404, -12.953391638076162, -24.933783116469783, -4.707310830575793, -37.84505128305884, -26.164093824064523, -12.072020614100522, -19.805309248149662, -17.713020596084636, -25.673301412957365, -13.794573812836116, -20.56843547245003, -27.421624060828595, -6.759996044690366, -19.495226229567272, -12.762390861128374, -12.37871395083554, -32.12948999071634, -14.469213813793047, -12.817455465527944, -21.864851026727184, -18.69567441375228, -9.065051402473653, -35.12866004300564, -20.060798763612574, -17.102528595410785, -28.066611273253482, -14.142160847088073, -46.7421321547476, -23.956626214687656, -3.05093520719882, -16.064811010248867, -18.514890321185288, -3.4960440181647945, 5.563466532334598, -24.584018949132194, -3.698745674847194, -5.579484367110437, -30.820620870457937, -27.97141860790382, -7.967542354773142, -16.788597475728704, -27.245890000063167, -26.721093801727516, -36.27850066450011, -17.98915942846584, -20.05025819103998, -17.699641400909982, -29.634826798600237, -24.478410128452552, -16.25182319955859, -18.149871588709257, -15.118651479501175, -12.078159622575642, -42.256735506756165, -15.787379883784169, -31.323493278457885, -5.708557343370144, -50.622017980355245, -25.923513919320143, -13.897289365502118, -32.94345299528795, -13.027490007197285, -27.398528217017937, -17.515452286021404, -23.871442390382814, -16.28668759737119, -23.046289672583065, -9.242702856667904, -1.3788385586904814, -5.367585807926844, -33.770204838568134, -7.944808480333425, -20.30727077092045, -21.550297392875684, 2.3559251857551224, -40.56627489594194, -1.550088679767951, -7.282500992207017, -9.546326201473839, -35.019746226335855, -15.876844916924462], "policy_predator_policy_reward": [12.423602796481777, 36.34546132742771, 35.975666100102245, 36.58699413359326, 29.106418392832055, 37.22649764326553, 4.430943489052343, 6.308454629176685, 10.965216103009702, 31.37117556294775, 19.53522901872278, 5.644872743201292, 21.03131438567122, -0.3776449085500033, 20.44276739228225, 12.461909347651677, 24.345462314281157, 8.593655227001609, 37.8889414827854, 4.3689061140977135, 13.163361782352277, 31.05422619758575, 24.473425412162953, 15.072049417394497, 13.474823107600907, 19.891409239756854, 21.736153741153263, 5.5563523694333705, 10.31645445709375, 18.798772216081737, 37.08647942190593, 39.18876838938205, 16.981636336557173, 11.889118923268203, 33.371642591911716, 32.2117145044735, 5.3474776131084365, -0.002612580303626544, 21.5830695140174, 4.323713762134897, 29.692046338363582, 20.175519894576006, 17.442923517148614, -8.02830185599703, 36.41646276281051, 39.27363980330719, 28.35888934042556, 23.969298307703443, 1.6494327551672612, 22.49460847303381, 5.678316095126814, 33.93230240117251, 2.860181758975184, 32.56585943319407, 18.97438695352376, 32.37221587239096, 13.808790343484464, 13.780357282187792, 32.80483708531432, 8.332033859585767, 14.941959240451297, 39.901288881205936, -3.1726551386176647, 16.692647227998368, 12.647299368605687, 26.343153090528908, 19.522301856587767, 6.002479865669004, 6.160626267709539, 18.596801633961544, 30.802470554371393, 33.45650942706133, 10.092466882192298, 18.845960745393803, 14.253264284407573, 11.381646646648324, 32.077898631843304, 11.651803421611067, 35.293941804299074, 2.0974070232055064, 17.78171604188614, 0.34838676306116145, 38.78750714732872, 31.469812938682544, 12.938450845418023, 27.18314668180712, 21.009522072342747, 13.195535118478823, 29.25101178238167, 26.882210764125308, 6.6996892877434835, 21.584632406432654, 55.471656522292186, 38.01260778720302, 37.71355194393295, 10.199700485442357, 12.764367545465863, -6.662497131068211, 8.453984771288578, 23.675637249209117, 29.25462849724372, 7.775152145126842, 11.899697890569758, -4.9076098542401745, -11.628450489973726, 0.501517425304538, 39.020799008071535, 10.147238890192874, 5.660284547668622, 1.7372068020257707, -8.735702370863072, 19.894671105083965, 19.923416797328738, 41.71782494358713, 39.137222106580495, 16.805615109227134, 5.161714123595697, 10.773370585950591, 6.639288658644757, 26.93790629281264, 16.846807036494315, 37.64497296363201, 12.695764221296997, 40.746423382158014, 35.699036306317296, 36.8579650226828, 15.757815286133368, 20.220503570798293, 12.923581906428776, 27.176934475651166, 19.331294469159666, 16.067988332660292, 27.50479971576919, 31.76485388143128, 36.00857138590966, 12.948248870995423, 6.223052944329519, 26.280593454787684, 26.57345316885886, 9.726290008559666, 7.570784202711449, 22.666518756290845, 4.7897118855323555, 19.366607359618975, 45.27698883657449, 39.23648217693792, 1.7363900298942916, 29.838369737674043, 18.548574842682882, 44.09841171423292, 13.302256660082058, -1.885141973341776, 49.176173543985314, 52.0678624167252, 19.573597251716862, 32.27343058692341, 15.588196712885816, 12.20638201811841, 44.155746635229534, 21.731159355346314, -6.1449795482926, 32.19995956268715, 28.148123128350374, 26.64893330568551, 26.044288416718643, 8.986616155324192, 5.59863735524134, 42.144247425524306, 12.889468620731144, 19.68390657401124, 19.607917527721835, 26.48466181744426, 11.063862251499422, 7.421543461836388, -12.380529678274268, 15.13820679565524, -6.606608615267836, 17.341780231121522, 34.595436581104366, 32.944973096031944, -6.658902711564933, 22.548519672231787, 12.33873125390778, 28.27581028793307, 6.187086560959667, 36.913508224791705, -0.5269405100053692, -4.184909861504872, 32.16854384526762, 48.96400594661614, -6.657682889932346, 9.757860249468218, 16.20470026336085, -1.6396982789468293, -1.0221567544623147, 20.11480915740999, 27.05826250569128, 42.981229946980434, 8.92281377731201, 22.83087605653693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6071604538870834, "mean_inference_ms": 1.6222661915566983, "mean_action_processing_ms": 0.2503360365736388, "mean_env_wait_ms": 0.14009355057964176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002833127975463867, "StateBufferConnector_ms": 0.002310633659362793, "ViewRequirementAgentConnector_ms": 0.06256246566772461}, "num_episodes": 18, "episode_return_max": 50.62201798035526, "episode_return_min": -5.563466532334592, "episode_return_mean": 19.22758869723453, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.9095802608798, "num_env_steps_trained_throughput_per_sec": 435.9095802608798, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2148000, "timers": {"training_iteration_time_ms": 8972.598, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8972.546, "sample_time_ms": 838.81, "learn_time_ms": 8118.482, "learn_throughput": 492.703, "synch_weights_time_ms": 14.473}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "done": false, "training_iteration": 179, "trial_id": "06536_00000", "date": "2024-08-11_17-49-27", "timestamp": 1723412967, "time_this_iter_s": 9.180740118026733, "time_total_s": 4505.866936206818, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63dc5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4505.866936206818, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 29.953846153846158, "ram_util_percent": 81.53076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.889612863585353, "cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.614814693791171, "policy_loss": -0.008730704290792346, "vf_loss": 1.6235453983147938, "vf_explained_var": 0.962916366259257, "kl": 0.0057846696905981265, "entropy": 0.36388718892509736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.079779569118742, "cur_kl_coeff": 1.3541694921472756e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1149688089966143, "policy_loss": -0.0014905738546981146, "vf_loss": 2.1164593827156795, "vf_explained_var": 0.9495550216505767, "kl": 0.001894624494538906, "entropy": 0.15887595015385794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 50.62201798035526, "episode_reward_min": -5.563466532334592, "episode_reward_mean": 18.743252395414956, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.622017980355245, "predator_policy": -12.380529678274268}, "policy_reward_max": {"prey_policy": 5.563466532334598, "predator_policy": 55.471656522292186}, "policy_reward_mean": {"prey_policy": -18.743252395414956, "predator_policy": 18.743252395414952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6724325164023846, 12.95339163807617, 24.93378311646982, 4.70731083057579, 37.845051283058865, 26.164093824064487, 12.072020614100564, 19.805309248149666, 17.713020596084636, 25.673301412957336, 13.794573812836125, 20.56843547245003, 27.421624060828634, 6.759996044690361, 19.495226229567237, 12.762390861128393, 12.378713950835543, 32.1294899907163, 14.469213813793056, 12.81745546552797, 21.864851026727184, 18.695674413752286, 9.065051402473657, 35.12866004300569, 20.060798763612556, 17.102528595410792, 28.066611273253493, 14.14216084708808, 46.742132154747594, 23.956626214687642, 3.05093520719882, 16.06481101024887, 18.51489032118529, 3.4960440181647794, -5.563466532334592, 24.584018949132204, 3.6987456748471947, 5.579484367110439, 30.82062087045793, 27.97141860790387, 7.967542354773149, 16.788597475728686, 27.24589000006315, 26.72109380172752, 36.2785006645, 17.989159428465836, 20.050258191039966, 17.699641400909996, 29.634826798600237, 24.478410128452534, 16.251823199558622, 18.14987158870926, 15.118651479501134, 12.078159622575676, 42.25673550675619, 15.787379883784178, 31.323493278457896, 5.708557343370131, 50.62201798035526, 25.923513919320133, 13.89728936550213, 32.94345299528792, 13.027490007197283, 27.398528217017947, 17.515452286021443, 23.871442390382818, 16.286687597371216, 23.04628967258302, 9.242702856667906, 1.3788385586904903, 5.367585807926844, 33.770204838568205, 7.944808480333416, 20.307270770920436, 21.55029739287568, -2.3559251857551207, 40.56627489594184, 1.550088679767959, 7.28250099220701, 9.546326201473832, 35.01974622633587, 15.876844916924473, 11.32514879257025, 36.68647355664324, 18.340000260664098, 20.30101144488008, 34.25746535129386, 34.781787995219524, 29.023581173092786, 22.57813774711747, 8.070262030056387, -1.2085949835213956, 25.759935790219536, 16.613431080505844, 18.193079233970508, 25.665475550876355, 13.449999859815895, -2.7760007634657167, 2.3703685965832415, 7.605922803094193], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.672432516402404, -12.953391638076162, -24.933783116469783, -4.707310830575793, -37.84505128305884, -26.164093824064523, -12.072020614100522, -19.805309248149662, -17.713020596084636, -25.673301412957365, -13.794573812836116, -20.56843547245003, -27.421624060828595, -6.759996044690366, -19.495226229567272, -12.762390861128374, -12.37871395083554, -32.12948999071634, -14.469213813793047, -12.817455465527944, -21.864851026727184, -18.69567441375228, -9.065051402473653, -35.12866004300564, -20.060798763612574, -17.102528595410785, -28.066611273253482, -14.142160847088073, -46.7421321547476, -23.956626214687656, -3.05093520719882, -16.064811010248867, -18.514890321185288, -3.4960440181647945, 5.563466532334598, -24.584018949132194, -3.698745674847194, -5.579484367110437, -30.820620870457937, -27.97141860790382, -7.967542354773142, -16.788597475728704, -27.245890000063167, -26.721093801727516, -36.27850066450011, -17.98915942846584, -20.05025819103998, -17.699641400909982, -29.634826798600237, -24.478410128452552, -16.25182319955859, -18.149871588709257, -15.118651479501175, -12.078159622575642, -42.256735506756165, -15.787379883784169, -31.323493278457885, -5.708557343370144, -50.622017980355245, -25.923513919320143, -13.897289365502118, -32.94345299528795, -13.027490007197285, -27.398528217017937, -17.515452286021404, -23.871442390382814, -16.28668759737119, -23.046289672583065, -9.242702856667904, -1.3788385586904814, -5.367585807926844, -33.770204838568134, -7.944808480333425, -20.30727077092045, -21.550297392875684, 2.3559251857551224, -40.56627489594194, -1.550088679767951, -7.282500992207017, -9.546326201473839, -35.019746226335855, -15.876844916924462, -11.325148792570241, -36.68647355664326, -18.340000260664134, -20.301011444880118, -34.257465351293824, -34.78178799521948, -29.023581173092794, -22.578137747117466, -8.070262030056377, 1.2085949835213885, -25.759935790219558, -16.613431080505855, -18.193079233970515, -25.665475550876348, -13.449999859815883, 2.7760007634657096, -2.3703685965832344, -7.605922803094201], "policy_predator_policy_reward": [5.3474776131084365, -0.002612580303626544, 21.5830695140174, 4.323713762134897, 29.692046338363582, 20.175519894576006, 17.442923517148614, -8.02830185599703, 36.41646276281051, 39.27363980330719, 28.35888934042556, 23.969298307703443, 1.6494327551672612, 22.49460847303381, 5.678316095126814, 33.93230240117251, 2.860181758975184, 32.56585943319407, 18.97438695352376, 32.37221587239096, 13.808790343484464, 13.780357282187792, 32.80483708531432, 8.332033859585767, 14.941959240451297, 39.901288881205936, -3.1726551386176647, 16.692647227998368, 12.647299368605687, 26.343153090528908, 19.522301856587767, 6.002479865669004, 6.160626267709539, 18.596801633961544, 30.802470554371393, 33.45650942706133, 10.092466882192298, 18.845960745393803, 14.253264284407573, 11.381646646648324, 32.077898631843304, 11.651803421611067, 35.293941804299074, 2.0974070232055064, 17.78171604188614, 0.34838676306116145, 38.78750714732872, 31.469812938682544, 12.938450845418023, 27.18314668180712, 21.009522072342747, 13.195535118478823, 29.25101178238167, 26.882210764125308, 6.6996892877434835, 21.584632406432654, 55.471656522292186, 38.01260778720302, 37.71355194393295, 10.199700485442357, 12.764367545465863, -6.662497131068211, 8.453984771288578, 23.675637249209117, 29.25462849724372, 7.775152145126842, 11.899697890569758, -4.9076098542401745, -11.628450489973726, 0.501517425304538, 39.020799008071535, 10.147238890192874, 5.660284547668622, 1.7372068020257707, -8.735702370863072, 19.894671105083965, 19.923416797328738, 41.71782494358713, 39.137222106580495, 16.805615109227134, 5.161714123595697, 10.773370585950591, 6.639288658644757, 26.93790629281264, 16.846807036494315, 37.64497296363201, 12.695764221296997, 40.746423382158014, 35.699036306317296, 36.8579650226828, 15.757815286133368, 20.220503570798293, 12.923581906428776, 27.176934475651166, 19.331294469159666, 16.067988332660292, 27.50479971576919, 31.76485388143128, 36.00857138590966, 12.948248870995423, 6.223052944329519, 26.280593454787684, 26.57345316885886, 9.726290008559666, 7.570784202711449, 22.666518756290845, 4.7897118855323555, 19.366607359618975, 45.27698883657449, 39.23648217693792, 1.7363900298942916, 29.838369737674043, 18.548574842682882, 44.09841171423292, 13.302256660082058, -1.885141973341776, 49.176173543985314, 52.0678624167252, 19.573597251716862, 32.27343058692341, 15.588196712885816, 12.20638201811841, 44.155746635229534, 21.731159355346314, -6.1449795482926, 32.19995956268715, 28.148123128350374, 26.64893330568551, 26.044288416718643, 8.986616155324192, 5.59863735524134, 42.144247425524306, 12.889468620731144, 19.68390657401124, 19.607917527721835, 26.48466181744426, 11.063862251499422, 7.421543461836388, -12.380529678274268, 15.13820679565524, -6.606608615267836, 17.341780231121522, 34.595436581104366, 32.944973096031944, -6.658902711564933, 22.548519672231787, 12.33873125390778, 28.27581028793307, 6.187086560959667, 36.913508224791705, -0.5269405100053692, -4.184909861504872, 32.16854384526762, 48.96400594661614, -6.657682889932346, 9.757860249468218, 16.20470026336085, -1.6396982789468293, -1.0221567544623147, 20.11480915740999, 27.05826250569128, 42.981229946980434, 8.92281377731201, 22.83087605653693, 14.1652328107809, 8.485064774359582, 32.91499755723931, 40.45794955604719, 22.655451528507925, 14.024548992820304, 16.43323341933936, 24.168789470420844, 27.823306070581996, 40.6916246320057, 36.27439239515871, 33.28918359528025, 28.85559965752504, 29.191562688660518, 21.801355737522673, 23.354919756712267, 25.696806008424147, -9.556281948311407, 7.153048734652586, -9.570238701695354, 21.542566018666065, 29.977305561773065, 23.078433263751137, 10.148428897260576, 20.99236084632347, 15.393797621617544, 24.42013131479322, 26.910819786959465, 27.331906998531814, -0.4319072789000433, -0.540637856901296, -5.011363670030116, -3.8702571793382656, 8.610994372504736, 23.430553941288686, -8.218708335100251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6061034827719296, "mean_inference_ms": 1.618998322265959, "mean_action_processing_ms": 0.24991675112433584, "mean_env_wait_ms": 0.1397812769759516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002806544303894043, "StateBufferConnector_ms": 0.0023059844970703125, "ViewRequirementAgentConnector_ms": 0.061914801597595215}, "num_episodes": 18, "episode_return_max": 50.62201798035526, "episode_return_min": -5.563466532334592, "episode_return_mean": 18.743252395414956, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.05078564830575, "num_env_steps_trained_throughput_per_sec": 464.05078564830575, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 8937.084, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8937.033, "sample_time_ms": 835.05, "learn_time_ms": 8086.78, "learn_throughput": 494.634, "synch_weights_time_ms": 14.426}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 180, "trial_id": "06536_00000", "date": "2024-08-11_17-49-36", "timestamp": 1723412976, "time_this_iter_s": 8.625619173049927, "time_total_s": 4514.492555379868, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63dcf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4514.492555379868, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 23.676923076923075, "ram_util_percent": 81.12307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9872249313940604, "cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.143538740215202, "policy_loss": -0.006335351831512526, "vf_loss": 2.1498740904033182, "vf_explained_var": 0.9442962598055601, "kl": 0.007358212597198374, "entropy": 0.35942532839253544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.060379235580485, "cur_kl_coeff": 6.770847460736378e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6397392599670977, "policy_loss": -0.0013295952004020806, "vf_loss": 2.641068858507449, "vf_explained_var": 0.9362248719684662, "kl": 0.001835698685407591, "entropy": 0.15548405835316295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "env_runners": {"episode_reward_max": 50.62201798035526, "episode_reward_min": -6.904881742727603, "episode_reward_mean": 17.866259754336475, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.622017980355245, "predator_policy": -13.944626750643017}, "policy_reward_max": {"prey_policy": 6.904881742727602, "predator_policy": 55.471656522292186}, "policy_reward_mean": {"prey_policy": -17.866259754336475, "predator_policy": 17.866259754336475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.469213813793056, 12.81745546552797, 21.864851026727184, 18.695674413752286, 9.065051402473657, 35.12866004300569, 20.060798763612556, 17.102528595410792, 28.066611273253493, 14.14216084708808, 46.742132154747594, 23.956626214687642, 3.05093520719882, 16.06481101024887, 18.51489032118529, 3.4960440181647794, -5.563466532334592, 24.584018949132204, 3.6987456748471947, 5.579484367110439, 30.82062087045793, 27.97141860790387, 7.967542354773149, 16.788597475728686, 27.24589000006315, 26.72109380172752, 36.2785006645, 17.989159428465836, 20.050258191039966, 17.699641400909996, 29.634826798600237, 24.478410128452534, 16.251823199558622, 18.14987158870926, 15.118651479501134, 12.078159622575676, 42.25673550675619, 15.787379883784178, 31.323493278457896, 5.708557343370131, 50.62201798035526, 25.923513919320133, 13.89728936550213, 32.94345299528792, 13.027490007197283, 27.398528217017947, 17.515452286021443, 23.871442390382818, 16.286687597371216, 23.04628967258302, 9.242702856667906, 1.3788385586904903, 5.367585807926844, 33.770204838568205, 7.944808480333416, 20.307270770920436, 21.55029739287568, -2.3559251857551207, 40.56627489594184, 1.550088679767959, 7.28250099220701, 9.546326201473832, 35.01974622633587, 15.876844916924473, 11.32514879257025, 36.68647355664324, 18.340000260664098, 20.30101144488008, 34.25746535129386, 34.781787995219524, 29.023581173092786, 22.57813774711747, 8.070262030056387, -1.2085949835213956, 25.759935790219536, 16.613431080505844, 18.193079233970508, 25.665475550876355, 13.449999859815895, -2.7760007634657167, 2.3703685965832415, 7.605922803094193, 26.211130773005365, 37.83550064274372, 17.786677465881432, 4.402526848438968, 20.235244585093717, 2.0499172798645837, -6.904881742727603, 13.119202289663258, 29.181830855969658, 28.92281281874633, 8.903828154428268, 18.892872313244414, 9.450371633361787, 5.687650611414501, 8.294395018122804, -0.6274892418125013, 21.793072842934286, -3.0837617532282673], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.469213813793047, -12.817455465527944, -21.864851026727184, -18.69567441375228, -9.065051402473653, -35.12866004300564, -20.060798763612574, -17.102528595410785, -28.066611273253482, -14.142160847088073, -46.7421321547476, -23.956626214687656, -3.05093520719882, -16.064811010248867, -18.514890321185288, -3.4960440181647945, 5.563466532334598, -24.584018949132194, -3.698745674847194, -5.579484367110437, -30.820620870457937, -27.97141860790382, -7.967542354773142, -16.788597475728704, -27.245890000063167, -26.721093801727516, -36.27850066450011, -17.98915942846584, -20.05025819103998, -17.699641400909982, -29.634826798600237, -24.478410128452552, -16.25182319955859, -18.149871588709257, -15.118651479501175, -12.078159622575642, -42.256735506756165, -15.787379883784169, -31.323493278457885, -5.708557343370144, -50.622017980355245, -25.923513919320143, -13.897289365502118, -32.94345299528795, -13.027490007197285, -27.398528217017937, -17.515452286021404, -23.871442390382814, -16.28668759737119, -23.046289672583065, -9.242702856667904, -1.3788385586904814, -5.367585807926844, -33.770204838568134, -7.944808480333425, -20.30727077092045, -21.550297392875684, 2.3559251857551224, -40.56627489594194, -1.550088679767951, -7.282500992207017, -9.546326201473839, -35.019746226335855, -15.876844916924462, -11.325148792570241, -36.68647355664326, -18.340000260664134, -20.301011444880118, -34.257465351293824, -34.78178799521948, -29.023581173092794, -22.578137747117466, -8.070262030056377, 1.2085949835213885, -25.759935790219558, -16.613431080505855, -18.193079233970515, -25.665475550876348, -13.449999859815883, 2.7760007634657096, -2.3703685965832344, -7.605922803094201, -26.211130773005387, -37.835500642743725, -17.78667746588149, -4.40252684843897, -20.23524458509374, -2.0499172798646006, 6.904881742727602, -13.119202289663274, -29.181830855969665, -28.922812818746355, -8.90382815442827, -18.892872313244386, -9.45037163336179, -5.6876506114145275, -8.294395018122788, 0.6274892418125018, -21.793072842934286, 3.08376175322827], "policy_predator_policy_reward": [10.092466882192298, 18.845960745393803, 14.253264284407573, 11.381646646648324, 32.077898631843304, 11.651803421611067, 35.293941804299074, 2.0974070232055064, 17.78171604188614, 0.34838676306116145, 38.78750714732872, 31.469812938682544, 12.938450845418023, 27.18314668180712, 21.009522072342747, 13.195535118478823, 29.25101178238167, 26.882210764125308, 6.6996892877434835, 21.584632406432654, 55.471656522292186, 38.01260778720302, 37.71355194393295, 10.199700485442357, 12.764367545465863, -6.662497131068211, 8.453984771288578, 23.675637249209117, 29.25462849724372, 7.775152145126842, 11.899697890569758, -4.9076098542401745, -11.628450489973726, 0.501517425304538, 39.020799008071535, 10.147238890192874, 5.660284547668622, 1.7372068020257707, -8.735702370863072, 19.894671105083965, 19.923416797328738, 41.71782494358713, 39.137222106580495, 16.805615109227134, 5.161714123595697, 10.773370585950591, 6.639288658644757, 26.93790629281264, 16.846807036494315, 37.64497296363201, 12.695764221296997, 40.746423382158014, 35.699036306317296, 36.8579650226828, 15.757815286133368, 20.220503570798293, 12.923581906428776, 27.176934475651166, 19.331294469159666, 16.067988332660292, 27.50479971576919, 31.76485388143128, 36.00857138590966, 12.948248870995423, 6.223052944329519, 26.280593454787684, 26.57345316885886, 9.726290008559666, 7.570784202711449, 22.666518756290845, 4.7897118855323555, 19.366607359618975, 45.27698883657449, 39.23648217693792, 1.7363900298942916, 29.838369737674043, 18.548574842682882, 44.09841171423292, 13.302256660082058, -1.885141973341776, 49.176173543985314, 52.0678624167252, 19.573597251716862, 32.27343058692341, 15.588196712885816, 12.20638201811841, 44.155746635229534, 21.731159355346314, -6.1449795482926, 32.19995956268715, 28.148123128350374, 26.64893330568551, 26.044288416718643, 8.986616155324192, 5.59863735524134, 42.144247425524306, 12.889468620731144, 19.68390657401124, 19.607917527721835, 26.48466181744426, 11.063862251499422, 7.421543461836388, -12.380529678274268, 15.13820679565524, -6.606608615267836, 17.341780231121522, 34.595436581104366, 32.944973096031944, -6.658902711564933, 22.548519672231787, 12.33873125390778, 28.27581028793307, 6.187086560959667, 36.913508224791705, -0.5269405100053692, -4.184909861504872, 32.16854384526762, 48.96400594661614, -6.657682889932346, 9.757860249468218, 16.20470026336085, -1.6396982789468293, -1.0221567544623147, 20.11480915740999, 27.05826250569128, 42.981229946980434, 8.92281377731201, 22.83087605653693, 14.1652328107809, 8.485064774359582, 32.91499755723931, 40.45794955604719, 22.655451528507925, 14.024548992820304, 16.43323341933936, 24.168789470420844, 27.823306070581996, 40.6916246320057, 36.27439239515871, 33.28918359528025, 28.85559965752504, 29.191562688660518, 21.801355737522673, 23.354919756712267, 25.696806008424147, -9.556281948311407, 7.153048734652586, -9.570238701695354, 21.542566018666065, 29.977305561773065, 23.078433263751137, 10.148428897260576, 20.99236084632347, 15.393797621617544, 24.42013131479322, 26.910819786959465, 27.331906998531814, -0.4319072789000433, -0.540637856901296, -5.011363670030116, -3.8702571793382656, 8.610994372504736, 23.430553941288686, -8.218708335100251, 13.529420611221266, 38.89284093478949, 30.49857392308811, 45.172427362399354, 26.406183050397367, 9.16717188136557, -7.025108749228595, 15.830162446106542, 10.776505388983228, 29.693983781204196, 9.071408654573148, -4.971574094843975, 0.13486326518781055, -13.944626750643017, 3.374045366504541, 22.864359212821988, 24.026358450729607, 34.33730326120972, 20.99286424532712, 36.85276139216558, 21.891667775734014, -4.084011466877464, 12.45344486679414, 25.332299759694703, -1.5900705087803209, 20.490813775503906, 12.332231344321848, -0.9569301214928174, -2.006987217585257, 18.595777253830825, 4.615676441168698, -5.870654924793705, 9.890047978111953, 33.696097707756635, -0.8128831401788172, -5.354640366277711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6050776041678574, "mean_inference_ms": 1.6158437969467, "mean_action_processing_ms": 0.24951796029980358, "mean_env_wait_ms": 0.13947827052731973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030645132064819336, "StateBufferConnector_ms": 0.002364039421081543, "ViewRequirementAgentConnector_ms": 0.06425583362579346}, "num_episodes": 18, "episode_return_max": 50.62201798035526, "episode_return_min": -6.904881742727603, "episode_return_mean": 17.866259754336475, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.1296805625145, "num_env_steps_trained_throughput_per_sec": 462.1296805625145, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2172000, "timers": {"training_iteration_time_ms": 8930.274, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8930.229, "sample_time_ms": 839.961, "learn_time_ms": 8075.777, "learn_throughput": 495.308, "synch_weights_time_ms": 13.763}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "done": false, "training_iteration": 181, "trial_id": "06536_00000", "date": "2024-08-11_17-49-44", "timestamp": 1723412984, "time_this_iter_s": 8.660789966583252, "time_total_s": 4523.153345346451, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58a1160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4523.153345346451, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 24.466666666666665, "ram_util_percent": 80.90833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.176012861356139, "cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2549194833884636, "policy_loss": -0.003930486458799957, "vf_loss": 2.2588499744733173, "vf_explained_var": 0.9428308579449852, "kl": 0.004084015914598047, "entropy": 0.3469473093127211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.215692490560037, "cur_kl_coeff": 3.385423730368189e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6459222974600616, "policy_loss": -0.001609208353021473, "vf_loss": 2.6475315097147827, "vf_explained_var": 0.9397709471523447, "kl": 0.0020873008017170255, "entropy": 0.16044850038394096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "env_runners": {"episode_reward_max": 50.62201798035526, "episode_reward_min": -6.904881742727603, "episode_reward_mean": 18.22379863767333, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.622017980355245, "predator_policy": -13.944626750643017}, "policy_reward_max": {"prey_policy": 6.904881742727602, "predator_policy": 55.59592798495504}, "policy_reward_mean": {"prey_policy": -18.22379863767333, "predator_policy": 18.22379863767333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.788597475728686, 27.24589000006315, 26.72109380172752, 36.2785006645, 17.989159428465836, 20.050258191039966, 17.699641400909996, 29.634826798600237, 24.478410128452534, 16.251823199558622, 18.14987158870926, 15.118651479501134, 12.078159622575676, 42.25673550675619, 15.787379883784178, 31.323493278457896, 5.708557343370131, 50.62201798035526, 25.923513919320133, 13.89728936550213, 32.94345299528792, 13.027490007197283, 27.398528217017947, 17.515452286021443, 23.871442390382818, 16.286687597371216, 23.04628967258302, 9.242702856667906, 1.3788385586904903, 5.367585807926844, 33.770204838568205, 7.944808480333416, 20.307270770920436, 21.55029739287568, -2.3559251857551207, 40.56627489594184, 1.550088679767959, 7.28250099220701, 9.546326201473832, 35.01974622633587, 15.876844916924473, 11.32514879257025, 36.68647355664324, 18.340000260664098, 20.30101144488008, 34.25746535129386, 34.781787995219524, 29.023581173092786, 22.57813774711747, 8.070262030056387, -1.2085949835213956, 25.759935790219536, 16.613431080505844, 18.193079233970508, 25.665475550876355, 13.449999859815895, -2.7760007634657167, 2.3703685965832415, 7.605922803094193, 26.211130773005365, 37.83550064274372, 17.786677465881432, 4.402526848438968, 20.235244585093717, 2.0499172798645837, -6.904881742727603, 13.119202289663258, 29.181830855969658, 28.92281281874633, 8.903828154428268, 18.892872313244414, 9.450371633361787, 5.687650611414501, 8.294395018122804, -0.6274892418125013, 21.793072842934286, -3.0837617532282673, 32.36235563072945, 14.397070796248315, 22.067374584443463, 36.431354117795145, 1.3638515025350024, 15.719119166111916, 15.937258848164518, 19.995569040626428, 5.383550248107886, 13.428213580710612, 17.34651727720846, 20.594352907711862, 22.38643664149047, 15.766590564474985, 24.652712092891573, 20.93172667109251, 0.9668912056254735, 11.410098913506827, 22.493417849758462, 6.2812389833335684, 11.928732919714342, 46.65132278790402, 35.55494086626775], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.788597475728704, -27.245890000063167, -26.721093801727516, -36.27850066450011, -17.98915942846584, -20.05025819103998, -17.699641400909982, -29.634826798600237, -24.478410128452552, -16.25182319955859, -18.149871588709257, -15.118651479501175, -12.078159622575642, -42.256735506756165, -15.787379883784169, -31.323493278457885, -5.708557343370144, -50.622017980355245, -25.923513919320143, -13.897289365502118, -32.94345299528795, -13.027490007197285, -27.398528217017937, -17.515452286021404, -23.871442390382814, -16.28668759737119, -23.046289672583065, -9.242702856667904, -1.3788385586904814, -5.367585807926844, -33.770204838568134, -7.944808480333425, -20.30727077092045, -21.550297392875684, 2.3559251857551224, -40.56627489594194, -1.550088679767951, -7.282500992207017, -9.546326201473839, -35.019746226335855, -15.876844916924462, -11.325148792570241, -36.68647355664326, -18.340000260664134, -20.301011444880118, -34.257465351293824, -34.78178799521948, -29.023581173092794, -22.578137747117466, -8.070262030056377, 1.2085949835213885, -25.759935790219558, -16.613431080505855, -18.193079233970515, -25.665475550876348, -13.449999859815883, 2.7760007634657096, -2.3703685965832344, -7.605922803094201, -26.211130773005387, -37.835500642743725, -17.78667746588149, -4.40252684843897, -20.23524458509374, -2.0499172798646006, 6.904881742727602, -13.119202289663274, -29.181830855969665, -28.922812818746355, -8.90382815442827, -18.892872313244386, -9.45037163336179, -5.6876506114145275, -8.294395018122788, 0.6274892418125018, -21.793072842934286, 3.08376175322827, -32.36235563072945, -14.397070796248302, -22.067374584443442, -36.43135411779514, -1.3638515025350015, -15.719119166111916, -15.937258848164458, -19.995569040626446, -5.3835502481078885, -13.428213580710626, -17.346517277208402, -20.594352907711887, -22.386436641490473, -15.766590564474981, -24.652712092891555, -20.93172667109251, -0.9668912056254806, -11.410098913506797, -22.493417849758462, -6.281238983333602, -11.928732919714312, -46.65132278790392, -35.55494086626772], "policy_predator_policy_reward": [6.639288658644757, 26.93790629281264, 16.846807036494315, 37.64497296363201, 12.695764221296997, 40.746423382158014, 35.699036306317296, 36.8579650226828, 15.757815286133368, 20.220503570798293, 12.923581906428776, 27.176934475651166, 19.331294469159666, 16.067988332660292, 27.50479971576919, 31.76485388143128, 36.00857138590966, 12.948248870995423, 6.223052944329519, 26.280593454787684, 26.57345316885886, 9.726290008559666, 7.570784202711449, 22.666518756290845, 4.7897118855323555, 19.366607359618975, 45.27698883657449, 39.23648217693792, 1.7363900298942916, 29.838369737674043, 18.548574842682882, 44.09841171423292, 13.302256660082058, -1.885141973341776, 49.176173543985314, 52.0678624167252, 19.573597251716862, 32.27343058692341, 15.588196712885816, 12.20638201811841, 44.155746635229534, 21.731159355346314, -6.1449795482926, 32.19995956268715, 28.148123128350374, 26.64893330568551, 26.044288416718643, 8.986616155324192, 5.59863735524134, 42.144247425524306, 12.889468620731144, 19.68390657401124, 19.607917527721835, 26.48466181744426, 11.063862251499422, 7.421543461836388, -12.380529678274268, 15.13820679565524, -6.606608615267836, 17.341780231121522, 34.595436581104366, 32.944973096031944, -6.658902711564933, 22.548519672231787, 12.33873125390778, 28.27581028793307, 6.187086560959667, 36.913508224791705, -0.5269405100053692, -4.184909861504872, 32.16854384526762, 48.96400594661614, -6.657682889932346, 9.757860249468218, 16.20470026336085, -1.6396982789468293, -1.0221567544623147, 20.11480915740999, 27.05826250569128, 42.981229946980434, 8.92281377731201, 22.83087605653693, 14.1652328107809, 8.485064774359582, 32.91499755723931, 40.45794955604719, 22.655451528507925, 14.024548992820304, 16.43323341933936, 24.168789470420844, 27.823306070581996, 40.6916246320057, 36.27439239515871, 33.28918359528025, 28.85559965752504, 29.191562688660518, 21.801355737522673, 23.354919756712267, 25.696806008424147, -9.556281948311407, 7.153048734652586, -9.570238701695354, 21.542566018666065, 29.977305561773065, 23.078433263751137, 10.148428897260576, 20.99236084632347, 15.393797621617544, 24.42013131479322, 26.910819786959465, 27.331906998531814, -0.4319072789000433, -0.540637856901296, -5.011363670030116, -3.8702571793382656, 8.610994372504736, 23.430553941288686, -8.218708335100251, 13.529420611221266, 38.89284093478949, 30.49857392308811, 45.172427362399354, 26.406183050397367, 9.16717188136557, -7.025108749228595, 15.830162446106542, 10.776505388983228, 29.693983781204196, 9.071408654573148, -4.971574094843975, 0.13486326518781055, -13.944626750643017, 3.374045366504541, 22.864359212821988, 24.026358450729607, 34.33730326120972, 20.99286424532712, 36.85276139216558, 21.891667775734014, -4.084011466877464, 12.45344486679414, 25.332299759694703, -1.5900705087803209, 20.490813775503906, 12.332231344321848, -0.9569301214928174, -2.006987217585257, 18.595777253830825, 4.615676441168698, -5.870654924793705, 9.890047978111953, 33.696097707756635, -0.8128831401788172, -5.354640366277711, 20.448432709942914, 44.276278551516, 21.759796575784563, 7.034345016712059, 44.06115195059685, 0.07359721829003973, 40.72637679284218, 32.136331442748094, 13.371257217279837, -10.64355421220983, 5.391704747325338, 26.04653358489852, 25.12325309479849, 6.751264601530462, 11.493155315457981, 28.497982765794912, 14.525963743713854, -3.758863247498086, 24.68039611014457, 2.176031051276663, 5.505053004164065, 29.187981550252765, 31.616091213160146, 9.572614602263677, 7.328822352990674, 37.44405092999028, 17.659558945070934, 13.873622183879025, 22.83413446157964, 26.47128972420351, 36.21834831458253, 5.645105027602446, 7.085112366556828, -5.151329955305869, 20.038879154908745, 2.781318672104822, 24.191023294235155, 20.795812405281758, 3.5000022416643706, 9.062475725002836, -4.111718917359495, 27.969184756788145, 55.59592798495504, 37.706717590852946, 24.233561762609302, 46.87631996992615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.603790205343594, "mean_inference_ms": 1.612103508845968, "mean_action_processing_ms": 0.2489332079536758, "mean_env_wait_ms": 0.13905827512118923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519415855407715, "StateBufferConnector_ms": 0.002345442771911621, "ViewRequirementAgentConnector_ms": 0.06238746643066406}, "num_episodes": 23, "episode_return_max": 50.62201798035526, "episode_return_min": -6.904881742727603, "episode_return_mean": 18.22379863767333, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 459.8506136529718, "num_env_steps_trained_throughput_per_sec": 459.8506136529718, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 8923.824, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8923.783, "sample_time_ms": 831.607, "learn_time_ms": 8077.813, "learn_throughput": 495.184, "synch_weights_time_ms": 13.64}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "training_iteration": 182, "trial_id": "06536_00000", "date": "2024-08-11_17-49-53", "timestamp": 1723412993, "time_this_iter_s": 8.70351791381836, "time_total_s": 4531.856863260269, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58a1040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4531.856863260269, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 24.075000000000003, "ram_util_percent": 80.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.378483080491423, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.46631664087375, "policy_loss": -0.008855048697053764, "vf_loss": 2.47517169204851, "vf_explained_var": 0.9458329075947404, "kl": 0.00579519436156475, "entropy": 0.36973687941208483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.064949930281866, "cur_kl_coeff": 1.6927118651840945e-37, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.749249684621417, "policy_loss": -0.000984605344101077, "vf_loss": 2.750234293306946, "vf_explained_var": 0.9345874976544153, "kl": 0.002279469294175162, "entropy": 0.16353534359938254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "env_runners": {"episode_reward_max": 46.65132278790402, "episode_reward_min": -6.904881742727603, "episode_reward_mean": 16.787864589652163, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.65132278790392, "predator_policy": -13.944626750643017}, "policy_reward_max": {"prey_policy": 6.904881742727602, "predator_policy": 55.59592798495504}, "policy_reward_mean": {"prey_policy": -16.78786458965216, "predator_policy": 16.787864589652163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.398528217017947, 17.515452286021443, 23.871442390382818, 16.286687597371216, 23.04628967258302, 9.242702856667906, 1.3788385586904903, 5.367585807926844, 33.770204838568205, 7.944808480333416, 20.307270770920436, 21.55029739287568, -2.3559251857551207, 40.56627489594184, 1.550088679767959, 7.28250099220701, 9.546326201473832, 35.01974622633587, 15.876844916924473, 11.32514879257025, 36.68647355664324, 18.340000260664098, 20.30101144488008, 34.25746535129386, 34.781787995219524, 29.023581173092786, 22.57813774711747, 8.070262030056387, -1.2085949835213956, 25.759935790219536, 16.613431080505844, 18.193079233970508, 25.665475550876355, 13.449999859815895, -2.7760007634657167, 2.3703685965832415, 7.605922803094193, 26.211130773005365, 37.83550064274372, 17.786677465881432, 4.402526848438968, 20.235244585093717, 2.0499172798645837, -6.904881742727603, 13.119202289663258, 29.181830855969658, 28.92281281874633, 8.903828154428268, 18.892872313244414, 9.450371633361787, 5.687650611414501, 8.294395018122804, -0.6274892418125013, 21.793072842934286, -3.0837617532282673, 32.36235563072945, 14.397070796248315, 22.067374584443463, 36.431354117795145, 1.3638515025350024, 15.719119166111916, 15.937258848164518, 19.995569040626428, 5.383550248107886, 13.428213580710612, 17.34651727720846, 20.594352907711862, 22.38643664149047, 15.766590564474985, 24.652712092891573, 20.93172667109251, 0.9668912056254735, 11.410098913506827, 22.493417849758462, 6.2812389833335684, 11.928732919714342, 46.65132278790402, 35.55494086626775, 22.650345053500427, 3.658913833121858, 12.194362840848717, 28.419735879567796, 20.112491978560502, 24.22059806323044, 17.20110862410791, 13.029862069245763, 11.59457427284656, 11.50764224043087, 3.8116663986083132, 11.474973771872286, 13.407743469042458, 5.243025846080937, 34.25363614641548, 14.133817724854723, 26.091734047477694, 19.1800968697962, 21.581018271473134, 29.9568993741252, 16.417219121221137, 6.239943361318599], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.398528217017937, -17.515452286021404, -23.871442390382814, -16.28668759737119, -23.046289672583065, -9.242702856667904, -1.3788385586904814, -5.367585807926844, -33.770204838568134, -7.944808480333425, -20.30727077092045, -21.550297392875684, 2.3559251857551224, -40.56627489594194, -1.550088679767951, -7.282500992207017, -9.546326201473839, -35.019746226335855, -15.876844916924462, -11.325148792570241, -36.68647355664326, -18.340000260664134, -20.301011444880118, -34.257465351293824, -34.78178799521948, -29.023581173092794, -22.578137747117466, -8.070262030056377, 1.2085949835213885, -25.759935790219558, -16.613431080505855, -18.193079233970515, -25.665475550876348, -13.449999859815883, 2.7760007634657096, -2.3703685965832344, -7.605922803094201, -26.211130773005387, -37.835500642743725, -17.78667746588149, -4.40252684843897, -20.23524458509374, -2.0499172798646006, 6.904881742727602, -13.119202289663274, -29.181830855969665, -28.922812818746355, -8.90382815442827, -18.892872313244386, -9.45037163336179, -5.6876506114145275, -8.294395018122788, 0.6274892418125018, -21.793072842934286, 3.08376175322827, -32.36235563072945, -14.397070796248302, -22.067374584443442, -36.43135411779514, -1.3638515025350015, -15.719119166111916, -15.937258848164458, -19.995569040626446, -5.3835502481078885, -13.428213580710626, -17.346517277208402, -20.594352907711887, -22.386436641490473, -15.766590564474981, -24.652712092891555, -20.93172667109251, -0.9668912056254806, -11.410098913506797, -22.493417849758462, -6.281238983333602, -11.928732919714312, -46.65132278790392, -35.55494086626772, -22.650345053500402, -3.6589138331218516, -12.194362840848706, -28.419735879567796, -20.1124919785605, -24.22059806323045, -17.20110862410787, -13.029862069245755, -11.594574272846547, -11.50764224043088, -3.8116663986083044, -11.474973771872284, -13.40774346904246, -5.243025846080933, -34.2536361464154, -14.133817724854701, -26.091734047477715, -19.180096869796177, -21.58101827147316, -29.956899374125197, -16.41721912122111, -6.239943361318589], "policy_predator_policy_reward": [28.148123128350374, 26.64893330568551, 26.044288416718643, 8.986616155324192, 5.59863735524134, 42.144247425524306, 12.889468620731144, 19.68390657401124, 19.607917527721835, 26.48466181744426, 11.063862251499422, 7.421543461836388, -12.380529678274268, 15.13820679565524, -6.606608615267836, 17.341780231121522, 34.595436581104366, 32.944973096031944, -6.658902711564933, 22.548519672231787, 12.33873125390778, 28.27581028793307, 6.187086560959667, 36.913508224791705, -0.5269405100053692, -4.184909861504872, 32.16854384526762, 48.96400594661614, -6.657682889932346, 9.757860249468218, 16.20470026336085, -1.6396982789468293, -1.0221567544623147, 20.11480915740999, 27.05826250569128, 42.981229946980434, 8.92281377731201, 22.83087605653693, 14.1652328107809, 8.485064774359582, 32.91499755723931, 40.45794955604719, 22.655451528507925, 14.024548992820304, 16.43323341933936, 24.168789470420844, 27.823306070581996, 40.6916246320057, 36.27439239515871, 33.28918359528025, 28.85559965752504, 29.191562688660518, 21.801355737522673, 23.354919756712267, 25.696806008424147, -9.556281948311407, 7.153048734652586, -9.570238701695354, 21.542566018666065, 29.977305561773065, 23.078433263751137, 10.148428897260576, 20.99236084632347, 15.393797621617544, 24.42013131479322, 26.910819786959465, 27.331906998531814, -0.4319072789000433, -0.540637856901296, -5.011363670030116, -3.8702571793382656, 8.610994372504736, 23.430553941288686, -8.218708335100251, 13.529420611221266, 38.89284093478949, 30.49857392308811, 45.172427362399354, 26.406183050397367, 9.16717188136557, -7.025108749228595, 15.830162446106542, 10.776505388983228, 29.693983781204196, 9.071408654573148, -4.971574094843975, 0.13486326518781055, -13.944626750643017, 3.374045366504541, 22.864359212821988, 24.026358450729607, 34.33730326120972, 20.99286424532712, 36.85276139216558, 21.891667775734014, -4.084011466877464, 12.45344486679414, 25.332299759694703, -1.5900705087803209, 20.490813775503906, 12.332231344321848, -0.9569301214928174, -2.006987217585257, 18.595777253830825, 4.615676441168698, -5.870654924793705, 9.890047978111953, 33.696097707756635, -0.8128831401788172, -5.354640366277711, 20.448432709942914, 44.276278551516, 21.759796575784563, 7.034345016712059, 44.06115195059685, 0.07359721829003973, 40.72637679284218, 32.136331442748094, 13.371257217279837, -10.64355421220983, 5.391704747325338, 26.04653358489852, 25.12325309479849, 6.751264601530462, 11.493155315457981, 28.497982765794912, 14.525963743713854, -3.758863247498086, 24.68039611014457, 2.176031051276663, 5.505053004164065, 29.187981550252765, 31.616091213160146, 9.572614602263677, 7.328822352990674, 37.44405092999028, 17.659558945070934, 13.873622183879025, 22.83413446157964, 26.47128972420351, 36.21834831458253, 5.645105027602446, 7.085112366556828, -5.151329955305869, 20.038879154908745, 2.781318672104822, 24.191023294235155, 20.795812405281758, 3.5000022416643706, 9.062475725002836, -4.111718917359495, 27.969184756788145, 55.59592798495504, 37.706717590852946, 24.233561762609302, 46.87631996992615, 21.535086835826142, 23.7656032711747, -4.067373516192847, 11.385201182436568, 9.165966741195824, 15.222758940501587, 12.73507571427632, 44.10439604485928, 10.194446591072541, 30.03053736604848, 25.969351511049542, 22.47184461541132, 32.392131896598855, 2.010085351616919, 16.711568105741176, 9.348156032750346, 17.57775427282015, 5.611394272872964, 17.75400211814048, 5.261282362721263, 1.6069670020456552, 6.016365795170962, 13.319699355381509, 9.630248188363064, 22.155210041010054, 4.660276897074856, 4.408953520980659, 6.077098171181216, 33.719185628443505, 34.788086664387414, 11.086603245116489, 17.18103220459294, 34.67826626459518, 17.505201830360203, 25.119155101359436, 13.241038638232943, 9.567794523650143, 33.59424201929616, 17.548598566132885, 42.365200182117505, 12.89220022936757, 19.9422380130747, 10.385704704751682, 2.094182017885478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6025922769281842, "mean_inference_ms": 1.608245825319584, "mean_action_processing_ms": 0.248555132586104, "mean_env_wait_ms": 0.13875238963040304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003943204879760742, "StateBufferConnector_ms": 0.002367377281188965, "ViewRequirementAgentConnector_ms": 0.06289446353912354}, "num_episodes": 22, "episode_return_max": 46.65132278790402, "episode_return_min": -6.904881742727603, "episode_return_mean": 16.787864589652163, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.2569540613243, "num_env_steps_trained_throughput_per_sec": 473.2569540613243, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2196000, "timers": {"training_iteration_time_ms": 8884.74, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8884.699, "sample_time_ms": 820.028, "learn_time_ms": 8050.414, "learn_throughput": 496.869, "synch_weights_time_ms": 13.58}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "done": false, "training_iteration": 183, "trial_id": "06536_00000", "date": "2024-08-11_17-50-01", "timestamp": 1723413001, "time_this_iter_s": 8.456644058227539, "time_total_s": 4540.313507318497, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b589a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4540.313507318497, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 22.991666666666664, "ram_util_percent": 80.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9294855521370966, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.108775559316079, "policy_loss": -0.00622190939320717, "vf_loss": 2.114997474476695, "vf_explained_var": 0.9300366055841247, "kl": 0.006650122256592835, "entropy": 0.3903182195189098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.219957967725381, "cur_kl_coeff": 8.463559325920472e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7785143949367384, "policy_loss": -0.0011970971316769324, "vf_loss": 2.779711497145355, "vf_explained_var": 0.9218860521518364, "kl": 0.002311468091510899, "entropy": 0.16524504371105678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 46.65132278790402, "episode_reward_min": -6.904881742727603, "episode_reward_mean": 17.222394253843717, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.65132278790392, "predator_policy": -13.944626750643017}, "policy_reward_max": {"prey_policy": 6.904881742727602, "predator_policy": 55.59592798495504}, "policy_reward_mean": {"prey_policy": -17.222394253843714, "predator_policy": 17.222394253843717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.876844916924473, 11.32514879257025, 36.68647355664324, 18.340000260664098, 20.30101144488008, 34.25746535129386, 34.781787995219524, 29.023581173092786, 22.57813774711747, 8.070262030056387, -1.2085949835213956, 25.759935790219536, 16.613431080505844, 18.193079233970508, 25.665475550876355, 13.449999859815895, -2.7760007634657167, 2.3703685965832415, 7.605922803094193, 26.211130773005365, 37.83550064274372, 17.786677465881432, 4.402526848438968, 20.235244585093717, 2.0499172798645837, -6.904881742727603, 13.119202289663258, 29.181830855969658, 28.92281281874633, 8.903828154428268, 18.892872313244414, 9.450371633361787, 5.687650611414501, 8.294395018122804, -0.6274892418125013, 21.793072842934286, -3.0837617532282673, 32.36235563072945, 14.397070796248315, 22.067374584443463, 36.431354117795145, 1.3638515025350024, 15.719119166111916, 15.937258848164518, 19.995569040626428, 5.383550248107886, 13.428213580710612, 17.34651727720846, 20.594352907711862, 22.38643664149047, 15.766590564474985, 24.652712092891573, 20.93172667109251, 0.9668912056254735, 11.410098913506827, 22.493417849758462, 6.2812389833335684, 11.928732919714342, 46.65132278790402, 35.55494086626775, 22.650345053500427, 3.658913833121858, 12.194362840848717, 28.419735879567796, 20.112491978560502, 24.22059806323044, 17.20110862410791, 13.029862069245763, 11.59457427284656, 11.50764224043087, 3.8116663986083132, 11.474973771872286, 13.407743469042458, 5.243025846080937, 34.25363614641548, 14.133817724854723, 26.091734047477694, 19.1800968697962, 21.581018271473134, 29.9568993741252, 16.417219121221137, 6.239943361318599, 43.142440439244254, 17.55444994249169, 28.37337166598782, 3.969598010285643, 9.227243201453287, 18.054916701759197, 28.64087318815999, 28.771806032597635, 0.011064368039959582, 22.04715260318557, 11.138135945385441, 9.950234845904523, 31.18282783238909, 27.98073238236829, 20.575348739456512, 16.76333506470979, 22.080786756810003, 3.277769378257525], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.876844916924462, -11.325148792570241, -36.68647355664326, -18.340000260664134, -20.301011444880118, -34.257465351293824, -34.78178799521948, -29.023581173092794, -22.578137747117466, -8.070262030056377, 1.2085949835213885, -25.759935790219558, -16.613431080505855, -18.193079233970515, -25.665475550876348, -13.449999859815883, 2.7760007634657096, -2.3703685965832344, -7.605922803094201, -26.211130773005387, -37.835500642743725, -17.78667746588149, -4.40252684843897, -20.23524458509374, -2.0499172798646006, 6.904881742727602, -13.119202289663274, -29.181830855969665, -28.922812818746355, -8.90382815442827, -18.892872313244386, -9.45037163336179, -5.6876506114145275, -8.294395018122788, 0.6274892418125018, -21.793072842934286, 3.08376175322827, -32.36235563072945, -14.397070796248302, -22.067374584443442, -36.43135411779514, -1.3638515025350015, -15.719119166111916, -15.937258848164458, -19.995569040626446, -5.3835502481078885, -13.428213580710626, -17.346517277208402, -20.594352907711887, -22.386436641490473, -15.766590564474981, -24.652712092891555, -20.93172667109251, -0.9668912056254806, -11.410098913506797, -22.493417849758462, -6.281238983333602, -11.928732919714312, -46.65132278790392, -35.55494086626772, -22.650345053500402, -3.6589138331218516, -12.194362840848706, -28.419735879567796, -20.1124919785605, -24.22059806323045, -17.20110862410787, -13.029862069245755, -11.594574272846547, -11.50764224043088, -3.8116663986083044, -11.474973771872284, -13.40774346904246, -5.243025846080933, -34.2536361464154, -14.133817724854701, -26.091734047477715, -19.180096869796177, -21.58101827147316, -29.956899374125197, -16.41721912122111, -6.239943361318589, -43.1424404392442, -17.5544499424917, -28.373371665987833, -3.969598010285643, -9.227243201453302, -18.05491670175918, -28.640873188159944, -28.771806032597638, -0.011064368039956918, -22.047152603185616, -11.138135945385454, -9.950234845904522, -31.182827832389005, -27.980732382368267, -20.575348739456533, -16.7633350647098, -22.08078675680998, -3.2777693782575437], "policy_predator_policy_reward": [8.92281377731201, 22.83087605653693, 14.1652328107809, 8.485064774359582, 32.91499755723931, 40.45794955604719, 22.655451528507925, 14.024548992820304, 16.43323341933936, 24.168789470420844, 27.823306070581996, 40.6916246320057, 36.27439239515871, 33.28918359528025, 28.85559965752504, 29.191562688660518, 21.801355737522673, 23.354919756712267, 25.696806008424147, -9.556281948311407, 7.153048734652586, -9.570238701695354, 21.542566018666065, 29.977305561773065, 23.078433263751137, 10.148428897260576, 20.99236084632347, 15.393797621617544, 24.42013131479322, 26.910819786959465, 27.331906998531814, -0.4319072789000433, -0.540637856901296, -5.011363670030116, -3.8702571793382656, 8.610994372504736, 23.430553941288686, -8.218708335100251, 13.529420611221266, 38.89284093478949, 30.49857392308811, 45.172427362399354, 26.406183050397367, 9.16717188136557, -7.025108749228595, 15.830162446106542, 10.776505388983228, 29.693983781204196, 9.071408654573148, -4.971574094843975, 0.13486326518781055, -13.944626750643017, 3.374045366504541, 22.864359212821988, 24.026358450729607, 34.33730326120972, 20.99286424532712, 36.85276139216558, 21.891667775734014, -4.084011466877464, 12.45344486679414, 25.332299759694703, -1.5900705087803209, 20.490813775503906, 12.332231344321848, -0.9569301214928174, -2.006987217585257, 18.595777253830825, 4.615676441168698, -5.870654924793705, 9.890047978111953, 33.696097707756635, -0.8128831401788172, -5.354640366277711, 20.448432709942914, 44.276278551516, 21.759796575784563, 7.034345016712059, 44.06115195059685, 0.07359721829003973, 40.72637679284218, 32.136331442748094, 13.371257217279837, -10.64355421220983, 5.391704747325338, 26.04653358489852, 25.12325309479849, 6.751264601530462, 11.493155315457981, 28.497982765794912, 14.525963743713854, -3.758863247498086, 24.68039611014457, 2.176031051276663, 5.505053004164065, 29.187981550252765, 31.616091213160146, 9.572614602263677, 7.328822352990674, 37.44405092999028, 17.659558945070934, 13.873622183879025, 22.83413446157964, 26.47128972420351, 36.21834831458253, 5.645105027602446, 7.085112366556828, -5.151329955305869, 20.038879154908745, 2.781318672104822, 24.191023294235155, 20.795812405281758, 3.5000022416643706, 9.062475725002836, -4.111718917359495, 27.969184756788145, 55.59592798495504, 37.706717590852946, 24.233561762609302, 46.87631996992615, 21.535086835826142, 23.7656032711747, -4.067373516192847, 11.385201182436568, 9.165966741195824, 15.222758940501587, 12.73507571427632, 44.10439604485928, 10.194446591072541, 30.03053736604848, 25.969351511049542, 22.47184461541132, 32.392131896598855, 2.010085351616919, 16.711568105741176, 9.348156032750346, 17.57775427282015, 5.611394272872964, 17.75400211814048, 5.261282362721263, 1.6069670020456552, 6.016365795170962, 13.319699355381509, 9.630248188363064, 22.155210041010054, 4.660276897074856, 4.408953520980659, 6.077098171181216, 33.719185628443505, 34.788086664387414, 11.086603245116489, 17.18103220459294, 34.67826626459518, 17.505201830360203, 25.119155101359436, 13.241038638232943, 9.567794523650143, 33.59424201929616, 17.548598566132885, 42.365200182117505, 12.89220022936757, 19.9422380130747, 10.385704704751682, 2.094182017885478, 37.48015633527641, 48.804724543212, 24.385297160178848, 10.723602724804554, 38.34217582173589, 18.40456751023977, 8.820250580073228, -0.8810545595019459, 11.993896864002199, 6.460589538904408, 29.993027000957298, 6.116806402561083, 12.804036847200514, 44.47770952911935, 38.78849247878204, 18.75511958641325, 4.98044340687401, -4.958314670794092, 13.267704506410304, 30.82660069996091, 15.514384280375529, 6.7618876103953625, -2.4700945635741594, 22.3705642553832, 41.668837857924956, 20.696817806853137, 18.969450331514427, 36.992014433222046, 16.62954788127071, 24.52114959764233, 30.852648188915005, 2.6740219405046144, 15.540751974154098, 28.62082153946588, 12.624130873540661, -6.0685921170255845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6014263073019326, "mean_inference_ms": 1.6047938073762693, "mean_action_processing_ms": 0.24810584480068715, "mean_env_wait_ms": 0.13843324451702554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004139542579650879, "StateBufferConnector_ms": 0.002331376075744629, "ViewRequirementAgentConnector_ms": 0.060845017433166504}, "num_episodes": 18, "episode_return_max": 46.65132278790402, "episode_return_min": -6.904881742727603, "episode_return_mean": 17.222394253843717, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.712980730712, "num_env_steps_trained_throughput_per_sec": 440.712980730712, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 8934.093, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8934.053, "sample_time_ms": 818.937, "learn_time_ms": 8100.757, "learn_throughput": 493.781, "synch_weights_time_ms": 13.686}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 184, "trial_id": "06536_00000", "date": "2024-08-11_17-50-11", "timestamp": 1723413011, "time_this_iter_s": 9.080038070678711, "time_total_s": 4549.393545389175, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58fc9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4549.393545389175, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 27.984615384615385, "ram_util_percent": 80.63846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.213094339892268, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9091320021698872, "policy_loss": -0.008163266557676251, "vf_loss": 1.9172952687988678, "vf_explained_var": 0.9484955595185359, "kl": 0.007221086793170646, "entropy": 0.39219449112812677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.044478041658957, "cur_kl_coeff": 4.231779662960236e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.342682977832814, "policy_loss": -0.004742197009116392, "vf_loss": 2.347425170297976, "vf_explained_var": 0.9367617578418167, "kl": 0.016452470890040583, "entropy": 0.14752808826428557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "env_runners": {"episode_reward_max": 46.65132278790402, "episode_reward_min": -6.904881742727603, "episode_reward_mean": 16.54030265475499, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.65132278790392, "predator_policy": -13.944626750643017}, "policy_reward_max": {"prey_policy": 6.904881742727602, "predator_policy": 55.59592798495504}, "policy_reward_mean": {"prey_policy": -16.54030265475499, "predator_policy": 16.54030265475499}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.605922803094193, 26.211130773005365, 37.83550064274372, 17.786677465881432, 4.402526848438968, 20.235244585093717, 2.0499172798645837, -6.904881742727603, 13.119202289663258, 29.181830855969658, 28.92281281874633, 8.903828154428268, 18.892872313244414, 9.450371633361787, 5.687650611414501, 8.294395018122804, -0.6274892418125013, 21.793072842934286, -3.0837617532282673, 32.36235563072945, 14.397070796248315, 22.067374584443463, 36.431354117795145, 1.3638515025350024, 15.719119166111916, 15.937258848164518, 19.995569040626428, 5.383550248107886, 13.428213580710612, 17.34651727720846, 20.594352907711862, 22.38643664149047, 15.766590564474985, 24.652712092891573, 20.93172667109251, 0.9668912056254735, 11.410098913506827, 22.493417849758462, 6.2812389833335684, 11.928732919714342, 46.65132278790402, 35.55494086626775, 22.650345053500427, 3.658913833121858, 12.194362840848717, 28.419735879567796, 20.112491978560502, 24.22059806323044, 17.20110862410791, 13.029862069245763, 11.59457427284656, 11.50764224043087, 3.8116663986083132, 11.474973771872286, 13.407743469042458, 5.243025846080937, 34.25363614641548, 14.133817724854723, 26.091734047477694, 19.1800968697962, 21.581018271473134, 29.9568993741252, 16.417219121221137, 6.239943361318599, 43.142440439244254, 17.55444994249169, 28.37337166598782, 3.969598010285643, 9.227243201453287, 18.054916701759197, 28.64087318815999, 28.771806032597635, 0.011064368039959582, 22.04715260318557, 11.138135945385441, 9.950234845904523, 31.18282783238909, 27.98073238236829, 20.575348739456512, 16.76333506470979, 22.080786756810003, 3.277769378257525, 18.005995258175766, 15.823792837601752, 2.4904395523519653, 25.58131204790239, 2.2837051418469807, 6.421658716852372, 9.808633582208227, 22.393388878190745, 13.832226677013463, 18.863489731511237, 16.225324230975204, 25.269490753208572, 22.696043353389765, 19.758291041959996, 16.442440778417136, -3.955376700129417, 8.154549206581613, 21.00384263651592], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.605922803094201, -26.211130773005387, -37.835500642743725, -17.78667746588149, -4.40252684843897, -20.23524458509374, -2.0499172798646006, 6.904881742727602, -13.119202289663274, -29.181830855969665, -28.922812818746355, -8.90382815442827, -18.892872313244386, -9.45037163336179, -5.6876506114145275, -8.294395018122788, 0.6274892418125018, -21.793072842934286, 3.08376175322827, -32.36235563072945, -14.397070796248302, -22.067374584443442, -36.43135411779514, -1.3638515025350015, -15.719119166111916, -15.937258848164458, -19.995569040626446, -5.3835502481078885, -13.428213580710626, -17.346517277208402, -20.594352907711887, -22.386436641490473, -15.766590564474981, -24.652712092891555, -20.93172667109251, -0.9668912056254806, -11.410098913506797, -22.493417849758462, -6.281238983333602, -11.928732919714312, -46.65132278790392, -35.55494086626772, -22.650345053500402, -3.6589138331218516, -12.194362840848706, -28.419735879567796, -20.1124919785605, -24.22059806323045, -17.20110862410787, -13.029862069245755, -11.594574272846547, -11.50764224043088, -3.8116663986083044, -11.474973771872284, -13.40774346904246, -5.243025846080933, -34.2536361464154, -14.133817724854701, -26.091734047477715, -19.180096869796177, -21.58101827147316, -29.956899374125197, -16.41721912122111, -6.239943361318589, -43.1424404392442, -17.5544499424917, -28.373371665987833, -3.969598010285643, -9.227243201453302, -18.05491670175918, -28.640873188159944, -28.771806032597638, -0.011064368039956918, -22.047152603185616, -11.138135945385454, -9.950234845904522, -31.182827832389005, -27.980732382368267, -20.575348739456533, -16.7633350647098, -22.08078675680998, -3.2777693782575437, -18.005995258175766, -15.823792837601767, -2.4904395523519662, -25.581312047902426, -2.2837051418469834, -6.421658716852374, -9.808633582208232, -22.393388878190777, -13.832226677013411, -18.863489731511237, -16.2253242309752, -25.269490753208622, -22.696043353389776, -19.758291041959986, -16.44244077841715, 3.955376700129417, -8.154549206581608, -21.003842636515916], "policy_predator_policy_reward": [23.430553941288686, -8.218708335100251, 13.529420611221266, 38.89284093478949, 30.49857392308811, 45.172427362399354, 26.406183050397367, 9.16717188136557, -7.025108749228595, 15.830162446106542, 10.776505388983228, 29.693983781204196, 9.071408654573148, -4.971574094843975, 0.13486326518781055, -13.944626750643017, 3.374045366504541, 22.864359212821988, 24.026358450729607, 34.33730326120972, 20.99286424532712, 36.85276139216558, 21.891667775734014, -4.084011466877464, 12.45344486679414, 25.332299759694703, -1.5900705087803209, 20.490813775503906, 12.332231344321848, -0.9569301214928174, -2.006987217585257, 18.595777253830825, 4.615676441168698, -5.870654924793705, 9.890047978111953, 33.696097707756635, -0.8128831401788172, -5.354640366277711, 20.448432709942914, 44.276278551516, 21.759796575784563, 7.034345016712059, 44.06115195059685, 0.07359721829003973, 40.72637679284218, 32.136331442748094, 13.371257217279837, -10.64355421220983, 5.391704747325338, 26.04653358489852, 25.12325309479849, 6.751264601530462, 11.493155315457981, 28.497982765794912, 14.525963743713854, -3.758863247498086, 24.68039611014457, 2.176031051276663, 5.505053004164065, 29.187981550252765, 31.616091213160146, 9.572614602263677, 7.328822352990674, 37.44405092999028, 17.659558945070934, 13.873622183879025, 22.83413446157964, 26.47128972420351, 36.21834831458253, 5.645105027602446, 7.085112366556828, -5.151329955305869, 20.038879154908745, 2.781318672104822, 24.191023294235155, 20.795812405281758, 3.5000022416643706, 9.062475725002836, -4.111718917359495, 27.969184756788145, 55.59592798495504, 37.706717590852946, 24.233561762609302, 46.87631996992615, 21.535086835826142, 23.7656032711747, -4.067373516192847, 11.385201182436568, 9.165966741195824, 15.222758940501587, 12.73507571427632, 44.10439604485928, 10.194446591072541, 30.03053736604848, 25.969351511049542, 22.47184461541132, 32.392131896598855, 2.010085351616919, 16.711568105741176, 9.348156032750346, 17.57775427282015, 5.611394272872964, 17.75400211814048, 5.261282362721263, 1.6069670020456552, 6.016365795170962, 13.319699355381509, 9.630248188363064, 22.155210041010054, 4.660276897074856, 4.408953520980659, 6.077098171181216, 33.719185628443505, 34.788086664387414, 11.086603245116489, 17.18103220459294, 34.67826626459518, 17.505201830360203, 25.119155101359436, 13.241038638232943, 9.567794523650143, 33.59424201929616, 17.548598566132885, 42.365200182117505, 12.89220022936757, 19.9422380130747, 10.385704704751682, 2.094182017885478, 37.48015633527641, 48.804724543212, 24.385297160178848, 10.723602724804554, 38.34217582173589, 18.40456751023977, 8.820250580073228, -0.8810545595019459, 11.993896864002199, 6.460589538904408, 29.993027000957298, 6.116806402561083, 12.804036847200514, 44.47770952911935, 38.78849247878204, 18.75511958641325, 4.98044340687401, -4.958314670794092, 13.267704506410304, 30.82660069996091, 15.514384280375529, 6.7618876103953625, -2.4700945635741594, 22.3705642553832, 41.668837857924956, 20.696817806853137, 18.969450331514427, 36.992014433222046, 16.62954788127071, 24.52114959764233, 30.852648188915005, 2.6740219405046144, 15.540751974154098, 28.62082153946588, 12.624130873540661, -6.0685921170255845, 5.459784746543811, 30.552205769807724, 18.23804938285552, 13.409536292348012, 0.905153803605689, 4.075725301098257, 22.989111835646796, 28.173512260158063, 4.670866572183179, -0.10345628848921251, -5.51972469959178, 18.36304213329653, 23.843875530961213, -4.226608366544735, 32.52108906731684, 12.265688689064682, 1.3976765907966797, 26.266776763230148, 24.79340233251719, 12.933577130505308, 12.461845623077224, 19.988802838873163, 36.338878709253514, 14.200102797163686, 25.52280647899972, 19.869280227779825, 4.348174866226974, 35.16840721769301, -0.15267874894771705, 33.03756030578204, -13.559845592614693, 5.649092192355877, -2.500099993349563, 18.809198406512802, 24.05244880362116, 17.955236469410657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6002735516702433, "mean_inference_ms": 1.6014071587697503, "mean_action_processing_ms": 0.24766869124471608, "mean_env_wait_ms": 0.13811943095410054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044214725494384766, "StateBufferConnector_ms": 0.0028592348098754883, "ViewRequirementAgentConnector_ms": 0.06373143196105957}, "num_episodes": 18, "episode_return_max": 46.65132278790402, "episode_return_min": -6.904881742727603, "episode_return_mean": 16.54030265475499, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.3207680451679, "num_env_steps_trained_throughput_per_sec": 433.3207680451679, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2220000, "timers": {"training_iteration_time_ms": 9008.387, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9008.341, "sample_time_ms": 822.573, "learn_time_ms": 8171.856, "learn_throughput": 489.485, "synch_weights_time_ms": 13.24}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "done": false, "training_iteration": 185, "trial_id": "06536_00000", "date": "2024-08-11_17-50-20", "timestamp": 1723413020, "time_this_iter_s": 9.238617897033691, "time_total_s": 4558.632163286209, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5915820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4558.632163286209, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 30.907692307692308, "ram_util_percent": 80.96923076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9310200795531274, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6701224826276302, "policy_loss": -0.007741757479379885, "vf_loss": 1.6778642383714517, "vf_explained_var": 0.9650155397132039, "kl": 0.006469895856888667, "entropy": 0.41533594594026607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.958119022026264, "cur_kl_coeff": 4.231779662960236e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3056550923478665, "policy_loss": -0.005178986185737861, "vf_loss": 2.3108340851844305, "vf_explained_var": 0.9564802505351879, "kl": 0.007572627203826322, "entropy": 0.33458443087717843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "env_runners": {"episode_reward_max": 46.65132278790402, "episode_reward_min": -4.622644203242503, "episode_reward_mean": 16.176112093824962, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -46.65132278790392, "predator_policy": -13.559845592614693}, "policy_reward_max": {"prey_policy": 4.622644203242503, "predator_policy": 55.59592798495504}, "policy_reward_mean": {"prey_policy": -16.176112093824962, "predator_policy": 16.17611209382496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0837617532282673, 32.36235563072945, 14.397070796248315, 22.067374584443463, 36.431354117795145, 1.3638515025350024, 15.719119166111916, 15.937258848164518, 19.995569040626428, 5.383550248107886, 13.428213580710612, 17.34651727720846, 20.594352907711862, 22.38643664149047, 15.766590564474985, 24.652712092891573, 20.93172667109251, 0.9668912056254735, 11.410098913506827, 22.493417849758462, 6.2812389833335684, 11.928732919714342, 46.65132278790402, 35.55494086626775, 22.650345053500427, 3.658913833121858, 12.194362840848717, 28.419735879567796, 20.112491978560502, 24.22059806323044, 17.20110862410791, 13.029862069245763, 11.59457427284656, 11.50764224043087, 3.8116663986083132, 11.474973771872286, 13.407743469042458, 5.243025846080937, 34.25363614641548, 14.133817724854723, 26.091734047477694, 19.1800968697962, 21.581018271473134, 29.9568993741252, 16.417219121221137, 6.239943361318599, 43.142440439244254, 17.55444994249169, 28.37337166598782, 3.969598010285643, 9.227243201453287, 18.054916701759197, 28.64087318815999, 28.771806032597635, 0.011064368039959582, 22.04715260318557, 11.138135945385441, 9.950234845904523, 31.18282783238909, 27.98073238236829, 20.575348739456512, 16.76333506470979, 22.080786756810003, 3.277769378257525, 18.005995258175766, 15.823792837601752, 2.4904395523519653, 25.58131204790239, 2.2837051418469807, 6.421658716852372, 9.808633582208227, 22.393388878190745, 13.832226677013463, 18.863489731511237, 16.225324230975204, 25.269490753208572, 22.696043353389765, 19.758291041959996, 16.442440778417136, -3.955376700129417, 8.154549206581613, 21.00384263651592, 44.63750390204852, 19.222087487808665, 8.354460957523962, 17.7232588973689, -4.622644203242503, 10.094411771640642, 6.093561419620773, 3.3350614582442386, 24.148179539139864, 13.784991916201582, -0.5426045579226244, 23.325569315630634, 9.760592377711442, 1.4867080584990129, 1.6538797584417546, 0.40861076734739576, 1.8871828134625845, 35.670718178939445], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.08376175322827, -32.36235563072945, -14.397070796248302, -22.067374584443442, -36.43135411779514, -1.3638515025350015, -15.719119166111916, -15.937258848164458, -19.995569040626446, -5.3835502481078885, -13.428213580710626, -17.346517277208402, -20.594352907711887, -22.386436641490473, -15.766590564474981, -24.652712092891555, -20.93172667109251, -0.9668912056254806, -11.410098913506797, -22.493417849758462, -6.281238983333602, -11.928732919714312, -46.65132278790392, -35.55494086626772, -22.650345053500402, -3.6589138331218516, -12.194362840848706, -28.419735879567796, -20.1124919785605, -24.22059806323045, -17.20110862410787, -13.029862069245755, -11.594574272846547, -11.50764224043088, -3.8116663986083044, -11.474973771872284, -13.40774346904246, -5.243025846080933, -34.2536361464154, -14.133817724854701, -26.091734047477715, -19.180096869796177, -21.58101827147316, -29.956899374125197, -16.41721912122111, -6.239943361318589, -43.1424404392442, -17.5544499424917, -28.373371665987833, -3.969598010285643, -9.227243201453302, -18.05491670175918, -28.640873188159944, -28.771806032597638, -0.011064368039956918, -22.047152603185616, -11.138135945385454, -9.950234845904522, -31.182827832389005, -27.980732382368267, -20.575348739456533, -16.7633350647098, -22.08078675680998, -3.2777693782575437, -18.005995258175766, -15.823792837601767, -2.4904395523519662, -25.581312047902426, -2.2837051418469834, -6.421658716852374, -9.808633582208232, -22.393388878190777, -13.832226677013411, -18.863489731511237, -16.2253242309752, -25.269490753208622, -22.696043353389776, -19.758291041959986, -16.44244077841715, 3.955376700129417, -8.154549206581608, -21.003842636515916, -44.637503902048586, -19.22208748780865, -8.354460957523964, -17.72325889736892, 4.622644203242503, -10.094411771640633, -6.093561419620781, -3.335061458244252, -24.148179539139836, -13.784991916201573, 0.5426045579226217, -23.325569315630574, -9.760592377711472, -1.4867080584989942, -1.6538797584418097, -0.40861076734738244, -1.8871828134625748, -35.67071817893949], "policy_predator_policy_reward": [-0.8128831401788172, -5.354640366277711, 20.448432709942914, 44.276278551516, 21.759796575784563, 7.034345016712059, 44.06115195059685, 0.07359721829003973, 40.72637679284218, 32.136331442748094, 13.371257217279837, -10.64355421220983, 5.391704747325338, 26.04653358489852, 25.12325309479849, 6.751264601530462, 11.493155315457981, 28.497982765794912, 14.525963743713854, -3.758863247498086, 24.68039611014457, 2.176031051276663, 5.505053004164065, 29.187981550252765, 31.616091213160146, 9.572614602263677, 7.328822352990674, 37.44405092999028, 17.659558945070934, 13.873622183879025, 22.83413446157964, 26.47128972420351, 36.21834831458253, 5.645105027602446, 7.085112366556828, -5.151329955305869, 20.038879154908745, 2.781318672104822, 24.191023294235155, 20.795812405281758, 3.5000022416643706, 9.062475725002836, -4.111718917359495, 27.969184756788145, 55.59592798495504, 37.706717590852946, 24.233561762609302, 46.87631996992615, 21.535086835826142, 23.7656032711747, -4.067373516192847, 11.385201182436568, 9.165966741195824, 15.222758940501587, 12.73507571427632, 44.10439604485928, 10.194446591072541, 30.03053736604848, 25.969351511049542, 22.47184461541132, 32.392131896598855, 2.010085351616919, 16.711568105741176, 9.348156032750346, 17.57775427282015, 5.611394272872964, 17.75400211814048, 5.261282362721263, 1.6069670020456552, 6.016365795170962, 13.319699355381509, 9.630248188363064, 22.155210041010054, 4.660276897074856, 4.408953520980659, 6.077098171181216, 33.719185628443505, 34.788086664387414, 11.086603245116489, 17.18103220459294, 34.67826626459518, 17.505201830360203, 25.119155101359436, 13.241038638232943, 9.567794523650143, 33.59424201929616, 17.548598566132885, 42.365200182117505, 12.89220022936757, 19.9422380130747, 10.385704704751682, 2.094182017885478, 37.48015633527641, 48.804724543212, 24.385297160178848, 10.723602724804554, 38.34217582173589, 18.40456751023977, 8.820250580073228, -0.8810545595019459, 11.993896864002199, 6.460589538904408, 29.993027000957298, 6.116806402561083, 12.804036847200514, 44.47770952911935, 38.78849247878204, 18.75511958641325, 4.98044340687401, -4.958314670794092, 13.267704506410304, 30.82660069996091, 15.514384280375529, 6.7618876103953625, -2.4700945635741594, 22.3705642553832, 41.668837857924956, 20.696817806853137, 18.969450331514427, 36.992014433222046, 16.62954788127071, 24.52114959764233, 30.852648188915005, 2.6740219405046144, 15.540751974154098, 28.62082153946588, 12.624130873540661, -6.0685921170255845, 5.459784746543811, 30.552205769807724, 18.23804938285552, 13.409536292348012, 0.905153803605689, 4.075725301098257, 22.989111835646796, 28.173512260158063, 4.670866572183179, -0.10345628848921251, -5.51972469959178, 18.36304213329653, 23.843875530961213, -4.226608366544735, 32.52108906731684, 12.265688689064682, 1.3976765907966797, 26.266776763230148, 24.79340233251719, 12.933577130505308, 12.461845623077224, 19.988802838873163, 36.338878709253514, 14.200102797163686, 25.52280647899972, 19.869280227779825, 4.348174866226974, 35.16840721769301, -0.15267874894771705, 33.03756030578204, -13.559845592614693, 5.649092192355877, -2.500099993349563, 18.809198406512802, 24.05244880362116, 17.955236469410657, 55.01643472342807, 34.25857308066904, 9.866402304988583, 28.577772670628754, 4.24964704682708, 12.459274868220824, 11.856438931182788, 23.590078863555043, 0.8435112240295037, -10.088799630514515, 6.1371053176308195, 14.05171822565044, 2.8749487536894502, 9.312174085552096, -1.5499894559051146, 8.220112372393631, 30.885676262880644, 17.410682815399042, 24.952403617951965, 2.617580214451186, 12.102631510424366, -13.187840626269615, 31.341617197978064, 15.309521433283145, -1.0227382593057648, 20.543923014728687, 9.26895665920209, -6.295540542204077, -4.048027908056338, 7.3557874249398765, 10.143547523771998, -9.326325989077208, -9.742656922935213, 13.517022549860334, 47.88504898792374, 23.456387369955166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5991200160513435, "mean_inference_ms": 1.5980353954879787, "mean_action_processing_ms": 0.24722563766135053, "mean_env_wait_ms": 0.13781004472351732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248380661010742, "StateBufferConnector_ms": 0.0028600692749023438, "ViewRequirementAgentConnector_ms": 0.06323325634002686}, "num_episodes": 18, "episode_return_max": 46.65132278790402, "episode_return_min": -4.622644203242503, "episode_return_mean": 16.176112093824962, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.01631274168614, "num_env_steps_trained_throughput_per_sec": 457.01631274168614, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2232000, "timers": {"training_iteration_time_ms": 9027.781, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9027.732, "sample_time_ms": 826.137, "learn_time_ms": 8187.567, "learn_throughput": 488.546, "synch_weights_time_ms": 13.351}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "done": false, "training_iteration": 186, "trial_id": "06536_00000", "date": "2024-08-11_17-50-29", "timestamp": 1723413029, "time_this_iter_s": 8.757218837738037, "time_total_s": 4567.389382123947, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5915b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4567.389382123947, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 22.99230769230769, "ram_util_percent": 80.58461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6553343224028745, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5808950260281562, "policy_loss": -0.007912949853440902, "vf_loss": 1.5888079710304737, "vf_explained_var": 0.9681411676729719, "kl": 0.008648916993339518, "entropy": 0.3499158814859887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.738185291883176, "cur_kl_coeff": 4.231779662960236e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9502691957054945, "policy_loss": -0.0006643918717388438, "vf_loss": 1.9509335908940229, "vf_explained_var": 0.9635404483035759, "kl": 0.0022854252208488017, "entropy": 0.2836522459904984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "env_runners": {"episode_reward_max": 44.63750390204852, "episode_reward_min": -8.969887124683883, "episode_reward_mean": 16.319692684054658, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.637503902048586, "predator_policy": -16.28282958372005}, "policy_reward_max": {"prey_policy": 8.969887124683881, "predator_policy": 55.01643472342807}, "policy_reward_mean": {"prey_policy": -16.319692684054658, "predator_policy": 16.319692684054658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.419735879567796, 20.112491978560502, 24.22059806323044, 17.20110862410791, 13.029862069245763, 11.59457427284656, 11.50764224043087, 3.8116663986083132, 11.474973771872286, 13.407743469042458, 5.243025846080937, 34.25363614641548, 14.133817724854723, 26.091734047477694, 19.1800968697962, 21.581018271473134, 29.9568993741252, 16.417219121221137, 6.239943361318599, 43.142440439244254, 17.55444994249169, 28.37337166598782, 3.969598010285643, 9.227243201453287, 18.054916701759197, 28.64087318815999, 28.771806032597635, 0.011064368039959582, 22.04715260318557, 11.138135945385441, 9.950234845904523, 31.18282783238909, 27.98073238236829, 20.575348739456512, 16.76333506470979, 22.080786756810003, 3.277769378257525, 18.005995258175766, 15.823792837601752, 2.4904395523519653, 25.58131204790239, 2.2837051418469807, 6.421658716852372, 9.808633582208227, 22.393388878190745, 13.832226677013463, 18.863489731511237, 16.225324230975204, 25.269490753208572, 22.696043353389765, 19.758291041959996, 16.442440778417136, -3.955376700129417, 8.154549206581613, 21.00384263651592, 44.63750390204852, 19.222087487808665, 8.354460957523962, 17.7232588973689, -4.622644203242503, 10.094411771640642, 6.093561419620773, 3.3350614582442386, 24.148179539139864, 13.784991916201582, -0.5426045579226244, 23.325569315630634, 9.760592377711442, 1.4867080584990129, 1.6538797584417546, 0.40861076734739576, 1.8871828134625845, 35.670718178939445, 12.909933507216637, 3.346417553333173, -8.101718972891447, 4.5190969462856785, 8.82692602251721, 20.318778087991397, 33.71586402548054, 23.869818668640605, 28.700790020334402, 38.66564101560798, 21.704278254853605, 16.17896764674826, 11.814903870885834, 15.906854751816446, 26.08520178707021, 8.92906837117788, 25.907388224181577, 36.567573305647, 31.383822661545114, 18.303054962549616, 10.836358587373109, 21.22862348913751, 3.989829643403442, 21.351028942898694, 26.24507554873063, -8.969887124683883, 29.594926395814497], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.419735879567796, -20.1124919785605, -24.22059806323045, -17.20110862410787, -13.029862069245755, -11.594574272846547, -11.50764224043088, -3.8116663986083044, -11.474973771872284, -13.40774346904246, -5.243025846080933, -34.2536361464154, -14.133817724854701, -26.091734047477715, -19.180096869796177, -21.58101827147316, -29.956899374125197, -16.41721912122111, -6.239943361318589, -43.1424404392442, -17.5544499424917, -28.373371665987833, -3.969598010285643, -9.227243201453302, -18.05491670175918, -28.640873188159944, -28.771806032597638, -0.011064368039956918, -22.047152603185616, -11.138135945385454, -9.950234845904522, -31.182827832389005, -27.980732382368267, -20.575348739456533, -16.7633350647098, -22.08078675680998, -3.2777693782575437, -18.005995258175766, -15.823792837601767, -2.4904395523519662, -25.581312047902426, -2.2837051418469834, -6.421658716852374, -9.808633582208232, -22.393388878190777, -13.832226677013411, -18.863489731511237, -16.2253242309752, -25.269490753208622, -22.696043353389776, -19.758291041959986, -16.44244077841715, 3.955376700129417, -8.154549206581608, -21.003842636515916, -44.637503902048586, -19.22208748780865, -8.354460957523964, -17.72325889736892, 4.622644203242503, -10.094411771640633, -6.093561419620781, -3.335061458244252, -24.148179539139836, -13.784991916201573, 0.5426045579226217, -23.325569315630574, -9.760592377711472, -1.4867080584989942, -1.6538797584418097, -0.40861076734738244, -1.8871828134625748, -35.67071817893949, -12.90993350721666, -3.346417553333164, 8.101718972891444, -4.5190969462856865, -8.826926022517172, -20.31877808799139, -33.71586402548055, -23.869818668640608, -28.700790020334416, -38.665641015607996, -21.704278254853598, -16.178967646748266, -11.814903870885818, -15.906854751816422, -26.08520178707021, -8.929068371177861, -25.907388224181627, -36.567573305646995, -31.383822661545118, -18.30305496254961, -10.836358587373121, -21.228623489137515, -3.9898296434034357, -21.3510289428987, -26.24507554873064, 8.969887124683881, -29.594926395814504], "policy_predator_policy_reward": [12.73507571427632, 44.10439604485928, 10.194446591072541, 30.03053736604848, 25.969351511049542, 22.47184461541132, 32.392131896598855, 2.010085351616919, 16.711568105741176, 9.348156032750346, 17.57775427282015, 5.611394272872964, 17.75400211814048, 5.261282362721263, 1.6069670020456552, 6.016365795170962, 13.319699355381509, 9.630248188363064, 22.155210041010054, 4.660276897074856, 4.408953520980659, 6.077098171181216, 33.719185628443505, 34.788086664387414, 11.086603245116489, 17.18103220459294, 34.67826626459518, 17.505201830360203, 25.119155101359436, 13.241038638232943, 9.567794523650143, 33.59424201929616, 17.548598566132885, 42.365200182117505, 12.89220022936757, 19.9422380130747, 10.385704704751682, 2.094182017885478, 37.48015633527641, 48.804724543212, 24.385297160178848, 10.723602724804554, 38.34217582173589, 18.40456751023977, 8.820250580073228, -0.8810545595019459, 11.993896864002199, 6.460589538904408, 29.993027000957298, 6.116806402561083, 12.804036847200514, 44.47770952911935, 38.78849247878204, 18.75511958641325, 4.98044340687401, -4.958314670794092, 13.267704506410304, 30.82660069996091, 15.514384280375529, 6.7618876103953625, -2.4700945635741594, 22.3705642553832, 41.668837857924956, 20.696817806853137, 18.969450331514427, 36.992014433222046, 16.62954788127071, 24.52114959764233, 30.852648188915005, 2.6740219405046144, 15.540751974154098, 28.62082153946588, 12.624130873540661, -6.0685921170255845, 5.459784746543811, 30.552205769807724, 18.23804938285552, 13.409536292348012, 0.905153803605689, 4.075725301098257, 22.989111835646796, 28.173512260158063, 4.670866572183179, -0.10345628848921251, -5.51972469959178, 18.36304213329653, 23.843875530961213, -4.226608366544735, 32.52108906731684, 12.265688689064682, 1.3976765907966797, 26.266776763230148, 24.79340233251719, 12.933577130505308, 12.461845623077224, 19.988802838873163, 36.338878709253514, 14.200102797163686, 25.52280647899972, 19.869280227779825, 4.348174866226974, 35.16840721769301, -0.15267874894771705, 33.03756030578204, -13.559845592614693, 5.649092192355877, -2.500099993349563, 18.809198406512802, 24.05244880362116, 17.955236469410657, 55.01643472342807, 34.25857308066904, 9.866402304988583, 28.577772670628754, 4.24964704682708, 12.459274868220824, 11.856438931182788, 23.590078863555043, 0.8435112240295037, -10.088799630514515, 6.1371053176308195, 14.05171822565044, 2.8749487536894502, 9.312174085552096, -1.5499894559051146, 8.220112372393631, 30.885676262880644, 17.410682815399042, 24.952403617951965, 2.617580214451186, 12.102631510424366, -13.187840626269615, 31.341617197978064, 15.309521433283145, -1.0227382593057648, 20.543923014728687, 9.26895665920209, -6.295540542204077, -4.048027908056338, 7.3557874249398765, 10.143547523771998, -9.326325989077208, -9.742656922935213, 13.517022549860334, 47.88504898792374, 23.456387369955166, 7.40803910244783, 18.411827911985483, 5.715716785030667, 0.9771183216356727, -5.221058020525248, -10.982379925257645, -3.4217562025453017, 12.459950095116671, 33.93668162875442, -16.28282958372005, 14.36334206150556, 26.274214114477246, 18.195519211644587, 49.236208839316504, 31.662664053710387, 16.076973283570826, 42.12655874262573, 15.275021298043104, 34.92671356892337, 42.40456846229264, 20.075771994237336, 23.33278451546984, 21.060818485753835, 11.297116807742686, -0.4621880576175377, 24.091995799389167, 23.868391678229518, 7.945317825403345, 23.969195052734985, 28.201208521405427, 2.860921568587731, 14.997215173767998, 33.07677431047936, 18.738002137883875, 33.121506463451425, 40.01364014784259, 42.523984153385406, 20.243661169704858, 6.244663234144969, 30.36144669095429, -0.19765402602695037, 21.870371200773185, 40.4694311623685, 1.9878158159065187, -3.6973887941006023, 11.677048080907458, 17.827143321029617, 24.87491456476777, 29.48270386996469, 23.00744722749656, -10.736546279159846, -7.2032279702079265, 13.917695678780857, 45.27215711284811]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5969704653302117, "mean_inference_ms": 1.5903646125784754, "mean_action_processing_ms": 0.246183258129522, "mean_env_wait_ms": 0.137147863493308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003656148910522461, "StateBufferConnector_ms": 0.0028247833251953125, "ViewRequirementAgentConnector_ms": 0.06327712535858154}, "num_episodes": 27, "episode_return_max": 44.63750390204852, "episode_return_min": -8.969887124683883, "episode_return_mean": 16.319692684054658, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.30419422380686, "num_env_steps_trained_throughput_per_sec": 446.30419422380686, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2244000, "timers": {"training_iteration_time_ms": 9030.742, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9030.693, "sample_time_ms": 828.984, "learn_time_ms": 8187.406, "learn_throughput": 488.555, "synch_weights_time_ms": 13.635}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "done": false, "training_iteration": 187, "trial_id": "06536_00000", "date": "2024-08-11_17-50-38", "timestamp": 1723413038, "time_this_iter_s": 8.96718692779541, "time_total_s": 4576.356569051743, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5915af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4576.356569051743, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 24.56153846153846, "ram_util_percent": 80.43076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6131530315925677, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5426186320682367, "policy_loss": -0.008883541220954309, "vf_loss": 1.551502170599997, "vf_explained_var": 0.9659102321912845, "kl": 0.00788442354145178, "entropy": 0.35569665490960084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.805464120642849, "cur_kl_coeff": 2.115889831480118e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9957862920231288, "policy_loss": -0.002762479848036217, "vf_loss": 1.9985487733568463, "vf_explained_var": 0.9547338149850331, "kl": 0.004362121453810782, "entropy": 0.3097173347438454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 44.63750390204852, "episode_reward_min": -8.969887124683883, "episode_reward_mean": 15.526621235021816, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.637503902048586, "predator_policy": -16.28282958372005}, "policy_reward_max": {"prey_policy": 8.969887124683881, "predator_policy": 55.01643472342807}, "policy_reward_mean": {"prey_policy": -15.52662123502182, "predator_policy": 15.526621235021816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.239943361318599, 43.142440439244254, 17.55444994249169, 28.37337166598782, 3.969598010285643, 9.227243201453287, 18.054916701759197, 28.64087318815999, 28.771806032597635, 0.011064368039959582, 22.04715260318557, 11.138135945385441, 9.950234845904523, 31.18282783238909, 27.98073238236829, 20.575348739456512, 16.76333506470979, 22.080786756810003, 3.277769378257525, 18.005995258175766, 15.823792837601752, 2.4904395523519653, 25.58131204790239, 2.2837051418469807, 6.421658716852372, 9.808633582208227, 22.393388878190745, 13.832226677013463, 18.863489731511237, 16.225324230975204, 25.269490753208572, 22.696043353389765, 19.758291041959996, 16.442440778417136, -3.955376700129417, 8.154549206581613, 21.00384263651592, 44.63750390204852, 19.222087487808665, 8.354460957523962, 17.7232588973689, -4.622644203242503, 10.094411771640642, 6.093561419620773, 3.3350614582442386, 24.148179539139864, 13.784991916201582, -0.5426045579226244, 23.325569315630634, 9.760592377711442, 1.4867080584990129, 1.6538797584417546, 0.40861076734739576, 1.8871828134625845, 35.670718178939445, 12.909933507216637, 3.346417553333173, -8.101718972891447, 4.5190969462856785, 8.82692602251721, 20.318778087991397, 33.71586402548054, 23.869818668640605, 28.700790020334402, 38.66564101560798, 21.704278254853605, 16.17896764674826, 11.814903870885834, 15.906854751816446, 26.08520178707021, 8.92906837117788, 25.907388224181577, 36.567573305647, 31.383822661545114, 18.303054962549616, 10.836358587373109, 21.22862348913751, 3.989829643403442, 21.351028942898694, 26.24507554873063, -8.969887124683883, 29.594926395814497, 20.707176215971796, 19.31393088053877, 8.109396618679249, 36.824333166102825, 7.104460913309606, 7.101785367599354, 8.473872807472507, 23.107738161191598, 5.628365034402093, 14.371282942844129, 19.47372916443573, 22.03177233284041, 25.598670322120928, -1.2160372631494791, 11.236054117265734, 5.639906511972074, -2.0615899725086315, 10.8858519445845], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.239943361318589, -43.1424404392442, -17.5544499424917, -28.373371665987833, -3.969598010285643, -9.227243201453302, -18.05491670175918, -28.640873188159944, -28.771806032597638, -0.011064368039956918, -22.047152603185616, -11.138135945385454, -9.950234845904522, -31.182827832389005, -27.980732382368267, -20.575348739456533, -16.7633350647098, -22.08078675680998, -3.2777693782575437, -18.005995258175766, -15.823792837601767, -2.4904395523519662, -25.581312047902426, -2.2837051418469834, -6.421658716852374, -9.808633582208232, -22.393388878190777, -13.832226677013411, -18.863489731511237, -16.2253242309752, -25.269490753208622, -22.696043353389776, -19.758291041959986, -16.44244077841715, 3.955376700129417, -8.154549206581608, -21.003842636515916, -44.637503902048586, -19.22208748780865, -8.354460957523964, -17.72325889736892, 4.622644203242503, -10.094411771640633, -6.093561419620781, -3.335061458244252, -24.148179539139836, -13.784991916201573, 0.5426045579226217, -23.325569315630574, -9.760592377711472, -1.4867080584989942, -1.6538797584418097, -0.40861076734738244, -1.8871828134625748, -35.67071817893949, -12.90993350721666, -3.346417553333164, 8.101718972891444, -4.5190969462856865, -8.826926022517172, -20.31877808799139, -33.71586402548055, -23.869818668640608, -28.700790020334416, -38.665641015607996, -21.704278254853598, -16.178967646748266, -11.814903870885818, -15.906854751816422, -26.08520178707021, -8.929068371177861, -25.907388224181627, -36.567573305646995, -31.383822661545118, -18.30305496254961, -10.836358587373121, -21.228623489137515, -3.9898296434034357, -21.3510289428987, -26.24507554873064, 8.969887124683881, -29.594926395814504, -20.707176215971792, -19.31393088053877, -8.109396618679245, -36.82433316610281, -7.104460913309593, -7.101785367599348, -8.473872807472489, -23.107738161191612, -5.628365034402085, -14.371282942844125, -19.473729164435735, -22.031772332840408, -25.59867032212096, 1.2160372631494791, -11.236054117265727, -5.6399065119720735, 2.0615899725086546, -10.88585194458448], "policy_predator_policy_reward": [10.385704704751682, 2.094182017885478, 37.48015633527641, 48.804724543212, 24.385297160178848, 10.723602724804554, 38.34217582173589, 18.40456751023977, 8.820250580073228, -0.8810545595019459, 11.993896864002199, 6.460589538904408, 29.993027000957298, 6.116806402561083, 12.804036847200514, 44.47770952911935, 38.78849247878204, 18.75511958641325, 4.98044340687401, -4.958314670794092, 13.267704506410304, 30.82660069996091, 15.514384280375529, 6.7618876103953625, -2.4700945635741594, 22.3705642553832, 41.668837857924956, 20.696817806853137, 18.969450331514427, 36.992014433222046, 16.62954788127071, 24.52114959764233, 30.852648188915005, 2.6740219405046144, 15.540751974154098, 28.62082153946588, 12.624130873540661, -6.0685921170255845, 5.459784746543811, 30.552205769807724, 18.23804938285552, 13.409536292348012, 0.905153803605689, 4.075725301098257, 22.989111835646796, 28.173512260158063, 4.670866572183179, -0.10345628848921251, -5.51972469959178, 18.36304213329653, 23.843875530961213, -4.226608366544735, 32.52108906731684, 12.265688689064682, 1.3976765907966797, 26.266776763230148, 24.79340233251719, 12.933577130505308, 12.461845623077224, 19.988802838873163, 36.338878709253514, 14.200102797163686, 25.52280647899972, 19.869280227779825, 4.348174866226974, 35.16840721769301, -0.15267874894771705, 33.03756030578204, -13.559845592614693, 5.649092192355877, -2.500099993349563, 18.809198406512802, 24.05244880362116, 17.955236469410657, 55.01643472342807, 34.25857308066904, 9.866402304988583, 28.577772670628754, 4.24964704682708, 12.459274868220824, 11.856438931182788, 23.590078863555043, 0.8435112240295037, -10.088799630514515, 6.1371053176308195, 14.05171822565044, 2.8749487536894502, 9.312174085552096, -1.5499894559051146, 8.220112372393631, 30.885676262880644, 17.410682815399042, 24.952403617951965, 2.617580214451186, 12.102631510424366, -13.187840626269615, 31.341617197978064, 15.309521433283145, -1.0227382593057648, 20.543923014728687, 9.26895665920209, -6.295540542204077, -4.048027908056338, 7.3557874249398765, 10.143547523771998, -9.326325989077208, -9.742656922935213, 13.517022549860334, 47.88504898792374, 23.456387369955166, 7.40803910244783, 18.411827911985483, 5.715716785030667, 0.9771183216356727, -5.221058020525248, -10.982379925257645, -3.4217562025453017, 12.459950095116671, 33.93668162875442, -16.28282958372005, 14.36334206150556, 26.274214114477246, 18.195519211644587, 49.236208839316504, 31.662664053710387, 16.076973283570826, 42.12655874262573, 15.275021298043104, 34.92671356892337, 42.40456846229264, 20.075771994237336, 23.33278451546984, 21.060818485753835, 11.297116807742686, -0.4621880576175377, 24.091995799389167, 23.868391678229518, 7.945317825403345, 23.969195052734985, 28.201208521405427, 2.860921568587731, 14.997215173767998, 33.07677431047936, 18.738002137883875, 33.121506463451425, 40.01364014784259, 42.523984153385406, 20.243661169704858, 6.244663234144969, 30.36144669095429, -0.19765402602695037, 21.870371200773185, 40.4694311623685, 1.9878158159065187, -3.6973887941006023, 11.677048080907458, 17.827143321029617, 24.87491456476777, 29.48270386996469, 23.00744722749656, -10.736546279159846, -7.2032279702079265, 13.917695678780857, 45.27215711284811, 27.91453895130655, 13.499813480637007, 13.161972278861075, 25.46588948221647, -6.526402199183796, 22.745195436542296, 33.55879781071803, 40.08986852148761, 18.21316886995016, -4.00424704333097, 9.202113876448003, 5.0014568587506965, 10.54656076086929, 6.40118485407571, 38.113763883559706, 8.101712438823533, -9.195702144996709, 20.45243221380086, 12.00270052374761, 16.739865361940655, 25.10054531559219, 13.84691301327927, 13.003234695385009, 31.060309970295826, 18.156979906097607, 33.0403607381443, 3.7503825516724802, -6.182457077971446, 8.072685723851079, 14.399422510680392, -0.033316805556005136, 11.313129829500161, 0.4178114948556999, -4.540991439872988, 9.894548063663992, 11.877155825504989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5963716308548785, "mean_inference_ms": 1.5899151893802073, "mean_action_processing_ms": 0.24616318653629915, "mean_env_wait_ms": 0.1370566404872195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003277897834777832, "StateBufferConnector_ms": 0.0027881860733032227, "ViewRequirementAgentConnector_ms": 0.062332987785339355}, "num_episodes": 18, "episode_return_max": 44.63750390204852, "episode_return_min": -8.969887124683883, "episode_return_mean": 15.526621235021816, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.520788200195, "num_env_steps_trained_throughput_per_sec": 455.520788200195, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 8840.548, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8840.507, "sample_time_ms": 820.818, "learn_time_ms": 8006.969, "learn_throughput": 499.565, "synch_weights_time_ms": 12.314}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 188, "trial_id": "06536_00000", "date": "2024-08-11_17-50-46", "timestamp": 1723413046, "time_this_iter_s": 8.785547971725464, "time_total_s": 4585.142117023468, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58fcf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4585.142117023468, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 25.941666666666663, "ram_util_percent": 80.39166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1660863686352965, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9994188535958528, "policy_loss": -0.01284365803876426, "vf_loss": 2.012262511625886, "vf_explained_var": 0.9559141581257184, "kl": 0.012122572547505032, "entropy": 0.37080057732140026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.099224893882792, "cur_kl_coeff": 1.057944915740059e-38, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4015459641577706, "policy_loss": -0.002835082380032098, "vf_loss": 2.404381045084151, "vf_explained_var": 0.9503931427758837, "kl": 0.004282455705047981, "entropy": 0.31825066061404644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "env_runners": {"episode_reward_max": 44.63750390204852, "episode_reward_min": -8.969887124683883, "episode_reward_mean": 15.018489176871144, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -44.637503902048586, "predator_policy": -16.28282958372005}, "policy_reward_max": {"prey_policy": 8.969887124683881, "predator_policy": 55.01643472342807}, "policy_reward_mean": {"prey_policy": -15.018489176871146, "predator_policy": 15.018489176871144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.277769378257525, 18.005995258175766, 15.823792837601752, 2.4904395523519653, 25.58131204790239, 2.2837051418469807, 6.421658716852372, 9.808633582208227, 22.393388878190745, 13.832226677013463, 18.863489731511237, 16.225324230975204, 25.269490753208572, 22.696043353389765, 19.758291041959996, 16.442440778417136, -3.955376700129417, 8.154549206581613, 21.00384263651592, 44.63750390204852, 19.222087487808665, 8.354460957523962, 17.7232588973689, -4.622644203242503, 10.094411771640642, 6.093561419620773, 3.3350614582442386, 24.148179539139864, 13.784991916201582, -0.5426045579226244, 23.325569315630634, 9.760592377711442, 1.4867080584990129, 1.6538797584417546, 0.40861076734739576, 1.8871828134625845, 35.670718178939445, 12.909933507216637, 3.346417553333173, -8.101718972891447, 4.5190969462856785, 8.82692602251721, 20.318778087991397, 33.71586402548054, 23.869818668640605, 28.700790020334402, 38.66564101560798, 21.704278254853605, 16.17896764674826, 11.814903870885834, 15.906854751816446, 26.08520178707021, 8.92906837117788, 25.907388224181577, 36.567573305647, 31.383822661545114, 18.303054962549616, 10.836358587373109, 21.22862348913751, 3.989829643403442, 21.351028942898694, 26.24507554873063, -8.969887124683883, 29.594926395814497, 20.707176215971796, 19.31393088053877, 8.109396618679249, 36.824333166102825, 7.104460913309606, 7.101785367599354, 8.473872807472507, 23.107738161191598, 5.628365034402093, 14.371282942844129, 19.47372916443573, 22.03177233284041, 25.598670322120928, -1.2160372631494791, 11.236054117265734, 5.639906511972074, -2.0615899725086315, 10.8858519445845, 36.160906984213234, 24.436182062830362, 27.424219195462754, 15.384957385953443, 17.716931517039633, 21.55456838284427, 9.832598996913166, 25.891945102568453, 14.933588238260802, 12.472556762336763, 17.462136782423016, 8.862019191774527, 8.574510297734179, 3.4257449394598956, 3.7644703998122715, 31.217356825085922, 10.25394751013708, 5.522414691630005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.2777693782575437, -18.005995258175766, -15.823792837601767, -2.4904395523519662, -25.581312047902426, -2.2837051418469834, -6.421658716852374, -9.808633582208232, -22.393388878190777, -13.832226677013411, -18.863489731511237, -16.2253242309752, -25.269490753208622, -22.696043353389776, -19.758291041959986, -16.44244077841715, 3.955376700129417, -8.154549206581608, -21.003842636515916, -44.637503902048586, -19.22208748780865, -8.354460957523964, -17.72325889736892, 4.622644203242503, -10.094411771640633, -6.093561419620781, -3.335061458244252, -24.148179539139836, -13.784991916201573, 0.5426045579226217, -23.325569315630574, -9.760592377711472, -1.4867080584989942, -1.6538797584418097, -0.40861076734738244, -1.8871828134625748, -35.67071817893949, -12.90993350721666, -3.346417553333164, 8.101718972891444, -4.5190969462856865, -8.826926022517172, -20.31877808799139, -33.71586402548055, -23.869818668640608, -28.700790020334416, -38.665641015607996, -21.704278254853598, -16.178967646748266, -11.814903870885818, -15.906854751816422, -26.08520178707021, -8.929068371177861, -25.907388224181627, -36.567573305646995, -31.383822661545118, -18.30305496254961, -10.836358587373121, -21.228623489137515, -3.9898296434034357, -21.3510289428987, -26.24507554873064, 8.969887124683881, -29.594926395814504, -20.707176215971792, -19.31393088053877, -8.109396618679245, -36.82433316610281, -7.104460913309593, -7.101785367599348, -8.473872807472489, -23.107738161191612, -5.628365034402085, -14.371282942844125, -19.473729164435735, -22.031772332840408, -25.59867032212096, 1.2160372631494791, -11.236054117265727, -5.6399065119720735, 2.0615899725086546, -10.88585194458448, -36.1609069842133, -24.436182062830397, -27.424219195462715, -15.384957385953417, -17.71693151703963, -21.55456838284426, -9.832598996913172, -25.891945102568453, -14.9335882382608, -12.472556762336758, -17.462136782423013, -8.86201919177456, -8.574510297734234, -3.4257449394599, -3.764470399812274, -31.217356825085947, -10.253947510137074, -5.522414691630015], "policy_predator_policy_reward": [12.624130873540661, -6.0685921170255845, 5.459784746543811, 30.552205769807724, 18.23804938285552, 13.409536292348012, 0.905153803605689, 4.075725301098257, 22.989111835646796, 28.173512260158063, 4.670866572183179, -0.10345628848921251, -5.51972469959178, 18.36304213329653, 23.843875530961213, -4.226608366544735, 32.52108906731684, 12.265688689064682, 1.3976765907966797, 26.266776763230148, 24.79340233251719, 12.933577130505308, 12.461845623077224, 19.988802838873163, 36.338878709253514, 14.200102797163686, 25.52280647899972, 19.869280227779825, 4.348174866226974, 35.16840721769301, -0.15267874894771705, 33.03756030578204, -13.559845592614693, 5.649092192355877, -2.500099993349563, 18.809198406512802, 24.05244880362116, 17.955236469410657, 55.01643472342807, 34.25857308066904, 9.866402304988583, 28.577772670628754, 4.24964704682708, 12.459274868220824, 11.856438931182788, 23.590078863555043, 0.8435112240295037, -10.088799630514515, 6.1371053176308195, 14.05171822565044, 2.8749487536894502, 9.312174085552096, -1.5499894559051146, 8.220112372393631, 30.885676262880644, 17.410682815399042, 24.952403617951965, 2.617580214451186, 12.102631510424366, -13.187840626269615, 31.341617197978064, 15.309521433283145, -1.0227382593057648, 20.543923014728687, 9.26895665920209, -6.295540542204077, -4.048027908056338, 7.3557874249398765, 10.143547523771998, -9.326325989077208, -9.742656922935213, 13.517022549860334, 47.88504898792374, 23.456387369955166, 7.40803910244783, 18.411827911985483, 5.715716785030667, 0.9771183216356727, -5.221058020525248, -10.982379925257645, -3.4217562025453017, 12.459950095116671, 33.93668162875442, -16.28282958372005, 14.36334206150556, 26.274214114477246, 18.195519211644587, 49.236208839316504, 31.662664053710387, 16.076973283570826, 42.12655874262573, 15.275021298043104, 34.92671356892337, 42.40456846229264, 20.075771994237336, 23.33278451546984, 21.060818485753835, 11.297116807742686, -0.4621880576175377, 24.091995799389167, 23.868391678229518, 7.945317825403345, 23.969195052734985, 28.201208521405427, 2.860921568587731, 14.997215173767998, 33.07677431047936, 18.738002137883875, 33.121506463451425, 40.01364014784259, 42.523984153385406, 20.243661169704858, 6.244663234144969, 30.36144669095429, -0.19765402602695037, 21.870371200773185, 40.4694311623685, 1.9878158159065187, -3.6973887941006023, 11.677048080907458, 17.827143321029617, 24.87491456476777, 29.48270386996469, 23.00744722749656, -10.736546279159846, -7.2032279702079265, 13.917695678780857, 45.27215711284811, 27.91453895130655, 13.499813480637007, 13.161972278861075, 25.46588948221647, -6.526402199183796, 22.745195436542296, 33.55879781071803, 40.08986852148761, 18.21316886995016, -4.00424704333097, 9.202113876448003, 5.0014568587506965, 10.54656076086929, 6.40118485407571, 38.113763883559706, 8.101712438823533, -9.195702144996709, 20.45243221380086, 12.00270052374761, 16.739865361940655, 25.10054531559219, 13.84691301327927, 13.003234695385009, 31.060309970295826, 18.156979906097607, 33.0403607381443, 3.7503825516724802, -6.182457077971446, 8.072685723851079, 14.399422510680392, -0.033316805556005136, 11.313129829500161, 0.4178114948556999, -4.540991439872988, 9.894548063663992, 11.877155825504989, 41.963903319227654, 30.35791064919895, 34.459822984379414, 14.412541141281409, 22.000955554992835, 32.84748283593259, 23.68187585580067, 7.088038916106196, 8.664994676394947, 26.768868357684305, 14.573349522248751, 28.53578724343977, 13.15430645588025, 6.510891537946083, 35.27833060177645, 16.505559603360467, 10.696286885666542, 19.170889590855055, 4.329221066792485, 20.615892457881046, 24.461854784720032, 10.462418780125997, 8.597265654858477, 9.126772728690607, -2.493443739576609, 19.64246433504507, 2.1804914037238134, 4.67099847519599, 0.04358702745969101, 7.48535377216484, 23.837946501320896, 38.59676714885093, 16.204909030622066, 4.302985989652073, 11.548509619771867, -0.5036802365118458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5952752552834282, "mean_inference_ms": 1.5866786202786, "mean_action_processing_ms": 0.2457384402478611, "mean_env_wait_ms": 0.13674879104669324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003018021583557129, "StateBufferConnector_ms": 0.0028148889541625977, "ViewRequirementAgentConnector_ms": 0.06271994113922119}, "num_episodes": 18, "episode_return_max": 44.63750390204852, "episode_return_min": -8.969887124683883, "episode_return_mean": 15.018489176871144, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.48053495697314, "num_env_steps_trained_throughput_per_sec": 473.48053495697314, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 2268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2268000, "timers": {"training_iteration_time_ms": 8767.733, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8767.696, "sample_time_ms": 780.474, "learn_time_ms": 7974.737, "learn_throughput": 501.584, "synch_weights_time_ms": 12.08}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "done": false, "training_iteration": 189, "trial_id": "06536_00000", "date": "2024-08-11_17-50-55", "timestamp": 1723413055, "time_this_iter_s": 8.451875925064087, "time_total_s": 4593.593992948532, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b589a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4593.593992948532, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 23.108333333333334, "ram_util_percent": 80.60833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9822190552949905, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8152971635262172, "policy_loss": -0.005790608610792939, "vf_loss": 1.8210877628996969, "vf_explained_var": 0.953569192936023, "kl": 0.005997651107696341, "entropy": 0.35132508175447585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.166258202406464, "cur_kl_coeff": 5.289724578700295e-39, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.50339628388642, "policy_loss": -0.0025665002187625283, "vf_loss": 2.505962785589632, "vf_explained_var": 0.9361207430324857, "kl": 0.004128983193883005, "entropy": 0.30643049724518306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 51.08711556378477, "episode_reward_min": -8.969887124683883, "episode_reward_mean": 16.259668975117492, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.08711556378475, "predator_policy": -16.28282958372005}, "policy_reward_max": {"prey_policy": 8.969887124683881, "predator_policy": 55.01643472342807}, "policy_reward_mean": {"prey_policy": -16.259668975117496, "predator_policy": 16.259668975117496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.00384263651592, 44.63750390204852, 19.222087487808665, 8.354460957523962, 17.7232588973689, -4.622644203242503, 10.094411771640642, 6.093561419620773, 3.3350614582442386, 24.148179539139864, 13.784991916201582, -0.5426045579226244, 23.325569315630634, 9.760592377711442, 1.4867080584990129, 1.6538797584417546, 0.40861076734739576, 1.8871828134625845, 35.670718178939445, 12.909933507216637, 3.346417553333173, -8.101718972891447, 4.5190969462856785, 8.82692602251721, 20.318778087991397, 33.71586402548054, 23.869818668640605, 28.700790020334402, 38.66564101560798, 21.704278254853605, 16.17896764674826, 11.814903870885834, 15.906854751816446, 26.08520178707021, 8.92906837117788, 25.907388224181577, 36.567573305647, 31.383822661545114, 18.303054962549616, 10.836358587373109, 21.22862348913751, 3.989829643403442, 21.351028942898694, 26.24507554873063, -8.969887124683883, 29.594926395814497, 20.707176215971796, 19.31393088053877, 8.109396618679249, 36.824333166102825, 7.104460913309606, 7.101785367599354, 8.473872807472507, 23.107738161191598, 5.628365034402093, 14.371282942844129, 19.47372916443573, 22.03177233284041, 25.598670322120928, -1.2160372631494791, 11.236054117265734, 5.639906511972074, -2.0615899725086315, 10.8858519445845, 36.160906984213234, 24.436182062830362, 27.424219195462754, 15.384957385953443, 17.716931517039633, 21.55456838284427, 9.832598996913166, 25.891945102568453, 14.933588238260802, 12.472556762336763, 17.462136782423016, 8.862019191774527, 8.574510297734179, 3.4257449394598956, 3.7644703998122715, 31.217356825085922, 10.25394751013708, 5.522414691630005, 32.39692313098291, 20.24595242873698, 13.42655934121187, 0.6368046983602005, 12.674083206515785, 8.007990705589519, 47.24842861571876, 18.107952322162436, 12.08044703850534, 51.08711556378477, 17.27087214166208, 11.097440493689074, 20.870165794996137, 25.351355323175227, 23.0950363671974, 12.827983550467398, 29.327095444000207, 11.738948124194247], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.003842636515916, -44.637503902048586, -19.22208748780865, -8.354460957523964, -17.72325889736892, 4.622644203242503, -10.094411771640633, -6.093561419620781, -3.335061458244252, -24.148179539139836, -13.784991916201573, 0.5426045579226217, -23.325569315630574, -9.760592377711472, -1.4867080584989942, -1.6538797584418097, -0.40861076734738244, -1.8871828134625748, -35.67071817893949, -12.90993350721666, -3.346417553333164, 8.101718972891444, -4.5190969462856865, -8.826926022517172, -20.31877808799139, -33.71586402548055, -23.869818668640608, -28.700790020334416, -38.665641015607996, -21.704278254853598, -16.178967646748266, -11.814903870885818, -15.906854751816422, -26.08520178707021, -8.929068371177861, -25.907388224181627, -36.567573305646995, -31.383822661545118, -18.30305496254961, -10.836358587373121, -21.228623489137515, -3.9898296434034357, -21.3510289428987, -26.24507554873064, 8.969887124683881, -29.594926395814504, -20.707176215971792, -19.31393088053877, -8.109396618679245, -36.82433316610281, -7.104460913309593, -7.101785367599348, -8.473872807472489, -23.107738161191612, -5.628365034402085, -14.371282942844125, -19.473729164435735, -22.031772332840408, -25.59867032212096, 1.2160372631494791, -11.236054117265727, -5.6399065119720735, 2.0615899725086546, -10.88585194458448, -36.1609069842133, -24.436182062830397, -27.424219195462715, -15.384957385953417, -17.71693151703963, -21.55456838284426, -9.832598996913172, -25.891945102568453, -14.9335882382608, -12.472556762336758, -17.462136782423013, -8.86201919177456, -8.574510297734234, -3.4257449394599, -3.764470399812274, -31.217356825085947, -10.253947510137074, -5.522414691630015, -32.3969231309829, -20.245952428736985, -13.426559341211904, -0.6368046983602103, -12.674083206515775, -8.007990705589517, -47.24842861571874, -18.10795232216244, -12.080447038505344, -51.08711556378475, -17.270872141662142, -11.09744049368909, -20.87016579499614, -25.351355323175287, -23.09503636719741, -12.827983550467396, -29.327095444000182, -11.73894812419423], "policy_predator_policy_reward": [24.05244880362116, 17.955236469410657, 55.01643472342807, 34.25857308066904, 9.866402304988583, 28.577772670628754, 4.24964704682708, 12.459274868220824, 11.856438931182788, 23.590078863555043, 0.8435112240295037, -10.088799630514515, 6.1371053176308195, 14.05171822565044, 2.8749487536894502, 9.312174085552096, -1.5499894559051146, 8.220112372393631, 30.885676262880644, 17.410682815399042, 24.952403617951965, 2.617580214451186, 12.102631510424366, -13.187840626269615, 31.341617197978064, 15.309521433283145, -1.0227382593057648, 20.543923014728687, 9.26895665920209, -6.295540542204077, -4.048027908056338, 7.3557874249398765, 10.143547523771998, -9.326325989077208, -9.742656922935213, 13.517022549860334, 47.88504898792374, 23.456387369955166, 7.40803910244783, 18.411827911985483, 5.715716785030667, 0.9771183216356727, -5.221058020525248, -10.982379925257645, -3.4217562025453017, 12.459950095116671, 33.93668162875442, -16.28282958372005, 14.36334206150556, 26.274214114477246, 18.195519211644587, 49.236208839316504, 31.662664053710387, 16.076973283570826, 42.12655874262573, 15.275021298043104, 34.92671356892337, 42.40456846229264, 20.075771994237336, 23.33278451546984, 21.060818485753835, 11.297116807742686, -0.4621880576175377, 24.091995799389167, 23.868391678229518, 7.945317825403345, 23.969195052734985, 28.201208521405427, 2.860921568587731, 14.997215173767998, 33.07677431047936, 18.738002137883875, 33.121506463451425, 40.01364014784259, 42.523984153385406, 20.243661169704858, 6.244663234144969, 30.36144669095429, -0.19765402602695037, 21.870371200773185, 40.4694311623685, 1.9878158159065187, -3.6973887941006023, 11.677048080907458, 17.827143321029617, 24.87491456476777, 29.48270386996469, 23.00744722749656, -10.736546279159846, -7.2032279702079265, 13.917695678780857, 45.27215711284811, 27.91453895130655, 13.499813480637007, 13.161972278861075, 25.46588948221647, -6.526402199183796, 22.745195436542296, 33.55879781071803, 40.08986852148761, 18.21316886995016, -4.00424704333097, 9.202113876448003, 5.0014568587506965, 10.54656076086929, 6.40118485407571, 38.113763883559706, 8.101712438823533, -9.195702144996709, 20.45243221380086, 12.00270052374761, 16.739865361940655, 25.10054531559219, 13.84691301327927, 13.003234695385009, 31.060309970295826, 18.156979906097607, 33.0403607381443, 3.7503825516724802, -6.182457077971446, 8.072685723851079, 14.399422510680392, -0.033316805556005136, 11.313129829500161, 0.4178114948556999, -4.540991439872988, 9.894548063663992, 11.877155825504989, 41.963903319227654, 30.35791064919895, 34.459822984379414, 14.412541141281409, 22.000955554992835, 32.84748283593259, 23.68187585580067, 7.088038916106196, 8.664994676394947, 26.768868357684305, 14.573349522248751, 28.53578724343977, 13.15430645588025, 6.510891537946083, 35.27833060177645, 16.505559603360467, 10.696286885666542, 19.170889590855055, 4.329221066792485, 20.615892457881046, 24.461854784720032, 10.462418780125997, 8.597265654858477, 9.126772728690607, -2.493443739576609, 19.64246433504507, 2.1804914037238134, 4.67099847519599, 0.04358702745969101, 7.48535377216484, 23.837946501320896, 38.59676714885093, 16.204909030622066, 4.302985989652073, 11.548509619771867, -0.5036802365118458, 33.39884933963851, 31.394996922327287, 38.63802474421606, 1.8538801132579117, 23.67534500227731, 3.1777736801464904, -10.516649799857989, 11.790259196578395, 22.878192651652128, 2.4699737613794444, 7.62644619228152, 8.389535218897523, 49.68623014852277, 44.81062708291469, 25.959376463303357, 10.256528181021498, 13.514398639455237, 10.646495437555451, 52.951174071407344, 49.22305705616216, 42.31271533727799, -7.770971053953769, 14.708552434620028, 7.486328552758163, 26.58825268825034, 15.152078901741955, 25.351117842607948, 25.351592803742612, 18.752722161758157, 27.437350572636653, 15.661052500374867, 9.994914600559937, 44.584557687412506, 14.069633200587901, 0.991420092692568, 22.486476155695904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5941872927216214, "mean_inference_ms": 1.5834643138081363, "mean_action_processing_ms": 0.24531708042802525, "mean_env_wait_ms": 0.1364431648920784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002759575843811035, "StateBufferConnector_ms": 0.0024068355560302734, "ViewRequirementAgentConnector_ms": 0.06091117858886719}, "num_episodes": 18, "episode_return_max": 51.08711556378477, "episode_return_min": -8.969887124683883, "episode_return_mean": 16.259668975117492, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.0249662349959, "num_env_steps_trained_throughput_per_sec": 448.0249662349959, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 8798.566, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8798.528, "sample_time_ms": 780.792, "learn_time_ms": 8005.287, "learn_throughput": 499.67, "synch_weights_time_ms": 12.044}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 190, "trial_id": "06536_00000", "date": "2024-08-11_17-51-04", "timestamp": 1723413064, "time_this_iter_s": 8.933613061904907, "time_total_s": 4602.527606010437, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63a8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4602.527606010437, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 24.246153846153845, "ram_util_percent": 80.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.928652302424113, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.285436848551035, "policy_loss": -0.007716986341256416, "vf_loss": 2.2931538290033737, "vf_explained_var": 0.9353272580852111, "kl": 0.0071660133546995386, "entropy": 0.3827172697832187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9177033371395535, "cur_kl_coeff": 2.6448622893501476e-39, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.852856330581443, "policy_loss": -0.0020991839939068077, "vf_loss": 2.854955507964684, "vf_explained_var": 0.9265283086312511, "kl": 0.0033608519880479956, "entropy": 0.2880175175095992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "env_runners": {"episode_reward_max": 51.08711556378477, "episode_reward_min": -8.969887124683883, "episode_reward_mean": 17.675082068520027, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.08711556378475, "predator_policy": -16.28282958372005}, "policy_reward_max": {"prey_policy": 8.969887124683881, "predator_policy": 52.951174071407344}, "policy_reward_mean": {"prey_policy": -17.675082068520027, "predator_policy": 17.67508206852003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.82692602251721, 20.318778087991397, 33.71586402548054, 23.869818668640605, 28.700790020334402, 38.66564101560798, 21.704278254853605, 16.17896764674826, 11.814903870885834, 15.906854751816446, 26.08520178707021, 8.92906837117788, 25.907388224181577, 36.567573305647, 31.383822661545114, 18.303054962549616, 10.836358587373109, 21.22862348913751, 3.989829643403442, 21.351028942898694, 26.24507554873063, -8.969887124683883, 29.594926395814497, 20.707176215971796, 19.31393088053877, 8.109396618679249, 36.824333166102825, 7.104460913309606, 7.101785367599354, 8.473872807472507, 23.107738161191598, 5.628365034402093, 14.371282942844129, 19.47372916443573, 22.03177233284041, 25.598670322120928, -1.2160372631494791, 11.236054117265734, 5.639906511972074, -2.0615899725086315, 10.8858519445845, 36.160906984213234, 24.436182062830362, 27.424219195462754, 15.384957385953443, 17.716931517039633, 21.55456838284427, 9.832598996913166, 25.891945102568453, 14.933588238260802, 12.472556762336763, 17.462136782423016, 8.862019191774527, 8.574510297734179, 3.4257449394598956, 3.7644703998122715, 31.217356825085922, 10.25394751013708, 5.522414691630005, 32.39692313098291, 20.24595242873698, 13.42655934121187, 0.6368046983602005, 12.674083206515785, 8.007990705589519, 47.24842861571876, 18.107952322162436, 12.08044703850534, 51.08711556378477, 17.27087214166208, 11.097440493689074, 20.870165794996137, 25.351355323175227, 23.0950363671974, 12.827983550467398, 29.327095444000207, 11.738948124194247, 13.145291213191955, 22.188084833528436, 13.133137116531012, 16.431739757469288, 26.77573261146933, 19.254086735938355, 14.783753908430732, 19.531298276380863, -2.720050230503885, -3.7916690946413265, 29.572543365437763, 20.51738354962784, 36.20330613533793, 18.471147004789902, 10.018190922075119, 14.246447135418359, 5.3660475907003455, 19.0249778559415, 14.023748140670358, 40.11153727196912, 18.137146740261972, -3.3382156028543504, 30.554745632007105], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.826926022517172, -20.31877808799139, -33.71586402548055, -23.869818668640608, -28.700790020334416, -38.665641015607996, -21.704278254853598, -16.178967646748266, -11.814903870885818, -15.906854751816422, -26.08520178707021, -8.929068371177861, -25.907388224181627, -36.567573305646995, -31.383822661545118, -18.30305496254961, -10.836358587373121, -21.228623489137515, -3.9898296434034357, -21.3510289428987, -26.24507554873064, 8.969887124683881, -29.594926395814504, -20.707176215971792, -19.31393088053877, -8.109396618679245, -36.82433316610281, -7.104460913309593, -7.101785367599348, -8.473872807472489, -23.107738161191612, -5.628365034402085, -14.371282942844125, -19.473729164435735, -22.031772332840408, -25.59867032212096, 1.2160372631494791, -11.236054117265727, -5.6399065119720735, 2.0615899725086546, -10.88585194458448, -36.1609069842133, -24.436182062830397, -27.424219195462715, -15.384957385953417, -17.71693151703963, -21.55456838284426, -9.832598996913172, -25.891945102568453, -14.9335882382608, -12.472556762336758, -17.462136782423013, -8.86201919177456, -8.574510297734234, -3.4257449394599, -3.764470399812274, -31.217356825085947, -10.253947510137074, -5.522414691630015, -32.3969231309829, -20.245952428736985, -13.426559341211904, -0.6368046983602103, -12.674083206515775, -8.007990705589517, -47.24842861571874, -18.10795232216244, -12.080447038505344, -51.08711556378475, -17.270872141662142, -11.09744049368909, -20.87016579499614, -25.351355323175287, -23.09503636719741, -12.827983550467396, -29.327095444000182, -11.73894812419423, -13.145291213191975, -22.18808483352843, -13.133137116530978, -16.431739757469295, -26.775732611469323, -19.25408673593833, -14.783753908430747, -19.531298276380845, 2.720050230503891, 3.791669094641321, -29.572543365437745, -20.517383549627862, -36.2033061353379, -18.471147004789913, -10.018190922075082, -14.246447135418364, -5.3660475907003224, -19.024977855941483, -14.0237481406704, -40.11153727196913, -18.13714674026203, 3.3382156028543566, -30.554745632007098], "policy_predator_policy_reward": [33.93668162875442, -16.28282958372005, 14.36334206150556, 26.274214114477246, 18.195519211644587, 49.236208839316504, 31.662664053710387, 16.076973283570826, 42.12655874262573, 15.275021298043104, 34.92671356892337, 42.40456846229264, 20.075771994237336, 23.33278451546984, 21.060818485753835, 11.297116807742686, -0.4621880576175377, 24.091995799389167, 23.868391678229518, 7.945317825403345, 23.969195052734985, 28.201208521405427, 2.860921568587731, 14.997215173767998, 33.07677431047936, 18.738002137883875, 33.121506463451425, 40.01364014784259, 42.523984153385406, 20.243661169704858, 6.244663234144969, 30.36144669095429, -0.19765402602695037, 21.870371200773185, 40.4694311623685, 1.9878158159065187, -3.6973887941006023, 11.677048080907458, 17.827143321029617, 24.87491456476777, 29.48270386996469, 23.00744722749656, -10.736546279159846, -7.2032279702079265, 13.917695678780857, 45.27215711284811, 27.91453895130655, 13.499813480637007, 13.161972278861075, 25.46588948221647, -6.526402199183796, 22.745195436542296, 33.55879781071803, 40.08986852148761, 18.21316886995016, -4.00424704333097, 9.202113876448003, 5.0014568587506965, 10.54656076086929, 6.40118485407571, 38.113763883559706, 8.101712438823533, -9.195702144996709, 20.45243221380086, 12.00270052374761, 16.739865361940655, 25.10054531559219, 13.84691301327927, 13.003234695385009, 31.060309970295826, 18.156979906097607, 33.0403607381443, 3.7503825516724802, -6.182457077971446, 8.072685723851079, 14.399422510680392, -0.033316805556005136, 11.313129829500161, 0.4178114948556999, -4.540991439872988, 9.894548063663992, 11.877155825504989, 41.963903319227654, 30.35791064919895, 34.459822984379414, 14.412541141281409, 22.000955554992835, 32.84748283593259, 23.68187585580067, 7.088038916106196, 8.664994676394947, 26.768868357684305, 14.573349522248751, 28.53578724343977, 13.15430645588025, 6.510891537946083, 35.27833060177645, 16.505559603360467, 10.696286885666542, 19.170889590855055, 4.329221066792485, 20.615892457881046, 24.461854784720032, 10.462418780125997, 8.597265654858477, 9.126772728690607, -2.493443739576609, 19.64246433504507, 2.1804914037238134, 4.67099847519599, 0.04358702745969101, 7.48535377216484, 23.837946501320896, 38.59676714885093, 16.204909030622066, 4.302985989652073, 11.548509619771867, -0.5036802365118458, 33.39884933963851, 31.394996922327287, 38.63802474421606, 1.8538801132579117, 23.67534500227731, 3.1777736801464904, -10.516649799857989, 11.790259196578395, 22.878192651652128, 2.4699737613794444, 7.62644619228152, 8.389535218897523, 49.68623014852277, 44.81062708291469, 25.959376463303357, 10.256528181021498, 13.514398639455237, 10.646495437555451, 52.951174071407344, 49.22305705616216, 42.31271533727799, -7.770971053953769, 14.708552434620028, 7.486328552758163, 26.58825268825034, 15.152078901741955, 25.351117842607948, 25.351592803742612, 18.752722161758157, 27.437350572636653, 15.661052500374867, 9.994914600559937, 44.584557687412506, 14.069633200587901, 0.991420092692568, 22.486476155695904, 4.052529859807569, 22.23805256657637, 10.22931662200449, 34.146853045052374, 4.724047407885297, 21.542226825176634, 3.655342194291176, 29.208137320647396, 18.124700302736144, 35.42676492020259, 26.105746230044033, 12.402427241832646, 14.513665611816997, 15.053842205044486, 12.648741251248236, 26.41385530151348, -4.910462529936833, -0.5296379310709565, -6.4546911913678215, -1.1286469979148315, 44.751674917325374, 14.393411813550134, 29.765539417257216, 11.269227681998508, 29.15006624075219, 43.256546029923626, 11.483462024161739, 25.458831985418083, 5.788303726663663, 14.248078117486505, 33.059331751868484, -4.566437481031752, 5.053952605194469, 5.6781425762061914, 13.587519137157349, 24.462436574725636, 8.761010260530814, 19.286486020809996, 40.3698505692892, 39.85322397464903, 14.614511929724781, 21.659781550799256, 0.11800160950383898, -6.794432815212559, 36.93662663709213, 24.172864626922106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.592796029942363, "mean_inference_ms": 1.5795281848932061, "mean_action_processing_ms": 0.24468184786964328, "mean_env_wait_ms": 0.13600982563350508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002681136131286621, "StateBufferConnector_ms": 0.0023669004440307617, "ViewRequirementAgentConnector_ms": 0.05953168869018555}, "num_episodes": 23, "episode_return_max": 51.08711556378477, "episode_return_min": -8.969887124683883, "episode_return_mean": 17.675082068520027, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.32364241305885, "num_env_steps_trained_throughput_per_sec": 455.32364241305885, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 2292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2292000, "timers": {"training_iteration_time_ms": 8811.504, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8811.465, "sample_time_ms": 781.914, "learn_time_ms": 8017.266, "learn_throughput": 498.923, "synch_weights_time_ms": 11.883}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "done": false, "training_iteration": 191, "trial_id": "06536_00000", "date": "2024-08-11_17-51-13", "timestamp": 1723413073, "time_this_iter_s": 8.788961172103882, "time_total_s": 4611.316567182541, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b638b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4611.316567182541, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 24.24166666666667, "ram_util_percent": 80.52500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7118699134637914, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.926205868832767, "policy_loss": -0.00526666305862212, "vf_loss": 1.931472530712684, "vf_explained_var": 0.9546227691074213, "kl": 0.007673742129781534, "entropy": 0.4068603800609708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7227513071090454, "cur_kl_coeff": 1.3224311446750738e-39, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1747961357787804, "policy_loss": -0.0029183279435894397, "vf_loss": 2.1777144609304964, "vf_explained_var": 0.9502635856784841, "kl": 0.004662878151766228, "entropy": 0.2545955072162013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 51.08711556378477, "episode_reward_min": -5.260771525784887, "episode_reward_mean": 16.280001476602592, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.08711556378475, "predator_policy": -12.034363369990672}, "policy_reward_max": {"prey_policy": 5.260771525784895, "predator_policy": 52.951174071407344}, "policy_reward_mean": {"prey_policy": -16.280001476602596, "predator_policy": 16.280001476602592}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.594926395814497, 20.707176215971796, 19.31393088053877, 8.109396618679249, 36.824333166102825, 7.104460913309606, 7.101785367599354, 8.473872807472507, 23.107738161191598, 5.628365034402093, 14.371282942844129, 19.47372916443573, 22.03177233284041, 25.598670322120928, -1.2160372631494791, 11.236054117265734, 5.639906511972074, -2.0615899725086315, 10.8858519445845, 36.160906984213234, 24.436182062830362, 27.424219195462754, 15.384957385953443, 17.716931517039633, 21.55456838284427, 9.832598996913166, 25.891945102568453, 14.933588238260802, 12.472556762336763, 17.462136782423016, 8.862019191774527, 8.574510297734179, 3.4257449394598956, 3.7644703998122715, 31.217356825085922, 10.25394751013708, 5.522414691630005, 32.39692313098291, 20.24595242873698, 13.42655934121187, 0.6368046983602005, 12.674083206515785, 8.007990705589519, 47.24842861571876, 18.107952322162436, 12.08044703850534, 51.08711556378477, 17.27087214166208, 11.097440493689074, 20.870165794996137, 25.351355323175227, 23.0950363671974, 12.827983550467398, 29.327095444000207, 11.738948124194247, 13.145291213191955, 22.188084833528436, 13.133137116531012, 16.431739757469288, 26.77573261146933, 19.254086735938355, 14.783753908430732, 19.531298276380863, -2.720050230503885, -3.7916690946413265, 29.572543365437763, 20.51738354962784, 36.20330613533793, 18.471147004789902, 10.018190922075119, 14.246447135418359, 5.3660475907003455, 19.0249778559415, 14.023748140670358, 40.11153727196912, 18.137146740261972, -3.3382156028543504, 30.554745632007105, 24.8478812447673, 17.0579719865985, 4.641985415756509, 17.558952131144665, -3.553498147192026, 33.82689299633352, 12.734896723143125, -4.74666696848951, -4.777535139674463, 14.902744761419012, 17.30198773628408, 31.266647117564872, -3.2293201178862905, 12.001287530411707, -5.260771525784887, 18.106940616070673, 9.655338889598994, 32.99222780893023, 34.67001880493126, 8.399053652042236, 32.68358164807454, 0.971284408119514], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.594926395814504, -20.707176215971792, -19.31393088053877, -8.109396618679245, -36.82433316610281, -7.104460913309593, -7.101785367599348, -8.473872807472489, -23.107738161191612, -5.628365034402085, -14.371282942844125, -19.473729164435735, -22.031772332840408, -25.59867032212096, 1.2160372631494791, -11.236054117265727, -5.6399065119720735, 2.0615899725086546, -10.88585194458448, -36.1609069842133, -24.436182062830397, -27.424219195462715, -15.384957385953417, -17.71693151703963, -21.55456838284426, -9.832598996913172, -25.891945102568453, -14.9335882382608, -12.472556762336758, -17.462136782423013, -8.86201919177456, -8.574510297734234, -3.4257449394599, -3.764470399812274, -31.217356825085947, -10.253947510137074, -5.522414691630015, -32.3969231309829, -20.245952428736985, -13.426559341211904, -0.6368046983602103, -12.674083206515775, -8.007990705589517, -47.24842861571874, -18.10795232216244, -12.080447038505344, -51.08711556378475, -17.270872141662142, -11.09744049368909, -20.87016579499614, -25.351355323175287, -23.09503636719741, -12.827983550467396, -29.327095444000182, -11.73894812419423, -13.145291213191975, -22.18808483352843, -13.133137116530978, -16.431739757469295, -26.775732611469323, -19.25408673593833, -14.783753908430747, -19.531298276380845, 2.720050230503891, 3.791669094641321, -29.572543365437745, -20.517383549627862, -36.2033061353379, -18.471147004789913, -10.018190922075082, -14.246447135418364, -5.3660475907003224, -19.024977855941483, -14.0237481406704, -40.11153727196913, -18.13714674026203, 3.3382156028543566, -30.554745632007098, -24.847881244767326, -17.05797198659853, -4.641985415756524, -17.55895213114466, 3.5534981471920197, -33.82689299633349, -12.734896723143105, 4.7466669684895155, 4.777535139674468, -14.902744761418997, -17.30198773628409, -31.266647117564858, 3.2293201178863047, -12.001287530411705, 5.260771525784895, -18.106940616070705, -9.655338889598998, -32.99222780893021, -34.67001880493129, -8.399053652042237, -32.683581648074515, -0.9712844081195109], "policy_predator_policy_reward": [13.917695678780857, 45.27215711284811, 27.91453895130655, 13.499813480637007, 13.161972278861075, 25.46588948221647, -6.526402199183796, 22.745195436542296, 33.55879781071803, 40.08986852148761, 18.21316886995016, -4.00424704333097, 9.202113876448003, 5.0014568587506965, 10.54656076086929, 6.40118485407571, 38.113763883559706, 8.101712438823533, -9.195702144996709, 20.45243221380086, 12.00270052374761, 16.739865361940655, 25.10054531559219, 13.84691301327927, 13.003234695385009, 31.060309970295826, 18.156979906097607, 33.0403607381443, 3.7503825516724802, -6.182457077971446, 8.072685723851079, 14.399422510680392, -0.033316805556005136, 11.313129829500161, 0.4178114948556999, -4.540991439872988, 9.894548063663992, 11.877155825504989, 41.963903319227654, 30.35791064919895, 34.459822984379414, 14.412541141281409, 22.000955554992835, 32.84748283593259, 23.68187585580067, 7.088038916106196, 8.664994676394947, 26.768868357684305, 14.573349522248751, 28.53578724343977, 13.15430645588025, 6.510891537946083, 35.27833060177645, 16.505559603360467, 10.696286885666542, 19.170889590855055, 4.329221066792485, 20.615892457881046, 24.461854784720032, 10.462418780125997, 8.597265654858477, 9.126772728690607, -2.493443739576609, 19.64246433504507, 2.1804914037238134, 4.67099847519599, 0.04358702745969101, 7.48535377216484, 23.837946501320896, 38.59676714885093, 16.204909030622066, 4.302985989652073, 11.548509619771867, -0.5036802365118458, 33.39884933963851, 31.394996922327287, 38.63802474421606, 1.8538801132579117, 23.67534500227731, 3.1777736801464904, -10.516649799857989, 11.790259196578395, 22.878192651652128, 2.4699737613794444, 7.62644619228152, 8.389535218897523, 49.68623014852277, 44.81062708291469, 25.959376463303357, 10.256528181021498, 13.514398639455237, 10.646495437555451, 52.951174071407344, 49.22305705616216, 42.31271533727799, -7.770971053953769, 14.708552434620028, 7.486328552758163, 26.58825268825034, 15.152078901741955, 25.351117842607948, 25.351592803742612, 18.752722161758157, 27.437350572636653, 15.661052500374867, 9.994914600559937, 44.584557687412506, 14.069633200587901, 0.991420092692568, 22.486476155695904, 4.052529859807569, 22.23805256657637, 10.22931662200449, 34.146853045052374, 4.724047407885297, 21.542226825176634, 3.655342194291176, 29.208137320647396, 18.124700302736144, 35.42676492020259, 26.105746230044033, 12.402427241832646, 14.513665611816997, 15.053842205044486, 12.648741251248236, 26.41385530151348, -4.910462529936833, -0.5296379310709565, -6.4546911913678215, -1.1286469979148315, 44.751674917325374, 14.393411813550134, 29.765539417257216, 11.269227681998508, 29.15006624075219, 43.256546029923626, 11.483462024161739, 25.458831985418083, 5.788303726663663, 14.248078117486505, 33.059331751868484, -4.566437481031752, 5.053952605194469, 5.6781425762061914, 13.587519137157349, 24.462436574725636, 8.761010260530814, 19.286486020809996, 40.3698505692892, 39.85322397464903, 14.614511929724781, 21.659781550799256, 0.11800160950383898, -6.794432815212559, 36.93662663709213, 24.172864626922106, 20.941592673429767, 28.75416981610488, 18.991591558665196, 15.124352414531852, 5.427917720289543, 3.8560531112235026, 6.785646575430505, 28.332257686858824, -3.184442475509454, -3.922553818874592, 32.45385728317082, 35.19992870949616, 9.775996570188347, 15.693796876097856, 1.018268019315201, -10.511601956294237, -12.034363369990672, 2.479293090641738, -0.8152310438556611, 30.62072056669366, 12.805999337678635, 21.79797613488952, 32.78774195867338, 29.7455522764564, -3.1415333560956107, -3.317106879676988, 19.417676131352014, 4.584898929471379, -2.972825517985015, -7.548717533584764, 9.26564444214242, 26.94823678999898, 0.7944378035163862, 18.51623997568161, 39.708606567036476, 26.27584905082395, 36.321059380843536, 33.01897822901895, 6.936983011502951, 9.861124292581533, 27.173660833559822, 38.1935024625892, -3.1100913021088292, 5.052660118347855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5916060189134906, "mean_inference_ms": 1.5757829916665589, "mean_action_processing_ms": 0.24430935976019127, "mean_env_wait_ms": 0.13571138159085605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002760171890258789, "StateBufferConnector_ms": 0.00240325927734375, "ViewRequirementAgentConnector_ms": 0.06132066249847412}, "num_episodes": 22, "episode_return_max": 51.08711556378477, "episode_return_min": -5.260771525784887, "episode_return_mean": 16.280001476602592, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.3978143292645, "num_env_steps_trained_throughput_per_sec": 442.3978143292645, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 8845.82, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8845.78, "sample_time_ms": 787.098, "learn_time_ms": 8046.541, "learn_throughput": 497.108, "synch_weights_time_ms": 11.73}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 192, "trial_id": "06536_00000", "date": "2024-08-11_17-51-22", "timestamp": 1723413082, "time_this_iter_s": 9.050693988800049, "time_total_s": 4620.367261171341, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b638bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4620.367261171341, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 27.161538461538463, "ram_util_percent": 80.9923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7463019444296757, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.724615403326849, "policy_loss": -0.007889856987458189, "vf_loss": 1.7325052656854192, "vf_explained_var": 0.9525701465085149, "kl": 0.0059935737909223245, "entropy": 0.3930802883269886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.904710883816714, "cur_kl_coeff": 6.612155723375369e-40, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.069393818025236, "policy_loss": -0.0013218614610316104, "vf_loss": 2.070715676161347, "vf_explained_var": 0.9536191656791344, "kl": 0.0031542028344245013, "entropy": 0.2957961361874979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "env_runners": {"episode_reward_max": 51.08711556378477, "episode_reward_min": -6.25317188894366, "episode_reward_mean": 17.115752779783588, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.08711556378475, "predator_policy": -14.107150273406859}, "policy_reward_max": {"prey_policy": 6.253171888943673, "predator_policy": 56.97854287215801}, "policy_reward_mean": {"prey_policy": -17.115752779783588, "predator_policy": 17.115752779783588}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.8858519445845, 36.160906984213234, 24.436182062830362, 27.424219195462754, 15.384957385953443, 17.716931517039633, 21.55456838284427, 9.832598996913166, 25.891945102568453, 14.933588238260802, 12.472556762336763, 17.462136782423016, 8.862019191774527, 8.574510297734179, 3.4257449394598956, 3.7644703998122715, 31.217356825085922, 10.25394751013708, 5.522414691630005, 32.39692313098291, 20.24595242873698, 13.42655934121187, 0.6368046983602005, 12.674083206515785, 8.007990705589519, 47.24842861571876, 18.107952322162436, 12.08044703850534, 51.08711556378477, 17.27087214166208, 11.097440493689074, 20.870165794996137, 25.351355323175227, 23.0950363671974, 12.827983550467398, 29.327095444000207, 11.738948124194247, 13.145291213191955, 22.188084833528436, 13.133137116531012, 16.431739757469288, 26.77573261146933, 19.254086735938355, 14.783753908430732, 19.531298276380863, -2.720050230503885, -3.7916690946413265, 29.572543365437763, 20.51738354962784, 36.20330613533793, 18.471147004789902, 10.018190922075119, 14.246447135418359, 5.3660475907003455, 19.0249778559415, 14.023748140670358, 40.11153727196912, 18.137146740261972, -3.3382156028543504, 30.554745632007105, 24.8478812447673, 17.0579719865985, 4.641985415756509, 17.558952131144665, -3.553498147192026, 33.82689299633352, 12.734896723143125, -4.74666696848951, -4.777535139674463, 14.902744761419012, 17.30198773628408, 31.266647117564872, -3.2293201178862905, 12.001287530411707, -5.260771525784887, 18.106940616070673, 9.655338889598994, 32.99222780893023, 34.67001880493126, 8.399053652042236, 32.68358164807454, 0.971284408119514, 26.924615194390693, 15.89598719991612, 40.30630555669692, 37.61586448558625, 45.05270101147786, 15.67546199790056, 15.98993102138966, 14.494756682995112, 6.248389751713977, 27.14362573497573, 7.616104733978338, 14.286966192603995, 14.859789269756966, 4.078781412491922, 10.207640859635434, 25.28373409577321, 29.187420722663646, -6.25317188894366], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.88585194458448, -36.1609069842133, -24.436182062830397, -27.424219195462715, -15.384957385953417, -17.71693151703963, -21.55456838284426, -9.832598996913172, -25.891945102568453, -14.9335882382608, -12.472556762336758, -17.462136782423013, -8.86201919177456, -8.574510297734234, -3.4257449394599, -3.764470399812274, -31.217356825085947, -10.253947510137074, -5.522414691630015, -32.3969231309829, -20.245952428736985, -13.426559341211904, -0.6368046983602103, -12.674083206515775, -8.007990705589517, -47.24842861571874, -18.10795232216244, -12.080447038505344, -51.08711556378475, -17.270872141662142, -11.09744049368909, -20.87016579499614, -25.351355323175287, -23.09503636719741, -12.827983550467396, -29.327095444000182, -11.73894812419423, -13.145291213191975, -22.18808483352843, -13.133137116530978, -16.431739757469295, -26.775732611469323, -19.25408673593833, -14.783753908430747, -19.531298276380845, 2.720050230503891, 3.791669094641321, -29.572543365437745, -20.517383549627862, -36.2033061353379, -18.471147004789913, -10.018190922075082, -14.246447135418364, -5.3660475907003224, -19.024977855941483, -14.0237481406704, -40.11153727196913, -18.13714674026203, 3.3382156028543566, -30.554745632007098, -24.847881244767326, -17.05797198659853, -4.641985415756524, -17.55895213114466, 3.5534981471920197, -33.82689299633349, -12.734896723143105, 4.7466669684895155, 4.777535139674468, -14.902744761418997, -17.30198773628409, -31.266647117564858, 3.2293201178863047, -12.001287530411705, 5.260771525784895, -18.106940616070705, -9.655338889598998, -32.99222780893021, -34.67001880493129, -8.399053652042237, -32.683581648074515, -0.9712844081195109, -26.92461519439067, -15.895987199916128, -40.30630555669698, -37.61586448558636, -45.052701011477836, -15.67546199790057, -15.989931021389651, -14.494756682995131, -6.248389751713976, -27.143625734975707, -7.616104733978337, -14.286966192603993, -14.85978926975696, -4.078781412491926, -10.207640859635458, -25.283734095773198, -29.18742072266364, 6.253171888943673], "policy_predator_policy_reward": [9.894548063663992, 11.877155825504989, 41.963903319227654, 30.35791064919895, 34.459822984379414, 14.412541141281409, 22.000955554992835, 32.84748283593259, 23.68187585580067, 7.088038916106196, 8.664994676394947, 26.768868357684305, 14.573349522248751, 28.53578724343977, 13.15430645588025, 6.510891537946083, 35.27833060177645, 16.505559603360467, 10.696286885666542, 19.170889590855055, 4.329221066792485, 20.615892457881046, 24.461854784720032, 10.462418780125997, 8.597265654858477, 9.126772728690607, -2.493443739576609, 19.64246433504507, 2.1804914037238134, 4.67099847519599, 0.04358702745969101, 7.48535377216484, 23.837946501320896, 38.59676714885093, 16.204909030622066, 4.302985989652073, 11.548509619771867, -0.5036802365118458, 33.39884933963851, 31.394996922327287, 38.63802474421606, 1.8538801132579117, 23.67534500227731, 3.1777736801464904, -10.516649799857989, 11.790259196578395, 22.878192651652128, 2.4699737613794444, 7.62644619228152, 8.389535218897523, 49.68623014852277, 44.81062708291469, 25.959376463303357, 10.256528181021498, 13.514398639455237, 10.646495437555451, 52.951174071407344, 49.22305705616216, 42.31271533727799, -7.770971053953769, 14.708552434620028, 7.486328552758163, 26.58825268825034, 15.152078901741955, 25.351117842607948, 25.351592803742612, 18.752722161758157, 27.437350572636653, 15.661052500374867, 9.994914600559937, 44.584557687412506, 14.069633200587901, 0.991420092692568, 22.486476155695904, 4.052529859807569, 22.23805256657637, 10.22931662200449, 34.146853045052374, 4.724047407885297, 21.542226825176634, 3.655342194291176, 29.208137320647396, 18.124700302736144, 35.42676492020259, 26.105746230044033, 12.402427241832646, 14.513665611816997, 15.053842205044486, 12.648741251248236, 26.41385530151348, -4.910462529936833, -0.5296379310709565, -6.4546911913678215, -1.1286469979148315, 44.751674917325374, 14.393411813550134, 29.765539417257216, 11.269227681998508, 29.15006624075219, 43.256546029923626, 11.483462024161739, 25.458831985418083, 5.788303726663663, 14.248078117486505, 33.059331751868484, -4.566437481031752, 5.053952605194469, 5.6781425762061914, 13.587519137157349, 24.462436574725636, 8.761010260530814, 19.286486020809996, 40.3698505692892, 39.85322397464903, 14.614511929724781, 21.659781550799256, 0.11800160950383898, -6.794432815212559, 36.93662663709213, 24.172864626922106, 20.941592673429767, 28.75416981610488, 18.991591558665196, 15.124352414531852, 5.427917720289543, 3.8560531112235026, 6.785646575430505, 28.332257686858824, -3.184442475509454, -3.922553818874592, 32.45385728317082, 35.19992870949616, 9.775996570188347, 15.693796876097856, 1.018268019315201, -10.511601956294237, -12.034363369990672, 2.479293090641738, -0.8152310438556611, 30.62072056669366, 12.805999337678635, 21.79797613488952, 32.78774195867338, 29.7455522764564, -3.1415333560956107, -3.317106879676988, 19.417676131352014, 4.584898929471379, -2.972825517985015, -7.548717533584764, 9.26564444214242, 26.94823678999898, 0.7944378035163862, 18.51623997568161, 39.708606567036476, 26.27584905082395, 36.321059380843536, 33.01897822901895, 6.936983011502951, 9.861124292581533, 27.173660833559822, 38.1935024625892, -3.1100913021088292, 5.052660118347855, 28.5647531100618, 25.284477278719514, 16.071791917334128, 15.720182482498128, 42.520408124846206, 38.09220298854766, 45.77206920739419, 29.45965976377842, 33.12685915079766, 56.97854287215801, 34.77535187726486, -3.424427881463762, 9.504254466887968, 22.475607575891345, 20.427979316357998, 8.561534049632222, 15.428268515751087, -2.931489012323137, 12.73403800233404, 41.55321346761736, 13.401694100439475, 1.8305153675172026, 13.900474558742987, 14.673457826465008, 20.2496678577384, 9.469910681775518, -7.662313035454451, 15.819875860438358, 5.634190251327784, 14.781091467943133, 16.213336227957615, 34.354131963588785, 34.15913583482771, 24.215705610499533, -14.107150273406859, 1.600806495519521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5905662304097423, "mean_inference_ms": 1.5726781376364734, "mean_action_processing_ms": 0.24390311269999085, "mean_env_wait_ms": 0.1354196493452221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027692317962646484, "StateBufferConnector_ms": 0.002402186393737793, "ViewRequirementAgentConnector_ms": 0.061394572257995605}, "num_episodes": 18, "episode_return_max": 51.08711556378477, "episode_return_min": -6.25317188894366, "episode_return_mean": 17.115752779783588, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.77013227518626, "num_env_steps_trained_throughput_per_sec": 468.77013227518626, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 2316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2316000, "timers": {"training_iteration_time_ms": 8853.91, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8853.87, "sample_time_ms": 786.544, "learn_time_ms": 8055.166, "learn_throughput": 496.576, "synch_weights_time_ms": 11.75}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "done": false, "training_iteration": 193, "trial_id": "06536_00000", "date": "2024-08-11_17-51-30", "timestamp": 1723413090, "time_this_iter_s": 8.53745985031128, "time_total_s": 4628.904721021652, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b63dc5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4628.904721021652, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 22.683333333333337, "ram_util_percent": 81.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.950752484674255, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0508226646731296, "policy_loss": -0.004871530986565631, "vf_loss": 2.0556942004089556, "vf_explained_var": 0.9402851192901532, "kl": 0.00521414155781225, "entropy": 0.3653254231748482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.01100924797159, "cur_kl_coeff": 3.3060778616876845e-40, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5615231296372794, "policy_loss": -0.0025998840584030383, "vf_loss": 2.5641230083647226, "vf_explained_var": 0.9306730602468763, "kl": 0.003329603422443128, "entropy": 0.23986165463609038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "env_runners": {"episode_reward_max": 51.08711556378477, "episode_reward_min": -6.25317188894366, "episode_reward_mean": 16.097145445851154, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.08711556378475, "predator_policy": -15.63952682655121}, "policy_reward_max": {"prey_policy": 6.253171888943673, "predator_policy": 56.97854287215801}, "policy_reward_mean": {"prey_policy": -16.097145445851158, "predator_policy": 16.097145445851154}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.522414691630005, 32.39692313098291, 20.24595242873698, 13.42655934121187, 0.6368046983602005, 12.674083206515785, 8.007990705589519, 47.24842861571876, 18.107952322162436, 12.08044703850534, 51.08711556378477, 17.27087214166208, 11.097440493689074, 20.870165794996137, 25.351355323175227, 23.0950363671974, 12.827983550467398, 29.327095444000207, 11.738948124194247, 13.145291213191955, 22.188084833528436, 13.133137116531012, 16.431739757469288, 26.77573261146933, 19.254086735938355, 14.783753908430732, 19.531298276380863, -2.720050230503885, -3.7916690946413265, 29.572543365437763, 20.51738354962784, 36.20330613533793, 18.471147004789902, 10.018190922075119, 14.246447135418359, 5.3660475907003455, 19.0249778559415, 14.023748140670358, 40.11153727196912, 18.137146740261972, -3.3382156028543504, 30.554745632007105, 24.8478812447673, 17.0579719865985, 4.641985415756509, 17.558952131144665, -3.553498147192026, 33.82689299633352, 12.734896723143125, -4.74666696848951, -4.777535139674463, 14.902744761419012, 17.30198773628408, 31.266647117564872, -3.2293201178862905, 12.001287530411707, -5.260771525784887, 18.106940616070673, 9.655338889598994, 32.99222780893023, 34.67001880493126, 8.399053652042236, 32.68358164807454, 0.971284408119514, 26.924615194390693, 15.89598719991612, 40.30630555669692, 37.61586448558625, 45.05270101147786, 15.67546199790056, 15.98993102138966, 14.494756682995112, 6.248389751713977, 27.14362573497573, 7.616104733978338, 14.286966192603995, 14.859789269756966, 4.078781412491922, 10.207640859635434, 25.28373409577321, 29.187420722663646, -6.25317188894366, 25.54028029095538, 2.597833832017365, 17.141989149280644, 2.144842410781619, 15.526528141106464, 26.016816688963008, 6.942702060574705, 9.799362745430495, 21.221698606143473, 19.29430110404534, 20.862782015366694, 13.189096453509945, -0.5856383770025841, -1.1592663102261191, -4.911759063151205, 6.135822814411673, 11.920266279292724, 6.716100284691661], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.522414691630015, -32.3969231309829, -20.245952428736985, -13.426559341211904, -0.6368046983602103, -12.674083206515775, -8.007990705589517, -47.24842861571874, -18.10795232216244, -12.080447038505344, -51.08711556378475, -17.270872141662142, -11.09744049368909, -20.87016579499614, -25.351355323175287, -23.09503636719741, -12.827983550467396, -29.327095444000182, -11.73894812419423, -13.145291213191975, -22.18808483352843, -13.133137116530978, -16.431739757469295, -26.775732611469323, -19.25408673593833, -14.783753908430747, -19.531298276380845, 2.720050230503891, 3.791669094641321, -29.572543365437745, -20.517383549627862, -36.2033061353379, -18.471147004789913, -10.018190922075082, -14.246447135418364, -5.3660475907003224, -19.024977855941483, -14.0237481406704, -40.11153727196913, -18.13714674026203, 3.3382156028543566, -30.554745632007098, -24.847881244767326, -17.05797198659853, -4.641985415756524, -17.55895213114466, 3.5534981471920197, -33.82689299633349, -12.734896723143105, 4.7466669684895155, 4.777535139674468, -14.902744761418997, -17.30198773628409, -31.266647117564858, 3.2293201178863047, -12.001287530411705, 5.260771525784895, -18.106940616070705, -9.655338889598998, -32.99222780893021, -34.67001880493129, -8.399053652042237, -32.683581648074515, -0.9712844081195109, -26.92461519439067, -15.895987199916128, -40.30630555669698, -37.61586448558636, -45.052701011477836, -15.67546199790057, -15.989931021389651, -14.494756682995131, -6.248389751713976, -27.143625734975707, -7.616104733978337, -14.286966192603993, -14.85978926975696, -4.078781412491926, -10.207640859635458, -25.283734095773198, -29.18742072266364, 6.253171888943673, -25.540280290955366, -2.597833832017372, -17.141989149280644, -2.1448424107815987, -15.526528141106457, -26.01681668896303, -6.942702060574703, -9.799362745430493, -21.221698606143498, -19.294301104045314, -20.86278201536669, -13.189096453509944, 0.5856383770025921, 1.1592663102261058, 4.911759063151211, -6.135822814411691, -11.920266279292733, -6.716100284691657], "policy_predator_policy_reward": [11.548509619771867, -0.5036802365118458, 33.39884933963851, 31.394996922327287, 38.63802474421606, 1.8538801132579117, 23.67534500227731, 3.1777736801464904, -10.516649799857989, 11.790259196578395, 22.878192651652128, 2.4699737613794444, 7.62644619228152, 8.389535218897523, 49.68623014852277, 44.81062708291469, 25.959376463303357, 10.256528181021498, 13.514398639455237, 10.646495437555451, 52.951174071407344, 49.22305705616216, 42.31271533727799, -7.770971053953769, 14.708552434620028, 7.486328552758163, 26.58825268825034, 15.152078901741955, 25.351117842607948, 25.351592803742612, 18.752722161758157, 27.437350572636653, 15.661052500374867, 9.994914600559937, 44.584557687412506, 14.069633200587901, 0.991420092692568, 22.486476155695904, 4.052529859807569, 22.23805256657637, 10.22931662200449, 34.146853045052374, 4.724047407885297, 21.542226825176634, 3.655342194291176, 29.208137320647396, 18.124700302736144, 35.42676492020259, 26.105746230044033, 12.402427241832646, 14.513665611816997, 15.053842205044486, 12.648741251248236, 26.41385530151348, -4.910462529936833, -0.5296379310709565, -6.4546911913678215, -1.1286469979148315, 44.751674917325374, 14.393411813550134, 29.765539417257216, 11.269227681998508, 29.15006624075219, 43.256546029923626, 11.483462024161739, 25.458831985418083, 5.788303726663663, 14.248078117486505, 33.059331751868484, -4.566437481031752, 5.053952605194469, 5.6781425762061914, 13.587519137157349, 24.462436574725636, 8.761010260530814, 19.286486020809996, 40.3698505692892, 39.85322397464903, 14.614511929724781, 21.659781550799256, 0.11800160950383898, -6.794432815212559, 36.93662663709213, 24.172864626922106, 20.941592673429767, 28.75416981610488, 18.991591558665196, 15.124352414531852, 5.427917720289543, 3.8560531112235026, 6.785646575430505, 28.332257686858824, -3.184442475509454, -3.922553818874592, 32.45385728317082, 35.19992870949616, 9.775996570188347, 15.693796876097856, 1.018268019315201, -10.511601956294237, -12.034363369990672, 2.479293090641738, -0.8152310438556611, 30.62072056669366, 12.805999337678635, 21.79797613488952, 32.78774195867338, 29.7455522764564, -3.1415333560956107, -3.317106879676988, 19.417676131352014, 4.584898929471379, -2.972825517985015, -7.548717533584764, 9.26564444214242, 26.94823678999898, 0.7944378035163862, 18.51623997568161, 39.708606567036476, 26.27584905082395, 36.321059380843536, 33.01897822901895, 6.936983011502951, 9.861124292581533, 27.173660833559822, 38.1935024625892, -3.1100913021088292, 5.052660118347855, 28.5647531100618, 25.284477278719514, 16.071791917334128, 15.720182482498128, 42.520408124846206, 38.09220298854766, 45.77206920739419, 29.45965976377842, 33.12685915079766, 56.97854287215801, 34.77535187726486, -3.424427881463762, 9.504254466887968, 22.475607575891345, 20.427979316357998, 8.561534049632222, 15.428268515751087, -2.931489012323137, 12.73403800233404, 41.55321346761736, 13.401694100439475, 1.8305153675172026, 13.900474558742987, 14.673457826465008, 20.2496678577384, 9.469910681775518, -7.662313035454451, 15.819875860438358, 5.634190251327784, 14.781091467943133, 16.213336227957615, 34.354131963588785, 34.15913583482771, 24.215705610499533, -14.107150273406859, 1.600806495519521, 25.23734593600544, 25.843214645905306, 2.736900888033619, 2.4587667760011267, 13.302009862253712, 20.981968436307586, 16.374307370622603, -12.0846225490594, 28.46124401751447, 2.5918122646984436, 21.74660788190619, 30.28702549601986, 14.41130767268702, -0.5259035515376154, 11.743987340865809, 7.854738149995162, 19.088490208169315, 23.354907004117663, 32.96841816885821, 5.620184039232431, 18.011778120086824, 23.713785910646543, 8.912765822566653, 17.465427084453207, -6.396719180355149, 5.22544242634997, -2.441770264335247, 0.12323764388303715, -15.63952682655121, 5.816008700248798, 9.89004365443107, 2.3816019743923, 17.513801792039857, 6.326730766545612, 10.611847491459136, 2.820353077924195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5895379067482512, "mean_inference_ms": 1.5696102559265106, "mean_action_processing_ms": 0.24350234660888728, "mean_env_wait_ms": 0.13513198781404293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027750730514526367, "StateBufferConnector_ms": 0.0023578405380249023, "ViewRequirementAgentConnector_ms": 0.062383174896240234}, "num_episodes": 18, "episode_return_max": 51.08711556378477, "episode_return_min": -6.25317188894366, "episode_return_mean": 16.097145445851154, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.62319385850327, "num_env_steps_trained_throughput_per_sec": 471.62319385850327, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 2328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2328000, "timers": {"training_iteration_time_ms": 8794.425, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8794.384, "sample_time_ms": 788.54, "learn_time_ms": 7993.801, "learn_throughput": 500.388, "synch_weights_time_ms": 11.633}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "done": false, "training_iteration": 194, "trial_id": "06536_00000", "date": "2024-08-11_17-51-39", "timestamp": 1723413099, "time_this_iter_s": 8.486484289169312, "time_total_s": 4637.3912053108215, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b638bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4637.3912053108215, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 22.907692307692308, "ram_util_percent": 81.03076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.035629396264752, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.059316169967254, "policy_loss": -0.010480171287296496, "vf_loss": 2.0697963359455267, "vf_explained_var": 0.9357777717833717, "kl": 0.012384653860534297, "entropy": 0.38797131612276037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.031438696699799, "cur_kl_coeff": 1.6530389308438423e-40, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5240048936435153, "policy_loss": -0.0022891563837657922, "vf_loss": 2.5262940505825022, "vf_explained_var": 0.9308683549600935, "kl": 0.0032774383288389037, "entropy": 0.2219583152305512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "env_runners": {"episode_reward_max": 45.05270101147786, "episode_reward_min": -6.25317188894366, "episode_reward_mean": 15.643045001597509, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.052701011477836, "predator_policy": -15.63952682655121}, "policy_reward_max": {"prey_policy": 6.253171888943673, "predator_policy": 56.97854287215801}, "policy_reward_mean": {"prey_policy": -15.64304500159751, "predator_policy": 15.64304500159751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.738948124194247, 13.145291213191955, 22.188084833528436, 13.133137116531012, 16.431739757469288, 26.77573261146933, 19.254086735938355, 14.783753908430732, 19.531298276380863, -2.720050230503885, -3.7916690946413265, 29.572543365437763, 20.51738354962784, 36.20330613533793, 18.471147004789902, 10.018190922075119, 14.246447135418359, 5.3660475907003455, 19.0249778559415, 14.023748140670358, 40.11153727196912, 18.137146740261972, -3.3382156028543504, 30.554745632007105, 24.8478812447673, 17.0579719865985, 4.641985415756509, 17.558952131144665, -3.553498147192026, 33.82689299633352, 12.734896723143125, -4.74666696848951, -4.777535139674463, 14.902744761419012, 17.30198773628408, 31.266647117564872, -3.2293201178862905, 12.001287530411707, -5.260771525784887, 18.106940616070673, 9.655338889598994, 32.99222780893023, 34.67001880493126, 8.399053652042236, 32.68358164807454, 0.971284408119514, 26.924615194390693, 15.89598719991612, 40.30630555669692, 37.61586448558625, 45.05270101147786, 15.67546199790056, 15.98993102138966, 14.494756682995112, 6.248389751713977, 27.14362573497573, 7.616104733978338, 14.286966192603995, 14.859789269756966, 4.078781412491922, 10.207640859635434, 25.28373409577321, 29.187420722663646, -6.25317188894366, 25.54028029095538, 2.597833832017365, 17.141989149280644, 2.144842410781619, 15.526528141106464, 26.016816688963008, 6.942702060574705, 9.799362745430495, 21.221698606143473, 19.29430110404534, 20.862782015366694, 13.189096453509945, -0.5856383770025841, -1.1592663102261191, -4.911759063151205, 6.135822814411673, 11.920266279292724, 6.716100284691661, 35.86251425309358, 14.808829708973933, 10.061316267957435, 7.356816753593112, 13.938701788129839, 26.86429181638739, 8.334267448334924, 25.664610166371176, 11.679163857431796, 11.661851221365852, 31.030163903726304, 5.53509589322497, 22.74608662856994, 1.4878316219677785, 17.299519375658974, 36.205319163114176, 32.32140875498599, 3.0067878101342354], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.73894812419423, -13.145291213191975, -22.18808483352843, -13.133137116530978, -16.431739757469295, -26.775732611469323, -19.25408673593833, -14.783753908430747, -19.531298276380845, 2.720050230503891, 3.791669094641321, -29.572543365437745, -20.517383549627862, -36.2033061353379, -18.471147004789913, -10.018190922075082, -14.246447135418364, -5.3660475907003224, -19.024977855941483, -14.0237481406704, -40.11153727196913, -18.13714674026203, 3.3382156028543566, -30.554745632007098, -24.847881244767326, -17.05797198659853, -4.641985415756524, -17.55895213114466, 3.5534981471920197, -33.82689299633349, -12.734896723143105, 4.7466669684895155, 4.777535139674468, -14.902744761418997, -17.30198773628409, -31.266647117564858, 3.2293201178863047, -12.001287530411705, 5.260771525784895, -18.106940616070705, -9.655338889598998, -32.99222780893021, -34.67001880493129, -8.399053652042237, -32.683581648074515, -0.9712844081195109, -26.92461519439067, -15.895987199916128, -40.30630555669698, -37.61586448558636, -45.052701011477836, -15.67546199790057, -15.989931021389651, -14.494756682995131, -6.248389751713976, -27.143625734975707, -7.616104733978337, -14.286966192603993, -14.85978926975696, -4.078781412491926, -10.207640859635458, -25.283734095773198, -29.18742072266364, 6.253171888943673, -25.540280290955366, -2.597833832017372, -17.141989149280644, -2.1448424107815987, -15.526528141106457, -26.01681668896303, -6.942702060574703, -9.799362745430493, -21.221698606143498, -19.294301104045314, -20.86278201536669, -13.189096453509944, 0.5856383770025921, 1.1592663102261058, 4.911759063151211, -6.135822814411691, -11.920266279292733, -6.716100284691657, -35.86251425309356, -14.808829708973938, -10.061316267957455, -7.356816753593118, -13.938701788129874, -26.864291816387446, -8.334267448334924, -25.664610166371233, -11.679163857431819, -11.661851221365847, -31.03016390372629, -5.535095893224982, -22.746086628569916, -1.487831621967782, -17.299519375658978, -36.20531916311418, -32.32140875498605, -3.0067878101342354], "policy_predator_policy_reward": [0.991420092692568, 22.486476155695904, 4.052529859807569, 22.23805256657637, 10.22931662200449, 34.146853045052374, 4.724047407885297, 21.542226825176634, 3.655342194291176, 29.208137320647396, 18.124700302736144, 35.42676492020259, 26.105746230044033, 12.402427241832646, 14.513665611816997, 15.053842205044486, 12.648741251248236, 26.41385530151348, -4.910462529936833, -0.5296379310709565, -6.4546911913678215, -1.1286469979148315, 44.751674917325374, 14.393411813550134, 29.765539417257216, 11.269227681998508, 29.15006624075219, 43.256546029923626, 11.483462024161739, 25.458831985418083, 5.788303726663663, 14.248078117486505, 33.059331751868484, -4.566437481031752, 5.053952605194469, 5.6781425762061914, 13.587519137157349, 24.462436574725636, 8.761010260530814, 19.286486020809996, 40.3698505692892, 39.85322397464903, 14.614511929724781, 21.659781550799256, 0.11800160950383898, -6.794432815212559, 36.93662663709213, 24.172864626922106, 20.941592673429767, 28.75416981610488, 18.991591558665196, 15.124352414531852, 5.427917720289543, 3.8560531112235026, 6.785646575430505, 28.332257686858824, -3.184442475509454, -3.922553818874592, 32.45385728317082, 35.19992870949616, 9.775996570188347, 15.693796876097856, 1.018268019315201, -10.511601956294237, -12.034363369990672, 2.479293090641738, -0.8152310438556611, 30.62072056669366, 12.805999337678635, 21.79797613488952, 32.78774195867338, 29.7455522764564, -3.1415333560956107, -3.317106879676988, 19.417676131352014, 4.584898929471379, -2.972825517985015, -7.548717533584764, 9.26564444214242, 26.94823678999898, 0.7944378035163862, 18.51623997568161, 39.708606567036476, 26.27584905082395, 36.321059380843536, 33.01897822901895, 6.936983011502951, 9.861124292581533, 27.173660833559822, 38.1935024625892, -3.1100913021088292, 5.052660118347855, 28.5647531100618, 25.284477278719514, 16.071791917334128, 15.720182482498128, 42.520408124846206, 38.09220298854766, 45.77206920739419, 29.45965976377842, 33.12685915079766, 56.97854287215801, 34.77535187726486, -3.424427881463762, 9.504254466887968, 22.475607575891345, 20.427979316357998, 8.561534049632222, 15.428268515751087, -2.931489012323137, 12.73403800233404, 41.55321346761736, 13.401694100439475, 1.8305153675172026, 13.900474558742987, 14.673457826465008, 20.2496678577384, 9.469910681775518, -7.662313035454451, 15.819875860438358, 5.634190251327784, 14.781091467943133, 16.213336227957615, 34.354131963588785, 34.15913583482771, 24.215705610499533, -14.107150273406859, 1.600806495519521, 25.23734593600544, 25.843214645905306, 2.736900888033619, 2.4587667760011267, 13.302009862253712, 20.981968436307586, 16.374307370622603, -12.0846225490594, 28.46124401751447, 2.5918122646984436, 21.74660788190619, 30.28702549601986, 14.41130767268702, -0.5259035515376154, 11.743987340865809, 7.854738149995162, 19.088490208169315, 23.354907004117663, 32.96841816885821, 5.620184039232431, 18.011778120086824, 23.713785910646543, 8.912765822566653, 17.465427084453207, -6.396719180355149, 5.22544242634997, -2.441770264335247, 0.12323764388303715, -15.63952682655121, 5.816008700248798, 9.89004365443107, 2.3816019743923, 17.513801792039857, 6.326730766545612, 10.611847491459136, 2.820353077924195, 33.26365648519157, 38.46137202099559, 17.99090930978757, 11.626750108160264, 23.300519714088175, -3.177887178173304, 7.245667575848421, 7.467965931337831, 21.343279062168218, 6.534124514091516, 38.21303269528359, 15.515550937491323, 6.054277070562383, 10.61425782610746, 36.40568709963761, 14.923533233104841, 2.848371756827861, 20.509955958035714, 15.331558410050588, 7.992144032681095, 40.656557904284625, 21.403769903167962, 4.955939477145517, 6.114252309304458, 26.530292719671962, 18.9618805374679, -6.8558041336388404, 9.831467377574402, 18.51059447036403, 16.08844428095391, 47.472403008775096, 24.93823531745326, 22.92965282112579, 41.713164688846284, -0.9585508199650672, 6.972126440233538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5885104773616636, "mean_inference_ms": 1.566591941983278, "mean_action_processing_ms": 0.24310622942822527, "mean_env_wait_ms": 0.13484805219291762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028023719787597656, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06271827220916748}, "num_episodes": 18, "episode_return_max": 45.05270101147786, "episode_return_min": -6.25317188894366, "episode_return_mean": 15.643045001597509, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.70039441383005, "num_env_steps_trained_throughput_per_sec": 458.70039441383005, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 2340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2340000, "timers": {"training_iteration_time_ms": 8743.35, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8743.315, "sample_time_ms": 792.689, "learn_time_ms": 7938.397, "learn_throughput": 503.88, "synch_weights_time_ms": 11.832}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "done": false, "training_iteration": 195, "trial_id": "06536_00000", "date": "2024-08-11_17-51-48", "timestamp": 1723413108, "time_this_iter_s": 8.724272966384888, "time_total_s": 4646.115478277206, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b638bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4646.115478277206, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 23.925, "ram_util_percent": 81.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.669366545105974, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7546512550363937, "policy_loss": -0.004796227664822557, "vf_loss": 1.7594474844634533, "vf_explained_var": 0.9565375945220391, "kl": 0.004629902796793706, "entropy": 0.3579335664088527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.781761279749492, "cur_kl_coeff": 8.265194654219211e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1934870687111343, "policy_loss": -0.0018301419885434881, "vf_loss": 2.1953172124882854, "vf_explained_var": 0.9461187445297443, "kl": 0.0038215261488660744, "entropy": 0.20946889384871437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 45.05270101147786, "episode_reward_min": -8.300591377161428, "episode_reward_mean": 15.424781998144477, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.052701011477836, "predator_policy": -15.63952682655121}, "policy_reward_max": {"prey_policy": 8.300591377161426, "predator_policy": 56.97854287215801}, "policy_reward_mean": {"prey_policy": -15.424781998144477, "predator_policy": 15.424781998144471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.558952131144665, -3.553498147192026, 33.82689299633352, 12.734896723143125, -4.74666696848951, -4.777535139674463, 14.902744761419012, 17.30198773628408, 31.266647117564872, -3.2293201178862905, 12.001287530411707, -5.260771525784887, 18.106940616070673, 9.655338889598994, 32.99222780893023, 34.67001880493126, 8.399053652042236, 32.68358164807454, 0.971284408119514, 26.924615194390693, 15.89598719991612, 40.30630555669692, 37.61586448558625, 45.05270101147786, 15.67546199790056, 15.98993102138966, 14.494756682995112, 6.248389751713977, 27.14362573497573, 7.616104733978338, 14.286966192603995, 14.859789269756966, 4.078781412491922, 10.207640859635434, 25.28373409577321, 29.187420722663646, -6.25317188894366, 25.54028029095538, 2.597833832017365, 17.141989149280644, 2.144842410781619, 15.526528141106464, 26.016816688963008, 6.942702060574705, 9.799362745430495, 21.221698606143473, 19.29430110404534, 20.862782015366694, 13.189096453509945, -0.5856383770025841, -1.1592663102261191, -4.911759063151205, 6.135822814411673, 11.920266279292724, 6.716100284691661, 35.86251425309358, 14.808829708973933, 10.061316267957435, 7.356816753593112, 13.938701788129839, 26.86429181638739, 8.334267448334924, 25.664610166371176, 11.679163857431796, 11.661851221365852, 31.030163903726304, 5.53509589322497, 22.74608662856994, 1.4878316219677785, 17.299519375658974, 36.205319163114176, 32.32140875498599, 3.0067878101342354, 8.53093700450628, 10.928681858933558, 14.616393862938274, 19.863715237285316, 5.460236677890153, 30.054868476791032, 11.274811550520544, 23.058732768598823, -8.300591377161428, 19.38531691046806, 9.284919546549515, -5.060888440177999, 14.737886331064052, 34.25946605879457, 23.294610800106703, 0.05175483115506996, 13.055415639522646, 39.084285358215475, 25.0801032719673, 19.852661146816605, 41.64159400867201, 6.072679322907772, 26.065530028938163, -5.739721472606662, 21.676095692011486, 8.460210125425132, 21.411192075058107], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.55895213114466, 3.5534981471920197, -33.82689299633349, -12.734896723143105, 4.7466669684895155, 4.777535139674468, -14.902744761418997, -17.30198773628409, -31.266647117564858, 3.2293201178863047, -12.001287530411705, 5.260771525784895, -18.106940616070705, -9.655338889598998, -32.99222780893021, -34.67001880493129, -8.399053652042237, -32.683581648074515, -0.9712844081195109, -26.92461519439067, -15.895987199916128, -40.30630555669698, -37.61586448558636, -45.052701011477836, -15.67546199790057, -15.989931021389651, -14.494756682995131, -6.248389751713976, -27.143625734975707, -7.616104733978337, -14.286966192603993, -14.85978926975696, -4.078781412491926, -10.207640859635458, -25.283734095773198, -29.18742072266364, 6.253171888943673, -25.540280290955366, -2.597833832017372, -17.141989149280644, -2.1448424107815987, -15.526528141106457, -26.01681668896303, -6.942702060574703, -9.799362745430493, -21.221698606143498, -19.294301104045314, -20.86278201536669, -13.189096453509944, 0.5856383770025921, 1.1592663102261058, 4.911759063151211, -6.135822814411691, -11.920266279292733, -6.716100284691657, -35.86251425309356, -14.808829708973938, -10.061316267957455, -7.356816753593118, -13.938701788129874, -26.864291816387446, -8.334267448334924, -25.664610166371233, -11.679163857431819, -11.661851221365847, -31.03016390372629, -5.535095893224982, -22.746086628569916, -1.487831621967782, -17.299519375658978, -36.20531916311418, -32.32140875498605, -3.0067878101342354, -8.530937004506299, -10.928681858933562, -14.616393862938267, -19.86371523728528, -5.460236677890148, -30.054868476791036, -11.274811550520528, -23.05873276859881, 8.300591377161426, -19.385316910468035, -9.284919546549496, 5.06088844017799, -14.737886331064049, -34.259466058794644, -23.29461080010666, -0.051754831155071734, -13.055415639522648, -39.08428535821547, -25.080103271967314, -19.852661146816594, -41.641594008672115, -6.072679322907779, -26.065530028938174, 5.739721472606659, -21.676095692011465, -8.460210125425142, -21.41119207505811], "policy_predator_policy_reward": [6.785646575430505, 28.332257686858824, -3.184442475509454, -3.922553818874592, 32.45385728317082, 35.19992870949616, 9.775996570188347, 15.693796876097856, 1.018268019315201, -10.511601956294237, -12.034363369990672, 2.479293090641738, -0.8152310438556611, 30.62072056669366, 12.805999337678635, 21.79797613488952, 32.78774195867338, 29.7455522764564, -3.1415333560956107, -3.317106879676988, 19.417676131352014, 4.584898929471379, -2.972825517985015, -7.548717533584764, 9.26564444214242, 26.94823678999898, 0.7944378035163862, 18.51623997568161, 39.708606567036476, 26.27584905082395, 36.321059380843536, 33.01897822901895, 6.936983011502951, 9.861124292581533, 27.173660833559822, 38.1935024625892, -3.1100913021088292, 5.052660118347855, 28.5647531100618, 25.284477278719514, 16.071791917334128, 15.720182482498128, 42.520408124846206, 38.09220298854766, 45.77206920739419, 29.45965976377842, 33.12685915079766, 56.97854287215801, 34.77535187726486, -3.424427881463762, 9.504254466887968, 22.475607575891345, 20.427979316357998, 8.561534049632222, 15.428268515751087, -2.931489012323137, 12.73403800233404, 41.55321346761736, 13.401694100439475, 1.8305153675172026, 13.900474558742987, 14.673457826465008, 20.2496678577384, 9.469910681775518, -7.662313035454451, 15.819875860438358, 5.634190251327784, 14.781091467943133, 16.213336227957615, 34.354131963588785, 34.15913583482771, 24.215705610499533, -14.107150273406859, 1.600806495519521, 25.23734593600544, 25.843214645905306, 2.736900888033619, 2.4587667760011267, 13.302009862253712, 20.981968436307586, 16.374307370622603, -12.0846225490594, 28.46124401751447, 2.5918122646984436, 21.74660788190619, 30.28702549601986, 14.41130767268702, -0.5259035515376154, 11.743987340865809, 7.854738149995162, 19.088490208169315, 23.354907004117663, 32.96841816885821, 5.620184039232431, 18.011778120086824, 23.713785910646543, 8.912765822566653, 17.465427084453207, -6.396719180355149, 5.22544242634997, -2.441770264335247, 0.12323764388303715, -15.63952682655121, 5.816008700248798, 9.89004365443107, 2.3816019743923, 17.513801792039857, 6.326730766545612, 10.611847491459136, 2.820353077924195, 33.26365648519157, 38.46137202099559, 17.99090930978757, 11.626750108160264, 23.300519714088175, -3.177887178173304, 7.245667575848421, 7.467965931337831, 21.343279062168218, 6.534124514091516, 38.21303269528359, 15.515550937491323, 6.054277070562383, 10.61425782610746, 36.40568709963761, 14.923533233104841, 2.848371756827861, 20.509955958035714, 15.331558410050588, 7.992144032681095, 40.656557904284625, 21.403769903167962, 4.955939477145517, 6.114252309304458, 26.530292719671962, 18.9618805374679, -6.8558041336388404, 9.831467377574402, 18.51059447036403, 16.08844428095391, 47.472403008775096, 24.93823531745326, 22.92965282112579, 41.713164688846284, -0.9585508199650672, 6.972126440233538, -2.2516523144293235, 19.313526323441906, 17.58381694471669, 4.2735467731504375, 7.595724037431334, 21.6370636884452, 8.48248386116311, 31.244946613407457, 3.3499666087935953, 7.570506746986714, 37.68389626637614, 22.425840687205948, 12.955799164344356, 9.593823936696724, 18.016101357735728, 28.10136417946191, -5.762446653865131, -10.838736100457723, 13.983227600794592, 24.787406220141484, 13.623175302258279, 4.946663790840722, -13.939138872442363, 3.817361992086381, 28.391154027336952, 1.0846186347911635, 33.95753700220834, 34.561395115380904, 17.508072243016898, 29.08114935719645, 8.064934452361337, -7.961424790051204, 22.003011007892876, 4.107820271152421, 34.69787388649831, 43.470696829932606, 42.9471603253652, 7.213046218569429, 15.876215955102019, 23.829106338531187, 37.78070560578485, 45.50248241155927, -0.6227491493915371, 12.768107795207083, 31.67935817577819, 20.451701882098163, -11.070631452020251, -0.4088114931930651, 30.377664595599548, 12.974526788423374, 18.40470745224294, -1.4842872013926596, 22.864275084710684, 19.95810906540552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5864762357849359, "mean_inference_ms": 1.559321568156125, "mean_action_processing_ms": 0.24212076229900006, "mean_env_wait_ms": 0.1342174788413385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027486085891723633, "StateBufferConnector_ms": 0.0022329092025756836, "ViewRequirementAgentConnector_ms": 0.06151938438415527}, "num_episodes": 27, "episode_return_max": 45.05270101147786, "episode_return_min": -8.300591377161428, "episode_return_mean": 15.424781998144477, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 461.65066122206383, "num_env_steps_trained_throughput_per_sec": 461.65066122206383, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 8734.563, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8734.531, "sample_time_ms": 791.56, "learn_time_ms": 7930.751, "learn_throughput": 504.366, "synch_weights_time_ms": 11.812}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 196, "trial_id": "06536_00000", "date": "2024-08-11_17-51-56", "timestamp": 1723413116, "time_this_iter_s": 8.668598175048828, "time_total_s": 4654.784076452255, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b58a1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4654.784076452255, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 22.666666666666668, "ram_util_percent": 80.88333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.216264580066006, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2497363422065972, "policy_loss": -0.009830039117271856, "vf_loss": 2.259566395605604, "vf_explained_var": 0.9397463084508976, "kl": 0.007722270179882001, "entropy": 0.3841777930036187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1470429215481674, "cur_kl_coeff": 4.1325973271096056e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4158727290138367, "policy_loss": -0.0012219870235110639, "vf_loss": 2.4170947204821953, "vf_explained_var": 0.9555019645779221, "kl": 0.0029009187077087793, "entropy": 0.1996399159705828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "env_runners": {"episode_reward_max": 45.05270101147786, "episode_reward_min": -9.696565762729284, "episode_reward_mean": 15.679505643662795, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -45.052701011477836, "predator_policy": -15.63952682655121}, "policy_reward_max": {"prey_policy": 9.696565762729286, "predator_policy": 56.97854287215801}, "policy_reward_mean": {"prey_policy": -15.6795056436628, "predator_policy": 15.679505643662797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.971284408119514, 26.924615194390693, 15.89598719991612, 40.30630555669692, 37.61586448558625, 45.05270101147786, 15.67546199790056, 15.98993102138966, 14.494756682995112, 6.248389751713977, 27.14362573497573, 7.616104733978338, 14.286966192603995, 14.859789269756966, 4.078781412491922, 10.207640859635434, 25.28373409577321, 29.187420722663646, -6.25317188894366, 25.54028029095538, 2.597833832017365, 17.141989149280644, 2.144842410781619, 15.526528141106464, 26.016816688963008, 6.942702060574705, 9.799362745430495, 21.221698606143473, 19.29430110404534, 20.862782015366694, 13.189096453509945, -0.5856383770025841, -1.1592663102261191, -4.911759063151205, 6.135822814411673, 11.920266279292724, 6.716100284691661, 35.86251425309358, 14.808829708973933, 10.061316267957435, 7.356816753593112, 13.938701788129839, 26.86429181638739, 8.334267448334924, 25.664610166371176, 11.679163857431796, 11.661851221365852, 31.030163903726304, 5.53509589322497, 22.74608662856994, 1.4878316219677785, 17.299519375658974, 36.205319163114176, 32.32140875498599, 3.0067878101342354, 8.53093700450628, 10.928681858933558, 14.616393862938274, 19.863715237285316, 5.460236677890153, 30.054868476791032, 11.274811550520544, 23.058732768598823, -8.300591377161428, 19.38531691046806, 9.284919546549515, -5.060888440177999, 14.737886331064052, 34.25946605879457, 23.294610800106703, 0.05175483115506996, 13.055415639522646, 39.084285358215475, 25.0801032719673, 19.852661146816605, 41.64159400867201, 6.072679322907772, 26.065530028938163, -5.739721472606662, 21.676095692011486, 8.460210125425132, 21.411192075058107, 13.693302372173038, 21.320507817646632, 22.877865205209734, 14.27619140463292, 24.85722341885515, 25.912774797142767, 13.093040659297147, -9.696565762729284, 16.21168008914752, 16.13527782325486, 5.826174662346757, 15.192004429739423, 10.386229973199217, -0.5315920624135697, 30.15479854039015, 6.7798188326660425, 32.838077562330206, 20.678333305865436], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.9712844081195109, -26.92461519439067, -15.895987199916128, -40.30630555669698, -37.61586448558636, -45.052701011477836, -15.67546199790057, -15.989931021389651, -14.494756682995131, -6.248389751713976, -27.143625734975707, -7.616104733978337, -14.286966192603993, -14.85978926975696, -4.078781412491926, -10.207640859635458, -25.283734095773198, -29.18742072266364, 6.253171888943673, -25.540280290955366, -2.597833832017372, -17.141989149280644, -2.1448424107815987, -15.526528141106457, -26.01681668896303, -6.942702060574703, -9.799362745430493, -21.221698606143498, -19.294301104045314, -20.86278201536669, -13.189096453509944, 0.5856383770025921, 1.1592663102261058, 4.911759063151211, -6.135822814411691, -11.920266279292733, -6.716100284691657, -35.86251425309356, -14.808829708973938, -10.061316267957455, -7.356816753593118, -13.938701788129874, -26.864291816387446, -8.334267448334924, -25.664610166371233, -11.679163857431819, -11.661851221365847, -31.03016390372629, -5.535095893224982, -22.746086628569916, -1.487831621967782, -17.299519375658978, -36.20531916311418, -32.32140875498605, -3.0067878101342354, -8.530937004506299, -10.928681858933562, -14.616393862938267, -19.86371523728528, -5.460236677890148, -30.054868476791036, -11.274811550520528, -23.05873276859881, 8.300591377161426, -19.385316910468035, -9.284919546549496, 5.06088844017799, -14.737886331064049, -34.259466058794644, -23.29461080010666, -0.051754831155071734, -13.055415639522648, -39.08428535821547, -25.080103271967314, -19.852661146816594, -41.641594008672115, -6.072679322907779, -26.065530028938174, 5.739721472606659, -21.676095692011465, -8.460210125425142, -21.41119207505811, -13.693302372173033, -21.320507817646636, -22.877865205209734, -14.276191404632907, -24.857223418855167, -25.91277479714279, -13.093040659297166, 9.696565762729286, -16.211680089147556, -16.135277823254825, -5.826174662346783, -15.192004429739429, -10.386229973199226, 0.5315920624135688, -30.154798540390104, -6.779818832666061, -32.83807756233015, -20.678333305865443], "policy_predator_policy_reward": [-3.1100913021088292, 5.052660118347855, 28.5647531100618, 25.284477278719514, 16.071791917334128, 15.720182482498128, 42.520408124846206, 38.09220298854766, 45.77206920739419, 29.45965976377842, 33.12685915079766, 56.97854287215801, 34.77535187726486, -3.424427881463762, 9.504254466887968, 22.475607575891345, 20.427979316357998, 8.561534049632222, 15.428268515751087, -2.931489012323137, 12.73403800233404, 41.55321346761736, 13.401694100439475, 1.8305153675172026, 13.900474558742987, 14.673457826465008, 20.2496678577384, 9.469910681775518, -7.662313035454451, 15.819875860438358, 5.634190251327784, 14.781091467943133, 16.213336227957615, 34.354131963588785, 34.15913583482771, 24.215705610499533, -14.107150273406859, 1.600806495519521, 25.23734593600544, 25.843214645905306, 2.736900888033619, 2.4587667760011267, 13.302009862253712, 20.981968436307586, 16.374307370622603, -12.0846225490594, 28.46124401751447, 2.5918122646984436, 21.74660788190619, 30.28702549601986, 14.41130767268702, -0.5259035515376154, 11.743987340865809, 7.854738149995162, 19.088490208169315, 23.354907004117663, 32.96841816885821, 5.620184039232431, 18.011778120086824, 23.713785910646543, 8.912765822566653, 17.465427084453207, -6.396719180355149, 5.22544242634997, -2.441770264335247, 0.12323764388303715, -15.63952682655121, 5.816008700248798, 9.89004365443107, 2.3816019743923, 17.513801792039857, 6.326730766545612, 10.611847491459136, 2.820353077924195, 33.26365648519157, 38.46137202099559, 17.99090930978757, 11.626750108160264, 23.300519714088175, -3.177887178173304, 7.245667575848421, 7.467965931337831, 21.343279062168218, 6.534124514091516, 38.21303269528359, 15.515550937491323, 6.054277070562383, 10.61425782610746, 36.40568709963761, 14.923533233104841, 2.848371756827861, 20.509955958035714, 15.331558410050588, 7.992144032681095, 40.656557904284625, 21.403769903167962, 4.955939477145517, 6.114252309304458, 26.530292719671962, 18.9618805374679, -6.8558041336388404, 9.831467377574402, 18.51059447036403, 16.08844428095391, 47.472403008775096, 24.93823531745326, 22.92965282112579, 41.713164688846284, -0.9585508199650672, 6.972126440233538, -2.2516523144293235, 19.313526323441906, 17.58381694471669, 4.2735467731504375, 7.595724037431334, 21.6370636884452, 8.48248386116311, 31.244946613407457, 3.3499666087935953, 7.570506746986714, 37.68389626637614, 22.425840687205948, 12.955799164344356, 9.593823936696724, 18.016101357735728, 28.10136417946191, -5.762446653865131, -10.838736100457723, 13.983227600794592, 24.787406220141484, 13.623175302258279, 4.946663790840722, -13.939138872442363, 3.817361992086381, 28.391154027336952, 1.0846186347911635, 33.95753700220834, 34.561395115380904, 17.508072243016898, 29.08114935719645, 8.064934452361337, -7.961424790051204, 22.003011007892876, 4.107820271152421, 34.69787388649831, 43.470696829932606, 42.9471603253652, 7.213046218569429, 15.876215955102019, 23.829106338531187, 37.78070560578485, 45.50248241155927, -0.6227491493915371, 12.768107795207083, 31.67935817577819, 20.451701882098163, -11.070631452020251, -0.4088114931930651, 30.377664595599548, 12.974526788423374, 18.40470745224294, -1.4842872013926596, 22.864275084710684, 19.95810906540552, 4.750221577365297, 22.636383166980764, 15.111893148423697, 27.529122486869554, 35.5165598388195, 10.239170571599924, -1.4467849593249884, 29.999167768590787, 30.114281108035517, 19.600165729674757, 14.645944701729185, 37.17960489255641, 7.463598504802386, 18.722482813791984, -5.817351125218702, -13.575780400239864, 28.736664474138337, 3.6866957041567616, 31.48056921044472, 0.7899864360649627, -4.326717909664095, 15.97906723435764, 8.026921947683551, 22.35708691179529, -0.3613723548228416, 21.13383230122133, -0.24125258607296018, -0.8219315387541766, 26.486721664713468, 33.82287541606681, 4.391758614627896, 9.167879050704213, 32.63245298977412, 33.04370213488627, 9.949966917870755, 31.406699693860123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5859829458023927, "mean_inference_ms": 1.5591475088601805, "mean_action_processing_ms": 0.24213089495635073, "mean_env_wait_ms": 0.1341513261704181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027581453323364258, "StateBufferConnector_ms": 0.0022389888763427734, "ViewRequirementAgentConnector_ms": 0.06129777431488037}, "num_episodes": 18, "episode_return_max": 45.05270101147786, "episode_return_min": -9.696565762729284, "episode_return_mean": 15.679505643662795, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.6755605671993, "num_env_steps_trained_throughput_per_sec": 447.6755605671993, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 2364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2364000, "timers": {"training_iteration_time_ms": 8731.817, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8731.785, "sample_time_ms": 787.557, "learn_time_ms": 7931.983, "learn_throughput": 504.287, "synch_weights_time_ms": 11.824}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "done": false, "training_iteration": 197, "trial_id": "06536_00000", "date": "2024-08-11_17-52-05", "timestamp": 1723413125, "time_this_iter_s": 8.939366102218628, "time_total_s": 4663.723442554474, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b589a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4663.723442554474, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 25.6, "ram_util_percent": 80.8076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.552596646050612, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6178481235479316, "policy_loss": -0.007543303252653762, "vf_loss": 1.6253914231434465, "vf_explained_var": 0.9440798794850707, "kl": 0.005621996091141033, "entropy": 0.37085739538694423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7079837475504194, "cur_kl_coeff": 2.0662986635548028e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9233818638892402, "policy_loss": -0.0011242497340337467, "vf_loss": 1.92450611402118, "vf_explained_var": 0.9505280475137095, "kl": 0.0026586649800470247, "entropy": 0.18879371823141813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "env_runners": {"episode_reward_max": 41.64159400867201, "episode_reward_min": -9.696565762729284, "episode_reward_mean": 15.328165639032349, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.641594008672115, "predator_policy": -15.63952682655121}, "policy_reward_max": {"prey_policy": 9.696565762729286, "predator_policy": 47.472403008775096}, "policy_reward_mean": {"prey_policy": -15.328165639032353, "predator_policy": 15.328165639032354}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.25317188894366, 25.54028029095538, 2.597833832017365, 17.141989149280644, 2.144842410781619, 15.526528141106464, 26.016816688963008, 6.942702060574705, 9.799362745430495, 21.221698606143473, 19.29430110404534, 20.862782015366694, 13.189096453509945, -0.5856383770025841, -1.1592663102261191, -4.911759063151205, 6.135822814411673, 11.920266279292724, 6.716100284691661, 35.86251425309358, 14.808829708973933, 10.061316267957435, 7.356816753593112, 13.938701788129839, 26.86429181638739, 8.334267448334924, 25.664610166371176, 11.679163857431796, 11.661851221365852, 31.030163903726304, 5.53509589322497, 22.74608662856994, 1.4878316219677785, 17.299519375658974, 36.205319163114176, 32.32140875498599, 3.0067878101342354, 8.53093700450628, 10.928681858933558, 14.616393862938274, 19.863715237285316, 5.460236677890153, 30.054868476791032, 11.274811550520544, 23.058732768598823, -8.300591377161428, 19.38531691046806, 9.284919546549515, -5.060888440177999, 14.737886331064052, 34.25946605879457, 23.294610800106703, 0.05175483115506996, 13.055415639522646, 39.084285358215475, 25.0801032719673, 19.852661146816605, 41.64159400867201, 6.072679322907772, 26.065530028938163, -5.739721472606662, 21.676095692011486, 8.460210125425132, 21.411192075058107, 13.693302372173038, 21.320507817646632, 22.877865205209734, 14.27619140463292, 24.85722341885515, 25.912774797142767, 13.093040659297147, -9.696565762729284, 16.21168008914752, 16.13527782325486, 5.826174662346757, 15.192004429739423, 10.386229973199217, -0.5315920624135697, 30.15479854039015, 6.7798188326660425, 32.838077562330206, 20.678333305865436, 27.05611783856501, 3.3520205966731424, 15.447851626600198, 18.53111614988063, 2.683097168636505, 23.069209666008813, 10.88742434913995, 30.87505574806621, 37.42862561200163, 22.558554380724342, 0.6432367125781857, 10.518452759393083, 33.00600472908518, 26.76346499269191, 21.918404064121475, 18.35514682317581, 10.04529154860933, 3.566285103069858], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.253171888943673, -25.540280290955366, -2.597833832017372, -17.141989149280644, -2.1448424107815987, -15.526528141106457, -26.01681668896303, -6.942702060574703, -9.799362745430493, -21.221698606143498, -19.294301104045314, -20.86278201536669, -13.189096453509944, 0.5856383770025921, 1.1592663102261058, 4.911759063151211, -6.135822814411691, -11.920266279292733, -6.716100284691657, -35.86251425309356, -14.808829708973938, -10.061316267957455, -7.356816753593118, -13.938701788129874, -26.864291816387446, -8.334267448334924, -25.664610166371233, -11.679163857431819, -11.661851221365847, -31.03016390372629, -5.535095893224982, -22.746086628569916, -1.487831621967782, -17.299519375658978, -36.20531916311418, -32.32140875498605, -3.0067878101342354, -8.530937004506299, -10.928681858933562, -14.616393862938267, -19.86371523728528, -5.460236677890148, -30.054868476791036, -11.274811550520528, -23.05873276859881, 8.300591377161426, -19.385316910468035, -9.284919546549496, 5.06088844017799, -14.737886331064049, -34.259466058794644, -23.29461080010666, -0.051754831155071734, -13.055415639522648, -39.08428535821547, -25.080103271967314, -19.852661146816594, -41.641594008672115, -6.072679322907779, -26.065530028938174, 5.739721472606659, -21.676095692011465, -8.460210125425142, -21.41119207505811, -13.693302372173033, -21.320507817646636, -22.877865205209734, -14.276191404632907, -24.857223418855167, -25.91277479714279, -13.093040659297166, 9.696565762729286, -16.211680089147556, -16.135277823254825, -5.826174662346783, -15.192004429739429, -10.386229973199226, 0.5315920624135688, -30.154798540390104, -6.779818832666061, -32.83807756233015, -20.678333305865443, -27.056117838565065, -3.352020596673122, -15.447851626600132, -18.531116149880646, -2.6830971686365084, -23.069209666008778, -10.887424349139927, -30.875055748066217, -37.428625612001674, -22.558554380724356, -0.6432367125781768, -10.518452759393092, -33.006004729085205, -26.763464992691894, -21.918404064121482, -18.355146823175815, -10.04529154860937, -3.566285103069835], "policy_predator_policy_reward": [-14.107150273406859, 1.600806495519521, 25.23734593600544, 25.843214645905306, 2.736900888033619, 2.4587667760011267, 13.302009862253712, 20.981968436307586, 16.374307370622603, -12.0846225490594, 28.46124401751447, 2.5918122646984436, 21.74660788190619, 30.28702549601986, 14.41130767268702, -0.5259035515376154, 11.743987340865809, 7.854738149995162, 19.088490208169315, 23.354907004117663, 32.96841816885821, 5.620184039232431, 18.011778120086824, 23.713785910646543, 8.912765822566653, 17.465427084453207, -6.396719180355149, 5.22544242634997, -2.441770264335247, 0.12323764388303715, -15.63952682655121, 5.816008700248798, 9.89004365443107, 2.3816019743923, 17.513801792039857, 6.326730766545612, 10.611847491459136, 2.820353077924195, 33.26365648519157, 38.46137202099559, 17.99090930978757, 11.626750108160264, 23.300519714088175, -3.177887178173304, 7.245667575848421, 7.467965931337831, 21.343279062168218, 6.534124514091516, 38.21303269528359, 15.515550937491323, 6.054277070562383, 10.61425782610746, 36.40568709963761, 14.923533233104841, 2.848371756827861, 20.509955958035714, 15.331558410050588, 7.992144032681095, 40.656557904284625, 21.403769903167962, 4.955939477145517, 6.114252309304458, 26.530292719671962, 18.9618805374679, -6.8558041336388404, 9.831467377574402, 18.51059447036403, 16.08844428095391, 47.472403008775096, 24.93823531745326, 22.92965282112579, 41.713164688846284, -0.9585508199650672, 6.972126440233538, -2.2516523144293235, 19.313526323441906, 17.58381694471669, 4.2735467731504375, 7.595724037431334, 21.6370636884452, 8.48248386116311, 31.244946613407457, 3.3499666087935953, 7.570506746986714, 37.68389626637614, 22.425840687205948, 12.955799164344356, 9.593823936696724, 18.016101357735728, 28.10136417946191, -5.762446653865131, -10.838736100457723, 13.983227600794592, 24.787406220141484, 13.623175302258279, 4.946663790840722, -13.939138872442363, 3.817361992086381, 28.391154027336952, 1.0846186347911635, 33.95753700220834, 34.561395115380904, 17.508072243016898, 29.08114935719645, 8.064934452361337, -7.961424790051204, 22.003011007892876, 4.107820271152421, 34.69787388649831, 43.470696829932606, 42.9471603253652, 7.213046218569429, 15.876215955102019, 23.829106338531187, 37.78070560578485, 45.50248241155927, -0.6227491493915371, 12.768107795207083, 31.67935817577819, 20.451701882098163, -11.070631452020251, -0.4088114931930651, 30.377664595599548, 12.974526788423374, 18.40470745224294, -1.4842872013926596, 22.864275084710684, 19.95810906540552, 4.750221577365297, 22.636383166980764, 15.111893148423697, 27.529122486869554, 35.5165598388195, 10.239170571599924, -1.4467849593249884, 29.999167768590787, 30.114281108035517, 19.600165729674757, 14.645944701729185, 37.17960489255641, 7.463598504802386, 18.722482813791984, -5.817351125218702, -13.575780400239864, 28.736664474138337, 3.6866957041567616, 31.48056921044472, 0.7899864360649627, -4.326717909664095, 15.97906723435764, 8.026921947683551, 22.35708691179529, -0.3613723548228416, 21.13383230122133, -0.24125258607296018, -0.8219315387541766, 26.486721664713468, 33.82287541606681, 4.391758614627896, 9.167879050704213, 32.63245298977412, 33.04370213488627, 9.949966917870755, 31.406699693860123, 21.954385741535177, 32.15784993559493, 7.5772338772162815, -0.8731926838700321, 23.678498442379396, 7.217204810820888, 19.792840448564775, 17.26939185119651, -3.588677836157105, 8.954872173430118, 21.235780369560363, 24.902638962457235, -2.6630892418455137, 24.437937940125362, 43.93505945400432, 17.815052042128077, 42.07961622916767, 32.777634994835616, 25.38530393954305, 19.731804821905655, 0.6886367169255525, 0.5978367082308313, 6.979975162138205, 14.056930356647982, 19.05222406323039, 46.95978539494002, 33.411429232107764, 20.115500753276077, 21.20312288065869, 22.633685247584275, 2.351834390136575, 34.35845925621504, -13.61758909934057, 33.7081721965593, 5.132567885549905, 2.000002320589793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5849896773705855, "mean_inference_ms": 1.5562370305316926, "mean_action_processing_ms": 0.24176039624035256, "mean_env_wait_ms": 0.13387522878232816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002810359001159668, "StateBufferConnector_ms": 0.002280116081237793, "ViewRequirementAgentConnector_ms": 0.06300294399261475}, "num_episodes": 18, "episode_return_max": 41.64159400867201, "episode_return_min": -9.696565762729284, "episode_return_mean": 15.328165639032349, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.35066801289355, "num_env_steps_trained_throughput_per_sec": 446.35066801289355, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 2376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2376000, "timers": {"training_iteration_time_ms": 8749.858, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8749.826, "sample_time_ms": 795.983, "learn_time_ms": 7941.217, "learn_throughput": 503.701, "synch_weights_time_ms": 12.205}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "done": false, "training_iteration": 198, "trial_id": "06536_00000", "date": "2024-08-11_17-52-14", "timestamp": 1723413134, "time_this_iter_s": 8.966250896453857, "time_total_s": 4672.689693450928, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b59158b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4672.689693450928, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 28.376923076923084, "ram_util_percent": 80.98461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.825368128841122, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.872903177763025, "policy_loss": -0.00852945291311092, "vf_loss": 1.8814326299975315, "vf_explained_var": 0.944531086521844, "kl": 0.006653629042391617, "entropy": 0.34093867462749283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.834767828795014, "cur_kl_coeff": 1.0331493317774014e-41, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.026216072317154, "policy_loss": -0.0014807024299260721, "vf_loss": 2.027696778786876, "vf_explained_var": 0.9523606766468633, "kl": 0.0025186330756037747, "entropy": 0.17886522909793903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "env_runners": {"episode_reward_max": 41.64159400867201, "episode_reward_min": -9.696565762729284, "episode_reward_mean": 16.320587556906318, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.641594008672115, "predator_policy": -13.939138872442363}, "policy_reward_max": {"prey_policy": 9.696565762729286, "predator_policy": 47.472403008775096}, "policy_reward_mean": {"prey_policy": -16.32058755690632, "predator_policy": 16.320587556906318}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.716100284691661, 35.86251425309358, 14.808829708973933, 10.061316267957435, 7.356816753593112, 13.938701788129839, 26.86429181638739, 8.334267448334924, 25.664610166371176, 11.679163857431796, 11.661851221365852, 31.030163903726304, 5.53509589322497, 22.74608662856994, 1.4878316219677785, 17.299519375658974, 36.205319163114176, 32.32140875498599, 3.0067878101342354, 8.53093700450628, 10.928681858933558, 14.616393862938274, 19.863715237285316, 5.460236677890153, 30.054868476791032, 11.274811550520544, 23.058732768598823, -8.300591377161428, 19.38531691046806, 9.284919546549515, -5.060888440177999, 14.737886331064052, 34.25946605879457, 23.294610800106703, 0.05175483115506996, 13.055415639522646, 39.084285358215475, 25.0801032719673, 19.852661146816605, 41.64159400867201, 6.072679322907772, 26.065530028938163, -5.739721472606662, 21.676095692011486, 8.460210125425132, 21.411192075058107, 13.693302372173038, 21.320507817646632, 22.877865205209734, 14.27619140463292, 24.85722341885515, 25.912774797142767, 13.093040659297147, -9.696565762729284, 16.21168008914752, 16.13527782325486, 5.826174662346757, 15.192004429739423, 10.386229973199217, -0.5315920624135697, 30.15479854039015, 6.7798188326660425, 32.838077562330206, 20.678333305865436, 27.05611783856501, 3.3520205966731424, 15.447851626600198, 18.53111614988063, 2.683097168636505, 23.069209666008813, 10.88742434913995, 30.87505574806621, 37.42862561200163, 22.558554380724342, 0.6432367125781857, 10.518452759393083, 33.00600472908518, 26.76346499269191, 21.918404064121475, 18.35514682317581, 10.04529154860933, 3.566285103069858, 24.028912123406325, 23.74970265138017, 11.714732424563518, 8.22988280943548, 36.457278249149326, 18.907701719786175, 11.51295848420901, 23.226658381500325, 22.537957227496058, 14.571503963705382, 7.348074624239307, 16.779823382436717, 13.03765058369834, 21.71134682509775, 17.028088583436286, -6.343596375768795, 11.865876879423292, 8.302126202758116], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.716100284691657, -35.86251425309356, -14.808829708973938, -10.061316267957455, -7.356816753593118, -13.938701788129874, -26.864291816387446, -8.334267448334924, -25.664610166371233, -11.679163857431819, -11.661851221365847, -31.03016390372629, -5.535095893224982, -22.746086628569916, -1.487831621967782, -17.299519375658978, -36.20531916311418, -32.32140875498605, -3.0067878101342354, -8.530937004506299, -10.928681858933562, -14.616393862938267, -19.86371523728528, -5.460236677890148, -30.054868476791036, -11.274811550520528, -23.05873276859881, 8.300591377161426, -19.385316910468035, -9.284919546549496, 5.06088844017799, -14.737886331064049, -34.259466058794644, -23.29461080010666, -0.051754831155071734, -13.055415639522648, -39.08428535821547, -25.080103271967314, -19.852661146816594, -41.641594008672115, -6.072679322907779, -26.065530028938174, 5.739721472606659, -21.676095692011465, -8.460210125425142, -21.41119207505811, -13.693302372173033, -21.320507817646636, -22.877865205209734, -14.276191404632907, -24.857223418855167, -25.91277479714279, -13.093040659297166, 9.696565762729286, -16.211680089147556, -16.135277823254825, -5.826174662346783, -15.192004429739429, -10.386229973199226, 0.5315920624135688, -30.154798540390104, -6.779818832666061, -32.83807756233015, -20.678333305865443, -27.056117838565065, -3.352020596673122, -15.447851626600132, -18.531116149880646, -2.6830971686365084, -23.069209666008778, -10.887424349139927, -30.875055748066217, -37.428625612001674, -22.558554380724356, -0.6432367125781768, -10.518452759393092, -33.006004729085205, -26.763464992691894, -21.918404064121482, -18.355146823175815, -10.04529154860937, -3.566285103069835, -24.028912123406364, -23.749702651380105, -11.714732424563522, -8.22988280943546, -36.45727824914934, -18.90770171978618, -11.512958484209026, -23.226658381500286, -22.537957227496005, -14.571503963705391, -7.348074624239297, -16.77982338243674, -13.037650583698356, -21.711346825097753, -17.02808858343625, 6.343596375768814, -11.865876879423276, -8.302126202758092], "policy_predator_policy_reward": [10.611847491459136, 2.820353077924195, 33.26365648519157, 38.46137202099559, 17.99090930978757, 11.626750108160264, 23.300519714088175, -3.177887178173304, 7.245667575848421, 7.467965931337831, 21.343279062168218, 6.534124514091516, 38.21303269528359, 15.515550937491323, 6.054277070562383, 10.61425782610746, 36.40568709963761, 14.923533233104841, 2.848371756827861, 20.509955958035714, 15.331558410050588, 7.992144032681095, 40.656557904284625, 21.403769903167962, 4.955939477145517, 6.114252309304458, 26.530292719671962, 18.9618805374679, -6.8558041336388404, 9.831467377574402, 18.51059447036403, 16.08844428095391, 47.472403008775096, 24.93823531745326, 22.92965282112579, 41.713164688846284, -0.9585508199650672, 6.972126440233538, -2.2516523144293235, 19.313526323441906, 17.58381694471669, 4.2735467731504375, 7.595724037431334, 21.6370636884452, 8.48248386116311, 31.244946613407457, 3.3499666087935953, 7.570506746986714, 37.68389626637614, 22.425840687205948, 12.955799164344356, 9.593823936696724, 18.016101357735728, 28.10136417946191, -5.762446653865131, -10.838736100457723, 13.983227600794592, 24.787406220141484, 13.623175302258279, 4.946663790840722, -13.939138872442363, 3.817361992086381, 28.391154027336952, 1.0846186347911635, 33.95753700220834, 34.561395115380904, 17.508072243016898, 29.08114935719645, 8.064934452361337, -7.961424790051204, 22.003011007892876, 4.107820271152421, 34.69787388649831, 43.470696829932606, 42.9471603253652, 7.213046218569429, 15.876215955102019, 23.829106338531187, 37.78070560578485, 45.50248241155927, -0.6227491493915371, 12.768107795207083, 31.67935817577819, 20.451701882098163, -11.070631452020251, -0.4088114931930651, 30.377664595599548, 12.974526788423374, 18.40470745224294, -1.4842872013926596, 22.864275084710684, 19.95810906540552, 4.750221577365297, 22.636383166980764, 15.111893148423697, 27.529122486869554, 35.5165598388195, 10.239170571599924, -1.4467849593249884, 29.999167768590787, 30.114281108035517, 19.600165729674757, 14.645944701729185, 37.17960489255641, 7.463598504802386, 18.722482813791984, -5.817351125218702, -13.575780400239864, 28.736664474138337, 3.6866957041567616, 31.48056921044472, 0.7899864360649627, -4.326717909664095, 15.97906723435764, 8.026921947683551, 22.35708691179529, -0.3613723548228416, 21.13383230122133, -0.24125258607296018, -0.8219315387541766, 26.486721664713468, 33.82287541606681, 4.391758614627896, 9.167879050704213, 32.63245298977412, 33.04370213488627, 9.949966917870755, 31.406699693860123, 21.954385741535177, 32.15784993559493, 7.5772338772162815, -0.8731926838700321, 23.678498442379396, 7.217204810820888, 19.792840448564775, 17.26939185119651, -3.588677836157105, 8.954872173430118, 21.235780369560363, 24.902638962457235, -2.6630892418455137, 24.437937940125362, 43.93505945400432, 17.815052042128077, 42.07961622916767, 32.777634994835616, 25.38530393954305, 19.731804821905655, 0.6886367169255525, 0.5978367082308313, 6.979975162138205, 14.056930356647982, 19.05222406323039, 46.95978539494002, 33.411429232107764, 20.115500753276077, 21.20312288065869, 22.633685247584275, 2.351834390136575, 34.35845925621504, -13.61758909934057, 33.7081721965593, 5.132567885549905, 2.000002320589793, 15.827876353071161, 32.22994789374151, 8.647192266515603, 38.85221303624464, 10.439998881990896, 12.989465967136137, 11.646266963222779, 4.813498655648159, 30.869522668154648, 42.04503383014398, 28.507930619123535, 9.307472820448853, 7.957674222297621, 15.068242746120424, 25.66583809116537, 20.787478671835228, 25.875067498870685, 19.200846956121342, 0.2764977198993357, 28.86651020751144, 13.970760898561775, 0.7253883499168285, 27.791670392185274, 5.767976372688233, 12.056494565528755, 14.018806601867976, 18.513885615271796, 24.90880803492371, 13.760346074886519, 20.295831091986045, -7.014188663481869, -5.67300408805575, 8.471266500579388, 15.260487258267174, -5.6605924140479935, 22.26484481956419]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5839997190435792, "mean_inference_ms": 1.5533460316422258, "mean_action_processing_ms": 0.2413893745922783, "mean_env_wait_ms": 0.1336012725405135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028029680252075195, "StateBufferConnector_ms": 0.0022925138473510742, "ViewRequirementAgentConnector_ms": 0.061946868896484375}, "num_episodes": 18, "episode_return_max": 41.64159400867201, "episode_return_min": -9.696565762729284, "episode_return_mean": 16.320587556906318, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.16821811847626, "num_env_steps_trained_throughput_per_sec": 443.16821811847626, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 2388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2388000, "timers": {"training_iteration_time_ms": 8807.642, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8807.609, "sample_time_ms": 786.455, "learn_time_ms": 8008.497, "learn_throughput": 499.469, "synch_weights_time_ms": 12.239}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "done": false, "training_iteration": 199, "trial_id": "06536_00000", "date": "2024-08-11_17-52-23", "timestamp": 1723413143, "time_this_iter_s": 9.031195163726807, "time_total_s": 4681.7208886146545, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b644df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4681.7208886146545, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 27.06153846153846, "ram_util_percent": 81.61538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9530067569265763, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5711676434924204, "policy_loss": -0.005259744557163989, "vf_loss": 1.5764273804302016, "vf_explained_var": 0.9681790923699737, "kl": 0.005496268067652569, "entropy": 0.34722548581970236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8647633314763428, "cur_kl_coeff": 5.165746658887007e-42, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.877151934684269, "policy_loss": -0.001016490593880277, "vf_loss": 1.878168425105867, "vf_explained_var": 0.9628496533979184, "kl": 0.0014563506493608675, "entropy": 0.16770355934425005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 41.64159400867201, "episode_reward_min": -9.696565762729284, "episode_reward_mean": 16.001711867896873, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.641594008672115, "predator_policy": -15.074004620479553}, "policy_reward_max": {"prey_policy": 9.696565762729286, "predator_policy": 51.662084945190074}, "policy_reward_mean": {"prey_policy": -16.00171186789687, "predator_policy": 16.00171186789687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.300591377161428, 19.38531691046806, 9.284919546549515, -5.060888440177999, 14.737886331064052, 34.25946605879457, 23.294610800106703, 0.05175483115506996, 13.055415639522646, 39.084285358215475, 25.0801032719673, 19.852661146816605, 41.64159400867201, 6.072679322907772, 26.065530028938163, -5.739721472606662, 21.676095692011486, 8.460210125425132, 21.411192075058107, 13.693302372173038, 21.320507817646632, 22.877865205209734, 14.27619140463292, 24.85722341885515, 25.912774797142767, 13.093040659297147, -9.696565762729284, 16.21168008914752, 16.13527782325486, 5.826174662346757, 15.192004429739423, 10.386229973199217, -0.5315920624135697, 30.15479854039015, 6.7798188326660425, 32.838077562330206, 20.678333305865436, 27.05611783856501, 3.3520205966731424, 15.447851626600198, 18.53111614988063, 2.683097168636505, 23.069209666008813, 10.88742434913995, 30.87505574806621, 37.42862561200163, 22.558554380724342, 0.6432367125781857, 10.518452759393083, 33.00600472908518, 26.76346499269191, 21.918404064121475, 18.35514682317581, 10.04529154860933, 3.566285103069858, 24.028912123406325, 23.74970265138017, 11.714732424563518, 8.22988280943548, 36.457278249149326, 18.907701719786175, 11.51295848420901, 23.226658381500325, 22.537957227496058, 14.571503963705382, 7.348074624239307, 16.779823382436717, 13.03765058369834, 21.71134682509775, 17.028088583436286, -6.343596375768795, 11.865876879423292, 8.302126202758116, 29.699380499414065, 11.454978446470216, 10.963426740421657, 7.115731126016032, 5.121097069340692, 11.904535096953998, 19.996696086503658, 38.76318086923382, 33.162103683656866, 4.9270147378573395, 36.79474409432657, 17.955867236083343, 23.866818313711278, 0.5234736204755901, 29.724971448413463, 13.195635599257068, -6.894499255308717, 8.843798606180258, 17.503305846796074, 29.409798935957415, 22.653758389844636, 1.2749247635445453, 17.45968687253826, 15.514321519147089, 24.642473159317685, -8.032365702721798, -3.063372549198747], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.300591377161426, -19.385316910468035, -9.284919546549496, 5.06088844017799, -14.737886331064049, -34.259466058794644, -23.29461080010666, -0.051754831155071734, -13.055415639522648, -39.08428535821547, -25.080103271967314, -19.852661146816594, -41.641594008672115, -6.072679322907779, -26.065530028938174, 5.739721472606659, -21.676095692011465, -8.460210125425142, -21.41119207505811, -13.693302372173033, -21.320507817646636, -22.877865205209734, -14.276191404632907, -24.857223418855167, -25.91277479714279, -13.093040659297166, 9.696565762729286, -16.211680089147556, -16.135277823254825, -5.826174662346783, -15.192004429739429, -10.386229973199226, 0.5315920624135688, -30.154798540390104, -6.779818832666061, -32.83807756233015, -20.678333305865443, -27.056117838565065, -3.352020596673122, -15.447851626600132, -18.531116149880646, -2.6830971686365084, -23.069209666008778, -10.887424349139927, -30.875055748066217, -37.428625612001674, -22.558554380724356, -0.6432367125781768, -10.518452759393092, -33.006004729085205, -26.763464992691894, -21.918404064121482, -18.355146823175815, -10.04529154860937, -3.566285103069835, -24.028912123406364, -23.749702651380105, -11.714732424563522, -8.22988280943546, -36.45727824914934, -18.90770171978618, -11.512958484209026, -23.226658381500286, -22.537957227496005, -14.571503963705391, -7.348074624239297, -16.77982338243674, -13.037650583698356, -21.711346825097753, -17.02808858343625, 6.343596375768814, -11.865876879423276, -8.302126202758092, -29.69938049941406, -11.454978446470275, -10.96342674042168, -7.115731126016033, -5.121097069340705, -11.904535096954032, -19.996696086503647, -38.76318086923377, -33.16210368365693, -4.927014737857307, -36.79474409432655, -17.955867236083318, -23.866818313711303, -0.5234736204755501, -29.724971448413434, -13.195635599257052, 6.894499255308719, -8.843798606180242, -17.50330584679602, -29.409798935957422, -22.65375838984466, -1.2749247635445462, -17.459686872538253, -15.514321519147057, -24.642473159317735, 8.03236570272179, 3.063372549198749], "policy_predator_policy_reward": [-5.762446653865131, -10.838736100457723, 13.983227600794592, 24.787406220141484, 13.623175302258279, 4.946663790840722, -13.939138872442363, 3.817361992086381, 28.391154027336952, 1.0846186347911635, 33.95753700220834, 34.561395115380904, 17.508072243016898, 29.08114935719645, 8.064934452361337, -7.961424790051204, 22.003011007892876, 4.107820271152421, 34.69787388649831, 43.470696829932606, 42.9471603253652, 7.213046218569429, 15.876215955102019, 23.829106338531187, 37.78070560578485, 45.50248241155927, -0.6227491493915371, 12.768107795207083, 31.67935817577819, 20.451701882098163, -11.070631452020251, -0.4088114931930651, 30.377664595599548, 12.974526788423374, 18.40470745224294, -1.4842872013926596, 22.864275084710684, 19.95810906540552, 4.750221577365297, 22.636383166980764, 15.111893148423697, 27.529122486869554, 35.5165598388195, 10.239170571599924, -1.4467849593249884, 29.999167768590787, 30.114281108035517, 19.600165729674757, 14.645944701729185, 37.17960489255641, 7.463598504802386, 18.722482813791984, -5.817351125218702, -13.575780400239864, 28.736664474138337, 3.6866957041567616, 31.48056921044472, 0.7899864360649627, -4.326717909664095, 15.97906723435764, 8.026921947683551, 22.35708691179529, -0.3613723548228416, 21.13383230122133, -0.24125258607296018, -0.8219315387541766, 26.486721664713468, 33.82287541606681, 4.391758614627896, 9.167879050704213, 32.63245298977412, 33.04370213488627, 9.949966917870755, 31.406699693860123, 21.954385741535177, 32.15784993559493, 7.5772338772162815, -0.8731926838700321, 23.678498442379396, 7.217204810820888, 19.792840448564775, 17.26939185119651, -3.588677836157105, 8.954872173430118, 21.235780369560363, 24.902638962457235, -2.6630892418455137, 24.437937940125362, 43.93505945400432, 17.815052042128077, 42.07961622916767, 32.777634994835616, 25.38530393954305, 19.731804821905655, 0.6886367169255525, 0.5978367082308313, 6.979975162138205, 14.056930356647982, 19.05222406323039, 46.95978539494002, 33.411429232107764, 20.115500753276077, 21.20312288065869, 22.633685247584275, 2.351834390136575, 34.35845925621504, -13.61758909934057, 33.7081721965593, 5.132567885549905, 2.000002320589793, 15.827876353071161, 32.22994789374151, 8.647192266515603, 38.85221303624464, 10.439998881990896, 12.989465967136137, 11.646266963222779, 4.813498655648159, 30.869522668154648, 42.04503383014398, 28.507930619123535, 9.307472820448853, 7.957674222297621, 15.068242746120424, 25.66583809116537, 20.787478671835228, 25.875067498870685, 19.200846956121342, 0.2764977198993357, 28.86651020751144, 13.970760898561775, 0.7253883499168285, 27.791670392185274, 5.767976372688233, 12.056494565528755, 14.018806601867976, 18.513885615271796, 24.90880803492371, 13.760346074886519, 20.295831091986045, -7.014188663481869, -5.67300408805575, 8.471266500579388, 15.260487258267174, -5.6605924140479935, 22.26484481956419, 22.245560885764533, 37.15320011306359, 4.882174506261702, 18.02778238667883, 12.100560672724558, 9.826292808118799, 12.74623836553093, 1.4852238865011387, 5.772828628381396, 4.469365510299996, 18.54039703531624, 5.268673158591774, 19.56872736873238, 20.42466480427491, 45.44757523791835, 32.07878650054924, 28.614655535258784, 37.70955183205503, 6.264095934354669, 3.589933541359981, 21.927403243463065, 51.662084945190074, 8.708704649990699, 27.20302982217596, 18.546991311801804, 29.186645315620776, 1.361090490826859, -0.3141432498757233, 39.87373594085689, 19.57620695597004, 24.76277587743253, 1.6284953210815702, -10.055029801310468, -3.7339687093069642, 13.864395631960694, 3.8232015803998127, 15.6103352623525, 19.396276431239592, 29.724633622206635, 29.094964249708212, 16.23053036528022, 29.07698641440912, 3.6436745568112787, -1.0938250297221863, 16.156708517667465, 18.762665227409048, 12.994087603121233, 18.03455543517289, 22.448018582292423, 26.836927736343004, -0.9907267849640284, -15.074004620479553, 5.294773666385991, -11.421518764783496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5828491470849401, "mean_inference_ms": 1.5514012367249235, "mean_action_processing_ms": 0.24118917477148838, "mean_env_wait_ms": 0.13329071103308673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027757883071899414, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.06233692169189453}, "num_episodes": 27, "episode_return_max": 41.64159400867201, "episode_return_min": -9.696565762729284, "episode_return_mean": 16.001711867896873, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.0224057894431, "num_env_steps_trained_throughput_per_sec": 397.0224057894431, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 8922.334, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8922.298, "sample_time_ms": 786.776, "learn_time_ms": 8117.085, "learn_throughput": 492.788, "synch_weights_time_ms": 17.947}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": true, "training_iteration": 200, "trial_id": "06536_00000", "date": "2024-08-11_17-52-33", "timestamp": 1723413153, "time_this_iter_s": 10.124511003494263, "time_total_s": 4691.845399618149, "pid": 38517, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b5863c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4691.845399618149, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 39.91428571428572, "ram_util_percent": 82.14285714285715}}
