{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7221255720450135, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.624964130492438, "policy_loss": -0.008958400839018246, "vf_loss": 6.63142742858362, "vf_explained_var": -0.007849798662952646, "kl": 0.012475598683388324, "entropy": 1.5972199907378546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3729248105237881, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.775334096948305, "policy_loss": -0.006301438837059929, "vf_loss": 7.779859671990077, "vf_explained_var": -0.01965670542170604, "kl": 0.008879384110828737, "entropy": 1.6006225453068812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 362.4, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3624, "policy_reward_min": {"agent_policy": -35.26816554323717, "adversary_policy": -19.77206189878989}, "policy_reward_max": {"agent_policy": 28.648515000359566, "adversary_policy": 18.995288918141792}, "policy_reward_mean": {"agent_policy": -0.6427414805650784, "adversary_policy": 0.32137074028253904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40855297256898726, "mean_inference_ms": 1.0911861408770087, "mean_action_processing_ms": 0.17396059505716163, "mean_env_wait_ms": 0.07346116476000816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005228519439697266, "StateBufferConnector_ms": 0.0022923946380615234, "ViewRequirementAgentConnector_ms": 0.06139993667602539}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.164723237706, "num_env_steps_trained_throughput_per_sec": 514.164723237706, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 7779.616, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7779.575, "sample_time_ms": 821.606, "learn_time_ms": 6947.574, "learn_throughput": 575.741, "synch_weights_time_ms": 9.933}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "fa423_00000", "date": "2024-08-10_10-58-34", "timestamp": 1723301914, "time_this_iter_s": 7.7825658321380615, "time_total_s": 7.7825658321380615, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a721b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7.7825658321380615, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.69166666666667, "ram_util_percent": 80.76666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5981307859616305, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.210838682184774, "policy_loss": -0.005918894728606261, "vf_loss": 6.214775185610251, "vf_explained_var": -0.04802089283075282, "kl": 0.009911942957639695, "entropy": 1.5938605179231633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1311161714605986, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.605398603280386, "policy_loss": -0.007046367850368066, "vf_loss": 7.610155252615611, "vf_explained_var": 0.007712895609438419, "kl": 0.011448594678820407, "entropy": 1.5735074037065109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 380.2105263157895, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 7224, "policy_reward_min": {"agent_policy": -35.26816554323717, "adversary_policy": -27.848967490046718}, "policy_reward_max": {"agent_policy": 35.73589759218069, "adversary_policy": 18.995288918141792}, "policy_reward_mean": {"agent_policy": 2.377220914145049, "adversary_policy": -1.1886104570725247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416, 35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616, -21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997917198330991, "mean_inference_ms": 1.0639754895476257, "mean_action_processing_ms": 0.1709064212006691, "mean_env_wait_ms": 0.07078229891964558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005008672413073088, "StateBufferConnector_ms": 0.0022944651151958263, "ViewRequirementAgentConnector_ms": 0.060605375390303765}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.3518441035383, "num_env_steps_trained_throughput_per_sec": 530.3518441035383, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 7660.893, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7660.856, "sample_time_ms": 785.3, "learn_time_ms": 6865.396, "learn_throughput": 582.632, "synch_weights_time_ms": 9.71}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 2, "trial_id": "fa423_00000", "date": "2024-08-10_10-58-41", "timestamp": 1723301921, "time_this_iter_s": 7.544607877731323, "time_total_s": 15.327173709869385, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72455e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15.327173709869385, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.827272727272724, "ram_util_percent": 81.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3919452823816785, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.794736586676704, "policy_loss": -0.017922664418442067, "vf_loss": 6.80705567566806, "vf_explained_var": -0.07539664443838533, "kl": 0.028017826348304138, "entropy": 1.5566240784983156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9840813201231262, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.961385143796603, "policy_loss": -0.006740568762567515, "vf_loss": 7.965965379277865, "vf_explained_var": -0.0015631000821789106, "kl": 0.010801573602569826, "entropy": 1.5265081461519003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 373.37931034482756, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 10828, "policy_reward_min": {"agent_policy": -35.26816554323717, "adversary_policy": -28.596816112393167}, "policy_reward_max": {"agent_policy": 49.80227865690868, "adversary_policy": 18.995288918141792}, "policy_reward_mean": {"agent_policy": 7.097170749628733, "adversary_policy": -3.548585374814369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416, 35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927, 40.09696721998066, 43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616, -21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996, -16.50935581444112, -23.587611405539548, -23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39571836817396994, "mean_inference_ms": 1.0467040450375642, "mean_action_processing_ms": 0.16979387808355775, "mean_env_wait_ms": 0.06901906348599299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004787280641753098, "StateBufferConnector_ms": 0.0024355691054771685, "ViewRequirementAgentConnector_ms": 0.06377450351057382}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.22674948659517, "num_env_steps_trained_throughput_per_sec": 496.22674948659517, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 7794.209, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7794.172, "sample_time_ms": 766.19, "learn_time_ms": 7017.807, "learn_throughput": 569.979, "synch_weights_time_ms": 9.74}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 3, "trial_id": "fa423_00000", "date": "2024-08-10_10-58-49", "timestamp": 1723301929, "time_this_iter_s": 8.116290092468262, "time_total_s": 23.443463802337646, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7284f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.443463802337646, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.49090909090909, "ram_util_percent": 81.34545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.89170819524104, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.921687865131116, "policy_loss": -0.003890301244057439, "vf_loss": 6.924273948063926, "vf_explained_var": 0.0029995598490276036, "kl": 0.004347349015413979, "entropy": 1.5556650328257726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1937887660538156, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.043411315480869, "policy_loss": -0.006929281953004344, "vf_loss": 8.048469391961893, "vf_explained_var": 0.13170428046335778, "kl": 0.009355933441148106, "entropy": 1.4855881011734406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 5.415722071342227e-18, "episode_len_mean": 345.0731707317073, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 14148, "policy_reward_min": {"agent_policy": -55.910678347112395, "adversary_policy": -28.596816112393167}, "policy_reward_max": {"agent_policy": 49.80227865690868, "adversary_policy": 30.04053800490056}, "policy_reward_mean": {"agent_policy": -0.6963834327292494, "adversary_policy": 0.34819171636462365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416, 35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927, 40.09696721998066, 43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286, 13.757607664433003, 15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616, -21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996, -16.50935581444112, -23.587611405539548, -23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456, -9.960456686546742, -3.797150977886261, 1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3941476926468284, "mean_inference_ms": 1.036110022124871, "mean_action_processing_ms": 0.1687020153030986, "mean_env_wait_ms": 0.06815728706285022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004618923838545636, "StateBufferConnector_ms": 0.002483042275033346, "ViewRequirementAgentConnector_ms": 0.06619459245263076}, "num_episodes": 12, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 5.415722071342227e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.3821486913982, "num_env_steps_trained_throughput_per_sec": 504.3821486913982, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7828.283, "restore_workers_time_ms": 0.015, "training_step_time_ms": 7828.243, "sample_time_ms": 767.402, "learn_time_ms": 7050.808, "learn_throughput": 567.311, "synch_weights_time_ms": 9.581}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 4, "trial_id": "fa423_00000", "date": "2024-08-10_10-58-58", "timestamp": 1723301938, "time_this_iter_s": 7.933156967163086, "time_total_s": 31.376620769500732, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a721b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.376620769500732, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.13333333333333, "ram_util_percent": 81.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.247701855500539, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.3943337226040144, "policy_loss": -0.0015549085742335707, "vf_loss": 6.395380039316006, "vf_explained_var": -0.0017403850795099974, "kl": 0.0033905969479508754, "entropy": 1.570025755551757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3880736785940826, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.579035231471062, "policy_loss": -0.015501664267018593, "vf_loss": 7.590433693428834, "vf_explained_var": 0.031072592238585155, "kl": 0.0205160533792224, "entropy": 1.4432742772003015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 324.07272727272726, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 17824, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -33.401459440967315}, "policy_reward_max": {"agent_policy": 64.8936868484553, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": -5.481286381792757, "adversary_policy": 2.7406431908963786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416, 35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927, 40.09696721998066, 43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286, 13.757607664433003, 15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616, -21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996, -16.50935581444112, -23.587611405539548, -23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456, -9.960456686546742, -3.797150977886261, 1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3931097798085719, "mean_inference_ms": 1.028603491605651, "mean_action_processing_ms": 0.1681497749258343, "mean_env_wait_ms": 0.06742672572445628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004277229309082031, "StateBufferConnector_ms": 0.0024689327586780896, "ViewRequirementAgentConnector_ms": 0.06601810455322266}, "num_episodes": 14, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.3368089690475, "num_env_steps_trained_throughput_per_sec": 533.3368089690475, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7762.618, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7762.58, "sample_time_ms": 761.732, "learn_time_ms": 6990.811, "learn_throughput": 572.18, "synch_weights_time_ms": 9.584}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 5, "trial_id": "fa423_00000", "date": "2024-08-10_10-59-05", "timestamp": 1723301945, "time_this_iter_s": 7.50272011756897, "time_total_s": 38.8793408870697, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.8793408870697, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 32.17272727272728, "ram_util_percent": 81.55454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.271441625870725, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.269192260787601, "policy_loss": -0.005628596498537316, "vf_loss": 5.273304365047071, "vf_explained_var": -0.02714311363835814, "kl": 0.02021980978930327, "entropy": 1.5852438248023786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.565518113474051, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.924475890398026, "policy_loss": -0.005264286949629119, "vf_loss": 6.927710150678952, "vf_explained_var": 0.061509128225346404, "kl": 0.006766730737129552, "entropy": 1.39072002209723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 329.46268656716416, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 22074, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -42.01465803946239}, "policy_reward_max": {"agent_policy": 67.52578990069172, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 0.18344549032354368, "adversary_policy": -0.09172274516177184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416, 35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927, 40.09696721998066, 43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286, 13.757607664433003, 15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616, -21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996, -16.50935581444112, -23.587611405539548, -23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456, -9.960456686546742, -3.797150977886261, 1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.392000586353015, "mean_inference_ms": 1.0232474248223158, "mean_action_processing_ms": 0.16771465295835072, "mean_env_wait_ms": 0.0669148045270892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004225880352418814, "StateBufferConnector_ms": 0.0025021496103770696, "ViewRequirementAgentConnector_ms": 0.07072135583678288}, "num_episodes": 12, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.8926424448694, "num_env_steps_trained_throughput_per_sec": 542.8926424448694, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7696.839, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7696.803, "sample_time_ms": 760.366, "learn_time_ms": 6926.418, "learn_throughput": 577.499, "synch_weights_time_ms": 9.574}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 6, "trial_id": "fa423_00000", "date": "2024-08-10_10-59-13", "timestamp": 1723301953, "time_this_iter_s": 7.371220111846924, "time_total_s": 46.250560998916626, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72700d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46.250560998916626, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.629999999999995, "ram_util_percent": 81.38}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.347023750187228, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.08301053349934, "policy_loss": -0.0020156061281721115, "vf_loss": 6.084278129648279, "vf_explained_var": -0.008566423982539505, "kl": 0.006649037521497568, "entropy": 1.5847086114858193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4588684583082796, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.675395206610362, "policy_loss": -0.002689643721290243, "vf_loss": 7.676420399546624, "vf_explained_var": -0.014054595368603866, "kl": 0.005548114368244448, "entropy": 1.4340274151414634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 332.0875, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 26567, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -42.01465803946239}, "policy_reward_max": {"agent_policy": 67.52578990069172, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 2.4823469101515303, "adversary_policy": -1.2411734550757647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416, 35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927, 40.09696721998066, 43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286, 13.757607664433003, 15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616, -21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996, -16.50935581444112, -23.587611405539548, -23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456, -9.960456686546742, -3.797150977886261, 1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39220254102138347, "mean_inference_ms": 1.0208626913787402, "mean_action_processing_ms": 0.16774811092450914, "mean_env_wait_ms": 0.06668807248539343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004099011421203613, "StateBufferConnector_ms": 0.0025241076946258545, "ViewRequirementAgentConnector_ms": 0.07358580827713013}, "num_episodes": 13, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.70480956303913, "num_env_steps_trained_throughput_per_sec": 477.70480956303913, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 7793.488, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7793.452, "sample_time_ms": 766.489, "learn_time_ms": 7016.805, "learn_throughput": 570.06, "synch_weights_time_ms": 9.627}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 7, "trial_id": "fa423_00000", "date": "2024-08-10_10-59-21", "timestamp": 1723301961, "time_this_iter_s": 8.425788879394531, "time_total_s": 54.67634987831116, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a729b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54.67634987831116, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.86923076923077, "ram_util_percent": 82.08461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5299702026225903, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.884450706098446, "policy_loss": -0.00951768773295005, "vf_loss": 5.891609956600048, "vf_explained_var": 0.029470382512561857, "kl": 0.02096384811806788, "entropy": 1.5644675527300154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.783445210599651, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.000259407858054, "policy_loss": -0.004719027798758665, "vf_loss": 7.003352088232835, "vf_explained_var": -0.07220069617033005, "kl": 0.005421024143058103, "entropy": 1.3662907677392164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 339.6333333333333, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 30567, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -42.01465803946239}, "policy_reward_max": {"agent_policy": 67.52578990069172, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 6.155965573411194, "adversary_policy": -3.077982786705597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416, 35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927, 40.09696721998066, 43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286, 13.757607664433003, 15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616, -21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996, -16.50935581444112, -23.587611405539548, -23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456, -9.960456686546742, -3.797150977886261, 1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924118566686137, "mean_inference_ms": 1.020550558303477, "mean_action_processing_ms": 0.16789685263399634, "mean_env_wait_ms": 0.06663908801666277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004035101996527778, "StateBufferConnector_ms": 0.0025641918182373047, "ViewRequirementAgentConnector_ms": 0.07289515601264106}, "num_episodes": 10, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.98938556758657, "num_env_steps_trained_throughput_per_sec": 508.98938556758657, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7801.642, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7801.606, "sample_time_ms": 776.358, "learn_time_ms": 7015.098, "learn_throughput": 570.199, "synch_weights_time_ms": 9.632}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 8, "trial_id": "fa423_00000", "date": "2024-08-10_10-59-29", "timestamp": 1723301969, "time_this_iter_s": 7.8614068031311035, "time_total_s": 62.53775668144226, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7283a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.53775668144226, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.627272727272725, "ram_util_percent": 82.81818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9446411284189375, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.206070925697448, "policy_loss": -0.011133938030926166, "vf_loss": 6.214103255953107, "vf_explained_var": 0.06796345578299628, "kl": 0.018380057703662384, "entropy": 1.557680697983535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5428995572961868, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.800080306331316, "policy_loss": -0.0026701811448826144, "vf_loss": 7.801279834409555, "vf_explained_var": 0.09278448478629192, "kl": 0.004902237682858909, "entropy": 1.3723490154991547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 341.74, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34174, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -42.01465803946239}, "policy_reward_max": {"agent_policy": 67.52578990069172, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 7.21102747849885, "adversary_policy": -3.605513739249424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400], "policy_agent_policy_reward": [-7.1773445619957545, -1.708570429114575, -19.607777957159016, 7.488783894009671, -35.26816554323717, -3.5905146763610105, 19.338105879061807, 28.648515000359566, 20.42240638607311, -14.972852797287416, 35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927, 40.09696721998066, 43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286, 13.757607664433003, 15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372], "policy_adversary_policy_reward": [-0.7387193426664709, 7.916063904662225, 8.105358523129347, -6.396788094014777, 15.139991083226056, 4.467786873932965, -8.769085526086291, 1.2803016320766254, 16.272876625095368, 18.995288918141792, -0.5413168768816234, 4.131831553242634, -10.048111125951706, -9.2899947531101, -14.784267866488342, -13.864247133871224, -0.6503444872832205, -19.77206189878989, -1.0036506712961994, 15.976503468583616, -21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996, -16.50935581444112, -23.587611405539548, -23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456, -9.960456686546742, -3.797150977886261, 1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.392332976303772, "mean_inference_ms": 1.019498951311443, "mean_action_processing_ms": 0.1678959340008447, "mean_env_wait_ms": 0.06655112568779328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990054130554199, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.07202720642089844}, "num_episodes": 10, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.37643520705285, "num_env_steps_trained_throughput_per_sec": 479.37643520705285, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 7861.924, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7861.888, "sample_time_ms": 770.647, "learn_time_ms": 7081.111, "learn_throughput": 564.883, "synch_weights_time_ms": 9.62}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 9, "trial_id": "fa423_00000", "date": "2024-08-10_10-59-38", "timestamp": 1723301978, "time_this_iter_s": 8.350769758224487, "time_total_s": 70.88852643966675, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72700d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 70.88852643966675, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.59166666666666, "ram_util_percent": 82.93333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.483521895055418, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.752115367960047, "policy_loss": -0.0025026540708033337, "vf_loss": 5.753816279658565, "vf_explained_var": 0.167588402985265, "kl": 0.004751056606675807, "entropy": 1.5710364247125292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.629460213333368, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.453572467962901, "policy_loss": -0.007899427159766976, "vf_loss": 7.459706441064676, "vf_explained_var": 0.1448364868760109, "kl": 0.011769584451395754, "entropy": 1.406877730290095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 345.5, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34550, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 8.867941760112872, "adversary_policy": -4.433970880056436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [35.73589759218069, -30.250737313437313, 23.388824324250173, 5.924686632092527, -19.51133944532111, 10.961880114457015, -22.132383885887617, 13.454343296879639, 34.0234408591927, 40.09696721998066, 43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286, 13.757607664433003, 15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857], "policy_adversary_policy_reward": [-21.577035878344944, -14.158861713835762, 11.646939185117958, 18.603798128319376, -9.22447632364111, -14.164348000609062, 1.8589056438905764, -7.783592275983107, 2.335663195596922, 17.17567624972417, 2.003365740761998, -12.965245855219013, 12.89565574318123, 9.236728142706394, -4.991082421653441, -8.463260875226197, -27.848967490046718, -6.174473369145996, -16.50935581444112, -23.587611405539548, -23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456, -9.960456686546742, -3.797150977886261, 1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39077828537503756, "mean_inference_ms": 1.0116532169475305, "mean_action_processing_ms": 0.16724630248032527, "mean_env_wait_ms": 0.06591760046749533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003897428512573242, "StateBufferConnector_ms": 0.0026091337203979492, "ViewRequirementAgentConnector_ms": 0.07344746589660645}, "num_episodes": 10, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 531.0886734460823, "num_env_steps_trained_throughput_per_sec": 531.0886734460823, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 7828.903, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7828.866, "sample_time_ms": 777.531, "learn_time_ms": 7041.249, "learn_throughput": 568.081, "synch_weights_time_ms": 9.586}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 10, "trial_id": "fa423_00000", "date": "2024-08-10_10-59-45", "timestamp": 1723301985, "time_this_iter_s": 7.5344061851501465, "time_total_s": 78.4229326248169, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a729d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.4229326248169, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.781818181818185, "ram_util_percent": 82.20909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2245096162355766, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.585598500317366, "policy_loss": -0.005972674441223264, "vf_loss": 5.590190727748568, "vf_explained_var": -0.23960485303843462, "kl": 0.016360700969791257, "entropy": 1.5690557824871527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6985602381949625, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.554981832206249, "policy_loss": -0.006764631633510969, "vf_loss": 7.560144691665967, "vf_explained_var": 0.10742994168152412, "kl": 0.010678505431468761, "entropy": 1.3778687742849192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 345.5, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34550, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 9.197610778901556, "adversary_policy": -4.598805389450778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [43.04142265599182, -13.780547059864315, 27.58198314617831, -24.519027870503265, 49.80227865690868, 4.163259967708218, -0.3228306141746735, -2.9808840063109443, 37.56813227456286, 13.757607664433003, 15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254], "policy_adversary_policy_reward": [-23.08526303800514, -19.956159617986714, 15.312212595216593, -1.5316655353523032, -19.577331896402164, -8.004651249776149, 9.85976360476247, 14.659264265740795, -21.205462544515488, -28.596816112393167, -11.925700203480616, 7.762440235772399, 0.0, 0.3228306141746735, 8.079490505292103, -5.098606498981173, -15.798391990488327, -21.76974028407456, -9.960456686546742, -3.797150977886261, 1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3909532026757266, "mean_inference_ms": 1.0089653217286314, "mean_action_processing_ms": 0.16713643339827516, "mean_env_wait_ms": 0.06577099310705446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037946701049804688, "StateBufferConnector_ms": 0.0026290416717529297, "ViewRequirementAgentConnector_ms": 0.0747678279876709}, "num_episodes": 10, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.7756129834552, "num_env_steps_trained_throughput_per_sec": 539.7756129834552, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 7791.99, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7791.954, "sample_time_ms": 767.835, "learn_time_ms": 7014.115, "learn_throughput": 570.279, "synch_weights_time_ms": 9.512}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 11, "trial_id": "fa423_00000", "date": "2024-08-10_10-59-53", "timestamp": 1723301993, "time_this_iter_s": 7.41309380531311, "time_total_s": 85.83602643013, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 85.83602643013, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.80909090909091, "ram_util_percent": 81.68181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4822140844568374, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.2377954166402265, "policy_loss": -0.005774484342949652, "vf_loss": 5.2420672671504756, "vf_explained_var": 0.19035817794698887, "kl": 0.01780902908969814, "entropy": 1.5529955540384566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8591325179984173, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.761245207985242, "policy_loss": -0.002543592274499436, "vf_loss": 6.762584102153778, "vf_explained_var": 0.011902681303520997, "kl": 0.008031161243322633, "entropy": 1.3327344466000794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 4.440892098500626e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 349.46, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34946, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 9.040461792318068, "adversary_policy": -4.520230896159034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 4.440892098500626e-16, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 314, 169, 41, 202, 384, 400, 95, 266, 400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [15.875561144465635, -40.666229631275684, -32.19350193830467, -13.89594178667588, -41.453883593344365, -27.61875465997538, 3.7638714553756216, -29.529842304704726, -55.910678347112395, 2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926], "policy_adversary_policy_reward": [1.1767557537367423, -17.052316898202378, 25.855693339819183, 14.810536291456515, 8.491761773624447, 23.70174016468021, 0.7709759812593937, 13.12496580541649, 18.069610529932028, 23.38427306341235, 13.690660821680893, 13.928093838294465, -7.309832656682708, 3.5459612013070867, 11.763661827684087, 17.766180477020647, 29.660157023255547, 26.25052132385683, 1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39105398400028507, "mean_inference_ms": 1.0078308646653624, "mean_action_processing_ms": 0.16702210327691502, "mean_env_wait_ms": 0.06580799577976161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038149356842041016, "StateBufferConnector_ms": 0.002636432647705078, "ViewRequirementAgentConnector_ms": 0.0738757848739624}, "num_episodes": 10, "episode_return_max": 4.440892098500626e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.4965759616205, "num_env_steps_trained_throughput_per_sec": 552.4965759616205, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 7761.76, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7761.725, "sample_time_ms": 770.567, "learn_time_ms": 6981.181, "learn_throughput": 572.969, "synch_weights_time_ms": 9.49}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 12, "trial_id": "fa423_00000", "date": "2024-08-10_11-00-00", "timestamp": 1723302000, "time_this_iter_s": 7.242449998855591, "time_total_s": 93.0784764289856, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7287b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.0784764289856, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.79, "ram_util_percent": 81.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0708680354571216, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.323574474122789, "policy_loss": -0.0037741193206606324, "vf_loss": 6.326228295179902, "vf_explained_var": -0.3295264407440468, "kl": 0.013277548424826108, "entropy": 1.5641298312989493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5820696115493775, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.630353267490864, "policy_loss": -0.009646774035839674, "vf_loss": 7.637032340963682, "vf_explained_var": 0.1450227017203967, "kl": 0.01978470010605172, "entropy": 1.3233616027981043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 362.75, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36275, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 12.075212204293898, "adversary_policy": -6.037606102146948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 2.220446049250313e-16, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 249, 400, 288, 277, 400, 234, 324, 126, 400, 194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [2.311477672761157, -28.809358156774838, 17.385396184007362, -67.59292672431411, -62.003066632101834, 64.8936868484553, -54.664999801319794, -45.30742275391804, -20.98457368520724, 36.97223244310999, -51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764], "policy_adversary_policy_reward": [1.3021960259566612, -3.613673698717818, 30.04053800490056, -1.231179848125704, -4.365813718454206, -13.019582465553157, 37.566732723971654, 30.02619400034253, 37.43569971467543, 24.567366917426426, -33.401459440967315, -31.49222740748801, 35.91973411690932, 18.7452656844105, 37.46111795247674, 7.846304801441291, 10.954711504278055, 10.029862180929175, -30.747774008830874, -6.224458434279114, 20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3908200681818264, "mean_inference_ms": 1.0072551421419762, "mean_action_processing_ms": 0.1670996284653385, "mean_env_wait_ms": 0.0658316372103397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039920806884765625, "StateBufferConnector_ms": 0.0026494264602661133, "ViewRequirementAgentConnector_ms": 0.07408833503723145}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.53877952512, "num_env_steps_trained_throughput_per_sec": 538.53877952512, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 7698.428, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7698.392, "sample_time_ms": 775.498, "learn_time_ms": 6912.96, "learn_throughput": 578.623, "synch_weights_time_ms": 9.447}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 13, "trial_id": "fa423_00000", "date": "2024-08-10_11-00-08", "timestamp": 1723302008, "time_this_iter_s": 7.430849075317383, "time_total_s": 100.50932550430298, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7287a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.50932550430298, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 27.836363636363636, "ram_util_percent": 81.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.931521153765381, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.188229968055846, "policy_loss": -0.0029341398206140313, "vf_loss": 6.1901282060714, "vf_explained_var": -0.315238421366959, "kl": 0.012277300723849714, "entropy": 1.5752310725746963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8204936498465636, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.13517863402764, "policy_loss": -0.010034985187424657, "vf_loss": 7.142825995385647, "vf_explained_var": 0.02937292493879795, "kl": 0.015917411800188817, "entropy": 1.2848658122122287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 371.77, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37177, "policy_reward_min": {"agent_policy": -70.7606302326333, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 47.929345513929135}, "policy_reward_mean": {"agent_policy": 15.623407707658066, "adversary_policy": -7.811703853829031}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [194, 116, 104, 72, 341, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-51.65836283495965, -31.419047424148676, -29.929307842265597, -16.56562293931574, -70.7606302326333, 58.71561513790888, 44.11833265037038, 52.678928448435904, 28.616341640148768, 30.674327984390054, 34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332], "policy_adversary_policy_reward": [20.39958367063168, 31.258779164327947, 32.65147173053563, -1.2324243063869602, 26.05507208018002, 3.8742357620855703, -0.4691756097479569, 17.034798549063694, 22.831284718704183, 47.929345513929135, -28.911172316623585, -29.804442821285306, -23.552610750041612, -20.565721900328768, -12.529218102639064, -40.149710345796834, -4.182885430689737, -24.43345620945903, -9.706449164428712, -20.967878819961335, -5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39069539875391507, "mean_inference_ms": 1.0065647185173994, "mean_action_processing_ms": 0.1670556482679158, "mean_env_wait_ms": 0.06583230739806942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004047751426696777, "StateBufferConnector_ms": 0.002623438835144043, "ViewRequirementAgentConnector_ms": 0.07296979427337646}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.76121047182875, "num_env_steps_trained_throughput_per_sec": 503.76121047182875, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 7699.405, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7699.371, "sample_time_ms": 776.874, "learn_time_ms": 6912.248, "learn_throughput": 578.683, "synch_weights_time_ms": 9.771}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 14, "trial_id": "fa423_00000", "date": "2024-08-10_11-00-16", "timestamp": 1723302016, "time_this_iter_s": 7.945825099945068, "time_total_s": 108.45515060424805, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7287ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 108.45515060424805, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.59090909090909, "ram_util_percent": 81.36363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.988952615683672, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.648912616255422, "policy_loss": -0.007168152436328234, "vf_loss": 5.654537982284707, "vf_explained_var": 0.04849358065418465, "kl": 0.01828483997533895, "entropy": 1.5628006477835317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8200600537781915, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.161918085316817, "policy_loss": -0.006873909706579677, "vf_loss": 7.166735757390658, "vf_explained_var": 0.024489998072385787, "kl": 0.013708279768203546, "entropy": 1.2561687365174294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.5, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38350, "policy_reward_min": {"agent_policy": -61.318915870411146, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 38.4933702930545}, "policy_reward_mean": {"agent_policy": 18.525637813866236, "adversary_policy": -9.262818906933116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 150, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [34.906452756338155, 42.97532346358775, -61.318915870411146, 45.585977719456736, 26.393480843423326, 67.52578990069172, 47.947536932822, -46.341977618974546, 46.61552048176786, 57.05033745604803, 24.01782023953152, 38.260612204115304, 23.378187627666485, -15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771], "policy_adversary_policy_reward": [-5.406295583148641, -29.500157173189507, -9.381135376585156, -33.59418808700259, 22.825545577356664, 38.4933702930545, -19.127158647618668, -26.458819071838064, -4.594481704788336, -21.798999138634993, -25.511131861229337, -42.01465803946239, -25.80402031646961, -22.143516616352407, 28.04562641087167, 18.296351208102873, -21.11901659438752, -25.496503887380346, -19.472443606480223, -37.5778938495678, -1.4783400414219443, -22.5394801981096, -8.969176650923842, -29.291435553191466, -5.862573069665551, -17.515614558000934, 7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39046112221696044, "mean_inference_ms": 1.0056222669181551, "mean_action_processing_ms": 0.1669902505565911, "mean_env_wait_ms": 0.06581777093637924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003992915153503418, "StateBufferConnector_ms": 0.002601027488708496, "ViewRequirementAgentConnector_ms": 0.06994712352752686}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.1242294691918, "num_env_steps_trained_throughput_per_sec": 506.1242294691918, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 7739.729, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7739.696, "sample_time_ms": 780.843, "learn_time_ms": 6948.39, "learn_throughput": 575.673, "synch_weights_time_ms": 9.988}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 15, "trial_id": "fa423_00000", "date": "2024-08-10_11-00-24", "timestamp": 1723302024, "time_this_iter_s": 7.90866494178772, "time_total_s": 116.36381554603577, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7287f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.36381554603577, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.974999999999998, "ram_util_percent": 81.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.945946968642492, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.262624282054801, "policy_loss": -0.007802946566574512, "vf_loss": 4.269053635395393, "vf_explained_var": -0.11919001716154592, "kl": 0.01627986117343186, "entropy": 1.5358127271056805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.834101993218064, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.669515751302242, "policy_loss": -0.0031657216721214356, "vf_loss": 6.671778339147568, "vf_explained_var": 0.021331761963665485, "kl": 0.006020677253856347, "entropy": 1.1907849833369255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.5, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38550, "policy_reward_min": {"agent_policy": -51.54657333667332, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 34.10369251699837}, "policy_reward_mean": {"agent_policy": 16.634529618626495, "adversary_policy": -8.317264809313246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 68, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-15.719001833097241, -8.992014487676872, -15.271875556389503, 21.69891327866233, -19.410245444865303, 13.203557715078396, 35.63997037676722, -14.174877097163218, 30.91050309994678, 28.434122817486404, 14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606], "policy_adversary_policy_reward": [7.402467813045828, 8.316534020051488, 14.682714315362915, -5.690699827686043, 8.890904454723001, 6.380971101666502, -13.953632434979724, -7.7452808436826075, 4.116234671978473, 15.294010772886814, -9.727606453402998, -3.475951261675398, -21.452502303722984, -14.187468073044236, -3.1745642590010483, 17.349441356164334, -10.065821973567736, -20.844681126379044, -8.617386330184516, -19.816736487301892, -3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39019427957888225, "mean_inference_ms": 1.004811465647148, "mean_action_processing_ms": 0.1668522577142438, "mean_env_wait_ms": 0.06588855577884166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004133462905883789, "StateBufferConnector_ms": 0.002639293670654297, "ViewRequirementAgentConnector_ms": 0.06802785396575928}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.4477075904584, "num_env_steps_trained_throughput_per_sec": 498.4477075904584, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 7805.427, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7805.393, "sample_time_ms": 778.95, "learn_time_ms": 7015.794, "learn_throughput": 570.142, "synch_weights_time_ms": 10.127}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 16, "trial_id": "fa423_00000", "date": "2024-08-10_11-00-32", "timestamp": 1723302032, "time_this_iter_s": 8.030531883239746, "time_total_s": 124.39434742927551, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 124.39434742927551, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.55454545454545, "ram_util_percent": 81.28181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1753091864484957, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.753184675791907, "policy_loss": -0.004838265140452201, "vf_loss": 4.757151208731233, "vf_explained_var": 0.11426168730649999, "kl": 0.010331482592045537, "entropy": 1.5106757228967373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2058327882240216, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.93400673319896, "policy_loss": -0.005354138573360008, "vf_loss": 5.937969336907069, "vf_explained_var": 0.11871848491330941, "kl": 0.009276790901317548, "entropy": 1.1661262409140667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.57, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39257, "policy_reward_min": {"agent_policy": -51.54657333667332, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 34.10369251699837}, "policy_reward_mean": {"agent_policy": 17.450953391166816, "adversary_policy": -8.72547669558341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [14.710926183454077, 38.16320027287096, 36.38724756273254, 33.04870139373512, 37.68765099355988, 37.583426626891566, 35.010930289036665, 63.512439555171134, 18.606581482486277, 16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776], "policy_adversary_policy_reward": [-3.5401417417223193, -11.170784441731758, 1.522034887098222, -39.68523515996918, -17.687666403201174, -18.699581159531366, -10.1744224517937, -22.874278941941427, -28.12368078771167, -9.563970205848218, -14.430155226340322, -23.153271400551244, -21.7725580654684, -13.238372223568263, -28.16055246110885, -35.35188709406228, -15.616654295959059, -2.9899271865272183, -6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3892445376575337, "mean_inference_ms": 1.0027539977327946, "mean_action_processing_ms": 0.16658893329852925, "mean_env_wait_ms": 0.06578822515959944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043250322341918945, "StateBufferConnector_ms": 0.0026100873947143555, "ViewRequirementAgentConnector_ms": 0.06654691696166992}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.7907699307691, "num_env_steps_trained_throughput_per_sec": 494.7907699307691, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 7776.512, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7776.477, "sample_time_ms": 769.33, "learn_time_ms": 6996.171, "learn_throughput": 571.741, "synch_weights_time_ms": 10.503}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 17, "trial_id": "fa423_00000", "date": "2024-08-10_11-00-40", "timestamp": 1723302040, "time_this_iter_s": 8.104919195175171, "time_total_s": 132.49926662445068, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.49926662445068, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.575, "ram_util_percent": 81.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1854251148839476, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.1026779896367795, "policy_loss": -0.0034340613480982564, "vf_loss": 5.1056019836001925, "vf_explained_var": 0.2516806959475159, "kl": 0.006045114670580987, "entropy": 1.4618452938776167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1600848593438666, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.2548898334304495, "policy_loss": -0.0023900915921937363, "vf_loss": 6.256679150958856, "vf_explained_var": 0.088780275794367, "kl": 0.004005035671878125, "entropy": 1.16734005138278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.57, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39257, "policy_reward_min": {"agent_policy": -51.54657333667332, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 34.10369251699837}, "policy_reward_mean": {"agent_policy": 14.98885819724506, "adversary_policy": -7.49442909862253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [16.94599941666942, 29.73792506187557, 20.425505909000606, 53.398101772226624, 36.619951227602265, -14.554521490725765, -1.789273110439574, 26.35240586758733, -18.676829893405372, -12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827], "policy_adversary_policy_reward": [-6.807836784057017, -10.138162632612403, -7.087058437988482, -22.65086662388709, -11.983478741284188, -8.442027167716418, -21.924907976350042, -31.473193795876604, -25.13613638113236, -11.483814846469905, 2.097747643840407, 12.456773846885358, 2.689313014144077, -0.9000399037045028, -5.078607631043109, -21.273798236544216, 13.893739700274136, 4.783090193131244, 4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3902670373891388, "mean_inference_ms": 1.0054833467356312, "mean_action_processing_ms": 0.1670873196539668, "mean_env_wait_ms": 0.06601330804918394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.0028150081634521484, "ViewRequirementAgentConnector_ms": 0.0728158950805664}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.82046467944076, "num_env_steps_trained_throughput_per_sec": 420.82046467944076, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 7941.166, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7941.13, "sample_time_ms": 830.823, "learn_time_ms": 7099.183, "learn_throughput": 563.445, "synch_weights_time_ms": 10.636}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 18, "trial_id": "fa423_00000", "date": "2024-08-10_11-00-50", "timestamp": 1723302050, "time_this_iter_s": 9.53383493423462, "time_total_s": 142.0331015586853, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.0331015586853, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 42.02857142857142, "ram_util_percent": 82.00714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0221600798702744, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.707453786633002, "policy_loss": -0.00884532207209203, "vf_loss": 4.714829274586269, "vf_explained_var": -0.011036882072529465, "kl": 0.017420379372369, "entropy": 1.4013548087821435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.204904966056347, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.954241460065047, "policy_loss": -0.004462404414274109, "vf_loss": 5.957368178665638, "vf_explained_var": 0.18447420820593835, "kl": 0.01780938395982896, "entropy": 1.1919762025276819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.5, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39650, "policy_reward_min": {"agent_policy": -51.54657333667332, "adversary_policy": -49.220292672736406}, "policy_reward_max": {"agent_policy": 96.65424186695319, "adversary_policy": 34.10369251699837}, "policy_reward_mean": {"agent_policy": 14.474592953760219, "adversary_policy": -7.237296476880107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-12.573672426045931, 84.01828569533136, 96.65424186695319, -20.484547393353452, -11.63195404657501, 20.23297223995097, 8.305621006668897, -1.6050989230040784, 35.41673017207415, -39.06856483624857, 15.671353981328885, -34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067], "policy_adversary_policy_reward": [4.818075355725476, 7.755597070320455, -48.8832945094839, -35.13499118584744, -49.220292672736406, -47.43394919421675, 28.23798453278029, -7.753437139426836, -5.936406731148388, 17.5683607777234, 7.534566217462402, -27.767538457413366, -14.361255561213284, 6.055634554544373, 0.5380949077080892, 1.0670040152959892, -9.924813839879135, -25.491916332195018, 13.069047374532182, 25.999517461716387, -7.232203196040896, -8.439150785287989, 13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39146047106473825, "mean_inference_ms": 1.0087770949792394, "mean_action_processing_ms": 0.1675792875283495, "mean_env_wait_ms": 0.0662754753436677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045206546783447266, "StateBufferConnector_ms": 0.0027812719345092773, "ViewRequirementAgentConnector_ms": 0.07245767116546631}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.64901095825195, "num_env_steps_trained_throughput_per_sec": 429.64901095825195, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 8037.742, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8037.704, "sample_time_ms": 834.472, "learn_time_ms": 7191.801, "learn_throughput": 556.189, "synch_weights_time_ms": 10.906}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 19, "trial_id": "fa423_00000", "date": "2024-08-10_11-01-00", "timestamp": 1723302060, "time_this_iter_s": 9.356361150741577, "time_total_s": 151.38946270942688, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 151.38946270942688, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 38.50000000000001, "ram_util_percent": 81.62307692307694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.21204349978891, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.709516891348299, "policy_loss": -0.0066905084928428685, "vf_loss": 4.715194881403888, "vf_explained_var": -0.41003507410407697, "kl": 0.012000213788426197, "entropy": 1.306438867314152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3875491350268323, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.911468840142091, "policy_loss": -0.0027768128634003612, "vf_loss": 5.913744541505973, "vf_explained_var": 0.09697950575500727, "kl": 0.006681548492836678, "entropy": 1.16696253195405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.5, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39650, "policy_reward_min": {"agent_policy": -51.54657333667332, "adversary_policy": -41.5785084545214}, "policy_reward_max": {"agent_policy": 75.09548033315343, "adversary_policy": 34.10369251699837}, "policy_reward_mean": {"agent_policy": 13.4559944915509, "adversary_policy": -6.72799724577545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-34.55656777837228, 0.32109093692491797, 65.80834823556125, 16.277461678155113, 72.48990137748632, 68.97624955521931, -17.46102393499512, -21.483170967740055, -41.38516181031254, -0.46603924292161025, 49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038], "policy_adversary_policy_reward": [13.02595908624252, 21.530608692129803, -5.802583454526271, 5.481492517601353, -29.088356015615545, -36.7199922199457, -2.2511010205748256, -14.02636065758029, -38.48944495686857, -34.00045642061777, -41.5785084545214, -27.39774110069795, -2.3390785659878883, 19.80010250098301, 11.669988168282792, 9.813182799457262, 23.84662447822082, 17.538537332091646, 3.190625884486714, -2.7245866415651037, -36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926179821615295, "mean_inference_ms": 1.0123525090464067, "mean_action_processing_ms": 0.16828048029515028, "mean_env_wait_ms": 0.06644978803270711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004472255706787109, "StateBufferConnector_ms": 0.002773761749267578, "ViewRequirementAgentConnector_ms": 0.07114195823669434}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.3629842174654, "num_env_steps_trained_throughput_per_sec": 447.3629842174654, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 8178.7, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8178.662, "sample_time_ms": 835.998, "learn_time_ms": 7329.204, "learn_throughput": 545.762, "synch_weights_time_ms": 12.803}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 20, "trial_id": "fa423_00000", "date": "2024-08-10_11-01-09", "timestamp": 1723302069, "time_this_iter_s": 8.950433015823364, "time_total_s": 160.33989572525024, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7287040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 160.33989572525024, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 34.238461538461536, "ram_util_percent": 80.9923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.304617872881511, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.686925483128381, "policy_loss": -0.00378197946341797, "vf_loss": 5.690001910073416, "vf_explained_var": -0.017532607897248847, "kl": 0.008362022468221762, "entropy": 1.280442830052956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0188201791296403, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.880800512929757, "policy_loss": -0.002615190828025031, "vf_loss": 5.883110811809699, "vf_explained_var": 0.05662661741177241, "kl": 0.004065129629735923, "entropy": 1.1772818729281425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.5, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39650, "policy_reward_min": {"agent_policy": -51.54657333667332, "adversary_policy": -43.9527783844399}, "policy_reward_max": {"agent_policy": 75.09548033315343, "adversary_policy": 34.10369251699837}, "policy_reward_mean": {"agent_policy": 14.221124245170861, "adversary_policy": -7.110562122585431}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [49.19845964418241, -11.646377346444144, 49.967439410363006, 10.663499453158721, -27.60591175356198, -18.8082335303581, 2.9595794975384138, -4.3870151629451275, 68.72109518756926, -6.783565421860121, -46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832], "policy_adversary_policy_reward": [-36.426644149062724, -12.771815495119675, 8.907904930945946, 2.7384724154981974, -18.226437045578137, -31.74100236478487, -5.305160735301296, -5.3583387178574355, 9.96181748074418, 17.64409427281781, 11.091292245011438, 7.716941285346664, -12.482711910702655, 9.523132413164241, -20.77717124934855, 25.164186412293677, -36.504515525195494, -32.21657966237374, -5.244806313595152, 12.028371735455273, 27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3941927573917709, "mean_inference_ms": 1.0168081168894676, "mean_action_processing_ms": 0.16907990841843937, "mean_env_wait_ms": 0.06670486172605052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044411420822143555, "StateBufferConnector_ms": 0.0028171539306640625, "ViewRequirementAgentConnector_ms": 0.07102489471435547}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.70422301632476, "num_env_steps_trained_throughput_per_sec": 430.70422301632476, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 8366.363, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8366.325, "sample_time_ms": 852.01, "learn_time_ms": 7500.665, "learn_throughput": 533.286, "synch_weights_time_ms": 12.964}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 21, "trial_id": "fa423_00000", "date": "2024-08-10_11-01-18", "timestamp": 1723302078, "time_this_iter_s": 9.328695058822632, "time_total_s": 169.66859078407288, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.66859078407288, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 37.39285714285715, "ram_util_percent": 82.59285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.119513220178387, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.645642440407364, "policy_loss": -0.0070189815445768616, "vf_loss": 4.65183160317638, "vf_explained_var": -0.11914484809946131, "kl": 0.0098348434756833, "entropy": 1.333068293679959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3435635693992176, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.365240266919136, "policy_loss": -0.003677818444945539, "vf_loss": 6.368483747541904, "vf_explained_var": 0.11390077297886213, "kl": 0.01158223975482741, "entropy": 1.2116649366915226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.07, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39307, "policy_reward_min": {"agent_policy": -51.54657333667332, "adversary_policy": -43.9527783844399}, "policy_reward_max": {"agent_policy": 75.09548033315343, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 12.992580608999603, "adversary_policy": -6.496290304499803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400], "policy_agent_policy_reward": [-46.91350736778452, -15.834897530017713, 0.9063671887331068, 47.31570924358351, 28.18630036295633, 29.70082127764338, 75.09548033315343, -29.8270665503764, 34.85877159271419, -32.41570378874124, 73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665], "policy_adversary_policy_reward": [27.58801340166373, 19.325493966120767, 28.353169380531202, -12.518271850513486, 11.004460770794672, -11.910827959527783, -39.54998049174432, -7.765728751839184, -15.002504751795279, -13.183795611161052, -21.85054704896994, -7.850274228673442, -36.24340927092983, -38.85207106222353, 34.10369251699837, -4.276625966621982, -16.26311874651994, -18.59565284619425, 19.08066290774058, 13.335040881000662, -40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39575479007683, "mean_inference_ms": 1.0215957288256197, "mean_action_processing_ms": 0.1698279120794606, "mean_env_wait_ms": 0.06698011833522122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042601823806762695, "StateBufferConnector_ms": 0.0027707815170288086, "ViewRequirementAgentConnector_ms": 0.07065379619598389}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.3829819274115, "num_env_steps_trained_throughput_per_sec": 490.3829819274115, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 8458.067, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8458.027, "sample_time_ms": 853.264, "learn_time_ms": 7590.994, "learn_throughput": 526.94, "synch_weights_time_ms": 13.079}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 22, "trial_id": "fa423_00000", "date": "2024-08-10_11-01-26", "timestamp": 1723302086, "time_this_iter_s": 8.163073778152466, "time_total_s": 177.83166456222534, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.83166456222534, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 26.127272727272725, "ram_util_percent": 81.5909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.139383763973675, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.023136917876188, "policy_loss": -0.00436920314650273, "vf_loss": 4.026753973708582, "vf_explained_var": 0.1951833054186806, "kl": 0.008914374322273398, "entropy": 1.330036214735142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1142145015920204, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.007371460894744, "policy_loss": -0.004570684308419004, "vf_loss": 5.01146968776981, "vf_explained_var": 0.10110571359594663, "kl": 0.012598861036257613, "entropy": 1.199969499434034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.07, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39307, "policy_reward_min": {"agent_policy": -51.54657333667332, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 74.58251355539346, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 13.623300750615938, "adversary_policy": -6.81165037530797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [73.91223956066402, 25.501926504482224, 2.1599619468111033, 68.89855916443096, -7.6269308670513, 33.352143758521365, 49.925601195956965, -51.54657333667332, 28.14869095610593, 42.473666180618494, 60.26038361365849, 42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627], "policy_adversary_policy_reward": [-40.4998687698112, -33.41237079085274, -4.1917421975649525, -21.310184306917254, 16.90775987489227, -19.067721821703383, -34.19253184553648, -34.70602731889445, 4.072338214829003, 3.554592652222297, -26.444238143231587, -6.907905615289756, -33.39097520896987, -16.534625986987095, 26.571230728396596, 24.975342608276762, -21.6353106711619, -6.513380284944027, -33.69217985855753, -8.78148632206096, -29.647688015627683, -30.612695598030818, -17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3974937950253058, "mean_inference_ms": 1.0269441051548005, "mean_action_processing_ms": 0.17060704639082883, "mean_env_wait_ms": 0.06729344143999728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004080772399902344, "StateBufferConnector_ms": 0.0027930736541748047, "ViewRequirementAgentConnector_ms": 0.0721215009689331}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.4401358509551, "num_env_steps_trained_throughput_per_sec": 449.4401358509551, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 8605.312, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8605.273, "sample_time_ms": 867.612, "learn_time_ms": 7723.718, "learn_throughput": 517.885, "synch_weights_time_ms": 13.24}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 23, "trial_id": "fa423_00000", "date": "2024-08-10_11-01-36", "timestamp": 1723302096, "time_this_iter_s": 8.952282190322876, "time_total_s": 186.78394675254822, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.78394675254822, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 32.330769230769235, "ram_util_percent": 81.93076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.236424420214204, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.564949516644553, "policy_loss": -0.009474237575368197, "vf_loss": 4.573231497391191, "vf_explained_var": -0.16791556814990977, "kl": 0.014130458929084808, "entropy": 1.389754574954825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0439748520031573, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.097423365215461, "policy_loss": -0.002030684983280177, "vf_loss": 6.099154600997766, "vf_explained_var": 0.15449293069541453, "kl": 0.007984677219977997, "entropy": 1.15083327802519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.36, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38936, "policy_reward_min": {"agent_policy": -47.66590251370266, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 74.58251355539346, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 10.993157666959918, "adversary_policy": -5.496578833479961}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [42.08166670348519, 30.75754870235643, 52.854853725421904, 23.166060036086165, -12.403126892459944, -4.943890901622268, 42.29773308509771, 28.809776525389005, -47.66590251370266, 50.81480916311791, -19.845033607153088, -5.203346883957824, 45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733], "policy_adversary_policy_reward": [-17.28076568119956, -24.80090102228563, -13.044926940047219, -17.71262176230921, -23.20172999397833, -29.65312373144358, -17.794845939329626, -5.371214096756539, -0.4595915689772312, 12.862718461437176, -4.598336349867296, 9.542227251489564, -21.88055339815795, -20.41717968693976, -5.344823239168193, -23.464953286220815, 24.42942898424733, 23.23647352945531, -23.728496164057912, -27.086312999060006, -1.9288358518705309, 21.77386945902362, -12.438341989717319, 17.641688873675143, -14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39988898972338666, "mean_inference_ms": 1.0341181459370006, "mean_action_processing_ms": 0.17165844474105307, "mean_env_wait_ms": 0.0678275275602543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010856151580810547, "StateBufferConnector_ms": 0.0028176307678222656, "ViewRequirementAgentConnector_ms": 0.08075070381164551}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.56624557452403, "num_env_steps_trained_throughput_per_sec": 435.56624557452403, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 8729.631, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8729.59, "sample_time_ms": 886.387, "learn_time_ms": 7829.439, "learn_throughput": 510.892, "synch_weights_time_ms": 13.017}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 24, "trial_id": "fa423_00000", "date": "2024-08-10_11-01-45", "timestamp": 1723302105, "time_this_iter_s": 9.188940048217773, "time_total_s": 195.972886800766, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.972886800766, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.076923076923077, "ram_util_percent": 81.51538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2114019336208464, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.294484791806135, "policy_loss": -0.005515215300003845, "vf_loss": 5.298913599700524, "vf_explained_var": -0.0674116971316161, "kl": 0.012875898315170647, "entropy": 1.4322791574493288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1896285277480882, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.38741595596075, "policy_loss": -0.008670788637634057, "vf_loss": 6.395376601318518, "vf_explained_var": 0.2944972703233361, "kl": 0.01893711281363023, "entropy": 1.1667169731110334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.86, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 39286, "policy_reward_min": {"agent_policy": -31.638821318540867, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 74.58251355539346, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 11.31805125802655, "adversary_policy": -5.659025629013277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [45.41037986285818, 12.253029519715085, 34.13890198987276, 10.40270518261094, 15.265963692083623, -8.423568286513074, 7.069738972892456, 34.857872994875606, 7.693776926979165, -22.044979432490365, 1.6785124275260692, 7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558], "policy_adversary_policy_reward": [-14.550365347137983, -30.860014515720188, -20.889400340340828, 8.636370820625743, -27.365881718649163, -6.773020271223594, 8.003022925626116, -18.405728108237053, -14.471120770773403, -0.7948429213102202, -5.390185519498768, 13.813753806011846, -6.628732057080111, -0.44100691581234486, -22.93031961091978, -11.927553383955818, -13.419618386048342, 5.725841459069176, 18.02582916443613, 4.019150268054254, -7.435584272786183, 5.757071845260114, -12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027016871027824, "mean_inference_ms": 1.0423301944767243, "mean_action_processing_ms": 0.17287478500395845, "mean_env_wait_ms": 0.06844229924254779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010867953300476074, "StateBufferConnector_ms": 0.00294649600982666, "ViewRequirementAgentConnector_ms": 0.08229362964630127}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.6684530659144, "num_env_steps_trained_throughput_per_sec": 447.6684530659144, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 8832.829, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8832.788, "sample_time_ms": 906.15, "learn_time_ms": 7912.634, "learn_throughput": 505.521, "synch_weights_time_ms": 13.247}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 25, "trial_id": "fa423_00000", "date": "2024-08-10_11-01-54", "timestamp": 1723302114, "time_this_iter_s": 8.942000150680542, "time_total_s": 204.91488695144653, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d20d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.91488695144653, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.623076923076926, "ram_util_percent": 81.06923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4193611871628535, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.184758462855425, "policy_loss": -0.004503345114878679, "vf_loss": 4.1885144116386535, "vf_explained_var": -0.10598691380213178, "kl": 0.008857967422626508, "entropy": 1.4239770063016781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4811510649199287, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.971543429295222, "policy_loss": -0.003954479019497133, "vf_loss": 5.975134613613288, "vf_explained_var": 0.16543552602330844, "kl": 0.009688251102650014, "entropy": 1.108102189625303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.88, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38688, "policy_reward_min": {"agent_policy": -31.638821318540867, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 74.58251355539346, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 10.78735201427625, "adversary_policy": -5.393676007138128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400], "policy_agent_policy_reward": [7.160284456944289, 6.41250826556022, 11.241936188257874, 15.572234364019963, 38.29460154224357, 46.53860365604605, 25.413951727694776, 28.212046482188843, 32.38874370000582, 14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475], "policy_adversary_policy_reward": [-12.4999255256694, 5.339641068725111, -10.114842072512829, 3.702333806952609, -17.421915245764204, 6.17997905750633, -7.144704001292425, -8.427530362727538, -27.973431751603165, -10.3211697906404, -36.3915812235125, -10.147022432533586, -3.5977510355830518, -21.81620069211173, -10.58795243561877, -17.624094046570075, -16.619305548315683, -15.76943815169017, -13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4054993870272151, "mean_inference_ms": 1.050524810080394, "mean_action_processing_ms": 0.17413031904389878, "mean_env_wait_ms": 0.06900579655888117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010872602462768555, "StateBufferConnector_ms": 0.002950429916381836, "ViewRequirementAgentConnector_ms": 0.08314132690429688}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.2762082595594, "num_env_steps_trained_throughput_per_sec": 460.2762082595594, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 8899.382, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8899.34, "sample_time_ms": 923.921, "learn_time_ms": 7961.333, "learn_throughput": 502.428, "synch_weights_time_ms": 13.323}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 26, "trial_id": "fa423_00000", "date": "2024-08-10_11-02-03", "timestamp": 1723302123, "time_this_iter_s": 8.6964750289917, "time_total_s": 213.61136198043823, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d2280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 213.61136198043823, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.399999999999995, "ram_util_percent": 81.1923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2417423182379, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.907317080194988, "policy_loss": -0.004258612004877438, "vf_loss": 4.910498534560834, "vf_explained_var": 0.08833447928151125, "kl": 0.01276651949534424, "entropy": 1.4143629725017244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9126207999885083, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5914673005541164, "policy_loss": -0.006985245858231792, "vf_loss": 6.597450361649195, "vf_explained_var": 0.20401530644545954, "kl": 0.02672453906714105, "entropy": 1.0914984554052354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.88, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38688, "policy_reward_min": {"agent_policy": -32.73479139551247, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 74.58251355539346, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 9.299606448140018, "adversary_policy": -4.64980322407001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [14.487259748217834, 1.272099178284801, 12.925223668875102, -17.858955561334, 10.302227141324344, 4.71925878001834, -17.946318169818827, 24.825662153341142, 20.37940382968239, 11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247], "policy_adversary_policy_reward": [-13.97745158925849, -0.5098081589593448, 12.650133821026166, -13.922232999310967, -20.952990663684606, 8.027766994809504, -2.2338862190085216, 20.09284178034252, -2.396664363739241, -7.905562777585104, -5.031265618704683, 0.3120068386863437, 1.0010885494013948, 16.945229620417432, -9.77100675052468, -15.05465540281646, -2.5169900384912474, -17.862413791191134, -13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40733615754828684, "mean_inference_ms": 1.0560025743043722, "mean_action_processing_ms": 0.1749475887844928, "mean_env_wait_ms": 0.06936230670409399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010557413101196289, "StateBufferConnector_ms": 0.0028836727142333984, "ViewRequirementAgentConnector_ms": 0.08197474479675293}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 474.6929821123942, "num_env_steps_trained_throughput_per_sec": 474.6929821123942, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 8933.61, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8933.568, "sample_time_ms": 924.367, "learn_time_ms": 7995.105, "learn_throughput": 500.306, "synch_weights_time_ms": 13.304}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 27, "trial_id": "fa423_00000", "date": "2024-08-10_11-02-11", "timestamp": 1723302131, "time_this_iter_s": 8.431787967681885, "time_total_s": 222.04314994812012, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d2430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.04314994812012, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 27.98333333333333, "ram_util_percent": 81.35833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.331082301448893, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.431270276175605, "policy_loss": -0.0035208211043879153, "vf_loss": 5.433795311842015, "vf_explained_var": -0.05829947931425912, "kl": 0.011801853796990645, "entropy": 1.3859952232194326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9030366878335676, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8457821443676945, "policy_loss": -0.012457023089276239, "vf_loss": 6.856849461297194, "vf_explained_var": 0.007142463636895021, "kl": 0.024706003306989213, "entropy": 1.1547576030095419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.88, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38688, "policy_reward_min": {"agent_policy": -32.73479139551247, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 74.58251355539346, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 10.297424157098519, "adversary_policy": -5.148712078549261}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [11.110600899321334, -7.720564278690198, 3.6585572777427124, 12.89275280358428, 0.2620713215275856, 0.5764901704321019, 31.047766234965067, 1.2338446082976695, 8.196527363746418, 16.049342692511164, -3.416571794843504, 15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365], "policy_adversary_policy_reward": [-13.225161515177057, 2.114560615855723, 0.279285833686032, 7.441278445004169, -7.884911170881235, 4.226353893138523, -8.591759269131565, -4.300993534452715, 3.5533130378388087, -3.8153843593664014, -2.5429923338617826, 1.9665021634296806, -12.231277095821394, -18.816489139143687, 1.8064643350237137, -3.0403089433213886, -7.974108431158884, -0.22241893258753365, -24.47703572496265, 8.427693032451486, -2.1593982059366823, 5.575970000780188, -6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40767343485980495, "mean_inference_ms": 1.057283586479915, "mean_action_processing_ms": 0.17512529425720358, "mean_env_wait_ms": 0.06947543192927108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01054072380065918, "StateBufferConnector_ms": 0.0027049779891967773, "ViewRequirementAgentConnector_ms": 0.07638370990753174}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.41641674006627, "num_env_steps_trained_throughput_per_sec": 500.41641674006627, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 8782.419, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8782.379, "sample_time_ms": 853.882, "learn_time_ms": 7914.606, "learn_throughput": 505.395, "synch_weights_time_ms": 13.118}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 28, "trial_id": "fa423_00000", "date": "2024-08-10_11-02-19", "timestamp": 1723302139, "time_this_iter_s": 7.998091697692871, "time_total_s": 230.041241645813, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d25e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.041241645813, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.558333333333326, "ram_util_percent": 81.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.000550111923268, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.287888659623565, "policy_loss": -0.009340414423470894, "vf_loss": 6.295451675899445, "vf_explained_var": -0.07234766555841637, "kl": 0.02106555934435663, "entropy": 1.4516834722624885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.077336346916854, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.193173155685266, "policy_loss": -0.007275058537197765, "vf_loss": 7.19938952177763, "vf_explained_var": 0.26622730897118646, "kl": 0.012547479904755226, "entropy": 1.1061021900425354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.63, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38363, "policy_reward_min": {"agent_policy": -32.73479139551247, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 74.58251355539346, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 12.151169650828065, "adversary_policy": -6.075584825414035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [15.240829725597017, 41.89638699217529, -3.5503963212599157, 14.283387692513184, -28.36677218488347, 12.058428692784503, -0.5494863504892038, 74.58251355539346, 27.5712235369693, 8.640459751104427, 70.92052255138995, -31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003], "policy_adversary_policy_reward": [-6.165852452332594, -9.07497727326442, -24.965993780857936, -16.930393211317387, 2.862117080192247, 0.6882792410676686, -11.085581573731126, -3.197806118782058, -0.019435936204370563, 28.38620812108783, -19.479937982695052, 7.421509289910549, 5.490652039185321, -4.941165688696117, -43.9527783844399, -30.62973517095373, -19.163750148866285, -8.407473388103014, 1.6536889263876944, -10.294148677492121, -43.142130035406375, -27.77839251598362, 15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40802547974839987, "mean_inference_ms": 1.0584962541940528, "mean_action_processing_ms": 0.17531974728452954, "mean_env_wait_ms": 0.06957153444843091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010528206825256348, "StateBufferConnector_ms": 0.0026807785034179688, "ViewRequirementAgentConnector_ms": 0.07600045204162598}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.41581408863414, "num_env_steps_trained_throughput_per_sec": 491.41581408863414, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 8665.4, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8665.362, "sample_time_ms": 853.008, "learn_time_ms": 7798.553, "learn_throughput": 512.916, "synch_weights_time_ms": 13.071}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 29, "trial_id": "fa423_00000", "date": "2024-08-10_11-02-28", "timestamp": 1723302148, "time_this_iter_s": 8.14462685585022, "time_total_s": 238.1858685016632, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7287ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.1858685016632, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.44545454545454, "ram_util_percent": 81.41818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1683495162025332, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.696202403023129, "policy_loss": -0.008554639937306837, "vf_loss": 5.7025224309749705, "vf_explained_var": -0.13860877206716588, "kl": 0.01765637355229713, "entropy": 1.437853317033677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.083825046538065, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.868701213598252, "policy_loss": -0.006766539376500683, "vf_loss": 6.874654376506806, "vf_explained_var": 0.19342200209697089, "kl": 0.009639920962411034, "entropy": 1.0417805055777232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.63, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38363, "policy_reward_min": {"agent_policy": -32.73479139551247, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 67.09467753420003, "adversary_policy": 35.93484059111489}, "policy_reward_mean": {"agent_policy": 11.31054790201941, "adversary_policy": -5.655273951009702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-31.638821318540867, 41.77152663609844, 0.45407632800818565, -4.719809134423407, 17.20499316634081, -19.752621661338832, -6.921817594074048, -6.631851950363213, -17.448506424030054, 16.830119454431646, -10.884121308399047, 49.65555614284264, -29.491619950237457, -18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003, 61.52547522806804, 26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704], "policy_adversary_policy_reward": [15.694291959610402, 15.944529358930478, -32.41433829869597, -9.35718833740247, 6.1074160622385705, -6.561492390246755, 2.7949771627715023, 1.924831971651905, -8.34126633403454, -8.86372683230627, 11.151949625708188, 8.600672035630645, -15.718820204849106, 22.64063779892315, 7.121913383690462, -0.49006143332725216, -5.532958689170156, 22.981465113200205, -8.302331859860942, -8.527787594570704, 1.0708593976958518, 9.813261910703199, -23.60242313091923, -26.05313301192341, -6.443220640877438, 35.93484059111489, 17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786, -26.423142755897786, -35.10233247217022, -24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4083159611628623, "mean_inference_ms": 1.0596502405252064, "mean_action_processing_ms": 0.17548821191058794, "mean_env_wait_ms": 0.0696545875601726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010457634925842285, "StateBufferConnector_ms": 0.002624034881591797, "ViewRequirementAgentConnector_ms": 0.07589435577392578}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.68385214878697, "num_env_steps_trained_throughput_per_sec": 487.68385214878697, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 8591.475, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8591.437, "sample_time_ms": 841.946, "learn_time_ms": 7737.539, "learn_throughput": 516.96, "synch_weights_time_ms": 11.334}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 30, "trial_id": "fa423_00000", "date": "2024-08-10_11-02-36", "timestamp": 1723302156, "time_this_iter_s": 8.221638917922974, "time_total_s": 246.40750741958618, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d28b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 246.40750741958618, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.424999999999997, "ram_util_percent": 81.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1687689238124426, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.849942643554122, "policy_loss": -0.005411687784300989, "vf_loss": 4.853960280948215, "vf_explained_var": -0.3398501691679475, "kl": 0.011014751542686527, "entropy": 1.3290347913585643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.169557154799501, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.453292479614417, "policy_loss": -0.004378540795490456, "vf_loss": 6.457008127868176, "vf_explained_var": -0.035660022000471754, "kl": 0.007856440289932546, "entropy": 1.0371224507068595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 381.37, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38137, "policy_reward_min": {"agent_policy": -58.13804354050276, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 68.02138297559316, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 11.81937419106399, "adversary_policy": -5.909687095531995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-18.004023551667295, 20.072487248974074, -7.7516157069607665, 41.055758334515545, -4.441453599258372, -5.5099505561841156, 10.036179944501917, 7.0307318114146895, 5.512061825143775, 16.595092450376892, 61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003, 61.52547522806804, 26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704, -12.838103294627606, 68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588], "policy_adversary_policy_reward": [17.052362563986012, 0.9516609876812794, -10.003173627421777, -10.069313621552297, 22.167827705775288, -14.416211998814497, -24.35181003385103, -16.703948300664514, 9.053697841605477, -4.612244242347103, -1.2773322671576608, 6.787282823341776, -5.7949222193851995, -4.241257725116718, 8.544984234425662, -15.575716045840352, -2.3629868034728787, -3.149075021670896, -11.972796128826495, -4.622296321550397, -51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786, -26.423142755897786, -35.10233247217022, -24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427, 2.4194696243498743, 10.418633670277732, -24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40815704323106056, "mean_inference_ms": 1.059674029865187, "mean_action_processing_ms": 0.17550846742572168, "mean_env_wait_ms": 0.06964910791914215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010846495628356934, "StateBufferConnector_ms": 0.0025986433029174805, "ViewRequirementAgentConnector_ms": 0.07569396495819092}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.9270694552367, "num_env_steps_trained_throughput_per_sec": 499.9270694552367, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 8462.882, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8462.842, "sample_time_ms": 828.904, "learn_time_ms": 7621.926, "learn_throughput": 524.802, "synch_weights_time_ms": 11.426}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 31, "trial_id": "fa423_00000", "date": "2024-08-10_11-02-44", "timestamp": 1723302164, "time_this_iter_s": 8.006342887878418, "time_total_s": 254.4138503074646, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d2af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.4138503074646, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.075, "ram_util_percent": 81.34166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1098092316319703, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.366888193604807, "policy_loss": -0.0056117106639292265, "vf_loss": 4.371415363417731, "vf_explained_var": -0.10777924820859597, "kl": 0.00856923908499752, "entropy": 1.1066124125132486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1549708529685936, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.841428746779759, "policy_loss": -0.00552611453992237, "vf_loss": 5.846093812088172, "vf_explained_var": 0.006479187247653802, "kl": 0.010205140011270543, "entropy": 1.0341082189232111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 377.48, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37748, "policy_reward_min": {"agent_policy": -58.13804354050276, "adversary_policy": -51.84326186642054}, "policy_reward_max": {"agent_policy": 68.02138297559316, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 11.816082519311045, "adversary_policy": -5.908041259655522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400], "policy_agent_policy_reward": [61.09882139540049, 24.080988562226683, -1.3139412446400627, -18.72483294187808, 3.2559120923988374, -10.908325880999723, 20.195224547940263, -3.1161192180535924, 10.972560799518579, 31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003, 61.52547522806804, 26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704, -12.838103294627606, 68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588, -14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188], "policy_adversary_policy_reward": [-51.84326186642054, -9.255559528979965, -15.419672680782927, -8.661315881443734, -14.160818096282984, 15.474759340923043, 15.494140849574624, 3.2306920923034497, 1.5461585801707045, -4.802070672569542, -7.119071618990223, 18.02739749998994, -4.20629812467412, -15.98892642326614, 12.174491783932428, -9.058372565878834, -9.878411865992014, -1.094148933526565, -19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786, -26.423142755897786, -35.10233247217022, -24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427, 2.4194696243498743, 10.418633670277732, -24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175, 9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40799554231465274, "mean_inference_ms": 1.0590020084012373, "mean_action_processing_ms": 0.17549193348887698, "mean_env_wait_ms": 0.06959423348209205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010885834693908691, "StateBufferConnector_ms": 0.002658367156982422, "ViewRequirementAgentConnector_ms": 0.07601058483123779}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.695404637254, "num_env_steps_trained_throughput_per_sec": 509.695404637254, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 8431.974, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8431.936, "sample_time_ms": 822.323, "learn_time_ms": 7597.578, "learn_throughput": 526.484, "synch_weights_time_ms": 11.406}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 32, "trial_id": "fa423_00000", "date": "2024-08-10_11-02-52", "timestamp": 1723302172, "time_this_iter_s": 7.853710889816284, "time_total_s": 262.2675611972809, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.2675611972809, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 23.963636363636365, "ram_util_percent": 81.19090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.880500097817214, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.689998437235595, "policy_loss": -0.004176218346224497, "vf_loss": 3.6933586940563545, "vf_explained_var": -0.1759295337729984, "kl": 0.006447074950004463, "entropy": 1.0633293355583513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5763269210234285, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.166600143909454, "policy_loss": -0.0019063741914578714, "vf_loss": 5.167739689101776, "vf_explained_var": 0.0403123473127683, "kl": 0.0090883026764533, "entropy": 0.9444211857393384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 381.19, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38119, "policy_reward_min": {"agent_policy": -58.13804354050276, "adversary_policy": -50.4666089710716}, "policy_reward_max": {"agent_policy": 71.49267403799763, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 10.647098280112262, "adversary_policy": -5.323549140056128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [31.129336061939483, 30.53259777404353, 32.465241429454196, -9.271134608197876, -24.085099744242733, 63.2772603756361, -18.016786444364815, 64.72377220149312, 7.633094849419933, 8.24709040706746, -1.0798955512578647, 49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003, 61.52547522806804, 26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704, -12.838103294627606, 68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588, -14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188, -26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104], "policy_adversary_policy_reward": [-19.32367337403988, -11.80566268789961, -7.0746684211185595, -23.457929352924975, -4.62290755613277, -27.842333873321422, 6.314325175953211, 2.956809432244654, 12.255152947970194, 11.82994679627254, -35.40403090483534, -27.873229470800737, 8.447188895346624, 9.56959754901822, -40.030229957169915, -24.69354224432323, -20.593667064548587, 12.960572215128654, -3.2716685145920366, -4.975421892475405, 8.83438583752513, -7.754490286267261, -5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786, -26.423142755897786, -35.10233247217022, -24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427, 2.4194696243498743, 10.418633670277732, -24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175, 9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242, 12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40756295693643246, "mean_inference_ms": 1.0575091012585807, "mean_action_processing_ms": 0.17532282251855932, "mean_env_wait_ms": 0.06943685843392801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004007935523986816, "StateBufferConnector_ms": 0.0026367902755737305, "ViewRequirementAgentConnector_ms": 0.06846058368682861}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 517.2442167479714, "num_env_steps_trained_throughput_per_sec": 517.2442167479714, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 8315.307, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8315.269, "sample_time_ms": 802.897, "learn_time_ms": 7500.273, "learn_throughput": 533.314, "synch_weights_time_ms": 11.393}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 33, "trial_id": "fa423_00000", "date": "2024-08-10_11-03-00", "timestamp": 1723302180, "time_this_iter_s": 7.7387590408325195, "time_total_s": 270.0063202381134, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d2d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.0063202381134, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.25454545454545, "ram_util_percent": 81.04545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8175698388505865, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7988097631111346, "policy_loss": -0.0041971690769223545, "vf_loss": 3.80229485791827, "vf_explained_var": -0.4931869153938596, "kl": 0.005626209903101633, "entropy": 0.9907149823254379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2927987813328703, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.920657552530368, "policy_loss": -0.0032645971999348453, "vf_loss": 4.923203251510858, "vf_explained_var": 0.11617975824822982, "kl": 0.008519912451037483, "entropy": 0.9700212512165308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 381.19, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38119, "policy_reward_min": {"agent_policy": -58.13804354050276, "adversary_policy": -50.4666089710716}, "policy_reward_max": {"agent_policy": 74.44055786496381, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 10.748427089389596, "adversary_policy": -5.374213544694798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [49.62379613802814, 12.28547604185685, -6.791442454064761, -3.970185941236945, 30.442379577778855, 6.835947048365558, 11.475790092018489, 9.355614486447173, -19.288343975723535, 24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003, 61.52547522806804, 26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704, -12.838103294627606, 68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588, -14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188, -26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104, 50.94408973535047, -31.174065184948276, 74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373], "policy_adversary_policy_reward": [-5.017648385648435, -44.606147752379705, -3.3672913396148942, -8.918184702241955, -0.7311264884843744, 7.522568942549135, -7.547101538734459, 11.517287479971404, -18.428104795909416, -12.014274781869453, -10.100531028917136, 3.2645839805515777, 7.548193955496689, -19.023984047515174, -4.240311191749441, -5.115303294697732, 9.929424858302426, 9.358919117421113, -15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786, -26.423142755897786, -35.10233247217022, -24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427, 2.4194696243498743, 10.418633670277732, -24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175, 9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242, 12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801, -24.650273664656247, -26.29381607069422, 20.38484110299039, 10.789224081957869, -34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4066317802105203, "mean_inference_ms": 1.054465553072025, "mean_action_processing_ms": 0.1749010820048122, "mean_env_wait_ms": 0.06920104174905987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.0024527311325073242, "ViewRequirementAgentConnector_ms": 0.06562697887420654}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.9831175544206, "num_env_steps_trained_throughput_per_sec": 499.9831175544206, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 8196.989, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8196.951, "sample_time_ms": 778.51, "learn_time_ms": 7406.273, "learn_throughput": 540.083, "synch_weights_time_ms": 11.486}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 34, "trial_id": "fa423_00000", "date": "2024-08-10_11-03-08", "timestamp": 1723302188, "time_this_iter_s": 8.005916118621826, "time_total_s": 278.01223635673523, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d2af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.01223635673523, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 23.125, "ram_util_percent": 80.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.034817141578311, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9491287072499595, "policy_loss": -0.004003060778366431, "vf_loss": 3.952509410040719, "vf_explained_var": -0.21941256519978639, "kl": 0.004917417972988955, "entropy": 0.961395199525924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.156498074159026, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.214759906629721, "policy_loss": -0.0038579182374329926, "vf_loss": 5.218004659563303, "vf_explained_var": 0.27314210689316193, "kl": 0.00726714685179796, "entropy": 1.004230137852331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 381.19, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38119, "policy_reward_min": {"agent_policy": -58.13804354050276, "adversary_policy": -50.4666089710716}, "policy_reward_max": {"agent_policy": 74.44055786496381, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 10.756804889156975, "adversary_policy": -5.378402444578488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 150, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [24.01621898999202, 54.190386704780686, 30.218446044295014, -15.86500295103837, 0.40763737326422245, 12.355943786891295, -9.784607828451447, -11.84967324709475, 43.8029962310321, 28.25868393821652, 19.66091089267731, -3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003, 61.52547522806804, 26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704, -12.838103294627606, 68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588, -14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188, -26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104, 50.94408973535047, -31.174065184948276, 74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373, 44.70911724868852, -35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082], "policy_adversary_policy_reward": [-15.216035979297423, -8.800183010694589, -21.895624289633872, -32.294762415146806, -12.973935580010789, -17.244510464284225, -7.596066028684884, 23.461068979723255, 3.5635394350180256, -3.971176808282248, -2.01448325773724, -10.341460529154055, 15.681488471649486, -5.896880643198038, 9.893335625740704, 1.956337621354045, -21.512626818522875, -22.29036941250922, -10.848809051485844, -17.409874886730677, 2.301761944084763, -21.962672836762078, -2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786, -26.423142755897786, -35.10233247217022, -24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427, 2.4194696243498743, 10.418633670277732, -24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175, 9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242, 12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801, -24.650273664656247, -26.29381607069422, 20.38484110299039, 10.789224081957869, -34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092, -17.633865983581597, -27.07525126510692, 15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4055963094581911, "mean_inference_ms": 1.0518515040632865, "mean_action_processing_ms": 0.1745849753966231, "mean_env_wait_ms": 0.06893976595435442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003722071647644043, "StateBufferConnector_ms": 0.0024747848510742188, "ViewRequirementAgentConnector_ms": 0.06561315059661865}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.7087504151011, "num_env_steps_trained_throughput_per_sec": 505.7087504151011, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 8094.439, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8094.402, "sample_time_ms": 754.59, "learn_time_ms": 7327.983, "learn_throughput": 545.853, "synch_weights_time_ms": 11.138}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 35, "trial_id": "fa423_00000", "date": "2024-08-10_11-03-16", "timestamp": 1723302196, "time_this_iter_s": 7.914851188659668, "time_total_s": 285.9270875453949, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d2f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 285.9270875453949, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 25.10909090909091, "ram_util_percent": 80.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9695179128772997, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.67567571092535, "policy_loss": -0.007198917559993566, "vf_loss": 4.682191867676992, "vf_explained_var": -0.22421047602381025, "kl": 0.010789175014028289, "entropy": 0.9448804753167289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4385990008711813, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.698029026885828, "policy_loss": -0.003377309448599893, "vf_loss": 5.700825759768486, "vf_explained_var": 0.40569653138518336, "kl": 0.006881127016052354, "entropy": 1.055171529079477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.08, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38308, "policy_reward_min": {"agent_policy": -58.13804354050276, "adversary_policy": -50.79982769506033}, "policy_reward_max": {"agent_policy": 96.11557345117788, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 8.436931342429304, "adversary_policy": -4.218465671214652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 113, 400, 400, 392, 303, 400, 400, 383], "policy_agent_policy_reward": [-3.3587257002283586, 13.269861396715005, -10.608811030503947, 15.573912028681015, -11.403682591739226, -32.73479139551247, 40.82690719998756, 23.328990544402433, -7.904476060401169, 14.109900979860903, -27.567525132343363, 49.84482543185001, 9.389980041014404, 47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003, 61.52547522806804, 26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704, -12.838103294627606, 68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588, -14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188, -26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104, 50.94408973535047, -31.174065184948276, 74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373, 44.70911724868852, -35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082, 94.13188160994068, -51.295016315435916, 96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585], "policy_adversary_policy_reward": [-2.8542672840583343, 6.212992984286693, -13.69957324559704, 0.42971184888203595, 11.223551604825488, -0.6147405743215408, -3.2151976943108416, -12.358714334370184, 3.9581325740578137, 7.445550017681413, 17.22462164726371, 15.510169748248757, -8.907991455015459, -31.918915744972097, -12.525428222256227, -10.803562322146206, -1.3615378318374063, 9.266013892238576, -12.762309560102977, -1.3475914197579257, 9.756953509918798, 17.810571622424565, -25.342356963550305, -24.502468468299703, -6.8283409778909885, -2.5616390631234154, -30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786, -26.423142755897786, -35.10233247217022, -24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427, 2.4194696243498743, 10.418633670277732, -24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175, 9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242, 12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801, -24.650273664656247, -26.29381607069422, 20.38484110299039, 10.789224081957869, -34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092, -17.633865983581597, -27.07525126510692, 15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664, -43.33205391488043, -50.79982769506033, 18.973138299274584, 32.32187801616133, -47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4043565184316477, "mean_inference_ms": 1.0480768808472418, "mean_action_processing_ms": 0.17403955112472996, "mean_env_wait_ms": 0.0686247157035376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686666488647461, "StateBufferConnector_ms": 0.00249481201171875, "ViewRequirementAgentConnector_ms": 0.06572449207305908}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.474097600995, "num_env_steps_trained_throughput_per_sec": 503.474097600995, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 8019.875, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8019.839, "sample_time_ms": 737.39, "learn_time_ms": 7270.904, "learn_throughput": 550.138, "synch_weights_time_ms": 10.863}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 36, "trial_id": "fa423_00000", "date": "2024-08-10_11-03-24", "timestamp": 1723302204, "time_this_iter_s": 7.950017213821411, "time_total_s": 293.8771047592163, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 293.8771047592163, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.916666666666668, "ram_util_percent": 80.38333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.019229793769342, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.334801680574972, "policy_loss": -0.004364234613064953, "vf_loss": 4.338634243591753, "vf_explained_var": -0.20943101590903349, "kl": 0.008401645963332522, "entropy": 0.9646175404705067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2568493985881406, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.797437818348408, "policy_loss": -0.009613084720331243, "vf_loss": 4.805799894779921, "vf_explained_var": 0.33036998969813186, "kl": 0.014826983896764878, "entropy": 1.0781412944197655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 371.82, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 37182, "policy_reward_min": {"agent_policy": -58.13804354050276, "adversary_policy": -50.79982769506033}, "policy_reward_max": {"agent_policy": 96.11557345117788, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 9.04942713810254, "adversary_policy": -4.5247135690512685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16], "episode_lengths": [400, 400, 400, 75, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 113, 400, 400, 392, 303, 400, 400, 383, 400, 400, 400, 400, 400, 400, 4, 400, 143, 11, 316, 400, 400], "policy_agent_policy_reward": [47.753332708222224, 3.1056959518482365, 5.8861233874805805, -21.020686755149548, 64.55948378436071, 22.26534323344044, -7.290160482091775, 34.27949393072602, 50.22615681937923, -6.55728107517999, 34.994436322417116, 14.827779971966581, 67.09467753420003, 61.52547522806804, 26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704, -12.838103294627606, 68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588, -14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188, -26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104, 50.94408973535047, -31.174065184948276, 74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373, 44.70911724868852, -35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082, 94.13188160994068, -51.295016315435916, 96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585, 80.04266031572773, -20.405389533962165, 73.25631403616478, 23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752], "policy_adversary_policy_reward": [-30.516978912565612, -17.236353795656612, 3.2248748453917067, -6.330570797239943, 10.607205351335853, -16.493328738816434, 3.661292598006881, 17.359394157142656, -29.47893918270627, -35.080544601654445, -14.10280642526764, -8.1625368081728, -9.716994654847856, 17.00715513693963, -9.510715372362295, -24.76877855836372, -25.10078912525904, -25.125367694120165, -2.0028712552217627, 8.560152330401753, -16.022502226300535, -18.971934096116563, -5.279028763944726, -9.548751208021855, -29.162217839615206, -37.932459694584786, -26.423142755897786, -35.10233247217022, -24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427, 2.4194696243498743, 10.418633670277732, -24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175, 9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242, 12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801, -24.650273664656247, -26.29381607069422, 20.38484110299039, 10.789224081957869, -34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092, -17.633865983581597, -27.07525126510692, 15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664, -43.33205391488043, -50.79982769506033, 18.973138299274584, 32.32187801616133, -47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013, -30.944325129757623, -49.098335185970114, 5.856217199158225, 14.549172334803968, -33.41461542522408, -39.841698610940696, -13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4030514857052319, "mean_inference_ms": 1.0439406237514925, "mean_action_processing_ms": 0.17353443489198997, "mean_env_wait_ms": 0.06827830786911566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035631656646728516, "StateBufferConnector_ms": 0.002483844757080078, "ViewRequirementAgentConnector_ms": 0.06509637832641602}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.4865184556631, "num_env_steps_trained_throughput_per_sec": 451.4865184556631, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 8063.187, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8063.152, "sample_time_ms": 739.894, "learn_time_ms": 7312.01, "learn_throughput": 547.045, "synch_weights_time_ms": 10.6}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "training_iteration": 37, "trial_id": "fa423_00000", "date": "2024-08-10_11-03-33", "timestamp": 1723302213, "time_this_iter_s": 8.90402102470398, "time_total_s": 302.7811257839203, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.7811257839203, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.77692307692308, "ram_util_percent": 80.86153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.112051391286194, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.04231586784282, "policy_loss": -0.002607210572542889, "vf_loss": 4.044351156300338, "vf_explained_var": 0.06995315895509467, "kl": 0.009037799229818351, "entropy": 1.0147802436477924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.712762108631432, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.937585163861513, "policy_loss": -0.017667465684159347, "vf_loss": 5.952500902364651, "vf_explained_var": 0.45862890680631, "kl": 0.03261321266208883, "entropy": 0.9661720849573612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 361.54, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 36154, "policy_reward_min": {"agent_policy": -58.13804354050276, "adversary_policy": -55.05026827435395}, "policy_reward_max": {"agent_policy": 106.91168930273878, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 6.339775660854343, "adversary_policy": -3.1698878304271703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 21, 400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 113, 400, 400, 392, 303, 400, 400, 383, 400, 400, 400, 400, 400, 400, 4, 400, 143, 11, 316, 400, 400, 400, 400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36], "policy_agent_policy_reward": [26.70408512495373, -7.703326443342725, 8.376143041056153, 12.856476311541602, 22.75218015855794, 49.54536404666534, -9.653445261777101, -23.66123546259643, 10.231844073764378, -2.3086380564624704, -12.838103294627606, 68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588, -14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188, -26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104, 50.94408973535047, -31.174065184948276, 74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373, 44.70911724868852, -35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082, 94.13188160994068, -51.295016315435916, 96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585, 80.04266031572773, -20.405389533962165, 73.25631403616478, 23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752, 106.91168930273878, -10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806], "policy_adversary_policy_reward": [-24.80129259961855, -1.9027925253351796, 6.507035240097096, 1.1962912032456288, -2.469705034492577, -5.906438006563576, 3.4064414343487037, -16.262917745890306, -2.892226368146595, -19.859953790411346, -50.4666089710716, 0.9212449244063023, 10.942834469280825, -1.2893892075037243, 15.078304035232705, 8.582931427363725, -10.563089025373902, 0.3312449516095235, 9.58588078065889, -7.277242724196427, 2.4194696243498743, 10.418633670277732, -24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175, 9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242, 12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801, -24.650273664656247, -26.29381607069422, 20.38484110299039, 10.789224081957869, -34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092, -17.633865983581597, -27.07525126510692, 15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664, -43.33205391488043, -50.79982769506033, 18.973138299274584, 32.32187801616133, -47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013, -30.944325129757623, -49.098335185970114, 5.856217199158225, 14.549172334803968, -33.41461542522408, -39.841698610940696, -13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877, -55.05026827435395, -51.86142102838491, -5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40207133879100887, "mean_inference_ms": 1.0414744430442975, "mean_action_processing_ms": 0.17324404056374776, "mean_env_wait_ms": 0.0680594217342148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004103302955627441, "StateBufferConnector_ms": 0.002631068229675293, "ViewRequirementAgentConnector_ms": 0.06995773315429688}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.43245908304465, "num_env_steps_trained_throughput_per_sec": 444.43245908304465, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 8163.878, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8163.842, "sample_time_ms": 772.685, "learn_time_ms": 7379.604, "learn_throughput": 542.035, "synch_weights_time_ms": 10.896}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 38, "trial_id": "fa423_00000", "date": "2024-08-10_11-03-43", "timestamp": 1723302223, "time_this_iter_s": 9.005769968032837, "time_total_s": 311.7868957519531, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.7868957519531, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 37.599999999999994, "ram_util_percent": 81.97692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0271988758965143, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.656614904050474, "policy_loss": -0.005335384902973024, "vf_loss": 4.6612740335010345, "vf_explained_var": -0.007613496490256496, "kl": 0.01068664819120422, "entropy": 1.1202828559925948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.087746542816361, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.438472339510918, "policy_loss": -0.005184375915996497, "vf_loss": 6.4427218993504844, "vf_explained_var": 0.362603703700006, "kl": 0.007386179902305797, "entropy": 0.9710535526896517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 362.54, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36254, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -55.05026827435395}, "policy_reward_max": {"agent_policy": 106.91168930273878, "adversary_policy": 36.38431005439281}, "policy_reward_mean": {"agent_policy": 6.554347453444264, "adversary_policy": -3.2771737267221317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 210, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 113, 400, 400, 392, 303, 400, 400, 383, 400, 400, 400, 400, 400, 400, 4, 400, 143, 11, 316, 400, 400, 400, 400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400], "policy_agent_policy_reward": [68.02138297559316, -22.570061966847135, -22.623644390437, 1.7990204609620726, 10.406724627764952, -58.13804354050276, 28.51100509354521, 47.58010438389584, 25.08210901486019, 23.330421733558953, -28.14584541721214, -11.105338389780588, -14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188, -26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104, 50.94408973535047, -31.174065184948276, 74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373, 44.70911724868852, -35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082, 94.13188160994068, -51.295016315435916, 96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585, 80.04266031572773, -20.405389533962165, 73.25631403616478, 23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752, 106.91168930273878, -10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649], "policy_adversary_policy_reward": [-24.669063322779312, -43.35231965281388, 12.969664501099576, 9.600397465747553, 22.357512279988136, 0.266132110448865, -1.8579009933992126, 0.058880532437139976, -0.18810006285153946, -10.218624564913384, 36.38431005439281, 21.75373348610993, -19.098564092802576, -9.412441000742634, -27.067950146043664, -20.512154237852208, -19.85585761563676, -5.2262513992234325, -7.565093940878604, -15.765327792680338, 5.262862283963543, 22.882983133248597, 1.0294266633063973, 10.075911726474175, 9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242, 12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801, -24.650273664656247, -26.29381607069422, 20.38484110299039, 10.789224081957869, -34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092, -17.633865983581597, -27.07525126510692, 15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664, -43.33205391488043, -50.79982769506033, 18.973138299274584, 32.32187801616133, -47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013, -30.944325129757623, -49.098335185970114, 5.856217199158225, 14.549172334803968, -33.41461542522408, -39.841698610940696, -13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877, -55.05026827435395, -51.86142102838491, -5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4016644124017386, "mean_inference_ms": 1.0403103039150687, "mean_action_processing_ms": 0.1730791754747969, "mean_env_wait_ms": 0.06798280679315476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00416719913482666, "StateBufferConnector_ms": 0.002675175666809082, "ViewRequirementAgentConnector_ms": 0.07285749912261963}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.8885138404476, "num_env_steps_trained_throughput_per_sec": 467.8885138404476, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 8204.808, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8204.772, "sample_time_ms": 782.442, "learn_time_ms": 7410.845, "learn_throughput": 539.75, "synch_weights_time_ms": 10.785}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "training_iteration": 39, "trial_id": "fa423_00000", "date": "2024-08-10_11-03-51", "timestamp": 1723302231, "time_this_iter_s": 8.554959058761597, "time_total_s": 320.3418548107147, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 320.3418548107147, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.933333333333334, "ram_util_percent": 82.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9709081814402625, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.185369062297559, "policy_loss": -0.004497080247001673, "vf_loss": 4.1893319484418035, "vf_explained_var": -0.24637725791603168, "kl": 0.008441434640049877, "entropy": 1.1413923842566354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.805601084108154, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.035070888698101, "policy_loss": -0.004153395884107643, "vf_loss": 6.038344482084115, "vf_explained_var": 0.34123336610694727, "kl": 0.006951700053833521, "entropy": 0.9474476353575786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 356.87, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35687, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -55.05026827435395}, "policy_reward_max": {"agent_policy": 106.91168930273878, "adversary_policy": 32.9325872825184}, "policy_reward_mean": {"agent_policy": 7.9473574191707375, "adversary_policy": -3.9736787095853687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 113, 400, 400, 392, 303, 400, 400, 383, 400, 400, 400, 400, 400, 400, 4, 400, 143, 11, 316, 400, 400, 400, 400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400], "policy_agent_policy_reward": [-14.561006704152561, 0.46412078081589314, 56.392943683905564, 23.477464096274822, -9.273806900859608, -13.098891690067607, -1.5919338276555797, 62.659459975955826, -20.645226157512823, -19.55702223114188, -26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104, 50.94408973535047, -31.174065184948276, 74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373, 44.70911724868852, -35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082, 94.13188160994068, -51.295016315435916, 96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585, 80.04266031572773, -20.405389533962165, 73.25631403616478, 23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752, 106.91168930273878, -10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128], "policy_adversary_policy_reward": [9.518323736707146, 5.042682967445415, 6.089917079009588, -6.554037859825481, -36.943075570408084, -19.44986811349748, -12.433571729820642, -11.04389236645418, -1.1492196733290285, 10.423026574188636, 4.647312319560548, 8.451579370507059, 5.263251805780508, -3.6713179781249288, -33.710483330349234, -28.948976645606514, 11.821307191214926, 8.8239189662979, -9.210545674668356, 28.767567905810242, 12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801, -24.650273664656247, -26.29381607069422, 20.38484110299039, 10.789224081957869, -34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092, -17.633865983581597, -27.07525126510692, 15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664, -43.33205391488043, -50.79982769506033, 18.973138299274584, 32.32187801616133, -47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013, -30.944325129757623, -49.098335185970114, 5.856217199158225, 14.549172334803968, -33.41461542522408, -39.841698610940696, -13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877, -55.05026827435395, -51.86142102838491, -5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40138596395989423, "mean_inference_ms": 1.0398363812574931, "mean_action_processing_ms": 0.17299911912273433, "mean_env_wait_ms": 0.06800213769760684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038715600967407227, "StateBufferConnector_ms": 0.0026781558990478516, "ViewRequirementAgentConnector_ms": 0.07268929481506348}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.4797689926027, "num_env_steps_trained_throughput_per_sec": 436.4797689926027, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 8301.028, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8300.985, "sample_time_ms": 784.058, "learn_time_ms": 7504.35, "learn_throughput": 533.024, "synch_weights_time_ms": 11.417}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 40, "trial_id": "fa423_00000", "date": "2024-08-10_11-04-01", "timestamp": 1723302241, "time_this_iter_s": 9.207963705062866, "time_total_s": 329.5498185157776, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 329.5498185157776, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 39.74615384615385, "ram_util_percent": 81.79230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.724395590831363, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.980029551314298, "policy_loss": -0.004964927753073868, "vf_loss": 4.983922738120669, "vf_explained_var": -0.6413413129155598, "kl": 0.01693629468172732, "entropy": 1.08769959356419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1393114004905027, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.858684749901295, "policy_loss": -0.005207113263168139, "vf_loss": 5.862653969228267, "vf_explained_var": 0.4961040772497654, "kl": 0.009780718958152527, "entropy": 0.93084975797683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 357.49, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35749, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -56.092401454467165}, "policy_reward_max": {"agent_policy": 106.91168930273878, "adversary_policy": 32.9325872825184}, "policy_reward_mean": {"agent_policy": 10.583777959869595, "adversary_policy": -5.2918889799347975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 113, 400, 400, 392, 303, 400, 400, 383, 400, 400, 400, 400, 400, 400, 4, 400, 143, 11, 316, 400, 400, 400, 400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-26.15497177102922, 65.50875024191528, 71.49267403799763, -28.518663722918262, -42.45313953130716, -6.1633937198191795, -26.560715074602964, -20.030915767381444, -18.477760500820104, 50.94408973535047, -31.174065184948276, 74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373, 44.70911724868852, -35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082, 94.13188160994068, -51.295016315435916, 96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585, 80.04266031572773, -20.405389533962165, 73.25631403616478, 23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752, 106.91168930273878, -10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806], "policy_adversary_policy_reward": [12.769163743505118, 13.385808027524103, -37.68456891610438, -27.8241813258109, -50.450201248441935, -21.042472789555646, 24.131127018685333, 4.387536704232929, 21.901118570305094, 20.552020961002082, 18.486337929561312, -12.32294420974213, 9.58079526003332, 16.979919814569644, 11.258513219865133, 8.772402547516299, 6.696891824472111, 11.78086867634801, -24.650273664656247, -26.29381607069422, 20.38484110299039, 10.789224081957869, -34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092, -17.633865983581597, -27.07525126510692, 15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664, -43.33205391488043, -50.79982769506033, 18.973138299274584, 32.32187801616133, -47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013, -30.944325129757623, -49.098335185970114, 5.856217199158225, 14.549172334803968, -33.41461542522408, -39.841698610940696, -13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877, -55.05026827435395, -51.86142102838491, -5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4012309912490275, "mean_inference_ms": 1.0396747425466937, "mean_action_processing_ms": 0.17293961291560023, "mean_env_wait_ms": 0.06802098293193963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038689374923706055, "StateBufferConnector_ms": 0.0026187896728515625, "ViewRequirementAgentConnector_ms": 0.07180249691009521}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.5170963876057, "num_env_steps_trained_throughput_per_sec": 498.5170963876057, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 8303.289, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8303.248, "sample_time_ms": 794.893, "learn_time_ms": 7495.892, "learn_throughput": 533.626, "synch_weights_time_ms": 11.298}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "training_iteration": 41, "trial_id": "fa423_00000", "date": "2024-08-10_11-04-09", "timestamp": 1723302249, "time_this_iter_s": 8.028706789016724, "time_total_s": 337.5785253047943, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7287a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 337.5785253047943, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.800000000000008, "ram_util_percent": 81.05833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.004814196862872, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.672449007993022, "policy_loss": -0.004320564377614391, "vf_loss": 4.6758532011950455, "vf_explained_var": -0.37962462873685926, "kl": 0.014480939844303192, "entropy": 1.0397811223590185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.699885023323198, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.151551202684641, "policy_loss": -0.0057637954174424525, "vf_loss": 5.155924856911103, "vf_explained_var": 0.5295273105924329, "kl": 0.01098372925792093, "entropy": 0.919901876958708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 353.74, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35374, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -56.092401454467165}, "policy_reward_max": {"agent_policy": 106.91168930273878, "adversary_policy": 36.938724105856416}, "policy_reward_mean": {"agent_policy": 11.847183114466565, "adversary_policy": -5.923591557233283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 113, 400, 400, 392, 303, 400, 400, 383, 400, 400, 400, 400, 400, 400, 4, 400, 143, 11, 316, 400, 400, 400, 400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [74.44055786496381, 2.241055799835854, 36.02701441372252, 67.8246162477657, 13.489547423162694, -55.75208791796446, 70.92256534992961, -13.380292251261212, -19.894643801832373, 44.70911724868852, -35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082, 94.13188160994068, -51.295016315435916, 96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585, 80.04266031572773, -20.405389533962165, 73.25631403616478, 23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752, 106.91168930273878, -10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601], "policy_adversary_policy_reward": [-34.86785832953068, -39.57269953543313, -9.640187767734691, 7.399131967898837, -19.041773804536962, -16.985240609185553, -29.04461984877556, -38.77999639899016, -5.414680045919635, -8.074867377243063, 25.749804760190827, 30.00228315777359, -43.53371778592587, -27.388847564003733, 12.106771233828118, 1.273521017433099, 3.3189335198262846, 16.575710282006092, -17.633865983581597, -27.07525126510692, 15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664, -43.33205391488043, -50.79982769506033, 18.973138299274584, 32.32187801616133, -47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013, -30.944325129757623, -49.098335185970114, 5.856217199158225, 14.549172334803968, -33.41461542522408, -39.841698610940696, -13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877, -55.05026827435395, -51.86142102838491, -5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4012046281486616, "mean_inference_ms": 1.0396891681055775, "mean_action_processing_ms": 0.17289530531741043, "mean_env_wait_ms": 0.06803529374535772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003961920738220215, "StateBufferConnector_ms": 0.002711653709411621, "ViewRequirementAgentConnector_ms": 0.07154655456542969}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.3283579497571, "num_env_steps_trained_throughput_per_sec": 491.3283579497571, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 8332.627, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8332.564, "sample_time_ms": 798.325, "learn_time_ms": 7520.854, "learn_throughput": 531.855, "synch_weights_time_ms": 12.173}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 42, "trial_id": "fa423_00000", "date": "2024-08-10_11-04-17", "timestamp": 1723302257, "time_this_iter_s": 8.173524856567383, "time_total_s": 345.7520501613617, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 345.7520501613617, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 39.666666666666664, "ram_util_percent": 81.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4776057340796034, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.457360992734395, "policy_loss": -0.010047978547367232, "vf_loss": 4.466099734911843, "vf_explained_var": -0.07339480904044297, "kl": 0.02068924715670258, "entropy": 1.2005612196745696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4623092165216804, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.679124176253875, "policy_loss": -0.007722948379038522, "vf_loss": 5.685682048400243, "vf_explained_var": 0.405911982866625, "kl": 0.009205479853908006, "entropy": 0.9516002059603731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 352.19, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35219, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -56.092401454467165}, "policy_reward_max": {"agent_policy": 106.91168930273878, "adversary_policy": 36.938724105856416}, "policy_reward_mean": {"agent_policy": 11.230873675917534, "adversary_policy": -5.615436837958769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 113, 400, 400, 392, 303, 400, 400, 383, 400, 400, 400, 400, 400, 400, 4, 400, 143, 11, 316, 400, 400, 400, 400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-35.079224657478754, 54.094108484275104, 16.114877213500503, 0.9598240088896848, -27.240413610935697, 60.38972507976551, -22.650008076677935, -0.4911946998190082, 94.13188160994068, -51.295016315435916, 96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585, 80.04266031572773, -20.405389533962165, 73.25631403616478, 23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752, 106.91168930273878, -10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707], "policy_adversary_policy_reward": [15.776262776053098, 19.302961881425638, -16.436715432760863, -37.657393051514234, -3.919419386965643, -12.19545782653486, -0.4519516568316302, -0.5078723520580528, 25.6729651438821, 1.5674484670535946, -41.498414772807514, -18.891310306957998, 2.4921869215210606, 20.157821155156867, -3.6850101318326587, 4.176204831651664, -43.33205391488043, -50.79982769506033, 18.973138299274584, 32.32187801616133, -47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013, -30.944325129757623, -49.098335185970114, 5.856217199158225, 14.549172334803968, -33.41461542522408, -39.841698610940696, -13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877, -55.05026827435395, -51.86142102838491, -5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40139101431854823, "mean_inference_ms": 1.0408321603390842, "mean_action_processing_ms": 0.1731057623566886, "mean_env_wait_ms": 0.06812344637812971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004030942916870117, "StateBufferConnector_ms": 0.0027930736541748047, "ViewRequirementAgentConnector_ms": 0.07320952415466309}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.11425669104403, "num_env_steps_trained_throughput_per_sec": 493.11425669104403, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 8370.472, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8370.405, "sample_time_ms": 830.658, "learn_time_ms": 7526.386, "learn_throughput": 531.464, "synch_weights_time_ms": 12.236}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "training_iteration": 43, "trial_id": "fa423_00000", "date": "2024-08-10_11-04-26", "timestamp": 1723302266, "time_this_iter_s": 8.117366075515747, "time_total_s": 353.86941623687744, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 353.86941623687744, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.90833333333334, "ram_util_percent": 80.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9818227350711823, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.995933685227046, "policy_loss": -0.007152565121256485, "vf_loss": 5.002391303657855, "vf_explained_var": -0.04806665226265236, "kl": 0.007321231690784157, "entropy": 1.0434714819388415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.958600113571932, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.618276708324751, "policy_loss": -0.006228364800578371, "vf_loss": 5.623442611594995, "vf_explained_var": 0.4475661634777983, "kl": 0.008394696457303756, "entropy": 0.9170534214625756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 348.24, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 34824, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -56.092401454467165}, "policy_reward_max": {"agent_policy": 106.91168930273878, "adversary_policy": 36.938724105856416}, "policy_reward_mean": {"agent_policy": 10.648710687573546, "adversary_policy": -5.324355343786773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 113, 400, 400, 392, 303, 400, 400, 383, 400, 400, 400, 400, 400, 400, 4, 400, 143, 11, 316, 400, 400, 400, 400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400], "policy_agent_policy_reward": [96.11557345117788, -32.57124199787305, -6.819312885708003, -31.456043381790096, -26.128428008931998, -37.098962685733696, -36.29469133528981, -1.2913463593828585, -23.86782682917585, 80.04266031572773, -20.405389533962165, 73.25631403616478, 23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752, 106.91168930273878, -10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015], "policy_adversary_policy_reward": [-47.62291706500943, -48.49265638616841, 10.00995586389982, 22.561286133973226, 1.9429797181089121, 4.876333167599091, 21.619233972326764, 9.836809409463351, 22.583315216203378, 3.545112792728613, 9.01283007469328, 28.086132611040433, 28.793289464477283, 7.501401870812549, 6.036150512567586, -4.744804153184727, 4.136033537322834, 19.731793291853013, -30.944325129757623, -49.098335185970114, 5.856217199158225, 14.549172334803968, -33.41461542522408, -39.841698610940696, -13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877, -55.05026827435395, -51.86142102838491, -5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4017594260199831, "mean_inference_ms": 1.042154285642359, "mean_action_processing_ms": 0.17331993454355316, "mean_env_wait_ms": 0.06824726099777637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004073619842529297, "StateBufferConnector_ms": 0.0027933120727539062, "ViewRequirementAgentConnector_ms": 0.07485246658325195}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.4044104761553, "num_env_steps_trained_throughput_per_sec": 498.4044104761553, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 8373.006, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8372.939, "sample_time_ms": 829.382, "learn_time_ms": 7530.383, "learn_throughput": 531.181, "synch_weights_time_ms": 12.065}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 44, "trial_id": "fa423_00000", "date": "2024-08-10_11-04-34", "timestamp": 1723302274, "time_this_iter_s": 8.030840635299683, "time_total_s": 361.9002568721771, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 361.9002568721771, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 25.99090909090909, "ram_util_percent": 80.22727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.994121583018984, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.045968748148156, "policy_loss": -0.002945579727865243, "vf_loss": 5.048278639430092, "vf_explained_var": 0.029847302670201296, "kl": 0.00669691083704697, "entropy": 1.0026949263438976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9196642000228166, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.774401305615902, "policy_loss": -0.006762189697474242, "vf_loss": 5.7794593205054605, "vf_explained_var": 0.34305934781829517, "kl": 0.013465185381549076, "entropy": 0.847771868792673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -4.440892098500626e-16, "episode_reward_mean": -5.551115123125783e-18, "episode_len_mean": 352.33, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35233, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -56.092401454467165}, "policy_reward_max": {"agent_policy": 106.91168930273878, "adversary_policy": 36.938724105856416}, "policy_reward_mean": {"agent_policy": 13.758744084095317, "adversary_policy": -6.87937204204766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -4.440892098500626e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 4, 400, 143, 11, 316, 400, 400, 400, 400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [23.687470948887416, 22.323050943911973, 62.67738765991698, 1.1891502297065204, -31.202829749852697, -27.958510427563013, -3.722608362493352, -19.631539440653242, 3.0407325972192822, -29.279943937903752, 106.91168930273878, -10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353], "policy_adversary_policy_reward": [-13.556659048479535, -10.130811900407881, -11.768908032666133, -10.55414291124584, -31.995523632873216, -30.681864027043765, -1.1891502297065202, -3.3306690738754696e-16, 27.163708521038878, 4.039121228813837, 16.45595629126974, 11.502554136293274, 0.6347929842464985, 3.0878153782468534, 1.1684094538848004, 18.463129986768443, -4.093803327208796, 1.0530707299895212, 22.929695288335957, 6.350248649567877, -55.05026827435395, -51.86142102838491, -5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021554543676467, "mean_inference_ms": 1.0439980195684953, "mean_action_processing_ms": 0.17364448250274214, "mean_env_wait_ms": 0.06842589667723155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004172205924987793, "StateBufferConnector_ms": 0.0027512311935424805, "ViewRequirementAgentConnector_ms": 0.07411134243011475}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": -4.440892098500626e-16, "episode_return_mean": -5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.8039344851809, "num_env_steps_trained_throughput_per_sec": 511.8039344851809, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 8363.586, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8363.519, "sample_time_ms": 832.896, "learn_time_ms": 7517.3, "learn_throughput": 532.106, "synch_weights_time_ms": 12.233}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 45, "trial_id": "fa423_00000", "date": "2024-08-10_11-04-42", "timestamp": 1723302282, "time_this_iter_s": 7.8206610679626465, "time_total_s": 369.72091794013977, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 369.72091794013977, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 25.8, "ram_util_percent": 79.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.035708484037843, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.219255529888093, "policy_loss": -0.008978303478138827, "vf_loss": 5.226585493264375, "vf_explained_var": 0.010150870381208954, "kl": 0.017365153008057754, "entropy": 0.8759137977683354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8179049786180257, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.670700107514858, "policy_loss": -0.004333564563664064, "vf_loss": 6.674468563497067, "vf_explained_var": 0.21439757825185854, "kl": 0.004465121438030432, "entropy": 0.7514956636354327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 360.01, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36001, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -56.092401454467165}, "policy_reward_max": {"agent_policy": 97.68048472827314, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 14.749938646773078, "adversary_policy": -7.37496932338654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 49, 39, 400, 400, 400, 400, 123, 400, 400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400], "policy_agent_policy_reward": [-10.23111460601535, -32.33002030314708, -0.20640223849323824, -8.235433520608868, -16.70243139628751, 43.89025206756251, -30.453214938685825, -20.765030336503678, 9.232405098776647, 23.27148546798352, -4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357], "policy_adversary_policy_reward": [-5.675674528202308, 15.906789134217657, 14.622717152031967, 17.70730315111509, 19.937500672336814, -19.731098433843577, 13.980336579943003, -5.744903059334135, 2.8904075852579183, 13.812023811029583, -21.867076383210502, -22.02317568435197, 23.10473818041716, 7.348476758268664, 14.512380871007487, 6.252649465496187, -23.63869212081747, 14.406287022040827, -7.049072604339621, -16.2224128636439, -4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40240320894999193, "mean_inference_ms": 1.04503090902596, "mean_action_processing_ms": 0.1737677660716517, "mean_env_wait_ms": 0.06853211398590607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004218339920043945, "StateBufferConnector_ms": 0.0027637481689453125, "ViewRequirementAgentConnector_ms": 0.07480227947235107}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.8276348676295, "num_env_steps_trained_throughput_per_sec": 498.8276348676295, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 8370.986, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8370.919, "sample_time_ms": 831.546, "learn_time_ms": 7525.82, "learn_throughput": 531.504, "synch_weights_time_ms": 12.512}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 46, "trial_id": "fa423_00000", "date": "2024-08-10_11-04-50", "timestamp": 1723302290, "time_this_iter_s": 8.023752212524414, "time_total_s": 377.7446701526642, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a715a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 377.7446701526642, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 27.972727272727273, "ram_util_percent": 79.65454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0842450769174667, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8942966525516813, "policy_loss": -0.004591278980668417, "vf_loss": 3.8984555316349816, "vf_explained_var": 0.14466059097537287, "kl": 0.004555342321843153, "entropy": 0.8018977224826813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9757498328884444, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.689850826809804, "policy_loss": -0.0058784093824215235, "vf_loss": 5.694804324954748, "vf_explained_var": 0.24288732359806697, "kl": 0.014616022446889095, "entropy": 0.6318065141017238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.9, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36990, "policy_reward_min": {"agent_policy": -65.01251798195928, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 22.879618957484553, "adversary_policy": -11.43980947874228}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 36, 400, 400, 400, 400, 400, 400, 400, 121, 400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-4.046771323654653, 54.196003153745636, -13.846693592542806, 66.90226704345412, -32.166386521330715, 37.06967025389869, -6.562876038266441, -7.174539843425999, -65.01251798195928, 54.59561139784232, -4.377907322162412, -36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709], "policy_adversary_policy_reward": [-4.731742503296463, 8.778513826951116, -24.71777317960187, -29.47822997414377, -9.689197718817901, 23.535891311360707, -33.17514774891807, -33.72711929453606, 9.560456134747328, 22.6059303865834, -13.69721868410572, -23.372451569792958, 8.38281598050552, -1.8199399422390847, -6.034850535141121, 13.209390378567122, 32.9325872825184, 32.07993069944088, -25.62794417717879, -28.967667220663536, -14.226463637246347, 18.60437095940876, 22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40261216140497924, "mean_inference_ms": 1.045084620991779, "mean_action_processing_ms": 0.17375940408667798, "mean_env_wait_ms": 0.06856607023827224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003728508949279785, "StateBufferConnector_ms": 0.002686023712158203, "ViewRequirementAgentConnector_ms": 0.07164168357849121}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 515.4101883580792, "num_env_steps_trained_throughput_per_sec": 515.4101883580792, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 8261.105, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8261.039, "sample_time_ms": 830.013, "learn_time_ms": 7417.368, "learn_throughput": 539.275, "synch_weights_time_ms": 12.625}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "training_iteration": 47, "trial_id": "fa423_00000", "date": "2024-08-10_11-04-58", "timestamp": 1723302298, "time_this_iter_s": 7.766046047210693, "time_total_s": 385.5107161998749, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b20d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 385.5107161998749, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.263636363636365, "ram_util_percent": 79.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1886673885678487, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.213675511955584, "policy_loss": -0.0038293147427596584, "vf_loss": 4.217241490202606, "vf_explained_var": -0.022899814572914567, "kl": 0.0055485939908505155, "entropy": 0.7713897764998138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0025562930852177, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.465966447691122, "policy_loss": -0.007112895743436335, "vf_loss": 5.472273497283458, "vf_explained_var": 0.2903465044374267, "kl": 0.012734597909941973, "entropy": 0.7155736063296596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 376.33, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37633, "policy_reward_min": {"agent_policy": -64.18572220194696, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 26.256525416651854, "adversary_policy": -13.128262708325929}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 26, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-36.66263694885808, 76.51266869210717, 12.635170765425649, -7.730047134795036, -9.245167804700527, -15.366777479179092, 86.09424261973598, 82.42180730772355, -17.398730061081235, 86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462], "policy_adversary_policy_reward": [22.73217293132827, 13.930464017529793, -45.35588390669186, -31.156784785415333, -7.645222526298042, -4.989948239127607, 7.32711051257651, 0.402936622218526, 12.647131453350466, -3.401963648649941, 0.20719294937792654, 15.159584529801162, -48.03230213166593, -38.06194048807, -39.05971787886778, -43.362089428855874, 13.247948100243619, 4.150781960837612, -50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40238367560349725, "mean_inference_ms": 1.0446468209293085, "mean_action_processing_ms": 0.17371123888834528, "mean_env_wait_ms": 0.0685369335980703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037091970443725586, "StateBufferConnector_ms": 0.002667069435119629, "ViewRequirementAgentConnector_ms": 0.06909286975860596}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 531.4257284219209, "num_env_steps_trained_throughput_per_sec": 531.4257284219209, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 8113.772, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8113.707, "sample_time_ms": 797.311, "learn_time_ms": 7302.882, "learn_throughput": 547.729, "synch_weights_time_ms": 12.441}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 48, "trial_id": "fa423_00000", "date": "2024-08-10_11-05-05", "timestamp": 1723302305, "time_this_iter_s": 7.5323591232299805, "time_total_s": 393.04307532310486, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b23a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 393.04307532310486, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.063636363636363, "ram_util_percent": 79.28181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.336855690946024, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0964115933135705, "policy_loss": -0.0033329110940001788, "vf_loss": 3.0995566727623105, "vf_explained_var": 0.37679732899186474, "kl": 0.003957725767811564, "entropy": 0.7522843975554068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.135795428665976, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0743824404974776, "policy_loss": -0.0018748937911974887, "vf_loss": 5.0755740880966185, "vf_explained_var": 0.20557005672405163, "kl": 0.01079695664785069, "entropy": 0.660408380193015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 380.07, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38007, "policy_reward_min": {"agent_policy": -64.18572220194696, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 28.221411357872338, "adversary_policy": -14.110705678936174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [86.86645363658089, 3.20661963894732, 61.58984719374046, -14.87343060635475, -25.232539182604377, -28.883446969965128, -15.519372973667823, -12.456160802835065, 91.46396440690663, 96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351], "policy_adversary_policy_reward": [-50.813315921907865, -36.05313771467302, 3.4475225992196563, -6.654142238166974, -25.050513692356873, -36.53933350138359, 7.0041204363281615, 7.869310170026589, 9.18303072526394, 16.04950845734043, 26.86046658918768, 2.022980380777449, -0.823501900201796, 16.34287487386962, 0.7249474205336277, 11.731213382301434, -47.43418356432018, -44.02978084258646, -56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021539095193891, "mean_inference_ms": 1.0437523302355014, "mean_action_processing_ms": 0.1736066531934709, "mean_env_wait_ms": 0.06847234884278347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668665885925293, "StateBufferConnector_ms": 0.002660036087036133, "ViewRequirementAgentConnector_ms": 0.06890666484832764}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.638867123231, "num_env_steps_trained_throughput_per_sec": 494.638867123231, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 8067.538, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8067.472, "sample_time_ms": 785.466, "learn_time_ms": 7268.344, "learn_throughput": 550.332, "synch_weights_time_ms": 12.631}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "training_iteration": 49, "trial_id": "fa423_00000", "date": "2024-08-10_11-05-14", "timestamp": 1723302314, "time_this_iter_s": 8.092413902282715, "time_total_s": 401.1354892253876, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b2430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.1354892253876, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 27.933333333333334, "ram_util_percent": 79.31666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.463503720552202, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6815101957825758, "policy_loss": -0.004288420057362783, "vf_loss": 3.6856460489293257, "vf_explained_var": 0.0373550069710565, "kl": 0.006428944878864981, "entropy": 0.7826746310506548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.110259653038035, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.169821305076281, "policy_loss": -0.004880170033235724, "vf_loss": 5.173976334929466, "vf_explained_var": 0.21529419161379337, "kl": 0.011459085630065147, "entropy": 0.7441554938753446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.9, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38390, "policy_reward_min": {"agent_policy": -64.18572220194696, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 31.572156622656767, "adversary_policy": -15.786078311328383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [96.33959611698845, -9.648095029697036, 73.1632699761725, 69.72048335566362, -42.50556572441809, 90.01777623403714, -12.667740463702806, 11.070656483509094, 63.4836450937375, -16.49302259087961, -11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445], "policy_adversary_policy_reward": [-56.092401454467165, -40.24719466252133, 29.32903633041201, -19.680941300714974, -30.258293072438924, -42.90497690373357, -48.265952236585434, -21.45453111907822, 16.251784217600864, 26.253781506817248, -45.0260275761938, -44.99174865784335, -4.310180409992171, 16.977920873694977, 4.544299167120167, -15.614955650629259, -27.752796086561897, -35.7308490071756, 36.938724105856416, -20.44570151497681, 15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4018869682588558, "mean_inference_ms": 1.0429012233685506, "mean_action_processing_ms": 0.17351860462989066, "mean_env_wait_ms": 0.068413709960853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035806894302368164, "StateBufferConnector_ms": 0.0026346445083618164, "ViewRequirementAgentConnector_ms": 0.06811046600341797}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.77319593141993, "num_env_steps_trained_throughput_per_sec": 509.77319593141993, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 7935.778, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7935.72, "sample_time_ms": 787.4, "learn_time_ms": 7135.774, "learn_throughput": 560.556, "synch_weights_time_ms": 11.99}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 50, "trial_id": "fa423_00000", "date": "2024-08-10_11-05-22", "timestamp": 1723302322, "time_this_iter_s": 7.852723121643066, "time_total_s": 408.98821234703064, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b25e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 408.98821234703064, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 25.236363636363635, "ram_util_percent": 79.39090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.472026389616507, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.382901556529696, "policy_loss": -0.005089489945700816, "vf_loss": 3.3877873376563743, "vf_explained_var": -0.03316356208589342, "kl": 0.0085841024894461, "entropy": 0.7388034210003243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3484401683633527, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.635493542999029, "policy_loss": -0.0036739787479746155, "vf_loss": 4.6382434740662575, "vf_explained_var": 0.14832786588619154, "kl": 0.014601883621852779, "entropy": 0.779901253245771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 387.17, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38717, "policy_reward_min": {"agent_policy": -64.18572220194696, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 32.1795913597825, "adversary_policy": -16.089795679891246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [25, 400, 400, 400, 400, 400, 400, 400, 245, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-11.027294100010923, -7.265023923263534, -25.520019199802697, -17.650214684270942, 22.15213874482737, 52.25748313771083, 64.80690301197288, -21.06284777139601, -11.191562856786959, 54.87014080458177, 61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191], "policy_adversary_policy_reward": [15.295118989245402, -4.2678248892344826, -2.2006350307415374, 9.465658954005072, 17.37584174915638, 8.14417745064631, 5.227242267979854, 12.422972416291099, 0.5832489830457366, -22.735387727873107, -25.823311269700007, -26.434171868010807, -28.6204357843417, -36.18646722763119, 14.079592157007571, 6.983255614388437, -7.462466248000467, 18.65402910478743, -36.722860008433635, -18.147280796148138, -31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015583056289912, "mean_inference_ms": 1.0418315160348066, "mean_action_processing_ms": 0.17337368524539734, "mean_env_wait_ms": 0.06833622596315618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035120248794555664, "StateBufferConnector_ms": 0.0026509761810302734, "ViewRequirementAgentConnector_ms": 0.06847357749938965}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.0690401972935, "num_env_steps_trained_throughput_per_sec": 525.0690401972935, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 7895.202, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7895.145, "sample_time_ms": 777.347, "learn_time_ms": 7105.083, "learn_throughput": 562.977, "synch_weights_time_ms": 12.16}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "training_iteration": 51, "trial_id": "fa423_00000", "date": "2024-08-10_11-05-29", "timestamp": 1723302329, "time_this_iter_s": 7.623470783233643, "time_total_s": 416.6116831302643, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 416.6116831302643, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 23.39090909090909, "ram_util_percent": 79.42727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6494781027710625, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6176547560111554, "policy_loss": -0.003482102325540923, "vf_loss": 3.6209705379274157, "vf_explained_var": -0.07121142281426324, "kl": 0.007008305392102467, "entropy": 0.8456486273694921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1680644787847996, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.047462263951699, "policy_loss": -0.004888831859473915, "vf_loss": 5.051505618542433, "vf_explained_var": 0.08811697978526353, "kl": 0.013360498501905483, "entropy": 0.7705748331422607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.47, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39247, "policy_reward_min": {"agent_policy": -64.18572220194696, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 33.08689966047873, "adversary_policy": -16.543449830239364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [61.08666951209565, 53.55154997345179, -3.466636030413273, 39.9010263146944, -7.151234452194304, -19.65617644753056, -24.57683355437781, 15.62956325858707, 2.984040194702283, -22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958], "policy_adversary_policy_reward": [-31.952510936049173, -29.134158576046488, -39.40020454753476, -14.151345425917018, -5.227302564794275, 8.693938595207548, -22.977271382905954, -16.923754931788444, -1.8819141640624988, 9.033148616256799, 5.803902947098928, 13.852273500431627, 9.639050643640001, 14.937782910737809, -6.521189798774792, -9.108373459812277, -5.328369206833145, 2.344329012130861, 13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4010521500402712, "mean_inference_ms": 1.0405562753894295, "mean_action_processing_ms": 0.1732410164864531, "mean_env_wait_ms": 0.0682331305081689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033502578735351562, "StateBufferConnector_ms": 0.002490520477294922, "ViewRequirementAgentConnector_ms": 0.06736338138580322}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 515.9804249198022, "num_env_steps_trained_throughput_per_sec": 515.9804249198022, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 7856.306, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7856.27, "sample_time_ms": 774.206, "learn_time_ms": 7070.138, "learn_throughput": 565.76, "synch_weights_time_ms": 11.408}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 52, "trial_id": "fa423_00000", "date": "2024-08-10_11-05-37", "timestamp": 1723302337, "time_this_iter_s": 7.756935119628906, "time_total_s": 424.3686182498932, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b2790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 424.3686182498932, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 25.600000000000005, "ram_util_percent": 79.55000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5256570154081577, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.023929455545214, "policy_loss": -0.005068335250000317, "vf_loss": 4.028851187922967, "vf_explained_var": -0.4092897870237865, "kl": 0.006177769209670256, "entropy": 0.8709895787100312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.445097356910507, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.805165509382884, "policy_loss": -0.0013992574245397312, "vf_loss": 4.806231621404489, "vf_explained_var": 0.1316096084813277, "kl": 0.005264474890346567, "entropy": 0.7437758951758345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.47, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39247, "policy_reward_min": {"agent_policy": -64.18572220194696, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 33.854734185925246, "adversary_policy": -16.927367092962623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 389, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-22.19008689667762, -12.416241052762345, -30.795472028753018, -12.809753241261921, -1.1252429087784523, 57.446070002431334, 66.90760067707185, -21.161791048456017, 3.879136504109015, 62.71183842387964, 43.701250220704544, 64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493], "policy_adversary_policy_reward": [13.958913507647257, 8.231173389030364, 10.894384940439956, 1.5218561123223893, 15.942242077348958, 14.85322995140406, -2.5442998465703894, 15.354053087832312, -6.88671325971594, 8.011956168494391, -23.34701448733662, -34.09905551509471, -36.00689907097896, -30.900701606092838, 21.099058124228392, 0.06273292422762466, 2.676655174607399, -6.555791678716393, -28.290568906095956, -34.421269517783685, -18.726973240245982, -24.974276980458562, -45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40066403612121726, "mean_inference_ms": 1.0395115932433705, "mean_action_processing_ms": 0.1730873695003921, "mean_env_wait_ms": 0.06814515604345288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033446550369262695, "StateBufferConnector_ms": 0.0027238130569458008, "ViewRequirementAgentConnector_ms": 0.06852436065673828}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.2576544108851, "num_env_steps_trained_throughput_per_sec": 501.2576544108851, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 7843.125, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7843.092, "sample_time_ms": 775.57, "learn_time_ms": 7055.634, "learn_throughput": 566.923, "synch_weights_time_ms": 11.373}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "training_iteration": 53, "trial_id": "fa423_00000", "date": "2024-08-10_11-05-45", "timestamp": 1723302345, "time_this_iter_s": 7.9852800369262695, "time_total_s": 432.35389828681946, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b2a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.35389828681946, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.618181818181814, "ram_util_percent": 80.54545454545453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.098627056299694, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.350956743356412, "policy_loss": -0.001494759266392855, "vf_loss": 3.3522741595273295, "vf_explained_var": -0.23243076700382131, "kl": 0.00747307786202329, "entropy": 0.7607273858691018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.625314643420279, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.444851512710254, "policy_loss": -0.0022546539910157054, "vf_loss": 4.446937707563241, "vf_explained_var": 0.2209318675721685, "kl": 0.002662143369453081, "entropy": 0.70314350767682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 396.42, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39642, "policy_reward_min": {"agent_policy": -64.18572220194696, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 43.72008060740974}, "policy_reward_mean": {"agent_policy": 33.910168475638756, "adversary_policy": -16.955084237819378}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [64.93559696722627, 67.70911362833071, -3.359055439195661, -1.8689563322722584, 78.0747649627416, 6.871646178444035, -20.541030474716223, -34.30844171564488, 6.87675640121892, 73.68116161668353, -64.18572220194696, 63.58347703697683, 50.56247752996819, -38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104], "policy_adversary_policy_reward": [-45.45402622213515, -19.481570745091126, -34.34801142085826, -33.36110220747245, -6.360876508072209, 9.71993194726787, 0.04971906307309837, 1.8192372691991245, -35.21013970494699, -42.86462525779454, 1.1912916425334146, -8.06293782097745, 6.820383997670319, 13.720646477045904, 14.65818766398046, 19.650254051664415, 0.386172937315564, -7.262929338534484, -44.74572699107679, -28.93543462560674, 20.465641594537217, 43.72008060740974, -27.14900147227104, -36.43447556470581, -33.860191120564664, -16.702286409403527, 20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001792242474258, "mean_inference_ms": 1.0381408296055128, "mean_action_processing_ms": 0.17287093124187414, "mean_env_wait_ms": 0.0680312897642321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033082962036132812, "StateBufferConnector_ms": 0.0027303695678710938, "ViewRequirementAgentConnector_ms": 0.06880795955657959}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.2079187912265, "num_env_steps_trained_throughput_per_sec": 536.2079187912265, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 7786.543, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7786.511, "sample_time_ms": 775.581, "learn_time_ms": 6998.791, "learn_throughput": 571.527, "synch_weights_time_ms": 11.626}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 54, "trial_id": "fa423_00000", "date": "2024-08-10_11-05-53", "timestamp": 1723302353, "time_this_iter_s": 7.464465856552124, "time_total_s": 439.8183641433716, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b2c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 439.8183641433716, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.85454545454546, "ram_util_percent": 80.20909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.469585519429868, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.011356971377418, "policy_loss": -0.003675243303564096, "vf_loss": 4.0148752590966605, "vf_explained_var": 0.054137373222875845, "kl": 0.006613820081053755, "entropy": 0.7094734249922333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.275825072452426, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.332044338186582, "policy_loss": -0.002350700806709938, "vf_loss": 5.333998325963815, "vf_explained_var": 0.20917756333947182, "kl": 0.012537873603503632, "entropy": 0.6258474334453543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 388.82, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38882, "policy_reward_min": {"agent_policy": -58.14178980170709, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 40.38469200231425}, "policy_reward_mean": {"agent_policy": 33.50543236377054, "adversary_policy": -16.752716181885273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 42, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400], "policy_agent_policy_reward": [-38.37813057229323, 70.68128450723535, 42.75688597949404, 97.68048472827314, 37.778531111478394, -19.70812079922848, -13.670272171611995, -19.947389116654357, 79.43573882507798, 93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745], "policy_adversary_policy_reward": [20.234291513972533, 18.143839058320715, -42.79713711767093, -27.88414738956441, -19.740395117057894, -23.016490862436143, -55.42037037803225, -42.2601143502409, -28.58729621587106, -9.191234895607348, 4.079773783131632, 15.62834701609685, 23.735374813456495, -10.0651026418445, 6.638757730474069, 13.308631386180291, -24.609069919319225, -54.82666890575873, -52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997939264772869, "mean_inference_ms": 1.0365751081391799, "mean_action_processing_ms": 0.17265139260788254, "mean_env_wait_ms": 0.0679373814135481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031664371490478516, "StateBufferConnector_ms": 0.0027229785919189453, "ViewRequirementAgentConnector_ms": 0.06885743141174316}, "num_episodes": 13, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.9382187312757, "num_env_steps_trained_throughput_per_sec": 534.9382187312757, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 7752.743, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7752.711, "sample_time_ms": 771.023, "learn_time_ms": 6969.611, "learn_throughput": 573.92, "synch_weights_time_ms": 11.565}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 55, "trial_id": "fa423_00000", "date": "2024-08-10_11-06-01", "timestamp": 1723302361, "time_this_iter_s": 7.483002185821533, "time_total_s": 447.3013663291931, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 447.3013663291931, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 23.927272727272726, "ram_util_percent": 80.0909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6419117959718856, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3897293394835537, "policy_loss": -0.002775779710688367, "vf_loss": 3.3923401011361016, "vf_explained_var": 0.3126936254993318, "kl": 0.0069539685180296604, "entropy": 0.8349709568831025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.047276628700396, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.58489361256361, "policy_loss": -0.007719901248977598, "vf_loss": 4.592283219595751, "vf_explained_var": 0.26023688993106286, "kl": 0.010438241868806241, "entropy": 0.6587825593849023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 392.4, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39240, "policy_reward_min": {"agent_policy": -58.14178980170709, "adversary_policy": -59.494034428699464}, "policy_reward_max": {"agent_policy": 116.07380008240811, "adversary_policy": 40.38469200231425}, "policy_reward_mean": {"agent_policy": 34.867344675312026, "adversary_policy": -17.433672337656017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [93.51651157335016, 94.87569956237886, 96.14582706652646, 90.5184727870693, 66.47597584555366, 98.92331991139702, 116.07380008240811, 92.61497051367454, -58.14178980170709, 50.09756921016959, 83.03626676072004, 30.56188717958203, -17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027], "policy_adversary_policy_reward": [-52.67940776597656, -40.83710380737354, -47.851334605214944, -47.02436495716389, -49.73635764713229, -46.40946941939423, -40.23375476428643, -50.28471802278286, -56.75595353091311, -9.720022314640545, -47.506822301167304, -51.41649761022975, -56.579765653708705, -59.494034428699464, -45.708001593558464, -46.90696892011601, 17.757097799392827, 40.38469200231425, -22.42294179834986, -27.674627411819728, -54.51092685943233, -28.525339901287758, -6.588597260662503, -23.973289918919527, 21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39932359976877935, "mean_inference_ms": 1.0358807485776511, "mean_action_processing_ms": 0.1725138787407632, "mean_env_wait_ms": 0.06784709147298247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031276941299438477, "StateBufferConnector_ms": 0.0026862621307373047, "ViewRequirementAgentConnector_ms": 0.06847310066223145}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.19314862022304, "num_env_steps_trained_throughput_per_sec": 497.19314862022304, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 7755.38, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7755.347, "sample_time_ms": 770.692, "learn_time_ms": 6972.467, "learn_throughput": 573.685, "synch_weights_time_ms": 11.669}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 56, "trial_id": "fa423_00000", "date": "2024-08-10_11-06-09", "timestamp": 1723302369, "time_this_iter_s": 8.051461696624756, "time_total_s": 455.35282802581787, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 455.35282802581787, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.754545454545454, "ram_util_percent": 79.74545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.117690349208615, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9085198790938764, "policy_loss": -0.0036147901981763504, "vf_loss": 2.9120065630428376, "vf_explained_var": -0.010969155364566378, "kl": 0.005398255453474756, "entropy": 0.8433403744584038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3038488822057843, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.575000091890494, "policy_loss": -0.0032920880788879004, "vf_loss": 4.577758020659288, "vf_explained_var": 0.24279686361551284, "kl": 0.01688200596338259, "entropy": 0.5794881925607721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 392.4, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 39240, "policy_reward_min": {"agent_policy": -57.532114106117554, "adversary_policy": -55.893889350569566}, "policy_reward_max": {"agent_policy": 105.43674280429462, "adversary_policy": 35.49865490960078}, "policy_reward_mean": {"agent_policy": 31.14773940524724, "adversary_policy": -15.57386970262362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-17.069070062437184, -45.95197088957762, 75.47540196935483, 92.69044604993138, 29.36961552758667, 50.636575843994976, -37.016959251291254, 105.43674280429462, 98.40689303030926, -12.53883547685456, 78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963], "policy_adversary_policy_reward": [21.821558673513373, -4.752488611076187, 22.942784262896623, 23.009186626681025, -37.32369997116741, -38.151701998187406, -48.330208747783864, -44.36023730214749, -16.7689504430234, -12.600665084563271, -20.447473879496535, -30.18910196449844, 3.972524235870516, 33.044435015420724, -53.78501102358738, -51.65173178070733, -50.537608452066294, -47.86928457824295, 7.790379566270543, 4.748455910584019, -53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39973679854016453, "mean_inference_ms": 1.0364277751907567, "mean_action_processing_ms": 0.17254419922540243, "mean_env_wait_ms": 0.06792624204377704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033932924270629883, "StateBufferConnector_ms": 0.002836942672729492, "ViewRequirementAgentConnector_ms": 0.0830378532409668}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.2318272156458, "num_env_steps_trained_throughput_per_sec": 438.2318272156458, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 7892.058, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7892.022, "sample_time_ms": 833.17, "learn_time_ms": 7046.055, "learn_throughput": 567.694, "synch_weights_time_ms": 12.263}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "training_iteration": 57, "trial_id": "fa423_00000", "date": "2024-08-10_11-06-18", "timestamp": 1723302378, "time_this_iter_s": 9.134002923965454, "time_total_s": 464.4868309497833, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72b2ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 464.4868309497833, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 46.21428571428571, "ram_util_percent": 82.95000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3062953489798086, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0838553479739597, "policy_loss": -0.010267714772215754, "vf_loss": 3.093842096051211, "vf_explained_var": -0.11814267266364324, "kl": 0.011839688894079263, "entropy": 0.8198441492817389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.879193304354946, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.783336158593496, "policy_loss": -0.004156383300626961, "vf_loss": 4.787289622922739, "vf_explained_var": 0.27449086885899304, "kl": 0.0064131861714254446, "entropy": 0.527193144025902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 388.46, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38846, "policy_reward_min": {"agent_policy": -57.532114106117554, "adversary_policy": -55.893889350569566}, "policy_reward_max": {"agent_policy": 102.46642107143191, "adversary_policy": 35.49865490960078}, "policy_reward_mean": {"agent_policy": 30.379263899557987, "adversary_policy": -15.189631949778994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400], "policy_agent_policy_reward": [78.87317524926476, 97.38220532973754, 77.22065778285689, -46.740907599394895, 37.90141102916708, -36.514756322009205, 73.759281055351, -33.15898638233177, 67.53009433474278, 86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124], "policy_adversary_policy_reward": [-53.45248341352767, -25.42069183573708, -43.51220835877525, -53.86999697096221, -26.803875578361108, -50.41678220449576, 33.79452099024522, 12.946386609149673, -9.727682606094326, -28.173728423072752, 10.285068075414323, 26.229688246594876, -53.194678741940535, -20.564602313410433, 8.516973025786237, 24.642013356545522, -27.605225284432443, -39.92486905031035, -41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3999779242236619, "mean_inference_ms": 1.037214053035405, "mean_action_processing_ms": 0.17263046120767747, "mean_env_wait_ms": 0.06795747611620158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003346085548400879, "StateBufferConnector_ms": 0.0029042959213256836, "ViewRequirementAgentConnector_ms": 0.08331549167633057}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.3415216451168, "num_env_steps_trained_throughput_per_sec": 496.3415216451168, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 7945.264, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7945.225, "sample_time_ms": 842.451, "learn_time_ms": 7089.376, "learn_throughput": 564.225, "synch_weights_time_ms": 12.9}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 58, "trial_id": "fa423_00000", "date": "2024-08-10_11-06-26", "timestamp": 1723302386, "time_this_iter_s": 8.066243171691895, "time_total_s": 472.5530741214752, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 472.5530741214752, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.37272727272727, "ram_util_percent": 83.26363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2856709666037687, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1125608437906496, "policy_loss": -0.004717285155501, "vf_loss": 3.1171280347480974, "vf_explained_var": -0.88520307616582, "kl": 0.006325069236162958, "entropy": 0.7315183485311175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.638002942626675, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.18335887392362, "policy_loss": -0.014859774423530325, "vf_loss": 4.196207950015863, "vf_explained_var": 0.20251990438749393, "kl": 0.06354794956062823, "entropy": 0.5823098678762714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 388.46, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38846, "policy_reward_min": {"agent_policy": -57.532114106117554, "adversary_policy": -55.893889350569566}, "policy_reward_max": {"agent_policy": 102.46642107143191, "adversary_policy": 35.49865490960078}, "policy_reward_mean": {"agent_policy": 29.848674093322103, "adversary_policy": -14.924337046661048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [86.74260493089614, 88.11136007141732, 92.14913300333444, 51.584115235918084, 90.41914927012436, -13.457349593561595, 51.316339948650445, 74.28934712907272, -57.532114106117554, 75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597], "policy_adversary_policy_reward": [-41.12787423673297, -45.61473069416311, -32.21747072084771, -55.893889350569566, -52.319175206415395, -39.82995779691902, -27.335621676354478, -24.248493559563606, -38.721626432034775, -51.697522838089604, 6.796204764064889, 6.661144829496706, -33.21969713276837, -18.096642815882078, -28.522745130663168, -45.766601998409556, 32.03471762613939, 25.49739647997813, -29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40080961129166964, "mean_inference_ms": 1.0396617683294112, "mean_action_processing_ms": 0.1729757395621997, "mean_env_wait_ms": 0.06812391376929278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035778284072875977, "StateBufferConnector_ms": 0.003018975257873535, "ViewRequirementAgentConnector_ms": 0.08692491054534912}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.57870393724517, "num_env_steps_trained_throughput_per_sec": 431.57870393724517, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 8063.424, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8063.382, "sample_time_ms": 923.984, "learn_time_ms": 7126.182, "learn_throughput": 561.31, "synch_weights_time_ms": 12.652}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "training_iteration": 59, "trial_id": "fa423_00000", "date": "2024-08-10_11-06-36", "timestamp": 1723302396, "time_this_iter_s": 9.27527379989624, "time_total_s": 481.82834792137146, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 481.82834792137146, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 39.728571428571435, "ram_util_percent": 83.40714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4792751671145203, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.645511272723082, "policy_loss": -0.0039060285441804106, "vf_loss": 3.6492098452552915, "vf_explained_var": -0.1629753551155171, "kl": 0.00874251915865943, "entropy": 0.8175216361013039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.049939075112343, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.446146588524183, "policy_loss": -0.00464028334536124, "vf_loss": 4.450355886419614, "vf_explained_var": 0.3758283151313663, "kl": 0.009080866612262236, "entropy": 0.6631705759093165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 388.46, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38846, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -54.32068151038653}, "policy_reward_max": {"agent_policy": 102.46642107143191, "adversary_policy": 37.57547324298271}, "policy_reward_mean": {"agent_policy": 27.032137294711898, "adversary_policy": -13.516068647355945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [75.97722455126228, 77.16025825019102, -14.762834166471231, 47.059883739292886, -52.93454310885936, 58.094622708825696, 73.40621109535567, 102.46642107143191, 51.1820392496209, -29.15189822866928, -43.26066497222965, -16.71684621317776, 33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873], "policy_adversary_policy_reward": [-29.35011053291049, -46.62711401835172, -37.53827781801401, -39.621980432177004, 1.219317533757664, 13.543516632713573, -28.910599662695898, -18.14928407659699, 19.658977044916494, 33.27556606394284, -44.614104661923605, -13.480518046902084, -39.13340441170196, -34.27280668365372, -48.14573956104545, -54.32068151038653, -6.846318483491203, -44.3357207661297, 18.41757189534492, 10.73432633332436, 20.5085619885801, 22.752102983649547, 10.816996257911871, 5.899849955265889, -12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4016449804840987, "mean_inference_ms": 1.042144929697928, "mean_action_processing_ms": 0.17332413412455847, "mean_env_wait_ms": 0.06829539752197983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035799741744995117, "StateBufferConnector_ms": 0.0029946565628051758, "ViewRequirementAgentConnector_ms": 0.08622145652770996}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.9092021706006, "num_env_steps_trained_throughput_per_sec": 513.9092021706006, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 8057.109, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8057.064, "sample_time_ms": 924.531, "learn_time_ms": 7119.223, "learn_throughput": 561.859, "synch_weights_time_ms": 12.742}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 60, "trial_id": "fa423_00000", "date": "2024-08-10_11-06-44", "timestamp": 1723302404, "time_this_iter_s": 7.788690805435181, "time_total_s": 489.61703872680664, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 489.61703872680664, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 26.890909090909098, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3270597161123994, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2004806499632577, "policy_loss": -0.006689639548431076, "vf_loss": 3.2068772303364264, "vf_explained_var": -0.37261273179735455, "kl": 0.012349347113397914, "entropy": 0.7570176938854197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3547253046184777, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.900573006023963, "policy_loss": -0.0070811617900593165, "vf_loss": 3.9068964565793673, "vf_explained_var": 0.17028281670063733, "kl": 0.01596452811342486, "entropy": 0.7079407238091032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 385.6, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38560, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -52.437830613932626}, "policy_reward_max": {"agent_policy": 95.9454015476318, "adversary_policy": 37.57547324298271}, "policy_reward_mean": {"agent_policy": 25.947202644938493, "adversary_policy": -12.973601322469252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [33.611025364462726, 63.23386525634092, 72.27718149829373, 35.74134822819408, 33.478598663944396, -9.2941156135958, -3.081074444182084, -48.84162447017478, 50.28638385948227, -6.814014533489683, 79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233], "policy_adversary_policy_reward": [-12.773583853311116, -20.83744151115161, -14.449831556352919, -48.784033699988, -48.4198985801566, -23.857282918137138, -19.857024202218227, -15.88432402597585, -19.055431884228334, -14.423166779716063, 8.440582426760507, 0.8535331868352998, 6.03839963045764, -2.9573251862755505, 23.801198046187455, 25.040426423987306, -31.14379412824226, -19.142589731240008, 15.837308659875724, -9.023294126386041, -40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.402785519867199, "mean_inference_ms": 1.0455615631673603, "mean_action_processing_ms": 0.17382554820981416, "mean_env_wait_ms": 0.06853171216715635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035859346389770508, "StateBufferConnector_ms": 0.0029802322387695312, "ViewRequirementAgentConnector_ms": 0.08581900596618652}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.58059575127743, "num_env_steps_trained_throughput_per_sec": 495.58059575127743, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 8102.438, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8102.394, "sample_time_ms": 921.851, "learn_time_ms": 7167.187, "learn_throughput": 558.099, "synch_weights_time_ms": 12.79}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "training_iteration": 61, "trial_id": "fa423_00000", "date": "2024-08-10_11-06-52", "timestamp": 1723302412, "time_this_iter_s": 8.076886177062988, "time_total_s": 497.69392490386963, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 497.69392490386963, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 29.10833333333333, "ram_util_percent": 83.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2656948755657864, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5161881697871697, "policy_loss": -0.003375306099877451, "vf_loss": 3.519385707063019, "vf_explained_var": -0.4615453467797981, "kl": 0.0074914370330178455, "entropy": 0.7030488126177006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.550499056900541, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9082076616585253, "policy_loss": -0.006729483404099786, "vf_loss": 3.914364309608936, "vf_explained_var": 0.2778137725467483, "kl": 0.01206974157267155, "entropy": 0.5673037437722087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 382.89, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38289, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -52.437830613932626}, "policy_reward_max": {"agent_policy": 95.9454015476318, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 24.68852932261786, "adversary_policy": -12.344264661308934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 129, 400, 400, 400, 400], "policy_agent_policy_reward": [79.47161677050688, 62.742902404653364, 78.1814611818057, -27.561567612543055, 10.701338157608493, -51.681958971751996, -49.30584402292614, 48.212192804007515, 70.41981564094169, 39.93516658430276, 77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233, 72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981], "policy_adversary_policy_reward": [-40.394986470897194, -39.07663029960974, -36.886742034245394, -25.856160370407952, -39.637895902250726, -38.543565279555004, 11.619034332250182, 15.94253328029287, 1.4939806344421704, -12.195318792050667, 35.49865490960078, 16.183304062151226, 20.55999708170522, 28.745846941220904, -16.240214521283015, -31.971978282724496, -47.56053781659352, -22.859277824348176, -22.673308182278785, -17.261858402023982, -31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384, -34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037437028509987, "mean_inference_ms": 1.0481800778214052, "mean_action_processing_ms": 0.17421342976763032, "mean_env_wait_ms": 0.06871195386346579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00372469425201416, "StateBufferConnector_ms": 0.002760648727416992, "ViewRequirementAgentConnector_ms": 0.08616650104522705}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.3000676793868, "num_env_steps_trained_throughput_per_sec": 514.3000676793868, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 8104.972, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8104.927, "sample_time_ms": 925.602, "learn_time_ms": 7166.022, "learn_throughput": 558.19, "synch_weights_time_ms": 12.79}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 62, "trial_id": "fa423_00000", "date": "2024-08-10_11-07-00", "timestamp": 1723302420, "time_this_iter_s": 7.783941984176636, "time_total_s": 505.47786688804626, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a721bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 505.47786688804626, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 25.69090909090909, "ram_util_percent": 83.08181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5707673579927475, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.099231823663863, "policy_loss": -0.0026295881030992383, "vf_loss": 4.101737639891407, "vf_explained_var": -0.14522713933672224, "kl": 0.005215691177932359, "entropy": 0.585973528011766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.438488819077611, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.408260932316383, "policy_loss": -0.004961524034782391, "vf_loss": 4.413049303740263, "vf_explained_var": 0.4064857730021079, "kl": 0.0036481271816146982, "entropy": 0.5692757411549488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 379.62, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37962, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 95.9454015476318, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 25.89393983777448, "adversary_policy": -12.94696991888724}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 129, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [77.63979746820749, -21.302865448899027, 23.160513352261813, -24.53310436288675, 60.52922754454158, -33.38220296494104, 50.260601106639186, 63.71180245250931, 73.2024912632321, -24.791054154329334, -23.537785332134213, 46.25932220886642, 95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233, 72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981, 50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966], "policy_adversary_policy_reward": [-31.115864258195117, -46.523933210012366, -2.826542808935444, 24.129408257834484, -10.464869604158654, -12.695643748103155, 10.61122040079954, 13.921883962087206, -30.523607000788747, -30.00562054375283, 18.81640505814363, 14.565797906797405, -23.343309811498766, -26.917291295140412, -29.232904359003136, -34.47889809350616, -31.38186786541724, -41.82062339781489, 12.92152889684739, 11.869525257481946, 2.768297424556737, 20.769487907577485, -28.34204516801475, -17.917277040851673, -52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384, -34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516, -24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4044483569617413, "mean_inference_ms": 1.0502464919629535, "mean_action_processing_ms": 0.1744781895436409, "mean_env_wait_ms": 0.06885681090876443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687143325805664, "StateBufferConnector_ms": 0.002722501754760742, "ViewRequirementAgentConnector_ms": 0.08400070667266846}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.4298857738256, "num_env_steps_trained_throughput_per_sec": 523.4298857738256, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 8071.169, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8071.124, "sample_time_ms": 891.671, "learn_time_ms": 7166.21, "learn_throughput": 558.175, "synch_weights_time_ms": 12.689}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "training_iteration": 63, "trial_id": "fa423_00000", "date": "2024-08-10_11-07-08", "timestamp": 1723302428, "time_this_iter_s": 7.6467039585113525, "time_total_s": 513.1245708465576, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 513.1245708465576, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 23.79090909090909, "ram_util_percent": 82.48181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0917957735440087, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7103372321557746, "policy_loss": -0.003082987211432761, "vf_loss": 2.7133279928454646, "vf_explained_var": 0.05586499199665413, "kl": 0.003886626541778746, "entropy": 0.6031470182396117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.231977812324961, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.962867391357819, "policy_loss": -0.003564367307020196, "vf_loss": 3.9661683790385722, "vf_explained_var": 0.06690009621282418, "kl": 0.011098531786156525, "entropy": 0.5455684259223441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.39, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38339, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 95.9454015476318, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 24.635714366985738, "adversary_policy": -12.317857183492865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 17, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 129, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [95.9454015476318, -44.69971355741016, -9.67875173631398, -39.19516432043003, -56.34473989257164, 68.29851276931541, 48.127254615987745, 56.09684368088079, 79.03491225129093, -18.451212694120695, -4.222931579107298, 73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233, 72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981, 50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966, 34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796], "policy_adversary_policy_reward": [-52.437830613932626, -43.50757093369915, 21.161083912036325, 23.538629645373824, 15.506958284832269, -5.828206548518288, 16.394581460454297, 22.800582859975737, 27.081515642820875, 29.263224249750763, -34.135139490264535, -34.1633732790509, -19.040855734376258, -29.086398881611487, -31.117798236687975, -24.979045444192813, -37.558504070537424, -41.47640818075346, 13.82337256441921, 4.627840129701482, -6.441775488151604, 10.664707067258906, -24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384, -34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516, -24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897, -9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4055337624344854, "mean_inference_ms": 1.0527565076999483, "mean_action_processing_ms": 0.17489587922133393, "mean_env_wait_ms": 0.06903990420996797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003639817237854004, "StateBufferConnector_ms": 0.0026891231536865234, "ViewRequirementAgentConnector_ms": 0.08236420154571533}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.2709686218931, "num_env_steps_trained_throughput_per_sec": 501.2709686218931, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 8123.161, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8123.116, "sample_time_ms": 903.085, "learn_time_ms": 7206.987, "learn_throughput": 555.017, "synch_weights_time_ms": 12.452}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 64, "trial_id": "fa423_00000", "date": "2024-08-10_11-07-16", "timestamp": 1723302436, "time_this_iter_s": 7.985166788101196, "time_total_s": 521.1097376346588, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 521.1097376346588, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 26.78333333333333, "ram_util_percent": 82.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3769503328219925, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.567191979367897, "policy_loss": -0.0013261915867034562, "vf_loss": 2.568478138484652, "vf_explained_var": 0.4103835898732382, "kl": 0.0033740678916501987, "entropy": 0.741322223282365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7768423813705643, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.23517141888539, "policy_loss": -0.003231606518966146, "vf_loss": 4.238278468201558, "vf_explained_var": 0.21026394752164682, "kl": 0.005248500748483398, "entropy": 0.5492707189793388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.93, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38393, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 93.6593669170503, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 25.02694771633039, "adversary_policy": -12.513473858165193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 129, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [73.2932211990477, 28.907016660877865, 88.12221350055978, 66.45014405864072, 3.5900365678504027, 27.82355047638997, 34.88233452836584, 19.029835453353154, 75.05454614336628, 51.71589374209921, 35.909859109024154, 66.2903954503565, -26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233, 72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981, 50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966, 34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517], "policy_adversary_policy_reward": [-24.62506440960449, -48.66815678944322, -10.404616966668364, -18.5023996942095, -41.64754065714904, -46.47467284341066, -31.829209309925474, -34.62093474871524, 0.20065204035182305, -3.790688608202231, -15.14889115378594, -12.674659322604029, -14.518267526118208, -20.36406700224763, -3.354130768306966, -15.675704685046188, -41.989150411384216, -33.06539573198212, -15.93673015306398, -35.779163589035235, -20.188748090130314, -15.721111018893843, -21.82743608118652, -44.462959369170015, 21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384, -34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516, -24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897, -9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40629166087549495, "mean_inference_ms": 1.0557534213755988, "mean_action_processing_ms": 0.17533020708057326, "mean_env_wait_ms": 0.0692345341368466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036760568618774414, "StateBufferConnector_ms": 0.002699613571166992, "ViewRequirementAgentConnector_ms": 0.08285212516784668}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.32291079901574, "num_env_steps_trained_throughput_per_sec": 488.32291079901574, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 8194.542, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8194.497, "sample_time_ms": 903.875, "learn_time_ms": 7277.625, "learn_throughput": 549.63, "synch_weights_time_ms": 12.408}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 65, "trial_id": "fa423_00000", "date": "2024-08-10_11-07-24", "timestamp": 1723302444, "time_this_iter_s": 8.19728398323059, "time_total_s": 529.3070216178894, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ab040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 529.3070216178894, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 28.690909090909088, "ram_util_percent": 82.84545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.193342145189406, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0353855925262287, "policy_loss": -0.004562918456621152, "vf_loss": 2.03990493609161, "vf_explained_var": 0.3870147917951856, "kl": 0.0073455463971168105, "entropy": 0.6828626585385156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7506941836948196, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4062618585924307, "policy_loss": -0.0021189838315573677, "vf_loss": 3.408230034758647, "vf_explained_var": 0.18982461138317983, "kl": 0.0063551210741580695, "entropy": 0.37254942155753573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 376.79, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37679, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 93.6593669170503, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 22.389619542888862, "adversary_policy": -11.194809771444431}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 129, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400], "policy_agent_policy_reward": [-26.968212374859924, 80.84082519125096, -17.33511653479302, 63.73011802123086, 71.76395447885963, 11.816226228890624, -26.205860583521662, 32.48771209598678, -9.15732729316094, 76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233, 72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981, 50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966, 34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814], "policy_adversary_policy_reward": [21.97771555671271, 4.990496818147214, -44.488955667808874, -36.35186952344202, 14.33575650432431, 2.999360030468697, -23.420477103457564, -40.309640917773265, -39.08952113382319, -32.67443334503647, -11.578999430422659, -0.23722679846796701, 25.734943403051226, 0.47091718047044395, -15.347620419813722, -17.140091676173057, 6.90124742559011, 2.256079867570829, -44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384, -34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516, -24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897, -9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40696746587380617, "mean_inference_ms": 1.057697093143053, "mean_action_processing_ms": 0.17565174896668873, "mean_env_wait_ms": 0.06937892818744895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035254955291748047, "StateBufferConnector_ms": 0.002625703811645508, "ViewRequirementAgentConnector_ms": 0.0809558629989624}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.4562847757194, "num_env_steps_trained_throughput_per_sec": 503.4562847757194, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 8184.533, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8184.488, "sample_time_ms": 905.17, "learn_time_ms": 7266.444, "learn_throughput": 550.476, "synch_weights_time_ms": 12.245}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 66, "trial_id": "fa423_00000", "date": "2024-08-10_11-07-32", "timestamp": 1723302452, "time_this_iter_s": 7.950639009475708, "time_total_s": 537.2576606273651, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ab4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 537.2576606273651, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 26.108333333333334, "ram_util_percent": 82.58333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.044550566162382, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6393330412566978, "policy_loss": -0.0024448387581046927, "vf_loss": 2.6417344805424805, "vf_explained_var": 0.47596417000054053, "kl": 0.007315935459857811, "entropy": 0.7421431010362333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8189313617224494, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.844417669127385, "policy_loss": -0.004379122584214201, "vf_loss": 4.848664428045352, "vf_explained_var": 0.17030708075811465, "kl": 0.0055774089627562175, "entropy": 0.24166547095713517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 376.48, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37648, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 93.6593669170503, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 23.339184216024606, "adversary_policy": -11.669592108012303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 129, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400], "policy_agent_policy_reward": [76.31581673951243, 48.77719912230562, 59.98739301485164, -4.6665749016503915, 47.9785287441856, 25.258175808986124, -5.750869139026491, 62.852381276355196, 65.050201111742, -33.397994770328125, 55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233, 72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981, 50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966, 34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177], "policy_adversary_policy_reward": [-44.031778301439424, -32.28403843807288, -32.29620090494942, -16.480998217356195, -13.422594462521083, -46.564798552330565, 6.849672255848318, -2.183097354197926, -24.834351354847616, -23.144177389337987, -8.457364469309795, -16.800811339676333, -2.8195528831644445, 8.570422022190936, -33.52743179736555, -29.32494947898966, -43.35451036319045, -21.695690748551534, 28.32156299936851, 5.076431770959605, -34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384, -34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516, -24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897, -9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40711757370897367, "mean_inference_ms": 1.0584790980369403, "mean_action_processing_ms": 0.17580805751345152, "mean_env_wait_ms": 0.06940253051175563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034279823303222656, "StateBufferConnector_ms": 0.002532362937927246, "ViewRequirementAgentConnector_ms": 0.06850886344909668}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.3140115533711, "num_env_steps_trained_throughput_per_sec": 505.3140115533711, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 8063.361, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8063.319, "sample_time_ms": 844.721, "learn_time_ms": 7206.326, "learn_throughput": 555.068, "synch_weights_time_ms": 11.66}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "training_iteration": 67, "trial_id": "fa423_00000", "date": "2024-08-10_11-07-40", "timestamp": 1723302460, "time_this_iter_s": 7.92031717300415, "time_total_s": 545.1779778003693, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72450d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 545.1779778003693, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 26.436363636363637, "ram_util_percent": 81.04545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2712165752415934, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3462068711008346, "policy_loss": -0.004652447246074203, "vf_loss": 2.3508040527818066, "vf_explained_var": 0.3507191436946707, "kl": 0.00931506391600061, "entropy": 0.82389556418651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.842181063691775, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4315152153372765, "policy_loss": -0.0025592431280529126, "vf_loss": 3.4339919549723468, "vf_explained_var": 0.28116675081352394, "kl": 0.0034768422734957633, "entropy": 0.36897023326406875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 380.42, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38042, "policy_reward_min": {"agent_policy": -64.2090351472583, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 93.6593669170503, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 24.138072504844413, "adversary_policy": -12.069036252422208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 129, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [55.96334859998404, 24.325985375714794, -8.087372901486331, 40.29808790917395, 61.93942639166597, -64.2090351472583, 29.120894959337633, 48.48496151922024, 55.06905405185522, 5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233, 72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981, 50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966, 34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448], "policy_adversary_policy_reward": [-34.833847297284564, -21.129501302699474, -15.0841793634496, -9.241806012265194, 1.2470817858374446, 6.840291115648887, -31.450615402416368, -8.847472506757583, -17.93980384141937, -43.99962255024664, 37.57547324298271, 26.633561904275577, -21.364709916063862, -7.756185043273767, -29.564788861558846, -18.920172657661396, -38.30604093559676, -16.763013116258456, 7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384, -34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516, -24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897, -9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40703288123934905, "mean_inference_ms": 1.0583563823870112, "mean_action_processing_ms": 0.1758390063770565, "mean_env_wait_ms": 0.06939915975463846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033245086669921875, "StateBufferConnector_ms": 0.002461671829223633, "ViewRequirementAgentConnector_ms": 0.06733417510986328}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 517.0986322814014, "num_env_steps_trained_throughput_per_sec": 517.0986322814014, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 8031.01, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8030.97, "sample_time_ms": 832.044, "learn_time_ms": 7187.161, "learn_throughput": 556.548, "synch_weights_time_ms": 11.124}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 68, "trial_id": "fa423_00000", "date": "2024-08-10_11-07-48", "timestamp": 1723302468, "time_this_iter_s": 7.7410969734191895, "time_total_s": 552.9190747737885, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ab550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 552.9190747737885, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.008333333333336, "ram_util_percent": 78.65833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.338474802933042, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1421745432747734, "policy_loss": -0.003305824358316838, "vf_loss": 3.1453982216340526, "vf_explained_var": -0.12633410395768585, "kl": 0.013848081539663614, "entropy": 0.8653268277645111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.109775012731552, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9787606671452522, "policy_loss": -0.0039831307964050214, "vf_loss": 3.982680589705706, "vf_explained_var": 0.10224854592233897, "kl": 0.005328650354251674, "entropy": 0.34804295978198446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 378.69, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37869, "policy_reward_min": {"agent_policy": -59.48222068508311, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 93.6593669170503, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 24.272060920878612, "adversary_policy": -12.136030460439308}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 114, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 129, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400], "policy_agent_policy_reward": [5.242112796742404, -39.04358900526911, 47.793783986122264, 67.60828158862489, 31.90244127933873, 61.88806501905686, 7.40985468904012, 62.51485014369164, 54.72716300869076, -32.11935573854002, 44.015423915890416, -5.185157904379241, -1.9414770368977514, 27.746195657253754, -16.380752073010402, 3.8876270075452517, 13.46397231089233, 72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981, 50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966, 34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573], "policy_adversary_policy_reward": [7.954031676262435, -13.19614447300484, 18.272695561138658, 20.77089344413044, -16.202928238578984, -31.590855747543273, -43.2416372220507, -24.366644366574185, -14.3623765943656, -17.54006468497313, -34.171222519539285, -27.716842499517583, -4.54432121418894, -2.86553347485118, -38.4565192985033, -24.0583308451883, -23.167697043205592, -31.559465965485163, 11.588361552313415, 20.53099418622663, -28.664248308850446, -15.35117560703997, -9.332893729230534, 14.518051633609776, 4.219884721110702, -2.278407684212951, -21.551984222881917, -6.194211434371837, -11.26579526282569, 27.646547335836093, -2.614666136984262, -1.2729608705609898, -9.879614687805592, -3.5843576230867384, -34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516, -24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897, -9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4066369479522568, "mean_inference_ms": 1.0572221848659096, "mean_action_processing_ms": 0.17569249339061432, "mean_env_wait_ms": 0.06931650393530812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003241896629333496, "StateBufferConnector_ms": 0.0023581981658935547, "ViewRequirementAgentConnector_ms": 0.06459689140319824}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.47145244376674, "num_env_steps_trained_throughput_per_sec": 511.47145244376674, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 7886.236, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7886.201, "sample_time_ms": 753.248, "learn_time_ms": 7121.174, "learn_throughput": 561.705, "synch_weights_time_ms": 11.201}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "training_iteration": 69, "trial_id": "fa423_00000", "date": "2024-08-10_11-07-56", "timestamp": 1723302476, "time_this_iter_s": 7.825857877731323, "time_total_s": 560.7449326515198, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ab790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 560.7449326515198, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 24.145454545454548, "ram_util_percent": 78.77272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.320643799677097, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9838206610351645, "policy_loss": -0.003117793923115762, "vf_loss": 2.986885116592286, "vf_explained_var": 0.26113134471196975, "kl": 0.008991002991632423, "entropy": 0.9160940617165237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.382077706915637, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.273219223568836, "policy_loss": -0.0013595372569398024, "vf_loss": 4.274535543223222, "vf_explained_var": -0.029243163764476776, "kl": 0.0036427318765550015, "entropy": 0.3777289410742621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 363.37, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 36337, "policy_reward_min": {"agent_policy": -59.48222068508311, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 93.6593669170503, "adversary_policy": 37.69483671439801}, "policy_reward_mean": {"agent_policy": 22.52196168434712, "adversary_policy": -11.260980842173563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 129, 400, 400, 400, 400, 400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400, 400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2], "policy_agent_policy_reward": [72.55624069864315, 56.41405337984402, -59.48222068508311, 17.860550211627732, 16.08088527593087, 22.54769488814724, -15.187650271309186, 12.0415869811773, -12.278371967845805, -15.82252693391981, 50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966, 34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573, 57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122], "policy_adversary_policy_reward": [-34.28526922528898, -38.27097147335416, -37.789481610034855, -18.624571769809165, 37.69483671439801, 21.787383970685102, -12.920208410403077, -4.940341801224655, -15.583951916380684, -0.4969333595501939, 16.749959753937887, -39.297654642085114, 1.544426564963235, 13.64322370634597, 6.989778379837613, -19.031365361014913, -5.955137066379866, 18.23350903422567, -9.55347695282535, 25.37600388674516, -24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897, -9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762, -20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4059596149288916, "mean_inference_ms": 1.0552477675624885, "mean_action_processing_ms": 0.17540661820739456, "mean_env_wait_ms": 0.06916467846575051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003378748893737793, "StateBufferConnector_ms": 0.002370476722717285, "ViewRequirementAgentConnector_ms": 0.0644221305847168}, "num_episodes": 17, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.1479595967528, "num_env_steps_trained_throughput_per_sec": 505.1479595967528, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 7899.735, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7899.703, "sample_time_ms": 748.289, "learn_time_ms": 7139.579, "learn_throughput": 560.257, "synch_weights_time_ms": 11.221}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 70, "trial_id": "fa423_00000", "date": "2024-08-10_11-08-04", "timestamp": 1723302484, "time_this_iter_s": 7.923965215682983, "time_total_s": 568.6688978672028, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72abb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 568.6688978672028, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.654545454545453, "ram_util_percent": 78.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8694112098090865, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1569473531826464, "policy_loss": -0.00803157725364029, "vf_loss": 2.164881002839911, "vf_explained_var": 0.3553137873846387, "kl": 0.0165072541757065, "entropy": 0.9599492074635925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8129834751288096, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.071320482591788, "policy_loss": -0.005096162581079019, "vf_loss": 3.0763901473333437, "vf_explained_var": 0.21379635563741128, "kl": 0.004466090013643479, "entropy": 0.3752084258633355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 366.08, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36608, "policy_reward_min": {"agent_policy": -54.57333875123102, "adversary_policy": -53.926771502172166}, "policy_reward_max": {"agent_policy": 93.6593669170503, "adversary_policy": 32.00681938607894}, "policy_reward_mean": {"agent_policy": 25.311338312394085, "adversary_policy": -12.655669156197046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 73, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400, 400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [50.358859504375275, 16.961714492913462, 93.6593669170503, 81.11542518665735, 63.094806713170875, 34.470744940745355, -23.717167317361596, 66.00138739617249, -49.39050021181702, 49.10153683035966, 34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573, 57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198], "policy_adversary_policy_reward": [-24.63684831257939, -25.722011191795882, 17.031745764762807, -33.99346025767627, -53.926771502172166, -39.73259541487812, -34.68783950628067, -46.42758568037671, -26.716755388746357, -36.37805132442454, -23.619583321147534, -10.851161619597821, 2.941576165631796, 20.7755911517298, -26.160738056657557, -39.84064933951495, 23.586175062588097, 25.804325149228948, -22.75210680820072, -26.34943002215897, -9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762, -20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40552864061850974, "mean_inference_ms": 1.053919238548433, "mean_action_processing_ms": 0.17523278975885112, "mean_env_wait_ms": 0.06906690694244882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032541751861572266, "StateBufferConnector_ms": 0.0023398399353027344, "ViewRequirementAgentConnector_ms": 0.0628277063369751}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.9806660253141, "num_env_steps_trained_throughput_per_sec": 521.9806660253141, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 7858.913, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7858.88, "sample_time_ms": 746.077, "learn_time_ms": 7101.322, "learn_throughput": 563.275, "synch_weights_time_ms": 10.864}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "training_iteration": 71, "trial_id": "fa423_00000", "date": "2024-08-10_11-08-12", "timestamp": 1723302492, "time_this_iter_s": 7.668063163757324, "time_total_s": 576.3369610309601, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72abdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 576.3369610309601, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 26.3, "ram_util_percent": 78.37272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.848322363221456, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4038008182767836, "policy_loss": -0.0016547572498441373, "vf_loss": 2.405416748637245, "vf_explained_var": 0.07477063044669136, "kl": 0.0065439571536119595, "entropy": 0.9999877299581256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5377748103191453, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.346062731246153, "policy_loss": -0.0033676244910263147, "vf_loss": 4.3493835362295306, "vf_explained_var": 0.20486811542262634, "kl": 0.01578383915297944, "entropy": 0.518635100654016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.35, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36935, "policy_reward_min": {"agent_policy": -54.57333875123102, "adversary_policy": -47.24995149374405}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 32.00681938607894}, "policy_reward_mean": {"agent_policy": 24.766685477106297, "adversary_policy": -12.383342738553152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400, 400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [34.13599627142283, 1.8795600019062206, 4.396520652148867, 13.521479988519658, -6.383865436265541, 18.404037876084384, 23.062895116237513, 78.28432317979441, 23.64271807103583, -28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573, 57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808], "policy_adversary_policy_reward": [-9.57129633581389, -24.564699935608964, -13.6513998866697, 11.77183988476348, 7.84468749535014, -12.241208147499009, -35.52465611894105, 22.003176130421387, -7.936978091622997, 14.320843527888538, -40.82798930421661, 22.423951428132217, -21.904681345080533, -1.15821377115698, -35.72257338715395, -42.561749792640526, -12.11959397328011, -11.52312409775572, 18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762, -20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40513191330596504, "mean_inference_ms": 1.0523404704051271, "mean_action_processing_ms": 0.17505685322357048, "mean_env_wait_ms": 0.06895775738902152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032575130462646484, "StateBufferConnector_ms": 0.002350330352783203, "ViewRequirementAgentConnector_ms": 0.06318187713623047}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.28749847303595, "num_env_steps_trained_throughput_per_sec": 498.28749847303595, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 7883.906, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7883.874, "sample_time_ms": 743.242, "learn_time_ms": 7129.124, "learn_throughput": 561.079, "synch_weights_time_ms": 10.893}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 72, "trial_id": "fa423_00000", "date": "2024-08-10_11-08-20", "timestamp": 1723302500, "time_this_iter_s": 8.033296823501587, "time_total_s": 584.3702578544617, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a728df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 584.3702578544617, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 26.666666666666668, "ram_util_percent": 78.33333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.55560991950136, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7856307732995855, "policy_loss": -0.008948268068008244, "vf_loss": 2.7944751267079955, "vf_explained_var": 0.4155404366513409, "kl": 0.017516109792275053, "entropy": 1.006667479856935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3519123980154593, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.647487246493498, "policy_loss": -0.001455521781463176, "vf_loss": 4.648918893436591, "vf_explained_var": 0.30023093335330486, "kl": 0.008050758435760383, "entropy": 0.5381792965655525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 369.35, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36935, "policy_reward_min": {"agent_policy": -54.57333875123102, "adversary_policy": -47.24995149374405}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 32.00681938607894}, "policy_reward_mean": {"agent_policy": 26.180129877349415, "adversary_policy": -13.09006493867471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 71, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400, 400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-28.76429758261356, -54.57333875123102, 33.788166667153796, 44.16280247337225, 57.25170538521279, 50.08673980451454, -1.2379389338302929, 57.52214269874029, -17.454203853023248, -18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573, 57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772], "policy_adversary_policy_reward": [18.50803354052462, 10.256264042088919, 28.09436175071685, 26.478977000514206, -27.67075444174704, -6.11741222540676, -11.047332403750245, -33.115470069621985, -42.967465560365675, -14.284239824847113, -20.608754386883163, -29.47798541763138, 2.0470429240325494, -0.8091039902022565, -24.95170660390123, -32.57043609483907, 10.460676486047802, 6.9935273669754485, 15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762, -20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40484230866015897, "mean_inference_ms": 1.0511027067181304, "mean_action_processing_ms": 0.17479737425044384, "mean_env_wait_ms": 0.06891649094424752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032804012298583984, "StateBufferConnector_ms": 0.002368927001953125, "ViewRequirementAgentConnector_ms": 0.06375265121459961}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.3629611959456, "num_env_steps_trained_throughput_per_sec": 493.3629611959456, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 7930.478, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7930.446, "sample_time_ms": 743.089, "learn_time_ms": 7175.543, "learn_throughput": 557.449, "synch_weights_time_ms": 11.238}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "training_iteration": 73, "trial_id": "fa423_00000", "date": "2024-08-10_11-08-29", "timestamp": 1723302509, "time_this_iter_s": 8.113529920578003, "time_total_s": 592.4837877750397, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72abe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 592.4837877750397, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 26.900000000000002, "ram_util_percent": 78.04166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.778161549378955, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8493121107419332, "policy_loss": -0.005380758637545147, "vf_loss": 2.8546019503048488, "vf_explained_var": 0.1262898467835926, "kl": 0.015323761182402583, "entropy": 1.0010048015407784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2489296931773426, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.452480320135752, "policy_loss": -0.0034348285223434988, "vf_loss": 4.455880246559778, "vf_explained_var": 0.2561209050938487, "kl": 0.011765227609172162, "entropy": 0.5927301464602351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 372.64, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37264, "policy_reward_min": {"agent_policy": -32.162766968330544, "adversary_policy": -47.24995149374405}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 32.00681938607894}, "policy_reward_mean": {"agent_policy": 29.126568212014355, "adversary_policy": -14.563284106007174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400, 400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-18.620401257112356, 59.6355476369816, 8.524011199045216, -7.99118963691917, -17.845469497363517, 52.38032541949098, -3.8554004464767946, 26.1591793935138, 0.4889832815915316, 52.12049346564708, 25.796499102184512, 21.246280299142214, -21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573, 57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772, 47.95673712741712, -2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526], "policy_adversary_policy_reward": [15.899525040447415, 2.7208762166649407, -35.665831386483895, -23.9697162504977, 9.011326577598929, -17.53533777664415, -10.096399310522575, 18.087588947441752, 20.295831689583125, -2.450362192219618, -27.777331688053447, -24.602993731437532, -13.622943967890212, 17.478344414367005, -0.03740599162050984, -26.12177340189329, -3.9305599369422346, 3.44157665535071, -22.790478061096735, -29.330015404550338, -15.904831311951888, -9.891667790232624, -17.259184328328054, -3.98709597081416, 13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762, -20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402, -36.05324735549948, -11.903489771917641, -7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40442641346436586, "mean_inference_ms": 1.0496646003119865, "mean_action_processing_ms": 0.17465755719116718, "mean_env_wait_ms": 0.06878542137680332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032684803009033203, "StateBufferConnector_ms": 0.0026656389236450195, "ViewRequirementAgentConnector_ms": 0.06424438953399658}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.26224661222835, "num_env_steps_trained_throughput_per_sec": 502.26224661222835, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 7928.903, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7928.871, "sample_time_ms": 741.864, "learn_time_ms": 7175.048, "learn_throughput": 557.488, "synch_weights_time_ms": 11.417}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 74, "trial_id": "fa423_00000", "date": "2024-08-10_11-08-37", "timestamp": 1723302517, "time_this_iter_s": 7.969170808792114, "time_total_s": 600.4529585838318, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72990d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 600.4529585838318, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 26.96363636363636, "ram_util_percent": 77.91818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.884796879405067, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8955573122968117, "policy_loss": -0.003413997170953918, "vf_loss": 2.898893103334639, "vf_explained_var": -0.07464201267434176, "kl": 0.013183628669972176, "entropy": 1.0099560442740325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2365624910841384, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6420315504074097, "policy_loss": -0.0012268701791375255, "vf_loss": 3.643225971361001, "vf_explained_var": 0.21634948352972666, "kl": 0.010940150647546668, "entropy": 0.49023940761884055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 372.81, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37281, "policy_reward_min": {"agent_policy": -32.162766968330544, "adversary_policy": -47.24995149374405}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 32.00681938607894}, "policy_reward_mean": {"agent_policy": 30.185958770832777, "adversary_policy": -15.092979385416388}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [56, 400, 400, 400, 400, 400, 400, 400, 400, 400, 369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400, 400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-21.278298639764134, 52.478246776355036, 31.447116909077977, 36.493132178523524, 33.859671806493814, -3.0619131331504796, 14.59999267582982, 55.153633057994185, 37.06859951761506, 13.217630545687982, -12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573, 57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772, 47.95673712741712, -2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526, 51.19123729345991, 37.398631335127384, 9.017117977524627, 51.10639400802583, 73.12890050494389, -19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428], "policy_adversary_policy_reward": [13.997271153680831, 7.2810274860833, -32.03476572069738, -20.44348105565766, -22.352278123290272, -9.094838785787708, -16.316045998242835, -20.177086180280693, -40.35514308961813, 6.495471283124336, 18.72216205857882, -15.660248925428341, -24.825460901483424, 10.225468225653607, -20.570640577599388, -34.58299248039479, -21.42594104815117, -15.642658469463889, -22.25464638306275, 9.037015837374767, -15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762, -20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402, -36.05324735549948, -11.903489771917641, -7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018, -24.075692362039884, -27.11554493142003, -30.20751272391681, -7.19111861121057, -20.153217644791077, 11.13609966726645, -23.136843713340276, -27.969550294685554, -41.00639353253729, -32.12250697240664, 17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039428583050727, "mean_inference_ms": 1.0478270846830018, "mean_action_processing_ms": 0.17434905173108256, "mean_env_wait_ms": 0.0686984452878046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033560991287231445, "StateBufferConnector_ms": 0.002687215805053711, "ViewRequirementAgentConnector_ms": 0.06529462337493896}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.57360843497815, "num_env_steps_trained_throughput_per_sec": 493.57360843497815, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 7920.189, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7920.156, "sample_time_ms": 742.073, "learn_time_ms": 7166.232, "learn_throughput": 558.173, "synch_weights_time_ms": 11.306}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 75, "trial_id": "fa423_00000", "date": "2024-08-10_11-08-45", "timestamp": 1723302525, "time_this_iter_s": 8.109583854675293, "time_total_s": 608.5625424385071, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72994c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 608.5625424385071, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 28.258333333333336, "ram_util_percent": 78.38333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.206897333816246, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4106188358453218, "policy_loss": -0.003157281297229467, "vf_loss": 2.413714685894194, "vf_explained_var": -0.15997839336672787, "kl": 0.010354912153154396, "entropy": 0.9560543889091129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.561491311651965, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9980797310670217, "policy_loss": -0.005177715593890753, "vf_loss": 4.003218612323205, "vf_explained_var": 0.07581438565005859, "kl": 0.013087483460031517, "entropy": 0.4719164922212561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 376.25, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37625, "policy_reward_min": {"agent_policy": -32.162766968330544, "adversary_policy": -47.24995149374405}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 32.00681938607894}, "policy_reward_mean": {"agent_policy": 31.295857140543244, "adversary_policy": -15.64792857027162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [369, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400, 400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-12.93682580252281, 35.93834500064384, 60.95855594267786, 74.99076873868177, 51.26389947818146, 45.235944137536755, 68.11487672282041, 14.800988256917904, 44.70814010966289, 6.248785483255581, 66.5125581631208, 35.69019685327209, 21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573, 57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772, 47.95673712741712, -2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526, 51.19123729345991, 37.398631335127384, 9.017117977524627, 51.10639400802583, 73.12890050494389, -19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428, 49.668929524906986, -21.36107825917261, 13.045426492960864, 37.96987330292211, 40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129], "policy_adversary_policy_reward": [-15.973777373228778, 28.91060317575159, -2.94904756860997, -32.98929743203388, -26.0720839109609, -34.88647203171696, -35.19952724128188, -39.79124149739998, -24.306855903169037, -26.95704357501242, -12.479844971304642, -32.756099166232104, -33.85095990303446, -34.26391681978593, -8.906982038585959, -5.8940062183319455, -27.48061307290827, -17.227527036754623, 1.6148601146997237, -7.863645597955305, -20.468270621969413, -46.044287541151384, -22.580517627291993, -13.109679225980098, -0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762, -20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402, -36.05324735549948, -11.903489771917641, -7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018, -24.075692362039884, -27.11554493142003, -30.20751272391681, -7.19111861121057, -20.153217644791077, 11.13609966726645, -23.136843713340276, -27.969550294685554, -41.00639353253729, -32.12250697240664, 17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583, -8.88297945597347, -40.78595006893356, 15.299998884595734, 6.061079374576877, -8.77200547875146, -4.273421014209404, -11.24722287951397, -26.72265042340814, -17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40346083364096086, "mean_inference_ms": 1.0464340179336928, "mean_action_processing_ms": 0.17418485596452768, "mean_env_wait_ms": 0.0685653765788023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033119916915893555, "StateBufferConnector_ms": 0.0026655197143554688, "ViewRequirementAgentConnector_ms": 0.06532704830169678}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.09861860736265, "num_env_steps_trained_throughput_per_sec": 510.09861860736265, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 7909.843, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7909.811, "sample_time_ms": 740.991, "learn_time_ms": 7157.063, "learn_throughput": 558.889, "synch_weights_time_ms": 11.257}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 76, "trial_id": "fa423_00000", "date": "2024-08-10_11-08-53", "timestamp": 1723302533, "time_this_iter_s": 7.8463850021362305, "time_total_s": 616.4089274406433, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7299700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.4089274406433, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 25.61818181818182, "ram_util_percent": 78.62727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.902016330143762, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.858340020154519, "policy_loss": -0.003281556191440258, "vf_loss": 3.861553198193747, "vf_explained_var": 0.16597787094494654, "kl": 0.011525705292105018, "entropy": 0.9327685351724978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7964775579050185, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.462154942502578, "policy_loss": -0.0036681788020359817, "vf_loss": 4.465806520233552, "vf_explained_var": 0.311435471723477, "kl": 0.005598680667868668, "entropy": 0.424283605410407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": 0.0, "episode_reward_mean": 1.1102230246251566e-18, "episode_len_mean": 371.92, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37192, "policy_reward_min": {"agent_policy": -32.162766968330544, "adversary_policy": -47.24995149374405}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 43.63590407916471}, "policy_reward_mean": {"agent_policy": 28.002299295959528, "adversary_policy": -14.001149647979764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 227, 400, 400, 400, 400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 327, 400, 400], "policy_agent_policy_reward": [21.18369802213203, 68.53399866201448, 12.787026635809433, 70.67934532163349, 5.54696232206485, 49.76813079915762, 60.60707088487582, 7.980041219205095, 17.77256900036692, 51.066805189321705, -19.903759010807573, 57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772, 47.95673712741712, -2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526, 51.19123729345991, 37.398631335127384, 9.017117977524627, 51.10639400802583, 73.12890050494389, -19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428, 49.668929524906986, -21.36107825917261, 13.045426492960864, 37.96987330292211, 40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129, 18.356817115004816, 4.638448072385797, 9.708517582389554, 2.8981165931623387, -21.39485997165935, 19.86413674075475, -17.375873830338485, 45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004], "policy_adversary_policy_reward": [-0.5803806699339482, -20.603317352198083, -27.095219241267067, -41.43877942074745, 12.843135108465574, -25.630161744275007, -41.12236387980112, -29.55698144183237, 15.57005877281484, -21.11702109487969, -35.41343564229487, -14.354695156862746, -37.70798610604517, -22.899084778830655, 25.445982094936156, -33.426023314141254, -17.148020311309665, -0.62454868905726, -29.861381796684398, -21.205423392637307, -11.69534533614819, 31.599104346955762, -20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402, -36.05324735549948, -11.903489771917641, -7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018, -24.075692362039884, -27.11554493142003, -30.20751272391681, -7.19111861121057, -20.153217644791077, 11.13609966726645, -23.136843713340276, -27.969550294685554, -41.00639353253729, -32.12250697240664, 17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583, -8.88297945597347, -40.78595006893356, 15.299998884595734, 6.061079374576877, -8.77200547875146, -4.273421014209404, -11.24722287951397, -26.72265042340814, -17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714, -22.137195824528643, 3.780378709523827, 19.21615629475391, -23.854604367139707, -16.966801566976297, 7.258283984586743, -10.008377615592286, 7.110261022429946, 13.778763999256213, 7.616095972403137, -11.273782030840756, -8.590354709913985, 21.41517208118838, -4.039298250849903, -13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4029408179888311, "mean_inference_ms": 1.0449185015432656, "mean_action_processing_ms": 0.1739428127281385, "mean_env_wait_ms": 0.06844753601227051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032759904861450195, "StateBufferConnector_ms": 0.0026923418045043945, "ViewRequirementAgentConnector_ms": 0.06583499908447266}, "num_episodes": 12, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": 0.0, "episode_return_mean": 1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.4738468646358, "num_env_steps_trained_throughput_per_sec": 230.4738468646358, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 8853.811, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8853.778, "sample_time_ms": 740.387, "learn_time_ms": 8100.306, "learn_throughput": 493.808, "synch_weights_time_ms": 12.426}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "training_iteration": 77, "trial_id": "fa423_00000", "date": "2024-08-10_11-09-10", "timestamp": 1723302550, "time_this_iter_s": 17.423118829727173, "time_total_s": 633.8320462703705, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7299940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 633.8320462703705, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 71.05, "ram_util_percent": 82.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9450652923848892, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.619471982168773, "policy_loss": -0.00510254243657328, "vf_loss": 2.6244945365285117, "vf_explained_var": 0.2696280045484109, "kl": 0.013482775948927158, "entropy": 0.9178593941781886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4531559063121677, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.164430740475654, "policy_loss": -0.0013680881570811228, "vf_loss": 4.165788629154364, "vf_explained_var": 0.1530339600518346, "kl": 0.0034423382291269918, "entropy": 0.37865687627345324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": 0.0, "episode_reward_mean": 1.1102230246251566e-18, "episode_len_mean": 367.37, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36737, "policy_reward_min": {"agent_policy": -33.61618178233919, "adversary_policy": -47.24995149374405}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 43.63590407916471}, "policy_reward_mean": {"agent_policy": 25.94724746944893, "adversary_policy": -12.973623734724464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 190, 400, 400, 27, 400, 400, 400, 400, 268, 400, 400, 400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 327, 400, 400, 400, 400, 400, 84, 400, 88, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [57.65708793379737, 2.0929676066941116, -20.15010664474855, -9.078164461918291, -15.902690929645763, 82.85004752474408, 71.01165394456567, -11.943003113199572, 3.151800805274206, -7.225046982741736, -17.93598179820537, 14.874611649559526, -11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772, 47.95673712741712, -2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526, 51.19123729345991, 37.398631335127384, 9.017117977524627, 51.10639400802583, 73.12890050494389, -19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428, 49.668929524906986, -21.36107825917261, 13.045426492960864, 37.96987330292211, 40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129, 18.356817115004816, 4.638448072385797, 9.708517582389554, 2.8981165931623387, -21.39485997165935, 19.86413674075475, -17.375873830338485, 45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004, 39.4655308394967, 14.452734985492718, 7.452187845629698, 3.909109075206487, 15.211164312723145, -33.61618178233919, 11.66575543401941, 45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212], "policy_adversary_policy_reward": [-20.924400257520226, -36.732687676277145, -20.59854438680922, 18.505576780115106, 7.272409362823016, 12.877697281925553, 12.287694787021906, -3.2095303251036142, 6.384797606773592, 9.517893322872167, -47.24995149374405, -35.60009603099998, -37.561716790189934, -33.449937154375725, -13.032145006341594, 24.975148119541167, -24.5371312395601, 21.385330434285898, 24.58151222449071, -17.35646524174897, 26.78811618244339, -8.852134384238022, -3.0879468323525643, -11.786664817206962, 12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402, -36.05324735549948, -11.903489771917641, -7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018, -24.075692362039884, -27.11554493142003, -30.20751272391681, -7.19111861121057, -20.153217644791077, 11.13609966726645, -23.136843713340276, -27.969550294685554, -41.00639353253729, -32.12250697240664, 17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583, -8.88297945597347, -40.78595006893356, 15.299998884595734, 6.061079374576877, -8.77200547875146, -4.273421014209404, -11.24722287951397, -26.72265042340814, -17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714, -22.137195824528643, 3.780378709523827, 19.21615629475391, -23.854604367139707, -16.966801566976297, 7.258283984586743, -10.008377615592286, 7.110261022429946, 13.778763999256213, 7.616095972403137, -11.273782030840756, -8.590354709913985, 21.41517208118838, -4.039298250849903, -13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009, -14.461185348675652, -25.00434549082105, 1.074384882855071, -15.52711986834779, 0.2814040402774616, -7.73359188590716, 21.93897175776973, -25.848080832976216, -9.309068148269631, -5.902096164453511, 15.033364346622808, 18.582817435716382, -3.3856883027378117, -8.280067131281598, -27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4023790073786406, "mean_inference_ms": 1.044161421406899, "mean_action_processing_ms": 0.17385353484989394, "mean_env_wait_ms": 0.06834717814810073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003851771354675293, "StateBufferConnector_ms": 0.002724885940551758, "ViewRequirementAgentConnector_ms": 0.067291259765625}, "num_episodes": 11, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": 0.0, "episode_return_mean": 1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.0296975604011, "num_env_steps_trained_throughput_per_sec": 502.0296975604011, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 8877.03, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8876.996, "sample_time_ms": 751.312, "learn_time_ms": 8112.454, "learn_throughput": 493.069, "synch_weights_time_ms": 12.537}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 78, "trial_id": "fa423_00000", "date": "2024-08-10_11-09-19", "timestamp": 1723302559, "time_this_iter_s": 7.973796129226685, "time_total_s": 641.8058423995972, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72999d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 641.8058423995972, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 32.074999999999996, "ram_util_percent": 80.84166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2042958992183523, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6594219755243373, "policy_loss": -0.00638756907801267, "vf_loss": 3.6657194663607884, "vf_explained_var": -0.1297777376162312, "kl": 0.015182936934527618, "entropy": 0.925554035674958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.247646636205415, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.050345724076033, "policy_loss": -0.001742920348381934, "vf_loss": 5.052080991119146, "vf_explained_var": -0.0363346786548694, "kl": 0.005183109126042792, "entropy": 0.38378601958975195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 369.85, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36985, "policy_reward_min": {"agent_policy": -63.87265531878309, "adversary_policy": -44.842014123150214}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 43.63590407916471}, "policy_reward_mean": {"agent_policy": 25.868815767394704, "adversary_policy": -12.934407883697352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 54, 41, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 327, 400, 400, 400, 400, 400, 84, 400, 88, 400, 400, 400, 400, 400, 400, 400, 340, 400, 400, 400, 332, 400, 400, 400, 400, 61], "policy_agent_policy_reward": [-11.640044105158488, 26.999077260813436, 0.2377467428015887, -5.495952914008663, -0.9844865269795122, 68.71456569794316, 75.41177445630514, -11.552524918128718, 54.460750229606184, 18.261051567514883, 47.12968385186195, -2.279986688774563, 36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772, 47.95673712741712, -2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526, 51.19123729345991, 37.398631335127384, 9.017117977524627, 51.10639400802583, 73.12890050494389, -19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428, 49.668929524906986, -21.36107825917261, 13.045426492960864, 37.96987330292211, 40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129, 18.356817115004816, 4.638448072385797, 9.708517582389554, 2.8981165931623387, -21.39485997165935, 19.86413674075475, -17.375873830338485, 45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004, 39.4655308394967, 14.452734985492718, 7.452187845629698, 3.909109075206487, 15.211164312723145, -33.61618178233919, 11.66575543401941, 45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212, 62.54692826021479, 12.333562353536351, -63.87265531878309, 33.716866876408396, -21.075695371660288, 40.6725496305498, -14.463297792171897, 26.58075700263651, 47.18605196572492, -25.801922229999956, 34.27995966313726, 9.45690028916014], "policy_adversary_policy_reward": [12.467683397505333, -0.827639292346845, -16.826172651556295, -10.172904609257142, 14.681392979369358, -14.919139722170947, 32.00681938607894, -26.510866472070262, -2.052870831123222, 3.037357358102734, -33.19555985201942, -35.51900584592387, -39.205550057769045, -36.206224398536094, 2.325345553864768, 9.22717936426395, -15.60705122442485, -38.85369900518133, -15.633351015682315, -2.627700551832568, -11.432408513328284, -35.697275338533665, -2.9237016733955032, 5.203688362170066, -8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402, -36.05324735549948, -11.903489771917641, -7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018, -24.075692362039884, -27.11554493142003, -30.20751272391681, -7.19111861121057, -20.153217644791077, 11.13609966726645, -23.136843713340276, -27.969550294685554, -41.00639353253729, -32.12250697240664, 17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583, -8.88297945597347, -40.78595006893356, 15.299998884595734, 6.061079374576877, -8.77200547875146, -4.273421014209404, -11.24722287951397, -26.72265042340814, -17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714, -22.137195824528643, 3.780378709523827, 19.21615629475391, -23.854604367139707, -16.966801566976297, 7.258283984586743, -10.008377615592286, 7.110261022429946, 13.778763999256213, 7.616095972403137, -11.273782030840756, -8.590354709913985, 21.41517208118838, -4.039298250849903, -13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009, -14.461185348675652, -25.00434549082105, 1.074384882855071, -15.52711986834779, 0.2814040402774616, -7.73359188590716, 21.93897175776973, -25.848080832976216, -9.309068148269631, -5.902096164453511, 15.033364346622808, 18.582817435716382, -3.3856883027378117, -8.280067131281598, -27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927, -31.850737351818786, -30.696190908395984, -5.775653384671237, -6.557908968865114, 32.33875139315836, 31.533903925624713, -11.373104306565246, -22.343762569843147, 39.196234190900896, -18.120538819240625, -22.722360333698667, -17.95018929685114, -20.215947608340638, 34.67924540051253, -10.652522929542322, -15.928234073094188, -25.760722459424606, -21.42532950630031, -10.381341843940184, 36.183264073940144, -13.152591015481143, -21.127368647656077, -31.926037738956705, 22.46913744979656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024043381080525, "mean_inference_ms": 1.042623824540819, "mean_action_processing_ms": 0.17354989884915906, "mean_env_wait_ms": 0.06832686454779403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037401914596557617, "StateBufferConnector_ms": 0.0028009414672851562, "ViewRequirementAgentConnector_ms": 0.0667569637298584}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.499396190313, "num_env_steps_trained_throughput_per_sec": 511.499396190313, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 8876.988, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8876.954, "sample_time_ms": 748.041, "learn_time_ms": 8115.646, "learn_throughput": 492.875, "synch_weights_time_ms": 12.527}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "training_iteration": 79, "trial_id": "fa423_00000", "date": "2024-08-10_11-09-27", "timestamp": 1723302567, "time_this_iter_s": 7.827329158782959, "time_total_s": 649.6331715583801, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7299dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 649.6331715583801, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 26.40909090909091, "ram_util_percent": 80.77272727272725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2843256600634763, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.310987774909489, "policy_loss": -0.0058300629978822105, "vf_loss": 3.3167119418502486, "vf_explained_var": 0.023155089471706008, "kl": 0.017849771103842928, "entropy": 0.850918617450371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5794860125829775, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.10703278457125, "policy_loss": -0.0021413096770023306, "vf_loss": 4.109165572871764, "vf_explained_var": 0.13506476848075788, "kl": 0.005739429279605734, "entropy": 0.3673742221357922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 371.56, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37156, "policy_reward_min": {"agent_policy": -63.87265531878309, "adversary_policy": -44.842014123150214}, "policy_reward_max": {"agent_policy": 85.31456056019141, "adversary_policy": 43.63590407916471}, "policy_reward_mean": {"agent_policy": 24.602496711542944, "adversary_policy": -12.30124835577147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 327, 400, 400, 400, 400, 400, 84, 400, 88, 400, 400, 400, 400, 400, 400, 400, 340, 400, 400, 400, 332, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 17, 400, 204, 400, 47, 400], "policy_agent_policy_reward": [36.762429048831066, 54.819527852365134, 31.940633284384198, 4.262890616722334, 64.26158287444466, 15.850554629801046, 31.707343513286908, 85.31456056019141, 23.901352283420756, 21.52620041253723, 46.37135956090823, 9.215319602685952, 24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772, 47.95673712741712, -2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526, 51.19123729345991, 37.398631335127384, 9.017117977524627, 51.10639400802583, 73.12890050494389, -19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428, 49.668929524906986, -21.36107825917261, 13.045426492960864, 37.96987330292211, 40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129, 18.356817115004816, 4.638448072385797, 9.708517582389554, 2.8981165931623387, -21.39485997165935, 19.86413674075475, -17.375873830338485, 45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004, 39.4655308394967, 14.452734985492718, 7.452187845629698, 3.909109075206487, 15.211164312723145, -33.61618178233919, 11.66575543401941, 45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212, 62.54692826021479, 12.333562353536351, -63.87265531878309, 33.716866876408396, -21.075695371660288, 40.6725496305498, -14.463297792171897, 26.58075700263651, 47.18605196572492, -25.801922229999956, 34.27995966313726, 9.45690028916014, 32.603455762549544, 13.456746863391658, 20.820922131882185, 36.56627880440329, 6.393388021007702, -5.735123986105204, -1.5423396537904548, 13.645705454942302, -21.449581370428064, 8.541408237620303, -8.924958117009897, 38.253846920157], "policy_adversary_policy_reward": [-8.890236123889519, -27.872192924941544, -28.387834514718506, -26.43169333764663, -12.431097440594442, -19.50953584378975, -12.342635496122302, 8.079744879399946, -27.101528821106893, -37.1600540533377, -11.619859052110577, -4.230695577690469, -24.695016601078006, -7.012326912208912, -40.47254643704111, -44.842014123150214, -15.825611927830408, -8.075740355590348, -24.32537902792118, 2.7991786153839513, -38.707683169950954, -7.663676390957278, -6.212855378354902, -3.0024642243310495, -19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402, -36.05324735549948, -11.903489771917641, -7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018, -24.075692362039884, -27.11554493142003, -30.20751272391681, -7.19111861121057, -20.153217644791077, 11.13609966726645, -23.136843713340276, -27.969550294685554, -41.00639353253729, -32.12250697240664, 17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583, -8.88297945597347, -40.78595006893356, 15.299998884595734, 6.061079374576877, -8.77200547875146, -4.273421014209404, -11.24722287951397, -26.72265042340814, -17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714, -22.137195824528643, 3.780378709523827, 19.21615629475391, -23.854604367139707, -16.966801566976297, 7.258283984586743, -10.008377615592286, 7.110261022429946, 13.778763999256213, 7.616095972403137, -11.273782030840756, -8.590354709913985, 21.41517208118838, -4.039298250849903, -13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009, -14.461185348675652, -25.00434549082105, 1.074384882855071, -15.52711986834779, 0.2814040402774616, -7.73359188590716, 21.93897175776973, -25.848080832976216, -9.309068148269631, -5.902096164453511, 15.033364346622808, 18.582817435716382, -3.3856883027378117, -8.280067131281598, -27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927, -31.850737351818786, -30.696190908395984, -5.775653384671237, -6.557908968865114, 32.33875139315836, 31.533903925624713, -11.373104306565246, -22.343762569843147, 39.196234190900896, -18.120538819240625, -22.722360333698667, -17.95018929685114, -20.215947608340638, 34.67924540051253, -10.652522929542322, -15.928234073094188, -25.760722459424606, -21.42532950630031, -10.381341843940184, 36.183264073940144, -13.152591015481143, -21.127368647656077, -31.926037738956705, 22.46913744979656, -9.436658069030827, -23.16679769351872, -15.495518624745259, 2.038771761353601, -10.949460436235931, -9.871461695646254, -25.37268491776847, -11.193593886634815, 5.787186361855895, -12.180574382863597, -18.72828891802291, 24.46341290412812, 1.8914666685177277, -0.3491270147272729, -6.456623662503432, -7.18908179243887, -14.147557863089382, 35.597139233517446, 3.064275268498413, -11.605683506118716, -3.0811545340708477, 12.006112651080745, -15.345652641465279, -22.90819427869172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4018818792212053, "mean_inference_ms": 1.0417980194650471, "mean_action_processing_ms": 0.17346241002763418, "mean_env_wait_ms": 0.06824649895759373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003818988800048828, "StateBufferConnector_ms": 0.002859354019165039, "ViewRequirementAgentConnector_ms": 0.06833517551422119}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.35772660197256, "num_env_steps_trained_throughput_per_sec": 497.35772660197256, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 8889.39, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8889.357, "sample_time_ms": 756.944, "learn_time_ms": 8119.309, "learn_throughput": 492.653, "synch_weights_time_ms": 12.409}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 80, "trial_id": "fa423_00000", "date": "2024-08-10_11-09-35", "timestamp": 1723302575, "time_this_iter_s": 8.047044038772583, "time_total_s": 657.6802155971527, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7299e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 657.6802155971527, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 27.274999999999995, "ram_util_percent": 80.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1867749109154655, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4916690440404983, "policy_loss": -0.0025702068762035756, "vf_loss": 3.4941990162329697, "vf_explained_var": 0.021643591147881967, "kl": 0.0067825169517926436, "entropy": 0.7478213407375195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6267697668944794, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.734079199035962, "policy_loss": -0.0026745045640078993, "vf_loss": 4.7367489250997705, "vf_explained_var": -0.25920765375097593, "kl": 0.0032246945276393434, "entropy": 0.34431814023603996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 362.06, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36206, "policy_reward_min": {"agent_policy": -63.87265531878309, "adversary_policy": -43.64433169215471}, "policy_reward_max": {"agent_policy": 83.07840024523563, "adversary_policy": 45.142100449183644}, "policy_reward_mean": {"agent_policy": 20.298108694100105, "adversary_policy": -10.14905434705005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 327, 400, 400, 400, 400, 400, 84, 400, 88, 400, 400, 400, 400, 400, 400, 400, 340, 400, 400, 400, 332, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 17, 400, 204, 400, 47, 400, 400, 400, 281, 400, 400, 176, 400, 144, 58, 400, 400, 391], "policy_agent_policy_reward": [24.779726869488808, 39.751384375407284, 51.217091695425836, 60.90505389699656, 56.52983673468007, 17.499764557152204, 49.415288391940805, 25.78782113156625, -32.162766968330544, 63.34463193035772, 47.95673712741712, -2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526, 51.19123729345991, 37.398631335127384, 9.017117977524627, 51.10639400802583, 73.12890050494389, -19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428, 49.668929524906986, -21.36107825917261, 13.045426492960864, 37.96987330292211, 40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129, 18.356817115004816, 4.638448072385797, 9.708517582389554, 2.8981165931623387, -21.39485997165935, 19.86413674075475, -17.375873830338485, 45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004, 39.4655308394967, 14.452734985492718, 7.452187845629698, 3.909109075206487, 15.211164312723145, -33.61618178233919, 11.66575543401941, 45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212, 62.54692826021479, 12.333562353536351, -63.87265531878309, 33.716866876408396, -21.075695371660288, 40.6725496305498, -14.463297792171897, 26.58075700263651, 47.18605196572492, -25.801922229999956, 34.27995966313726, 9.45690028916014, 32.603455762549544, 13.456746863391658, 20.820922131882185, 36.56627880440329, 6.393388021007702, -5.735123986105204, -1.5423396537904548, 13.645705454942302, -21.449581370428064, 8.541408237620303, -8.924958117009897, 38.253846920157, 13.301498966996125, -11.232696252529387, -33.54180925075127, -12.328046745104405, 18.20362662974418, -49.18590643695178, 15.593080262727021, 8.89566683192168, 5.7861560889497845, 49.94010645705929, 23.618674271127347, -33.555398327893464], "policy_adversary_policy_reward": [-19.226258822905887, -5.553468046582921, -26.193030658533466, -13.558353716873807, -23.495719244287617, -27.72137245113823, -31.02343573518531, -29.881618161811254, -39.39593760320815, -17.13389913147192, -11.575822584340393, -5.923941972811811, -10.16703132036271, -39.24825707157809, -1.8060584013406142, -23.981762730225636, 21.191217267037086, 10.971549701293496, -35.52662173832032, -27.818010192037402, -36.05324735549948, -11.903489771917641, -7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018, -24.075692362039884, -27.11554493142003, -30.20751272391681, -7.19111861121057, -20.153217644791077, 11.13609966726645, -23.136843713340276, -27.969550294685554, -41.00639353253729, -32.12250697240664, 17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583, -8.88297945597347, -40.78595006893356, 15.299998884595734, 6.061079374576877, -8.77200547875146, -4.273421014209404, -11.24722287951397, -26.72265042340814, -17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714, -22.137195824528643, 3.780378709523827, 19.21615629475391, -23.854604367139707, -16.966801566976297, 7.258283984586743, -10.008377615592286, 7.110261022429946, 13.778763999256213, 7.616095972403137, -11.273782030840756, -8.590354709913985, 21.41517208118838, -4.039298250849903, -13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009, -14.461185348675652, -25.00434549082105, 1.074384882855071, -15.52711986834779, 0.2814040402774616, -7.73359188590716, 21.93897175776973, -25.848080832976216, -9.309068148269631, -5.902096164453511, 15.033364346622808, 18.582817435716382, -3.3856883027378117, -8.280067131281598, -27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927, -31.850737351818786, -30.696190908395984, -5.775653384671237, -6.557908968865114, 32.33875139315836, 31.533903925624713, -11.373104306565246, -22.343762569843147, 39.196234190900896, -18.120538819240625, -22.722360333698667, -17.95018929685114, -20.215947608340638, 34.67924540051253, -10.652522929542322, -15.928234073094188, -25.760722459424606, -21.42532950630031, -10.381341843940184, 36.183264073940144, -13.152591015481143, -21.127368647656077, -31.926037738956705, 22.46913744979656, -9.436658069030827, -23.16679769351872, -15.495518624745259, 2.038771761353601, -10.949460436235931, -9.871461695646254, -25.37268491776847, -11.193593886634815, 5.787186361855895, -12.180574382863597, -18.72828891802291, 24.46341290412812, 1.8914666685177277, -0.3491270147272729, -6.456623662503432, -7.18908179243887, -14.147557863089382, 35.597139233517446, 3.064275268498413, -11.605683506118716, -3.0811545340708477, 12.006112651080745, -15.345652641465279, -22.90819427869172, -35.479002802548514, 22.177503835552393, -10.319143080544567, 21.551839333073957, -7.2172962059411745, 40.75910545669244, 6.685722892793539, 5.6423238523108745, -27.209623177183424, 9.005996547439246, 22.107166738036504, 27.07873969891527, -12.443584744932966, -3.1494955177940547, 20.867129941913866, -29.762796773835547, 32.78888959856172, -38.5750456875115, -29.60032643976227, -20.339780017297016, -22.600056043981148, -1.0186182271461988, -11.586702121290173, 45.142100449183644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4016413077367274, "mean_inference_ms": 1.041201049369414, "mean_action_processing_ms": 0.17345651472863982, "mean_env_wait_ms": 0.06819182161673949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003908634185791016, "StateBufferConnector_ms": 0.0029366016387939453, "ViewRequirementAgentConnector_ms": 0.07179367542266846}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.97075457759604, "num_env_steps_trained_throughput_per_sec": 500.97075457759604, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 8921.528, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8921.495, "sample_time_ms": 772.363, "learn_time_ms": 8135.665, "learn_throughput": 491.662, "synch_weights_time_ms": 12.69}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "training_iteration": 81, "trial_id": "fa423_00000", "date": "2024-08-10_11-09-43", "timestamp": 1723302583, "time_this_iter_s": 7.990638017654419, "time_total_s": 665.6708536148071, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98a50d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 665.6708536148071, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 24.975000000000005, "ram_util_percent": 78.97499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2565675404652086, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.716120413371495, "policy_loss": -0.0037967417428575495, "vf_loss": 3.719874703442609, "vf_explained_var": 0.05429156747444597, "kl": 0.007155782880370532, "entropy": 0.7325319405901369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2145611592568457, "cur_kl_coeff": 0.0007415771484375002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.30867920294404, "policy_loss": -0.0018693436548346653, "vf_loss": 4.310542775690555, "vf_explained_var": 0.13622629083693027, "kl": 0.007803736551622856, "entropy": 0.3208029568505784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 356.51, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35651, "policy_reward_min": {"agent_policy": -63.87265531878309, "adversary_policy": -43.64433169215471}, "policy_reward_max": {"agent_policy": 83.07840024523563, "adversary_policy": 45.142100449183644}, "policy_reward_mean": {"agent_policy": 16.78714812850262, "adversary_policy": -8.39357406425131}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 327, 400, 400, 400, 400, 400, 84, 400, 88, 400, 400, 400, 400, 400, 400, 400, 340, 400, 400, 400, 332, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 17, 400, 204, 400, 47, 400, 400, 400, 281, 400, 400, 176, 400, 144, 58, 400, 400, 391, 400, 400, 400, 11, 400, 400, 400, 400, 234, 400, 400], "policy_agent_policy_reward": [-2.419867549515253, 49.628135002497906, 56.30470605629132, 54.71622086581181, 58.914503404604396, 63.683046949303694, 49.78345065599103, 56.858678862386526, 51.19123729345991, 37.398631335127384, 9.017117977524627, 51.10639400802583, 73.12890050494389, -19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428, 49.668929524906986, -21.36107825917261, 13.045426492960864, 37.96987330292211, 40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129, 18.356817115004816, 4.638448072385797, 9.708517582389554, 2.8981165931623387, -21.39485997165935, 19.86413674075475, -17.375873830338485, 45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004, 39.4655308394967, 14.452734985492718, 7.452187845629698, 3.909109075206487, 15.211164312723145, -33.61618178233919, 11.66575543401941, 45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212, 62.54692826021479, 12.333562353536351, -63.87265531878309, 33.716866876408396, -21.075695371660288, 40.6725496305498, -14.463297792171897, 26.58075700263651, 47.18605196572492, -25.801922229999956, 34.27995966313726, 9.45690028916014, 32.603455762549544, 13.456746863391658, 20.820922131882185, 36.56627880440329, 6.393388021007702, -5.735123986105204, -1.5423396537904548, 13.645705454942302, -21.449581370428064, 8.541408237620303, -8.924958117009897, 38.253846920157, 13.301498966996125, -11.232696252529387, -33.54180925075127, -12.328046745104405, 18.20362662974418, -49.18590643695178, 15.593080262727021, 8.89566683192168, 5.7861560889497845, 49.94010645705929, 23.618674271127347, -33.555398327893464, -25.232923159481224, 6.501060010040398, 21.096983379914278, -16.054651841128212, 10.032984131593379, 19.314580130302076, -43.97833576580004, 52.07159870264535, -12.622840125854921, -4.955965222562732, 47.75602294268518], "policy_adversary_policy_reward": [-7.530457473065724, 9.950325022580977, -9.097316447772755, -40.53081855472515, -33.875339514960714, -22.429366541330612, -28.55277561282385, -26.16344525298796, -38.44055051030986, -20.47395289429453, -36.965030030000676, -26.718016919303007, -33.104904051469816, -16.678546604521213, -13.66561603989635, -43.19306282249018, -24.075692362039884, -27.11554493142003, -30.20751272391681, -7.19111861121057, -20.153217644791077, 11.13609966726645, -23.136843713340276, -27.969550294685554, -41.00639353253729, -32.12250697240664, 17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583, -8.88297945597347, -40.78595006893356, 15.299998884595734, 6.061079374576877, -8.77200547875146, -4.273421014209404, -11.24722287951397, -26.72265042340814, -17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714, -22.137195824528643, 3.780378709523827, 19.21615629475391, -23.854604367139707, -16.966801566976297, 7.258283984586743, -10.008377615592286, 7.110261022429946, 13.778763999256213, 7.616095972403137, -11.273782030840756, -8.590354709913985, 21.41517208118838, -4.039298250849903, -13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009, -14.461185348675652, -25.00434549082105, 1.074384882855071, -15.52711986834779, 0.2814040402774616, -7.73359188590716, 21.93897175776973, -25.848080832976216, -9.309068148269631, -5.902096164453511, 15.033364346622808, 18.582817435716382, -3.3856883027378117, -8.280067131281598, -27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927, -31.850737351818786, -30.696190908395984, -5.775653384671237, -6.557908968865114, 32.33875139315836, 31.533903925624713, -11.373104306565246, -22.343762569843147, 39.196234190900896, -18.120538819240625, -22.722360333698667, -17.95018929685114, -20.215947608340638, 34.67924540051253, -10.652522929542322, -15.928234073094188, -25.760722459424606, -21.42532950630031, -10.381341843940184, 36.183264073940144, -13.152591015481143, -21.127368647656077, -31.926037738956705, 22.46913744979656, -9.436658069030827, -23.16679769351872, -15.495518624745259, 2.038771761353601, -10.949460436235931, -9.871461695646254, -25.37268491776847, -11.193593886634815, 5.787186361855895, -12.180574382863597, -18.72828891802291, 24.46341290412812, 1.8914666685177277, -0.3491270147272729, -6.456623662503432, -7.18908179243887, -14.147557863089382, 35.597139233517446, 3.064275268498413, -11.605683506118716, -3.0811545340708477, 12.006112651080745, -15.345652641465279, -22.90819427869172, -35.479002802548514, 22.177503835552393, -10.319143080544567, 21.551839333073957, -7.2172962059411745, 40.75910545669244, 6.685722892793539, 5.6423238523108745, -27.209623177183424, 9.005996547439246, 22.107166738036504, 27.07873969891527, -12.443584744932966, -3.1494955177940547, 20.867129941913866, -29.762796773835547, 32.78888959856172, -38.5750456875115, -29.60032643976227, -20.339780017297016, -22.600056043981148, -1.0186182271461988, -11.586702121290173, 45.142100449183644, -9.47102030306948, 34.703943462550704, -9.92542706950723, 3.4243670594668316, -10.371407601903684, -10.725575778010594, 8.537131594504437, 7.517520246623777, 5.894760192256458, -15.927744323849836, -13.46629327467764, -5.848286855624439, 18.26431009017584, 25.714025675624203, -35.73980489586657, -16.331793806778784, -21.58322502876651, 34.20606515462143, -20.476985648818708, 25.43295087138144, -27.761127587022408, -19.994895355662784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4014149614629471, "mean_inference_ms": 1.0404846977182438, "mean_action_processing_ms": 0.17335069155628433, "mean_env_wait_ms": 0.06814890411596691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003978252410888672, "StateBufferConnector_ms": 0.002954721450805664, "ViewRequirementAgentConnector_ms": 0.07247233390808105}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.3406953048918, "num_env_steps_trained_throughput_per_sec": 512.3406953048918, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 8899.51, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8899.476, "sample_time_ms": 774.859, "learn_time_ms": 8111.165, "learn_throughput": 493.147, "synch_weights_time_ms": 12.643}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 82, "trial_id": "fa423_00000", "date": "2024-08-10_11-09-51", "timestamp": 1723302591, "time_this_iter_s": 7.812195062637329, "time_total_s": 673.4830486774445, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72abf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 673.4830486774445, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 25.08181818181818, "ram_util_percent": 78.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8804113615442204, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.370971359336187, "policy_loss": -0.004086402302149624, "vf_loss": 2.374991219573551, "vf_explained_var": -0.13554784740720477, "kl": 0.011215226786151803, "entropy": 0.8512730873135662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7734406415683526, "cur_kl_coeff": 0.0007415771484375002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.389801741888126, "policy_loss": -0.0021094730644108496, "vf_loss": 3.3919084274520475, "vf_explained_var": 0.22212003966172536, "kl": 0.0037564273713858436, "entropy": 0.38759708385914565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 350.47, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 35047, "policy_reward_min": {"agent_policy": -63.87265531878309, "adversary_policy": -43.64433169215471}, "policy_reward_max": {"agent_policy": 83.07840024523563, "adversary_policy": 45.142100449183644}, "policy_reward_mean": {"agent_policy": 13.946928152050894, "adversary_policy": -6.97346407602545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 327, 400, 400, 400, 400, 400, 84, 400, 88, 400, 400, 400, 400, 400, 400, 400, 340, 400, 400, 400, 332, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 17, 400, 204, 400, 47, 400, 400, 400, 281, 400, 400, 176, 400, 144, 58, 400, 400, 391, 400, 400, 400, 11, 400, 400, 400, 400, 234, 400, 400, 400, 47, 162, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400], "policy_agent_policy_reward": [-19.035380583977688, 53.733143753631346, 50.16690928533134, -18.10147845635328, -2.30693264332227, -7.395483925537594, 25.07485629271428, 49.668929524906986, -21.36107825917261, 13.045426492960864, 37.96987330292211, 40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129, 18.356817115004816, 4.638448072385797, 9.708517582389554, 2.8981165931623387, -21.39485997165935, 19.86413674075475, -17.375873830338485, 45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004, 39.4655308394967, 14.452734985492718, 7.452187845629698, 3.909109075206487, 15.211164312723145, -33.61618178233919, 11.66575543401941, 45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212, 62.54692826021479, 12.333562353536351, -63.87265531878309, 33.716866876408396, -21.075695371660288, 40.6725496305498, -14.463297792171897, 26.58075700263651, 47.18605196572492, -25.801922229999956, 34.27995966313726, 9.45690028916014, 32.603455762549544, 13.456746863391658, 20.820922131882185, 36.56627880440329, 6.393388021007702, -5.735123986105204, -1.5423396537904548, 13.645705454942302, -21.449581370428064, 8.541408237620303, -8.924958117009897, 38.253846920157, 13.301498966996125, -11.232696252529387, -33.54180925075127, -12.328046745104405, 18.20362662974418, -49.18590643695178, 15.593080262727021, 8.89566683192168, 5.7861560889497845, 49.94010645705929, 23.618674271127347, -33.555398327893464, -25.232923159481224, 6.501060010040398, 21.096983379914278, -16.054651841128212, 10.032984131593379, 19.314580130302076, -43.97833576580004, 52.07159870264535, -12.622840125854921, -4.955965222562732, 47.75602294268518, 62.56857634517894, 18.117462327743624, -10.694403067353413, 56.89588948593754, 71.2591226319374, 47.44939983816737, -26.97892464068583, 23.622711504963668, 43.50738245552775, 1.576311009710098, -17.15810221736063, -6.417339034955354, 61.54107108246978], "policy_adversary_policy_reward": [17.28434419156349, 1.7510363924141963, -32.92885623118432, -20.80428752244703, -22.73886728627493, -27.428041999056408, 13.447628913369773, 4.653849542983508, 15.124774921622556, -12.817842278300287, 2.233374726224149, 5.162109199313445, -14.922447158181697, -10.152409134532583, -8.88297945597347, -40.78595006893356, 15.299998884595734, 6.061079374576877, -8.77200547875146, -4.273421014209404, -11.24722287951397, -26.72265042340814, -17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714, -22.137195824528643, 3.780378709523827, 19.21615629475391, -23.854604367139707, -16.966801566976297, 7.258283984586743, -10.008377615592286, 7.110261022429946, 13.778763999256213, 7.616095972403137, -11.273782030840756, -8.590354709913985, 21.41517208118838, -4.039298250849903, -13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009, -14.461185348675652, -25.00434549082105, 1.074384882855071, -15.52711986834779, 0.2814040402774616, -7.73359188590716, 21.93897175776973, -25.848080832976216, -9.309068148269631, -5.902096164453511, 15.033364346622808, 18.582817435716382, -3.3856883027378117, -8.280067131281598, -27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927, -31.850737351818786, -30.696190908395984, -5.775653384671237, -6.557908968865114, 32.33875139315836, 31.533903925624713, -11.373104306565246, -22.343762569843147, 39.196234190900896, -18.120538819240625, -22.722360333698667, -17.95018929685114, -20.215947608340638, 34.67924540051253, -10.652522929542322, -15.928234073094188, -25.760722459424606, -21.42532950630031, -10.381341843940184, 36.183264073940144, -13.152591015481143, -21.127368647656077, -31.926037738956705, 22.46913744979656, -9.436658069030827, -23.16679769351872, -15.495518624745259, 2.038771761353601, -10.949460436235931, -9.871461695646254, -25.37268491776847, -11.193593886634815, 5.787186361855895, -12.180574382863597, -18.72828891802291, 24.46341290412812, 1.8914666685177277, -0.3491270147272729, -6.456623662503432, -7.18908179243887, -14.147557863089382, 35.597139233517446, 3.064275268498413, -11.605683506118716, -3.0811545340708477, 12.006112651080745, -15.345652641465279, -22.90819427869172, -35.479002802548514, 22.177503835552393, -10.319143080544567, 21.551839333073957, -7.2172962059411745, 40.75910545669244, 6.685722892793539, 5.6423238523108745, -27.209623177183424, 9.005996547439246, 22.107166738036504, 27.07873969891527, -12.443584744932966, -3.1494955177940547, 20.867129941913866, -29.762796773835547, 32.78888959856172, -38.5750456875115, -29.60032643976227, -20.339780017297016, -22.600056043981148, -1.0186182271461988, -11.586702121290173, 45.142100449183644, -9.47102030306948, 34.703943462550704, -9.92542706950723, 3.4243670594668316, -10.371407601903684, -10.725575778010594, 8.537131594504437, 7.517520246623777, 5.894760192256458, -15.927744323849836, -13.46629327467764, -5.848286855624439, 18.26431009017584, 25.714025675624203, -35.73980489586657, -16.331793806778784, -21.58322502876651, 34.20606515462143, -20.476985648818708, 25.43295087138144, -27.761127587022408, -19.994895355662784, -21.164780872082684, -41.40379547309626, -25.395095000712853, 7.277632672969226, 32.276518195756054, -21.582115128402638, -24.43677897015342, -32.45911051578412, -37.950240188212746, -33.3088824437247, -19.895426735598694, -27.553973102568676, 15.912573492016303, 11.066351148669526, -13.974988025383993, -9.647723479579675, -10.996602878405037, -32.51077957712279, -10.475955733315377, 8.899644723605281, 3.283174952400909, 13.874927264959721, 12.05576560366638, -5.638426568711026, -31.101418344794922, -30.439652737674862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4013870789099886, "mean_inference_ms": 1.0402416859560473, "mean_action_processing_ms": 0.1732363207902004, "mean_env_wait_ms": 0.06812259622712086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038837194442749023, "StateBufferConnector_ms": 0.002646327018737793, "ViewRequirementAgentConnector_ms": 0.07072031497955322}, "num_episodes": 13, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.143754269134, "num_env_steps_trained_throughput_per_sec": 510.143754269134, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 8872.84, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8872.806, "sample_time_ms": 780.646, "learn_time_ms": 8078.865, "learn_throughput": 495.119, "synch_weights_time_ms": 12.473}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "training_iteration": 83, "trial_id": "fa423_00000", "date": "2024-08-10_11-09-59", "timestamp": 1723302599, "time_this_iter_s": 7.8479578495025635, "time_total_s": 681.331006526947, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98a54c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 681.331006526947, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 25.472727272727276, "ram_util_percent": 78.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.93245623310407, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4309057400340124, "policy_loss": -0.003953259111327863, "vf_loss": 2.434766626799548, "vf_explained_var": 0.26286554699221615, "kl": 0.015569967183774973, "entropy": 0.7321005828166134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6914878275245426, "cur_kl_coeff": 0.0003707885742187501, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3626332310338816, "policy_loss": -0.0017558369785547257, "vf_loss": 3.3643871476252873, "vf_explained_var": -0.24421584717929362, "kl": 0.005195095072974354, "entropy": 0.31773861687009536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 344.06, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34406, "policy_reward_min": {"agent_policy": -63.87265531878309, "adversary_policy": -47.449287565255695}, "policy_reward_max": {"agent_policy": 83.07840024523563, "adversary_policy": 45.142100449183644}, "policy_reward_mean": {"agent_policy": 13.979990834255519, "adversary_policy": -6.98999541712776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 327, 400, 400, 400, 400, 400, 84, 400, 88, 400, 400, 400, 400, 400, 400, 400, 340, 400, 400, 400, 332, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 17, 400, 204, 400, 47, 400, 400, 400, 281, 400, 400, 176, 400, 144, 58, 400, 400, 391, 400, 400, 400, 11, 400, 400, 400, 400, 234, 400, 400, 400, 47, 162, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 400, 400, 400, 400, 400, 54, 400, 105, 400, 400, 400], "policy_agent_policy_reward": [40.13471804476976, 41.65580975375806, 34.30584084148097, 83.07840024523563, 38.324731797716446, 44.14499692113129, 18.356817115004816, 4.638448072385797, 9.708517582389554, 2.8981165931623387, -21.39485997165935, 19.86413674075475, -17.375873830338485, 45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004, 39.4655308394967, 14.452734985492718, 7.452187845629698, 3.909109075206487, 15.211164312723145, -33.61618178233919, 11.66575543401941, 45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212, 62.54692826021479, 12.333562353536351, -63.87265531878309, 33.716866876408396, -21.075695371660288, 40.6725496305498, -14.463297792171897, 26.58075700263651, 47.18605196572492, -25.801922229999956, 34.27995966313726, 9.45690028916014, 32.603455762549544, 13.456746863391658, 20.820922131882185, 36.56627880440329, 6.393388021007702, -5.735123986105204, -1.5423396537904548, 13.645705454942302, -21.449581370428064, 8.541408237620303, -8.924958117009897, 38.253846920157, 13.301498966996125, -11.232696252529387, -33.54180925075127, -12.328046745104405, 18.20362662974418, -49.18590643695178, 15.593080262727021, 8.89566683192168, 5.7861560889497845, 49.94010645705929, 23.618674271127347, -33.555398327893464, -25.232923159481224, 6.501060010040398, 21.096983379914278, -16.054651841128212, 10.032984131593379, 19.314580130302076, -43.97833576580004, 52.07159870264535, -12.622840125854921, -4.955965222562732, 47.75602294268518, 62.56857634517894, 18.117462327743624, -10.694403067353413, 56.89588948593754, 71.2591226319374, 47.44939983816737, -26.97892464068583, 23.622711504963668, 43.50738245552775, 1.576311009710098, -17.15810221736063, -6.417339034955354, 61.54107108246978, 18.445974388125315, 46.01014620068707, 3.6945801548109642, 14.572010811364393, 20.52640314847485, -18.071817876208733, 26.91243959436597, -35.67134887443652, 38.06695623109123, 9.909682883691662, 40.37002634259957], "policy_adversary_policy_reward": [-17.194350248360536, -22.94036779640923, -11.733167964528242, -29.92264178922976, -15.930250682435215, -18.375590159045753, -39.434068553080955, -43.64433169215471, -14.343884960227044, -23.980846837489402, -26.16964497728857, -17.975351943842714, -22.137195824528643, 3.780378709523827, 19.21615629475391, -23.854604367139707, -16.966801566976297, 7.258283984586743, -10.008377615592286, 7.110261022429946, 13.778763999256213, 7.616095972403137, -11.273782030840756, -8.590354709913985, 21.41517208118838, -4.039298250849903, -13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009, -14.461185348675652, -25.00434549082105, 1.074384882855071, -15.52711986834779, 0.2814040402774616, -7.73359188590716, 21.93897175776973, -25.848080832976216, -9.309068148269631, -5.902096164453511, 15.033364346622808, 18.582817435716382, -3.3856883027378117, -8.280067131281598, -27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927, -31.850737351818786, -30.696190908395984, -5.775653384671237, -6.557908968865114, 32.33875139315836, 31.533903925624713, -11.373104306565246, -22.343762569843147, 39.196234190900896, -18.120538819240625, -22.722360333698667, -17.95018929685114, -20.215947608340638, 34.67924540051253, -10.652522929542322, -15.928234073094188, -25.760722459424606, -21.42532950630031, -10.381341843940184, 36.183264073940144, -13.152591015481143, -21.127368647656077, -31.926037738956705, 22.46913744979656, -9.436658069030827, -23.16679769351872, -15.495518624745259, 2.038771761353601, -10.949460436235931, -9.871461695646254, -25.37268491776847, -11.193593886634815, 5.787186361855895, -12.180574382863597, -18.72828891802291, 24.46341290412812, 1.8914666685177277, -0.3491270147272729, -6.456623662503432, -7.18908179243887, -14.147557863089382, 35.597139233517446, 3.064275268498413, -11.605683506118716, -3.0811545340708477, 12.006112651080745, -15.345652641465279, -22.90819427869172, -35.479002802548514, 22.177503835552393, -10.319143080544567, 21.551839333073957, -7.2172962059411745, 40.75910545669244, 6.685722892793539, 5.6423238523108745, -27.209623177183424, 9.005996547439246, 22.107166738036504, 27.07873969891527, -12.443584744932966, -3.1494955177940547, 20.867129941913866, -29.762796773835547, 32.78888959856172, -38.5750456875115, -29.60032643976227, -20.339780017297016, -22.600056043981148, -1.0186182271461988, -11.586702121290173, 45.142100449183644, -9.47102030306948, 34.703943462550704, -9.92542706950723, 3.4243670594668316, -10.371407601903684, -10.725575778010594, 8.537131594504437, 7.517520246623777, 5.894760192256458, -15.927744323849836, -13.46629327467764, -5.848286855624439, 18.26431009017584, 25.714025675624203, -35.73980489586657, -16.331793806778784, -21.58322502876651, 34.20606515462143, -20.476985648818708, 25.43295087138144, -27.761127587022408, -19.994895355662784, -21.164780872082684, -41.40379547309626, -25.395095000712853, 7.277632672969226, 32.276518195756054, -21.582115128402638, -24.43677897015342, -32.45911051578412, -37.950240188212746, -33.3088824437247, -19.895426735598694, -27.553973102568676, 15.912573492016303, 11.066351148669526, -13.974988025383993, -9.647723479579675, -10.996602878405037, -32.51077957712279, -10.475955733315377, 8.899644723605281, 3.283174952400909, 13.874927264959721, 12.05576560366638, -5.638426568711026, -31.101418344794922, -30.439652737674862, -15.593204723545982, -2.852769664579334, -28.783000295934514, -17.22714590475255, -1.4460507215516643, -2.2485294332593, -8.400049833869375, -6.171960977495019, -4.446074076254589, -16.08032907222026, 8.574947747647258, 9.496870128561477, -7.22345785401302, -19.68898174035295, -9.193475075956748, 44.86482395039327, -47.449287565255695, 9.382331334164455, -5.378863408899267, -4.530819474792395, -11.562723685105707, -28.80730265749387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40146505256521103, "mean_inference_ms": 1.040634226351073, "mean_action_processing_ms": 0.17334805426579866, "mean_env_wait_ms": 0.06812427602202581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004271864891052246, "StateBufferConnector_ms": 0.0027484893798828125, "ViewRequirementAgentConnector_ms": 0.08064496517181396}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.180765783726, "num_env_steps_trained_throughput_per_sec": 473.180765783726, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 8921.786, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8921.753, "sample_time_ms": 811.395, "learn_time_ms": 8096.993, "learn_throughput": 494.011, "synch_weights_time_ms": 12.536}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 84, "trial_id": "fa423_00000", "date": "2024-08-10_11-10-08", "timestamp": 1723302608, "time_this_iter_s": 8.461018085479736, "time_total_s": 689.7920246124268, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98a5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 689.7920246124268, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 33.161538461538456, "ram_util_percent": 79.15384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.708560735365701, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.273343214976094, "policy_loss": -0.004171577294569009, "vf_loss": 2.2774322952542985, "vf_explained_var": 0.0703585081630283, "kl": 0.013905896645078986, "entropy": 0.7028979534194583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4335842720543344, "cur_kl_coeff": 0.0003707885742187501, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.03524089169999, "policy_loss": -0.0011360935241100378, "vf_loss": 3.0363762258241573, "vf_explained_var": -0.06733595468103885, "kl": 0.00203246627842056, "entropy": 0.36023219373698034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 337.52, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 33752, "policy_reward_min": {"agent_policy": -69.547694717658, "adversary_policy": -47.449287565255695}, "policy_reward_max": {"agent_policy": 71.2591226319374, "adversary_policy": 45.142100449183644}, "policy_reward_mean": {"agent_policy": 10.486444882523035, "adversary_policy": -5.243222441261519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 327, 400, 400, 400, 400, 400, 84, 400, 88, 400, 400, 400, 400, 400, 400, 400, 340, 400, 400, 400, 332, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 17, 400, 204, 400, 47, 400, 400, 400, 281, 400, 400, 176, 400, 144, 58, 400, 400, 391, 400, 400, 400, 11, 400, 400, 400, 400, 234, 400, 400, 400, 47, 162, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 400, 400, 400, 400, 400, 54, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 11, 37, 244, 400, 400, 400], "policy_agent_policy_reward": [45.465674969079004, 22.692361536004118, -11.356913483413358, 35.01322678246805, 53.66079652004004, 39.4655308394967, 14.452734985492718, 7.452187845629698, 3.909109075206487, 15.211164312723145, -33.61618178233919, 11.66575543401941, 45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212, 62.54692826021479, 12.333562353536351, -63.87265531878309, 33.716866876408396, -21.075695371660288, 40.6725496305498, -14.463297792171897, 26.58075700263651, 47.18605196572492, -25.801922229999956, 34.27995966313726, 9.45690028916014, 32.603455762549544, 13.456746863391658, 20.820922131882185, 36.56627880440329, 6.393388021007702, -5.735123986105204, -1.5423396537904548, 13.645705454942302, -21.449581370428064, 8.541408237620303, -8.924958117009897, 38.253846920157, 13.301498966996125, -11.232696252529387, -33.54180925075127, -12.328046745104405, 18.20362662974418, -49.18590643695178, 15.593080262727021, 8.89566683192168, 5.7861560889497845, 49.94010645705929, 23.618674271127347, -33.555398327893464, -25.232923159481224, 6.501060010040398, 21.096983379914278, -16.054651841128212, 10.032984131593379, 19.314580130302076, -43.97833576580004, 52.07159870264535, -12.622840125854921, -4.955965222562732, 47.75602294268518, 62.56857634517894, 18.117462327743624, -10.694403067353413, 56.89588948593754, 71.2591226319374, 47.44939983816737, -26.97892464068583, 23.622711504963668, 43.50738245552775, 1.576311009710098, -17.15810221736063, -6.417339034955354, 61.54107108246978, 18.445974388125315, 46.01014620068707, 3.6945801548109642, 14.572010811364393, 20.52640314847485, -18.071817876208733, 26.91243959436597, -35.67134887443652, 38.06695623109123, 9.909682883691662, 40.37002634259957, 28.297566749112832, 0.5493671889263858, -15.918585399223073, -12.426082623842422, 21.074373578221092, -0.059489403994234635, -69.547694717658, -3.6787473511966007, -15.761703763968713, -41.80530480230577, 39.84413608337, 20.457385476534213, -2.040016281432546], "policy_adversary_policy_reward": [-13.605431275237365, -31.860243693841646, -14.284860198315332, -8.407501337688785, 43.63590407916471, -32.27899059575135, -0.6959693016583373, -34.31725748080972, -21.239023146509957, -32.42177337353009, -14.461185348675652, -25.00434549082105, 1.074384882855071, -15.52711986834779, 0.2814040402774616, -7.73359188590716, 21.93897175776973, -25.848080832976216, -9.309068148269631, -5.902096164453511, 15.033364346622808, 18.582817435716382, -3.3856883027378117, -8.280067131281598, -27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927, -31.850737351818786, -30.696190908395984, -5.775653384671237, -6.557908968865114, 32.33875139315836, 31.533903925624713, -11.373104306565246, -22.343762569843147, 39.196234190900896, -18.120538819240625, -22.722360333698667, -17.95018929685114, -20.215947608340638, 34.67924540051253, -10.652522929542322, -15.928234073094188, -25.760722459424606, -21.42532950630031, -10.381341843940184, 36.183264073940144, -13.152591015481143, -21.127368647656077, -31.926037738956705, 22.46913744979656, -9.436658069030827, -23.16679769351872, -15.495518624745259, 2.038771761353601, -10.949460436235931, -9.871461695646254, -25.37268491776847, -11.193593886634815, 5.787186361855895, -12.180574382863597, -18.72828891802291, 24.46341290412812, 1.8914666685177277, -0.3491270147272729, -6.456623662503432, -7.18908179243887, -14.147557863089382, 35.597139233517446, 3.064275268498413, -11.605683506118716, -3.0811545340708477, 12.006112651080745, -15.345652641465279, -22.90819427869172, -35.479002802548514, 22.177503835552393, -10.319143080544567, 21.551839333073957, -7.2172962059411745, 40.75910545669244, 6.685722892793539, 5.6423238523108745, -27.209623177183424, 9.005996547439246, 22.107166738036504, 27.07873969891527, -12.443584744932966, -3.1494955177940547, 20.867129941913866, -29.762796773835547, 32.78888959856172, -38.5750456875115, -29.60032643976227, -20.339780017297016, -22.600056043981148, -1.0186182271461988, -11.586702121290173, 45.142100449183644, -9.47102030306948, 34.703943462550704, -9.92542706950723, 3.4243670594668316, -10.371407601903684, -10.725575778010594, 8.537131594504437, 7.517520246623777, 5.894760192256458, -15.927744323849836, -13.46629327467764, -5.848286855624439, 18.26431009017584, 25.714025675624203, -35.73980489586657, -16.331793806778784, -21.58322502876651, 34.20606515462143, -20.476985648818708, 25.43295087138144, -27.761127587022408, -19.994895355662784, -21.164780872082684, -41.40379547309626, -25.395095000712853, 7.277632672969226, 32.276518195756054, -21.582115128402638, -24.43677897015342, -32.45911051578412, -37.950240188212746, -33.3088824437247, -19.895426735598694, -27.553973102568676, 15.912573492016303, 11.066351148669526, -13.974988025383993, -9.647723479579675, -10.996602878405037, -32.51077957712279, -10.475955733315377, 8.899644723605281, 3.283174952400909, 13.874927264959721, 12.05576560366638, -5.638426568711026, -31.101418344794922, -30.439652737674862, -15.593204723545982, -2.852769664579334, -28.783000295934514, -17.22714590475255, -1.4460507215516643, -2.2485294332593, -8.400049833869375, -6.171960977495019, -4.446074076254589, -16.08032907222026, 8.574947747647258, 9.496870128561477, -7.22345785401302, -19.68898174035295, -9.193475075956748, 44.86482395039327, -47.449287565255695, 9.382331334164455, -5.378863408899267, -4.530819474792395, -11.562723685105707, -28.80730265749387, 15.536775550523188, -43.83434229963603, 17.92271318111384, -18.472080370040224, 13.670746802027182, 2.2478385971958907, -4.376701933047805, 16.802784556890227, -14.338566595182144, -6.735806983038948, -2.099478871155611, 2.158968275149846, 40.537240544483396, 29.010454173174605, -9.00819091650343, 12.68693826770003, 31.296740602402636, -15.535036838433921, 21.43259108282244, 20.37271371948333, -32.86986824903546, -6.974267834334526, -8.119315220616997, -12.338070255917216, -3.456382913613691, 5.496399195046237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4016744812588303, "mean_inference_ms": 1.0411774456504723, "mean_action_processing_ms": 0.1732640961179442, "mean_env_wait_ms": 0.06818513375604131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004419207572937012, "StateBufferConnector_ms": 0.0027747154235839844, "ViewRequirementAgentConnector_ms": 0.08140087127685547}, "num_episodes": 13, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.0230871483118, "num_env_steps_trained_throughput_per_sec": 513.0230871483118, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 8891.062, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8891.029, "sample_time_ms": 814.523, "learn_time_ms": 8063.012, "learn_throughput": 496.093, "synch_weights_time_ms": 12.669}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "training_iteration": 85, "trial_id": "fa423_00000", "date": "2024-08-10_11-10-16", "timestamp": 1723302616, "time_this_iter_s": 7.801856994628906, "time_total_s": 697.5938816070557, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98a5940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 697.5938816070557, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 29.60000000000001, "ram_util_percent": 78.63636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.789911955468869, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4575143935819153, "policy_loss": -0.00476225279776685, "vf_loss": 2.4621971481060854, "vf_explained_var": 0.11602446645025223, "kl": 0.013399792207823676, "entropy": 0.6792511472941707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4636626672931015, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7615677278488873, "policy_loss": -8.353663797606714e-05, "vf_loss": 2.76165105390052, "vf_explained_var": 0.14395871243129174, "kl": 0.0011442926239403387, "entropy": 0.4366646207248171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 334.06, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 33406, "policy_reward_min": {"agent_policy": -69.547694717658, "adversary_policy": -47.449287565255695}, "policy_reward_max": {"agent_policy": 71.2591226319374, "adversary_policy": 45.142100449183644}, "policy_reward_mean": {"agent_policy": 8.900104340817325, "adversary_policy": -4.4500521704086635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 340, 400, 400, 400, 332, 400, 400, 400, 400, 61, 400, 400, 400, 400, 400, 400, 17, 400, 204, 400, 47, 400, 400, 400, 281, 400, 400, 176, 400, 144, 58, 400, 400, 391, 400, 400, 400, 11, 400, 400, 400, 400, 234, 400, 400, 400, 47, 162, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 400, 400, 400, 400, 400, 54, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 11, 37, 244, 400, 400, 400, 400, 400, 400, 62, 400, 400, 44, 400, 400, 400, 400, 47], "policy_agent_policy_reward": [45.31478848179427, -6.28192027310369, -7.006054132126877, 49.9495916079212, 62.54692826021479, 12.333562353536351, -63.87265531878309, 33.716866876408396, -21.075695371660288, 40.6725496305498, -14.463297792171897, 26.58075700263651, 47.18605196572492, -25.801922229999956, 34.27995966313726, 9.45690028916014, 32.603455762549544, 13.456746863391658, 20.820922131882185, 36.56627880440329, 6.393388021007702, -5.735123986105204, -1.5423396537904548, 13.645705454942302, -21.449581370428064, 8.541408237620303, -8.924958117009897, 38.253846920157, 13.301498966996125, -11.232696252529387, -33.54180925075127, -12.328046745104405, 18.20362662974418, -49.18590643695178, 15.593080262727021, 8.89566683192168, 5.7861560889497845, 49.94010645705929, 23.618674271127347, -33.555398327893464, -25.232923159481224, 6.501060010040398, 21.096983379914278, -16.054651841128212, 10.032984131593379, 19.314580130302076, -43.97833576580004, 52.07159870264535, -12.622840125854921, -4.955965222562732, 47.75602294268518, 62.56857634517894, 18.117462327743624, -10.694403067353413, 56.89588948593754, 71.2591226319374, 47.44939983816737, -26.97892464068583, 23.622711504963668, 43.50738245552775, 1.576311009710098, -17.15810221736063, -6.417339034955354, 61.54107108246978, 18.445974388125315, 46.01014620068707, 3.6945801548109642, 14.572010811364393, 20.52640314847485, -18.071817876208733, 26.91243959436597, -35.67134887443652, 38.06695623109123, 9.909682883691662, 40.37002634259957, 28.297566749112832, 0.5493671889263858, -15.918585399223073, -12.426082623842422, 21.074373578221092, -0.059489403994234635, -69.547694717658, -3.6787473511966007, -15.761703763968713, -41.80530480230577, 39.84413608337, 20.457385476534213, -2.040016281432546, 16.351652098135226, -12.465738864443882, 19.787004908017593, -22.035659074016817, -1.5226240674591907, 52.467203461023374, -19.549602926695723, 9.168215549213382, 22.858748453860528, -6.886618420591432, 22.86757915398421, -35.65876740719139], "policy_adversary_policy_reward": [-27.898233099571893, -17.41655538222237, 14.44753052840614, -8.16561025530245, 12.382519180692825, -5.376465048565947, -11.947871812291929, -38.00171979562927, -31.850737351818786, -30.696190908395984, -5.775653384671237, -6.557908968865114, 32.33875139315836, 31.533903925624713, -11.373104306565246, -22.343762569843147, 39.196234190900896, -18.120538819240625, -22.722360333698667, -17.95018929685114, -20.215947608340638, 34.67924540051253, -10.652522929542322, -15.928234073094188, -25.760722459424606, -21.42532950630031, -10.381341843940184, 36.183264073940144, -13.152591015481143, -21.127368647656077, -31.926037738956705, 22.46913744979656, -9.436658069030827, -23.16679769351872, -15.495518624745259, 2.038771761353601, -10.949460436235931, -9.871461695646254, -25.37268491776847, -11.193593886634815, 5.787186361855895, -12.180574382863597, -18.72828891802291, 24.46341290412812, 1.8914666685177277, -0.3491270147272729, -6.456623662503432, -7.18908179243887, -14.147557863089382, 35.597139233517446, 3.064275268498413, -11.605683506118716, -3.0811545340708477, 12.006112651080745, -15.345652641465279, -22.90819427869172, -35.479002802548514, 22.177503835552393, -10.319143080544567, 21.551839333073957, -7.2172962059411745, 40.75910545669244, 6.685722892793539, 5.6423238523108745, -27.209623177183424, 9.005996547439246, 22.107166738036504, 27.07873969891527, -12.443584744932966, -3.1494955177940547, 20.867129941913866, -29.762796773835547, 32.78888959856172, -38.5750456875115, -29.60032643976227, -20.339780017297016, -22.600056043981148, -1.0186182271461988, -11.586702121290173, 45.142100449183644, -9.47102030306948, 34.703943462550704, -9.92542706950723, 3.4243670594668316, -10.371407601903684, -10.725575778010594, 8.537131594504437, 7.517520246623777, 5.894760192256458, -15.927744323849836, -13.46629327467764, -5.848286855624439, 18.26431009017584, 25.714025675624203, -35.73980489586657, -16.331793806778784, -21.58322502876651, 34.20606515462143, -20.476985648818708, 25.43295087138144, -27.761127587022408, -19.994895355662784, -21.164780872082684, -41.40379547309626, -25.395095000712853, 7.277632672969226, 32.276518195756054, -21.582115128402638, -24.43677897015342, -32.45911051578412, -37.950240188212746, -33.3088824437247, -19.895426735598694, -27.553973102568676, 15.912573492016303, 11.066351148669526, -13.974988025383993, -9.647723479579675, -10.996602878405037, -32.51077957712279, -10.475955733315377, 8.899644723605281, 3.283174952400909, 13.874927264959721, 12.05576560366638, -5.638426568711026, -31.101418344794922, -30.439652737674862, -15.593204723545982, -2.852769664579334, -28.783000295934514, -17.22714590475255, -1.4460507215516643, -2.2485294332593, -8.400049833869375, -6.171960977495019, -4.446074076254589, -16.08032907222026, 8.574947747647258, 9.496870128561477, -7.22345785401302, -19.68898174035295, -9.193475075956748, 44.86482395039327, -47.449287565255695, 9.382331334164455, -5.378863408899267, -4.530819474792395, -11.562723685105707, -28.80730265749387, 15.536775550523188, -43.83434229963603, 17.92271318111384, -18.472080370040224, 13.670746802027182, 2.2478385971958907, -4.376701933047805, 16.802784556890227, -14.338566595182144, -6.735806983038948, -2.099478871155611, 2.158968275149846, 40.537240544483396, 29.010454173174605, -9.00819091650343, 12.68693826770003, 31.296740602402636, -15.535036838433921, 21.43259108282244, 20.37271371948333, -32.86986824903546, -6.974267834334526, -8.119315220616997, -12.338070255917216, -3.456382913613691, 5.496399195046237, 21.237458003556107, -37.589110101691325, 11.152668688547646, 1.313070175896236, -1.1792456635958786, -18.607759244421715, 9.887447724476665, 12.14821134954015, -3.218420577992269, 4.74104464545146, -28.709729634009943, -23.757473827013417, 6.981481334788981, 12.568121591906733, 14.515487933037553, -23.683703482250934, -22.896088234143477, 0.03733978028294871, -1.1880284910666212, 8.074646911658057, -11.893886567720507, -10.973692586263702, 9.077668800430049, 26.58109860676134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40203577176511146, "mean_inference_ms": 1.0412376562228003, "mean_action_processing_ms": 0.17328102238858464, "mean_env_wait_ms": 0.06823114221321808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038906335830688477, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.08076679706573486}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.5395659310409, "num_env_steps_trained_throughput_per_sec": 506.5395659310409, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 8896.572, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8896.537, "sample_time_ms": 816.671, "learn_time_ms": 8066.27, "learn_throughput": 495.892, "synch_weights_time_ms": 12.753}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 86, "trial_id": "fa423_00000", "date": "2024-08-10_11-10-24", "timestamp": 1723302624, "time_this_iter_s": 7.902381658554077, "time_total_s": 705.4962632656097, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98a59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 705.4962632656097, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.372727272727275, "ram_util_percent": 78.60909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8715500704195134, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0674608367460747, "policy_loss": -0.004809729963363636, "vf_loss": 3.0722338137172516, "vf_explained_var": 0.25537642294136936, "kl": 0.006196364442157285, "entropy": 0.663614491243211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0728715787952146, "cur_kl_coeff": 9.269714355468753e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9803658058245976, "policy_loss": -0.0014170801453777433, "vf_loss": 3.9817824589709443, "vf_explained_var": -0.04698647999515136, "kl": 0.004744651419360106, "entropy": 0.4322909914578001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 1.1102230246251566e-18, "episode_len_mean": 310.77, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 31077, "policy_reward_min": {"agent_policy": -69.547694717658, "adversary_policy": -47.449287565255695}, "policy_reward_max": {"agent_policy": 71.2591226319374, "adversary_policy": 45.142100449183644}, "policy_reward_mean": {"agent_policy": 7.069837389277521, "adversary_policy": -3.53491869463876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 17, 400, 204, 400, 47, 400, 400, 400, 281, 400, 400, 176, 400, 144, 58, 400, 400, 391, 400, 400, 400, 11, 400, 400, 400, 400, 234, 400, 400, 400, 47, 162, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 400, 400, 400, 400, 400, 54, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 11, 37, 244, 400, 400, 400, 400, 400, 400, 62, 400, 400, 44, 400, 400, 400, 400, 47, 400, 400, 400, 400, 80, 24, 185, 51, 142, 71, 12, 400, 400, 27, 212, 400, 400], "policy_agent_policy_reward": [13.456746863391658, 20.820922131882185, 36.56627880440329, 6.393388021007702, -5.735123986105204, -1.5423396537904548, 13.645705454942302, -21.449581370428064, 8.541408237620303, -8.924958117009897, 38.253846920157, 13.301498966996125, -11.232696252529387, -33.54180925075127, -12.328046745104405, 18.20362662974418, -49.18590643695178, 15.593080262727021, 8.89566683192168, 5.7861560889497845, 49.94010645705929, 23.618674271127347, -33.555398327893464, -25.232923159481224, 6.501060010040398, 21.096983379914278, -16.054651841128212, 10.032984131593379, 19.314580130302076, -43.97833576580004, 52.07159870264535, -12.622840125854921, -4.955965222562732, 47.75602294268518, 62.56857634517894, 18.117462327743624, -10.694403067353413, 56.89588948593754, 71.2591226319374, 47.44939983816737, -26.97892464068583, 23.622711504963668, 43.50738245552775, 1.576311009710098, -17.15810221736063, -6.417339034955354, 61.54107108246978, 18.445974388125315, 46.01014620068707, 3.6945801548109642, 14.572010811364393, 20.52640314847485, -18.071817876208733, 26.91243959436597, -35.67134887443652, 38.06695623109123, 9.909682883691662, 40.37002634259957, 28.297566749112832, 0.5493671889263858, -15.918585399223073, -12.426082623842422, 21.074373578221092, -0.059489403994234635, -69.547694717658, -3.6787473511966007, -15.761703763968713, -41.80530480230577, 39.84413608337, 20.457385476534213, -2.040016281432546, 16.351652098135226, -12.465738864443882, 19.787004908017593, -22.035659074016817, -1.5226240674591907, 52.467203461023374, -19.549602926695723, 9.168215549213382, 22.858748453860528, -6.886618420591432, 22.86757915398421, -35.65876740719139, 14.707113341432311, 15.488813934500826, 12.859961011433604, 65.39650309138113, -6.339707058601357, -10.895538131044171, 3.077014880606658, -21.36852543475275, -3.2590553252277843, -39.7210537577553, 1.9364769698436026, 18.4396948548251, 32.652290986586735, -12.493346471099262, -15.930558719756537, 2.949224093554534, 15.613863355879367], "policy_adversary_policy_reward": [-15.495518624745259, 2.038771761353601, -10.949460436235931, -9.871461695646254, -25.37268491776847, -11.193593886634815, 5.787186361855895, -12.180574382863597, -18.72828891802291, 24.46341290412812, 1.8914666685177277, -0.3491270147272729, -6.456623662503432, -7.18908179243887, -14.147557863089382, 35.597139233517446, 3.064275268498413, -11.605683506118716, -3.0811545340708477, 12.006112651080745, -15.345652641465279, -22.90819427869172, -35.479002802548514, 22.177503835552393, -10.319143080544567, 21.551839333073957, -7.2172962059411745, 40.75910545669244, 6.685722892793539, 5.6423238523108745, -27.209623177183424, 9.005996547439246, 22.107166738036504, 27.07873969891527, -12.443584744932966, -3.1494955177940547, 20.867129941913866, -29.762796773835547, 32.78888959856172, -38.5750456875115, -29.60032643976227, -20.339780017297016, -22.600056043981148, -1.0186182271461988, -11.586702121290173, 45.142100449183644, -9.47102030306948, 34.703943462550704, -9.92542706950723, 3.4243670594668316, -10.371407601903684, -10.725575778010594, 8.537131594504437, 7.517520246623777, 5.894760192256458, -15.927744323849836, -13.46629327467764, -5.848286855624439, 18.26431009017584, 25.714025675624203, -35.73980489586657, -16.331793806778784, -21.58322502876651, 34.20606515462143, -20.476985648818708, 25.43295087138144, -27.761127587022408, -19.994895355662784, -21.164780872082684, -41.40379547309626, -25.395095000712853, 7.277632672969226, 32.276518195756054, -21.582115128402638, -24.43677897015342, -32.45911051578412, -37.950240188212746, -33.3088824437247, -19.895426735598694, -27.553973102568676, 15.912573492016303, 11.066351148669526, -13.974988025383993, -9.647723479579675, -10.996602878405037, -32.51077957712279, -10.475955733315377, 8.899644723605281, 3.283174952400909, 13.874927264959721, 12.05576560366638, -5.638426568711026, -31.101418344794922, -30.439652737674862, -15.593204723545982, -2.852769664579334, -28.783000295934514, -17.22714590475255, -1.4460507215516643, -2.2485294332593, -8.400049833869375, -6.171960977495019, -4.446074076254589, -16.08032907222026, 8.574947747647258, 9.496870128561477, -7.22345785401302, -19.68898174035295, -9.193475075956748, 44.86482395039327, -47.449287565255695, 9.382331334164455, -5.378863408899267, -4.530819474792395, -11.562723685105707, -28.80730265749387, 15.536775550523188, -43.83434229963603, 17.92271318111384, -18.472080370040224, 13.670746802027182, 2.2478385971958907, -4.376701933047805, 16.802784556890227, -14.338566595182144, -6.735806983038948, -2.099478871155611, 2.158968275149846, 40.537240544483396, 29.010454173174605, -9.00819091650343, 12.68693826770003, 31.296740602402636, -15.535036838433921, 21.43259108282244, 20.37271371948333, -32.86986824903546, -6.974267834334526, -8.119315220616997, -12.338070255917216, -3.456382913613691, 5.496399195046237, 21.237458003556107, -37.589110101691325, 11.152668688547646, 1.313070175896236, -1.1792456635958786, -18.607759244421715, 9.887447724476665, 12.14821134954015, -3.218420577992269, 4.74104464545146, -28.709729634009943, -23.757473827013417, 6.981481334788981, 12.568121591906733, 14.515487933037553, -23.683703482250934, -22.896088234143477, 0.03733978028294871, -1.1880284910666212, 8.074646911658057, -11.893886567720507, -10.973692586263702, 9.077668800430049, 26.58109860676134, -12.515949951879175, -2.191163389553136, -7.546269221455482, -7.9425447130453435, -7.854142655846488, -5.005818355587117, -28.832279697079, -36.564223394302125, -8.113563471011158, 14.453270529612514, -1.0712150835623948, 11.966753214606566, 20.011747665945762, -23.08876254655242, -0.7943094691743422, 22.162834903927095, 28.334488475613064, -25.075433150385283, 18.39356075286477, 21.32749300489053, -7.338568133199612, 5.402091163356008, -3.2251449452215013, -15.214549909603598, -18.270907320811915, -14.38138366577482, 24.580273216133776, -12.086926745034518, 22.898306065668777, -6.96774734591224, -4.850294014103753, 1.9010699205492188, -30.56655848813663, 14.95269513225727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40198044572940217, "mean_inference_ms": 1.0415225947260496, "mean_action_processing_ms": 0.17326329857755277, "mean_env_wait_ms": 0.06825870888816303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003941059112548828, "StateBufferConnector_ms": 0.002710103988647461, "ViewRequirementAgentConnector_ms": 0.08168864250183105}, "num_episodes": 17, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.0208445985929, "num_env_steps_trained_throughput_per_sec": 512.0208445985929, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 7942.235, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7942.201, "sample_time_ms": 816.961, "learn_time_ms": 7113.088, "learn_throughput": 562.344, "synch_weights_time_ms": 11.467}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "training_iteration": 87, "trial_id": "fa423_00000", "date": "2024-08-10_11-10-32", "timestamp": 1723302632, "time_this_iter_s": 7.817162036895752, "time_total_s": 713.3134253025055, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7299dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 713.3134253025055, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 24.950000000000003, "ram_util_percent": 78.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2655662018155294, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.757055724676324, "policy_loss": -0.004246499583435555, "vf_loss": 2.7612513706797643, "vf_explained_var": 0.285749219491999, "kl": 0.008573087697650862, "entropy": 0.6565586945997974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.349919090109567, "cur_kl_coeff": 4.6348571777343765e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5432792166868845, "policy_loss": -0.0009930064838651258, "vf_loss": 3.544272193312645, "vf_explained_var": 0.07916750367730856, "kl": 0.0016384538465634554, "entropy": 0.290134822903201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 1.1102230246251566e-18, "episode_len_mean": 306.79, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 30679, "policy_reward_min": {"agent_policy": -69.547694717658, "adversary_policy": -47.449287565255695}, "policy_reward_max": {"agent_policy": 71.58892010834518, "adversary_policy": 45.142100449183644}, "policy_reward_mean": {"agent_policy": 10.10425607203349, "adversary_policy": -5.052128036016746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 176, 400, 144, 58, 400, 400, 391, 400, 400, 400, 11, 400, 400, 400, 400, 234, 400, 400, 400, 47, 162, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 400, 400, 400, 400, 400, 54, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 11, 37, 244, 400, 400, 400, 400, 400, 400, 62, 400, 400, 44, 400, 400, 400, 400, 47, 400, 400, 400, 400, 80, 24, 185, 51, 142, 71, 12, 400, 400, 27, 212, 400, 400, 400, 219, 400, 400, 114, 400, 31, 400, 400, 400, 153, 400, 34, 400], "policy_agent_policy_reward": [-12.328046745104405, 18.20362662974418, -49.18590643695178, 15.593080262727021, 8.89566683192168, 5.7861560889497845, 49.94010645705929, 23.618674271127347, -33.555398327893464, -25.232923159481224, 6.501060010040398, 21.096983379914278, -16.054651841128212, 10.032984131593379, 19.314580130302076, -43.97833576580004, 52.07159870264535, -12.622840125854921, -4.955965222562732, 47.75602294268518, 62.56857634517894, 18.117462327743624, -10.694403067353413, 56.89588948593754, 71.2591226319374, 47.44939983816737, -26.97892464068583, 23.622711504963668, 43.50738245552775, 1.576311009710098, -17.15810221736063, -6.417339034955354, 61.54107108246978, 18.445974388125315, 46.01014620068707, 3.6945801548109642, 14.572010811364393, 20.52640314847485, -18.071817876208733, 26.91243959436597, -35.67134887443652, 38.06695623109123, 9.909682883691662, 40.37002634259957, 28.297566749112832, 0.5493671889263858, -15.918585399223073, -12.426082623842422, 21.074373578221092, -0.059489403994234635, -69.547694717658, -3.6787473511966007, -15.761703763968713, -41.80530480230577, 39.84413608337, 20.457385476534213, -2.040016281432546, 16.351652098135226, -12.465738864443882, 19.787004908017593, -22.035659074016817, -1.5226240674591907, 52.467203461023374, -19.549602926695723, 9.168215549213382, 22.858748453860528, -6.886618420591432, 22.86757915398421, -35.65876740719139, 14.707113341432311, 15.488813934500826, 12.859961011433604, 65.39650309138113, -6.339707058601357, -10.895538131044171, 3.077014880606658, -21.36852543475275, -3.2590553252277843, -39.7210537577553, 1.9364769698436026, 18.4396948548251, 32.652290986586735, -12.493346471099262, -15.930558719756537, 2.949224093554534, 15.613863355879367, 60.999661395902315, -2.4712281313417233, 19.061874562656897, 22.899170460376638, -8.915244472464035, 71.58892010834518, -8.934450811354399, 57.30317336575733, 35.0011681865005, 3.1849662935150036, -7.386730930784607, 62.652653423878796, 1.8243244695069984, 65.18689712488833], "policy_adversary_policy_reward": [6.685722892793539, 5.6423238523108745, -27.209623177183424, 9.005996547439246, 22.107166738036504, 27.07873969891527, -12.443584744932966, -3.1494955177940547, 20.867129941913866, -29.762796773835547, 32.78888959856172, -38.5750456875115, -29.60032643976227, -20.339780017297016, -22.600056043981148, -1.0186182271461988, -11.586702121290173, 45.142100449183644, -9.47102030306948, 34.703943462550704, -9.92542706950723, 3.4243670594668316, -10.371407601903684, -10.725575778010594, 8.537131594504437, 7.517520246623777, 5.894760192256458, -15.927744323849836, -13.46629327467764, -5.848286855624439, 18.26431009017584, 25.714025675624203, -35.73980489586657, -16.331793806778784, -21.58322502876651, 34.20606515462143, -20.476985648818708, 25.43295087138144, -27.761127587022408, -19.994895355662784, -21.164780872082684, -41.40379547309626, -25.395095000712853, 7.277632672969226, 32.276518195756054, -21.582115128402638, -24.43677897015342, -32.45911051578412, -37.950240188212746, -33.3088824437247, -19.895426735598694, -27.553973102568676, 15.912573492016303, 11.066351148669526, -13.974988025383993, -9.647723479579675, -10.996602878405037, -32.51077957712279, -10.475955733315377, 8.899644723605281, 3.283174952400909, 13.874927264959721, 12.05576560366638, -5.638426568711026, -31.101418344794922, -30.439652737674862, -15.593204723545982, -2.852769664579334, -28.783000295934514, -17.22714590475255, -1.4460507215516643, -2.2485294332593, -8.400049833869375, -6.171960977495019, -4.446074076254589, -16.08032907222026, 8.574947747647258, 9.496870128561477, -7.22345785401302, -19.68898174035295, -9.193475075956748, 44.86482395039327, -47.449287565255695, 9.382331334164455, -5.378863408899267, -4.530819474792395, -11.562723685105707, -28.80730265749387, 15.536775550523188, -43.83434229963603, 17.92271318111384, -18.472080370040224, 13.670746802027182, 2.2478385971958907, -4.376701933047805, 16.802784556890227, -14.338566595182144, -6.735806983038948, -2.099478871155611, 2.158968275149846, 40.537240544483396, 29.010454173174605, -9.00819091650343, 12.68693826770003, 31.296740602402636, -15.535036838433921, 21.43259108282244, 20.37271371948333, -32.86986824903546, -6.974267834334526, -8.119315220616997, -12.338070255917216, -3.456382913613691, 5.496399195046237, 21.237458003556107, -37.589110101691325, 11.152668688547646, 1.313070175896236, -1.1792456635958786, -18.607759244421715, 9.887447724476665, 12.14821134954015, -3.218420577992269, 4.74104464545146, -28.709729634009943, -23.757473827013417, 6.981481334788981, 12.568121591906733, 14.515487933037553, -23.683703482250934, -22.896088234143477, 0.03733978028294871, -1.1880284910666212, 8.074646911658057, -11.893886567720507, -10.973692586263702, 9.077668800430049, 26.58109860676134, -12.515949951879175, -2.191163389553136, -7.546269221455482, -7.9425447130453435, -7.854142655846488, -5.005818355587117, -28.832279697079, -36.564223394302125, -8.113563471011158, 14.453270529612514, -1.0712150835623948, 11.966753214606566, 20.011747665945762, -23.08876254655242, -0.7943094691743422, 22.162834903927095, 28.334488475613064, -25.075433150385283, 18.39356075286477, 21.32749300489053, -7.338568133199612, 5.402091163356008, -3.2251449452215013, -15.214549909603598, -18.270907320811915, -14.38138366577482, 24.580273216133776, -12.086926745034518, 22.898306065668777, -6.96774734591224, -4.850294014103753, 1.9010699205492188, -30.56655848813663, 14.95269513225727, -32.37460685994804, -28.62505453595428, 30.101603579439086, -27.630375448097364, -23.493861135431285, 4.431986572774388, -12.82931825683847, -10.069852203538169, -11.222455238645239, 20.137699711109274, -37.21393329175695, -34.37498681658832, -6.602953195515603, 15.537404006869998, -28.440353980198655, -28.862819385558662, -24.094748984017535, -10.906419202482965, -11.36578660625284, 8.180820312737836, -27.018196502854394, 34.404927433639, -30.480794640502587, -32.17185878337621, -8.860587913554536, 7.036263444047537, -24.61673185425418, -40.57016527063416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40228372430894127, "mean_inference_ms": 1.0419785000994972, "mean_action_processing_ms": 0.17326550501209934, "mean_env_wait_ms": 0.06830413069634993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395047664642334, "StateBufferConnector_ms": 0.0026890039443969727, "ViewRequirementAgentConnector_ms": 0.09031283855438232}, "num_episodes": 14, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.44190008558724, "num_env_steps_trained_throughput_per_sec": 497.44190008558724, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 7949.583, "restore_workers_time_ms": 0.011, "training_step_time_ms": 7949.55, "sample_time_ms": 819.591, "learn_time_ms": 7117.795, "learn_throughput": 561.972, "synch_weights_time_ms": 11.542}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 88, "trial_id": "fa423_00000", "date": "2024-08-10_11-10-40", "timestamp": 1723302640, "time_this_iter_s": 8.046094179153442, "time_total_s": 721.3595194816589, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98a5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 721.3595194816589, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 26.88181818181818, "ram_util_percent": 78.08181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2259110473135792, "cur_kl_coeff": 0.005932617187500002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2178580583087983, "policy_loss": -0.0023735515131472202, "vf_loss": 3.2202020071801685, "vf_explained_var": 0.426015593702831, "kl": 0.004990504415195694, "entropy": 0.6438750735666386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6554994489376744, "cur_kl_coeff": 2.3174285888671882e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.262345749636491, "policy_loss": -0.0014750279452224882, "vf_loss": 3.2638207664092382, "vf_explained_var": 0.19556725900620223, "kl": 0.0020581189804327253, "entropy": 0.3524145390217503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": -1.1102230246251566e-18, "episode_len_mean": 304.59, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 30459, "policy_reward_min": {"agent_policy": -69.547694717658, "adversary_policy": -47.449287565255695}, "policy_reward_max": {"agent_policy": 71.58892010834518, "adversary_policy": 44.86482395039327}, "policy_reward_mean": {"agent_policy": 10.299814531174391, "adversary_policy": -5.1499072655871965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [11, 400, 400, 400, 400, 234, 400, 400, 400, 47, 162, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 400, 400, 400, 400, 400, 54, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 11, 37, 244, 400, 400, 400, 400, 400, 400, 62, 400, 400, 44, 400, 400, 400, 400, 47, 400, 400, 400, 400, 80, 24, 185, 51, 142, 71, 12, 400, 400, 27, 212, 400, 400, 400, 219, 400, 400, 114, 400, 31, 400, 400, 400, 153, 400, 34, 400, 400, 42, 400, 400, 400, 400, 400, 366, 400, 64, 77, 400], "policy_agent_policy_reward": [-16.054651841128212, 10.032984131593379, 19.314580130302076, -43.97833576580004, 52.07159870264535, -12.622840125854921, -4.955965222562732, 47.75602294268518, 62.56857634517894, 18.117462327743624, -10.694403067353413, 56.89588948593754, 71.2591226319374, 47.44939983816737, -26.97892464068583, 23.622711504963668, 43.50738245552775, 1.576311009710098, -17.15810221736063, -6.417339034955354, 61.54107108246978, 18.445974388125315, 46.01014620068707, 3.6945801548109642, 14.572010811364393, 20.52640314847485, -18.071817876208733, 26.91243959436597, -35.67134887443652, 38.06695623109123, 9.909682883691662, 40.37002634259957, 28.297566749112832, 0.5493671889263858, -15.918585399223073, -12.426082623842422, 21.074373578221092, -0.059489403994234635, -69.547694717658, -3.6787473511966007, -15.761703763968713, -41.80530480230577, 39.84413608337, 20.457385476534213, -2.040016281432546, 16.351652098135226, -12.465738864443882, 19.787004908017593, -22.035659074016817, -1.5226240674591907, 52.467203461023374, -19.549602926695723, 9.168215549213382, 22.858748453860528, -6.886618420591432, 22.86757915398421, -35.65876740719139, 14.707113341432311, 15.488813934500826, 12.859961011433604, 65.39650309138113, -6.339707058601357, -10.895538131044171, 3.077014880606658, -21.36852543475275, -3.2590553252277843, -39.7210537577553, 1.9364769698436026, 18.4396948548251, 32.652290986586735, -12.493346471099262, -15.930558719756537, 2.949224093554534, 15.613863355879367, 60.999661395902315, -2.4712281313417233, 19.061874562656897, 22.899170460376638, -8.915244472464035, 71.58892010834518, -8.934450811354399, 57.30317336575733, 35.0011681865005, 3.1849662935150036, -7.386730930784607, 62.652653423878796, 1.8243244695069984, 65.18689712488833, 25.788950537125935, 3.9124804151627726, 2.019808960731666, 22.351490882737764, -9.29211433334979, -6.0227347277171255, 30.594979986175936, -2.426039041796326, 15.646784614046737, -11.497097579793412, -22.402494590697835, 0.21491005351703052], "policy_adversary_policy_reward": [8.537131594504437, 7.517520246623777, 5.894760192256458, -15.927744323849836, -13.46629327467764, -5.848286855624439, 18.26431009017584, 25.714025675624203, -35.73980489586657, -16.331793806778784, -21.58322502876651, 34.20606515462143, -20.476985648818708, 25.43295087138144, -27.761127587022408, -19.994895355662784, -21.164780872082684, -41.40379547309626, -25.395095000712853, 7.277632672969226, 32.276518195756054, -21.582115128402638, -24.43677897015342, -32.45911051578412, -37.950240188212746, -33.3088824437247, -19.895426735598694, -27.553973102568676, 15.912573492016303, 11.066351148669526, -13.974988025383993, -9.647723479579675, -10.996602878405037, -32.51077957712279, -10.475955733315377, 8.899644723605281, 3.283174952400909, 13.874927264959721, 12.05576560366638, -5.638426568711026, -31.101418344794922, -30.439652737674862, -15.593204723545982, -2.852769664579334, -28.783000295934514, -17.22714590475255, -1.4460507215516643, -2.2485294332593, -8.400049833869375, -6.171960977495019, -4.446074076254589, -16.08032907222026, 8.574947747647258, 9.496870128561477, -7.22345785401302, -19.68898174035295, -9.193475075956748, 44.86482395039327, -47.449287565255695, 9.382331334164455, -5.378863408899267, -4.530819474792395, -11.562723685105707, -28.80730265749387, 15.536775550523188, -43.83434229963603, 17.92271318111384, -18.472080370040224, 13.670746802027182, 2.2478385971958907, -4.376701933047805, 16.802784556890227, -14.338566595182144, -6.735806983038948, -2.099478871155611, 2.158968275149846, 40.537240544483396, 29.010454173174605, -9.00819091650343, 12.68693826770003, 31.296740602402636, -15.535036838433921, 21.43259108282244, 20.37271371948333, -32.86986824903546, -6.974267834334526, -8.119315220616997, -12.338070255917216, -3.456382913613691, 5.496399195046237, 21.237458003556107, -37.589110101691325, 11.152668688547646, 1.313070175896236, -1.1792456635958786, -18.607759244421715, 9.887447724476665, 12.14821134954015, -3.218420577992269, 4.74104464545146, -28.709729634009943, -23.757473827013417, 6.981481334788981, 12.568121591906733, 14.515487933037553, -23.683703482250934, -22.896088234143477, 0.03733978028294871, -1.1880284910666212, 8.074646911658057, -11.893886567720507, -10.973692586263702, 9.077668800430049, 26.58109860676134, -12.515949951879175, -2.191163389553136, -7.546269221455482, -7.9425447130453435, -7.854142655846488, -5.005818355587117, -28.832279697079, -36.564223394302125, -8.113563471011158, 14.453270529612514, -1.0712150835623948, 11.966753214606566, 20.011747665945762, -23.08876254655242, -0.7943094691743422, 22.162834903927095, 28.334488475613064, -25.075433150385283, 18.39356075286477, 21.32749300489053, -7.338568133199612, 5.402091163356008, -3.2251449452215013, -15.214549909603598, -18.270907320811915, -14.38138366577482, 24.580273216133776, -12.086926745034518, 22.898306065668777, -6.96774734591224, -4.850294014103753, 1.9010699205492188, -30.56655848813663, 14.95269513225727, -32.37460685994804, -28.62505453595428, 30.101603579439086, -27.630375448097364, -23.493861135431285, 4.431986572774388, -12.82931825683847, -10.069852203538169, -11.222455238645239, 20.137699711109274, -37.21393329175695, -34.37498681658832, -6.602953195515603, 15.537404006869998, -28.440353980198655, -28.862819385558662, -24.094748984017535, -10.906419202482965, -11.36578660625284, 8.180820312737836, -27.018196502854394, 34.404927433639, -30.480794640502587, -32.17185878337621, -8.860587913554536, 7.036263444047537, -24.61673185425418, -40.57016527063416, -13.780960243356303, -12.007990293769637, 15.473943410489728, -19.3864238256525, -22.52938363233848, 20.509574671606813, -10.622907593746763, -11.728583288990997, 12.025309177386518, -2.7331948440367277, 18.961533271338457, -12.938798543621331, -22.641106964404848, -7.953873021771088, 23.178047896357086, -20.752008854560763, -13.454266693211117, -2.19251792083562, -12.547350374525571, 24.044447954318983, 0.7483076521017864, 21.654186938596048, -1.6851351924026758, 1.4702251388856453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40246528334334564, "mean_inference_ms": 1.0426344783343984, "mean_action_processing_ms": 0.17326073000145661, "mean_env_wait_ms": 0.06838301459807689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004067897796630859, "StateBufferConnector_ms": 0.0026092529296875, "ViewRequirementAgentConnector_ms": 0.08674633502960205}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": -1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.1846431470431, "num_env_steps_trained_throughput_per_sec": 518.1846431470431, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 7939.494, "restore_workers_time_ms": 0.011, "training_step_time_ms": 7939.461, "sample_time_ms": 821.39, "learn_time_ms": 7105.777, "learn_throughput": 562.922, "synch_weights_time_ms": 11.706}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "training_iteration": 89, "trial_id": "fa423_00000", "date": "2024-08-10_11-10-48", "timestamp": 1723302648, "time_this_iter_s": 7.723736047744751, "time_total_s": 729.0832555294037, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98a5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 729.0832555294037, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 24.29090909090909, "ram_util_percent": 77.98181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0194181481997173, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.412560377297578, "policy_loss": -0.003351229855423626, "vf_loss": 2.4158860206604005, "vf_explained_var": 0.03666183346163028, "kl": 0.00862816090931047, "entropy": 0.5241179343411532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7180120206748444, "cur_kl_coeff": 1.1587142944335941e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2189673220117885, "policy_loss": -0.005191954611291294, "vf_loss": 3.224159056941668, "vf_explained_var": -0.08292658974726995, "kl": 0.01871106893885343, "entropy": 0.3966855023987591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 308.88, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 30888, "policy_reward_min": {"agent_policy": -69.547694717658, "adversary_policy": -47.449287565255695}, "policy_reward_max": {"agent_policy": 71.58892010834518, "adversary_policy": 45.94989251995874}, "policy_reward_mean": {"agent_policy": 9.993702324647872, "adversary_policy": -4.996851162323936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 34, 400, 400, 400, 400, 400, 400, 400, 54, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 11, 37, 244, 400, 400, 400, 400, 400, 400, 62, 400, 400, 44, 400, 400, 400, 400, 47, 400, 400, 400, 400, 80, 24, 185, 51, 142, 71, 12, 400, 400, 27, 212, 400, 400, 400, 219, 400, 400, 114, 400, 31, 400, 400, 400, 153, 400, 34, 400, 400, 42, 400, 400, 400, 400, 400, 366, 400, 64, 77, 400, 400, 400, 264, 400, 181, 400, 400, 299, 139, 400, 400, 400], "policy_agent_policy_reward": [71.2591226319374, 47.44939983816737, -26.97892464068583, 23.622711504963668, 43.50738245552775, 1.576311009710098, -17.15810221736063, -6.417339034955354, 61.54107108246978, 18.445974388125315, 46.01014620068707, 3.6945801548109642, 14.572010811364393, 20.52640314847485, -18.071817876208733, 26.91243959436597, -35.67134887443652, 38.06695623109123, 9.909682883691662, 40.37002634259957, 28.297566749112832, 0.5493671889263858, -15.918585399223073, -12.426082623842422, 21.074373578221092, -0.059489403994234635, -69.547694717658, -3.6787473511966007, -15.761703763968713, -41.80530480230577, 39.84413608337, 20.457385476534213, -2.040016281432546, 16.351652098135226, -12.465738864443882, 19.787004908017593, -22.035659074016817, -1.5226240674591907, 52.467203461023374, -19.549602926695723, 9.168215549213382, 22.858748453860528, -6.886618420591432, 22.86757915398421, -35.65876740719139, 14.707113341432311, 15.488813934500826, 12.859961011433604, 65.39650309138113, -6.339707058601357, -10.895538131044171, 3.077014880606658, -21.36852543475275, -3.2590553252277843, -39.7210537577553, 1.9364769698436026, 18.4396948548251, 32.652290986586735, -12.493346471099262, -15.930558719756537, 2.949224093554534, 15.613863355879367, 60.999661395902315, -2.4712281313417233, 19.061874562656897, 22.899170460376638, -8.915244472464035, 71.58892010834518, -8.934450811354399, 57.30317336575733, 35.0011681865005, 3.1849662935150036, -7.386730930784607, 62.652653423878796, 1.8243244695069984, 65.18689712488833, 25.788950537125935, 3.9124804151627726, 2.019808960731666, 22.351490882737764, -9.29211433334979, -6.0227347277171255, 30.594979986175936, -2.426039041796326, 15.646784614046737, -11.497097579793412, -22.402494590697835, 0.21491005351703052, 42.00323201032879, 17.531021113935438, -17.988369901808923, -6.678160925718323, 2.244672854934082, 9.982873663972113, 48.98319500464358, -22.237899799673595, -5.770781015422637, 17.506051944526234, 23.014691578576596, 39.24917086244131], "policy_adversary_policy_reward": [-37.950240188212746, -33.3088824437247, -19.895426735598694, -27.553973102568676, 15.912573492016303, 11.066351148669526, -13.974988025383993, -9.647723479579675, -10.996602878405037, -32.51077957712279, -10.475955733315377, 8.899644723605281, 3.283174952400909, 13.874927264959721, 12.05576560366638, -5.638426568711026, -31.101418344794922, -30.439652737674862, -15.593204723545982, -2.852769664579334, -28.783000295934514, -17.22714590475255, -1.4460507215516643, -2.2485294332593, -8.400049833869375, -6.171960977495019, -4.446074076254589, -16.08032907222026, 8.574947747647258, 9.496870128561477, -7.22345785401302, -19.68898174035295, -9.193475075956748, 44.86482395039327, -47.449287565255695, 9.382331334164455, -5.378863408899267, -4.530819474792395, -11.562723685105707, -28.80730265749387, 15.536775550523188, -43.83434229963603, 17.92271318111384, -18.472080370040224, 13.670746802027182, 2.2478385971958907, -4.376701933047805, 16.802784556890227, -14.338566595182144, -6.735806983038948, -2.099478871155611, 2.158968275149846, 40.537240544483396, 29.010454173174605, -9.00819091650343, 12.68693826770003, 31.296740602402636, -15.535036838433921, 21.43259108282244, 20.37271371948333, -32.86986824903546, -6.974267834334526, -8.119315220616997, -12.338070255917216, -3.456382913613691, 5.496399195046237, 21.237458003556107, -37.589110101691325, 11.152668688547646, 1.313070175896236, -1.1792456635958786, -18.607759244421715, 9.887447724476665, 12.14821134954015, -3.218420577992269, 4.74104464545146, -28.709729634009943, -23.757473827013417, 6.981481334788981, 12.568121591906733, 14.515487933037553, -23.683703482250934, -22.896088234143477, 0.03733978028294871, -1.1880284910666212, 8.074646911658057, -11.893886567720507, -10.973692586263702, 9.077668800430049, 26.58109860676134, -12.515949951879175, -2.191163389553136, -7.546269221455482, -7.9425447130453435, -7.854142655846488, -5.005818355587117, -28.832279697079, -36.564223394302125, -8.113563471011158, 14.453270529612514, -1.0712150835623948, 11.966753214606566, 20.011747665945762, -23.08876254655242, -0.7943094691743422, 22.162834903927095, 28.334488475613064, -25.075433150385283, 18.39356075286477, 21.32749300489053, -7.338568133199612, 5.402091163356008, -3.2251449452215013, -15.214549909603598, -18.270907320811915, -14.38138366577482, 24.580273216133776, -12.086926745034518, 22.898306065668777, -6.96774734591224, -4.850294014103753, 1.9010699205492188, -30.56655848813663, 14.95269513225727, -32.37460685994804, -28.62505453595428, 30.101603579439086, -27.630375448097364, -23.493861135431285, 4.431986572774388, -12.82931825683847, -10.069852203538169, -11.222455238645239, 20.137699711109274, -37.21393329175695, -34.37498681658832, -6.602953195515603, 15.537404006869998, -28.440353980198655, -28.862819385558662, -24.094748984017535, -10.906419202482965, -11.36578660625284, 8.180820312737836, -27.018196502854394, 34.404927433639, -30.480794640502587, -32.17185878337621, -8.860587913554536, 7.036263444047537, -24.61673185425418, -40.57016527063416, -13.780960243356303, -12.007990293769637, 15.473943410489728, -19.3864238256525, -22.52938363233848, 20.509574671606813, -10.622907593746763, -11.728583288990997, 12.025309177386518, -2.7331948440367277, 18.961533271338457, -12.938798543621331, -22.641106964404848, -7.953873021771088, 23.178047896357086, -20.752008854560763, -13.454266693211117, -2.19251792083562, -12.547350374525571, 24.044447954318983, 0.7483076521017864, 21.654186938596048, -1.6851351924026758, 1.4702251388856453, -31.32753034079662, -10.675701669532163, -3.797517086108966, -13.733504027826474, -15.506021121101625, 33.49439102291055, 7.531401681444422, -0.8532407557260981, -33.58273741651311, 31.33806456157903, 7.764290876434769, -17.74716454040688, -5.650331121243173, -43.33286388340042, 45.94989251995874, -23.71199272028514, 33.633125812840696, -27.862344797418057, -8.020116496703842, -9.485935447822392, -5.359224225179381, -17.655467353397214, -24.10233891944483, -15.146831942996478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40274456619622157, "mean_inference_ms": 1.0425298024515466, "mean_action_processing_ms": 0.17334580884064849, "mean_env_wait_ms": 0.06839295604095667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004021763801574707, "StateBufferConnector_ms": 0.002631664276123047, "ViewRequirementAgentConnector_ms": 0.08665978908538818}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.0359864552885, "num_env_steps_trained_throughput_per_sec": 521.0359864552885, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 7902.946, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7902.912, "sample_time_ms": 813.001, "learn_time_ms": 7077.508, "learn_throughput": 565.171, "synch_weights_time_ms": 11.809}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 90, "trial_id": "fa423_00000", "date": "2024-08-10_11-10-55", "timestamp": 1723302655, "time_this_iter_s": 7.682265043258667, "time_total_s": 736.7655205726624, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ba0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 736.7655205726624, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 25.900000000000002, "ram_util_percent": 77.91666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8525266407343444, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1839387460360453, "policy_loss": -0.003740829836069631, "vf_loss": 2.1876525685269996, "vf_explained_var": 0.2938239763022731, "kl": 0.009105717897241468, "entropy": 0.7174574952276926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.69013193808496, "cur_kl_coeff": 1.1587142944335941e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6098993346095085, "policy_loss": -0.0038103934275568463, "vf_loss": 3.6137097251911956, "vf_explained_var": 0.09607648241023223, "kl": 0.0035142765524126198, "entropy": 0.4568594073566298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 303.17, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 30317, "policy_reward_min": {"agent_policy": -69.547694717658, "adversary_policy": -47.449287565255695}, "policy_reward_max": {"agent_policy": 71.58892010834518, "adversary_policy": 45.94989251995874}, "policy_reward_mean": {"agent_policy": 8.961188219412103, "adversary_policy": -4.480594109706052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 54, 400, 105, 400, 400, 400, 400, 400, 400, 400, 400, 400, 263, 11, 37, 244, 400, 400, 400, 400, 400, 400, 62, 400, 400, 44, 400, 400, 400, 400, 47, 400, 400, 400, 400, 80, 24, 185, 51, 142, 71, 12, 400, 400, 27, 212, 400, 400, 400, 219, 400, 400, 114, 400, 31, 400, 400, 400, 153, 400, 34, 400, 400, 42, 400, 400, 400, 400, 400, 366, 400, 64, 77, 400, 400, 400, 264, 400, 181, 400, 400, 299, 139, 400, 400, 400, 400, 91, 400, 400, 400, 400, 90, 400, 400, 82, 400, 400], "policy_agent_policy_reward": [14.572010811364393, 20.52640314847485, -18.071817876208733, 26.91243959436597, -35.67134887443652, 38.06695623109123, 9.909682883691662, 40.37002634259957, 28.297566749112832, 0.5493671889263858, -15.918585399223073, -12.426082623842422, 21.074373578221092, -0.059489403994234635, -69.547694717658, -3.6787473511966007, -15.761703763968713, -41.80530480230577, 39.84413608337, 20.457385476534213, -2.040016281432546, 16.351652098135226, -12.465738864443882, 19.787004908017593, -22.035659074016817, -1.5226240674591907, 52.467203461023374, -19.549602926695723, 9.168215549213382, 22.858748453860528, -6.886618420591432, 22.86757915398421, -35.65876740719139, 14.707113341432311, 15.488813934500826, 12.859961011433604, 65.39650309138113, -6.339707058601357, -10.895538131044171, 3.077014880606658, -21.36852543475275, -3.2590553252277843, -39.7210537577553, 1.9364769698436026, 18.4396948548251, 32.652290986586735, -12.493346471099262, -15.930558719756537, 2.949224093554534, 15.613863355879367, 60.999661395902315, -2.4712281313417233, 19.061874562656897, 22.899170460376638, -8.915244472464035, 71.58892010834518, -8.934450811354399, 57.30317336575733, 35.0011681865005, 3.1849662935150036, -7.386730930784607, 62.652653423878796, 1.8243244695069984, 65.18689712488833, 25.788950537125935, 3.9124804151627726, 2.019808960731666, 22.351490882737764, -9.29211433334979, -6.0227347277171255, 30.594979986175936, -2.426039041796326, 15.646784614046737, -11.497097579793412, -22.402494590697835, 0.21491005351703052, 42.00323201032879, 17.531021113935438, -17.988369901808923, -6.678160925718323, 2.244672854934082, 9.982873663972113, 48.98319500464358, -22.237899799673595, -5.770781015422637, 17.506051944526234, 23.014691578576596, 39.24917086244131, -6.0366880713287685, -1.269597435544398, -53.94821355431644, 30.652909098695986, 26.013853984526207, 40.69205631298757, -13.382004959980161, 56.277143232684324, 13.467186290119848, -2.362900893373917, 46.491790723655846, 26.705388121694774], "policy_adversary_policy_reward": [-8.400049833869375, -6.171960977495019, -4.446074076254589, -16.08032907222026, 8.574947747647258, 9.496870128561477, -7.22345785401302, -19.68898174035295, -9.193475075956748, 44.86482395039327, -47.449287565255695, 9.382331334164455, -5.378863408899267, -4.530819474792395, -11.562723685105707, -28.80730265749387, 15.536775550523188, -43.83434229963603, 17.92271318111384, -18.472080370040224, 13.670746802027182, 2.2478385971958907, -4.376701933047805, 16.802784556890227, -14.338566595182144, -6.735806983038948, -2.099478871155611, 2.158968275149846, 40.537240544483396, 29.010454173174605, -9.00819091650343, 12.68693826770003, 31.296740602402636, -15.535036838433921, 21.43259108282244, 20.37271371948333, -32.86986824903546, -6.974267834334526, -8.119315220616997, -12.338070255917216, -3.456382913613691, 5.496399195046237, 21.237458003556107, -37.589110101691325, 11.152668688547646, 1.313070175896236, -1.1792456635958786, -18.607759244421715, 9.887447724476665, 12.14821134954015, -3.218420577992269, 4.74104464545146, -28.709729634009943, -23.757473827013417, 6.981481334788981, 12.568121591906733, 14.515487933037553, -23.683703482250934, -22.896088234143477, 0.03733978028294871, -1.1880284910666212, 8.074646911658057, -11.893886567720507, -10.973692586263702, 9.077668800430049, 26.58109860676134, -12.515949951879175, -2.191163389553136, -7.546269221455482, -7.9425447130453435, -7.854142655846488, -5.005818355587117, -28.832279697079, -36.564223394302125, -8.113563471011158, 14.453270529612514, -1.0712150835623948, 11.966753214606566, 20.011747665945762, -23.08876254655242, -0.7943094691743422, 22.162834903927095, 28.334488475613064, -25.075433150385283, 18.39356075286477, 21.32749300489053, -7.338568133199612, 5.402091163356008, -3.2251449452215013, -15.214549909603598, -18.270907320811915, -14.38138366577482, 24.580273216133776, -12.086926745034518, 22.898306065668777, -6.96774734591224, -4.850294014103753, 1.9010699205492188, -30.56655848813663, 14.95269513225727, -32.37460685994804, -28.62505453595428, 30.101603579439086, -27.630375448097364, -23.493861135431285, 4.431986572774388, -12.82931825683847, -10.069852203538169, -11.222455238645239, 20.137699711109274, -37.21393329175695, -34.37498681658832, -6.602953195515603, 15.537404006869998, -28.440353980198655, -28.862819385558662, -24.094748984017535, -10.906419202482965, -11.36578660625284, 8.180820312737836, -27.018196502854394, 34.404927433639, -30.480794640502587, -32.17185878337621, -8.860587913554536, 7.036263444047537, -24.61673185425418, -40.57016527063416, -13.780960243356303, -12.007990293769637, 15.473943410489728, -19.3864238256525, -22.52938363233848, 20.509574671606813, -10.622907593746763, -11.728583288990997, 12.025309177386518, -2.7331948440367277, 18.961533271338457, -12.938798543621331, -22.641106964404848, -7.953873021771088, 23.178047896357086, -20.752008854560763, -13.454266693211117, -2.19251792083562, -12.547350374525571, 24.044447954318983, 0.7483076521017864, 21.654186938596048, -1.6851351924026758, 1.4702251388856453, -31.32753034079662, -10.675701669532163, -3.797517086108966, -13.733504027826474, -15.506021121101625, 33.49439102291055, 7.531401681444422, -0.8532407557260981, -33.58273741651311, 31.33806456157903, 7.764290876434769, -17.74716454040688, -5.650331121243173, -43.33286388340042, 45.94989251995874, -23.71199272028514, 33.633125812840696, -27.862344797418057, -8.020116496703842, -9.485935447822392, -5.359224225179381, -17.655467353397214, -24.10233891944483, -15.146831942996478, 18.74123840196527, -12.7045503306365, -20.347550756859178, 21.617148192403576, 40.09063581133473, 13.857577742981722, -25.46278613163343, -5.190122967062557, 12.408282998701317, -38.422136983227524, -3.0858433737849396, -37.60621293920263, 39.42314841907525, -26.04114345909508, -37.11632291331631, -19.160820319368014, -7.8256743777801105, -5.6415119123397375, -8.637478922627267, 11.000379816001184, -35.84106609225252, -10.650724631403337, -14.74944301247185, -11.955945109222924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027222393789775, "mean_inference_ms": 1.0426974941262306, "mean_action_processing_ms": 0.17334758338858872, "mean_env_wait_ms": 0.06840192940640426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733038902282715, "StateBufferConnector_ms": 0.0032678842544555664, "ViewRequirementAgentConnector_ms": 0.07965075969696045}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.3923884258442, "num_env_steps_trained_throughput_per_sec": 507.3923884258442, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 7892.84, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7892.807, "sample_time_ms": 799.194, "learn_time_ms": 7080.969, "learn_throughput": 564.894, "synch_weights_time_ms": 12.109}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "training_iteration": 91, "trial_id": "fa423_00000", "date": "2024-08-10_11-11-04", "timestamp": 1723302664, "time_this_iter_s": 7.889750003814697, "time_total_s": 744.655270576477, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ba310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 744.655270576477, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 24.309090909090912, "ram_util_percent": 77.75454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2127877428102747, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6186107299315236, "policy_loss": -0.0041095638864491356, "vf_loss": 2.6226997216542562, "vf_explained_var": 0.33698414810120114, "kl": 0.0069364188093364795, "entropy": 0.6156425031404646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5783042003090184, "cur_kl_coeff": 5.793571472167971e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.115452501922846, "policy_loss": -0.0006918386968512399, "vf_loss": 4.116144332786401, "vf_explained_var": -0.0085117078696688, "kl": 0.002181265767749944, "entropy": 0.3695449821340541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 299.85, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 29985, "policy_reward_min": {"agent_policy": -69.547694717658, "adversary_policy": -43.33286388340042}, "policy_reward_max": {"agent_policy": 71.58892010834518, "adversary_policy": 45.94989251995874}, "policy_reward_mean": {"agent_policy": 9.879846285116653, "adversary_policy": -4.939923142558326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [263, 11, 37, 244, 400, 400, 400, 400, 400, 400, 62, 400, 400, 44, 400, 400, 400, 400, 47, 400, 400, 400, 400, 80, 24, 185, 51, 142, 71, 12, 400, 400, 27, 212, 400, 400, 400, 219, 400, 400, 114, 400, 31, 400, 400, 400, 153, 400, 34, 400, 400, 42, 400, 400, 400, 400, 400, 366, 400, 64, 77, 400, 400, 400, 264, 400, 181, 400, 400, 299, 139, 400, 400, 400, 400, 91, 400, 400, 400, 400, 90, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 310, 400, 400, 400, 221, 400, 76, 20], "policy_agent_policy_reward": [-69.547694717658, -3.6787473511966007, -15.761703763968713, -41.80530480230577, 39.84413608337, 20.457385476534213, -2.040016281432546, 16.351652098135226, -12.465738864443882, 19.787004908017593, -22.035659074016817, -1.5226240674591907, 52.467203461023374, -19.549602926695723, 9.168215549213382, 22.858748453860528, -6.886618420591432, 22.86757915398421, -35.65876740719139, 14.707113341432311, 15.488813934500826, 12.859961011433604, 65.39650309138113, -6.339707058601357, -10.895538131044171, 3.077014880606658, -21.36852543475275, -3.2590553252277843, -39.7210537577553, 1.9364769698436026, 18.4396948548251, 32.652290986586735, -12.493346471099262, -15.930558719756537, 2.949224093554534, 15.613863355879367, 60.999661395902315, -2.4712281313417233, 19.061874562656897, 22.899170460376638, -8.915244472464035, 71.58892010834518, -8.934450811354399, 57.30317336575733, 35.0011681865005, 3.1849662935150036, -7.386730930784607, 62.652653423878796, 1.8243244695069984, 65.18689712488833, 25.788950537125935, 3.9124804151627726, 2.019808960731666, 22.351490882737764, -9.29211433334979, -6.0227347277171255, 30.594979986175936, -2.426039041796326, 15.646784614046737, -11.497097579793412, -22.402494590697835, 0.21491005351703052, 42.00323201032879, 17.531021113935438, -17.988369901808923, -6.678160925718323, 2.244672854934082, 9.982873663972113, 48.98319500464358, -22.237899799673595, -5.770781015422637, 17.506051944526234, 23.014691578576596, 39.24917086244131, -6.0366880713287685, -1.269597435544398, -53.94821355431644, 30.652909098695986, 26.013853984526207, 40.69205631298757, -13.382004959980161, 56.277143232684324, 13.467186290119848, -2.362900893373917, 46.491790723655846, 26.705388121694774, -13.762747527373847, 57.47603181889474, 38.03152632734535, 20.738347049508707, 60.6240107730095, 28.91683807116637, -0.16385531921713792, 29.165052139129088, 0.9334832858228737, 51.7880007312244, -5.457351170046071, -3.7076156473941992, -58.77592758180771, 4.191515970335974], "policy_adversary_policy_reward": [40.537240544483396, 29.010454173174605, -9.00819091650343, 12.68693826770003, 31.296740602402636, -15.535036838433921, 21.43259108282244, 20.37271371948333, -32.86986824903546, -6.974267834334526, -8.119315220616997, -12.338070255917216, -3.456382913613691, 5.496399195046237, 21.237458003556107, -37.589110101691325, 11.152668688547646, 1.313070175896236, -1.1792456635958786, -18.607759244421715, 9.887447724476665, 12.14821134954015, -3.218420577992269, 4.74104464545146, -28.709729634009943, -23.757473827013417, 6.981481334788981, 12.568121591906733, 14.515487933037553, -23.683703482250934, -22.896088234143477, 0.03733978028294871, -1.1880284910666212, 8.074646911658057, -11.893886567720507, -10.973692586263702, 9.077668800430049, 26.58109860676134, -12.515949951879175, -2.191163389553136, -7.546269221455482, -7.9425447130453435, -7.854142655846488, -5.005818355587117, -28.832279697079, -36.564223394302125, -8.113563471011158, 14.453270529612514, -1.0712150835623948, 11.966753214606566, 20.011747665945762, -23.08876254655242, -0.7943094691743422, 22.162834903927095, 28.334488475613064, -25.075433150385283, 18.39356075286477, 21.32749300489053, -7.338568133199612, 5.402091163356008, -3.2251449452215013, -15.214549909603598, -18.270907320811915, -14.38138366577482, 24.580273216133776, -12.086926745034518, 22.898306065668777, -6.96774734591224, -4.850294014103753, 1.9010699205492188, -30.56655848813663, 14.95269513225727, -32.37460685994804, -28.62505453595428, 30.101603579439086, -27.630375448097364, -23.493861135431285, 4.431986572774388, -12.82931825683847, -10.069852203538169, -11.222455238645239, 20.137699711109274, -37.21393329175695, -34.37498681658832, -6.602953195515603, 15.537404006869998, -28.440353980198655, -28.862819385558662, -24.094748984017535, -10.906419202482965, -11.36578660625284, 8.180820312737836, -27.018196502854394, 34.404927433639, -30.480794640502587, -32.17185878337621, -8.860587913554536, 7.036263444047537, -24.61673185425418, -40.57016527063416, -13.780960243356303, -12.007990293769637, 15.473943410489728, -19.3864238256525, -22.52938363233848, 20.509574671606813, -10.622907593746763, -11.728583288990997, 12.025309177386518, -2.7331948440367277, 18.961533271338457, -12.938798543621331, -22.641106964404848, -7.953873021771088, 23.178047896357086, -20.752008854560763, -13.454266693211117, -2.19251792083562, -12.547350374525571, 24.044447954318983, 0.7483076521017864, 21.654186938596048, -1.6851351924026758, 1.4702251388856453, -31.32753034079662, -10.675701669532163, -3.797517086108966, -13.733504027826474, -15.506021121101625, 33.49439102291055, 7.531401681444422, -0.8532407557260981, -33.58273741651311, 31.33806456157903, 7.764290876434769, -17.74716454040688, -5.650331121243173, -43.33286388340042, 45.94989251995874, -23.71199272028514, 33.633125812840696, -27.862344797418057, -8.020116496703842, -9.485935447822392, -5.359224225179381, -17.655467353397214, -24.10233891944483, -15.146831942996478, 18.74123840196527, -12.7045503306365, -20.347550756859178, 21.617148192403576, 40.09063581133473, 13.857577742981722, -25.46278613163343, -5.190122967062557, 12.408282998701317, -38.422136983227524, -3.0858433737849396, -37.60621293920263, 39.42314841907525, -26.04114345909508, -37.11632291331631, -19.160820319368014, -7.8256743777801105, -5.6415119123397375, -8.637478922627267, 11.000379816001184, -35.84106609225252, -10.650724631403337, -14.74944301247185, -11.955945109222924, 9.085888343166552, 4.676859184207295, -29.193155968323936, -28.2828758505708, -16.629326207524656, -21.402200119820705, -20.31802044426561, -0.4203266052430976, -33.40490205219177, -27.21910872081772, -15.823894658753227, -13.092943412413145, -15.957041735845543, 16.120897055062684, -12.33933186046157, -16.825720278667514, 1.4423338339794896, -2.375817119802363, -25.583207980395674, -26.204792750828723, 25.057138548469815, -19.59978737842375, 9.028965897439342, -5.321350250045143, 40.1777873541229, 18.598140227684816, -11.332387236780942, 7.140871266444967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40260857641569436, "mean_inference_ms": 1.0421298242666506, "mean_action_processing_ms": 0.1731591259812438, "mean_env_wait_ms": 0.06840151887357351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511786460876465, "StateBufferConnector_ms": 0.0032309293746948242, "ViewRequirementAgentConnector_ms": 0.07480883598327637}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.9834202754302, "num_env_steps_trained_throughput_per_sec": 496.9834202754302, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 7916.965, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7916.932, "sample_time_ms": 800.325, "learn_time_ms": 7103.935, "learn_throughput": 563.068, "synch_weights_time_ms": 12.168}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 92, "trial_id": "fa423_00000", "date": "2024-08-10_11-11-12", "timestamp": 1723302672, "time_this_iter_s": 8.055924892425537, "time_total_s": 752.7111954689026, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a721b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 752.7111954689026, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 24.425, "ram_util_percent": 77.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9640878296718394, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.411225546100152, "policy_loss": -0.0049485579222963046, "vf_loss": 2.416156356044547, "vf_explained_var": 0.1797298067461246, "kl": 0.005987543742078261, "entropy": 0.6369383876916592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2442901849746706, "cur_kl_coeff": 2.8967857360839853e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.500387467443943, "policy_loss": 0.00014881825942817764, "vf_loss": 3.500238638371229, "vf_explained_var": 0.05552978124469519, "kl": 0.0012265876711462897, "entropy": 0.2903398095164448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 299.22, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 29922, "policy_reward_min": {"agent_policy": -58.77592758180771, "adversary_policy": -43.33286388340042}, "policy_reward_max": {"agent_policy": 71.58892010834518, "adversary_policy": 45.94989251995874}, "policy_reward_mean": {"agent_policy": 9.474664347519537, "adversary_policy": -4.737332173759768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 47, 400, 400, 400, 400, 80, 24, 185, 51, 142, 71, 12, 400, 400, 27, 212, 400, 400, 400, 219, 400, 400, 114, 400, 31, 400, 400, 400, 153, 400, 34, 400, 400, 42, 400, 400, 400, 400, 400, 366, 400, 64, 77, 400, 400, 400, 264, 400, 181, 400, 400, 299, 139, 400, 400, 400, 400, 91, 400, 400, 400, 400, 90, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 310, 400, 400, 400, 221, 400, 76, 20, 400, 47, 400, 400, 400, 400, 400, 400, 400, 48, 7, 400, 81, 400, 15], "policy_agent_policy_reward": [22.858748453860528, -6.886618420591432, 22.86757915398421, -35.65876740719139, 14.707113341432311, 15.488813934500826, 12.859961011433604, 65.39650309138113, -6.339707058601357, -10.895538131044171, 3.077014880606658, -21.36852543475275, -3.2590553252277843, -39.7210537577553, 1.9364769698436026, 18.4396948548251, 32.652290986586735, -12.493346471099262, -15.930558719756537, 2.949224093554534, 15.613863355879367, 60.999661395902315, -2.4712281313417233, 19.061874562656897, 22.899170460376638, -8.915244472464035, 71.58892010834518, -8.934450811354399, 57.30317336575733, 35.0011681865005, 3.1849662935150036, -7.386730930784607, 62.652653423878796, 1.8243244695069984, 65.18689712488833, 25.788950537125935, 3.9124804151627726, 2.019808960731666, 22.351490882737764, -9.29211433334979, -6.0227347277171255, 30.594979986175936, -2.426039041796326, 15.646784614046737, -11.497097579793412, -22.402494590697835, 0.21491005351703052, 42.00323201032879, 17.531021113935438, -17.988369901808923, -6.678160925718323, 2.244672854934082, 9.982873663972113, 48.98319500464358, -22.237899799673595, -5.770781015422637, 17.506051944526234, 23.014691578576596, 39.24917086244131, -6.0366880713287685, -1.269597435544398, -53.94821355431644, 30.652909098695986, 26.013853984526207, 40.69205631298757, -13.382004959980161, 56.277143232684324, 13.467186290119848, -2.362900893373917, 46.491790723655846, 26.705388121694774, -13.762747527373847, 57.47603181889474, 38.03152632734535, 20.738347049508707, 60.6240107730095, 28.91683807116637, -0.16385531921713792, 29.165052139129088, 0.9334832858228737, 51.7880007312244, -5.457351170046071, -3.7076156473941992, -58.77592758180771, 4.191515970335974, -24.254250038600265, -21.01553480980889, -11.363149299768807, 3.739994044065888, 18.654214838902952, 0.3634176823688602, -15.772369692395603, 28.955369159954913, -20.283145716270603, -19.438454696016258, -6.019502740153552, 13.425209111439706, -22.75611062414457, 18.65961992705715, -13.744995179226159], "policy_adversary_policy_reward": [-22.896088234143477, 0.03733978028294871, -1.1880284910666212, 8.074646911658057, -11.893886567720507, -10.973692586263702, 9.077668800430049, 26.58109860676134, -12.515949951879175, -2.191163389553136, -7.546269221455482, -7.9425447130453435, -7.854142655846488, -5.005818355587117, -28.832279697079, -36.564223394302125, -8.113563471011158, 14.453270529612514, -1.0712150835623948, 11.966753214606566, 20.011747665945762, -23.08876254655242, -0.7943094691743422, 22.162834903927095, 28.334488475613064, -25.075433150385283, 18.39356075286477, 21.32749300489053, -7.338568133199612, 5.402091163356008, -3.2251449452215013, -15.214549909603598, -18.270907320811915, -14.38138366577482, 24.580273216133776, -12.086926745034518, 22.898306065668777, -6.96774734591224, -4.850294014103753, 1.9010699205492188, -30.56655848813663, 14.95269513225727, -32.37460685994804, -28.62505453595428, 30.101603579439086, -27.630375448097364, -23.493861135431285, 4.431986572774388, -12.82931825683847, -10.069852203538169, -11.222455238645239, 20.137699711109274, -37.21393329175695, -34.37498681658832, -6.602953195515603, 15.537404006869998, -28.440353980198655, -28.862819385558662, -24.094748984017535, -10.906419202482965, -11.36578660625284, 8.180820312737836, -27.018196502854394, 34.404927433639, -30.480794640502587, -32.17185878337621, -8.860587913554536, 7.036263444047537, -24.61673185425418, -40.57016527063416, -13.780960243356303, -12.007990293769637, 15.473943410489728, -19.3864238256525, -22.52938363233848, 20.509574671606813, -10.622907593746763, -11.728583288990997, 12.025309177386518, -2.7331948440367277, 18.961533271338457, -12.938798543621331, -22.641106964404848, -7.953873021771088, 23.178047896357086, -20.752008854560763, -13.454266693211117, -2.19251792083562, -12.547350374525571, 24.044447954318983, 0.7483076521017864, 21.654186938596048, -1.6851351924026758, 1.4702251388856453, -31.32753034079662, -10.675701669532163, -3.797517086108966, -13.733504027826474, -15.506021121101625, 33.49439102291055, 7.531401681444422, -0.8532407557260981, -33.58273741651311, 31.33806456157903, 7.764290876434769, -17.74716454040688, -5.650331121243173, -43.33286388340042, 45.94989251995874, -23.71199272028514, 33.633125812840696, -27.862344797418057, -8.020116496703842, -9.485935447822392, -5.359224225179381, -17.655467353397214, -24.10233891944483, -15.146831942996478, 18.74123840196527, -12.7045503306365, -20.347550756859178, 21.617148192403576, 40.09063581133473, 13.857577742981722, -25.46278613163343, -5.190122967062557, 12.408282998701317, -38.422136983227524, -3.0858433737849396, -37.60621293920263, 39.42314841907525, -26.04114345909508, -37.11632291331631, -19.160820319368014, -7.8256743777801105, -5.6415119123397375, -8.637478922627267, 11.000379816001184, -35.84106609225252, -10.650724631403337, -14.74944301247185, -11.955945109222924, 9.085888343166552, 4.676859184207295, -29.193155968323936, -28.2828758505708, -16.629326207524656, -21.402200119820705, -20.31802044426561, -0.4203266052430976, -33.40490205219177, -27.21910872081772, -15.823894658753227, -13.092943412413145, -15.957041735845543, 16.120897055062684, -12.33933186046157, -16.825720278667514, 1.4423338339794896, -2.375817119802363, -25.583207980395674, -26.204792750828723, 25.057138548469815, -19.59978737842375, 9.028965897439342, -5.321350250045143, 40.1777873541229, 18.598140227684816, -11.332387236780942, 7.140871266444967, 14.025305366079895, 10.22894467252037, -10.630641227932237, 31.646176037741128, 16.161934352656463, -4.798785052887656, -0.2839282240484451, -3.456065820017443, 12.221587516571246, -30.8758023554742, 8.943803472917544, -9.307221155286404, -3.5391954100724377, 19.31156510246804, -8.808514014534381, -20.14685514542053, 10.699241592228834, 9.583904124041773, 21.07769805078703, -1.6392433547707768, 3.936884503066131, 2.08261823708742, -11.529232017560027, -1.8959770938796794, -2.854464592493887, 25.610575216638455, -26.768268565675584, 8.108648638618416, 7.4693498345365095, 6.27564534468965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.402554710978923, "mean_inference_ms": 1.0417282907636725, "mean_action_processing_ms": 0.1731307798196691, "mean_env_wait_ms": 0.06837828540716932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036263465881347656, "StateBufferConnector_ms": 0.003255128860473633, "ViewRequirementAgentConnector_ms": 0.07472002506256104}, "num_episodes": 15, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.5391431455358, "num_env_steps_trained_throughput_per_sec": 491.5391431455358, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 7946.643, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7946.61, "sample_time_ms": 803.33, "learn_time_ms": 7130.596, "learn_throughput": 560.963, "synch_weights_time_ms": 12.181}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "training_iteration": 93, "trial_id": "fa423_00000", "date": "2024-08-10_11-11-20", "timestamp": 1723302680, "time_this_iter_s": 8.142602920532227, "time_total_s": 760.8537983894348, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ba700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 760.8537983894348, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 25.090909090909086, "ram_util_percent": 77.24545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8868053742186732, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3685124597221456, "policy_loss": -0.005573167387277834, "vf_loss": 2.3740624945630473, "vf_explained_var": 0.10320025430154547, "kl": 0.007800086133285115, "entropy": 0.6786242623808523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6435944521178802, "cur_kl_coeff": 1.4483928680419927e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.293919193247954, "policy_loss": -0.0007014112755617438, "vf_loss": 3.294620610028505, "vf_explained_var": 0.2013285944859187, "kl": 0.004623907998642361, "entropy": 0.3979708280103902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 302.77, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 30277, "policy_reward_min": {"agent_policy": -58.77592758180771, "adversary_policy": -43.33286388340042}, "policy_reward_max": {"agent_policy": 71.58892010834518, "adversary_policy": 45.94989251995874}, "policy_reward_mean": {"agent_policy": 9.129320077151057, "adversary_policy": -4.564660038575529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [24, 185, 51, 142, 71, 12, 400, 400, 27, 212, 400, 400, 400, 219, 400, 400, 114, 400, 31, 400, 400, 400, 153, 400, 34, 400, 400, 42, 400, 400, 400, 400, 400, 366, 400, 64, 77, 400, 400, 400, 264, 400, 181, 400, 400, 299, 139, 400, 400, 400, 400, 91, 400, 400, 400, 400, 90, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 310, 400, 400, 400, 221, 400, 76, 20, 400, 47, 400, 400, 400, 400, 400, 400, 400, 48, 7, 400, 81, 400, 15, 400, 400, 400, 400, 400, 82, 400, 400, 400], "policy_agent_policy_reward": [-10.895538131044171, 3.077014880606658, -21.36852543475275, -3.2590553252277843, -39.7210537577553, 1.9364769698436026, 18.4396948548251, 32.652290986586735, -12.493346471099262, -15.930558719756537, 2.949224093554534, 15.613863355879367, 60.999661395902315, -2.4712281313417233, 19.061874562656897, 22.899170460376638, -8.915244472464035, 71.58892010834518, -8.934450811354399, 57.30317336575733, 35.0011681865005, 3.1849662935150036, -7.386730930784607, 62.652653423878796, 1.8243244695069984, 65.18689712488833, 25.788950537125935, 3.9124804151627726, 2.019808960731666, 22.351490882737764, -9.29211433334979, -6.0227347277171255, 30.594979986175936, -2.426039041796326, 15.646784614046737, -11.497097579793412, -22.402494590697835, 0.21491005351703052, 42.00323201032879, 17.531021113935438, -17.988369901808923, -6.678160925718323, 2.244672854934082, 9.982873663972113, 48.98319500464358, -22.237899799673595, -5.770781015422637, 17.506051944526234, 23.014691578576596, 39.24917086244131, -6.0366880713287685, -1.269597435544398, -53.94821355431644, 30.652909098695986, 26.013853984526207, 40.69205631298757, -13.382004959980161, 56.277143232684324, 13.467186290119848, -2.362900893373917, 46.491790723655846, 26.705388121694774, -13.762747527373847, 57.47603181889474, 38.03152632734535, 20.738347049508707, 60.6240107730095, 28.91683807116637, -0.16385531921713792, 29.165052139129088, 0.9334832858228737, 51.7880007312244, -5.457351170046071, -3.7076156473941992, -58.77592758180771, 4.191515970335974, -24.254250038600265, -21.01553480980889, -11.363149299768807, 3.739994044065888, 18.654214838902952, 0.3634176823688602, -15.772369692395603, 28.955369159954913, -20.283145716270603, -19.438454696016258, -6.019502740153552, 13.425209111439706, -22.75611062414457, 18.65961992705715, -13.744995179226159, 28.836385532322314, 20.076204531675, -17.674327923171447, 18.27622127530862, 24.47901137352889, -28.08576148631054, 9.350380393143677, 7.062843750734714, 8.438241616129432], "policy_adversary_policy_reward": [-1.0712150835623948, 11.966753214606566, 20.011747665945762, -23.08876254655242, -0.7943094691743422, 22.162834903927095, 28.334488475613064, -25.075433150385283, 18.39356075286477, 21.32749300489053, -7.338568133199612, 5.402091163356008, -3.2251449452215013, -15.214549909603598, -18.270907320811915, -14.38138366577482, 24.580273216133776, -12.086926745034518, 22.898306065668777, -6.96774734591224, -4.850294014103753, 1.9010699205492188, -30.56655848813663, 14.95269513225727, -32.37460685994804, -28.62505453595428, 30.101603579439086, -27.630375448097364, -23.493861135431285, 4.431986572774388, -12.82931825683847, -10.069852203538169, -11.222455238645239, 20.137699711109274, -37.21393329175695, -34.37498681658832, -6.602953195515603, 15.537404006869998, -28.440353980198655, -28.862819385558662, -24.094748984017535, -10.906419202482965, -11.36578660625284, 8.180820312737836, -27.018196502854394, 34.404927433639, -30.480794640502587, -32.17185878337621, -8.860587913554536, 7.036263444047537, -24.61673185425418, -40.57016527063416, -13.780960243356303, -12.007990293769637, 15.473943410489728, -19.3864238256525, -22.52938363233848, 20.509574671606813, -10.622907593746763, -11.728583288990997, 12.025309177386518, -2.7331948440367277, 18.961533271338457, -12.938798543621331, -22.641106964404848, -7.953873021771088, 23.178047896357086, -20.752008854560763, -13.454266693211117, -2.19251792083562, -12.547350374525571, 24.044447954318983, 0.7483076521017864, 21.654186938596048, -1.6851351924026758, 1.4702251388856453, -31.32753034079662, -10.675701669532163, -3.797517086108966, -13.733504027826474, -15.506021121101625, 33.49439102291055, 7.531401681444422, -0.8532407557260981, -33.58273741651311, 31.33806456157903, 7.764290876434769, -17.74716454040688, -5.650331121243173, -43.33286388340042, 45.94989251995874, -23.71199272028514, 33.633125812840696, -27.862344797418057, -8.020116496703842, -9.485935447822392, -5.359224225179381, -17.655467353397214, -24.10233891944483, -15.146831942996478, 18.74123840196527, -12.7045503306365, -20.347550756859178, 21.617148192403576, 40.09063581133473, 13.857577742981722, -25.46278613163343, -5.190122967062557, 12.408282998701317, -38.422136983227524, -3.0858433737849396, -37.60621293920263, 39.42314841907525, -26.04114345909508, -37.11632291331631, -19.160820319368014, -7.8256743777801105, -5.6415119123397375, -8.637478922627267, 11.000379816001184, -35.84106609225252, -10.650724631403337, -14.74944301247185, -11.955945109222924, 9.085888343166552, 4.676859184207295, -29.193155968323936, -28.2828758505708, -16.629326207524656, -21.402200119820705, -20.31802044426561, -0.4203266052430976, -33.40490205219177, -27.21910872081772, -15.823894658753227, -13.092943412413145, -15.957041735845543, 16.120897055062684, -12.33933186046157, -16.825720278667514, 1.4423338339794896, -2.375817119802363, -25.583207980395674, -26.204792750828723, 25.057138548469815, -19.59978737842375, 9.028965897439342, -5.321350250045143, 40.1777873541229, 18.598140227684816, -11.332387236780942, 7.140871266444967, 14.025305366079895, 10.22894467252037, -10.630641227932237, 31.646176037741128, 16.161934352656463, -4.798785052887656, -0.2839282240484451, -3.456065820017443, 12.221587516571246, -30.8758023554742, 8.943803472917544, -9.307221155286404, -3.5391954100724377, 19.31156510246804, -8.808514014534381, -20.14685514542053, 10.699241592228834, 9.583904124041773, 21.07769805078703, -1.6392433547707768, 3.936884503066131, 2.08261823708742, -11.529232017560027, -1.8959770938796794, -2.854464592493887, 25.610575216638455, -26.768268565675584, 8.108648638618416, 7.4693498345365095, 6.27564534468965, -16.67534702376455, -12.161038508557784, -21.630732903260878, 1.5545283715858726, 17.580904240755956, 0.09342368241549082, -12.977732766445534, -5.2984885088630875, -14.086430071974469, -10.392581301554422, 11.816353857563183, 16.269407628747352, -7.6523821517152975, -1.6979982414283796, -7.17908861539933, 0.11624486466461548, -12.652538079008629, 4.214296462879197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024988813988596, "mean_inference_ms": 1.0415222409822251, "mean_action_processing_ms": 0.17316111271560036, "mean_env_wait_ms": 0.06833085044644766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036035776138305664, "StateBufferConnector_ms": 0.003239750862121582, "ViewRequirementAgentConnector_ms": 0.07418680191040039}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.5664932807764, "num_env_steps_trained_throughput_per_sec": 508.5664932807764, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 7887.825, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7887.792, "sample_time_ms": 765.627, "learn_time_ms": 7109.529, "learn_throughput": 562.625, "synch_weights_time_ms": 12.145}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 94, "trial_id": "fa423_00000", "date": "2024-08-10_11-11-28", "timestamp": 1723302688, "time_this_iter_s": 7.870881080627441, "time_total_s": 768.7246794700623, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ba940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 768.7246794700623, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.558333333333334, "ram_util_percent": 77.31666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.785926043955737, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1754566689647694, "policy_loss": -0.0007657543493671314, "vf_loss": 2.1762047182315243, "vf_explained_var": 0.04384873515714413, "kl": 0.005968436377236161, "entropy": 0.596245550667798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.781533703394234, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.422798527777195, "policy_loss": -0.006008390208201793, "vf_loss": 3.428806901971499, "vf_explained_var": -0.36202083236227434, "kl": 0.011921467000012006, "entropy": 0.43322848140572506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 317.52, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 31752, "policy_reward_min": {"agent_policy": -58.77592758180771, "adversary_policy": -43.33286388340042}, "policy_reward_max": {"agent_policy": 71.58892010834518, "adversary_policy": 45.94989251995874}, "policy_reward_mean": {"agent_policy": 10.550357377547503, "adversary_policy": -5.275178688773751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 114, 400, 31, 400, 400, 400, 153, 400, 34, 400, 400, 42, 400, 400, 400, 400, 400, 366, 400, 64, 77, 400, 400, 400, 264, 400, 181, 400, 400, 299, 139, 400, 400, 400, 400, 91, 400, 400, 400, 400, 90, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 310, 400, 400, 400, 221, 400, 76, 20, 400, 47, 400, 400, 400, 400, 400, 400, 400, 48, 7, 400, 81, 400, 15, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 138, 88, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 92], "policy_agent_policy_reward": [19.061874562656897, 22.899170460376638, -8.915244472464035, 71.58892010834518, -8.934450811354399, 57.30317336575733, 35.0011681865005, 3.1849662935150036, -7.386730930784607, 62.652653423878796, 1.8243244695069984, 65.18689712488833, 25.788950537125935, 3.9124804151627726, 2.019808960731666, 22.351490882737764, -9.29211433334979, -6.0227347277171255, 30.594979986175936, -2.426039041796326, 15.646784614046737, -11.497097579793412, -22.402494590697835, 0.21491005351703052, 42.00323201032879, 17.531021113935438, -17.988369901808923, -6.678160925718323, 2.244672854934082, 9.982873663972113, 48.98319500464358, -22.237899799673595, -5.770781015422637, 17.506051944526234, 23.014691578576596, 39.24917086244131, -6.0366880713287685, -1.269597435544398, -53.94821355431644, 30.652909098695986, 26.013853984526207, 40.69205631298757, -13.382004959980161, 56.277143232684324, 13.467186290119848, -2.362900893373917, 46.491790723655846, 26.705388121694774, -13.762747527373847, 57.47603181889474, 38.03152632734535, 20.738347049508707, 60.6240107730095, 28.91683807116637, -0.16385531921713792, 29.165052139129088, 0.9334832858228737, 51.7880007312244, -5.457351170046071, -3.7076156473941992, -58.77592758180771, 4.191515970335974, -24.254250038600265, -21.01553480980889, -11.363149299768807, 3.739994044065888, 18.654214838902952, 0.3634176823688602, -15.772369692395603, 28.955369159954913, -20.283145716270603, -19.438454696016258, -6.019502740153552, 13.425209111439706, -22.75611062414457, 18.65961992705715, -13.744995179226159, 28.836385532322314, 20.076204531675, -17.674327923171447, 18.27622127530862, 24.47901137352889, -28.08576148631054, 9.350380393143677, 7.062843750734714, 8.438241616129432, 53.37037095227857, 5.876831052392685, 3.823295116233691, 21.151222412366923, -5.448223820533709, 28.29432545447265, 45.31571879773551, -31.532880289099126, 11.255273240402765, 10.669126756542585, 11.180595558993076, 3.4474675687393646, 0.5132071788724915, 13.716320626467798], "policy_adversary_policy_reward": [-23.493861135431285, 4.431986572774388, -12.82931825683847, -10.069852203538169, -11.222455238645239, 20.137699711109274, -37.21393329175695, -34.37498681658832, -6.602953195515603, 15.537404006869998, -28.440353980198655, -28.862819385558662, -24.094748984017535, -10.906419202482965, -11.36578660625284, 8.180820312737836, -27.018196502854394, 34.404927433639, -30.480794640502587, -32.17185878337621, -8.860587913554536, 7.036263444047537, -24.61673185425418, -40.57016527063416, -13.780960243356303, -12.007990293769637, 15.473943410489728, -19.3864238256525, -22.52938363233848, 20.509574671606813, -10.622907593746763, -11.728583288990997, 12.025309177386518, -2.7331948440367277, 18.961533271338457, -12.938798543621331, -22.641106964404848, -7.953873021771088, 23.178047896357086, -20.752008854560763, -13.454266693211117, -2.19251792083562, -12.547350374525571, 24.044447954318983, 0.7483076521017864, 21.654186938596048, -1.6851351924026758, 1.4702251388856453, -31.32753034079662, -10.675701669532163, -3.797517086108966, -13.733504027826474, -15.506021121101625, 33.49439102291055, 7.531401681444422, -0.8532407557260981, -33.58273741651311, 31.33806456157903, 7.764290876434769, -17.74716454040688, -5.650331121243173, -43.33286388340042, 45.94989251995874, -23.71199272028514, 33.633125812840696, -27.862344797418057, -8.020116496703842, -9.485935447822392, -5.359224225179381, -17.655467353397214, -24.10233891944483, -15.146831942996478, 18.74123840196527, -12.7045503306365, -20.347550756859178, 21.617148192403576, 40.09063581133473, 13.857577742981722, -25.46278613163343, -5.190122967062557, 12.408282998701317, -38.422136983227524, -3.0858433737849396, -37.60621293920263, 39.42314841907525, -26.04114345909508, -37.11632291331631, -19.160820319368014, -7.8256743777801105, -5.6415119123397375, -8.637478922627267, 11.000379816001184, -35.84106609225252, -10.650724631403337, -14.74944301247185, -11.955945109222924, 9.085888343166552, 4.676859184207295, -29.193155968323936, -28.2828758505708, -16.629326207524656, -21.402200119820705, -20.31802044426561, -0.4203266052430976, -33.40490205219177, -27.21910872081772, -15.823894658753227, -13.092943412413145, -15.957041735845543, 16.120897055062684, -12.33933186046157, -16.825720278667514, 1.4423338339794896, -2.375817119802363, -25.583207980395674, -26.204792750828723, 25.057138548469815, -19.59978737842375, 9.028965897439342, -5.321350250045143, 40.1777873541229, 18.598140227684816, -11.332387236780942, 7.140871266444967, 14.025305366079895, 10.22894467252037, -10.630641227932237, 31.646176037741128, 16.161934352656463, -4.798785052887656, -0.2839282240484451, -3.456065820017443, 12.221587516571246, -30.8758023554742, 8.943803472917544, -9.307221155286404, -3.5391954100724377, 19.31156510246804, -8.808514014534381, -20.14685514542053, 10.699241592228834, 9.583904124041773, 21.07769805078703, -1.6392433547707768, 3.936884503066131, 2.08261823708742, -11.529232017560027, -1.8959770938796794, -2.854464592493887, 25.610575216638455, -26.768268565675584, 8.108648638618416, 7.4693498345365095, 6.27564534468965, -16.67534702376455, -12.161038508557784, -21.630732903260878, 1.5545283715858726, 17.580904240755956, 0.09342368241549082, -12.977732766445534, -5.2984885088630875, -14.086430071974469, -10.392581301554422, 11.816353857563183, 16.269407628747352, -7.6523821517152975, -1.6979982414283796, -7.17908861539933, 0.11624486466461548, -12.652538079008629, 4.214296462879197, -22.58043346290336, -30.78993748937522, -27.880821145375574, 22.00399009298289, 12.056308339785392, -15.879603456019083, -16.961837272784994, -4.18938513958193, -1.2932871916369457, 6.741511012170655, -10.84268970516262, -17.45163574931003, -28.864071806568017, -16.45164699116749, 16.034441678013955, 15.49843861108517, -8.55102606685552, -2.7042471735472446, 4.842124783460871, -15.511251540003457, -9.229886782193681, -1.9507087767993951, -11.473501260025397, 8.026033691286033, 0.7614551265349903, -1.2746623054074817, -31.90632736533768, 18.190006738869883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40262451493316403, "mean_inference_ms": 1.0418934848834462, "mean_action_processing_ms": 0.173288084173183, "mean_env_wait_ms": 0.06832732111989807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038357973098754883, "StateBufferConnector_ms": 0.004273176193237305, "ViewRequirementAgentConnector_ms": 0.07887864112854004}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.0753854475301, "num_env_steps_trained_throughput_per_sec": 472.0753854475301, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 7955.455, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7955.422, "sample_time_ms": 797.524, "learn_time_ms": 7145.216, "learn_throughput": 559.815, "synch_weights_time_ms": 12.183}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "training_iteration": 95, "trial_id": "fa423_00000", "date": "2024-08-10_11-11-37", "timestamp": 1723302697, "time_this_iter_s": 8.479381084442139, "time_total_s": 777.2040605545044, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ba9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 777.2040605545044, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 29.316666666666663, "ram_util_percent": 77.45833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9019462385505594, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.939834426193641, "policy_loss": -0.002342970059475019, "vf_loss": 2.9421605131613515, "vf_explained_var": 0.08808516434260777, "kl": 0.005689404913765049, "entropy": 0.48324793187714127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4574412840108075, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8730689687033495, "policy_loss": -0.007960133034551594, "vf_loss": 3.8810291086634, "vf_explained_var": 0.02735317572951317, "kl": 0.017372134335022427, "entropy": 0.38862944301217794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 316.53, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 31653, "policy_reward_min": {"agent_policy": -58.77592758180771, "adversary_policy": -43.33286388340042}, "policy_reward_max": {"agent_policy": 60.6240107730095, "adversary_policy": 45.94989251995874}, "policy_reward_mean": {"agent_policy": 6.646364443516351, "adversary_policy": -3.323182221758175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [42, 400, 400, 400, 400, 400, 366, 400, 64, 77, 400, 400, 400, 264, 400, 181, 400, 400, 299, 139, 400, 400, 400, 400, 91, 400, 400, 400, 400, 90, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 310, 400, 400, 400, 221, 400, 76, 20, 400, 47, 400, 400, 400, 400, 400, 400, 400, 48, 7, 400, 81, 400, 15, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 138, 88, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 92, 400, 38, 19, 400, 400, 49, 154, 400, 400, 373, 400, 400, 400], "policy_agent_policy_reward": [3.9124804151627726, 2.019808960731666, 22.351490882737764, -9.29211433334979, -6.0227347277171255, 30.594979986175936, -2.426039041796326, 15.646784614046737, -11.497097579793412, -22.402494590697835, 0.21491005351703052, 42.00323201032879, 17.531021113935438, -17.988369901808923, -6.678160925718323, 2.244672854934082, 9.982873663972113, 48.98319500464358, -22.237899799673595, -5.770781015422637, 17.506051944526234, 23.014691578576596, 39.24917086244131, -6.0366880713287685, -1.269597435544398, -53.94821355431644, 30.652909098695986, 26.013853984526207, 40.69205631298757, -13.382004959980161, 56.277143232684324, 13.467186290119848, -2.362900893373917, 46.491790723655846, 26.705388121694774, -13.762747527373847, 57.47603181889474, 38.03152632734535, 20.738347049508707, 60.6240107730095, 28.91683807116637, -0.16385531921713792, 29.165052139129088, 0.9334832858228737, 51.7880007312244, -5.457351170046071, -3.7076156473941992, -58.77592758180771, 4.191515970335974, -24.254250038600265, -21.01553480980889, -11.363149299768807, 3.739994044065888, 18.654214838902952, 0.3634176823688602, -15.772369692395603, 28.955369159954913, -20.283145716270603, -19.438454696016258, -6.019502740153552, 13.425209111439706, -22.75611062414457, 18.65961992705715, -13.744995179226159, 28.836385532322314, 20.076204531675, -17.674327923171447, 18.27622127530862, 24.47901137352889, -28.08576148631054, 9.350380393143677, 7.062843750734714, 8.438241616129432, 53.37037095227857, 5.876831052392685, 3.823295116233691, 21.151222412366923, -5.448223820533709, 28.29432545447265, 45.31571879773551, -31.532880289099126, 11.255273240402765, 10.669126756542585, 11.180595558993076, 3.4474675687393646, 0.5132071788724915, 13.716320626467798, -9.892578708757489, -9.83350197631065, -37.100918359747524, 24.24873842895328, 2.302544988781147, -25.265919312270157, -14.754274453937704, 32.92172422599478, 21.411665186117226, -23.08128249780195, -1.5424685552442092, -39.61135932922745, 29.05400927828395], "policy_adversary_policy_reward": [15.473943410489728, -19.3864238256525, -22.52938363233848, 20.509574671606813, -10.622907593746763, -11.728583288990997, 12.025309177386518, -2.7331948440367277, 18.961533271338457, -12.938798543621331, -22.641106964404848, -7.953873021771088, 23.178047896357086, -20.752008854560763, -13.454266693211117, -2.19251792083562, -12.547350374525571, 24.044447954318983, 0.7483076521017864, 21.654186938596048, -1.6851351924026758, 1.4702251388856453, -31.32753034079662, -10.675701669532163, -3.797517086108966, -13.733504027826474, -15.506021121101625, 33.49439102291055, 7.531401681444422, -0.8532407557260981, -33.58273741651311, 31.33806456157903, 7.764290876434769, -17.74716454040688, -5.650331121243173, -43.33286388340042, 45.94989251995874, -23.71199272028514, 33.633125812840696, -27.862344797418057, -8.020116496703842, -9.485935447822392, -5.359224225179381, -17.655467353397214, -24.10233891944483, -15.146831942996478, 18.74123840196527, -12.7045503306365, -20.347550756859178, 21.617148192403576, 40.09063581133473, 13.857577742981722, -25.46278613163343, -5.190122967062557, 12.408282998701317, -38.422136983227524, -3.0858433737849396, -37.60621293920263, 39.42314841907525, -26.04114345909508, -37.11632291331631, -19.160820319368014, -7.8256743777801105, -5.6415119123397375, -8.637478922627267, 11.000379816001184, -35.84106609225252, -10.650724631403337, -14.74944301247185, -11.955945109222924, 9.085888343166552, 4.676859184207295, -29.193155968323936, -28.2828758505708, -16.629326207524656, -21.402200119820705, -20.31802044426561, -0.4203266052430976, -33.40490205219177, -27.21910872081772, -15.823894658753227, -13.092943412413145, -15.957041735845543, 16.120897055062684, -12.33933186046157, -16.825720278667514, 1.4423338339794896, -2.375817119802363, -25.583207980395674, -26.204792750828723, 25.057138548469815, -19.59978737842375, 9.028965897439342, -5.321350250045143, 40.1777873541229, 18.598140227684816, -11.332387236780942, 7.140871266444967, 14.025305366079895, 10.22894467252037, -10.630641227932237, 31.646176037741128, 16.161934352656463, -4.798785052887656, -0.2839282240484451, -3.456065820017443, 12.221587516571246, -30.8758023554742, 8.943803472917544, -9.307221155286404, -3.5391954100724377, 19.31156510246804, -8.808514014534381, -20.14685514542053, 10.699241592228834, 9.583904124041773, 21.07769805078703, -1.6392433547707768, 3.936884503066131, 2.08261823708742, -11.529232017560027, -1.8959770938796794, -2.854464592493887, 25.610575216638455, -26.768268565675584, 8.108648638618416, 7.4693498345365095, 6.27564534468965, -16.67534702376455, -12.161038508557784, -21.630732903260878, 1.5545283715858726, 17.580904240755956, 0.09342368241549082, -12.977732766445534, -5.2984885088630875, -14.086430071974469, -10.392581301554422, 11.816353857563183, 16.269407628747352, -7.6523821517152975, -1.6979982414283796, -7.17908861539933, 0.11624486466461548, -12.652538079008629, 4.214296462879197, -22.58043346290336, -30.78993748937522, -27.880821145375574, 22.00399009298289, 12.056308339785392, -15.879603456019083, -16.961837272784994, -4.18938513958193, -1.2932871916369457, 6.741511012170655, -10.84268970516262, -17.45163574931003, -28.864071806568017, -16.45164699116749, 16.034441678013955, 15.49843861108517, -8.55102606685552, -2.7042471735472446, 4.842124783460871, -15.511251540003457, -9.229886782193681, -1.9507087767993951, -11.473501260025397, 8.026033691286033, 0.7614551265349903, -1.2746623054074817, -31.90632736533768, 18.190006738869883, -4.171934544848831, 14.06451325360632, 17.187217262546937, -7.353715286236284, 19.089704141861027, 18.011214217886497, -34.8798141088828, 10.631075679929513, -5.509763948502062, 3.2072189597209153, 11.570768233623093, 13.695151078647063, -20.249995259748037, 35.004269713685744, -13.549811447186606, -19.371912778808156, -9.762635978841821, -11.649029207275404, 42.13433941193966, -19.053056914137713, -12.063514849588277, 13.605983404832486, 1.3289174073825407, 38.282441921844935, -14.953778744217086, -14.100230534066863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40263875054945863, "mean_inference_ms": 1.0426185591078518, "mean_action_processing_ms": 0.1734058309534936, "mean_env_wait_ms": 0.06833255758704387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003949999809265137, "StateBufferConnector_ms": 0.004287004470825195, "ViewRequirementAgentConnector_ms": 0.06983184814453125}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.09896257366535, "num_env_steps_trained_throughput_per_sec": 504.09896257366535, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 7959.279, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7959.247, "sample_time_ms": 804.722, "learn_time_ms": 7141.628, "learn_throughput": 560.096, "synch_weights_time_ms": 12.387}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 96, "trial_id": "fa423_00000", "date": "2024-08-10_11-11-45", "timestamp": 1723302705, "time_this_iter_s": 7.940341949462891, "time_total_s": 785.1444025039673, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72badc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 785.1444025039673, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 25.00909090909091, "ram_util_percent": 77.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3981110107646417, "cur_kl_coeff": 0.002966308593750001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7444336573913615, "policy_loss": -0.0018535901777564532, "vf_loss": 1.7462771229327672, "vf_explained_var": -0.012750601043146124, "kl": 0.0034125016117488687, "entropy": 0.4470803485818641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.052688579975317, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8933640748262404, "policy_loss": -0.002750908719220509, "vf_loss": 2.8961149733513594, "vf_explained_var": -0.332265230640769, "kl": 0.008096707500061629, "entropy": 0.3072770053210358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 304.3, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 30430, "policy_reward_min": {"agent_policy": -58.77592758180771, "adversary_policy": -47.56072280727678}, "policy_reward_max": {"agent_policy": 61.47523308414985, "adversary_policy": 45.94989251995874}, "policy_reward_mean": {"agent_policy": 7.2056642299211315, "adversary_policy": -3.6028321149605667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 299, 139, 400, 400, 400, 400, 91, 400, 400, 400, 400, 90, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 310, 400, 400, 400, 221, 400, 76, 20, 400, 47, 400, 400, 400, 400, 400, 400, 400, 48, 7, 400, 81, 400, 15, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 138, 88, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 92, 400, 38, 19, 400, 400, 49, 154, 400, 400, 373, 400, 400, 400, 400, 50, 400, 10, 400, 400, 400, 29, 400, 400, 6, 41, 72, 400, 324, 39], "policy_agent_policy_reward": [9.982873663972113, 48.98319500464358, -22.237899799673595, -5.770781015422637, 17.506051944526234, 23.014691578576596, 39.24917086244131, -6.0366880713287685, -1.269597435544398, -53.94821355431644, 30.652909098695986, 26.013853984526207, 40.69205631298757, -13.382004959980161, 56.277143232684324, 13.467186290119848, -2.362900893373917, 46.491790723655846, 26.705388121694774, -13.762747527373847, 57.47603181889474, 38.03152632734535, 20.738347049508707, 60.6240107730095, 28.91683807116637, -0.16385531921713792, 29.165052139129088, 0.9334832858228737, 51.7880007312244, -5.457351170046071, -3.7076156473941992, -58.77592758180771, 4.191515970335974, -24.254250038600265, -21.01553480980889, -11.363149299768807, 3.739994044065888, 18.654214838902952, 0.3634176823688602, -15.772369692395603, 28.955369159954913, -20.283145716270603, -19.438454696016258, -6.019502740153552, 13.425209111439706, -22.75611062414457, 18.65961992705715, -13.744995179226159, 28.836385532322314, 20.076204531675, -17.674327923171447, 18.27622127530862, 24.47901137352889, -28.08576148631054, 9.350380393143677, 7.062843750734714, 8.438241616129432, 53.37037095227857, 5.876831052392685, 3.823295116233691, 21.151222412366923, -5.448223820533709, 28.29432545447265, 45.31571879773551, -31.532880289099126, 11.255273240402765, 10.669126756542585, 11.180595558993076, 3.4474675687393646, 0.5132071788724915, 13.716320626467798, -9.892578708757489, -9.83350197631065, -37.100918359747524, 24.24873842895328, 2.302544988781147, -25.265919312270157, -14.754274453937704, 32.92172422599478, 21.411665186117226, -23.08128249780195, -1.5424685552442092, -39.61135932922745, 29.05400927828395, 45.07062142034235, -1.102860547215152, 51.275720846832755, -5.150234479414641, -1.671611902440926, 61.47523308414985, -11.648132372687574, -0.8798318913926781, 42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307], "policy_adversary_policy_reward": [7.764290876434769, -17.74716454040688, -5.650331121243173, -43.33286388340042, 45.94989251995874, -23.71199272028514, 33.633125812840696, -27.862344797418057, -8.020116496703842, -9.485935447822392, -5.359224225179381, -17.655467353397214, -24.10233891944483, -15.146831942996478, 18.74123840196527, -12.7045503306365, -20.347550756859178, 21.617148192403576, 40.09063581133473, 13.857577742981722, -25.46278613163343, -5.190122967062557, 12.408282998701317, -38.422136983227524, -3.0858433737849396, -37.60621293920263, 39.42314841907525, -26.04114345909508, -37.11632291331631, -19.160820319368014, -7.8256743777801105, -5.6415119123397375, -8.637478922627267, 11.000379816001184, -35.84106609225252, -10.650724631403337, -14.74944301247185, -11.955945109222924, 9.085888343166552, 4.676859184207295, -29.193155968323936, -28.2828758505708, -16.629326207524656, -21.402200119820705, -20.31802044426561, -0.4203266052430976, -33.40490205219177, -27.21910872081772, -15.823894658753227, -13.092943412413145, -15.957041735845543, 16.120897055062684, -12.33933186046157, -16.825720278667514, 1.4423338339794896, -2.375817119802363, -25.583207980395674, -26.204792750828723, 25.057138548469815, -19.59978737842375, 9.028965897439342, -5.321350250045143, 40.1777873541229, 18.598140227684816, -11.332387236780942, 7.140871266444967, 14.025305366079895, 10.22894467252037, -10.630641227932237, 31.646176037741128, 16.161934352656463, -4.798785052887656, -0.2839282240484451, -3.456065820017443, 12.221587516571246, -30.8758023554742, 8.943803472917544, -9.307221155286404, -3.5391954100724377, 19.31156510246804, -8.808514014534381, -20.14685514542053, 10.699241592228834, 9.583904124041773, 21.07769805078703, -1.6392433547707768, 3.936884503066131, 2.08261823708742, -11.529232017560027, -1.8959770938796794, -2.854464592493887, 25.610575216638455, -26.768268565675584, 8.108648638618416, 7.4693498345365095, 6.27564534468965, -16.67534702376455, -12.161038508557784, -21.630732903260878, 1.5545283715858726, 17.580904240755956, 0.09342368241549082, -12.977732766445534, -5.2984885088630875, -14.086430071974469, -10.392581301554422, 11.816353857563183, 16.269407628747352, -7.6523821517152975, -1.6979982414283796, -7.17908861539933, 0.11624486466461548, -12.652538079008629, 4.214296462879197, -22.58043346290336, -30.78993748937522, -27.880821145375574, 22.00399009298289, 12.056308339785392, -15.879603456019083, -16.961837272784994, -4.18938513958193, -1.2932871916369457, 6.741511012170655, -10.84268970516262, -17.45163574931003, -28.864071806568017, -16.45164699116749, 16.034441678013955, 15.49843861108517, -8.55102606685552, -2.7042471735472446, 4.842124783460871, -15.511251540003457, -9.229886782193681, -1.9507087767993951, -11.473501260025397, 8.026033691286033, 0.7614551265349903, -1.2746623054074817, -31.90632736533768, 18.190006738869883, -4.171934544848831, 14.06451325360632, 17.187217262546937, -7.353715286236284, 19.089704141861027, 18.011214217886497, -34.8798141088828, 10.631075679929513, -5.509763948502062, 3.2072189597209153, 11.570768233623093, 13.695151078647063, -20.249995259748037, 35.004269713685744, -13.549811447186606, -19.371912778808156, -9.762635978841821, -11.649029207275404, 42.13433941193966, -19.053056914137713, -12.063514849588277, 13.605983404832486, 1.3289174073825407, 38.282441921844935, -14.953778744217086, -14.100230534066863, -30.255313653718027, -14.815307766624326, -34.635964795937944, 35.738825343153096, -23.364089475397243, -27.9116313714355, 4.0831258433306115, 1.0671086360840292, 1.9865564401764217, -0.3149445377354958, -47.56072280727678, -13.914510276873067, 0.8389543188500781, 10.809178053837496, 12.958612381002759, -12.07878048961008, -22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027340774248897, "mean_inference_ms": 1.0428008880978168, "mean_action_processing_ms": 0.17325577799507655, "mean_env_wait_ms": 0.06827003409549703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038051605224609375, "StateBufferConnector_ms": 0.004279613494873047, "ViewRequirementAgentConnector_ms": 0.0695641040802002}, "num_episodes": 16, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.9734880479206, "num_env_steps_trained_throughput_per_sec": 512.9734880479206, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 7957.828, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7957.796, "sample_time_ms": 805.39, "learn_time_ms": 7139.369, "learn_throughput": 560.274, "synch_weights_time_ms": 12.529}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "training_iteration": 97, "trial_id": "fa423_00000", "date": "2024-08-10_11-11-53", "timestamp": 1723302713, "time_this_iter_s": 7.8023388385772705, "time_total_s": 792.9467413425446, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72bae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 792.9467413425446, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.64166666666667, "ram_util_percent": 77.30833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8258100980173344, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.791192551895424, "policy_loss": -0.0033676310926527967, "vf_loss": 2.794556160137136, "vf_explained_var": 0.0963216015901515, "kl": 0.002714106069241172, "entropy": 0.4331989066626029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1865489087377985, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.276012480383118, "policy_loss": -0.0072478237188382385, "vf_loss": 3.2832602902005115, "vf_explained_var": 0.069178781285882, "kl": 0.040106235428546445, "entropy": 0.32023734212853017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 301.97, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 30197, "policy_reward_min": {"agent_policy": -58.77592758180771, "adversary_policy": -47.56072280727678}, "policy_reward_max": {"agent_policy": 61.47523308414985, "adversary_policy": 42.13433941193966}, "policy_reward_mean": {"agent_policy": 6.453393655658241, "adversary_policy": -3.22669682782912}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 90, 400, 400, 82, 400, 400, 400, 400, 400, 400, 400, 400, 310, 400, 400, 400, 221, 400, 76, 20, 400, 47, 400, 400, 400, 400, 400, 400, 400, 48, 7, 400, 81, 400, 15, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 138, 88, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 92, 400, 38, 19, 400, 400, 49, 154, 400, 400, 373, 400, 400, 400, 400, 50, 400, 10, 400, 400, 400, 29, 400, 400, 6, 41, 72, 400, 324, 39, 400, 400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400], "policy_agent_policy_reward": [40.69205631298757, -13.382004959980161, 56.277143232684324, 13.467186290119848, -2.362900893373917, 46.491790723655846, 26.705388121694774, -13.762747527373847, 57.47603181889474, 38.03152632734535, 20.738347049508707, 60.6240107730095, 28.91683807116637, -0.16385531921713792, 29.165052139129088, 0.9334832858228737, 51.7880007312244, -5.457351170046071, -3.7076156473941992, -58.77592758180771, 4.191515970335974, -24.254250038600265, -21.01553480980889, -11.363149299768807, 3.739994044065888, 18.654214838902952, 0.3634176823688602, -15.772369692395603, 28.955369159954913, -20.283145716270603, -19.438454696016258, -6.019502740153552, 13.425209111439706, -22.75611062414457, 18.65961992705715, -13.744995179226159, 28.836385532322314, 20.076204531675, -17.674327923171447, 18.27622127530862, 24.47901137352889, -28.08576148631054, 9.350380393143677, 7.062843750734714, 8.438241616129432, 53.37037095227857, 5.876831052392685, 3.823295116233691, 21.151222412366923, -5.448223820533709, 28.29432545447265, 45.31571879773551, -31.532880289099126, 11.255273240402765, 10.669126756542585, 11.180595558993076, 3.4474675687393646, 0.5132071788724915, 13.716320626467798, -9.892578708757489, -9.83350197631065, -37.100918359747524, 24.24873842895328, 2.302544988781147, -25.265919312270157, -14.754274453937704, 32.92172422599478, 21.411665186117226, -23.08128249780195, -1.5424685552442092, -39.61135932922745, 29.05400927828395, 45.07062142034235, -1.102860547215152, 51.275720846832755, -5.150234479414641, -1.671611902440926, 61.47523308414985, -11.648132372687574, -0.8798318913926781, 42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307, -19.01869704997586, 49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824], "policy_adversary_policy_reward": [-3.0858433737849396, -37.60621293920263, 39.42314841907525, -26.04114345909508, -37.11632291331631, -19.160820319368014, -7.8256743777801105, -5.6415119123397375, -8.637478922627267, 11.000379816001184, -35.84106609225252, -10.650724631403337, -14.74944301247185, -11.955945109222924, 9.085888343166552, 4.676859184207295, -29.193155968323936, -28.2828758505708, -16.629326207524656, -21.402200119820705, -20.31802044426561, -0.4203266052430976, -33.40490205219177, -27.21910872081772, -15.823894658753227, -13.092943412413145, -15.957041735845543, 16.120897055062684, -12.33933186046157, -16.825720278667514, 1.4423338339794896, -2.375817119802363, -25.583207980395674, -26.204792750828723, 25.057138548469815, -19.59978737842375, 9.028965897439342, -5.321350250045143, 40.1777873541229, 18.598140227684816, -11.332387236780942, 7.140871266444967, 14.025305366079895, 10.22894467252037, -10.630641227932237, 31.646176037741128, 16.161934352656463, -4.798785052887656, -0.2839282240484451, -3.456065820017443, 12.221587516571246, -30.8758023554742, 8.943803472917544, -9.307221155286404, -3.5391954100724377, 19.31156510246804, -8.808514014534381, -20.14685514542053, 10.699241592228834, 9.583904124041773, 21.07769805078703, -1.6392433547707768, 3.936884503066131, 2.08261823708742, -11.529232017560027, -1.8959770938796794, -2.854464592493887, 25.610575216638455, -26.768268565675584, 8.108648638618416, 7.4693498345365095, 6.27564534468965, -16.67534702376455, -12.161038508557784, -21.630732903260878, 1.5545283715858726, 17.580904240755956, 0.09342368241549082, -12.977732766445534, -5.2984885088630875, -14.086430071974469, -10.392581301554422, 11.816353857563183, 16.269407628747352, -7.6523821517152975, -1.6979982414283796, -7.17908861539933, 0.11624486466461548, -12.652538079008629, 4.214296462879197, -22.58043346290336, -30.78993748937522, -27.880821145375574, 22.00399009298289, 12.056308339785392, -15.879603456019083, -16.961837272784994, -4.18938513958193, -1.2932871916369457, 6.741511012170655, -10.84268970516262, -17.45163574931003, -28.864071806568017, -16.45164699116749, 16.034441678013955, 15.49843861108517, -8.55102606685552, -2.7042471735472446, 4.842124783460871, -15.511251540003457, -9.229886782193681, -1.9507087767993951, -11.473501260025397, 8.026033691286033, 0.7614551265349903, -1.2746623054074817, -31.90632736533768, 18.190006738869883, -4.171934544848831, 14.06451325360632, 17.187217262546937, -7.353715286236284, 19.089704141861027, 18.011214217886497, -34.8798141088828, 10.631075679929513, -5.509763948502062, 3.2072189597209153, 11.570768233623093, 13.695151078647063, -20.249995259748037, 35.004269713685744, -13.549811447186606, -19.371912778808156, -9.762635978841821, -11.649029207275404, 42.13433941193966, -19.053056914137713, -12.063514849588277, 13.605983404832486, 1.3289174073825407, 38.282441921844935, -14.953778744217086, -14.100230534066863, -30.255313653718027, -14.815307766624326, -34.635964795937944, 35.738825343153096, -23.364089475397243, -27.9116313714355, 4.0831258433306115, 1.0671086360840292, 1.9865564401764217, -0.3149445377354958, -47.56072280727678, -13.914510276873067, 0.8389543188500781, 10.809178053837496, 12.958612381002759, -12.07878048961008, -22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017, 7.5821062798090715, 11.436590770166788, -25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027498506519202, "mean_inference_ms": 1.0427846802439062, "mean_action_processing_ms": 0.17316099550946312, "mean_env_wait_ms": 0.06829644700878731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039577484130859375, "StateBufferConnector_ms": 0.0035927295684814453, "ViewRequirementAgentConnector_ms": 0.06900346279144287}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.07383239841926, "num_env_steps_trained_throughput_per_sec": 503.07383239841926, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 7948.826, "restore_workers_time_ms": 0.011, "training_step_time_ms": 7948.794, "sample_time_ms": 794.995, "learn_time_ms": 7140.662, "learn_throughput": 560.172, "synch_weights_time_ms": 12.621}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 98, "trial_id": "fa423_00000", "date": "2024-08-10_11-12-01", "timestamp": 1723302721, "time_this_iter_s": 7.955955982208252, "time_total_s": 800.9026973247528, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98a5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 800.9026973247528, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 27.04545454545454, "ram_util_percent": 77.36363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5555581718840927, "cur_kl_coeff": 0.0007415771484375002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6507892989607713, "policy_loss": -0.0024202082665863807, "vf_loss": 2.6532067523431526, "vf_explained_var": 0.17720768104785334, "kl": 0.0037253347656539242, "entropy": 0.36858693652998203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1803984815254807, "cur_kl_coeff": 1.086294651031494e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7316506184637546, "policy_loss": -0.005890131061460124, "vf_loss": 3.7375407447417577, "vf_explained_var": 0.05354187383006016, "kl": 0.009676565182157834, "entropy": 0.5841640536362926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 296.29, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 29629, "policy_reward_min": {"agent_policy": -58.77592758180771, "adversary_policy": -47.56072280727678}, "policy_reward_max": {"agent_policy": 61.47523308414985, "adversary_policy": 42.13433941193966}, "policy_reward_mean": {"agent_policy": 1.6566618781834783, "adversary_policy": -0.8283309390917389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [310, 400, 400, 400, 221, 400, 76, 20, 400, 47, 400, 400, 400, 400, 400, 400, 400, 48, 7, 400, 81, 400, 15, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 138, 88, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 92, 400, 38, 19, 400, 400, 49, 154, 400, 400, 373, 400, 400, 400, 400, 50, 400, 10, 400, 400, 400, 29, 400, 400, 6, 41, 72, 400, 324, 39, 400, 400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400], "policy_agent_policy_reward": [-0.16385531921713792, 29.165052139129088, 0.9334832858228737, 51.7880007312244, -5.457351170046071, -3.7076156473941992, -58.77592758180771, 4.191515970335974, -24.254250038600265, -21.01553480980889, -11.363149299768807, 3.739994044065888, 18.654214838902952, 0.3634176823688602, -15.772369692395603, 28.955369159954913, -20.283145716270603, -19.438454696016258, -6.019502740153552, 13.425209111439706, -22.75611062414457, 18.65961992705715, -13.744995179226159, 28.836385532322314, 20.076204531675, -17.674327923171447, 18.27622127530862, 24.47901137352889, -28.08576148631054, 9.350380393143677, 7.062843750734714, 8.438241616129432, 53.37037095227857, 5.876831052392685, 3.823295116233691, 21.151222412366923, -5.448223820533709, 28.29432545447265, 45.31571879773551, -31.532880289099126, 11.255273240402765, 10.669126756542585, 11.180595558993076, 3.4474675687393646, 0.5132071788724915, 13.716320626467798, -9.892578708757489, -9.83350197631065, -37.100918359747524, 24.24873842895328, 2.302544988781147, -25.265919312270157, -14.754274453937704, 32.92172422599478, 21.411665186117226, -23.08128249780195, -1.5424685552442092, -39.61135932922745, 29.05400927828395, 45.07062142034235, -1.102860547215152, 51.275720846832755, -5.150234479414641, -1.671611902440926, 61.47523308414985, -11.648132372687574, -0.8798318913926781, 42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307, -19.01869704997586, 49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966], "policy_adversary_policy_reward": [-15.957041735845543, 16.120897055062684, -12.33933186046157, -16.825720278667514, 1.4423338339794896, -2.375817119802363, -25.583207980395674, -26.204792750828723, 25.057138548469815, -19.59978737842375, 9.028965897439342, -5.321350250045143, 40.1777873541229, 18.598140227684816, -11.332387236780942, 7.140871266444967, 14.025305366079895, 10.22894467252037, -10.630641227932237, 31.646176037741128, 16.161934352656463, -4.798785052887656, -0.2839282240484451, -3.456065820017443, 12.221587516571246, -30.8758023554742, 8.943803472917544, -9.307221155286404, -3.5391954100724377, 19.31156510246804, -8.808514014534381, -20.14685514542053, 10.699241592228834, 9.583904124041773, 21.07769805078703, -1.6392433547707768, 3.936884503066131, 2.08261823708742, -11.529232017560027, -1.8959770938796794, -2.854464592493887, 25.610575216638455, -26.768268565675584, 8.108648638618416, 7.4693498345365095, 6.27564534468965, -16.67534702376455, -12.161038508557784, -21.630732903260878, 1.5545283715858726, 17.580904240755956, 0.09342368241549082, -12.977732766445534, -5.2984885088630875, -14.086430071974469, -10.392581301554422, 11.816353857563183, 16.269407628747352, -7.6523821517152975, -1.6979982414283796, -7.17908861539933, 0.11624486466461548, -12.652538079008629, 4.214296462879197, -22.58043346290336, -30.78993748937522, -27.880821145375574, 22.00399009298289, 12.056308339785392, -15.879603456019083, -16.961837272784994, -4.18938513958193, -1.2932871916369457, 6.741511012170655, -10.84268970516262, -17.45163574931003, -28.864071806568017, -16.45164699116749, 16.034441678013955, 15.49843861108517, -8.55102606685552, -2.7042471735472446, 4.842124783460871, -15.511251540003457, -9.229886782193681, -1.9507087767993951, -11.473501260025397, 8.026033691286033, 0.7614551265349903, -1.2746623054074817, -31.90632736533768, 18.190006738869883, -4.171934544848831, 14.06451325360632, 17.187217262546937, -7.353715286236284, 19.089704141861027, 18.011214217886497, -34.8798141088828, 10.631075679929513, -5.509763948502062, 3.2072189597209153, 11.570768233623093, 13.695151078647063, -20.249995259748037, 35.004269713685744, -13.549811447186606, -19.371912778808156, -9.762635978841821, -11.649029207275404, 42.13433941193966, -19.053056914137713, -12.063514849588277, 13.605983404832486, 1.3289174073825407, 38.282441921844935, -14.953778744217086, -14.100230534066863, -30.255313653718027, -14.815307766624326, -34.635964795937944, 35.738825343153096, -23.364089475397243, -27.9116313714355, 4.0831258433306115, 1.0671086360840292, 1.9865564401764217, -0.3149445377354958, -47.56072280727678, -13.914510276873067, 0.8389543188500781, 10.809178053837496, 12.958612381002759, -12.07878048961008, -22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017, 7.5821062798090715, 11.436590770166788, -25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40279985076041186, "mean_inference_ms": 1.043157369896423, "mean_action_processing_ms": 0.17317125266640607, "mean_env_wait_ms": 0.06831443874987103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041158199310302734, "StateBufferConnector_ms": 0.0037093162536621094, "ViewRequirementAgentConnector_ms": 0.07102274894714355}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.86229777565467, "num_env_steps_trained_throughput_per_sec": 505.86229777565467, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 7967.629, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7967.597, "sample_time_ms": 794.494, "learn_time_ms": 7160.0, "learn_throughput": 558.659, "synch_weights_time_ms": 12.545}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "training_iteration": 99, "trial_id": "fa423_00000", "date": "2024-08-10_11-12-09", "timestamp": 1723302729, "time_this_iter_s": 7.9122700691223145, "time_total_s": 808.8149673938751, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 808.8149673938751, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 24.058333333333334, "ram_util_percent": 77.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.53981429480371, "cur_kl_coeff": 0.0003707885742187501, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7167007752196497, "policy_loss": -0.0025637125300746115, "vf_loss": 2.7192627672795897, "vf_explained_var": 0.2509553007347874, "kl": 0.004652109909226166, "entropy": 0.4511015266495407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0174579517294964, "cur_kl_coeff": 1.086294651031494e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.694652004912496, "policy_loss": -0.0029955541799912074, "vf_loss": 3.6976475631197294, "vf_explained_var": 0.2114419302592675, "kl": 0.013538935760558094, "entropy": 0.8450584040333827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 300.22, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 30022, "policy_reward_min": {"agent_policy": -57.66442548228976, "adversary_policy": -47.56072280727678}, "policy_reward_max": {"agent_policy": 61.47523308414985, "adversary_policy": 42.13433941193966}, "policy_reward_mean": {"agent_policy": 1.8991167441446613, "adversary_policy": -0.9495583720723306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 48, 7, 400, 81, 400, 15, 400, 400, 400, 400, 400, 82, 400, 400, 400, 400, 138, 88, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 92, 400, 38, 19, 400, 400, 49, 154, 400, 400, 373, 400, 400, 400, 400, 50, 400, 10, 400, 400, 400, 29, 400, 400, 6, 41, 72, 400, 324, 39, 400, 400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400], "policy_agent_policy_reward": [0.3634176823688602, -15.772369692395603, 28.955369159954913, -20.283145716270603, -19.438454696016258, -6.019502740153552, 13.425209111439706, -22.75611062414457, 18.65961992705715, -13.744995179226159, 28.836385532322314, 20.076204531675, -17.674327923171447, 18.27622127530862, 24.47901137352889, -28.08576148631054, 9.350380393143677, 7.062843750734714, 8.438241616129432, 53.37037095227857, 5.876831052392685, 3.823295116233691, 21.151222412366923, -5.448223820533709, 28.29432545447265, 45.31571879773551, -31.532880289099126, 11.255273240402765, 10.669126756542585, 11.180595558993076, 3.4474675687393646, 0.5132071788724915, 13.716320626467798, -9.892578708757489, -9.83350197631065, -37.100918359747524, 24.24873842895328, 2.302544988781147, -25.265919312270157, -14.754274453937704, 32.92172422599478, 21.411665186117226, -23.08128249780195, -1.5424685552442092, -39.61135932922745, 29.05400927828395, 45.07062142034235, -1.102860547215152, 51.275720846832755, -5.150234479414641, -1.671611902440926, 61.47523308414985, -11.648132372687574, -0.8798318913926781, 42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307, -19.01869704997586, 49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482], "policy_adversary_policy_reward": [8.943803472917544, -9.307221155286404, -3.5391954100724377, 19.31156510246804, -8.808514014534381, -20.14685514542053, 10.699241592228834, 9.583904124041773, 21.07769805078703, -1.6392433547707768, 3.936884503066131, 2.08261823708742, -11.529232017560027, -1.8959770938796794, -2.854464592493887, 25.610575216638455, -26.768268565675584, 8.108648638618416, 7.4693498345365095, 6.27564534468965, -16.67534702376455, -12.161038508557784, -21.630732903260878, 1.5545283715858726, 17.580904240755956, 0.09342368241549082, -12.977732766445534, -5.2984885088630875, -14.086430071974469, -10.392581301554422, 11.816353857563183, 16.269407628747352, -7.6523821517152975, -1.6979982414283796, -7.17908861539933, 0.11624486466461548, -12.652538079008629, 4.214296462879197, -22.58043346290336, -30.78993748937522, -27.880821145375574, 22.00399009298289, 12.056308339785392, -15.879603456019083, -16.961837272784994, -4.18938513958193, -1.2932871916369457, 6.741511012170655, -10.84268970516262, -17.45163574931003, -28.864071806568017, -16.45164699116749, 16.034441678013955, 15.49843861108517, -8.55102606685552, -2.7042471735472446, 4.842124783460871, -15.511251540003457, -9.229886782193681, -1.9507087767993951, -11.473501260025397, 8.026033691286033, 0.7614551265349903, -1.2746623054074817, -31.90632736533768, 18.190006738869883, -4.171934544848831, 14.06451325360632, 17.187217262546937, -7.353715286236284, 19.089704141861027, 18.011214217886497, -34.8798141088828, 10.631075679929513, -5.509763948502062, 3.2072189597209153, 11.570768233623093, 13.695151078647063, -20.249995259748037, 35.004269713685744, -13.549811447186606, -19.371912778808156, -9.762635978841821, -11.649029207275404, 42.13433941193966, -19.053056914137713, -12.063514849588277, 13.605983404832486, 1.3289174073825407, 38.282441921844935, -14.953778744217086, -14.100230534066863, -30.255313653718027, -14.815307766624326, -34.635964795937944, 35.738825343153096, -23.364089475397243, -27.9116313714355, 4.0831258433306115, 1.0671086360840292, 1.9865564401764217, -0.3149445377354958, -47.56072280727678, -13.914510276873067, 0.8389543188500781, 10.809178053837496, 12.958612381002759, -12.07878048961008, -22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017, 7.5821062798090715, 11.436590770166788, -25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027109112145576, "mean_inference_ms": 1.043212412014931, "mean_action_processing_ms": 0.17309735395875328, "mean_env_wait_ms": 0.06827840217323017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041425228118896484, "StateBufferConnector_ms": 0.003611922264099121, "ViewRequirementAgentConnector_ms": 0.07071316242218018}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.6214359571142, "num_env_steps_trained_throughput_per_sec": 501.6214359571142, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 7997.342, "restore_workers_time_ms": 0.011, "training_step_time_ms": 7997.31, "sample_time_ms": 795.307, "learn_time_ms": 7188.645, "learn_throughput": 556.433, "synch_weights_time_ms": 12.774}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 100, "trial_id": "fa423_00000", "date": "2024-08-10_11-12-17", "timestamp": 1723302737, "time_this_iter_s": 7.979924201965332, "time_total_s": 816.7948915958405, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 816.7948915958405, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.45454545454546, "ram_util_percent": 77.07272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4827708702869518, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.234066167331877, "policy_loss": -0.0025710739194114924, "vf_loss": 3.236636544283105, "vf_explained_var": -0.14568434222034676, "kl": 0.0037585453171777032, "entropy": 0.3837279008809852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.959683330108722, "cur_kl_coeff": 1.086294651031494e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.090277639528115, "policy_loss": -0.0097667429256641, "vf_loss": 5.100044363240401, "vf_explained_var": -0.10468270710359016, "kl": 0.025067697454694837, "entropy": 0.8848408546298743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 310.05, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 31005, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -47.56072280727678}, "policy_reward_max": {"agent_policy": 61.47523308414985, "adversary_policy": 42.13433941193966}, "policy_reward_mean": {"agent_policy": 0.5424463598123479, "adversary_policy": -0.27122317990617406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 82, 400, 400, 400, 400, 138, 88, 400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 92, 400, 38, 19, 400, 400, 49, 154, 400, 400, 373, 400, 400, 400, 400, 50, 400, 10, 400, 400, 400, 29, 400, 400, 6, 41, 72, 400, 324, 39, 400, 400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400], "policy_agent_policy_reward": [20.076204531675, -17.674327923171447, 18.27622127530862, 24.47901137352889, -28.08576148631054, 9.350380393143677, 7.062843750734714, 8.438241616129432, 53.37037095227857, 5.876831052392685, 3.823295116233691, 21.151222412366923, -5.448223820533709, 28.29432545447265, 45.31571879773551, -31.532880289099126, 11.255273240402765, 10.669126756542585, 11.180595558993076, 3.4474675687393646, 0.5132071788724915, 13.716320626467798, -9.892578708757489, -9.83350197631065, -37.100918359747524, 24.24873842895328, 2.302544988781147, -25.265919312270157, -14.754274453937704, 32.92172422599478, 21.411665186117226, -23.08128249780195, -1.5424685552442092, -39.61135932922745, 29.05400927828395, 45.07062142034235, -1.102860547215152, 51.275720846832755, -5.150234479414641, -1.671611902440926, 61.47523308414985, -11.648132372687574, -0.8798318913926781, 42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307, -19.01869704997586, 49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406], "policy_adversary_policy_reward": [-21.630732903260878, 1.5545283715858726, 17.580904240755956, 0.09342368241549082, -12.977732766445534, -5.2984885088630875, -14.086430071974469, -10.392581301554422, 11.816353857563183, 16.269407628747352, -7.6523821517152975, -1.6979982414283796, -7.17908861539933, 0.11624486466461548, -12.652538079008629, 4.214296462879197, -22.58043346290336, -30.78993748937522, -27.880821145375574, 22.00399009298289, 12.056308339785392, -15.879603456019083, -16.961837272784994, -4.18938513958193, -1.2932871916369457, 6.741511012170655, -10.84268970516262, -17.45163574931003, -28.864071806568017, -16.45164699116749, 16.034441678013955, 15.49843861108517, -8.55102606685552, -2.7042471735472446, 4.842124783460871, -15.511251540003457, -9.229886782193681, -1.9507087767993951, -11.473501260025397, 8.026033691286033, 0.7614551265349903, -1.2746623054074817, -31.90632736533768, 18.190006738869883, -4.171934544848831, 14.06451325360632, 17.187217262546937, -7.353715286236284, 19.089704141861027, 18.011214217886497, -34.8798141088828, 10.631075679929513, -5.509763948502062, 3.2072189597209153, 11.570768233623093, 13.695151078647063, -20.249995259748037, 35.004269713685744, -13.549811447186606, -19.371912778808156, -9.762635978841821, -11.649029207275404, 42.13433941193966, -19.053056914137713, -12.063514849588277, 13.605983404832486, 1.3289174073825407, 38.282441921844935, -14.953778744217086, -14.100230534066863, -30.255313653718027, -14.815307766624326, -34.635964795937944, 35.738825343153096, -23.364089475397243, -27.9116313714355, 4.0831258433306115, 1.0671086360840292, 1.9865564401764217, -0.3149445377354958, -47.56072280727678, -13.914510276873067, 0.8389543188500781, 10.809178053837496, 12.958612381002759, -12.07878048961008, -22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017, 7.5821062798090715, 11.436590770166788, -25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024710939603257, "mean_inference_ms": 1.0432800745687436, "mean_action_processing_ms": 0.1731324200446798, "mean_env_wait_ms": 0.06829545587886426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042008161544799805, "StateBufferConnector_ms": 0.0035761594772338867, "ViewRequirementAgentConnector_ms": 0.07012736797332764}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.6262460083428, "num_env_steps_trained_throughput_per_sec": 486.6262460083428, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 8030.983, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8030.952, "sample_time_ms": 800.867, "learn_time_ms": 7217.224, "learn_throughput": 554.23, "synch_weights_time_ms": 12.301}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "training_iteration": 101, "trial_id": "fa423_00000", "date": "2024-08-10_11-12-25", "timestamp": 1723302745, "time_this_iter_s": 8.224372863769531, "time_total_s": 825.01926445961, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 825.01926445961, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 27.91666666666666, "ram_util_percent": 77.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6794234987289185, "cur_kl_coeff": 9.269714355468753e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.354149149965357, "policy_loss": -0.0032387438316450073, "vf_loss": 4.357387361072359, "vf_explained_var": 0.0023874337395662984, "kl": 0.005583696249177845, "entropy": 0.39680796240372634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3527838034555315, "cur_kl_coeff": 1.6294419765472407e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.902834811806679, "policy_loss": -0.011896729803023238, "vf_loss": 5.914731531838576, "vf_explained_var": 0.0677934485177199, "kl": 0.018136489277563957, "entropy": 0.4638872703382125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 316.6, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 31660, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -47.56072280727678}, "policy_reward_max": {"agent_policy": 73.52577377419672, "adversary_policy": 42.13433941193966}, "policy_reward_mean": {"agent_policy": 1.771495252136121, "adversary_policy": -0.8857476260680603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 100, 400, 400, 400, 400, 400, 92, 400, 38, 19, 400, 400, 49, 154, 400, 400, 373, 400, 400, 400, 400, 50, 400, 10, 400, 400, 400, 29, 400, 400, 6, 41, 72, 400, 324, 39, 400, 400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400], "policy_agent_policy_reward": [21.151222412366923, -5.448223820533709, 28.29432545447265, 45.31571879773551, -31.532880289099126, 11.255273240402765, 10.669126756542585, 11.180595558993076, 3.4474675687393646, 0.5132071788724915, 13.716320626467798, -9.892578708757489, -9.83350197631065, -37.100918359747524, 24.24873842895328, 2.302544988781147, -25.265919312270157, -14.754274453937704, 32.92172422599478, 21.411665186117226, -23.08128249780195, -1.5424685552442092, -39.61135932922745, 29.05400927828395, 45.07062142034235, -1.102860547215152, 51.275720846832755, -5.150234479414641, -1.671611902440926, 61.47523308414985, -11.648132372687574, -0.8798318913926781, 42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307, -19.01869704997586, 49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075], "policy_adversary_policy_reward": [-16.961837272784994, -4.18938513958193, -1.2932871916369457, 6.741511012170655, -10.84268970516262, -17.45163574931003, -28.864071806568017, -16.45164699116749, 16.034441678013955, 15.49843861108517, -8.55102606685552, -2.7042471735472446, 4.842124783460871, -15.511251540003457, -9.229886782193681, -1.9507087767993951, -11.473501260025397, 8.026033691286033, 0.7614551265349903, -1.2746623054074817, -31.90632736533768, 18.190006738869883, -4.171934544848831, 14.06451325360632, 17.187217262546937, -7.353715286236284, 19.089704141861027, 18.011214217886497, -34.8798141088828, 10.631075679929513, -5.509763948502062, 3.2072189597209153, 11.570768233623093, 13.695151078647063, -20.249995259748037, 35.004269713685744, -13.549811447186606, -19.371912778808156, -9.762635978841821, -11.649029207275404, 42.13433941193966, -19.053056914137713, -12.063514849588277, 13.605983404832486, 1.3289174073825407, 38.282441921844935, -14.953778744217086, -14.100230534066863, -30.255313653718027, -14.815307766624326, -34.635964795937944, 35.738825343153096, -23.364089475397243, -27.9116313714355, 4.0831258433306115, 1.0671086360840292, 1.9865564401764217, -0.3149445377354958, -47.56072280727678, -13.914510276873067, 0.8389543188500781, 10.809178053837496, 12.958612381002759, -12.07878048961008, -22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017, 7.5821062798090715, 11.436590770166788, -25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024327720199403, "mean_inference_ms": 1.0427971846922015, "mean_action_processing_ms": 0.17304981029054314, "mean_env_wait_ms": 0.06829937493799258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.0035858154296875, "ViewRequirementAgentConnector_ms": 0.07047092914581299}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.0391604613779, "num_env_steps_trained_throughput_per_sec": 499.0391604613779, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 8027.668, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8027.636, "sample_time_ms": 806.446, "learn_time_ms": 7207.611, "learn_throughput": 554.969, "synch_weights_time_ms": 13.013}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 102, "trial_id": "fa423_00000", "date": "2024-08-10_11-12-34", "timestamp": 1723302754, "time_this_iter_s": 8.041478157043457, "time_total_s": 833.0607426166534, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 833.0607426166534, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 25.816666666666674, "ram_util_percent": 77.45833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.184851567502375, "cur_kl_coeff": 9.269714355468753e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.640717675950792, "policy_loss": -0.0029346765223496334, "vf_loss": 3.6436518389081196, "vf_explained_var": -0.24390091016179039, "kl": 0.005475892190740341, "entropy": 0.42707154932160857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.620648007467389, "cur_kl_coeff": 1.6294419765472407e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.775248453766108, "policy_loss": -0.0048438126444428535, "vf_loss": 4.780092281103134, "vf_explained_var": 0.22587382787217697, "kl": 0.007005970272530849, "entropy": 0.2988609783196201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 318.53, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 31853, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -58.205591178465376}, "policy_reward_max": {"agent_policy": 73.52577377419672, "adversary_policy": 42.13433941193966}, "policy_reward_mean": {"agent_policy": 5.35054909407003, "adversary_policy": -2.675274547035016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [19, 400, 400, 49, 154, 400, 400, 373, 400, 400, 400, 400, 50, 400, 10, 400, 400, 400, 29, 400, 400, 6, 41, 72, 400, 324, 39, 400, 400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-37.100918359747524, 24.24873842895328, 2.302544988781147, -25.265919312270157, -14.754274453937704, 32.92172422599478, 21.411665186117226, -23.08128249780195, -1.5424685552442092, -39.61135932922745, 29.05400927828395, 45.07062142034235, -1.102860547215152, 51.275720846832755, -5.150234479414641, -1.671611902440926, 61.47523308414985, -11.648132372687574, -0.8798318913926781, 42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307, -19.01869704997586, 49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191], "policy_adversary_policy_reward": [19.089704141861027, 18.011214217886497, -34.8798141088828, 10.631075679929513, -5.509763948502062, 3.2072189597209153, 11.570768233623093, 13.695151078647063, -20.249995259748037, 35.004269713685744, -13.549811447186606, -19.371912778808156, -9.762635978841821, -11.649029207275404, 42.13433941193966, -19.053056914137713, -12.063514849588277, 13.605983404832486, 1.3289174073825407, 38.282441921844935, -14.953778744217086, -14.100230534066863, -30.255313653718027, -14.815307766624326, -34.635964795937944, 35.738825343153096, -23.364089475397243, -27.9116313714355, 4.0831258433306115, 1.0671086360840292, 1.9865564401764217, -0.3149445377354958, -47.56072280727678, -13.914510276873067, 0.8389543188500781, 10.809178053837496, 12.958612381002759, -12.07878048961008, -22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017, 7.5821062798090715, 11.436590770166788, -25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40204312867715325, "mean_inference_ms": 1.0421813721166981, "mean_action_processing_ms": 0.1729695922510972, "mean_env_wait_ms": 0.06828570233348873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039827823638916016, "StateBufferConnector_ms": 0.0025748014450073242, "ViewRequirementAgentConnector_ms": 0.06750047206878662}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.5350617179995, "num_env_steps_trained_throughput_per_sec": 508.5350617179995, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 8000.47, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8000.438, "sample_time_ms": 804.08, "learn_time_ms": 7182.766, "learn_throughput": 556.889, "synch_weights_time_ms": 12.972}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "training_iteration": 103, "trial_id": "fa423_00000", "date": "2024-08-10_11-12-42", "timestamp": 1723302762, "time_this_iter_s": 7.870757102966309, "time_total_s": 840.9314997196198, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a717eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 840.9314997196198, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 27.663636363636364, "ram_util_percent": 77.7909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.03151855358371, "cur_kl_coeff": 9.269714355468753e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4389794005918755, "policy_loss": -0.0023426044574647985, "vf_loss": 3.441321609133766, "vf_explained_var": -0.21328857459088482, "kl": 0.004323887033394124, "entropy": 0.3722595130009626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9592955361120403, "cur_kl_coeff": 1.6294419765472407e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.147117616732915, "policy_loss": -0.004088707243742344, "vf_loss": 5.151206318537394, "vf_explained_var": 0.10850387712319692, "kl": 0.005923969985894892, "entropy": 0.255334322542573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 328.58, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 32858, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -58.205591178465376}, "policy_reward_max": {"agent_policy": 77.82894630207707, "adversary_policy": 35.738825343153096}, "policy_reward_mean": {"agent_policy": 11.322265547748813, "adversary_policy": -5.661132773874407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 50, 400, 10, 400, 400, 400, 29, 400, 400, 6, 41, 72, 400, 324, 39, 400, 400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [29.05400927828395, 45.07062142034235, -1.102860547215152, 51.275720846832755, -5.150234479414641, -1.671611902440926, 61.47523308414985, -11.648132372687574, -0.8798318913926781, 42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307, -19.01869704997586, 49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085], "policy_adversary_policy_reward": [-14.953778744217086, -14.100230534066863, -30.255313653718027, -14.815307766624326, -34.635964795937944, 35.738825343153096, -23.364089475397243, -27.9116313714355, 4.0831258433306115, 1.0671086360840292, 1.9865564401764217, -0.3149445377354958, -47.56072280727678, -13.914510276873067, 0.8389543188500781, 10.809178053837496, 12.958612381002759, -12.07878048961008, -22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017, 7.5821062798090715, 11.436590770166788, -25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40197348954717815, "mean_inference_ms": 1.041630369240658, "mean_action_processing_ms": 0.17285623164046768, "mean_env_wait_ms": 0.06826776699975434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038520097732543945, "StateBufferConnector_ms": 0.0025441646575927734, "ViewRequirementAgentConnector_ms": 0.06709277629852295}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.2498849942688, "num_env_steps_trained_throughput_per_sec": 499.2498849942688, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 8015.148, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8015.115, "sample_time_ms": 806.128, "learn_time_ms": 7195.307, "learn_throughput": 555.918, "synch_weights_time_ms": 13.023}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 104, "trial_id": "fa423_00000", "date": "2024-08-10_11-12-50", "timestamp": 1723302770, "time_this_iter_s": 8.016948938369751, "time_total_s": 848.9484486579895, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 848.9484486579895, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 24.808333333333334, "ram_util_percent": 77.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0522852923819626, "cur_kl_coeff": 4.6348571777343765e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.327481095626871, "policy_loss": -0.002869930054016766, "vf_loss": 4.330350953939731, "vf_explained_var": 0.03012138974098932, "kl": 0.003849085868817832, "entropy": 0.36012717001337224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8084432105223338, "cur_kl_coeff": 1.6294419765472407e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.8853325021763645, "policy_loss": -0.0061822215677239, "vf_loss": 4.891514734178782, "vf_explained_var": 0.08913957805683216, "kl": 0.00396455228981119, "entropy": 0.3652913930825889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 339.69, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 33969, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -58.205591178465376}, "policy_reward_max": {"agent_policy": 81.3221692774708, "adversary_policy": 30.832636482768663}, "policy_reward_mean": {"agent_policy": 13.64435361779516, "adversary_policy": -6.82217680889758}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 6, 41, 72, 400, 324, 39, 400, 400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [42.59602643464237, 13.692668697584482, -6.477607792668482, 3.493425126891424, -1.3939905859831168, 2.5021132537089414, -57.66442548228976, -17.97476537889307, -19.01869704997586, 49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708], "policy_adversary_policy_reward": [-22.807345577068254, -19.788680857574118, -4.608217940552002, -9.08445075703248, 0.0, 6.477607792668482, -13.664032444482395, 10.17060731759097, 15.004915737469018, -13.610925151485901, -2.4102759141673076, -0.09183733954163387, 28.114819260560495, 29.549606221729263, 24.901514851888088, -6.926749472995017, 7.5821062798090715, 11.436590770166788, -25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40192655378961595, "mean_inference_ms": 1.0408549443654498, "mean_action_processing_ms": 0.17273267692402666, "mean_env_wait_ms": 0.06825282253507702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038373470306396484, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.0673227310180664}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.9457294056872, "num_env_steps_trained_throughput_per_sec": 518.9457294056872, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 7938.619, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7938.586, "sample_time_ms": 771.839, "learn_time_ms": 7152.952, "learn_throughput": 559.21, "synch_weights_time_ms": 13.103}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "training_iteration": 105, "trial_id": "fa423_00000", "date": "2024-08-10_11-12-58", "timestamp": 1723302778, "time_this_iter_s": 7.713227033615112, "time_total_s": 856.6616756916046, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 856.6616756916046, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 24.11818181818182, "ram_util_percent": 77.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9993063645703453, "cur_kl_coeff": 2.3174285888671882e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9606757186707995, "policy_loss": -0.003923699771123076, "vf_loss": 3.9645993313461383, "vf_explained_var": 0.014108194434453571, "kl": 0.005710067092708193, "entropy": 0.4208506168196441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0784946143006287, "cur_kl_coeff": 8.147209882736204e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.161215686549743, "policy_loss": -0.0034863498813744323, "vf_loss": 5.164702044179042, "vf_explained_var": 0.048173804643253486, "kl": 0.00379297877469903, "entropy": 0.26661184611730276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 354.87, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 35487, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -59.50390719758147}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 30.832636482768663}, "policy_reward_mean": {"agent_policy": 19.312544131611684, "adversary_policy": -9.656272065805842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 61, 400, 400, 400, 135, 400, 400, 400, 100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [49.790036451728156, -44.10672551257859, 11.997124919542905, -14.899535286886763, 25.267864430008903, -10.670071682684075, 24.143389953472617, -10.380394648427394, -4.680394638624561, -12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856], "policy_adversary_policy_reward": [-25.793901922078316, -23.996134529649833, 24.053803491428358, 20.052922021150234, -7.9805305802067465, -4.016594339336159, 16.531314081442044, -1.6317787945552809, -28.55832393522313, 3.2904595052142263, -12.571494665669213, 23.241566348353288, 10.953447215554913, -35.09683716902753, 11.159598614719648, -0.7792039662922541, -7.029829405903124, 11.710224044527685, 23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015893196993061, "mean_inference_ms": 1.0405054959979434, "mean_action_processing_ms": 0.17281559124845647, "mean_env_wait_ms": 0.06824462990354163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003852367401123047, "StateBufferConnector_ms": 0.0025523900985717773, "ViewRequirementAgentConnector_ms": 0.0691990852355957}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.55977601858206, "num_env_steps_trained_throughput_per_sec": 498.55977601858206, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 7947.435, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7947.402, "sample_time_ms": 771.78, "learn_time_ms": 7162.025, "learn_throughput": 558.501, "synch_weights_time_ms": 12.925}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 106, "trial_id": "fa423_00000", "date": "2024-08-10_11-13-06", "timestamp": 1723302786, "time_this_iter_s": 8.028511047363281, "time_total_s": 864.6901867389679, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 864.6901867389679, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.1, "ram_util_percent": 77.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.506106961624963, "cur_kl_coeff": 2.3174285888671882e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.777102464216727, "policy_loss": -0.0030597569420933723, "vf_loss": 3.780162073947765, "vf_explained_var": -0.22654760706992377, "kl": 0.006491465637178879, "entropy": 0.41920912770367175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.754180858222147, "cur_kl_coeff": 4.073604941368102e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.285174194226662, "policy_loss": -0.003894417968209988, "vf_loss": 5.2890686000386875, "vf_explained_var": 0.12635107611616453, "kl": 0.003720914602836264, "entropy": 0.3721179160134246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 360.91, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36091, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -59.50390719758147}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 30.832636482768663}, "policy_reward_mean": {"agent_policy": 21.64703562890366, "adversary_policy": -10.823517814451835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [100, 400, 140, 400, 400, 23, 400, 400, 91, 400, 400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-12.122645283359248, 35.592557182590824, -45.59081715445173, -6.450855009967276, 8.538493494316272, -8.208742806514655, 25.230677076134015, 30.169552801756584, -45.57532641116764, -21.3110760699212, -17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673], "policy_adversary_policy_reward": [23.30541314285874, -11.182767859499492, -13.661520913339547, -21.931036269251273, 21.406911680392277, 24.18390547405945, 4.318585925112352, 2.132269084854924, -6.82369903508995, -1.7147944592263222, -3.5429756373412395, 11.751718443855896, -6.531804505034685, -18.69887257109933, -8.869647763509619, -21.29990503824697, 17.40672786775927, 28.168598543408372, -2.581504373666645, 23.89258044358784, 20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401567289321293, "mean_inference_ms": 1.0401478602642227, "mean_action_processing_ms": 0.1727378425352944, "mean_env_wait_ms": 0.06823497690795496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003804445266723633, "StateBufferConnector_ms": 0.0025638341903686523, "ViewRequirementAgentConnector_ms": 0.06933152675628662}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.0737933993291, "num_env_steps_trained_throughput_per_sec": 508.0737933993291, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 7954.955, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7954.921, "sample_time_ms": 775.509, "learn_time_ms": 7165.657, "learn_throughput": 558.218, "synch_weights_time_ms": 13.034}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "training_iteration": 107, "trial_id": "fa423_00000", "date": "2024-08-10_11-13-14", "timestamp": 1723302794, "time_this_iter_s": 7.8785717487335205, "time_total_s": 872.5687584877014, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a720e280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 872.5687584877014, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 27.458333333333332, "ram_util_percent": 77.20833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3421075972615095, "cur_kl_coeff": 2.3174285888671882e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.46283325556094, "policy_loss": -0.0031556232455408288, "vf_loss": 5.465988893609829, "vf_explained_var": 0.15385474591028123, "kl": 0.005218940283213218, "entropy": 0.38691395968987197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.410454923287034, "cur_kl_coeff": 2.036802470684051e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.273130864898364, "policy_loss": -0.004795610120345373, "vf_loss": 6.277926483253638, "vf_explained_var": 0.08198432841648658, "kl": 0.007836936172910007, "entropy": 0.5450309379957616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 370.78, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37078, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -59.50390719758147}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 34.90939467085584}, "policy_reward_mean": {"agent_policy": 25.33472136257204, "adversary_policy": -12.667360681286018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 150, 400, 400, 400, 53, 400, 400, 400, 400, 400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400], "policy_agent_policy_reward": [-17.340926831516022, -1.8215242497269273, -45.90759417028087, -2.4159711431355575, 10.923598067337966, -14.364282699928843, -2.9353887470999105, 49.3816783537396, -13.361151059524271, 43.38388477673864, -9.233992391124156, -3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486], "policy_adversary_policy_reward": [20.027334905127613, -2.686408073611588, 4.010167638344214, -2.1886433886172867, 17.480899706215265, 28.426694464065605, -3.1380803129892882, 5.554051456124846, -14.35468361104115, 3.4310855437031833, 12.524958691706146, 1.8393240082226967, -1.7806289871334293, 4.71601773423334, -5.0113690398702815, -44.37030931386931, -2.9447659861139037, 16.305917045638175, -12.144134170668806, -31.239750606069833, 12.712509367531641, -3.4785169764074855, -3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40153837320662994, "mean_inference_ms": 1.0395769148656728, "mean_action_processing_ms": 0.17263939416886687, "mean_env_wait_ms": 0.06818526526310749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003728628158569336, "StateBufferConnector_ms": 0.002516508102416992, "ViewRequirementAgentConnector_ms": 0.06882059574127197}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.888173109026, "num_env_steps_trained_throughput_per_sec": 496.888173109026, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 7964.853, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7964.819, "sample_time_ms": 784.768, "learn_time_ms": 7166.381, "learn_throughput": 558.162, "synch_weights_time_ms": 12.895}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 108, "trial_id": "fa423_00000", "date": "2024-08-10_11-13-22", "timestamp": 1723302802, "time_this_iter_s": 8.05583906173706, "time_total_s": 880.6245975494385, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a724a310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 880.6245975494385, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 25.291666666666668, "ram_util_percent": 77.3583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.03401822766299, "cur_kl_coeff": 2.3174285888671882e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.922556875811683, "policy_loss": -0.0015629857394193847, "vf_loss": 2.9241198504412615, "vf_explained_var": 0.017036429189500355, "kl": 0.0030185562803119012, "entropy": 0.2995106302162327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3689824638267356, "cur_kl_coeff": 2.036802470684051e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.80462238167723, "policy_loss": -0.0070763316640902, "vf_loss": 3.811698721100887, "vf_explained_var": 0.19788951793064674, "kl": 0.00719972761537501, "entropy": 0.1937912145551915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 376.75, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37675, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -59.50390719758147}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 34.90939467085584}, "policy_reward_mean": {"agent_policy": 30.15019160948659, "adversary_policy": -15.0750958047433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 28, 186, 400, 400, 400, 400, 400, 320, 400, 400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-3.238758135118278, -5.748591048240856, -12.974092064421198, -10.789406215452166, -30.93658323790529, 5.780649020117636, 13.016097187175482, -11.069244840555982, -13.106837240599152, -31.64801733648054, 24.58477455536677, 10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022], "policy_adversary_policy_reward": [-3.0316702442183967, 6.270428379336675, 4.640858096748211, 1.1077329514926504, 15.169452458243896, -2.1953603938226998, -4.280651485090582, 15.070057700542746, 25.414507869924734, 5.522075367980538, 1.102192426645729, -6.882841446763365, -8.268986335490325, -4.747110851685154, 6.429560723707326, 4.639684116848663, 6.188370384456743, 6.918466856142409, 2.29516123014694, 29.352856106333572, -14.023919109856067, -10.560855445510704, 7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40136452611180345, "mean_inference_ms": 1.0392160750401263, "mean_action_processing_ms": 0.17257551001564198, "mean_env_wait_ms": 0.06815387793446429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003614664077758789, "StateBufferConnector_ms": 0.002483367919921875, "ViewRequirementAgentConnector_ms": 0.06947946548461914}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.30201880571536, "num_env_steps_trained_throughput_per_sec": 505.30201880571536, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 7965.73, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7965.695, "sample_time_ms": 786.958, "learn_time_ms": 7164.949, "learn_throughput": 558.273, "synch_weights_time_ms": 13.017}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "training_iteration": 109, "trial_id": "fa423_00000", "date": "2024-08-10_11-13-30", "timestamp": 1723302810, "time_this_iter_s": 7.92186713218689, "time_total_s": 888.5464646816254, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a720e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 888.5464646816254, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 24.327272727272724, "ram_util_percent": 77.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0006070324668177, "cur_kl_coeff": 1.1587142944335941e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.506682006518046, "policy_loss": -0.0017136620090308565, "vf_loss": 2.508395668186208, "vf_explained_var": 0.024758102937980933, "kl": 0.0040934713422471495, "entropy": 0.4454973048476315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.943479936383665, "cur_kl_coeff": 2.036802470684051e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.273535439868768, "policy_loss": -0.0036062954226508737, "vf_loss": 4.277141724030177, "vf_explained_var": 0.22612537474681935, "kl": 0.004689278139661241, "entropy": 0.3105682400520891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.58, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38258, "policy_reward_min": {"agent_policy": -60.134095233011266, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 38.18517277357031}, "policy_reward_mean": {"agent_policy": 34.19320048015807, "adversary_policy": -17.096600240079034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 14, 400, 400, 400, 400, 400, 400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [10.551188721818606, -17.637358394904112, -13.272945683609048, -60.134095233011266, -0.45332298248973757, -6.498347028406585, -24.75741020542406, 27.198504724789863, 73.52577377419672, 21.806828159543084, 32.88606883264832, 2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487], "policy_adversary_policy_reward": [7.50132117716938, -18.05250989898798, 10.489229524043239, 7.148128870860873, 8.53173656111175, 4.741209122497288, 30.832636482768663, 29.30145875024261, 3.58966357870327, -3.1363405962135325, -0.4461056564911079, 6.944452684897693, 14.376673277677085, 10.380736927746973, 2.4363951291465753, -29.634899853936435, -31.49634718908922, -42.02942658510752, -22.3162140540543, 0.5093858945112189, -17.541611432708635, -15.344457399939671, 6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4011606251303561, "mean_inference_ms": 1.0388996994469901, "mean_action_processing_ms": 0.17257322460975139, "mean_env_wait_ms": 0.06814019268458289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038341283798217773, "StateBufferConnector_ms": 0.0025229454040527344, "ViewRequirementAgentConnector_ms": 0.07107365131378174}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.04939998578743, "num_env_steps_trained_throughput_per_sec": 492.04939998578743, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 7981.242, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7981.208, "sample_time_ms": 789.53, "learn_time_ms": 7178.133, "learn_throughput": 557.248, "synch_weights_time_ms": 12.795}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 110, "trial_id": "fa423_00000", "date": "2024-08-10_11-13-38", "timestamp": 1723302818, "time_this_iter_s": 8.134380102157593, "time_total_s": 896.680844783783, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a720e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 896.680844783783, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 25.208333333333332, "ram_util_percent": 77.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.519058694315966, "cur_kl_coeff": 5.793571472167971e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2207249554376753, "policy_loss": -0.0018102991530208519, "vf_loss": 2.22253524462382, "vf_explained_var": -0.013025548123808765, "kl": 0.0040689341368903564, "entropy": 0.4585825471335618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9831541210412977, "cur_kl_coeff": 1.0184012353420254e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9371040287117163, "policy_loss": -0.0062483711444656365, "vf_loss": 3.943352388093869, "vf_explained_var": 0.24442554681251447, "kl": 0.008605720408705641, "entropy": 0.2071553154150024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 383.16, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38316, "policy_reward_min": {"agent_policy": -43.116971910066844, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 38.18517277357031}, "policy_reward_mean": {"agent_policy": 36.57315599058046, "adversary_policy": -18.28657799529023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 163, 400, 400, 400, 400, 400, 400, 11, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400], "policy_agent_policy_reward": [2.0157880929090943, 56.39544993529277, -36.57159739860732, 5.997897261155388, 11.087560174260187, -9.881151288877604, 43.437077617010075, 63.841969662490996, 41.91406407099087, -16.46435688202175, 0.8660947350290401, 16.392916313466984, 60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809], "policy_adversary_policy_reward": [6.565842941463163, -8.581631034372258, -21.45609987700294, -34.93935005828982, 10.324610564553462, 26.24698683405384, -8.407283548665703, 2.4093862875103156, -0.2625439201009776, -10.825016254159213, 1.0036503743197258, 8.877500914557878, -31.987795199179924, -11.449282417830169, -27.677774733144552, -36.16419492934645, -32.77311104751594, -9.140953023474928, 4.338128454029892, 12.126228427991858, -16.206232652430277, 15.340137917401238, -8.75926418296443, -7.633652130502554, -28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4009191205371982, "mean_inference_ms": 1.038532289029439, "mean_action_processing_ms": 0.1724800684395834, "mean_env_wait_ms": 0.0680836906743521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003645777702331543, "StateBufferConnector_ms": 0.002531886100769043, "ViewRequirementAgentConnector_ms": 0.07005774974822998}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.38099626786317, "num_env_steps_trained_throughput_per_sec": 504.38099626786317, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 7952.308, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7952.271, "sample_time_ms": 791.469, "learn_time_ms": 7146.888, "learn_throughput": 559.684, "synch_weights_time_ms": 13.104}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "training_iteration": 111, "trial_id": "fa423_00000", "date": "2024-08-10_11-13-47", "timestamp": 1723302827, "time_this_iter_s": 7.936241865158081, "time_total_s": 904.617086648941, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a720ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 904.617086648941, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 24.96363636363636, "ram_util_percent": 77.39090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.428029297647022, "cur_kl_coeff": 2.8967857360839853e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.268433186049184, "policy_loss": -0.002285515205323617, "vf_loss": 2.270718697959153, "vf_explained_var": -0.02713488680975778, "kl": 0.005633876451785074, "entropy": 0.45530508513803836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.95019604684785, "cur_kl_coeff": 1.0184012353420254e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.114668482542038, "policy_loss": -0.0020447811439225916, "vf_loss": 4.116713284949461, "vf_explained_var": -0.005843912996351719, "kl": 0.0019060662152922644, "entropy": 0.13794893991822998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 393.3, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 39330, "policy_reward_min": {"agent_policy": -43.116971910066844, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 38.18517277357031}, "policy_reward_mean": {"agent_policy": 36.44855207298405, "adversary_policy": -18.22427603649203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [60.1312975210384, 73.37341130911773, -14.967148239025384, 28.57281459368254, 24.23162377711523, 49.660260438436985, 60.54335514506967, 58.64515454789191, 32.03863299828704, 77.82894630207707, 37.071679234533136, 59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782], "policy_adversary_policy_reward": [-28.096667780171046, -32.03462974086736, -15.167820130652359, -58.205591178465376, 1.1075868070986417, 13.859561431926757, -21.942144574551463, -6.6306700191310775, -12.50079375817775, -11.730830018937482, -30.655686215174693, -19.00457422326229, -42.35428977631367, -18.18906536875599, -12.105758763849217, -46.539395784042696, -21.760327992248826, -10.278305006038217, -45.71316543329206, -32.11578086878501, -8.92385257415053, -28.147826660382606, -32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401132690286561, "mean_inference_ms": 1.0386423602578903, "mean_action_processing_ms": 0.17252871862233113, "mean_env_wait_ms": 0.06809428277297211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003651857376098633, "StateBufferConnector_ms": 0.002570509910583496, "ViewRequirementAgentConnector_ms": 0.0727834701538086}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.7406512275009, "num_env_steps_trained_throughput_per_sec": 440.7406512275009, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 8058.331, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8058.292, "sample_time_ms": 836.797, "learn_time_ms": 7208.021, "learn_throughput": 554.937, "synch_weights_time_ms": 12.638}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 112, "trial_id": "fa423_00000", "date": "2024-08-10_11-13-56", "timestamp": 1723302836, "time_this_iter_s": 9.081743955612183, "time_total_s": 913.6988306045532, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9847310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 913.6988306045532, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 35.699999999999996, "ram_util_percent": 78.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3016727422595653, "cur_kl_coeff": 2.8967857360839853e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6840101060413177, "policy_loss": -0.002262956324826788, "vf_loss": 2.6862730573094082, "vf_explained_var": -0.05182786669049944, "kl": 0.0035029914685604127, "entropy": 0.4667536981049038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9826381254941223, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.538669777413209, "policy_loss": -0.004989219136283888, "vf_loss": 4.543658999602, "vf_explained_var": 0.18459861439963182, "kl": 0.009114689803322133, "entropy": 0.2896310321210573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.46, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38946, "policy_reward_min": {"agent_policy": -43.116971910066844, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 38.18517277357031}, "policy_reward_mean": {"agent_policy": 32.76414861067502, "adversary_policy": -16.38207430533751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [59.71830378391372, 47.83643383298127, 61.51834984873385, 61.57533369932983, 60.64429554762564, 58.374622098193306, 40.09349834382085, 78.4785621320616, 18.444351302179236, -8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619], "policy_adversary_policy_reward": [-32.02008703589875, -27.698216748014968, -26.42296316681236, -21.413470666168912, -17.798200779000467, -43.72014906973338, -32.418351738837416, -29.15698196049242, -25.962361062372878, -34.68193448525276, -33.81921221273329, -24.555409885460044, -30.119280567768214, -9.974217776052633, -35.56952197232001, -42.90904015974158, 10.861619711163605, -29.30597101334282, -8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4011399882502304, "mean_inference_ms": 1.0388944927931836, "mean_action_processing_ms": 0.17258438821049102, "mean_env_wait_ms": 0.06809404013481948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003846406936645508, "StateBufferConnector_ms": 0.0026040077209472656, "ViewRequirementAgentConnector_ms": 0.07268297672271729}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.8207817480277, "num_env_steps_trained_throughput_per_sec": 486.8207817480277, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 8093.416, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8093.377, "sample_time_ms": 839.109, "learn_time_ms": 7240.898, "learn_throughput": 552.418, "synch_weights_time_ms": 12.586}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "training_iteration": 113, "trial_id": "fa423_00000", "date": "2024-08-10_11-14-04", "timestamp": 1723302844, "time_this_iter_s": 8.22160792350769, "time_total_s": 921.9204385280609, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9847670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 921.9204385280609, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 28.224999999999998, "ram_util_percent": 78.91666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6059012224434546, "cur_kl_coeff": 1.4483928680419927e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.920908226222588, "policy_loss": -0.004207722322335319, "vf_loss": 2.925115943964196, "vf_explained_var": 0.0630224208983164, "kl": 0.01841768652785813, "entropy": 0.5685077652256325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6236076567322018, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.226511097947756, "policy_loss": -0.0043843519869066466, "vf_loss": 5.230895470331112, "vf_explained_var": 0.18987263459712267, "kl": 0.006180868542509177, "entropy": 0.343310219872122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": -1.1102230246251566e-18, "episode_len_mean": 387.15, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38715, "policy_reward_min": {"agent_policy": -48.35105471991506, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 118.07647256957335, "adversary_policy": 42.369596483433305}, "policy_reward_mean": {"agent_policy": 27.50379343894298, "adversary_policy": -13.75189671947149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400], "policy_agent_policy_reward": [-8.664717298077658, 70.68132064332283, 31.022242440405044, 47.20153105407205, 44.34398217874804, 35.80227871091053, 81.3221692774708, 118.07647256957335, 50.32968109246336, 41.19456058065586, 75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075], "policy_adversary_policy_reward": [-8.734458432768186, 17.399175730845812, -33.59680970716519, -37.08451093615764, -17.196961056803737, -13.825281383601308, -14.74943966495335, -32.4520913891187, -38.43581374698867, -5.908168431759378, -27.20978784037874, -8.592490870531783, -43.97421595226871, -37.34795332520211, -59.50390719758147, -58.5725653719919, -8.75827876814472, -41.57140232431864, -17.830436891070477, -23.364123689585384, -42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40119757864307815, "mean_inference_ms": 1.0391239715836305, "mean_action_processing_ms": 0.17262629093933493, "mean_env_wait_ms": 0.06810002390855817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038717985153198242, "StateBufferConnector_ms": 0.0026082992553710938, "ViewRequirementAgentConnector_ms": 0.07436621189117432}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": -1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.29679132210316, "num_env_steps_trained_throughput_per_sec": 499.29679132210316, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 8093.341, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8093.302, "sample_time_ms": 840.825, "learn_time_ms": 7239.197, "learn_throughput": 552.547, "synch_weights_time_ms": 12.526}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 114, "trial_id": "fa423_00000", "date": "2024-08-10_11-14-12", "timestamp": 1723302852, "time_this_iter_s": 8.016056060791016, "time_total_s": 929.9364945888519, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a724a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 929.9364945888519, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 29.066666666666674, "ram_util_percent": 79.49166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.63964526691134, "cur_kl_coeff": 1.4483928680419927e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1724670208320416, "policy_loss": -0.003913317301690027, "vf_loss": 3.1763803277696883, "vf_explained_var": 0.05855221530747792, "kl": 0.006258291128803707, "entropy": 0.5948439033573898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.252806498669088, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.773261945694685, "policy_loss": -0.004023099786233312, "vf_loss": 5.777285042901834, "vf_explained_var": 0.15459215715527536, "kl": 0.010485575794626957, "entropy": 0.29505295598258574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": -1.1102230246251566e-18, "episode_len_mean": 383.19, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38319, "policy_reward_min": {"agent_policy": -48.35105471991506, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 106.64173892481878, "adversary_policy": 43.705227313370315}, "policy_reward_mean": {"agent_policy": 21.997892730364256, "adversary_policy": -10.99894636518213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400], "policy_agent_policy_reward": [75.98553089733986, 41.27431427973282, 96.21529591802599, 2.3051323257515435, 66.35198579607791, 34.84082514504856, 21.791243786367556, 46.566584300553245, 0.7007316766580622, 14.489825911786653, 87.76381162916927, 35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625], "policy_adversary_policy_reward": [-42.95124077404532, -33.03429012329453, -20.44364976486295, -20.830664514869866, -42.05575555289092, -54.15954036513506, -19.25806821028768, 16.95293588453613, -36.881643896082856, -29.47034189999507, -17.8892324030214, -16.951592742027163, -26.940071053749847, 5.148827267382288, -14.512308260173043, -32.0542760403802, -3.095275135651992, 2.3945434589939296, 7.946761644149177, -22.43658755593583, -43.86080493871399, -43.90300669045531, -8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40127885395669594, "mean_inference_ms": 1.039561544838157, "mean_action_processing_ms": 0.17267756239886733, "mean_env_wait_ms": 0.06810220270065179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003828883171081543, "StateBufferConnector_ms": 0.002559065818786621, "ViewRequirementAgentConnector_ms": 0.07374119758605957}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": -1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.5876145194294, "num_env_steps_trained_throughput_per_sec": 484.5876145194294, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 8147.991, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8147.953, "sample_time_ms": 859.161, "learn_time_ms": 7275.722, "learn_throughput": 549.774, "synch_weights_time_ms": 12.352}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "training_iteration": 115, "trial_id": "fa423_00000", "date": "2024-08-10_11-14-21", "timestamp": 1723302861, "time_this_iter_s": 8.258468866348267, "time_total_s": 938.1949634552002, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9847700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 938.1949634552002, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 26.841666666666672, "ram_util_percent": 79.55833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.840637708782519, "cur_kl_coeff": 1.4483928680419927e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7873771308591127, "policy_loss": -0.005257186579897448, "vf_loss": 2.7926343123118085, "vf_explained_var": -0.1253117405863666, "kl": 0.006858042916776689, "entropy": 0.5689210006799648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2969309840972225, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.775444742540518, "policy_loss": -0.0075768407536088486, "vf_loss": 4.783021576702595, "vf_explained_var": 0.25210919001450144, "kl": 0.005596055266715292, "entropy": 0.3324113062893351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": -1.1102230246251566e-18, "episode_len_mean": 379.27, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37927, "policy_reward_min": {"agent_policy": -48.35105471991506, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 106.64173892481878, "adversary_policy": 43.705227313370315}, "policy_reward_mean": {"agent_policy": 16.56399973445154, "adversary_policy": -8.28199986722577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 141, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8], "policy_agent_policy_reward": [35.87429085029195, 12.826843963182359, -33.98657336684667, 73.88368496358673, 70.71413766476418, 14.663341329709986, 37.66309384402903, 47.248497617658884, 41.895799623509276, -43.116971910066844, 67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085], "policy_adversary_policy_reward": [-8.230952490404725, -27.643338359887224, -4.530177804404275, -8.296666158778084, 15.254516599136647, 18.732056767710006, -27.861304075875836, -46.02238088771094, -16.261060132928662, -54.45307753183549, -4.461860047112133, -10.201481282597861, -19.90429634534221, -17.758797498686818, -22.220731755030265, -25.027765862628613, -33.32716966823632, -8.568629955272966, 8.207577239211005, 34.90939467085584, -31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015445806771571, "mean_inference_ms": 1.040489579706088, "mean_action_processing_ms": 0.1727604827325681, "mean_env_wait_ms": 0.06813212879308564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395655632019043, "StateBufferConnector_ms": 0.0026149749755859375, "ViewRequirementAgentConnector_ms": 0.07483291625976562}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": -1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.586048389704, "num_env_steps_trained_throughput_per_sec": 485.586048389704, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 8169.427, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8169.389, "sample_time_ms": 886.478, "learn_time_ms": 7269.916, "learn_throughput": 550.213, "synch_weights_time_ms": 12.281}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 116, "trial_id": "fa423_00000", "date": "2024-08-10_11-14-29", "timestamp": 1723302869, "time_this_iter_s": 8.242969989776611, "time_total_s": 946.4379334449768, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9847a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 946.4379334449768, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 27.20833333333334, "ram_util_percent": 78.65833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.395682170939824, "cur_kl_coeff": 1.4483928680419927e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.805312805831748, "policy_loss": -0.004303613768782092, "vf_loss": 3.8096164173550076, "vf_explained_var": -0.19866232433647074, "kl": 0.004884965594026993, "entropy": 0.5818596147986316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.957600279028217, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.465417025486628, "policy_loss": -0.00597455628036793, "vf_loss": 5.4713915626207985, "vf_explained_var": 0.2279253862798214, "kl": 0.005603074387402346, "entropy": 0.41323644773413737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": -1.1102230246251566e-18, "episode_len_mean": 379.76, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37976, "policy_reward_min": {"agent_policy": -50.64908483659373, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 106.64173892481878, "adversary_policy": 43.705227313370315}, "policy_reward_mean": {"agent_policy": 13.888430982583372, "adversary_policy": -6.944215491291687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400], "policy_agent_policy_reward": [67.97991424021481, 47.22793392429895, 13.26860829298861, 31.496036559146486, 9.079056351059624, 84.99631973475636, 40.55668099562073, 7.684252482912065, 46.833883746401845, 22.554272565837614, 60.03544906899625, 16.00776899787754, 12.390238616064648, 106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902], "policy_adversary_policy_reward": [-31.91643474653138, -36.06347949368347, -49.47757348294025, 2.2496395586412987, -6.789531397693732, -6.479076895294881, -11.344138618226676, -20.151897940919813, -0.9010505576790511, -8.17800579338057, -44.33847467171574, -40.657845063040604, -38.04623609358972, -2.5104449020310398, 23.817844077892474, -31.50209656080454, -20.429709521572484, -26.40417422482936, -6.307416202086337, -16.246856363751277, -17.509807819679466, -42.52564124931679, -15.77385589550222, -0.23391310237531826, -40.524074419319575, 28.133835803254925, -51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4018240428798, "mean_inference_ms": 1.0417327944053765, "mean_action_processing_ms": 0.17285774888567382, "mean_env_wait_ms": 0.06817607194104833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004043936729431152, "StateBufferConnector_ms": 0.002758026123046875, "ViewRequirementAgentConnector_ms": 0.07603442668914795}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": -1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.8401737365701, "num_env_steps_trained_throughput_per_sec": 454.8401737365701, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 8261.57, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8261.532, "sample_time_ms": 932.509, "learn_time_ms": 7316.266, "learn_throughput": 546.727, "synch_weights_time_ms": 12.044}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "training_iteration": 117, "trial_id": "fa423_00000", "date": "2024-08-10_11-14-38", "timestamp": 1723302878, "time_this_iter_s": 8.79909610748291, "time_total_s": 955.2370295524597, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9847dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 955.2370295524597, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 30.684615384615384, "ram_util_percent": 79.88461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4186532419509987, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4006886547835418, "policy_loss": -0.00652330649164185, "vf_loss": 3.407211966110916, "vf_explained_var": -0.0825336151652866, "kl": 0.010537915371160809, "entropy": 0.5299565078404845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.911595935684939, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.811520823836327, "policy_loss": -0.00838405135194383, "vf_loss": 5.819904881715774, "vf_explained_var": 0.30466960606475674, "kl": 0.0076508719550468195, "entropy": 0.2677339210252588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": -1.1102230246251566e-18, "episode_len_mean": 377.11, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 37711, "policy_reward_min": {"agent_policy": -50.64908483659373, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 106.64173892481878, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": 9.256636539012263, "adversary_policy": -4.628318269506132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 317, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400], "policy_agent_policy_reward": [106.64173892481878, 71.07569311259022, -14.705250867094811, 12.303619386126964, -16.15431478449653, 96.48159478888942, 1.8944608007802834, 35.66685346915175, 25.560007839000146, 3.808554988022255, 106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364], "policy_adversary_policy_reward": [-51.88212402396564, -54.759614900853144, -38.294645973610976, -32.78104713897925, 7.579436410004483, 7.125814457090328, -5.043980561135708, -7.2596388249912565, -22.03085798907379, 38.18517277357031, -48.53816045565188, -47.94343433323758, 11.390095675442861, -13.284556476223145, -22.762112409026507, -12.90474106012524, -26.740679189702142, 1.1806713507019815, -1.1345300292218496, -2.6740249588004055, -59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021969439834578, "mean_inference_ms": 1.0433292570954358, "mean_action_processing_ms": 0.17303353341805494, "mean_env_wait_ms": 0.06826477006297521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004121065139770508, "StateBufferConnector_ms": 0.0027843713760375977, "ViewRequirementAgentConnector_ms": 0.07689487934112549}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": -1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.44196290925515, "num_env_steps_trained_throughput_per_sec": 503.44196290925515, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 8251.09, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8251.053, "sample_time_ms": 922.16, "learn_time_ms": 7316.277, "learn_throughput": 546.726, "synch_weights_time_ms": 11.931}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 118, "trial_id": "fa423_00000", "date": "2024-08-10_11-14-46", "timestamp": 1723302886, "time_this_iter_s": 7.9505438804626465, "time_total_s": 963.1875734329224, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98c0160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 963.1875734329224, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 24.545454545454547, "ram_util_percent": 80.08181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0034196011919194, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.010659542033281, "policy_loss": -0.006056235664987335, "vf_loss": 4.016715771306759, "vf_explained_var": -0.32788448084599126, "kl": 0.012613534922004826, "entropy": 0.5675282703505622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1137353661780556, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.609794876972834, "policy_loss": -0.0033337173309215965, "vf_loss": 5.613128592073918, "vf_explained_var": 0.38025980529685816, "kl": 0.0036952810870217964, "entropy": 0.574909058958292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": -1.1102230246251566e-18, "episode_len_mean": 377.94, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37794, "policy_reward_min": {"agent_policy": -50.64908483659373, "adversary_policy": -59.59888080421391}, "policy_reward_max": {"agent_policy": 106.5984227602176, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": 6.050009203927937, "adversary_policy": -3.0250046019639676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 72, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [106.5984227602176, 72.60644327563139, 4.11048605480487, -3.786086677642796, 7.089833687978025, 59.391014840312245, 18.04211603465075, 3.4043804785198866, 4.1144001826636725, -1.9606024911933702, 18.657190612144483, 56.66424093715436, 75.05813580459616, 44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786], "policy_adversary_policy_reward": [-59.59888080421391, -46.99954195600368, -21.12992656386015, -51.476516711771254, 0.023684840841966093, -4.134170895646836, 7.0532241689229735, -3.267137491280174, -10.735688497436442, 3.6458548094584167, -52.94345313891437, -6.447561701397916, -9.872282710538517, -8.169833324112233, -11.652972739787188, 8.248592261267301, 9.390474998604521, -13.504875181268162, 5.3974968761909565, -3.4368943849975864, 29.0707581654948, -47.727948777639305, -57.64204912642591, 0.9778081892715456, -39.72200101650302, -35.33613478809316, -1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026401210479492, "mean_inference_ms": 1.0445394394722054, "mean_action_processing_ms": 0.1731437493137695, "mean_env_wait_ms": 0.06832838904050405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003907442092895508, "StateBufferConnector_ms": 0.00274813175201416, "ViewRequirementAgentConnector_ms": 0.0756305456161499}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": -1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.9602785240331, "num_env_steps_trained_throughput_per_sec": 496.9602785240331, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 8264.378, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8264.34, "sample_time_ms": 924.954, "learn_time_ms": 7326.968, "learn_throughput": 545.928, "synch_weights_time_ms": 11.758}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "training_iteration": 119, "trial_id": "fa423_00000", "date": "2024-08-10_11-14-54", "timestamp": 1723302894, "time_this_iter_s": 8.054187059402466, "time_total_s": 971.2417604923248, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98c04c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 971.2417604923248, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 23.775000000000002, "ram_util_percent": 80.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.930612748167502, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.232291925142682, "policy_loss": -0.00556882462370648, "vf_loss": 5.237860736897383, "vf_explained_var": 0.03369065747059211, "kl": 0.01024237938483078, "entropy": 0.6034598778164576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.671821546430389, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.814325187603632, "policy_loss": -0.009526127900365585, "vf_loss": 6.823851296305657, "vf_explained_var": 0.16646065711975097, "kl": 0.010258081202757044, "entropy": 0.6763666514928143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -3.3306690738754695e-18, "episode_len_mean": 370.62, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 37062, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -53.548780637475225}, "policy_reward_max": {"agent_policy": 74.6228061475407, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": 0.6235797561217541, "adversary_policy": -0.3117898780608772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400], "policy_agent_policy_reward": [44.53581231820809, 3.267781486921722, 41.74589516992789, -14.910730288916902, 5.962000508782381, 59.22924587377209, 71.16412746735756, 18.144791687436285, -5.230991799169832, -8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393], "policy_adversary_policy_reward": [-1.3081558033515108, -43.2276565148566, -0.9121491125041992, -2.3556323744175174, -23.255240209108713, -18.49065496081916, 1.3110173187532332, 13.599712970163669, -0.9274412992219432, -5.034559209560438, -16.738875731633318, -42.49037014213878, -43.9154584453923, -27.24866902196522, 13.5190300394008, -31.66382172683709, 11.676042243822565, -6.445050444652733, -14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40298251250215517, "mean_inference_ms": 1.0460785588688208, "mean_action_processing_ms": 0.17341945925218064, "mean_env_wait_ms": 0.06838680248541254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040367841720581055, "StateBufferConnector_ms": 0.0027735233306884766, "ViewRequirementAgentConnector_ms": 0.07725763320922852}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.72442733086683, "num_env_steps_trained_throughput_per_sec": 492.72442733086683, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 8263.264, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8263.227, "sample_time_ms": 928.654, "learn_time_ms": 7321.977, "learn_throughput": 546.301, "synch_weights_time_ms": 11.941}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 120, "trial_id": "fa423_00000", "date": "2024-08-10_11-15-03", "timestamp": 1723302903, "time_this_iter_s": 8.124300003051758, "time_total_s": 979.3660604953766, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a724ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 979.3660604953766, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 24.349999999999998, "ram_util_percent": 79.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.24813557948385, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6912092501524265, "policy_loss": -0.006909014622399968, "vf_loss": 2.698118263829953, "vf_explained_var": -0.17566505727313814, "kl": 0.005164714773933584, "entropy": 0.6115856718449365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.271342784538865, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7415998754402, "policy_loss": -0.0048975562705891205, "vf_loss": 4.746497419228157, "vf_explained_var": 0.272752753769358, "kl": 0.01663005208771508, "entropy": 0.5232370487414301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -3.3306690738754695e-18, "episode_len_mean": 370.62, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37062, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -53.548780637475225}, "policy_reward_max": {"agent_policy": 74.6228061475407, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": -1.9892151343414373, "adversary_policy": 0.9946075671707183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-8.54420715965121, 30.016053776260662, -34.41642531219563, 0.14377912293251782, -15.222642027907554, 20.03355851022892, -8.12268228362785, -1.5980774850313137, -7.002298462803509, -1.3375229358438325, 61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647], "policy_adversary_policy_reward": [-14.456612213991317, 23.00081937364254, 0.9553501085769938, -30.971403884837656, 5.39783870504343, 29.01858660715221, 0.5089686787937318, -0.6527478017262496, 14.454568935099598, 0.7680730928079775, -41.70799787626267, 21.67443936603375, 7.108097214332453, 1.0145850692954035, -11.735655083067929, 13.333732568099242, 2.328570741954074, 4.673727720849435, 7.467009352772674, -6.129486416928845, -39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40313556465393213, "mean_inference_ms": 1.0467952864492782, "mean_action_processing_ms": 0.17337186918061692, "mean_env_wait_ms": 0.06842437698489023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003996610641479492, "StateBufferConnector_ms": 0.0027278661727905273, "ViewRequirementAgentConnector_ms": 0.07409429550170898}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.5847947124108, "num_env_steps_trained_throughput_per_sec": 486.5847947124108, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 8292.269, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8292.234, "sample_time_ms": 926.037, "learn_time_ms": 7353.787, "learn_throughput": 543.937, "synch_weights_time_ms": 11.816}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "training_iteration": 121, "trial_id": "fa423_00000", "date": "2024-08-10_11-15-11", "timestamp": 1723302911, "time_this_iter_s": 8.226494312286377, "time_total_s": 987.592554807663, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98c0820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 987.592554807663, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 26.809090909090912, "ram_util_percent": 80.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2036524479351347, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8969262216456984, "policy_loss": -0.006597989068302528, "vf_loss": 3.903524197598614, "vf_explained_var": -0.20339918757872608, "kl": 0.005888009579950543, "entropy": 0.6075925295945829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9473956153417626, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.698618325094382, "policy_loss": -0.007960516440410478, "vf_loss": 5.706578836341699, "vf_explained_var": 0.2717133647451798, "kl": 0.012127576152947966, "entropy": 0.7112315813079476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -3.3306690738754695e-18, "episode_len_mean": 374.46, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37446, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -53.548780637475225}, "policy_reward_max": {"agent_policy": 74.6228061475407, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": -1.2956446876884744, "adversary_policy": 0.6478223438442368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [61.46975980974963, 43.227592124684975, -13.306348122327943, -6.4541857139868135, 47.00252798418619, -3.231520727811562, -48.35105471991506, 8.125884381804536, -22.735723488067766, -3.263311952209815, -26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708], "policy_adversary_policy_reward": [-39.44548262463909, -22.024277185110527, 10.32118851279025, -53.548780637475225, 37.26962279812905, -23.963274675801138, 16.2337719384952, -9.779586224508385, -3.100060939047312, -43.90246704513887, 11.753944365151808, -8.522423637340246, 21.690653373494065, 26.66040134642103, 8.298832388773352, -16.424716770577888, 9.024269973956034, 13.711453514111732, -10.078289569711743, 13.341601521921557, 42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032186483296731, "mean_inference_ms": 1.047400291746067, "mean_action_processing_ms": 0.17344091338501516, "mean_env_wait_ms": 0.06840836709740764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040471553802490234, "StateBufferConnector_ms": 0.0027654170989990234, "ViewRequirementAgentConnector_ms": 0.07533371448516846}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.55433115262355, "num_env_steps_trained_throughput_per_sec": 487.55433115262355, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 8205.127, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8205.093, "sample_time_ms": 878.087, "learn_time_ms": 7314.758, "learn_throughput": 546.84, "synch_weights_time_ms": 11.656}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 122, "trial_id": "fa423_00000", "date": "2024-08-10_11-15-19", "timestamp": 1723302919, "time_this_iter_s": 8.208477258682251, "time_total_s": 995.8010320663452, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98c0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 995.8010320663452, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 24.333333333333332, "ram_util_percent": 80.00833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2376057848728523, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5837782403148672, "policy_loss": -0.004606369281897233, "vf_loss": 3.588384603066419, "vf_explained_var": -0.26070413110117435, "kl": 0.009276097826243593, "entropy": 0.5698890787268441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.444278357923031, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7921516614655655, "policy_loss": -0.004456319345869512, "vf_loss": 4.796607968211174, "vf_explained_var": 0.3641803108776609, "kl": 0.0064260998020978215, "entropy": 0.8872212408731381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -3.3306690738754695e-18, "episode_len_mean": 370.52, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37052, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -40.25315818925967}, "policy_reward_max": {"agent_policy": 74.6228061475407, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": -1.5925291635307424, "adversary_policy": 0.7962645817653707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [169, 400, 400, 400, 400, 400, 400, 400, 400, 119, 400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400], "policy_agent_policy_reward": [-26.20591862685142, 4.740280782512965, 74.6228061475407, -23.053208381367075, 29.77303882769104, -17.522908973655568, 25.68875251005555, -23.97755808220613, 26.875069113403395, -8.867679596301373, 3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558], "policy_adversary_policy_reward": [42.369596483433305, -16.16367785658189, 4.1313877014433835, -8.87166848395633, -40.25315818925967, -34.36964795828108, -3.1853453755435055, 26.238553756910576, -21.335309907394148, -8.437728920296873, 14.763459015824552, 2.759449957831025, -2.004658484184951, -23.6840940258706, 6.986274963657696, 16.991283118548434, -17.83388081974726, -9.04118829365613, -32.35513575458871, 41.22281535089008, -3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40334788994792375, "mean_inference_ms": 1.0480104234595025, "mean_action_processing_ms": 0.1734450320581265, "mean_env_wait_ms": 0.06844427406948775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038031339645385742, "StateBufferConnector_ms": 0.0027927160263061523, "ViewRequirementAgentConnector_ms": 0.07611525058746338}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.13955840864026, "num_env_steps_trained_throughput_per_sec": 504.13955840864026, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 8176.9, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8176.866, "sample_time_ms": 874.659, "learn_time_ms": 7289.679, "learn_throughput": 548.721, "synch_weights_time_ms": 11.928}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "training_iteration": 123, "trial_id": "fa423_00000", "date": "2024-08-10_11-15-28", "timestamp": 1723302928, "time_this_iter_s": 7.939886093139648, "time_total_s": 1003.7409181594849, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98c0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1003.7409181594849, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 24.59166666666667, "ram_util_percent": 80.10833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2556741654557526, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.445579138760844, "policy_loss": -0.008377576690837347, "vf_loss": 3.4539567247269645, "vf_explained_var": -0.10201140456098728, "kl": 0.005981070763873167, "entropy": 0.5766613282696911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.309162388990323, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.651487033565839, "policy_loss": -0.008152857716292298, "vf_loss": 4.659639875094096, "vf_explained_var": 0.397688049202164, "kl": 0.015211868475887513, "entropy": 1.1365669813007115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 375.64, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37564, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -30.67518139177338}, "policy_reward_max": {"agent_policy": 42.38365658029393, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": -1.872232269754949, "adversary_policy": 0.9361161348774744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 285, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [3.0281403673705434, -7.651454375548157, -42.77047324945768, -23.855476149679625, 3.4092002234912258, -19.829897916238124, 21.758237640957137, -6.937737624938869, 10.525727705169388, -15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461], "policy_adversary_policy_reward": [-3.217090020128623, 0.18894965275807962, 7.743994444517522, -0.09254006896936495, 43.705227313370315, -0.9347540639126493, 13.961688453718637, 9.893787695960988, 1.5919356173487298, -5.001135840839957, 9.442926479160928, 10.3869714370772, -10.28851961793309, -11.46971802302404, -5.831467615426035, 12.769205240364887, -4.043117865478806, -6.482609839690582, -6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40343395054602227, "mean_inference_ms": 1.0485825398778637, "mean_action_processing_ms": 0.17347541667790778, "mean_env_wait_ms": 0.06845910681246943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037860870361328125, "StateBufferConnector_ms": 0.0027892589569091797, "ViewRequirementAgentConnector_ms": 0.0755910873413086}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.16699873925296, "num_env_steps_trained_throughput_per_sec": 485.16699873925296, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 8200.232, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8200.198, "sample_time_ms": 873.53, "learn_time_ms": 7313.792, "learn_throughput": 546.912, "synch_weights_time_ms": 12.235}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 124, "trial_id": "fa423_00000", "date": "2024-08-10_11-15-36", "timestamp": 1723302936, "time_this_iter_s": 8.250555992126465, "time_total_s": 1011.9914741516113, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98d1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1011.9914741516113, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 26.250000000000004, "ram_util_percent": 80.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3507707858527147, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.613365834226053, "policy_loss": -0.005754793252396796, "vf_loss": 3.6191206373234905, "vf_explained_var": -0.3147798986346633, "kl": 0.013007199544364943, "entropy": 0.6570282620412332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.825118262631198, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.822162708640098, "policy_loss": -0.01002298474656224, "vf_loss": 5.832185683151086, "vf_explained_var": 0.2879007219026486, "kl": 0.013479330416240769, "entropy": 0.8004198749239246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 376.79, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37679, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -31.605917481000645}, "policy_reward_max": {"agent_policy": 43.60340823827136, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": -0.0852041040496308, "adversary_policy": 0.04260205202481529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-15.980224040273022, -5.624679637189658, 9.748877465732345, -2.1939039721445432, -35.452189304155596, -14.52742846517085, 21.116581914590675, -9.496120762438927, -7.27060632719844, 3.262081365937533, 23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054], "policy_adversary_policy_reward": [-6.587519048849998, 22.56774308912302, 2.0437818742560694, 3.5808977629335885, -22.601484981796734, 12.852607516064417, 5.37856194639458, -3.1846579742500296, 22.38993234574616, 13.062256958409435, 6.528768810229649, 7.998659654941201, -11.154749197073475, -9.961832717517199, 17.705611128277514, -8.209490365838583, 2.96333923585442, 4.30726709134402, 0.8110898909551025, -4.0731712568926355, -19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4035473838368159, "mean_inference_ms": 1.048938034225364, "mean_action_processing_ms": 0.17350920603932266, "mean_env_wait_ms": 0.0684767628726504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036982297897338867, "StateBufferConnector_ms": 0.0027822256088256836, "ViewRequirementAgentConnector_ms": 0.07484853267669678}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.6948108400462, "num_env_steps_trained_throughput_per_sec": 489.6948108400462, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 8191.623, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8191.589, "sample_time_ms": 873.213, "learn_time_ms": 7305.334, "learn_throughput": 547.545, "synch_weights_time_ms": 12.392}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "training_iteration": 125, "trial_id": "fa423_00000", "date": "2024-08-10_11-15-44", "timestamp": 1723302944, "time_this_iter_s": 8.174438238143921, "time_total_s": 1020.1659123897552, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98d15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1020.1659123897552, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 25.89090909090909, "ram_util_percent": 80.15454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.307771807845938, "cur_kl_coeff": 7.241964340209963e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.320333433971203, "policy_loss": -0.004718067471021737, "vf_loss": 3.325051495511696, "vf_explained_var": -0.043985195986177554, "kl": 0.004309675281746185, "entropy": 0.4937636126128454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.402191150933504, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.245810886224111, "policy_loss": -0.0048245318253369385, "vf_loss": 4.250635418544213, "vf_explained_var": 0.18551153801381587, "kl": 0.013781050291847103, "entropy": 0.7920700720821817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 376.99, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37699, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -31.89262421998209}, "policy_reward_max": {"agent_policy": 43.60340823827136, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": 0.7258039816210341, "adversary_policy": -0.3629019908105174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 190, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400], "policy_agent_policy_reward": [23.44004258274653, -5.258254270434815, 15.90746902807987, -50.64908483659373, -3.032199812575154, 2.089360510888902, 16.381286913110145, 31.113402976184876, 9.175042437777773, 21.057683196219195, 0.5067403609680348, 4.685130204529592, -35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326], "policy_adversary_policy_reward": [-19.745341101374276, -3.6947014813722525, -16.062991652714466, 21.32124592314926, -0.2516497307946999, -15.655819297285184, 35.51262599259624, 15.136458843997497, -8.075750029304277, 11.107949841879428, 19.238266375417894, -21.327626886306795, 7.174033218861435, -23.555320131971566, -21.900447896099095, -9.212955080085798, 0.31897498166807026, -9.494017419445846, -3.3861375432197995, -17.67154565299939, -1.0784644315891008, 0.5717240706210731, 11.859189180487192, -16.544319385016784, 16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4035342562855922, "mean_inference_ms": 1.0491053794318541, "mean_action_processing_ms": 0.17349752706462535, "mean_env_wait_ms": 0.06846040922837478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036363601684570312, "StateBufferConnector_ms": 0.0026617050170898438, "ViewRequirementAgentConnector_ms": 0.07552146911621094}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.1627586440973, "num_env_steps_trained_throughput_per_sec": 495.1627586440973, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 8175.691, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8175.657, "sample_time_ms": 842.962, "learn_time_ms": 7319.332, "learn_throughput": 546.498, "synch_weights_time_ms": 12.685}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 126, "trial_id": "fa423_00000", "date": "2024-08-10_11-15-53", "timestamp": 1723302953, "time_this_iter_s": 8.083838939666748, "time_total_s": 1028.249751329422, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98c0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1028.249751329422, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 24.049999999999997, "ram_util_percent": 79.81666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.418657755757135, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4524144426224725, "policy_loss": -0.009877243905485899, "vf_loss": 3.462291687253922, "vf_explained_var": -0.1687353146139276, "kl": 0.006834961292662837, "entropy": 0.4808620646674797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9373287389054896, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6294612323244415, "policy_loss": -0.006958509681135183, "vf_loss": 5.636419763167699, "vf_explained_var": 0.1992047619074583, "kl": 0.014135409786561892, "entropy": 1.1698926879713933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 379.09, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37909, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -31.89262421998209}, "policy_reward_max": {"agent_policy": 43.60340823827136, "adversary_policy": 56.652164022199095}, "policy_reward_mean": {"agent_policy": 1.1891075103018613, "adversary_policy": -0.5945537551509311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 135, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-35.69813857815515, 17.68026113931812, -26.437374263549536, -14.154803826788486, -23.89563206174849, -19.400547924391727, 15.917920645590364, -23.499381885314698, -3.9285050514535342, 20.986434672657342, 2.3009940906010193, 2.6274090058091844, -13.074294940542321, -12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606], "policy_adversary_policy_reward": [16.339169770807835, 19.358968807347324, -11.591159829525274, -6.089101309792849, 56.652164022199095, -30.214789758649573, 15.173109942875655, -1.0183061160871887, 8.300878721127738, 15.594753340620723, 1.9978532529360713, 17.40269467145566, -15.648845410753491, -0.2690752348368761, 9.432469802599151, 14.066912082715547, -4.277859663763721, 8.206364715217255, -11.306923691868, -9.679510980789342, -0.8546410572142449, -1.4463530333867887, 3.8947478530972965, -6.522156858906481, 1.847983778929823, 11.226311161612509, 3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034803611521077, "mean_inference_ms": 1.0488249474597362, "mean_action_processing_ms": 0.17351655184494347, "mean_env_wait_ms": 0.06845241050402368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003576993942260742, "StateBufferConnector_ms": 0.0026199817657470703, "ViewRequirementAgentConnector_ms": 0.07385122776031494}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.32334508301926, "num_env_steps_trained_throughput_per_sec": 485.32334508301926, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1524000, "timers": {"training_iteration_time_ms": 8120.454, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8120.421, "sample_time_ms": 797.69, "learn_time_ms": 7309.366, "learn_throughput": 547.243, "synch_weights_time_ms": 12.693}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "done": false, "training_iteration": 127, "trial_id": "fa423_00000", "date": "2024-08-10_11-16-01", "timestamp": 1723302961, "time_this_iter_s": 8.246876001358032, "time_total_s": 1036.49662733078, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98d1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1036.49662733078, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 23.925, "ram_util_percent": 79.74166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.128506231591815, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5259226724584267, "policy_loss": -0.00491914060324056, "vf_loss": 3.5308418193191446, "vf_explained_var": -0.4495533380243513, "kl": 0.005427668567779097, "entropy": 0.5551738557203737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.67062717632701, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6547487740715345, "policy_loss": -0.006499177523558804, "vf_loss": 5.661247939119736, "vf_explained_var": 0.24196316798528036, "kl": 0.018341623803324648, "entropy": 1.0951802607625722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 378.38, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 37838, "policy_reward_min": {"agent_policy": -57.76041106407446, "adversary_policy": -31.89262421998209}, "policy_reward_max": {"agent_policy": 43.60340823827136, "adversary_policy": 34.784959533587674}, "policy_reward_mean": {"agent_policy": 4.1466076665650995, "adversary_policy": -2.0733038332825493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-12.413328466893553, 31.234961176809737, 8.220658580873348, -10.544723033190786, -3.862280088856913, -29.67077711860419, -1.641358913163323, -42.22922566652224, -2.9401323469238, -57.76041106407446, -2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653], "policy_adversary_policy_reward": [3.7448590502636634, 8.668469416629886, -12.094985396564383, -19.139975780245354, 3.957060086408891, -12.177718667282242, 4.365431304325686, 6.179291728865117, -18.376652662802595, 22.23893275165951, 12.440971757722316, 17.229805360881873, -0.29913567969046184, 1.940494592853785, 20.30780719656328, 21.921418469958954, 4.351122353579061, -1.4109900066552612, 22.97545153048679, 34.784959533587674, 13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034038621770403, "mean_inference_ms": 1.0486182968162916, "mean_action_processing_ms": 0.17345242090273644, "mean_env_wait_ms": 0.06846010968028678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035643577575683594, "StateBufferConnector_ms": 0.002671360969543457, "ViewRequirementAgentConnector_ms": 0.07348573207855225}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.4832763395256, "num_env_steps_trained_throughput_per_sec": 489.4832763395256, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 8143.112, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8143.078, "sample_time_ms": 800.532, "learn_time_ms": 7328.822, "learn_throughput": 545.79, "synch_weights_time_ms": 13.073}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 128, "trial_id": "fa423_00000", "date": "2024-08-10_11-16-09", "timestamp": 1723302969, "time_this_iter_s": 8.178991079330444, "time_total_s": 1044.6756184101105, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98d1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1044.6756184101105, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 24.174999999999997, "ram_util_percent": 79.66666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4179769428003404, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.34145889357915, "policy_loss": -0.005058732742773832, "vf_loss": 3.3465176341394898, "vf_explained_var": -0.011536129977968004, "kl": 0.008619177964462646, "entropy": 0.5820202773683285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8482107255607843, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.088485484321912, "policy_loss": -0.0051039730077415395, "vf_loss": 5.093589447687069, "vf_explained_var": 0.415484225936234, "kl": 0.010128352731184365, "entropy": 1.0336991973842184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.22, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38222, "policy_reward_min": {"agent_policy": -47.839592159674766, "adversary_policy": -31.89262421998209}, "policy_reward_max": {"agent_policy": 50.20647487818674, "adversary_policy": 26.84127570895806}, "policy_reward_mean": {"agent_policy": 6.964335547289639, "adversary_policy": -3.4821677736448198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 72, 400, 400, 52, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-2.938927277889608, 7.533153963028624, -18.474276638401108, -6.769905661887567, 22.935051320670976, -29.217536368451224, 42.38365658029393, -21.53798454614859, -32.896360637946884, 17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844], "policy_adversary_policy_reward": [13.744161983561945, -10.805234705672348, -10.428074414196324, 2.894920451167696, 21.52897971512716, -3.0547030767260566, 7.3447545647906445, -0.5748489029030779, -16.128238712100647, -6.806812608570333, 20.227590246384274, 8.98994612206694, -18.29557451215917, -24.088082068134756, 2.2875479766113536, 19.25043656953724, 6.616741858557692, 26.279618779389182, -9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40339622797657326, "mean_inference_ms": 1.0485067400506565, "mean_action_processing_ms": 0.17346529200475744, "mean_env_wait_ms": 0.06844142291557752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034967660903930664, "StateBufferConnector_ms": 0.0026601552963256836, "ViewRequirementAgentConnector_ms": 0.0730506181716919}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.74644836952086, "num_env_steps_trained_throughput_per_sec": 497.74644836952086, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1548000, "timers": {"training_iteration_time_ms": 8141.84, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8141.807, "sample_time_ms": 800.62, "learn_time_ms": 7327.527, "learn_throughput": 545.887, "synch_weights_time_ms": 13.039}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "done": false, "training_iteration": 129, "trial_id": "fa423_00000", "date": "2024-08-10_11-16-17", "timestamp": 1723302977, "time_this_iter_s": 8.040815114974976, "time_total_s": 1052.7164335250854, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a97fc310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1052.7164335250854, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 29.172727272727276, "ram_util_percent": 80.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.735106110951257, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8120974666857848, "policy_loss": -0.006215394260090771, "vf_loss": 2.8183128561292374, "vf_explained_var": 0.07361573346708186, "kl": 0.00594791467956357, "entropy": 0.6233309069165477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.614985929305355, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.795152511447668, "policy_loss": -0.003063760513517385, "vf_loss": 5.798216264943282, "vf_explained_var": 0.3338689509158333, "kl": 0.004168756126635209, "entropy": 0.6292816800065338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.84, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38684, "policy_reward_min": {"agent_policy": -47.839592159674766, "adversary_policy": -31.89262421998209}, "policy_reward_max": {"agent_policy": 50.20647487818674, "adversary_policy": 31.002560019954856}, "policy_reward_mean": {"agent_policy": 8.190747767535449, "adversary_policy": -4.095373883767724}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [17.286919098806237, 14.75224147429994, -16.81652105032909, 4.951581672500147, -16.907576232863367, 2.0756776022131067, 11.720465997468647, 13.217937984492252, 13.750837571336039, 8.249708875869382, 8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456], "policy_adversary_policy_reward": [-9.284474800944977, -8.002444297861267, -4.283154341821238, -10.469087132478712, 12.546158482924689, 4.270362567404405, -2.9649344153304185, -1.9866472571697287, 6.952676400108935, 9.954899832754432, 2.2975554353016747, -4.373233037514781, -6.145648991644141, -5.574817005824503, -6.049023478763775, -7.168914505728473, -5.468142109593298, -8.282695461742716, 10.113848124057203, -18.363556999926587, -12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032707015575431, "mean_inference_ms": 1.0484002727331672, "mean_action_processing_ms": 0.17345406410192654, "mean_env_wait_ms": 0.06843439406099155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034275054931640625, "StateBufferConnector_ms": 0.0026072263717651367, "ViewRequirementAgentConnector_ms": 0.07111668586730957}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.73954201781476, "num_env_steps_trained_throughput_per_sec": 490.73954201781476, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 8145.124, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8145.09, "sample_time_ms": 799.13, "learn_time_ms": 7332.419, "learn_throughput": 545.523, "synch_weights_time_ms": 12.918}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 130, "trial_id": "fa423_00000", "date": "2024-08-10_11-16-26", "timestamp": 1723302986, "time_this_iter_s": 8.155524015426636, "time_total_s": 1060.871957540512, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a97fc670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1060.871957540512, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 24.058333333333334, "ram_util_percent": 80.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2836298218479865, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.897404563111603, "policy_loss": -0.010745825614563371, "vf_loss": 2.908150385296534, "vf_explained_var": -0.1154703663770484, "kl": 0.014070551702027053, "entropy": 0.49840106737046014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.399393290778001, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.379296332846085, "policy_loss": -0.005501508725865278, "vf_loss": 4.38479783286651, "vf_explained_var": 0.38322942654291786, "kl": 0.005759766257973007, "entropy": 0.6198910665077467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.84, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38684, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -31.89262421998209}, "policy_reward_max": {"agent_policy": 50.92855220442381, "adversary_policy": 33.141755557879534}, "policy_reward_mean": {"agent_policy": 7.992124513453339, "adversary_policy": -3.9960622567266695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [8.247054886971846, 33.42724910341762, -45.604868771709334, 9.836583514777907, 23.3431789035129, -4.971083448044075, -16.19001821296708, -37.01834528517412, 19.190632723923954, 39.72919485292932, 24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615], "policy_adversary_policy_reward": [-12.420706527103981, 4.173651640132135, -14.477164687363366, -18.95008441605427, 22.986450208826128, 22.618418562883186, -1.8055314793336237, -8.031052035444283, -23.07898722848391, -0.26419167502898233, 1.2827816817426196, 3.6883017663014552, 0.24964812911707668, 15.940370083850002, 10.17706957621607, 26.84127570895806, -4.521978097358634, -14.66865462656532, -19.43337519476593, -20.295819658163378, -6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40322133421662865, "mean_inference_ms": 1.0484352315812018, "mean_action_processing_ms": 0.1734370745574878, "mean_env_wait_ms": 0.06842520751809351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034279823303222656, "StateBufferConnector_ms": 0.00258481502532959, "ViewRequirementAgentConnector_ms": 0.0714331865310669}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.95627035093145, "num_env_steps_trained_throughput_per_sec": 482.95627035093145, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1572000, "timers": {"training_iteration_time_ms": 8151.3, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8151.267, "sample_time_ms": 798.375, "learn_time_ms": 7339.391, "learn_throughput": 545.004, "synch_weights_time_ms": 12.877}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "done": false, "training_iteration": 131, "trial_id": "fa423_00000", "date": "2024-08-10_11-16-34", "timestamp": 1723302994, "time_this_iter_s": 8.28658676147461, "time_total_s": 1069.1585443019867, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1069.1585443019867, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 25.150000000000002, "ram_util_percent": 80.68333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1054384772739714, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.77875929421218, "policy_loss": -0.005664042902312108, "vf_loss": 3.7844233375377754, "vf_explained_var": -0.049553916220942504, "kl": 0.007874997898908642, "entropy": 0.6072845552333448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.193336478496591, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.060855265210072, "policy_loss": -0.008743901384877972, "vf_loss": 5.069599126031002, "vf_explained_var": 0.3579161254689097, "kl": 0.00981706966959545, "entropy": 0.8267996966838836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 386.84, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38684, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -40.81909549752012}, "policy_reward_max": {"agent_policy": 50.92855220442381, "adversary_policy": 33.141755557879534}, "policy_reward_mean": {"agent_policy": 8.3668235262283, "adversary_policy": -4.18341176311415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [24.38866800035615, 22.39442773547314, -29.762148890717867, -23.58771624743261, -1.2224957662546352, -6.310593429189376, 24.99354829796558, 29.005647404407426, -47.839592159674766, 6.7734541357376195, 24.733068269419018, 6.174734004948263, 24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823], "policy_adversary_policy_reward": [-6.05296539041165, -18.335702609944494, -7.07961567390778, -15.314812061565359, 10.349631101180318, 19.412517789537517, 3.2513331510723162, 20.336383096360294, 6.540461756636766, -5.317965990382131, 7.9975240215442245, -1.686930592354848, 5.681633093807804, -30.67518139177338, -2.146536754870585, -26.859110649536795, 26.195905852897212, 21.64368630677758, 12.3762709785766, -19.149725114314222, -9.259976355140392, -15.473091914278633, 14.09880920424196, -20.273543209190223, -11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40315915895698157, "mean_inference_ms": 1.0482406499460255, "mean_action_processing_ms": 0.17340863821119126, "mean_env_wait_ms": 0.06842060359153773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415703773498535, "StateBufferConnector_ms": 0.0025655031204223633, "ViewRequirementAgentConnector_ms": 0.07089602947235107}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.57800381076925, "num_env_steps_trained_throughput_per_sec": 494.57800381076925, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 8139.649, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8139.616, "sample_time_ms": 793.872, "learn_time_ms": 7332.361, "learn_throughput": 545.527, "synch_weights_time_ms": 12.79}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 132, "trial_id": "fa423_00000", "date": "2024-08-10_11-16-42", "timestamp": 1723303002, "time_this_iter_s": 8.093676090240479, "time_total_s": 1077.2522203922272, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a97fc9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1077.2522203922272, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 25.083333333333332, "ram_util_percent": 80.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6563977272422226, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0334814134728973, "policy_loss": -0.0056545283235782, "vf_loss": 3.0391359435818184, "vf_explained_var": 0.08506587346394857, "kl": 0.00795563469800985, "entropy": 0.5373587734327114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2082275466372567, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.09434483324488, "policy_loss": -0.010168486449644357, "vf_loss": 5.104513302693764, "vf_explained_var": -0.14380994898577532, "kl": 0.011981924320519925, "entropy": 1.1038194194436073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 383.85, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38385, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -40.81909549752012}, "policy_reward_max": {"agent_policy": 50.92855220442381, "adversary_policy": 33.141755557879534}, "policy_reward_mean": {"agent_policy": 9.210071341041344, "adversary_policy": -4.605035670520671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400], "policy_agent_policy_reward": [24.723896324068527, -8.786323610602075, 21.82713603106344, -4.041393358861416, -18.46826394210461, -2.65426000146158, 0.5296318878276267, 19.079622595329614, 43.60340823827136, 15.848627244138882, 21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095], "policy_adversary_policy_reward": [-11.757311225287573, -12.966585098780953, 13.535875737874065, -4.74955212727199, -7.954911059742376, -13.872224971321064, 13.16139928316364, -9.120005924302223, 0.412575798729673, 18.055688143374937, 8.492055460805641, -5.837795459344061, -9.555493110738013, 9.025861222910386, -8.448328580465361, -10.631294014864253, -31.605917481000645, -11.997490757270725, -2.298401200127552, -13.550226044011332, -7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4031352559283405, "mean_inference_ms": 1.0480416191236386, "mean_action_processing_ms": 0.17334469117261408, "mean_env_wait_ms": 0.06840256370837024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467082977294922, "StateBufferConnector_ms": 0.0024814605712890625, "ViewRequirementAgentConnector_ms": 0.06932246685028076}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.8619974034921, "num_env_steps_trained_throughput_per_sec": 487.8619974034921, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1596000, "timers": {"training_iteration_time_ms": 8166.122, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8166.089, "sample_time_ms": 791.768, "learn_time_ms": 7361.266, "learn_throughput": 543.385, "synch_weights_time_ms": 12.496}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "done": false, "training_iteration": 133, "trial_id": "fa423_00000", "date": "2024-08-10_11-16-51", "timestamp": 1723303011, "time_this_iter_s": 8.204699039459229, "time_total_s": 1085.4569194316864, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a97fcd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1085.4569194316864, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 23.85454545454546, "ram_util_percent": 80.08181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3061332801662426, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.272366435502572, "policy_loss": -0.009667840369154142, "vf_loss": 2.2820342735007957, "vf_explained_var": 0.39266616408787075, "kl": 0.016012080029794654, "entropy": 0.5878802094194624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.08269429517289, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.840672333786885, "policy_loss": -0.006675511049979832, "vf_loss": 3.847347850352526, "vf_explained_var": -0.5365886116400361, "kl": 0.015078925041752119, "entropy": 0.9867267704879245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 380.35, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38035, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 50.92855220442381, "adversary_policy": 33.141755557879534}, "policy_reward_mean": {"agent_policy": 9.748909249667225, "adversary_policy": -4.8744546248336125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400], "policy_agent_policy_reward": [21.779619669400628, 12.676222414053754, 13.815334970553419, -8.299123826456054, 37.60752167125031, -13.383417350275565, 24.185582199644784, 12.532083409758066, -30.591794276358183, 16.441665858888648, 5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136], "policy_adversary_policy_reward": [-7.513597172291089, -14.266022497109539, -9.30590646071014, -3.3703159533436136, 2.888844717700401, -16.70417968825386, 0.7706149072540214, 7.528508919202004, -28.491260968143152, -9.116260703107141, 11.893011789823142, 1.4904055604524231, 7.707042020337305, -31.89262421998209, -3.531576067148251, -9.000507342609815, 8.386035482528097, 22.205758793830093, -14.7571775191041, -1.6844883397845543, -20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4030434144530395, "mean_inference_ms": 1.0476288875203936, "mean_action_processing_ms": 0.17331801449866205, "mean_env_wait_ms": 0.06839143403141162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034759044647216797, "StateBufferConnector_ms": 0.002520322799682617, "ViewRequirementAgentConnector_ms": 0.06868696212768555}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.9455549198406, "num_env_steps_trained_throughput_per_sec": 494.9455549198406, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 8149.833, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8149.8, "sample_time_ms": 789.823, "learn_time_ms": 7347.313, "learn_throughput": 544.417, "synch_weights_time_ms": 12.144}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "training_iteration": 134, "trial_id": "fa423_00000", "date": "2024-08-10_11-16-59", "timestamp": 1723303019, "time_this_iter_s": 8.08812403678894, "time_total_s": 1093.5450434684753, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a97fcdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1093.5450434684753, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 25.666666666666668, "ram_util_percent": 80.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4304008865482594, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.972970305927216, "policy_loss": -0.005395683365450216, "vf_loss": 2.9783659972841776, "vf_explained_var": 0.5058436761772822, "kl": 0.00839816015552798, "entropy": 0.6915576937968138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2184458465936285, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.9654940970242025, "policy_loss": -0.004879686283675255, "vf_loss": 4.970373793939749, "vf_explained_var": 0.2577921986579895, "kl": 0.016497658666934718, "entropy": 1.1167388788734873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 380.35, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38035, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 50.92855220442381, "adversary_policy": 33.141755557879534}, "policy_reward_mean": {"agent_policy": 8.51878677240985, "adversary_policy": -4.259393386204925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 28, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [5.0183809262487316, -13.196417433171282, 5.388401163861847, -19.318809365091326, -12.130222707414694, 21.306602548574126, 26.08898199289191, 11.805571312267862, 13.066846219966123, -14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044], "policy_adversary_policy_reward": [-20.56437639917415, 15.54599547292542, 18.455328714736325, -5.258911281565048, -0.4609415273789068, -4.92745963648294, 5.170993945240209, 14.147815419851117, -5.775398351615129, 17.905621059029823, 0.165150785667727, -21.471753334241853, -10.471092881106841, -15.617889111785068, -7.753491014176706, -4.052080298091152, 11.474484192638595, -24.54133041260472, 0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40282904577510015, "mean_inference_ms": 1.0472995192601728, "mean_action_processing_ms": 0.17325649183023242, "mean_env_wait_ms": 0.06837320170585003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034563541412353516, "StateBufferConnector_ms": 0.0025168657302856445, "ViewRequirementAgentConnector_ms": 0.06658005714416504}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.03687277723515, "num_env_steps_trained_throughput_per_sec": 490.03687277723515, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1620000, "timers": {"training_iteration_time_ms": 8149.263, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8149.23, "sample_time_ms": 772.785, "learn_time_ms": 7363.71, "learn_throughput": 543.204, "synch_weights_time_ms": 12.184}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "done": false, "training_iteration": 135, "trial_id": "fa423_00000", "date": "2024-08-10_11-17-07", "timestamp": 1723303027, "time_this_iter_s": 8.16796588897705, "time_total_s": 1101.7130093574524, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a996a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1101.7130093574524, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 23.600000000000005, "ram_util_percent": 80.08333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.581142394315629, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.157843226288992, "policy_loss": -0.00502449831329089, "vf_loss": 3.1628677195972865, "vf_explained_var": 0.24993070537451084, "kl": 0.012555069113446626, "entropy": 0.5413344169577593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2878843707342944, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.785892172406117, "policy_loss": -0.0031616811216129766, "vf_loss": 4.789053839196762, "vf_explained_var": -0.24960090033710003, "kl": 0.0096469050021866, "entropy": 0.9298243746161461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 384.07, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38407, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 62.00850181870545, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 9.100580069264195, "adversary_policy": -4.550290034632098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 64, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-14.227740471547463, 28.61232231759086, 16.31878706552659, 11.665372437642716, 19.658426570365314, -7.85833414457743, -2.5596409823019606, 7.71459429811026, 31.88770429697167, -19.38269694636292, -6.510000236026642, 10.807113006580956, 16.818172898896176, 11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966], "policy_adversary_policy_reward": [0.3822790010935897, 13.845461470453873, -13.380802303806867, -15.231520013783992, -23.65518794204121, 7.33640087651462, -14.590424587506071, 2.9250521498633546, -12.995825156493055, -6.662601413872263, -3.2971816202507718, 11.155515764828202, 15.500403310292914, -12.940762327990956, -5.440001539520313, -2.2745927585899466, -21.745544279103743, -10.142160017867926, 16.66501112688988, 2.717685819473033, 24.025126494151706, -17.51512625812506, -27.608329236124135, 16.801216229543186, -8.134820685364009, -8.683352213532167, -8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027138050085151, "mean_inference_ms": 1.0466638573965164, "mean_action_processing_ms": 0.17324621754047762, "mean_env_wait_ms": 0.06836416050112497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459930419921875, "StateBufferConnector_ms": 0.0024977922439575195, "ViewRequirementAgentConnector_ms": 0.06551194190979004}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.88368681118214, "num_env_steps_trained_throughput_per_sec": 493.88368681118214, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 8151.355, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8151.322, "sample_time_ms": 767.326, "learn_time_ms": 7371.426, "learn_throughput": 542.636, "synch_weights_time_ms": 12.052}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 136, "trial_id": "fa423_00000", "date": "2024-08-10_11-17-16", "timestamp": 1723303036, "time_this_iter_s": 8.105244874954224, "time_total_s": 1109.8182542324066, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a996a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1109.8182542324066, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 24.016666666666666, "ram_util_percent": 80.09166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5710052458697525, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2141015891675595, "policy_loss": -0.004502907338202315, "vf_loss": 3.218604495916417, "vf_explained_var": 0.2620688222072743, "kl": 0.00643207106372548, "entropy": 0.6416121937610485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8989330089340606, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.945040440559387, "policy_loss": -0.006414779399347026, "vf_loss": 4.951455220083395, "vf_explained_var": -0.3807185880218943, "kl": 0.012704743557760209, "entropy": 1.0946127991502483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 383.89, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38389, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 62.00850181870545, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 9.336606943892914, "adversary_policy": -4.668303471946456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400], "policy_agent_policy_reward": [11.365506441259427, 15.208694267772534, 7.822103235085027, 39.27267224805471, 11.825777454030423, 40.18604221892768, 28.15867346505653, 27.155833465234238, 9.041024377618356, 50.20647487818674, 20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173], "policy_adversary_policy_reward": [-8.13497279698855, -3.230533644270878, -12.407094581200546, -2.8015996865720023, 18.080039001607716, -25.902142236692747, -16.200599779036253, -23.072072469018465, 0.6545315322132979, -12.48030898624372, -24.56128809444379, -15.624754124483879, -14.538228871632938, -13.620444593423578, -26.81246460695135, -0.34336885828288644, 5.501491594249206, -14.542515971867562, -27.359358646609667, -22.847116231577033, -13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026304704067512, "mean_inference_ms": 1.0460873821552668, "mean_action_processing_ms": 0.17310556301071686, "mean_env_wait_ms": 0.06833014509874395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003396272659301758, "StateBufferConnector_ms": 0.0024499893188476562, "ViewRequirementAgentConnector_ms": 0.064797043800354}, "num_episodes": 13, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.05520837830215, "num_env_steps_trained_throughput_per_sec": 488.05520837830215, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1644000, "timers": {"training_iteration_time_ms": 8146.741, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8146.708, "sample_time_ms": 763.543, "learn_time_ms": 7370.448, "learn_throughput": 542.708, "synch_weights_time_ms": 12.21}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "done": false, "training_iteration": 137, "trial_id": "fa423_00000", "date": "2024-08-10_11-17-24", "timestamp": 1723303044, "time_this_iter_s": 8.203351736068726, "time_total_s": 1118.0216059684753, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a989ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1118.0216059684753, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 24.363636363636363, "ram_util_percent": 79.96363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8236499147440393, "cur_kl_coeff": 3.6209821701049816e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.586731192800734, "policy_loss": -0.0021569030339676867, "vf_loss": 3.588888102864462, "vf_explained_var": 0.3536939367415413, "kl": 0.0037980743903377125, "entropy": 0.7678429075649806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.989525444371005, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.27948782145977, "policy_loss": -0.007717812443055057, "vf_loss": 6.287205611666043, "vf_explained_var": 0.05849577877670527, "kl": 0.009421759142562582, "entropy": 0.9206962432712317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 383.89, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38389, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 62.00850181870545, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 8.2134302477439, "adversary_policy": -4.106715123871949}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 186, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [20.86519830495207, 12.264781034479277, -3.760661159887295, 0.19909446385994656, 48.62271074206228, 6.391286019488039, -10.819570994085844, -13.464926293517404, 11.657403052508464, 14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021], "policy_adversary_policy_reward": [-13.119231598606586, -7.7459667063454845, -23.185645704301365, 10.920864669822087, 13.008042682329375, -9.24738152244208, 10.433782194040631, -10.632876657900578, -26.2892817301122, -22.333429011950084, -10.111111002340998, 3.719824982852952, -0.30366440856113996, 11.123235402646984, 31.002560019954856, -17.537633726437456, -0.8861195098935273, -10.771283542614949, 14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40235573647221023, "mean_inference_ms": 1.0455998588232185, "mean_action_processing_ms": 0.1730719226890235, "mean_env_wait_ms": 0.06829602576922669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003403186798095703, "StateBufferConnector_ms": 0.002411365509033203, "ViewRequirementAgentConnector_ms": 0.06407475471496582}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.53904700358504, "num_env_steps_trained_throughput_per_sec": 486.53904700358504, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1656000, "timers": {"training_iteration_time_ms": 8151.686, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8151.653, "sample_time_ms": 763.059, "learn_time_ms": 7376.199, "learn_throughput": 542.285, "synch_weights_time_ms": 11.912}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "done": false, "training_iteration": 138, "trial_id": "fa423_00000", "date": "2024-08-10_11-17-32", "timestamp": 1723303052, "time_this_iter_s": 8.226648092269897, "time_total_s": 1126.2482540607452, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a996aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1126.2482540607452, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 24.99166666666666, "ram_util_percent": 80.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5851894530038986, "cur_kl_coeff": 1.8104910850524908e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.267931834982816, "policy_loss": -0.005814879286847023, "vf_loss": 4.2737467191837455, "vf_explained_var": -0.06432663205439451, "kl": 0.012357290773288036, "entropy": 0.8070908219725997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9915361644079286, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.492522941281398, "policy_loss": -0.009448932758338439, "vf_loss": 6.501971899221341, "vf_explained_var": -0.023147443061073622, "kl": 0.007249864793252863, "entropy": 0.7218523558229208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 382.9, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38290, "policy_reward_min": {"agent_policy": -60.89589947997787, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 62.00850181870545, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 8.273238062768318, "adversary_policy": -4.136619031384158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400], "policy_agent_policy_reward": [14.720554910490662, 34.287941603179235, 26.578335772707867, 23.41988011291145, -13.593430730267617, 14.175118285642355, -14.122783955805456, -33.595039408012084, 50.92855220442381, -9.691138478312476, 5.382717864041307, 32.77718090426429, -29.639883908876953, -60.89589947997787, 25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927], "policy_adversary_policy_reward": [14.36956264750819, -29.090117557998852, -18.99478590993048, -15.293155693248753, -4.687619434163157, -21.890716338544706, 2.3010422232179835, -25.720922336129433, 10.418301997205393, 3.1751287330622233, -7.411396908611312, -6.763721377031043, 1.0222900075769736, 13.100493948228483, 18.910731203114096, 14.684308204897981, -25.17096575651953, -25.757586447904245, 3.594313969180593, 6.096824509131881, 20.59637020063959, -25.979088064680898, -4.420502060914856, -28.356678843349414, 17.956640807621916, 11.683243101255037, 33.141755557879534, 27.754143922098326, -12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40216725690659694, "mean_inference_ms": 1.0451767889092256, "mean_action_processing_ms": 0.17304200466994085, "mean_env_wait_ms": 0.06825685246628463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003712296485900879, "StateBufferConnector_ms": 0.0024188756942749023, "ViewRequirementAgentConnector_ms": 0.06469762325286865}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.0670717487442, "num_env_steps_trained_throughput_per_sec": 480.0670717487442, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1668000, "timers": {"training_iteration_time_ms": 8181.281, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8181.248, "sample_time_ms": 768.433, "learn_time_ms": 7400.38, "learn_throughput": 540.513, "synch_weights_time_ms": 11.91}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "done": false, "training_iteration": 139, "trial_id": "fa423_00000", "date": "2024-08-10_11-17-41", "timestamp": 1723303061, "time_this_iter_s": 8.337235927581787, "time_total_s": 1134.585489988327, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a996ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1134.585489988327, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 25.34166666666667, "ram_util_percent": 80.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6431229788159567, "cur_kl_coeff": 1.8104910850524908e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2540104763848445, "policy_loss": -0.0037623137440138234, "vf_loss": 4.257772794980851, "vf_explained_var": 0.17554356190893386, "kl": 0.009250549236664, "entropy": 0.7079304632686433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.223363175801933, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.890570942312479, "policy_loss": -0.005523708217757909, "vf_loss": 5.896094656984011, "vf_explained_var": -0.14359482880681754, "kl": 0.013495101668445272, "entropy": 0.8837308967486024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 376.24, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 37624, "policy_reward_min": {"agent_policy": -60.8049683345765, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 9.757793718121814, "adversary_policy": -4.878896859060905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [25.401037354044913, 13.82588675434382, 37.925533779643615, 44.16372899514324, -19.222861892779424, 24.96636246087226, 11.774697058019793, 1.9787483144037061, -11.594863696320028, 26.14899218035094, -12.787726587499616, 6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568], "policy_adversary_policy_reward": [-12.254877222351062, -13.146160131693843, 2.837573805090491, -16.663460559434316, -27.282715303908958, -10.642818475734632, -40.81909549752012, -3.3446334976231213, 5.037533517736723, 14.185328375042701, 0.20502022542075693, -25.17138268629302, -6.946859964795493, -4.827837093224311, -1.3017103183021526, -0.6770379961015536, 22.70211823485367, -11.107254538533645, -0.8893933155222342, -25.2595988648287, 22.201903400119885, -9.41417681262027, 6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40198068194543296, "mean_inference_ms": 1.044891340572357, "mean_action_processing_ms": 0.17290959794116806, "mean_env_wait_ms": 0.0682313934291757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759026527404785, "StateBufferConnector_ms": 0.0024416446685791016, "ViewRequirementAgentConnector_ms": 0.06515681743621826}, "num_episodes": 14, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.88421288190847, "num_env_steps_trained_throughput_per_sec": 485.88421288190847, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 8189.426, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8189.393, "sample_time_ms": 766.834, "learn_time_ms": 7410.155, "learn_throughput": 539.8, "synch_weights_time_ms": 11.872}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 140, "trial_id": "fa423_00000", "date": "2024-08-10_11-17-49", "timestamp": 1723303069, "time_this_iter_s": 8.2381432056427, "time_total_s": 1142.8236331939697, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a996aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1142.8236331939697, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 23.675, "ram_util_percent": 80.44166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5640612832452887, "cur_kl_coeff": 1.8104910850524908e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.373577524745275, "policy_loss": -0.003558193029535235, "vf_loss": 4.3771357157873725, "vf_explained_var": -0.22060238290085363, "kl": 0.008087887443425484, "entropy": 0.675311144508382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.284801583488782, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.839169224599997, "policy_loss": -0.010359204472479178, "vf_loss": 5.849528428415457, "vf_explained_var": 0.06340372680375973, "kl": 0.013049685899337169, "entropy": 0.80643270611763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 7.771561172376097e-18, "episode_len_mean": 369.84, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36984, "policy_reward_min": {"agent_policy": -60.8049683345765, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 8.37459362509071, "adversary_policy": -4.187296812545355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400], "policy_agent_policy_reward": [6.661914182706056, -4.629511469761823, 33.32434641772562, 16.230024217778904, 18.79682507345732, 12.309825160905927, 15.527664773482176, 11.662689413050522, -12.226456961317922, 46.01054349602042, -27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126], "policy_adversary_policy_reward": [6.8077316012773785, -13.469645783983434, 6.496246591548914, -1.866735121787059, -2.684003539640635, -30.640342878084944, -12.245450421343682, -3.9845737964352246, -0.30146079282755167, -18.495364280629772, -2.2923629478581447, -10.017462213047782, 3.137795489372394, -18.665460262854573, -0.4426885010723609, -11.220000911978161, 6.668982246848387, 5.557474714469539, -29.08925704627712, -16.921286449743295, 14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.401809914235917, "mean_inference_ms": 1.0445053611497621, "mean_action_processing_ms": 0.17289554797142384, "mean_env_wait_ms": 0.06821255643752527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038574934005737305, "StateBufferConnector_ms": 0.0024956464767456055, "ViewRequirementAgentConnector_ms": 0.06527388095855713}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 7.771561172376097e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 483.96120652453345, "num_env_steps_trained_throughput_per_sec": 483.96120652453345, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1692000, "timers": {"training_iteration_time_ms": 8187.707, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8187.673, "sample_time_ms": 768.901, "learn_time_ms": 7406.336, "learn_throughput": 540.078, "synch_weights_time_ms": 11.893}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "done": false, "training_iteration": 141, "trial_id": "fa423_00000", "date": "2024-08-10_11-17-58", "timestamp": 1723303078, "time_this_iter_s": 8.270746946334839, "time_total_s": 1151.0943801403046, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9818280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1151.0943801403046, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 23.700000000000003, "ram_util_percent": 80.45833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.323295352067897, "cur_kl_coeff": 1.8104910850524908e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1262746547895763, "policy_loss": -0.0056688180512369235, "vf_loss": 3.1319434732987137, "vf_explained_var": 0.17187605169084336, "kl": 0.008555776808787524, "entropy": 0.6815901159924805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5502059411257507, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.149974423646927, "policy_loss": -0.0037281276236171834, "vf_loss": 5.15370253076156, "vf_explained_var": -0.3333907705421249, "kl": 0.004737800518547783, "entropy": 0.7153652474905053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 7.771561172376097e-18, "episode_len_mean": 367.39, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36739, "policy_reward_min": {"agent_policy": -60.8049683345765, "adversary_policy": -44.60217208841494}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 8.904571531321432, "adversary_policy": -4.452285765660715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.220446049250313e-16, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [15, 400, 92, 400, 400, 400, 400, 400, 400, 400, 50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155], "policy_agent_policy_reward": [-27.16797648619139, -16.55509706158683, -26.136576211051807, 42.289971004069095, 20.207004971006484, 28.27897070664187, 4.891332639884904, 49.475047079904456, 32.04678518506864, -9.429373713133202, -9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058], "policy_adversary_policy_reward": [14.038824540293074, 13.12915194589831, 6.094982601940462, 10.46011445964637, 19.825199797940428, 6.311376413111379, -23.85163609368094, -18.438334910388154, -14.40392019791772, -5.803084773088763, -20.657809452016753, -7.621161254625131, -17.931797687716475, 13.040465047831571, -4.872874991489539, -44.60217208841494, -3.7802592275889815, -28.26652595747965, 13.652204660753359, -4.222830947620157, 11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40171522244377583, "mean_inference_ms": 1.0441323361502308, "mean_action_processing_ms": 0.1728224076253085, "mean_env_wait_ms": 0.06821142815478558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037816762924194336, "StateBufferConnector_ms": 0.0024886131286621094, "ViewRequirementAgentConnector_ms": 0.0643082857131958}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 7.771561172376097e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 478.0533946027079, "num_env_steps_trained_throughput_per_sec": 478.0533946027079, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1704000, "timers": {"training_iteration_time_ms": 8215.663, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8215.628, "sample_time_ms": 771.762, "learn_time_ms": 7431.406, "learn_throughput": 538.256, "synch_weights_time_ms": 11.888}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "done": false, "training_iteration": 142, "trial_id": "fa423_00000", "date": "2024-08-10_11-18-06", "timestamp": 1723303086, "time_this_iter_s": 8.373550176620483, "time_total_s": 1159.467930316925, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98188b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1159.467930316925, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 24.141666666666666, "ram_util_percent": 80.38333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2612790669713703, "cur_kl_coeff": 1.8104910850524908e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.202270549062699, "policy_loss": -0.0034587410391953887, "vf_loss": 3.205729293634021, "vf_explained_var": 0.13858739175493756, "kl": 0.005236184189242228, "entropy": 0.5741793955444658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5970218078543743, "cur_kl_coeff": 6.365007720887659e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.720861948033174, "policy_loss": -0.008126549270915955, "vf_loss": 4.728988516827425, "vf_explained_var": -0.02734032509227594, "kl": 0.010420453951689225, "entropy": 0.8674652387698492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 374.32, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37432, "policy_reward_min": {"agent_policy": -60.8049683345765, "adversary_policy": -42.80393319572227}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 7.978714952941749, "adversary_policy": -3.989357476470874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [50, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-9.598653268725123, 18.114928317150028, 24.8286785592791, -13.268848206819136, -28.896399618614172, -32.397714636407954, 22.80005678257007, -10.265166531060505, -5.963823823676243, -23.51878352310887, 11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623], "policy_adversary_policy_reward": [11.990086776748448, -2.3914335080233244, -12.474944353938703, -5.639983963211325, -1.5007885310819375, -23.327890028197167, 12.031738011938089, 1.2371101948810477, 6.398535132397765, 22.497864486216393, 15.4035022499368, 16.994212386471148, -37.575006422410276, 14.774949639840205, -5.003020397885386, 15.268186928945891, 1.1660386776752496, 4.797785146000994, 22.56313571930483, 0.9556478038040375, -14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4015314203543209, "mean_inference_ms": 1.043780500006565, "mean_action_processing_ms": 0.17279234477741473, "mean_env_wait_ms": 0.06816500275787664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003796815872192383, "StateBufferConnector_ms": 0.002514362335205078, "ViewRequirementAgentConnector_ms": 0.06482577323913574}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.7656576863874, "num_env_steps_trained_throughput_per_sec": 492.7656576863874, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1716000, "timers": {"training_iteration_time_ms": 8207.504, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8207.469, "sample_time_ms": 774.809, "learn_time_ms": 7420.142, "learn_throughput": 539.073, "synch_weights_time_ms": 11.916}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "done": false, "training_iteration": 143, "trial_id": "fa423_00000", "date": "2024-08-10_11-18-15", "timestamp": 1723303095, "time_this_iter_s": 8.12273621559143, "time_total_s": 1167.5906665325165, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a996aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1167.5906665325165, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 27.325000000000003, "ram_util_percent": 80.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.701606560194934, "cur_kl_coeff": 1.8104910850524908e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.932997544543453, "policy_loss": -0.009211621395184132, "vf_loss": 2.9422091559127526, "vf_explained_var": 0.20912321348669669, "kl": 0.010640200614622824, "entropy": 0.5756014128052999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4177139357974133, "cur_kl_coeff": 6.365007720887659e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.978834981719653, "policy_loss": -0.008226187372929416, "vf_loss": 4.98706117644906, "vf_explained_var": 0.21947006272772948, "kl": 0.008339777042400801, "entropy": 0.935551240046819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 373.86, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37386, "policy_reward_min": {"agent_policy": -60.8049683345765, "adversary_policy": -42.80393319572227}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 41.95709815977874}, "policy_reward_mean": {"agent_policy": 9.01665440029522, "adversary_policy": -4.508327200147608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [11.815359001752771, -8.99742215668648, 14.846510541213327, 24.32883097874044, 2.3644450909993164, -60.8049683345765, 51.29259419824934, 2.589176068678114, 32.10623159108491, 62.00850181870545, -54.35802998765902, 25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767], "policy_adversary_policy_reward": [-14.347710818227316, 2.532351816474545, 13.329135395034466, -4.331713238347987, -2.1058402730835866, -12.74067026812974, 0.021495936775998814, -24.35032691551644, -6.887646782067739, 4.5232016910684205, 41.95709815977874, 18.84787017479779, -29.719144061970994, -21.573450136278336, -16.688614024638994, 14.09943795596088, -26.62474729947801, -5.481484291606893, -33.85281355537035, -28.155688263335115, 22.041565051296505, 32.31646493636259, 13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4013892114934404, "mean_inference_ms": 1.043409365392631, "mean_action_processing_ms": 0.17274515562409973, "mean_env_wait_ms": 0.06814538964536442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003852248191833496, "StateBufferConnector_ms": 0.0025098323822021484, "ViewRequirementAgentConnector_ms": 0.06526219844818115}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.1067047814393, "num_env_steps_trained_throughput_per_sec": 484.1067047814393, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 8225.598, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8225.563, "sample_time_ms": 772.38, "learn_time_ms": 7440.474, "learn_throughput": 537.6, "synch_weights_time_ms": 12.111}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 144, "trial_id": "fa423_00000", "date": "2024-08-10_11-18-23", "timestamp": 1723303103, "time_this_iter_s": 8.266682863235474, "time_total_s": 1175.857349395752, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9818940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1175.857349395752, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 25.099999999999994, "ram_util_percent": 80.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.482205473052131, "cur_kl_coeff": 1.8104910850524908e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.933721181576845, "policy_loss": -0.005786795551745744, "vf_loss": 2.939507974644817, "vf_explained_var": 0.10499948247399911, "kl": 0.004988707939667836, "entropy": 0.579654936894538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.650458901996414, "cur_kl_coeff": 6.365007720887659e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.010682595024506, "policy_loss": -0.006781904387510925, "vf_loss": 5.017464498927196, "vf_explained_var": -0.03105920075128476, "kl": 0.006040771406603331, "entropy": 0.6794799130720397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 370.15, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37015, "policy_reward_min": {"agent_policy": -43.22470413917662, "adversary_policy": -42.80393319572227}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 35.17180551651781}, "policy_reward_mean": {"agent_policy": 8.996151530533542, "adversary_policy": -4.498075765266771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [25.984232841036594, 35.02648105704966, 0.20057835057160744, 4.272030374864624, -13.127402409849232, -5.957694847832954, 9.087648120727856, 22.311734098420704, 24.310675166394102, 48.020399248525315, -2.455863572694451, -32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373], "policy_adversary_policy_reward": [13.366339382844703, -39.350572223881294, -25.017723124705455, -10.008757932344189, 3.354073618854688, -3.5546519694262955, 16.841627818275455, -21.11365819314008, 0.46963361173968465, 12.657768798109544, -15.551404886710372, 21.509099734543327, 14.537246240638126, -23.624894361365982, -34.20167021538633, 11.889936116965629, -2.7243848531222383, -21.586290313271864, -33.50892425439354, -14.511474994131774, 5.393308763176396, -2.937445190481945, 17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4012237494665809, "mean_inference_ms": 1.043111609550902, "mean_action_processing_ms": 0.17273209395329522, "mean_env_wait_ms": 0.06814788290706561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003851175308227539, "StateBufferConnector_ms": 0.0025101900100708008, "ViewRequirementAgentConnector_ms": 0.0658942461013794}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.95436570358277, "num_env_steps_trained_throughput_per_sec": 482.95436570358277, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1740000, "timers": {"training_iteration_time_ms": 8237.569, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8237.534, "sample_time_ms": 770.955, "learn_time_ms": 7454.075, "learn_throughput": 536.619, "synch_weights_time_ms": 11.945}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "done": false, "training_iteration": 145, "trial_id": "fa423_00000", "date": "2024-08-10_11-18-31", "timestamp": 1723303111, "time_this_iter_s": 8.28773808479309, "time_total_s": 1184.145087480545, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9818f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1184.145087480545, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 24.024999999999995, "ram_util_percent": 80.50833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2739401711357963, "cur_kl_coeff": 9.052455425262454e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.366957829774372, "policy_loss": -0.0036115384855918667, "vf_loss": 2.3705693706633553, "vf_explained_var": 0.18454753378080943, "kl": 0.0032943904275014205, "entropy": 0.4499618680861892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2311322039614123, "cur_kl_coeff": 6.365007720887659e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.168898060669502, "policy_loss": -0.015717699334102993, "vf_loss": 4.184615764021873, "vf_explained_var": 0.02340198283394178, "kl": 0.013770698819859772, "entropy": 0.7134754998298983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 4.440892098500626e-18, "episode_len_mean": 370.15, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37015, "policy_reward_min": {"agent_policy": -43.22470413917662, "adversary_policy": -42.80393319572227}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 35.17180551651781}, "policy_reward_mean": {"agent_policy": 8.41401405031747, "adversary_policy": -4.207007025158735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [46, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-32.69534935610988, 29.11512181649236, 23.341270184978722, 10.123620399251173, 2.949836336011977, 14.05706698516207, -19.73116083554926, 34.33422994062677, 11.1825755212013, -10.63191025485252, 27.242577486288535, 22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838], "policy_adversary_policy_reward": [17.47348487318694, 15.22186448292293, 0.11658105265781771, -29.231702869150176, 19.329462097450254, -42.67073228242897, 6.895145337726056, -17.018765736977237, 5.773506987403941, -8.723343323415921, -13.388370803493832, -0.6686961816682384, -5.251895344549432, 24.98305618009868, -42.43933722919805, 8.105107288571329, -28.402462106014816, 17.219886584813512, 20.720607089202055, -10.088696834349534, 6.960108555844645, -34.20268604213317, -21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4010764487018105, "mean_inference_ms": 1.0427468585081254, "mean_action_processing_ms": 0.1726808341268827, "mean_env_wait_ms": 0.06812911616243114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038836002349853516, "StateBufferConnector_ms": 0.0025365352630615234, "ViewRequirementAgentConnector_ms": 0.06651806831359863}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.8831434372461, "num_env_steps_trained_throughput_per_sec": 485.8831434372461, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 8250.905, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8250.87, "sample_time_ms": 773.72, "learn_time_ms": 7464.707, "learn_throughput": 535.855, "synch_weights_time_ms": 11.884}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "training_iteration": 146, "trial_id": "fa423_00000", "date": "2024-08-10_11-18-40", "timestamp": 1723303120, "time_this_iter_s": 8.237769365310669, "time_total_s": 1192.3828568458557, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9940310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1192.3828568458557, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 25.233333333333334, "ram_util_percent": 80.37499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.385583699001837, "cur_kl_coeff": 4.526227712631227e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6462370256898264, "policy_loss": -0.005191264987341744, "vf_loss": 2.651428285351506, "vf_explained_var": -0.10678519455213395, "kl": 0.004239553936960259, "entropy": 0.43560876254997555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.614045728991429, "cur_kl_coeff": 6.365007720887659e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.561410541584094, "policy_loss": -0.016562388107073882, "vf_loss": 4.57797292470932, "vf_explained_var": -0.12057808029154936, "kl": 0.0370558345378538, "entropy": 0.8211302393426497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 5.551115123125783e-18, "episode_len_mean": 370.04, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37004, "policy_reward_min": {"agent_policy": -43.22470413917662, "adversary_policy": -42.80393319572227}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 35.17180551651781}, "policy_reward_mean": {"agent_policy": 7.223549227914677, "adversary_policy": -3.6117746139573383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 87, 400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400], "policy_agent_policy_reward": [22.54841241201425, 20.327842489450923, 25.64566235597021, 30.338723813538067, 27.9961236469372, -20.33815001651563, 33.3840655711401, -15.76857394264524, 7.548163907812555, -40.31356851507292, 16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564], "policy_adversary_policy_reward": [-21.168237762815608, -1.3801746491986115, -29.909931123390365, 9.582088633939442, -1.1790934920758573, -24.466568863894352, -23.837459197562847, -6.501264615975213, -2.393363560017667, -25.602760086919538, 7.100938824665317, 13.237211191850314, -17.649958155228397, -15.734107415911712, 10.568646141462121, 5.199927801183119, -19.137703804608662, 11.589539896796108, 25.34910599744545, 14.964462517627478, -38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40078713456329873, "mean_inference_ms": 1.0422249220950237, "mean_action_processing_ms": 0.17270484146957127, "mean_env_wait_ms": 0.06808917018578939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038623809814453125, "StateBufferConnector_ms": 0.0025382041931152344, "ViewRequirementAgentConnector_ms": 0.06703996658325195}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 5.551115123125783e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.23649672594496, "num_env_steps_trained_throughput_per_sec": 493.23649672594496, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1764000, "timers": {"training_iteration_time_ms": 8242.296, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8242.262, "sample_time_ms": 772.518, "learn_time_ms": 7457.318, "learn_throughput": 536.386, "synch_weights_time_ms": 11.832}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "done": false, "training_iteration": 147, "trial_id": "fa423_00000", "date": "2024-08-10_11-18-48", "timestamp": 1723303128, "time_this_iter_s": 8.115623235702515, "time_total_s": 1200.4984800815582, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99403a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1200.4984800815582, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 24.181818181818183, "ram_util_percent": 80.31818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.166988590249309, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7446079315962613, "policy_loss": -0.00429772819286439, "vf_loss": 2.748905663326304, "vf_explained_var": 0.1735840867120753, "kl": 0.006826316871266564, "entropy": 0.4556309710419367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.484522667961816, "cur_kl_coeff": 9.547511581331493e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.538648559649785, "policy_loss": -0.013468029980140272, "vf_loss": 5.552116589744886, "vf_explained_var": -0.6372109862665335, "kl": 0.012804759834671072, "entropy": 0.9280526999384164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 369.27, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36927, "policy_reward_min": {"agent_policy": -54.481646314416736, "adversary_policy": -42.80393319572227}, "policy_reward_max": {"agent_policy": 85.25831237563818, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": 5.354871132270597, "adversary_policy": -2.6774355661352978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 22, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400], "policy_agent_policy_reward": [16.288363667557892, 38.80094853954927, -32.7967919861031, -6.316471630797565, -22.497452011668702, 85.25831237563818, -21.138932299149126, 17.465369713876118, 43.00397255655804, 68.04162238609749, -22.168823842709717, 4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736], "policy_adversary_policy_reward": [-38.3598995637764, 22.071535896218514, -1.2435616980823738, -37.55738684146689, 26.689018035024716, 6.107773951078379, -1.6754240937766198, 7.991895724574185, 7.810855512455113, 14.686596499213575, -42.80393319572227, -42.454379179915904, 9.31742430707706, 11.821507992072078, 1.3308599248641606, -18.79622963874028, -16.02116125332275, -26.982811303235287, -33.55868777426512, -34.482934611832405, -1.5139413025541693, 23.682765145263875, -3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4006590589006088, "mean_inference_ms": 1.0418598325830377, "mean_action_processing_ms": 0.17265675109837905, "mean_env_wait_ms": 0.06807186306857838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035125017166137695, "StateBufferConnector_ms": 0.0025020837783813477, "ViewRequirementAgentConnector_ms": 0.06620430946350098}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.7122194611614, "num_env_steps_trained_throughput_per_sec": 485.7122194611614, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 8243.695, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8243.66, "sample_time_ms": 770.811, "learn_time_ms": 7460.414, "learn_throughput": 536.163, "synch_weights_time_ms": 11.784}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 148, "trial_id": "fa423_00000", "date": "2024-08-10_11-18-57", "timestamp": 1723303137, "time_this_iter_s": 8.241634845733643, "time_total_s": 1208.7401149272919, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99409d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1208.7401149272919, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 24.216666666666665, "ram_util_percent": 80.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.081481068853348, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.312164938639081, "policy_loss": -0.009194359366619397, "vf_loss": 3.321359293170707, "vf_explained_var": -0.47084835449223794, "kl": 0.009941503891082629, "entropy": 0.4278529537102533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.402551575563848, "cur_kl_coeff": 9.547511581331493e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7474941993753115, "policy_loss": -0.01711332569672474, "vf_loss": 4.764607532074054, "vf_explained_var": -0.2016544982790947, "kl": 0.019547871769500333, "entropy": 0.9395036193852623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 3.3306690738754695e-18, "episode_len_mean": 375.93, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37593, "policy_reward_min": {"agent_policy": -54.481646314416736, "adversary_policy": -38.472205689129396}, "policy_reward_max": {"agent_policy": 76.56880676052042, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": 2.1062953697735995, "adversary_policy": -1.0531476848867987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 154, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [4.287895957274703, -17.8795906657677, 76.56880676052042, 26.68804011030587, -9.328286192316568, -3.7247037058996675, 18.621580064404903, -43.22470413917662, -41.3251502447468, -0.5488721466537463, -6.5889915673106785, -12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451], "policy_adversary_policy_reward": [-3.758709379064822, -0.529186578209881, 13.20561627721877, 4.67397438854897, -38.09660107139091, -38.472205689129396, 4.36051645091699, -31.04855656122285, -19.74189069897577, 29.070176891292345, 4.348319396293409, -0.6236156903937378, 11.942049769595233, -30.563629834000135, 28.106901490716112, 15.117802648460497, 26.82015431879279, 14.504995925953992, -11.149378203420166, 11.698250350073902, -4.909161682250307, 11.498153249560986, 6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4006294763303309, "mean_inference_ms": 1.0412526063148102, "mean_action_processing_ms": 0.1725239094505736, "mean_env_wait_ms": 0.06806932734837531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490447998046875, "StateBufferConnector_ms": 0.0025290250778198242, "ViewRequirementAgentConnector_ms": 0.06612706184387207}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.2702268851888, "num_env_steps_trained_throughput_per_sec": 496.2702268851888, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1788000, "timers": {"training_iteration_time_ms": 8216.491, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8216.456, "sample_time_ms": 760.577, "learn_time_ms": 7443.446, "learn_throughput": 537.386, "synch_weights_time_ms": 11.804}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "done": false, "training_iteration": 149, "trial_id": "fa423_00000", "date": "2024-08-10_11-19-05", "timestamp": 1723303145, "time_this_iter_s": 8.066394090652466, "time_total_s": 1216.8065090179443, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9818dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1216.8065090179443, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 24.683333333333334, "ram_util_percent": 80.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.012819341944639, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5365159941098048, "policy_loss": -0.006035945786251908, "vf_loss": 2.5425519357282647, "vf_explained_var": -0.014118262226619417, "kl": 0.0052675381323077745, "entropy": 0.41900622690165484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9147896986454724, "cur_kl_coeff": 9.547511581331493e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2846215307712554, "policy_loss": -0.0031993979121277033, "vf_loss": 3.2878209305306276, "vf_explained_var": 0.1615542907267809, "kl": 0.01176947680182175, "entropy": 0.9671802883346875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": 0.0, "episode_reward_mean": 1.1102230246251566e-18, "episode_len_mean": 378.39, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37839, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -38.08303093031576}, "policy_reward_max": {"agent_policy": 62.23430788772925, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": 2.2265486320842363, "adversary_policy": -1.1132743160421175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-12.369347941014611, 30.647350809447744, 24.88808105609987, 12.21010305200744, 25.674180179955126, 2.2468826668972426, 14.951268550839064, -35.63583499259582, 45.381730180156616, 40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206], "policy_adversary_policy_reward": [6.297161408017256, 6.072186532997355, -28.202370723546792, -2.4449800859009407, -13.083621526382831, -11.80445952971704, 5.205854917040988, -17.415957969048428, -21.03061000797883, -4.643570171976295, 10.327523715482101, -12.574406382379344, 10.901030989903592, -25.85229954074265, 24.39493482150842, 11.240900171087393, -17.119251658387245, -28.262478521769363, -18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4004993470231345, "mean_inference_ms": 1.0406912033551776, "mean_action_processing_ms": 0.17245494987007595, "mean_env_wait_ms": 0.06802881430659444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003443121910095215, "StateBufferConnector_ms": 0.002522587776184082, "ViewRequirementAgentConnector_ms": 0.06659054756164551}, "num_episodes": 11, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": 0.0, "episode_return_mean": 1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.05125034600314, "num_env_steps_trained_throughput_per_sec": 500.05125034600314, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 8193.167, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8193.133, "sample_time_ms": 757.536, "learn_time_ms": 7423.263, "learn_throughput": 538.847, "synch_weights_time_ms": 11.708}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 150, "trial_id": "fa423_00000", "date": "2024-08-10_11-19-13", "timestamp": 1723303153, "time_this_iter_s": 8.004881858825684, "time_total_s": 1224.81139087677, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9940a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1224.81139087677, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 26.236363636363635, "ram_util_percent": 79.14545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2202370273373115, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7331247252131265, "policy_loss": -0.003712140304583406, "vf_loss": 2.736836865843919, "vf_explained_var": -0.2224674953039361, "kl": 0.005843068644226399, "entropy": 0.43805038588387624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4122698791945973, "cur_kl_coeff": 9.547511581331493e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.62190111503005, "policy_loss": -0.003172780870712207, "vf_loss": 3.625073895851771, "vf_explained_var": 0.30647818992535275, "kl": 0.010643350242382225, "entropy": 0.8927588698764642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 382.33, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38233, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -38.08303093031576}, "policy_reward_max": {"agent_policy": 62.23430788772925, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": 1.8073772926615554, "adversary_policy": -0.9036886463307767}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 155, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [40.25701548087006, 28.20278779975185, 27.043160157292515, 62.23430788772925, 40.918197459708914, -28.93386026353058, -4.551707671169076, -29.122795472439893, -21.894786128810424, -22.680069909305743, 20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224], "policy_adversary_policy_reward": [-18.76502955660386, -21.491985924266224, -38.08303093031576, 9.880243130563912, -25.18549540443397, -1.8576647528585468, -31.442910871394176, -30.791397016335075, -18.461804553845308, -22.456392905863606, 16.30223910959915, 12.631621153931427, 35.17180551651781, -30.620097845348752, 12.707344990807279, 16.415450481632618, 17.907012824057777, 3.987773304752647, 13.555587026724368, 9.124482882581376, -6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.400383651887152, "mean_inference_ms": 1.0402956381141133, "mean_action_processing_ms": 0.1723999609445653, "mean_env_wait_ms": 0.06800652225108003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033562183380126953, "StateBufferConnector_ms": 0.0024652481079101562, "ViewRequirementAgentConnector_ms": 0.06556546688079834}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.710347782597, "num_env_steps_trained_throughput_per_sec": 492.710347782597, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1812000, "timers": {"training_iteration_time_ms": 8178.491, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8178.455, "sample_time_ms": 753.388, "learn_time_ms": 7412.771, "learn_throughput": 539.609, "synch_weights_time_ms": 11.67}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "done": false, "training_iteration": 151, "trial_id": "fa423_00000", "date": "2024-08-10_11-19-21", "timestamp": 1723303161, "time_this_iter_s": 8.12338900566101, "time_total_s": 1232.934779882431, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9940dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1232.934779882431, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 23.900000000000002, "ram_util_percent": 79.24166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.396064064174733, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1402832930680935, "policy_loss": -0.006133916750353165, "vf_loss": 3.146417213117004, "vf_explained_var": -0.3508374133122661, "kl": 0.005576002094428182, "entropy": 0.4314516020672662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1848929188524684, "cur_kl_coeff": 9.547511581331493e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3308896337946257, "policy_loss": -0.010408465318808643, "vf_loss": 3.341298100848993, "vf_explained_var": -0.1902242176855604, "kl": 0.02483632198303355, "entropy": 0.9894788717230161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 384.78, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38478, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -31.7790658652795}, "policy_reward_max": {"agent_policy": 61.17184796356372, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": 2.2362513634181838, "adversary_policy": -1.118125681709091}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 4, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [20.280110567808784, 31.68341550933785, 6.047565803562044, 40.62809610024572, -14.601378146931605, -0.4740203756536623, -12.252016665069231, 16.08054308991843, -1.3754630096631881, 3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243], "policy_adversary_policy_reward": [-6.122058454531171, -14.158052113277613, -16.242091189853433, -15.44132431948442, -1.219760984008449, -4.82780481955362, -15.110491522980393, -25.51760457726532, 19.22161328970677, -4.620235142775169, -7.767177762878944, 8.241198138532607, -15.109974027923002, 27.361990692992215, -10.54671695991, -5.533826130008428, 4.28224571685743, -2.9067827071942425, -17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40020675353340246, "mean_inference_ms": 1.0398616182915423, "mean_action_processing_ms": 0.1723644501541723, "mean_env_wait_ms": 0.06796143641805832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034308433532714844, "StateBufferConnector_ms": 0.002510666847229004, "ViewRequirementAgentConnector_ms": 0.06730806827545166}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.1038476571132, "num_env_steps_trained_throughput_per_sec": 449.1038476571132, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 8232.427, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8232.392, "sample_time_ms": 750.316, "learn_time_ms": 7469.61, "learn_throughput": 535.503, "synch_weights_time_ms": 11.856}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 152, "trial_id": "fa423_00000", "date": "2024-08-10_11-19-30", "timestamp": 1723303170, "time_this_iter_s": 8.912880897521973, "time_total_s": 1241.847660779953, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99dd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1241.847660779953, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 27.323076923076922, "ram_util_percent": 79.67692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5725973299571447, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9617419037238633, "policy_loss": -0.0039327779645593, "vf_loss": 2.965674683467421, "vf_explained_var": -0.030404436809045296, "kl": 0.005342298390642853, "entropy": 0.4659440153017246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5208302337676285, "cur_kl_coeff": 1.4321267371997234e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.569161362449328, "policy_loss": -0.004865158325264929, "vf_loss": 4.574026513348023, "vf_explained_var": 0.13779815485080082, "kl": 0.01092744175371602, "entropy": 0.9348030326267084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.74, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38874, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -35.26900562784525}, "policy_reward_max": {"agent_policy": 61.17184796356372, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": 1.4844110484471884, "adversary_policy": -0.7422055242235931}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [3.691885923295649, 12.570562783503341, 16.297442134170478, 25.625249191822714, 10.694443500018512, -12.656663137164696, -13.047765024897767, 5.2580676553213195, -2.842034930521214, 3.5884200265526935, -36.8792917017786, -21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846], "policy_adversary_policy_reward": [-17.701123883103495, 14.009237959807848, 3.7997721400197015, -16.37033492352304, -0.12932296925475484, -16.168119164915723, -24.56312933508671, -1.0621198567359968, -6.401692975005719, -4.292750525012792, 19.10294815383442, -6.446285016669723, 26.46573563298205, -13.417970608084271, -20.05374324892509, 14.795675593603772, -2.862785797095853, 5.7048207276170615, -5.877001616158267, 2.288581589605574, 30.80122579255085, 6.078065909227746, 6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4001308438230696, "mean_inference_ms": 1.039451194131912, "mean_action_processing_ms": 0.17230626696191162, "mean_env_wait_ms": 0.06795774040787234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034024715423583984, "StateBufferConnector_ms": 0.0024962425231933594, "ViewRequirementAgentConnector_ms": 0.06796979904174805}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 483.4409835570517, "num_env_steps_trained_throughput_per_sec": 483.4409835570517, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1836000, "timers": {"training_iteration_time_ms": 8248.083, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8248.049, "sample_time_ms": 747.614, "learn_time_ms": 7487.96, "learn_throughput": 534.191, "synch_weights_time_ms": 11.892}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "done": false, "training_iteration": 153, "trial_id": "fa423_00000", "date": "2024-08-10_11-19-39", "timestamp": 1723303179, "time_this_iter_s": 8.278441905975342, "time_total_s": 1250.1261026859283, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99dd790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1250.1261026859283, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 27.14166666666667, "ram_util_percent": 80.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.289595762320927, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.335700417700268, "policy_loss": -0.006215903093722999, "vf_loss": 3.3419163184191185, "vf_explained_var": 0.18284107333137875, "kl": 0.0050613430533576935, "entropy": 0.5057325757685162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9993770617370803, "cur_kl_coeff": 1.4321267371997234e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.467051147917906, "policy_loss": -0.016777451873834556, "vf_loss": 5.483828621606032, "vf_explained_var": -0.13714155511309703, "kl": 0.018307763689097575, "entropy": 1.0356208622455596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 384.75, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38475, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -35.26900562784525}, "policy_reward_max": {"agent_policy": 61.17184796356372, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": 1.7435021521035867, "adversary_policy": -0.8717510760517925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [29, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-21.892518725344246, 12.47769301028958, 20.390803385564812, 61.17184796356372, 20.949740625461057, 14.82414416184685, -1.9059296366220373, -8.98774073763504, 27.42147724940204, -26.127534772847646, 34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592], "policy_adversary_policy_reward": [6.523782926774857, 15.36873579856939, -10.309653375455857, -2.16803963483372, -3.878568004075074, -16.512235381489738, -29.392782098284172, -31.7790658652795, -11.163533296872224, -9.786207328588834, -5.249628226787724, -9.574515935059125, 9.987359057516613, -8.081429420894574, -9.532765056654085, 18.520505794289125, -15.676395483167134, -11.745081766234899, 22.902418011056746, 3.2251167617909005, -21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39995514218136335, "mean_inference_ms": 1.0389755873644293, "mean_action_processing_ms": 0.17223156706791115, "mean_env_wait_ms": 0.06793128749676659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478527069091797, "StateBufferConnector_ms": 0.002542734146118164, "ViewRequirementAgentConnector_ms": 0.06833231449127197}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.4434781949989, "num_env_steps_trained_throughput_per_sec": 496.4434781949989, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 8227.55, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8227.516, "sample_time_ms": 749.533, "learn_time_ms": 7465.626, "learn_throughput": 535.789, "synch_weights_time_ms": 11.695}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "training_iteration": 154, "trial_id": "fa423_00000", "date": "2024-08-10_11-19-47", "timestamp": 1723303187, "time_this_iter_s": 8.062818050384521, "time_total_s": 1258.1889207363129, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99ddaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1258.1889207363129, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 23.541666666666668, "ram_util_percent": 80.01666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2602228606819477, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0325895007325228, "policy_loss": -0.004220692363134018, "vf_loss": 3.036810185417296, "vf_explained_var": 0.19117521164278506, "kl": 0.0051500612220413, "entropy": 0.4948913161874448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.287306000602742, "cur_kl_coeff": 1.4321267371997234e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.755697725216548, "policy_loss": -0.006030484353929447, "vf_loss": 4.761728197584549, "vf_explained_var": -0.369247266339759, "kl": 0.009786780498918716, "entropy": 1.1206860354170203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.46, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38846, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -35.26900562784525}, "policy_reward_max": {"agent_policy": 49.547985558963035, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": 0.06433492272032176, "adversary_policy": -0.03216746136016042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [34.914926157348276, 31.250941443426434, -13.07121309344302, 0.5818018788288803, 21.61189142389508, -0.2220879935504989, 33.117975137164926, -11.031366286982838, -23.59074517029348, -17.850818317155433, 28.939836276117415, -30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592, 2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748], "policy_adversary_policy_reward": [-21.08497926778692, -13.829946889561342, -10.565521504827984, -20.685419938598432, -3.1839292245794475, 16.25514231802247, -3.0391786973475696, 2.4573768185186893, -8.559817730853993, -13.05207369304108, 0.8615207478264999, -0.639432754276001, -13.869724233217987, -19.248250903946943, 17.759344603785003, -6.727978316802165, 8.042952467644945, 15.547792702648536, 4.262033173734398, 13.588785143421035, -10.51260404861037, -18.427232227507048, 8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704, 10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39979874816128197, "mean_inference_ms": 1.0385487038883585, "mean_action_processing_ms": 0.17216549677976356, "mean_env_wait_ms": 0.06790841093321692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035059452056884766, "StateBufferConnector_ms": 0.0025364160537719727, "ViewRequirementAgentConnector_ms": 0.06844043731689453}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.40143638877345, "num_env_steps_trained_throughput_per_sec": 495.40143638877345, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1860000, "timers": {"training_iteration_time_ms": 8206.741, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8206.707, "sample_time_ms": 750.065, "learn_time_ms": 7444.217, "learn_throughput": 537.33, "synch_weights_time_ms": 11.723}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "done": false, "training_iteration": 155, "trial_id": "fa423_00000", "date": "2024-08-10_11-19-55", "timestamp": 1723303195, "time_this_iter_s": 8.07937502861023, "time_total_s": 1266.268295764923, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9818e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1266.268295764923, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 23.818181818181813, "ram_util_percent": 79.94545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0607982272193546, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.659595417597937, "policy_loss": -0.006540447753785109, "vf_loss": 3.666135871978033, "vf_explained_var": -0.12914690151416436, "kl": 0.009200364882762881, "entropy": 0.41112082674705164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5875961462035777, "cur_kl_coeff": 1.4321267371997234e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.761449417223533, "policy_loss": -0.005048655504166769, "vf_loss": 4.766498066484928, "vf_explained_var": 0.35380498723437387, "kl": 0.009762558716764177, "entropy": 0.8666200034320355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.46, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38846, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -35.26900562784525}, "policy_reward_max": {"agent_policy": 49.547985558963035, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": -1.5000131001740147, "adversary_policy": 0.750006550087008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 35, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-30.198097224521536, -14.570173953190952, -6.5596061824022165, 37.167716799210254, -17.211041025662812, 4.417808493372647, -9.693475150487632, 19.38999143823564, 17.566970110811408, -18.5714988467464, -18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592, 2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748, -53.5484346852913, -15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348], "policy_adversary_policy_reward": [8.483502423307264, 21.714594801214258, 7.550685243072909, 7.019488710118043, 6.714573784195249, -0.15496760179303237, -24.462873170333786, -12.704843628876443, -5.224519620240876, 22.435560645903685, -1.0178101972532758, -3.399998296119369, 19.634175411630242, -9.94070026114261, -14.557156724586811, -4.832834713648818, -13.41383629992907, -4.153133810882338, -8.882315911204323, 27.453814757950717, 11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704, 10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917, 24.593832410229584, 28.954602275061703, -7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3997209294424023, "mean_inference_ms": 1.0380982398656458, "mean_action_processing_ms": 0.17210863011277794, "mean_env_wait_ms": 0.06788345749474281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043833255767822266, "StateBufferConnector_ms": 0.002538442611694336, "ViewRequirementAgentConnector_ms": 0.06837999820709229}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.8694225874756, "num_env_steps_trained_throughput_per_sec": 482.8694225874756, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 8211.879, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8211.845, "sample_time_ms": 748.776, "learn_time_ms": 7450.671, "learn_throughput": 536.864, "synch_weights_time_ms": 11.623}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 156, "trial_id": "fa423_00000", "date": "2024-08-10_11-20-04", "timestamp": 1723303204, "time_this_iter_s": 8.289885997772217, "time_total_s": 1274.5581817626953, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99ddb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1274.5581817626953, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 24.28333333333333, "ram_util_percent": 79.90833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.566155251308724, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.391604451149229, "policy_loss": -0.007068821390666974, "vf_loss": 3.3986732678438623, "vf_explained_var": 0.26143209751320895, "kl": 0.010123131507750183, "entropy": 0.591468572947714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6472125032916667, "cur_kl_coeff": 1.4321267371997234e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3954303587476415, "policy_loss": -0.009857424295963332, "vf_loss": 5.4052877523005005, "vf_explained_var": 0.4738855674862862, "kl": 0.014207635621132093, "entropy": 0.731006553893288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.27, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38827, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -35.26900562784525}, "policy_reward_max": {"agent_policy": 49.547985558963035, "adversary_policy": 36.04196405403443}, "policy_reward_mean": {"agent_policy": -0.7462056258595063, "adversary_policy": 0.37310281292975317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400], "policy_agent_policy_reward": [-18.179131184317146, 0.2720522517832471, -17.80478360773183, -26.311815697345615, 3.76112077267468, -5.846440716423152, 24.09606538993312, -54.481646314416736, -2.071582176951054, -9.633965206018548, -44.42020282607278, -15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592, 2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748, -53.5484346852913, -15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348, 6.135878744745776, 38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765], "policy_adversary_policy_reward": [11.98514837282363, 6.193982811493516, -2.9446682039408607, 2.6726159521576136, 0.3816560890404581, 17.423127518691373, 11.72953270898747, 14.582282988358145, -16.913769077429244, 13.15264830475456, -0.8278339987576864, 6.674274715180839, -15.04031789666498, -9.055747493268143, 36.04196405403443, 18.43968226038232, 8.492502622076895, -6.420920445125841, 15.83819175437253, -6.2042265483539865, 12.829640773188453, 31.590562052884316, 23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704, 10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917, 24.593832410229584, 28.954602275061703, -7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787, 7.580775287918305, -13.716654032664081, -15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39962969930096065, "mean_inference_ms": 1.03788250691612, "mean_action_processing_ms": 0.17205114165212337, "mean_env_wait_ms": 0.06786869413915025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004496574401855469, "StateBufferConnector_ms": 0.0026061534881591797, "ViewRequirementAgentConnector_ms": 0.06980741024017334}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.918044363563, "num_env_steps_trained_throughput_per_sec": 486.918044363563, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1884000, "timers": {"training_iteration_time_ms": 8222.403, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8222.367, "sample_time_ms": 757.841, "learn_time_ms": 7452.204, "learn_throughput": 536.754, "synch_weights_time_ms": 11.602}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "done": false, "training_iteration": 157, "trial_id": "fa423_00000", "date": "2024-08-10_11-20-12", "timestamp": 1723303212, "time_this_iter_s": 8.220566034317017, "time_total_s": 1282.7787477970123, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99ddee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1282.7787477970123, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 27.03333333333333, "ram_util_percent": 79.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.437691003494162, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.136050725866247, "policy_loss": -0.007085709162697038, "vf_loss": 4.143136434958725, "vf_explained_var": -0.14381711596534366, "kl": 0.01140724380990114, "entropy": 0.6996137994937796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6072200423727434, "cur_kl_coeff": 1.4321267371997234e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.963442530234655, "policy_loss": -0.009657513253720633, "vf_loss": 5.973100039362907, "vf_explained_var": 0.08408955000340938, "kl": 0.02755040506122241, "entropy": 0.7772890873874228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 392.17, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39217, "policy_reward_min": {"agent_policy": -62.915303567190065, "adversary_policy": -35.26900562784525}, "policy_reward_max": {"agent_policy": 60.11874992721482, "adversary_policy": 34.977957444444456}, "policy_reward_mean": {"agent_policy": 1.7986997179067645, "adversary_policy": -0.899349858953382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-15.515189336435387, 3.537781707816407, 6.954711830000328, 0.07120528730889575, 9.206698357160452, -47.72163719747064, -13.536648571654215, -47.78863064853451, -23.555252484502503, 25.690189289929158, -62.915303567190065, 30.24109842438915, 11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592, 2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748, -53.5484346852913, -15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348, 6.135878744745776, 38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765, -2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482], "policy_adversary_policy_reward": [23.319059197963888, -7.803869861528515, 14.195093642209319, -17.732875350025726, 5.638643683318191, -12.59335551331852, 2.9997793955467387, -3.0709846828556344, -4.6548303021013595, -4.551868055059092, 21.577105911368267, 26.144531286102385, 22.20570152817542, -8.669052956521195, 33.44394568458932, 14.344684963945216, 12.698717603798816, 10.856534880703698, -6.2129762503588, -19.47721303957036, 33.01627331169752, 29.899030255492534, -18.596423664923964, -11.644674759465186, -23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704, 10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917, 24.593832410229584, 28.954602275061703, -7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787, 7.580775287918305, -13.716654032664081, -15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487, -10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39955068285583645, "mean_inference_ms": 1.0375000084036456, "mean_action_processing_ms": 0.17201961771637944, "mean_env_wait_ms": 0.06787308611067747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00453794002532959, "StateBufferConnector_ms": 0.0026346445083618164, "ViewRequirementAgentConnector_ms": 0.07172250747680664}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.41786424259413, "num_env_steps_trained_throughput_per_sec": 489.41786424259413, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1896000, "timers": {"training_iteration_time_ms": 8216.168, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8216.132, "sample_time_ms": 755.33, "learn_time_ms": 7448.535, "learn_throughput": 537.018, "synch_weights_time_ms": 11.6}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "done": false, "training_iteration": 158, "trial_id": "fa423_00000", "date": "2024-08-10_11-20-20", "timestamp": 1723303220, "time_this_iter_s": 8.178971767425537, "time_total_s": 1290.9577195644379, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9959280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1290.9577195644379, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 25.125, "ram_util_percent": 80.39166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.615743911644769, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.28158002202473, "policy_loss": -0.006824436150097027, "vf_loss": 3.288404469199912, "vf_explained_var": 0.009536700179337193, "kl": 0.012203298740889173, "entropy": 0.7068964526451454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5502528607845307, "cur_kl_coeff": 2.148190105799585e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.256794310609499, "policy_loss": -0.01329926439357223, "vf_loss": 5.270093562453985, "vf_explained_var": 0.17383567908157904, "kl": 0.024527396961592063, "entropy": 0.8334602552155653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 388.3, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38830, "policy_reward_min": {"agent_policy": -53.5484346852913, "adversary_policy": -41.40579460973319}, "policy_reward_max": {"agent_policy": 60.11874992721482, "adversary_policy": 34.977957444444456}, "policy_reward_mean": {"agent_policy": 5.088347354102184, "adversary_policy": -2.5441736770510914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [11.607523415157248, 7.989825076542919, -6.082384303292123, 49.547985558963035, -34.01039138803578, 29.722189742449896, -12.664129302713206, -29.785005182536015, 20.307458177097317, 9.32942056466392, -21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592, 2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748, -53.5484346852913, -15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348, 6.135878744745776, 38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765, -2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156], "policy_adversary_policy_reward": [-23.80899801111754, 12.201474595960292, -15.639884741030734, 7.65005966448782, -1.7723571086795644, 7.854741411971684, -31.339783973297678, -18.208201585665346, 23.82508090172616, 10.185310486309639, -25.31280716528741, -4.40938257716248, 15.404867989622389, -2.7407386869091823, 20.840681934187483, 8.944323248348532, -5.13948354907642, -15.167974628020897, -7.862048237416477, -1.4673723272474426, 5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704, 10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917, 24.593832410229584, 28.954602275061703, -7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787, 7.580775287918305, -13.716654032664081, -15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487, -10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3994449558921211, "mean_inference_ms": 1.0370740372859384, "mean_action_processing_ms": 0.1719083646689123, "mean_env_wait_ms": 0.06783324964698585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044782161712646484, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.07031393051147461}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.45752241211636, "num_env_steps_trained_throughput_per_sec": 484.45752241211636, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1908000, "timers": {"training_iteration_time_ms": 8235.821, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8235.785, "sample_time_ms": 757.02, "learn_time_ms": 7466.561, "learn_throughput": 535.722, "synch_weights_time_ms": 11.533}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "done": false, "training_iteration": 159, "trial_id": "fa423_00000", "date": "2024-08-10_11-20-29", "timestamp": 1723303229, "time_this_iter_s": 8.261690855026245, "time_total_s": 1299.219410419464, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99598b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1299.219410419464, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 23.65833333333333, "ram_util_percent": 80.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3583321946007865, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4319953401883443, "policy_loss": -0.00857649425244225, "vf_loss": 3.4405718361889877, "vf_explained_var": 0.05290068435290503, "kl": 0.008745304982744423, "entropy": 0.6863412543894752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.406077694023649, "cur_kl_coeff": 3.222285158699379e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.447147480646769, "policy_loss": -0.003570950079059306, "vf_loss": 5.450718429187933, "vf_explained_var": 0.32208564716080823, "kl": 0.01280633577521447, "entropy": 0.7594435024385651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.12, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38512, "policy_reward_min": {"agent_policy": -53.5484346852913, "adversary_policy": -41.40579460973319}, "policy_reward_max": {"agent_policy": 60.11874992721482, "adversary_policy": 34.977957444444456}, "policy_reward_mean": {"agent_policy": 5.15746330005797, "adversary_policy": -2.578731650028985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-21.16896417830189, 31.650906551144175, 12.862194769962738, -8.787110839077636, 30.763074655249586, 20.9053051013224, 9.756863725740033, 46.540156026202126, -5.3112328483553135, 2.1700546476992812, 7.301915774474779, 1.8502445607356854, -7.064800794727873, 24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592, 2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748, -53.5484346852913, -15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348, 6.135878744745776, 38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765, -2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021], "policy_adversary_policy_reward": [5.980839750525973, 15.188124427775918, -17.22482763327527, -14.426078917868896, -16.926912088736472, 4.064717318773724, 2.4926288909983825, 6.294481948079266, -11.407259931599807, -19.35581472364978, -1.066256368190686, -19.839048733131715, -8.996568860038408, -0.7602948657016242, -21.63186547775446, -24.908290548447653, 11.774631487379132, -6.4633986390238185, -4.048497217453274, 1.878442569753993, -13.501791383561894, 6.199875609087115, 6.24504200559133, -8.095286566327015, 3.967861661841262, 3.096939132886618, -13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704, 10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917, 24.593832410229584, 28.954602275061703, -7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787, 7.580775287918305, -13.716654032664081, -15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487, -10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991824905172093, "mean_inference_ms": 1.0367225339412927, "mean_action_processing_ms": 0.17192449395317122, "mean_env_wait_ms": 0.06781038967732635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004850506782531738, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.07138478755950928}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.0724803339032, "num_env_steps_trained_throughput_per_sec": 486.0724803339032, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 8258.826, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8258.788, "sample_time_ms": 761.807, "learn_time_ms": 7484.672, "learn_throughput": 534.426, "synch_weights_time_ms": 11.61}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 160, "trial_id": "fa423_00000", "date": "2024-08-10_11-20-37", "timestamp": 1723303237, "time_this_iter_s": 8.234586000442505, "time_total_s": 1307.4539964199066, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9959c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1307.4539964199066, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 26.24166666666667, "ram_util_percent": 80.35833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5155486953952324, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.881203908642764, "policy_loss": -0.003738379291142953, "vf_loss": 3.884942288878103, "vf_explained_var": 0.20550616519161002, "kl": 0.006102033024209055, "entropy": 0.6249430275467969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.237964660736422, "cur_kl_coeff": 3.222285158699379e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.327494477232297, "policy_loss": -0.003207744522660505, "vf_loss": 5.330702216923237, "vf_explained_var": 0.34088248331099746, "kl": 0.010210516103050838, "entropy": 0.6982755242536466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 375.31, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 37531, "policy_reward_min": {"agent_policy": -53.5484346852913, "adversary_policy": -43.9043403217553}, "policy_reward_max": {"agent_policy": 67.61516427981647, "adversary_policy": 34.977957444444456}, "policy_reward_mean": {"agent_policy": 6.109784059021559, "adversary_policy": -3.05489202951078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400], "policy_agent_policy_reward": [24.22790914831606, 35.33661351553971, 19.551932660135243, -41.6842416014736, 36.60591036203877, 31.520801413502937, -1.6659320147253904, 6.4113416492000255, -31.602524128325275, -3.5096380275732493, 6.310672832344551, 8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592, 2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748, -53.5484346852913, -15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348, 6.135878744745776, 38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765, -2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476], "policy_adversary_policy_reward": [-13.706697650078304, -10.521211498237756, -16.196410049146706, -19.140203466393004, -6.004932678992091, -13.546999981143152, 14.67655606218299, 27.00768553929062, -20.66046594814524, -15.945444413893519, -35.26900562784525, 3.7482042143423087, -16.512217658353325, 18.17814967307871, -9.972026137041496, 3.560684487841474, -3.3754333161191994, 34.977957444444456, 3.2182468255085297, 0.2913912020647196, -4.12690589300062, -2.1837669393439363, -27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704, 10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917, 24.593832410229584, 28.954602275061703, -7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787, 7.580775287918305, -13.716654032664081, -15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487, -10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39912980584396174, "mean_inference_ms": 1.0364183740114357, "mean_action_processing_ms": 0.1718445700019698, "mean_env_wait_ms": 0.06782776550260715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004790186882019043, "StateBufferConnector_ms": 0.002549409866333008, "ViewRequirementAgentConnector_ms": 0.07478523254394531}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.1557873076732, "num_env_steps_trained_throughput_per_sec": 490.1557873076732, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1932000, "timers": {"training_iteration_time_ms": 8263.057, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8263.02, "sample_time_ms": 765.494, "learn_time_ms": 7485.164, "learn_throughput": 534.39, "synch_weights_time_ms": 11.606}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "done": false, "training_iteration": 161, "trial_id": "fa423_00000", "date": "2024-08-10_11-20-46", "timestamp": 1723303246, "time_this_iter_s": 8.16599988937378, "time_total_s": 1315.6199963092804, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99ddee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1315.6199963092804, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 25.990909090909096, "ram_util_percent": 80.3090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3564130849939176, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.821170602399836, "policy_loss": -0.005851753033505427, "vf_loss": 3.8270223587278336, "vf_explained_var": 0.037255684408561265, "kl": 0.01233362028526514, "entropy": 0.7316740040425901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0496664347747964, "cur_kl_coeff": 3.222285158699379e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.446469960610072, "policy_loss": -0.0047892713123777264, "vf_loss": 5.451259233305851, "vf_explained_var": 0.42965582609176634, "kl": 0.012437152757032107, "entropy": 0.721824718080461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 370.51, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37051, "policy_reward_min": {"agent_policy": -53.5484346852913, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 34.03461398031486}, "policy_reward_mean": {"agent_policy": 7.822680457980903, "adversary_policy": -3.911340228990453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154], "policy_agent_policy_reward": [8.446430891466846, 29.720167365746384, -11.95191604540086, -5.286630420662515, 0.3443866925639014, 1.0301816313017333, -0.9494800993673213, 21.89460430988487, 9.787698452004875, 15.11901236498867, -6.132807910323855, -15.365789554773592, 2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748, -53.5484346852913, -15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348, 6.135878744745776, 38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765, -2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207], "policy_adversary_policy_reward": [-27.58393086273773, 19.137499971270884, -25.21607768580966, -4.504089679936733, 13.609135829735092, -1.657219784334231, 19.986261102262077, -14.699630681599562, -16.147449656449567, 15.803062963885665, 10.379802107670361, -11.409983738972095, 0.0, 0.9494800993673213, 6.128536252163286, -28.023140562048155, 4.264803070677786, -14.052501522682665, -4.741877287731096, -10.377135077257574, 4.76781103226017, 1.3649968780636854, -3.6669452636911117, 19.032734818464704, 10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917, 24.593832410229584, 28.954602275061703, -7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787, 7.580775287918305, -13.716654032664081, -15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487, -10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39904966457007324, "mean_inference_ms": 1.0361019240091403, "mean_action_processing_ms": 0.17178674693869797, "mean_env_wait_ms": 0.06780710830299634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004700660705566406, "StateBufferConnector_ms": 0.0025320053100585938, "ViewRequirementAgentConnector_ms": 0.07317578792572021}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.90447925913287, "num_env_steps_trained_throughput_per_sec": 496.90447925913287, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1944000, "timers": {"training_iteration_time_ms": 8177.378, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8177.342, "sample_time_ms": 767.423, "learn_time_ms": 7397.541, "learn_throughput": 540.72, "synch_weights_time_ms": 11.614}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "done": false, "training_iteration": 162, "trial_id": "fa423_00000", "date": "2024-08-10_11-20-54", "timestamp": 1723303254, "time_this_iter_s": 8.055282831192017, "time_total_s": 1323.6752791404724, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9959ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1323.6752791404724, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 23.266666666666666, "ram_util_percent": 80.30833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5261466755438104, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1536590350998774, "policy_loss": -0.004447665649821006, "vf_loss": 3.158106701083915, "vf_explained_var": 0.11351923967795398, "kl": 0.005655793502810018, "entropy": 0.8064848415435306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.348785471916199, "cur_kl_coeff": 3.222285158699379e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.648119956006607, "policy_loss": -0.007819568745617289, "vf_loss": 4.655939529587825, "vf_explained_var": 0.31960729335745175, "kl": 0.02192837949691638, "entropy": 0.6556662239755193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 368.36, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36836, "policy_reward_min": {"agent_policy": -53.5484346852913, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 34.03461398031486}, "policy_reward_mean": {"agent_policy": 8.74458527988687, "adversary_policy": -4.372292639943435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400], "policy_agent_policy_reward": [2.1872641113099647, 7.82334403149917, -20.052792662942228, -19.07828531171736, -9.396844848260645, 16.036751671191652, -26.140098166195074, -38.80808647219091, -7.424450223529492, 25.25845745618748, -53.5484346852913, -15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348, 6.135878744745776, 38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765, -2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886], "policy_adversary_policy_reward": [10.37215068527232, -12.559414796582292, -9.952308909128405, 2.1289648776292385, 18.86768019831377, 1.1851124646284603, 9.178992286537863, 9.899293025179496, -1.7121373338892987, 11.108982182149944, -14.949032081588658, -1.0877195896029903, 14.16457575188348, 11.975522414311595, 32.13445182117853, 6.6736346510123745, 3.920888655027026, 3.5035615685024517, -11.26029874022956, -13.998158715957917, 24.593832410229584, 28.954602275061703, -7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787, 7.580775287918305, -13.716654032664081, -15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487, -10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39892136388552674, "mean_inference_ms": 1.0359099186787852, "mean_action_processing_ms": 0.17180300356772416, "mean_env_wait_ms": 0.06775732254215681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004632115364074707, "StateBufferConnector_ms": 0.0024727582931518555, "ViewRequirementAgentConnector_ms": 0.07200920581817627}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": 0.0, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.4842209633473, "num_env_steps_trained_throughput_per_sec": 487.4842209633473, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1956000, "timers": {"training_iteration_time_ms": 8170.516, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8170.479, "sample_time_ms": 770.726, "learn_time_ms": 7387.404, "learn_throughput": 541.462, "synch_weights_time_ms": 11.585}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "done": false, "training_iteration": 163, "trial_id": "fa423_00000", "date": "2024-08-10_11-21-02", "timestamp": 1723303262, "time_this_iter_s": 8.210628032684326, "time_total_s": 1331.8859071731567, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9853040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1331.8859071731567, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 23.391666666666666, "ram_util_percent": 80.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6447927010753167, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.427757062230792, "policy_loss": -0.005802608366991595, "vf_loss": 4.433559662324411, "vf_explained_var": 0.14940239471733255, "kl": 0.007696656074622595, "entropy": 0.851570750922753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9688675560057165, "cur_kl_coeff": 4.833427738049066e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.163502260049184, "policy_loss": -0.005158262255038911, "vf_loss": 6.168660527964433, "vf_explained_var": 0.5205532969286044, "kl": 0.01344423268781269, "entropy": 0.5935119768604636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 357.7, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35770, "policy_reward_min": {"agent_policy": -40.58090840413981, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 39.44526766638343}, "policy_reward_mean": {"agent_policy": 10.815004896379435, "adversary_policy": -5.407502448189717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322], "policy_agent_policy_reward": [-15.107536874879987, -18.69079098446757, -24.14539579788741, -17.605293219741117, 38.37519005507068, 2.330803338834375, 21.70323424348907, -30.267149542887175, 11.29446555003316, 13.877247083649348, 6.135878744745776, 38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765, -2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453], "policy_adversary_policy_reward": [-7.977807336045597, 23.085344210925584, 19.797147586578628, -1.1063566021110756, 9.040349280683891, 15.105046517203519, 12.461255999651861, 5.144037220089276, -10.83317553937406, -27.54201451569663, -0.26900418815284866, -2.0617991506815265, -8.441211860115459, -13.262022383373612, 17.780285742387832, 12.486863800499357, -6.209116492620321, -5.085349057412836, -6.51028965075856, -7.366957432890787, 7.580775287918305, -13.716654032664081, -15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487, -10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3989807613811815, "mean_inference_ms": 1.0358311025891629, "mean_action_processing_ms": 0.1717835235285435, "mean_env_wait_ms": 0.06776403622893204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004637002944946289, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.07233774662017822}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.3521725311532, "num_env_steps_trained_throughput_per_sec": 470.3521725311532, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 8215.211, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8215.175, "sample_time_ms": 793.248, "learn_time_ms": 7409.523, "learn_throughput": 539.846, "synch_weights_time_ms": 11.713}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 164, "trial_id": "fa423_00000", "date": "2024-08-10_11-21-11", "timestamp": 1723303271, "time_this_iter_s": 8.510208129882812, "time_total_s": 1340.3961153030396, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9853670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1340.3961153030396, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 27.308333333333334, "ram_util_percent": 80.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2738281898397616, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.464630036253147, "policy_loss": -0.010975678732234335, "vf_loss": 4.4756057100951985, "vf_explained_var": -0.572453951267969, "kl": 0.02676874470638014, "entropy": 0.9084012140357305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.737122327523927, "cur_kl_coeff": 4.833427738049066e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.109303751587868, "policy_loss": -0.003178261728802075, "vf_loss": 6.112482008337975, "vf_explained_var": 0.5313425223653515, "kl": 0.008560492192320107, "entropy": 0.621112153865397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 357.64, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35764, "policy_reward_min": {"agent_policy": -44.79438205132178, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 12.151092313951121, "adversary_policy": -6.075546156975561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 16, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [38.21629435565751, 34.62631554608142, 39.3288718420754, 5.6228995364096654, -7.908392678933545, -22.291998635102104, 15.375821293161408, -16.02210212944861, -35.96424598457765, -2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834], "policy_adversary_policy_reward": [-15.897970291345668, -22.31832406431183, -21.378609460747214, -13.247706085334208, -26.84660244217652, -12.482269399898925, 12.582162661772593, -18.205062198182258, -1.5666977246058806, 9.475090403539426, 34.03461398031486, -11.742615345212748, -15.935899296186214, 0.560078003024806, 18.76735478887986, -2.7452526594312516, 14.52065029642215, 21.443595688155487, -10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3989502718899387, "mean_inference_ms": 1.0357649409789067, "mean_action_processing_ms": 0.17178075179181682, "mean_env_wait_ms": 0.06775716113124368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037374496459960938, "StateBufferConnector_ms": 0.0025000572204589844, "ViewRequirementAgentConnector_ms": 0.07279312610626221}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.77895588694764, "num_env_steps_trained_throughput_per_sec": 505.77895588694764, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1980000, "timers": {"training_iteration_time_ms": 8198.645, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8198.607, "sample_time_ms": 792.424, "learn_time_ms": 7393.928, "learn_throughput": 540.984, "synch_weights_time_ms": 11.605}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "done": false, "training_iteration": 165, "trial_id": "fa423_00000", "date": "2024-08-10_11-21-19", "timestamp": 1723303279, "time_this_iter_s": 7.9142820835113525, "time_total_s": 1348.310397386551, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98539d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1348.310397386551, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 23.308333333333334, "ram_util_percent": 79.85833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.017574808963392, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.808785873241526, "policy_loss": -0.004389406686461476, "vf_loss": 4.813175287826982, "vf_explained_var": -0.2278525415236357, "kl": 0.009692773389147941, "entropy": 0.8707986936052009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6169187961767117, "cur_kl_coeff": 4.833427738049066e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.48937595585982, "policy_loss": -0.011469991940248291, "vf_loss": 5.500845954070488, "vf_explained_var": 0.1352705001210173, "kl": 0.022247867189297547, "entropy": 0.6781776569162806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 361.48, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36148, "policy_reward_min": {"agent_policy": -48.613615254498725, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 12.142286417724563, "adversary_policy": -6.071143208862281}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-2.0775979285799977, 34.83618863611973, -15.89017937764725, -24.96376023030043, 44.19282038747939, -1.473713638920234, 21.992200314645487, -9.573367503359975, 0.24297890770020203, -3.53411443261051, 60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774], "policy_adversary_policy_reward": [-10.074900480400991, 12.152498408980989, -20.03244839305299, -14.803740243066741, 3.6390765006494554, 12.251102876997795, 14.919556960993155, 10.044203269307275, -21.053170256044847, -23.139650131434536, -4.515896396253893, 5.9896100351741275, -11.435851217745732, -10.556349096899755, 2.792655219393197, 6.780712283966775, 10.699678060697071, -10.942656968397273, 5.7780095645374985, -2.2438951319269895, -31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3989165681279314, "mean_inference_ms": 1.035817517976897, "mean_action_processing_ms": 0.17178707277492866, "mean_env_wait_ms": 0.06774981762842638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675222396850586, "StateBufferConnector_ms": 0.002450108528137207, "ViewRequirementAgentConnector_ms": 0.07191550731658936}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.694762114407, "num_env_steps_trained_throughput_per_sec": 500.694762114407, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1992000, "timers": {"training_iteration_time_ms": 8169.153, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8169.116, "sample_time_ms": 791.827, "learn_time_ms": 7365.123, "learn_throughput": 543.1, "synch_weights_time_ms": 11.586}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "done": false, "training_iteration": 166, "trial_id": "fa423_00000", "date": "2024-08-10_11-21-27", "timestamp": 1723303287, "time_this_iter_s": 7.9937968254089355, "time_total_s": 1356.3041942119598, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9853a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1356.3041942119598, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 24.072727272727274, "ram_util_percent": 79.57272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7767529119890204, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2783804863218275, "policy_loss": -0.00624763157080721, "vf_loss": 3.284628115633808, "vf_explained_var": -0.03700710326906235, "kl": 0.012495955650029604, "entropy": 1.121539832202215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.643505717876057, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.872814097007116, "policy_loss": -0.003443919582059607, "vf_loss": 4.876258014639219, "vf_explained_var": 0.3469884973640243, "kl": 0.01585131527825799, "entropy": 0.6292746728286147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 361.48, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36148, "policy_reward_min": {"agent_policy": -48.613615254498725, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 12.413883513805342, "adversary_policy": -6.20694175690267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [60.11874992721482, 19.74764425655811, 25.802146696267698, 3.2970222561491553, 12.514465590052014, -14.636309551484615, 34.63495122144922, -23.564410150305687, 51.253836301225085, 15.86288644505004, 23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887], "policy_adversary_policy_reward": [-31.253115869909514, -28.865634057305314, -23.443445244789096, 3.6958009882309852, -22.151345566913207, -3.650801129354491, -10.992981097155916, 7.69595884100676, 10.232283043896842, -22.746748633948854, 9.902514879197824, 4.733794672286791, -41.40579460973319, 6.7708433882839625, -8.864852383262463, 32.42926253356815, -26.272894332661203, -24.980941968563865, 4.424369300650763, -20.287255745700804, -7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988597670864428, "mean_inference_ms": 1.0354993978446467, "mean_action_processing_ms": 0.1717663209227432, "mean_env_wait_ms": 0.06774188590403626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675103187561035, "StateBufferConnector_ms": 0.0024552345275878906, "ViewRequirementAgentConnector_ms": 0.07052862644195557}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.8212462494012, "num_env_steps_trained_throughput_per_sec": 452.8212462494012, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2004000, "timers": {"training_iteration_time_ms": 8231.01, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8230.975, "sample_time_ms": 784.804, "learn_time_ms": 7434.007, "learn_throughput": 538.068, "synch_weights_time_ms": 11.565}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "done": false, "training_iteration": 167, "trial_id": "fa423_00000", "date": "2024-08-10_11-21-36", "timestamp": 1723303296, "time_this_iter_s": 8.838736057281494, "time_total_s": 1365.1429302692413, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a721baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1365.1429302692413, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 29.961538461538467, "ram_util_percent": 80.45384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.781647240547907, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.469148851450158, "policy_loss": -0.004718306029052843, "vf_loss": 3.4738671698898234, "vf_explained_var": -0.18561311534472874, "kl": 0.00976654033315478, "entropy": 1.1101870295231935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.538322875400384, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.20819956411918, "policy_loss": -0.0032043401505992128, "vf_loss": 6.2114038815100985, "vf_explained_var": 0.28090559113770724, "kl": 0.011533112439047, "entropy": 0.5899104790762066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 365.35, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36535, "policy_reward_min": {"agent_policy": -48.613615254498725, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 10.332487217763019, "adversary_policy": -5.16624360888151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 339, 400, 143, 400, 400, 400, 400, 400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [23.980443263547784, 27.561327224158582, 17.17978315769156, 5.3900762490618455, 13.797172503577777, -7.045616673745176, 3.431777818809735, 10.572885776999485, 21.593098754791693, 14.370015742936708, -37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887, -4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025], "policy_adversary_policy_reward": [-7.334995405631844, -16.64544785791594, -12.372761548463213, -15.188565675695369, -12.15647983916675, -5.02330331852481, 12.489020848181196, -17.87909709724304, 0.35851344359818427, -14.15568594717596, -21.60672903444831, 28.652345708193486, -5.940878203852897, 2.509100385043162, -6.132743525969346, -4.440142251030139, -14.987558005538325, -6.605540749253368, -1.8145952927799804, -12.555420450156724, 9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291, -3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39885458395221873, "mean_inference_ms": 1.0353971722483282, "mean_action_processing_ms": 0.17177962233618668, "mean_env_wait_ms": 0.06775787879939309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037006139755249023, "StateBufferConnector_ms": 0.0024677515029907227, "ViewRequirementAgentConnector_ms": 0.07484555244445801}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.40396008441587, "num_env_steps_trained_throughput_per_sec": 505.40396008441587, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 8205.159, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8205.123, "sample_time_ms": 786.89, "learn_time_ms": 7406.0, "learn_throughput": 540.103, "synch_weights_time_ms": 11.632}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 168, "trial_id": "fa423_00000", "date": "2024-08-10_11-21-44", "timestamp": 1723303304, "time_this_iter_s": 7.919957160949707, "time_total_s": 1373.062887430191, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9853dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1373.062887430191, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 24.481818181818184, "ram_util_percent": 80.51818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6342061959877214, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3722675420619823, "policy_loss": -0.007147970954793944, "vf_loss": 3.379415514734056, "vf_explained_var": -0.2586634101060332, "kl": 0.016411900336877866, "entropy": 1.1748781269820279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.417366915568709, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.749378099540869, "policy_loss": -0.002827674343522328, "vf_loss": 5.752205779651801, "vf_explained_var": 0.17844288119425375, "kl": 0.009710283108056779, "entropy": 0.5260965100179116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 364.94, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36494, "policy_reward_min": {"agent_policy": -48.613615254498725, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 8.910654881430656, "adversary_policy": -4.455327440715328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 327, 400, 400, 171, 400, 153, 400, 400, 400, 400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400], "policy_agent_policy_reward": [-37.84366840284799, -11.417079264888365, 40.02542444918021, -14.954439041378071, 67.61516427981647, 21.540899049609262, -20.17207306056231, 12.394588782702703, -1.0830318843069264, 42.8790576218032, 36.527749259918025, 39.189011770467935, 23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887, -4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025, -14.639542054839632, -12.452099293887255, 31.892947532553876, -12.743124389549337, -1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251], "policy_adversary_policy_reward": [9.294007155417855, 28.549661247430112, 1.2184587016167896, 10.198620563271575, -23.538811909881645, -16.486612539298566, 6.4900120347967984, 8.464427006581271, -43.9043403217553, -23.710823958061177, 2.0478697491905535, -23.588768798799816, 10.181185762542752, 9.99088729801956, -0.11461667243218798, -12.2799721102705, 28.51110025196364, -27.42806836765671, -24.03359361286347, -18.84546400893973, -9.377886977628336, -27.1498622822897, -20.903076340715092, -18.285935429752854, 9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291, -3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051, 13.985368464708204, 0.6541735901314283, -3.551953452441161, 16.004052746328405, -21.77691213348448, -10.116035399069398, -0.8777051246691094, 13.620829514218446, 12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39880273171737257, "mean_inference_ms": 1.035124110312782, "mean_action_processing_ms": 0.171759536463845, "mean_env_wait_ms": 0.06771819720659543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032993555068969727, "StateBufferConnector_ms": 0.002461552619934082, "ViewRequirementAgentConnector_ms": 0.07445955276489258}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.17828700891323, "num_env_steps_trained_throughput_per_sec": 499.17828700891323, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2028000, "timers": {"training_iteration_time_ms": 8180.81, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8180.774, "sample_time_ms": 789.463, "learn_time_ms": 7378.956, "learn_throughput": 542.082, "synch_weights_time_ms": 11.75}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "done": false, "training_iteration": 169, "trial_id": "fa423_00000", "date": "2024-08-10_11-21-52", "timestamp": 1723303312, "time_this_iter_s": 8.018054246902466, "time_total_s": 1381.0809416770935, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9912430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1381.0809416770935, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 23.825, "ram_util_percent": 80.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.110057315687654, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.796673129349158, "policy_loss": -0.008795519402772976, "vf_loss": 4.805468633439806, "vf_explained_var": 0.09327198039917718, "kl": 0.01583094379098538, "entropy": 1.298378129737087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4196953505898517, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.948272291322549, "policy_loss": -0.004881490639915379, "vf_loss": 5.953153773148855, "vf_explained_var": 0.20994310658425092, "kl": 0.008023524591042476, "entropy": 0.5959794105341037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 370.43, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37043, "policy_reward_min": {"agent_policy": -48.613615254498725, "adversary_policy": -50.37066091186136}, "policy_reward_max": {"agent_policy": 86.95935109588314, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 7.67648845041061, "adversary_policy": -3.838244225205305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 236, 132, 400, 400, 400, 400, 400, 400, 400, 166, 400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [23.444898925593012, 0.14552224764945376, -10.323893104220215, 19.497228201334476, 28.12884319129708, 20.888874305998478, 86.95935109588314, 0.240563492268679, 27.570552952676586, 32.1028489287162, 1.723258203329184, 31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887, -4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025, -14.639542054839632, -12.452099293887255, 31.892947532553876, -12.743124389549337, -1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251, 1.640439987709108, 12.2404799726352, -0.6232962858029971, -9.746011956290705, 7.2805752268061426, -5.997946828651145, 17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112], "policy_adversary_policy_reward": [9.056235587986578, -32.501134513579586, -22.455410463009688, 22.309888215360232, -3.511006759412872, 13.834899863633087, -8.97270632771506, -10.524521873619413, -27.391605022510007, -0.7372381687870693, 3.297036985011232, -24.185911291009706, -50.37066091186136, -36.58869018402177, 14.869565229983671, -15.11012872225235, -26.626926033982258, -0.9436269186943278, -17.803617088680753, -14.299231840035437, 29.931784183968364, -31.65504238729755, -28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291, -3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051, 13.985368464708204, 0.6541735901314283, -3.551953452441161, 16.004052746328405, -21.77691213348448, -10.116035399069398, -0.8777051246691094, 13.620829514218446, 12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277, 10.136738083529025, -11.777178071238136, -14.899304033627658, 2.6588240609924583, -3.2785870652456666, 3.9018833510486637, -14.370390550139899, 24.116402506430607, -12.443979010568228, 5.163403783762085, -6.1749206048145595, 12.172867433465704, -16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3988314899447336, "mean_inference_ms": 1.0349875741284533, "mean_action_processing_ms": 0.17169839024434005, "mean_env_wait_ms": 0.06772837506322545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033043622970581055, "StateBufferConnector_ms": 0.0024427175521850586, "ViewRequirementAgentConnector_ms": 0.06953418254852295}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.2199273934061, "num_env_steps_trained_throughput_per_sec": 486.2199273934061, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 8180.56, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8180.527, "sample_time_ms": 789.296, "learn_time_ms": 7378.982, "learn_throughput": 542.08, "synch_weights_time_ms": 11.671}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 170, "trial_id": "fa423_00000", "date": "2024-08-10_11-22-01", "timestamp": 1723303321, "time_this_iter_s": 8.232269048690796, "time_total_s": 1389.3132107257843, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99124c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1389.3132107257843, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 25.25833333333333, "ram_util_percent": 80.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5874093484626246, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.2892973019332485, "policy_loss": -0.006507730416500221, "vf_loss": 5.295805023713086, "vf_explained_var": -0.31866889372073787, "kl": 0.01090730040409586, "entropy": 1.2780250426322695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2296239150688053, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.569025377432506, "policy_loss": -0.004171829056091762, "vf_loss": 6.573197209338347, "vf_explained_var": 0.3962271776050329, "kl": 0.01033716828233148, "entropy": 0.6649916978552938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 370.01, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37001, "policy_reward_min": {"agent_policy": -48.613615254498725, "adversary_policy": -43.51794036830306}, "policy_reward_max": {"agent_policy": 84.03893196994267, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 6.64680769350324, "adversary_policy": -3.323403846751621}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 154, 400, 257, 196, 400, 400, 400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 68, 400, 400], "policy_agent_policy_reward": [31.58555397505043, -23.9896166455255, 51.21757605057321, -3.635319845353207, 15.886926593124244, -5.852018026549386, -12.965083635549831, 9.36695827041764, 45.54493717624379, 20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887, -4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025, -14.639542054839632, -12.452099293887255, 31.892947532553876, -12.743124389549337, -1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251, 1.640439987709108, 12.2404799726352, -0.6232962858029971, -9.746011956290705, 7.2805752268061426, -5.997946828651145, 17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112, 49.88466662837703, -14.825358768676235, -11.251810588510716, -31.711374179971415, -28.56847928856681, 77.25536510212925, 44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073], "policy_adversary_policy_reward": [-28.137782517429844, -3.44777145762059, 33.722718327822676, -9.733101682297168, -21.60437095540238, -29.61320509517083, 30.801018987674354, -27.16569914232114, -19.047164867081996, 3.160238273957752, 21.675892334933042, -15.823874308383658, 16.89612694189791, -3.93104330634808, -19.348124781861756, 9.981166511444115, -20.388208092020083, -25.15672908422371, -6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291, -3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051, 13.985368464708204, 0.6541735901314283, -3.551953452441161, 16.004052746328405, -21.77691213348448, -10.116035399069398, -0.8777051246691094, 13.620829514218446, 12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277, 10.136738083529025, -11.777178071238136, -14.899304033627658, 2.6588240609924583, -3.2785870652456666, 3.9018833510486637, -14.370390550139899, 24.116402506430607, -12.443979010568228, 5.163403783762085, -6.1749206048145595, 12.172867433465704, -16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437, -16.329407252046522, -33.55525937633052, 8.797296785806385, 6.028061982869829, -1.1787630292552134, 12.43057361776593, 19.070589270162483, 12.640784909808929, 24.425311290991406, 4.143167997575407, -33.737424733826316, -43.51794036830306, -6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39862562583110994, "mean_inference_ms": 1.0348163377057022, "mean_action_processing_ms": 0.17170620390389996, "mean_env_wait_ms": 0.06769011749765806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003360152244567871, "StateBufferConnector_ms": 0.0024684667587280273, "ViewRequirementAgentConnector_ms": 0.07094764709472656}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.9322045571843, "num_env_steps_trained_throughput_per_sec": 465.9322045571843, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2052000, "timers": {"training_iteration_time_ms": 8222.986, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8222.953, "sample_time_ms": 787.127, "learn_time_ms": 7423.52, "learn_throughput": 538.828, "synch_weights_time_ms": 11.774}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "done": false, "training_iteration": 171, "trial_id": "fa423_00000", "date": "2024-08-10_11-22-10", "timestamp": 1723303330, "time_this_iter_s": 8.589702844619751, "time_total_s": 1397.902913570404, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9912af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1397.902913570404, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 31.266666666666662, "ram_util_percent": 81.04166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.053882048306642, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.358901076468211, "policy_loss": -0.0056896134474309825, "vf_loss": 4.364590698953659, "vf_explained_var": 0.005961169010747678, "kl": 0.014547322021735127, "entropy": 1.2697615051395679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.37144492007792, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.206549363831679, "policy_loss": -0.010291412379107594, "vf_loss": 6.216840787231922, "vf_explained_var": 0.3364622057105104, "kl": 0.010544091256465944, "entropy": 0.7082517379894853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 372.97, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37297, "policy_reward_min": {"agent_policy": -70.7449629487593, "adversary_policy": -50.06536961021692}, "policy_reward_max": {"agent_policy": 84.03893196994267, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 5.508613376489836, "adversary_policy": -2.7543066882449185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 133, 400, 400, 400, 400, 137, 59, 400, 400, 400, 263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 68, 400, 400, 400, 400, 400, 400, 103, 400, 400, 400, 400], "policy_agent_policy_reward": [20.778638852259753, 57.993379215889966, 4.880651191628832, -24.16747295319438, -37.89709405492712, 9.473196106237292, 55.803321132444886, 25.30611743867875, 0.40934565768171893, -13.520748510850389, 32.78700731384551, 15.795800194485814, 33.9324877267494, -0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887, -4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025, -14.639542054839632, -12.452099293887255, 31.892947532553876, -12.743124389549337, -1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251, 1.640439987709108, 12.2404799726352, -0.6232962858029971, -9.746011956290705, 7.2805752268061426, -5.997946828651145, 17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112, 49.88466662837703, -14.825358768676235, -11.251810588510716, -31.711374179971415, -28.56847928856681, 77.25536510212925, 44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073, -70.7449629487593, -18.030057713568823, -24.66497275247951, 68.52675553943625, -56.256726331234496, -0.07107834334283503, 39.46492048399469, -22.4480174051559, 77.56462168220098], "policy_adversary_policy_reward": [-6.288176108134422, -14.490462744125331, -25.485836274531636, -32.50754294135833, 9.359627221124732, -14.240278412753565, 15.494012204592492, 8.673460748601887, 5.613035681452217, 32.2840583734749, 15.473828466281184, -24.947024572518476, -27.25415462253588, -28.549166509909007, 1.9408166430285156, -27.246934081707266, -13.213347183247375, 12.804001525565658, 28.65130271298525, -15.13055420213486, -8.745393022974266, -24.04161429087125, -7.201303096827928, -8.594497097657886, -14.913505172716338, -19.01898255403305, 17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291, -3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051, 13.985368464708204, 0.6541735901314283, -3.551953452441161, 16.004052746328405, -21.77691213348448, -10.116035399069398, -0.8777051246691094, 13.620829514218446, 12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277, 10.136738083529025, -11.777178071238136, -14.899304033627658, 2.6588240609924583, -3.2785870652456666, 3.9018833510486637, -14.370390550139899, 24.116402506430607, -12.443979010568228, 5.163403783762085, -6.1749206048145595, 12.172867433465704, -16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437, -16.329407252046522, -33.55525937633052, 8.797296785806385, 6.028061982869829, -1.1787630292552134, 12.43057361776593, 19.070589270162483, 12.640784909808929, 24.425311290991406, 4.143167997575407, -33.737424733826316, -43.51794036830306, -6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335, 35.44316549917062, 35.30179744958877, -14.547695487196533, 32.57775320076537, 21.692395268251445, 2.9725774842280615, -31.137605160143757, -37.389150379292545, 22.43980224085405, 33.81692409038047, 6.930952511053004, -6.859874167710167, -14.479803924063205, -24.985116559931484, 15.247954929028229, 7.20006247612767, -50.06536961021692, -27.499252071984138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39852216632581927, "mean_inference_ms": 1.0344334465827947, "mean_action_processing_ms": 0.17171569745221596, "mean_env_wait_ms": 0.06766914154286977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003339409828186035, "StateBufferConnector_ms": 0.0024830102920532227, "ViewRequirementAgentConnector_ms": 0.07173645496368408}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.7566472283793, "num_env_steps_trained_throughput_per_sec": 498.7566472283793, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 8219.997, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8219.964, "sample_time_ms": 795.541, "learn_time_ms": 7412.368, "learn_throughput": 539.639, "synch_weights_time_ms": 11.514}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 172, "trial_id": "fa423_00000", "date": "2024-08-10_11-22-18", "timestamp": 1723303338, "time_this_iter_s": 8.023739099502563, "time_total_s": 1405.9266526699066, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9912b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1405.9266526699066, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 30.38333333333333, "ram_util_percent": 82.78333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.773111469026596, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.460214174866046, "policy_loss": -0.010942135384138772, "vf_loss": 4.4711563063677024, "vf_explained_var": -0.30684682499794735, "kl": 0.01948535928962397, "entropy": 1.3065410863785516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4293844933311144, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.933474177618821, "policy_loss": -0.004383731247313941, "vf_loss": 5.937857928375403, "vf_explained_var": -0.26358273352185885, "kl": 0.016394557919683212, "entropy": 0.8162563877180219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 377.98, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 37798, "policy_reward_min": {"agent_policy": -70.7449629487593, "adversary_policy": -50.06536961021692}, "policy_reward_max": {"agent_policy": 84.03893196994267, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 2.8200128220287515, "adversary_policy": -1.4100064110143762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [263, 400, 400, 153, 322, 400, 400, 400, 394, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 68, 400, 400, 400, 400, 400, 400, 103, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-0.46022286290157677, 37.049820492493325, -40.58090840413981, 17.48868340626841, -24.308595902993453, 55.251323909180606, -36.7902364975041, 50.96682746268451, -44.79438205132178, 9.16426172503847, 51.58276381111207, 52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887, -4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025, -14.639542054839632, -12.452099293887255, 31.892947532553876, -12.743124389549337, -1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251, 1.640439987709108, 12.2404799726352, -0.6232962858029971, -9.746011956290705, 7.2805752268061426, -5.997946828651145, 17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112, 49.88466662837703, -14.825358768676235, -11.251810588510716, -31.711374179971415, -28.56847928856681, 77.25536510212925, 44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073, -70.7449629487593, -18.030057713568823, -24.66497275247951, 68.52675553943625, -56.256726331234496, -0.07107834334283503, 39.46492048399469, -22.4480174051559, 77.56462168220098, -24.84419256075955, -27.621233466895035, 9.12406218558969, 5.038648963189537, 14.60891608822282, -26.51944259771039, 34.337782905425364, -20.387923150722923, 39.83302951237165, -25.464640743607923, -12.286893577895022, -37.09591257251077, -16.007627119875913], "policy_adversary_policy_reward": [17.873080557384572, -17.41285769448299, -20.215813122741242, -16.834007369752086, 39.44526766638343, 1.1356407377563826, 18.590174970371994, -36.0788583766404, 21.952544690431857, 2.3560512125615958, -25.008531000324474, -30.24279290885613, 5.738185545876277, 31.05205095162781, -31.805707634099736, -19.161119828584773, 12.156122765645659, 32.63825928567618, -21.589955895542914, 12.425694170504448, -40.16337688819485, -11.419386922917234, -25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291, -3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051, 13.985368464708204, 0.6541735901314283, -3.551953452441161, 16.004052746328405, -21.77691213348448, -10.116035399069398, -0.8777051246691094, 13.620829514218446, 12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277, 10.136738083529025, -11.777178071238136, -14.899304033627658, 2.6588240609924583, -3.2785870652456666, 3.9018833510486637, -14.370390550139899, 24.116402506430607, -12.443979010568228, 5.163403783762085, -6.1749206048145595, 12.172867433465704, -16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437, -16.329407252046522, -33.55525937633052, 8.797296785806385, 6.028061982869829, -1.1787630292552134, 12.43057361776593, 19.070589270162483, 12.640784909808929, 24.425311290991406, 4.143167997575407, -33.737424733826316, -43.51794036830306, -6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335, 35.44316549917062, 35.30179744958877, -14.547695487196533, 32.57775320076537, 21.692395268251445, 2.9725774842280615, -31.137605160143757, -37.389150379292545, 22.43980224085405, 33.81692409038047, 6.930952511053004, -6.859874167710167, -14.479803924063205, -24.985116559931484, 15.247954929028229, 7.20006247612767, -50.06536961021692, -27.499252071984138, 6.98674631248916, 17.85744624827039, 16.495894160362553, 11.125339306532538, -11.617614867771117, 2.4935526821814307, -2.045565964132706, -2.9930829990568313, -7.848787500216645, -6.7601285880061734, 6.161790044105808, 20.357652553604584, -14.319346071723537, -20.018436833701827, 11.840859963325897, 8.547063187397034, -13.74487927656525, -26.0881502358064, 12.50232957635783, 12.962311167250093, 1.6335544984994437, 10.653339079395572, 20.81823702411991, 16.277675548390878, 6.524590340333447, 9.483036779542468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3984294796125857, "mean_inference_ms": 1.0343112676186867, "mean_action_processing_ms": 0.17164757519626977, "mean_env_wait_ms": 0.06765925573673898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003382444381713867, "StateBufferConnector_ms": 0.0025168657302856445, "ViewRequirementAgentConnector_ms": 0.0717165470123291}, "num_episodes": 13, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.55043388428544, "num_env_steps_trained_throughput_per_sec": 491.55043388428544, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2076000, "timers": {"training_iteration_time_ms": 8213.209, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8213.176, "sample_time_ms": 797.577, "learn_time_ms": 7403.531, "learn_throughput": 540.283, "synch_weights_time_ms": 11.53}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "done": false, "training_iteration": 173, "trial_id": "fa423_00000", "date": "2024-08-10_11-22-26", "timestamp": 1723303346, "time_this_iter_s": 8.144904851913452, "time_total_s": 1414.07155752182, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9853a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1414.07155752182, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 26.09166666666667, "ram_util_percent": 82.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.140872551019861, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.716712681326286, "policy_loss": -0.008685162983016756, "vf_loss": 4.725397833566817, "vf_explained_var": -0.03682585147322801, "kl": 0.012715239653864532, "entropy": 1.2334768487662866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7425594387575982, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.168741399049759, "policy_loss": -0.0041785935653024355, "vf_loss": 7.17292001148065, "vf_explained_var": 0.27566327104965843, "kl": 0.007768167865289873, "entropy": 0.6680819788947702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 378.79, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37879, "policy_reward_min": {"agent_policy": -70.7449629487593, "adversary_policy": -50.06536961021692}, "policy_reward_max": {"agent_policy": 84.03893196994267, "adversary_policy": 45.11386106676825}, "policy_reward_mean": {"agent_policy": 1.6599275145626964, "adversary_policy": -0.8299637572813486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 68, 400, 400, 400, 400, 400, 400, 103, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400], "policy_agent_policy_reward": [52.44121259201302, 84.03893196994267, -41.864231406888116, -26.172095481848572, -32.314981679280834, 15.10322444765707, 10.009212547107811, 13.600941726147976, -7.692421591220361, -48.613615254498725, 12.69957879086494, 12.553058472905345, 34.23095010052069, 8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887, -4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025, -14.639542054839632, -12.452099293887255, 31.892947532553876, -12.743124389549337, -1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251, 1.640439987709108, 12.2404799726352, -0.6232962858029971, -9.746011956290705, 7.2805752268061426, -5.997946828651145, 17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112, 49.88466662837703, -14.825358768676235, -11.251810588510716, -31.711374179971415, -28.56847928856681, 77.25536510212925, 44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073, -70.7449629487593, -18.030057713568823, -24.66497275247951, 68.52675553943625, -56.256726331234496, -0.07107834334283503, 39.46492048399469, -22.4480174051559, 77.56462168220098, -24.84419256075955, -27.621233466895035, 9.12406218558969, 5.038648963189537, 14.60891608822282, -26.51944259771039, 34.337782905425364, -20.387923150722923, 39.83302951237165, -25.464640743607923, -12.286893577895022, -37.09591257251077, -16.007627119875913, -9.005638241968612, -32.448016230777, 46.64473957589023, -23.014869963965822, 5.013349675487872, -14.518154207287726, 8.96632253295251, -3.316875934939276, -33.976769913788644, -27.929404180518954, 42.14612123022658], "policy_adversary_policy_reward": [-25.33448395984389, -27.106728632169137, -42.79440084060161, -41.24453112934106, -3.249629659880128, 45.11386106676825, -12.052677515967442, 38.22477299781601, 37.26568545775259, -4.950703778471755, -13.222329632334116, -1.8808948153229608, -7.146112304776434, -2.8631002423313774, -20.670276485735773, 7.0693347595878056, 6.657406025682819, 1.0350155655375417, 25.00076773065632, 23.612847523842415, -15.19527489690449, 2.4956961060395493, -12.995498663413493, 0.4424401905081474, -22.57338944069002, -11.657560659830667, -5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291, -3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051, 13.985368464708204, 0.6541735901314283, -3.551953452441161, 16.004052746328405, -21.77691213348448, -10.116035399069398, -0.8777051246691094, 13.620829514218446, 12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277, 10.136738083529025, -11.777178071238136, -14.899304033627658, 2.6588240609924583, -3.2785870652456666, 3.9018833510486637, -14.370390550139899, 24.116402506430607, -12.443979010568228, 5.163403783762085, -6.1749206048145595, 12.172867433465704, -16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437, -16.329407252046522, -33.55525937633052, 8.797296785806385, 6.028061982869829, -1.1787630292552134, 12.43057361776593, 19.070589270162483, 12.640784909808929, 24.425311290991406, 4.143167997575407, -33.737424733826316, -43.51794036830306, -6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335, 35.44316549917062, 35.30179744958877, -14.547695487196533, 32.57775320076537, 21.692395268251445, 2.9725774842280615, -31.137605160143757, -37.389150379292545, 22.43980224085405, 33.81692409038047, 6.930952511053004, -6.859874167710167, -14.479803924063205, -24.985116559931484, 15.247954929028229, 7.20006247612767, -50.06536961021692, -27.499252071984138, 6.98674631248916, 17.85744624827039, 16.495894160362553, 11.125339306532538, -11.617614867771117, 2.4935526821814307, -2.045565964132706, -2.9930829990568313, -7.848787500216645, -6.7601285880061734, 6.161790044105808, 20.357652553604584, -14.319346071723537, -20.018436833701827, 11.840859963325897, 8.547063187397034, -13.74487927656525, -26.0881502358064, 12.50232957635783, 12.962311167250093, 1.6335544984994437, 10.653339079395572, 20.81823702411991, 16.277675548390878, 6.524590340333447, 9.483036779542468, 5.01924623649227, 3.986392005476336, 39.987177458376436, -7.539161227599404, -23.229436367177847, -23.41530320871238, 25.719464362384905, -2.7045943984190837, -9.114366942871872, 4.101017267383984, 5.219858714176576, 9.298295493111151, -12.24893402021275, 3.282611487260235, 2.460587430733156, 0.8562885042061197, 22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3983214668862453, "mean_inference_ms": 1.034069638996869, "mean_action_processing_ms": 0.17167793097679898, "mean_env_wait_ms": 0.0676300646192239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003432750701904297, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.0710524320602417}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.37563177616835, "num_env_steps_trained_throughput_per_sec": 487.37563177616835, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2088000, "timers": {"training_iteration_time_ms": 8183.505, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8183.472, "sample_time_ms": 792.053, "learn_time_ms": 7379.439, "learn_throughput": 542.047, "synch_weights_time_ms": 11.444}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "done": false, "training_iteration": 174, "trial_id": "fa423_00000", "date": "2024-08-10_11-22-35", "timestamp": 1723303355, "time_this_iter_s": 8.212764978408813, "time_total_s": 1422.2843225002289, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9912ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1422.2843225002289, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 27.308333333333334, "ram_util_percent": 82.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8555117942038035, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.169918322941614, "policy_loss": -0.0077747025870762414, "vf_loss": 4.177693013917832, "vf_explained_var": 0.18195581877673114, "kl": 0.018858996601300998, "entropy": 1.250114137218112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.82091034433494, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6796353926261265, "policy_loss": -0.004441428929567337, "vf_loss": 6.684076834718386, "vf_explained_var": 0.39880023257186015, "kl": 0.010791939331788089, "entropy": 0.5254850913460056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 371.53, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 37153, "policy_reward_min": {"agent_policy": -71.05601964296062, "adversary_policy": -55.57900892893407}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 48.56803798896113}, "policy_reward_mean": {"agent_policy": -2.028794051395309, "adversary_policy": 1.0143970256976536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 68, 400, 400, 400, 400, 400, 400, 103, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 241, 348, 400, 400, 400, 400, 159, 400, 126], "policy_agent_policy_reward": [8.211944283182774, 2.5308290009183168, -29.832206319343015, 9.233740338395743, 24.84538107077846, 20.90056514108502, -0.7690163678706678, 7.709996091913247, 7.115345583193037, 23.376894564155204, 5.79963563937887, -4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025, -14.639542054839632, -12.452099293887255, 31.892947532553876, -12.743124389549337, -1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251, 1.640439987709108, 12.2404799726352, -0.6232962858029971, -9.746011956290705, 7.2805752268061426, -5.997946828651145, 17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112, 49.88466662837703, -14.825358768676235, -11.251810588510716, -31.711374179971415, -28.56847928856681, 77.25536510212925, 44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073, -70.7449629487593, -18.030057713568823, -24.66497275247951, 68.52675553943625, -56.256726331234496, -0.07107834334283503, 39.46492048399469, -22.4480174051559, 77.56462168220098, -24.84419256075955, -27.621233466895035, 9.12406218558969, 5.038648963189537, 14.60891608822282, -26.51944259771039, 34.337782905425364, -20.387923150722923, 39.83302951237165, -25.464640743607923, -12.286893577895022, -37.09591257251077, -16.007627119875913, -9.005638241968612, -32.448016230777, 46.64473957589023, -23.014869963965822, 5.013349675487872, -14.518154207287726, 8.96632253295251, -3.316875934939276, -33.976769913788644, -27.929404180518954, 42.14612123022658, 30.238528495456904, -25.347226054516362, -49.25809531644089, -8.353155217406897, -71.05601964296062, -44.67516026922206, -61.7560989114495, -26.774663145887786, -41.604651078266286, -50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611], "policy_adversary_policy_reward": [-5.017088231709025, -3.1948560514737494, -7.001758201554438, 4.470929200636121, 10.622427343260743, 19.209778976082276, -16.448912640431786, 7.215172302036045, -14.858863003658648, -9.98651806711981, -7.031369837103259, -13.869195303981762, 1.5451382114112207, -0.7761218435405475, -2.9939252324507706, -4.7160708594624765, -1.4310673864561245, -5.684278196736912, -11.735535228296328, -11.641359335858885, -5.476528521088241, -0.3231071182906291, -3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051, 13.985368464708204, 0.6541735901314283, -3.551953452441161, 16.004052746328405, -21.77691213348448, -10.116035399069398, -0.8777051246691094, 13.620829514218446, 12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277, 10.136738083529025, -11.777178071238136, -14.899304033627658, 2.6588240609924583, -3.2785870652456666, 3.9018833510486637, -14.370390550139899, 24.116402506430607, -12.443979010568228, 5.163403783762085, -6.1749206048145595, 12.172867433465704, -16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437, -16.329407252046522, -33.55525937633052, 8.797296785806385, 6.028061982869829, -1.1787630292552134, 12.43057361776593, 19.070589270162483, 12.640784909808929, 24.425311290991406, 4.143167997575407, -33.737424733826316, -43.51794036830306, -6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335, 35.44316549917062, 35.30179744958877, -14.547695487196533, 32.57775320076537, 21.692395268251445, 2.9725774842280615, -31.137605160143757, -37.389150379292545, 22.43980224085405, 33.81692409038047, 6.930952511053004, -6.859874167710167, -14.479803924063205, -24.985116559931484, 15.247954929028229, 7.20006247612767, -50.06536961021692, -27.499252071984138, 6.98674631248916, 17.85744624827039, 16.495894160362553, 11.125339306532538, -11.617614867771117, 2.4935526821814307, -2.045565964132706, -2.9930829990568313, -7.848787500216645, -6.7601285880061734, 6.161790044105808, 20.357652553604584, -14.319346071723537, -20.018436833701827, 11.840859963325897, 8.547063187397034, -13.74487927656525, -26.0881502358064, 12.50232957635783, 12.962311167250093, 1.6335544984994437, 10.653339079395572, 20.81823702411991, 16.277675548390878, 6.524590340333447, 9.483036779542468, 5.01924623649227, 3.986392005476336, 39.987177458376436, -7.539161227599404, -23.229436367177847, -23.41530320871238, 25.719464362384905, -2.7045943984190837, -9.114366942871872, 4.101017267383984, 5.219858714176576, 9.298295493111151, -12.24893402021275, 3.282611487260235, 2.460587430733156, 0.8562885042061197, 22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458, -17.24351672729788, -12.995011768159024, 0.7411799006588264, 24.606046153857537, 15.426118343786092, 33.83197697265479, -0.7729235739845777, 9.126078791391468, 48.56803798896113, 22.487981653999512, 19.087948555854982, 25.587211713367083, 36.858784845294366, 24.897314066155086, 19.539793742446385, 7.234869403441415, 25.37313760699768, 16.231513471268602, 26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3982495727173339, "mean_inference_ms": 1.0340179900632847, "mean_action_processing_ms": 0.1716824181147893, "mean_env_wait_ms": 0.06766146062818922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034683942794799805, "StateBufferConnector_ms": 0.0025626420974731445, "ViewRequirementAgentConnector_ms": 0.07081007957458496}, "num_episodes": 13, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.6057000450533, "num_env_steps_trained_throughput_per_sec": 502.6057000450533, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2100000, "timers": {"training_iteration_time_ms": 8188.498, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8188.464, "sample_time_ms": 798.3, "learn_time_ms": 7378.152, "learn_throughput": 542.141, "synch_weights_time_ms": 11.45}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "done": false, "training_iteration": 175, "trial_id": "fa423_00000", "date": "2024-08-10_11-22-43", "timestamp": 1723303363, "time_this_iter_s": 7.965042352676392, "time_total_s": 1430.2493648529053, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99d8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1430.2493648529053, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 26.754545454545454, "ram_util_percent": 82.48181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6288097860951902, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.789747649651987, "policy_loss": -0.007482071000979178, "vf_loss": 4.797229722946409, "vf_explained_var": -0.37766129551110444, "kl": 0.01747812096093099, "entropy": 1.2373749258026243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.643710525209705, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.800634956856569, "policy_loss": -0.002551784093520837, "vf_loss": 6.803186734517415, "vf_explained_var": 0.41996394967039424, "kl": 0.006664627197113193, "entropy": 0.4579723806741337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 366.46, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36646, "policy_reward_min": {"agent_policy": -76.64861166088359, "adversary_policy": -55.57900892893407}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 48.66421837645345}, "policy_reward_mean": {"agent_policy": -1.731814939791007, "adversary_policy": 0.8659074698955022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 68, 400, 400, 400, 400, 400, 400, 103, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 241, 348, 400, 400, 400, 400, 159, 400, 126, 400, 350, 400, 400, 400, 400, 400, 237, 400, 106, 400], "policy_agent_policy_reward": [-4.660615959853871, -7.009886783656359, -27.444098623130113, 1.7217463710592469, 43.021875066020975, 0.6431276644354611, -36.23188853876651, 7.440913208027837, 2.5489794439182365, -3.1387984601111025, -14.639542054839632, -12.452099293887255, 31.892947532553876, -12.743124389549337, -1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251, 1.640439987709108, 12.2404799726352, -0.6232962858029971, -9.746011956290705, 7.2805752268061426, -5.997946828651145, 17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112, 49.88466662837703, -14.825358768676235, -11.251810588510716, -31.711374179971415, -28.56847928856681, 77.25536510212925, 44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073, -70.7449629487593, -18.030057713568823, -24.66497275247951, 68.52675553943625, -56.256726331234496, -0.07107834334283503, 39.46492048399469, -22.4480174051559, 77.56462168220098, -24.84419256075955, -27.621233466895035, 9.12406218558969, 5.038648963189537, 14.60891608822282, -26.51944259771039, 34.337782905425364, -20.387923150722923, 39.83302951237165, -25.464640743607923, -12.286893577895022, -37.09591257251077, -16.007627119875913, -9.005638241968612, -32.448016230777, 46.64473957589023, -23.014869963965822, 5.013349675487872, -14.518154207287726, 8.96632253295251, -3.316875934939276, -33.976769913788644, -27.929404180518954, 42.14612123022658, 30.238528495456904, -25.347226054516362, -49.25809531644089, -8.353155217406897, -71.05601964296062, -44.67516026922206, -61.7560989114495, -26.774663145887786, -41.604651078266286, -50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611, -51.00056453924577, -76.64861166088359, -39.16086804626555, 68.0842395106296, 69.36095493082533, 55.96477252730694, 74.44002826827102, -67.88650830107188, 28.041462074330006, -28.09625953141957, 75.72237495374064], "policy_adversary_policy_reward": [-3.813557484634245, 8.474173444488116, 1.791640495841115, 5.218246287815244, 27.80304142046184, -0.3589427973317285, -3.5215695500781052, 1.7998231790188584, -18.315396977577606, -24.70647808844337, 7.612800601220794, -8.255928265656255, 7.014270512815703, 29.2176180259508, -9.658795765941633, 2.217882557913793, 5.338805732042214, -7.8877851759604525, 19.563069200181616, -16.42427074007051, 13.985368464708204, 0.6541735901314283, -3.551953452441161, 16.004052746328405, -21.77691213348448, -10.116035399069398, -0.8777051246691094, 13.620829514218446, 12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277, 10.136738083529025, -11.777178071238136, -14.899304033627658, 2.6588240609924583, -3.2785870652456666, 3.9018833510486637, -14.370390550139899, 24.116402506430607, -12.443979010568228, 5.163403783762085, -6.1749206048145595, 12.172867433465704, -16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437, -16.329407252046522, -33.55525937633052, 8.797296785806385, 6.028061982869829, -1.1787630292552134, 12.43057361776593, 19.070589270162483, 12.640784909808929, 24.425311290991406, 4.143167997575407, -33.737424733826316, -43.51794036830306, -6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335, 35.44316549917062, 35.30179744958877, -14.547695487196533, 32.57775320076537, 21.692395268251445, 2.9725774842280615, -31.137605160143757, -37.389150379292545, 22.43980224085405, 33.81692409038047, 6.930952511053004, -6.859874167710167, -14.479803924063205, -24.985116559931484, 15.247954929028229, 7.20006247612767, -50.06536961021692, -27.499252071984138, 6.98674631248916, 17.85744624827039, 16.495894160362553, 11.125339306532538, -11.617614867771117, 2.4935526821814307, -2.045565964132706, -2.9930829990568313, -7.848787500216645, -6.7601285880061734, 6.161790044105808, 20.357652553604584, -14.319346071723537, -20.018436833701827, 11.840859963325897, 8.547063187397034, -13.74487927656525, -26.0881502358064, 12.50232957635783, 12.962311167250093, 1.6335544984994437, 10.653339079395572, 20.81823702411991, 16.277675548390878, 6.524590340333447, 9.483036779542468, 5.01924623649227, 3.986392005476336, 39.987177458376436, -7.539161227599404, -23.229436367177847, -23.41530320871238, 25.719464362384905, -2.7045943984190837, -9.114366942871872, 4.101017267383984, 5.219858714176576, 9.298295493111151, -12.24893402021275, 3.282611487260235, 2.460587430733156, 0.8562885042061197, 22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458, -17.24351672729788, -12.995011768159024, 0.7411799006588264, 24.606046153857537, 15.426118343786092, 33.83197697265479, -0.7729235739845777, 9.126078791391468, 48.56803798896113, 22.487981653999512, 19.087948555854982, 25.587211713367083, 36.858784845294366, 24.897314066155086, 19.539793742446385, 7.234869403441415, 25.37313760699768, 16.231513471268602, 26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227, 17.179992661844423, 33.820571877401356, 48.66421837645345, 27.9843932844301, 26.237011377917355, 12.923856668348208, -28.1739271828011, -39.91031232782854, -32.113766487350425, -37.24718844347489, -30.10169688620379, -25.86307564110315, -53.96469615629432, -20.47533211197672, 44.27515391864114, 23.61135438243077, -7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39821601532525525, "mean_inference_ms": 1.0339268736358849, "mean_action_processing_ms": 0.17169419070042616, "mean_env_wait_ms": 0.06766683215974031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543376922607422, "StateBufferConnector_ms": 0.0025634765625, "ViewRequirementAgentConnector_ms": 0.07243132591247559}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.1307429354791, "num_env_steps_trained_throughput_per_sec": 505.1307429354791, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 8181.483, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8181.448, "sample_time_ms": 805.33, "learn_time_ms": 7364.01, "learn_throughput": 543.182, "synch_weights_time_ms": 11.469}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 176, "trial_id": "fa423_00000", "date": "2024-08-10_11-22-51", "timestamp": 1723303371, "time_this_iter_s": 7.926393032073975, "time_total_s": 1438.1757578849792, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99d85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1438.1757578849792, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 25.408333333333335, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.891288393262833, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.014998276776107, "policy_loss": -0.007335589952993566, "vf_loss": 5.022333854720706, "vf_explained_var": -0.651823742269839, "kl": 0.016870516834349415, "entropy": 1.199470608259635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.982458342487613, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.9148004730542505, "policy_loss": -0.0071937074535526335, "vf_loss": 6.921994169056416, "vf_explained_var": 0.5832151584948103, "kl": 0.009954499524849902, "entropy": 0.43308561950301133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 344.14, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 34414, "policy_reward_min": {"agent_policy": -76.64861166088359, "adversary_policy": -55.57900892893407}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 53.74333358992925}, "policy_reward_mean": {"agent_policy": -3.14482676146852, "adversary_policy": 1.572413380734259}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 68, 400, 400, 400, 400, 400, 400, 103, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 241, 348, 400, 400, 400, 400, 159, 400, 126, 400, 350, 400, 400, 400, 400, 400, 237, 400, 106, 400, 400, 177, 35, 280, 176, 262, 400, 110, 263, 337, 112, 225, 191, 400], "policy_agent_policy_reward": [-1.4915068399923896, 32.386512230782984, -46.38947957329746, 12.233518925126493, -15.021564527141795, 14.872068174838251, 1.640439987709108, 12.2404799726352, -0.6232962858029971, -9.746011956290705, 7.2805752268061426, -5.997946828651145, 17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112, 49.88466662837703, -14.825358768676235, -11.251810588510716, -31.711374179971415, -28.56847928856681, 77.25536510212925, 44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073, -70.7449629487593, -18.030057713568823, -24.66497275247951, 68.52675553943625, -56.256726331234496, -0.07107834334283503, 39.46492048399469, -22.4480174051559, 77.56462168220098, -24.84419256075955, -27.621233466895035, 9.12406218558969, 5.038648963189537, 14.60891608822282, -26.51944259771039, 34.337782905425364, -20.387923150722923, 39.83302951237165, -25.464640743607923, -12.286893577895022, -37.09591257251077, -16.007627119875913, -9.005638241968612, -32.448016230777, 46.64473957589023, -23.014869963965822, 5.013349675487872, -14.518154207287726, 8.96632253295251, -3.316875934939276, -33.976769913788644, -27.929404180518954, 42.14612123022658, 30.238528495456904, -25.347226054516362, -49.25809531644089, -8.353155217406897, -71.05601964296062, -44.67516026922206, -61.7560989114495, -26.774663145887786, -41.604651078266286, -50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611, -51.00056453924577, -76.64861166088359, -39.16086804626555, 68.0842395106296, 69.36095493082533, 55.96477252730694, 74.44002826827102, -67.88650830107188, 28.041462074330006, -28.09625953141957, 75.72237495374064, 79.18261777511478, -39.57677751250192, -13.623213445623293, -2.6479863945129267, -40.463287598567454, -69.39125849146346, 59.065884669974146, -35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922], "policy_adversary_policy_reward": [12.888681880595088, -11.397175040602693, -26.09535073492737, -6.291161495855619, 23.336630761935787, 23.052848811361677, -9.943821539689457, -2.2896973854370373, 15.864123092305185, -0.8425585651633902, -14.027865246612723, -0.8442029282255277, 10.136738083529025, -11.777178071238136, -14.899304033627658, 2.6588240609924583, -3.2785870652456666, 3.9018833510486637, -14.370390550139899, 24.116402506430607, -12.443979010568228, 5.163403783762085, -6.1749206048145595, 12.172867433465704, -16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437, -16.329407252046522, -33.55525937633052, 8.797296785806385, 6.028061982869829, -1.1787630292552134, 12.43057361776593, 19.070589270162483, 12.640784909808929, 24.425311290991406, 4.143167997575407, -33.737424733826316, -43.51794036830306, -6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335, 35.44316549917062, 35.30179744958877, -14.547695487196533, 32.57775320076537, 21.692395268251445, 2.9725774842280615, -31.137605160143757, -37.389150379292545, 22.43980224085405, 33.81692409038047, 6.930952511053004, -6.859874167710167, -14.479803924063205, -24.985116559931484, 15.247954929028229, 7.20006247612767, -50.06536961021692, -27.499252071984138, 6.98674631248916, 17.85744624827039, 16.495894160362553, 11.125339306532538, -11.617614867771117, 2.4935526821814307, -2.045565964132706, -2.9930829990568313, -7.848787500216645, -6.7601285880061734, 6.161790044105808, 20.357652553604584, -14.319346071723537, -20.018436833701827, 11.840859963325897, 8.547063187397034, -13.74487927656525, -26.0881502358064, 12.50232957635783, 12.962311167250093, 1.6335544984994437, 10.653339079395572, 20.81823702411991, 16.277675548390878, 6.524590340333447, 9.483036779542468, 5.01924623649227, 3.986392005476336, 39.987177458376436, -7.539161227599404, -23.229436367177847, -23.41530320871238, 25.719464362384905, -2.7045943984190837, -9.114366942871872, 4.101017267383984, 5.219858714176576, 9.298295493111151, -12.24893402021275, 3.282611487260235, 2.460587430733156, 0.8562885042061197, 22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458, -17.24351672729788, -12.995011768159024, 0.7411799006588264, 24.606046153857537, 15.426118343786092, 33.83197697265479, -0.7729235739845777, 9.126078791391468, 48.56803798896113, 22.487981653999512, 19.087948555854982, 25.587211713367083, 36.858784845294366, 24.897314066155086, 19.539793742446385, 7.234869403441415, 25.37313760699768, 16.231513471268602, 26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227, 17.179992661844423, 33.820571877401356, 48.66421837645345, 27.9843932844301, 26.237011377917355, 12.923856668348208, -28.1739271828011, -39.91031232782854, -32.113766487350425, -37.24718844347489, -30.10169688620379, -25.86307564110315, -53.96469615629432, -20.47533211197672, 44.27515391864114, 23.61135438243077, -7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292, -52.2406483943043, -26.9419693808104, 26.319002529805097, 13.257774982696834, 6.234767840606058, 7.388445605017237, -4.379078070016426, 7.027064464529339, 13.541095603912535, 26.92219199465491, 15.647924901534202, 53.74333358992925, -35.21873562076284, -23.8471490492113, 24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39830385596799567, "mean_inference_ms": 1.033643855462953, "mean_action_processing_ms": 0.1716547623474862, "mean_env_wait_ms": 0.06766326036717428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035893917083740234, "StateBufferConnector_ms": 0.002595067024230957, "ViewRequirementAgentConnector_ms": 0.06954383850097656}, "num_episodes": 14, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.37419567698197, "num_env_steps_trained_throughput_per_sec": 490.37419567698197, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2124000, "timers": {"training_iteration_time_ms": 8113.836, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8113.801, "sample_time_ms": 807.027, "learn_time_ms": 7294.457, "learn_throughput": 548.362, "synch_weights_time_ms": 11.701}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "done": false, "training_iteration": 177, "trial_id": "fa423_00000", "date": "2024-08-10_11-22-59", "timestamp": 1723303379, "time_this_iter_s": 8.162929058074951, "time_total_s": 1446.3386869430542, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99d8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1446.3386869430542, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 27.45, "ram_util_percent": 81.80833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3540335629982923, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.851184299635508, "policy_loss": -0.007043667963986832, "vf_loss": 4.858227973766428, "vf_explained_var": -0.8800992625731009, "kl": 0.019356041387115233, "entropy": 1.1785960087700496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0650740566353005, "cur_kl_coeff": 7.250141607073601e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.485128964483738, "policy_loss": -0.010741117340997638, "vf_loss": 6.4958700706561405, "vf_explained_var": 0.34049435580770177, "kl": 0.0414576036907737, "entropy": 0.461507107069095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 343.75, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34375, "policy_reward_min": {"agent_policy": -76.64861166088359, "adversary_policy": -55.57900892893407}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 53.74333358992925}, "policy_reward_mean": {"agent_policy": -1.5476789075938109, "adversary_policy": 0.7738394537969049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 68, 400, 400, 400, 400, 400, 400, 103, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 241, 348, 400, 400, 400, 400, 159, 400, 126, 400, 350, 400, 400, 400, 400, 400, 237, 400, 106, 400, 400, 177, 35, 280, 176, 262, 400, 110, 263, 337, 112, 225, 191, 400, 400, 400, 400, 400, 400, 149, 400, 400, 400, 253, 400, 400], "policy_agent_policy_reward": [17.162244784323555, 55.74817073089333, 26.198372747204374, -39.55013552069584, 18.820587305855558, -31.888519706477112, 49.88466662837703, -14.825358768676235, -11.251810588510716, -31.711374179971415, -28.56847928856681, 77.25536510212925, 44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073, -70.7449629487593, -18.030057713568823, -24.66497275247951, 68.52675553943625, -56.256726331234496, -0.07107834334283503, 39.46492048399469, -22.4480174051559, 77.56462168220098, -24.84419256075955, -27.621233466895035, 9.12406218558969, 5.038648963189537, 14.60891608822282, -26.51944259771039, 34.337782905425364, -20.387923150722923, 39.83302951237165, -25.464640743607923, -12.286893577895022, -37.09591257251077, -16.007627119875913, -9.005638241968612, -32.448016230777, 46.64473957589023, -23.014869963965822, 5.013349675487872, -14.518154207287726, 8.96632253295251, -3.316875934939276, -33.976769913788644, -27.929404180518954, 42.14612123022658, 30.238528495456904, -25.347226054516362, -49.25809531644089, -8.353155217406897, -71.05601964296062, -44.67516026922206, -61.7560989114495, -26.774663145887786, -41.604651078266286, -50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611, -51.00056453924577, -76.64861166088359, -39.16086804626555, 68.0842395106296, 69.36095493082533, 55.96477252730694, 74.44002826827102, -67.88650830107188, 28.041462074330006, -28.09625953141957, 75.72237495374064, 79.18261777511478, -39.57677751250192, -13.623213445623293, -2.6479863945129267, -40.463287598567454, -69.39125849146346, 59.065884669974146, -35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922, 48.58557524149581, 62.959254836301795, -58.679563308681914, -56.80912957504781, 78.01176380232415, -13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937], "policy_adversary_policy_reward": [-16.826712547865938, -0.33553223645761676, -37.144575200984995, -18.603595529908343, -12.058994012336438, -14.139378734867947, 22.278185310590207, 17.271950210105622, -12.996126353214603, -5.824460952640953, 31.014781168191668, 0.873738538285437, -16.329407252046522, -33.55525937633052, 8.797296785806385, 6.028061982869829, -1.1787630292552134, 12.43057361776593, 19.070589270162483, 12.640784909808929, 24.425311290991406, 4.143167997575407, -33.737424733826316, -43.51794036830306, -6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335, 35.44316549917062, 35.30179744958877, -14.547695487196533, 32.57775320076537, 21.692395268251445, 2.9725774842280615, -31.137605160143757, -37.389150379292545, 22.43980224085405, 33.81692409038047, 6.930952511053004, -6.859874167710167, -14.479803924063205, -24.985116559931484, 15.247954929028229, 7.20006247612767, -50.06536961021692, -27.499252071984138, 6.98674631248916, 17.85744624827039, 16.495894160362553, 11.125339306532538, -11.617614867771117, 2.4935526821814307, -2.045565964132706, -2.9930829990568313, -7.848787500216645, -6.7601285880061734, 6.161790044105808, 20.357652553604584, -14.319346071723537, -20.018436833701827, 11.840859963325897, 8.547063187397034, -13.74487927656525, -26.0881502358064, 12.50232957635783, 12.962311167250093, 1.6335544984994437, 10.653339079395572, 20.81823702411991, 16.277675548390878, 6.524590340333447, 9.483036779542468, 5.01924623649227, 3.986392005476336, 39.987177458376436, -7.539161227599404, -23.229436367177847, -23.41530320871238, 25.719464362384905, -2.7045943984190837, -9.114366942871872, 4.101017267383984, 5.219858714176576, 9.298295493111151, -12.24893402021275, 3.282611487260235, 2.460587430733156, 0.8562885042061197, 22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458, -17.24351672729788, -12.995011768159024, 0.7411799006588264, 24.606046153857537, 15.426118343786092, 33.83197697265479, -0.7729235739845777, 9.126078791391468, 48.56803798896113, 22.487981653999512, 19.087948555854982, 25.587211713367083, 36.858784845294366, 24.897314066155086, 19.539793742446385, 7.234869403441415, 25.37313760699768, 16.231513471268602, 26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227, 17.179992661844423, 33.820571877401356, 48.66421837645345, 27.9843932844301, 26.237011377917355, 12.923856668348208, -28.1739271828011, -39.91031232782854, -32.113766487350425, -37.24718844347489, -30.10169688620379, -25.86307564110315, -53.96469615629432, -20.47533211197672, 44.27515391864114, 23.61135438243077, -7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292, -52.2406483943043, -26.9419693808104, 26.319002529805097, 13.257774982696834, 6.234767840606058, 7.388445605017237, -4.379078070016426, 7.027064464529339, 13.541095603912535, 26.92219199465491, 15.647924901534202, 53.74333358992925, -35.21873562076284, -23.8471490492113, 24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489, -40.77771997654663, -7.807855264949183, -52.79112230514295, -10.168132531158847, 43.590447711285734, 15.089115597396157, 21.512970950678046, 35.2961586243698, -37.04959945419257, -40.96216434813163, 7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39824241953533146, "mean_inference_ms": 1.0337229171796904, "mean_action_processing_ms": 0.1716484411726849, "mean_env_wait_ms": 0.06770242825401099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699183464050293, "StateBufferConnector_ms": 0.0026454925537109375, "ViewRequirementAgentConnector_ms": 0.07259440422058105}, "num_episodes": 12, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.1078301758076, "num_env_steps_trained_throughput_per_sec": 486.1078301758076, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2136000, "timers": {"training_iteration_time_ms": 8145.252, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8145.216, "sample_time_ms": 814.29, "learn_time_ms": 7318.483, "learn_throughput": 546.561, "synch_weights_time_ms": 11.782}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "done": false, "training_iteration": 178, "trial_id": "fa423_00000", "date": "2024-08-10_11-23-08", "timestamp": 1723303388, "time_this_iter_s": 8.233891010284424, "time_total_s": 1454.5725779533386, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99d8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1454.5725779533386, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 26.391666666666662, "ram_util_percent": 81.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7582610804567893, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.124514460437513, "policy_loss": -0.011658531385005782, "vf_loss": 5.136172999780645, "vf_explained_var": -0.08580459365769039, "kl": 0.03170672051476916, "entropy": 1.140677904388892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.921195190648238, "cur_kl_coeff": 1.0875212410610405e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.059595792492231, "policy_loss": -0.000989624445598262, "vf_loss": 7.060585419336955, "vf_explained_var": 0.5387705804780125, "kl": 0.008783685936695445, "entropy": 0.5401772016038497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 333.52, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 33352, "policy_reward_min": {"agent_policy": -76.64861166088359, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 53.74333358992925}, "policy_reward_mean": {"agent_policy": -1.1430471824652526, "adversary_policy": 0.5715235912326267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 68, 400, 400, 400, 400, 400, 400, 103, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 241, 348, 400, 400, 400, 400, 159, 400, 126, 400, 350, 400, 400, 400, 400, 400, 237, 400, 106, 400, 400, 177, 35, 280, 176, 262, 400, 110, 263, 337, 112, 225, 191, 400, 400, 400, 400, 400, 400, 149, 400, 400, 400, 253, 400, 400, 400, 220, 391, 400, 400, 400, 75, 400, 193, 76, 362, 84], "policy_agent_policy_reward": [44.72943516328594, -14.70993088382124, -18.626049510279117, 3.4080017460415597, 71.82550732978073, -70.7449629487593, -18.030057713568823, -24.66497275247951, 68.52675553943625, -56.256726331234496, -0.07107834334283503, 39.46492048399469, -22.4480174051559, 77.56462168220098, -24.84419256075955, -27.621233466895035, 9.12406218558969, 5.038648963189537, 14.60891608822282, -26.51944259771039, 34.337782905425364, -20.387923150722923, 39.83302951237165, -25.464640743607923, -12.286893577895022, -37.09591257251077, -16.007627119875913, -9.005638241968612, -32.448016230777, 46.64473957589023, -23.014869963965822, 5.013349675487872, -14.518154207287726, 8.96632253295251, -3.316875934939276, -33.976769913788644, -27.929404180518954, 42.14612123022658, 30.238528495456904, -25.347226054516362, -49.25809531644089, -8.353155217406897, -71.05601964296062, -44.67516026922206, -61.7560989114495, -26.774663145887786, -41.604651078266286, -50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611, -51.00056453924577, -76.64861166088359, -39.16086804626555, 68.0842395106296, 69.36095493082533, 55.96477252730694, 74.44002826827102, -67.88650830107188, 28.041462074330006, -28.09625953141957, 75.72237495374064, 79.18261777511478, -39.57677751250192, -13.623213445623293, -2.6479863945129267, -40.463287598567454, -69.39125849146346, 59.065884669974146, -35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922, 48.58557524149581, 62.959254836301795, -58.679563308681914, -56.80912957504781, 78.01176380232415, -13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937, 73.53095162094873, -52.18801142447225, -59.054058352759036, 73.49902981572032, 26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879], "policy_adversary_policy_reward": [-6.812179833574511, -37.91725532971145, 7.431014104868268, 7.278916778952972, 16.738444954220626, 1.8876045560584895, 2.635818153019809, -6.0438198990613685, -37.871027765937356, -33.95447956384335, 35.44316549917062, 35.30179744958877, -14.547695487196533, 32.57775320076537, 21.692395268251445, 2.9725774842280615, -31.137605160143757, -37.389150379292545, 22.43980224085405, 33.81692409038047, 6.930952511053004, -6.859874167710167, -14.479803924063205, -24.985116559931484, 15.247954929028229, 7.20006247612767, -50.06536961021692, -27.499252071984138, 6.98674631248916, 17.85744624827039, 16.495894160362553, 11.125339306532538, -11.617614867771117, 2.4935526821814307, -2.045565964132706, -2.9930829990568313, -7.848787500216645, -6.7601285880061734, 6.161790044105808, 20.357652553604584, -14.319346071723537, -20.018436833701827, 11.840859963325897, 8.547063187397034, -13.74487927656525, -26.0881502358064, 12.50232957635783, 12.962311167250093, 1.6335544984994437, 10.653339079395572, 20.81823702411991, 16.277675548390878, 6.524590340333447, 9.483036779542468, 5.01924623649227, 3.986392005476336, 39.987177458376436, -7.539161227599404, -23.229436367177847, -23.41530320871238, 25.719464362384905, -2.7045943984190837, -9.114366942871872, 4.101017267383984, 5.219858714176576, 9.298295493111151, -12.24893402021275, 3.282611487260235, 2.460587430733156, 0.8562885042061197, 22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458, -17.24351672729788, -12.995011768159024, 0.7411799006588264, 24.606046153857537, 15.426118343786092, 33.83197697265479, -0.7729235739845777, 9.126078791391468, 48.56803798896113, 22.487981653999512, 19.087948555854982, 25.587211713367083, 36.858784845294366, 24.897314066155086, 19.539793742446385, 7.234869403441415, 25.37313760699768, 16.231513471268602, 26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227, 17.179992661844423, 33.820571877401356, 48.66421837645345, 27.9843932844301, 26.237011377917355, 12.923856668348208, -28.1739271828011, -39.91031232782854, -32.113766487350425, -37.24718844347489, -30.10169688620379, -25.86307564110315, -53.96469615629432, -20.47533211197672, 44.27515391864114, 23.61135438243077, -7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292, -52.2406483943043, -26.9419693808104, 26.319002529805097, 13.257774982696834, 6.234767840606058, 7.388445605017237, -4.379078070016426, 7.027064464529339, 13.541095603912535, 26.92219199465491, 15.647924901534202, 53.74333358992925, -35.21873562076284, -23.8471490492113, 24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489, -40.77771997654663, -7.807855264949183, -52.79112230514295, -10.168132531158847, 43.590447711285734, 15.089115597396157, 21.512970950678046, 35.2961586243698, -37.04959945419257, -40.96216434813163, 7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015, -30.699734343847467, -42.831217277101274, 21.7757589487822, 30.412252475690067, 34.34740426592981, 24.706654086829243, -28.013557186229196, -45.48547262949114, -15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3982720116919307, "mean_inference_ms": 1.0336281857888279, "mean_action_processing_ms": 0.17166761920016987, "mean_env_wait_ms": 0.06767658267302337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036417245864868164, "StateBufferConnector_ms": 0.0026636123657226562, "ViewRequirementAgentConnector_ms": 0.07045531272888184}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.6732777248537, "num_env_steps_trained_throughput_per_sec": 488.6732777248537, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2148000, "timers": {"training_iteration_time_ms": 8162.478, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8162.441, "sample_time_ms": 816.902, "learn_time_ms": 7332.982, "learn_throughput": 545.481, "synch_weights_time_ms": 11.88}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "done": false, "training_iteration": 179, "trial_id": "fa423_00000", "date": "2024-08-10_11-23-16", "timestamp": 1723303396, "time_this_iter_s": 8.191057920455933, "time_total_s": 1462.7636358737946, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9912d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1462.7636358737946, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 25.754545454545454, "ram_util_percent": 81.60909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.84961410786109, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.048775165295475, "policy_loss": -0.00741655658166757, "vf_loss": 5.056191729490088, "vf_explained_var": -0.3716822043297783, "kl": 0.035657014110860585, "entropy": 1.078913825529593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.86435955564181, "cur_kl_coeff": 1.0875212410610405e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.898240454494953, "policy_loss": -0.002700730440362046, "vf_loss": 6.900941187143326, "vf_explained_var": 0.4599004770318667, "kl": 0.005991847791521776, "entropy": 0.5604010339515905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 328.32, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 32832, "policy_reward_min": {"agent_policy": -76.64861166088359, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 53.74333358992925}, "policy_reward_mean": {"agent_policy": -3.2386720196111813, "adversary_policy": 1.6193360098055902}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 241, 348, 400, 400, 400, 400, 159, 400, 126, 400, 350, 400, 400, 400, 400, 400, 237, 400, 106, 400, 400, 177, 35, 280, 176, 262, 400, 110, 263, 337, 112, 225, 191, 400, 400, 400, 400, 400, 400, 149, 400, 400, 400, 253, 400, 400, 400, 220, 391, 400, 400, 400, 75, 400, 193, 76, 362, 84, 400, 313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-27.621233466895035, 9.12406218558969, 5.038648963189537, 14.60891608822282, -26.51944259771039, 34.337782905425364, -20.387923150722923, 39.83302951237165, -25.464640743607923, -12.286893577895022, -37.09591257251077, -16.007627119875913, -9.005638241968612, -32.448016230777, 46.64473957589023, -23.014869963965822, 5.013349675487872, -14.518154207287726, 8.96632253295251, -3.316875934939276, -33.976769913788644, -27.929404180518954, 42.14612123022658, 30.238528495456904, -25.347226054516362, -49.25809531644089, -8.353155217406897, -71.05601964296062, -44.67516026922206, -61.7560989114495, -26.774663145887786, -41.604651078266286, -50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611, -51.00056453924577, -76.64861166088359, -39.16086804626555, 68.0842395106296, 69.36095493082533, 55.96477252730694, 74.44002826827102, -67.88650830107188, 28.041462074330006, -28.09625953141957, 75.72237495374064, 79.18261777511478, -39.57677751250192, -13.623213445623293, -2.6479863945129267, -40.463287598567454, -69.39125849146346, 59.065884669974146, -35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922, 48.58557524149581, 62.959254836301795, -58.679563308681914, -56.80912957504781, 78.01176380232415, -13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937, 73.53095162094873, -52.18801142447225, -59.054058352759036, 73.49902981572032, 26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879, 16.107280260923634, -24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238], "policy_adversary_policy_reward": [16.495894160362553, 11.125339306532538, -11.617614867771117, 2.4935526821814307, -2.045565964132706, -2.9930829990568313, -7.848787500216645, -6.7601285880061734, 6.161790044105808, 20.357652553604584, -14.319346071723537, -20.018436833701827, 11.840859963325897, 8.547063187397034, -13.74487927656525, -26.0881502358064, 12.50232957635783, 12.962311167250093, 1.6335544984994437, 10.653339079395572, 20.81823702411991, 16.277675548390878, 6.524590340333447, 9.483036779542468, 5.01924623649227, 3.986392005476336, 39.987177458376436, -7.539161227599404, -23.229436367177847, -23.41530320871238, 25.719464362384905, -2.7045943984190837, -9.114366942871872, 4.101017267383984, 5.219858714176576, 9.298295493111151, -12.24893402021275, 3.282611487260235, 2.460587430733156, 0.8562885042061197, 22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458, -17.24351672729788, -12.995011768159024, 0.7411799006588264, 24.606046153857537, 15.426118343786092, 33.83197697265479, -0.7729235739845777, 9.126078791391468, 48.56803798896113, 22.487981653999512, 19.087948555854982, 25.587211713367083, 36.858784845294366, 24.897314066155086, 19.539793742446385, 7.234869403441415, 25.37313760699768, 16.231513471268602, 26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227, 17.179992661844423, 33.820571877401356, 48.66421837645345, 27.9843932844301, 26.237011377917355, 12.923856668348208, -28.1739271828011, -39.91031232782854, -32.113766487350425, -37.24718844347489, -30.10169688620379, -25.86307564110315, -53.96469615629432, -20.47533211197672, 44.27515391864114, 23.61135438243077, -7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292, -52.2406483943043, -26.9419693808104, 26.319002529805097, 13.257774982696834, 6.234767840606058, 7.388445605017237, -4.379078070016426, 7.027064464529339, 13.541095603912535, 26.92219199465491, 15.647924901534202, 53.74333358992925, -35.21873562076284, -23.8471490492113, 24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489, -40.77771997654663, -7.807855264949183, -52.79112230514295, -10.168132531158847, 43.590447711285734, 15.089115597396157, 21.512970950678046, 35.2961586243698, -37.04959945419257, -40.96216434813163, 7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015, -30.699734343847467, -42.831217277101274, 21.7757589487822, 30.412252475690067, 34.34740426592981, 24.706654086829243, -28.013557186229196, -45.48547262949114, -15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277, -3.6468997080748125, -12.460380552848818, 15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3981733450906506, "mean_inference_ms": 1.033814747076165, "mean_action_processing_ms": 0.17177090724775726, "mean_env_wait_ms": 0.06767534560336722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003677964210510254, "StateBufferConnector_ms": 0.0026601552963256836, "ViewRequirementAgentConnector_ms": 0.06998598575592041}, "num_episodes": 15, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.536716889233, "num_env_steps_trained_throughput_per_sec": 503.536716889233, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 8134.187, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8134.149, "sample_time_ms": 818.553, "learn_time_ms": 7302.956, "learn_throughput": 547.723, "synch_weights_time_ms": 11.96}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 180, "trial_id": "fa423_00000", "date": "2024-08-10_11-23-24", "timestamp": 1723303404, "time_this_iter_s": 7.949705123901367, "time_total_s": 1470.713340997696, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98fd1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1470.713340997696, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 25.116666666666664, "ram_util_percent": 81.55833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.067956092181029, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.416766531000692, "policy_loss": -0.011398111752520201, "vf_loss": 4.428164643459219, "vf_explained_var": -0.7982858874179699, "kl": 0.019236283158143734, "entropy": 1.0829515237341483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.490434456368287, "cur_kl_coeff": 1.0875212410610405e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.656775220731894, "policy_loss": -0.009879664548498113, "vf_loss": 6.666654896239439, "vf_explained_var": 0.5117570007840793, "kl": 0.033514682064983245, "entropy": 0.3840352605562657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": 0.0, "episode_len_mean": 325.46, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 32546, "policy_reward_min": {"agent_policy": -76.64861166088359, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 53.74333358992925}, "policy_reward_mean": {"agent_policy": -1.0743833119822843, "adversary_policy": 0.5371916559911412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 241, 348, 400, 400, 400, 400, 159, 400, 126, 400, 350, 400, 400, 400, 400, 400, 237, 400, 106, 400, 400, 177, 35, 280, 176, 262, 400, 110, 263, 337, 112, 225, 191, 400, 400, 400, 400, 400, 400, 149, 400, 400, 400, 253, 400, 400, 400, 220, 391, 400, 400, 400, 75, 400, 193, 76, 362, 84, 400, 313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225], "policy_agent_policy_reward": [-16.007627119875913, -9.005638241968612, -32.448016230777, 46.64473957589023, -23.014869963965822, 5.013349675487872, -14.518154207287726, 8.96632253295251, -3.316875934939276, -33.976769913788644, -27.929404180518954, 42.14612123022658, 30.238528495456904, -25.347226054516362, -49.25809531644089, -8.353155217406897, -71.05601964296062, -44.67516026922206, -61.7560989114495, -26.774663145887786, -41.604651078266286, -50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611, -51.00056453924577, -76.64861166088359, -39.16086804626555, 68.0842395106296, 69.36095493082533, 55.96477252730694, 74.44002826827102, -67.88650830107188, 28.041462074330006, -28.09625953141957, 75.72237495374064, 79.18261777511478, -39.57677751250192, -13.623213445623293, -2.6479863945129267, -40.463287598567454, -69.39125849146346, 59.065884669974146, -35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922, 48.58557524149581, 62.959254836301795, -58.679563308681914, -56.80912957504781, 78.01176380232415, -13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937, 73.53095162094873, -52.18801142447225, -59.054058352759036, 73.49902981572032, 26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879, 16.107280260923634, -24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646], "policy_adversary_policy_reward": [6.524590340333447, 9.483036779542468, 5.01924623649227, 3.986392005476336, 39.987177458376436, -7.539161227599404, -23.229436367177847, -23.41530320871238, 25.719464362384905, -2.7045943984190837, -9.114366942871872, 4.101017267383984, 5.219858714176576, 9.298295493111151, -12.24893402021275, 3.282611487260235, 2.460587430733156, 0.8562885042061197, 22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458, -17.24351672729788, -12.995011768159024, 0.7411799006588264, 24.606046153857537, 15.426118343786092, 33.83197697265479, -0.7729235739845777, 9.126078791391468, 48.56803798896113, 22.487981653999512, 19.087948555854982, 25.587211713367083, 36.858784845294366, 24.897314066155086, 19.539793742446385, 7.234869403441415, 25.37313760699768, 16.231513471268602, 26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227, 17.179992661844423, 33.820571877401356, 48.66421837645345, 27.9843932844301, 26.237011377917355, 12.923856668348208, -28.1739271828011, -39.91031232782854, -32.113766487350425, -37.24718844347489, -30.10169688620379, -25.86307564110315, -53.96469615629432, -20.47533211197672, 44.27515391864114, 23.61135438243077, -7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292, -52.2406483943043, -26.9419693808104, 26.319002529805097, 13.257774982696834, 6.234767840606058, 7.388445605017237, -4.379078070016426, 7.027064464529339, 13.541095603912535, 26.92219199465491, 15.647924901534202, 53.74333358992925, -35.21873562076284, -23.8471490492113, 24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489, -40.77771997654663, -7.807855264949183, -52.79112230514295, -10.168132531158847, 43.590447711285734, 15.089115597396157, 21.512970950678046, 35.2961586243698, -37.04959945419257, -40.96216434813163, 7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015, -30.699734343847467, -42.831217277101274, 21.7757589487822, 30.412252475690067, 34.34740426592981, 24.706654086829243, -28.013557186229196, -45.48547262949114, -15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277, -3.6468997080748125, -12.460380552848818, 15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3982365422812781, "mean_inference_ms": 1.0338199404213824, "mean_action_processing_ms": 0.17177118441907055, "mean_env_wait_ms": 0.06771168691795114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694295883178711, "StateBufferConnector_ms": 0.0026502609252929688, "ViewRequirementAgentConnector_ms": 0.07065486907958984}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.1053618969872, "num_env_steps_trained_throughput_per_sec": 503.1053618969872, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2172000, "timers": {"training_iteration_time_ms": 8070.755, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8070.717, "sample_time_ms": 820.691, "learn_time_ms": 7237.513, "learn_throughput": 552.676, "synch_weights_time_ms": 11.857}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "done": false, "training_iteration": 181, "trial_id": "fa423_00000", "date": "2024-08-10_11-23-32", "timestamp": 1723303412, "time_this_iter_s": 7.955949068069458, "time_total_s": 1478.6692900657654, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98fd820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1478.6692900657654, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 24.716666666666665, "ram_util_percent": 81.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6687359719049364, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.921764382988057, "policy_loss": -0.008666855090411095, "vf_loss": 4.930431229223019, "vf_explained_var": -0.5350275919235573, "kl": 0.016328032920140536, "entropy": 1.1785812161586904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.128186317533254, "cur_kl_coeff": 1.63128186159156e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.592687125504017, "policy_loss": -0.002831240757465518, "vf_loss": 5.59551836202542, "vf_explained_var": 0.12650329265743493, "kl": 0.021211515244653714, "entropy": 0.6041760660087069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 324.94, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 32494, "policy_reward_min": {"agent_policy": -76.64861166088359, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 53.74333358992925}, "policy_reward_mean": {"agent_policy": 0.7082554107901337, "adversary_policy": -0.35412770539506766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 241, 348, 400, 400, 400, 400, 159, 400, 126, 400, 350, 400, 400, 400, 400, 400, 237, 400, 106, 400, 400, 177, 35, 280, 176, 262, 400, 110, 263, 337, 112, 225, 191, 400, 400, 400, 400, 400, 400, 149, 400, 400, 400, 253, 400, 400, 400, 220, 391, 400, 400, 400, 75, 400, 193, 76, 362, 84, 400, 313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225, 400, 400, 400, 400, 132, 400, 400, 331, 298], "policy_agent_policy_reward": [-33.976769913788644, -27.929404180518954, 42.14612123022658, 30.238528495456904, -25.347226054516362, -49.25809531644089, -8.353155217406897, -71.05601964296062, -44.67516026922206, -61.7560989114495, -26.774663145887786, -41.604651078266286, -50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611, -51.00056453924577, -76.64861166088359, -39.16086804626555, 68.0842395106296, 69.36095493082533, 55.96477252730694, 74.44002826827102, -67.88650830107188, 28.041462074330006, -28.09625953141957, 75.72237495374064, 79.18261777511478, -39.57677751250192, -13.623213445623293, -2.6479863945129267, -40.463287598567454, -69.39125849146346, 59.065884669974146, -35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922, 48.58557524149581, 62.959254836301795, -58.679563308681914, -56.80912957504781, 78.01176380232415, -13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937, 73.53095162094873, -52.18801142447225, -59.054058352759036, 73.49902981572032, 26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879, 16.107280260923634, -24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416], "policy_adversary_policy_reward": [22.318147432398213, 11.658622481390449, 5.126226692417028, 22.80317748810191, -16.851434179935126, -25.294687050291458, -17.24351672729788, -12.995011768159024, 0.7411799006588264, 24.606046153857537, 15.426118343786092, 33.83197697265479, -0.7729235739845777, 9.126078791391468, 48.56803798896113, 22.487981653999512, 19.087948555854982, 25.587211713367083, 36.858784845294366, 24.897314066155086, 19.539793742446385, 7.234869403441415, 25.37313760699768, 16.231513471268602, 26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227, 17.179992661844423, 33.820571877401356, 48.66421837645345, 27.9843932844301, 26.237011377917355, 12.923856668348208, -28.1739271828011, -39.91031232782854, -32.113766487350425, -37.24718844347489, -30.10169688620379, -25.86307564110315, -53.96469615629432, -20.47533211197672, 44.27515391864114, 23.61135438243077, -7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292, -52.2406483943043, -26.9419693808104, 26.319002529805097, 13.257774982696834, 6.234767840606058, 7.388445605017237, -4.379078070016426, 7.027064464529339, 13.541095603912535, 26.92219199465491, 15.647924901534202, 53.74333358992925, -35.21873562076284, -23.8471490492113, 24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489, -40.77771997654663, -7.807855264949183, -52.79112230514295, -10.168132531158847, 43.590447711285734, 15.089115597396157, 21.512970950678046, 35.2961586243698, -37.04959945419257, -40.96216434813163, 7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015, -30.699734343847467, -42.831217277101274, 21.7757589487822, 30.412252475690067, 34.34740426592981, 24.706654086829243, -28.013557186229196, -45.48547262949114, -15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277, -3.6468997080748125, -12.460380552848818, 15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39831122150412773, "mean_inference_ms": 1.0338071462744147, "mean_action_processing_ms": 0.17168039718166633, "mean_env_wait_ms": 0.06772285082121597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036600828170776367, "StateBufferConnector_ms": 0.002585887908935547, "ViewRequirementAgentConnector_ms": 0.07033395767211914}, "num_episodes": 9, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.1035213104645, "num_env_steps_trained_throughput_per_sec": 503.1035213104645, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 8063.826, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8063.785, "sample_time_ms": 812.496, "learn_time_ms": 7238.342, "learn_throughput": 552.613, "synch_weights_time_ms": 12.24}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "training_iteration": 182, "trial_id": "fa423_00000", "date": "2024-08-10_11-23-40", "timestamp": 1723303420, "time_this_iter_s": 7.959591865539551, "time_total_s": 1486.628881931305, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98fd8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1486.628881931305, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 27.2, "ram_util_percent": 81.45454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6981341292618444, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6696749033751312, "policy_loss": -0.008021170780476596, "vf_loss": 3.677696080687185, "vf_explained_var": 0.06497981746991476, "kl": 0.013568826457629463, "entropy": 1.178565926211221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.467504635080695, "cur_kl_coeff": 2.446922792387341e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.981492054214081, "policy_loss": -0.0025909772271309824, "vf_loss": 5.984083045770725, "vf_explained_var": 0.12277370175967614, "kl": 0.004090046657759135, "entropy": 0.26968404768655696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 325.92, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 32592, "policy_reward_min": {"agent_policy": -76.64861166088359, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 110.74806558857759, "adversary_policy": 53.74333358992925}, "policy_reward_mean": {"agent_policy": 5.345812420043005, "adversary_policy": -2.6729062100215026}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 159, 400, 126, 400, 350, 400, 400, 400, 400, 400, 237, 400, 106, 400, 400, 177, 35, 280, 176, 262, 400, 110, 263, 337, 112, 225, 191, 400, 400, 400, 400, 400, 400, 149, 400, 400, 400, 253, 400, 400, 400, 220, 391, 400, 400, 400, 75, 400, 193, 76, 362, 84, 400, 313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225, 400, 400, 400, 400, 132, 400, 400, 331, 298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287], "policy_agent_policy_reward": [-50.69334544598289, -4.874544014012681, 110.74806558857759, -47.44602635026611, -51.00056453924577, -76.64861166088359, -39.16086804626555, 68.0842395106296, 69.36095493082533, 55.96477252730694, 74.44002826827102, -67.88650830107188, 28.041462074330006, -28.09625953141957, 75.72237495374064, 79.18261777511478, -39.57677751250192, -13.623213445623293, -2.6479863945129267, -40.463287598567454, -69.39125849146346, 59.065884669974146, -35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922, 48.58557524149581, 62.959254836301795, -58.679563308681914, -56.80912957504781, 78.01176380232415, -13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937, 73.53095162094873, -52.18801142447225, -59.054058352759036, 73.49902981572032, 26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879, 16.107280260923634, -24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589], "policy_adversary_policy_reward": [26.826746990663047, 23.86659845531988, -6.048076926986443, 10.922620940999124, -55.16905665964355, -55.57900892893407, 27.597592201737857, 19.848434148528227, 17.179992661844423, 33.820571877401356, 48.66421837645345, 27.9843932844301, 26.237011377917355, 12.923856668348208, -28.1739271828011, -39.91031232782854, -32.113766487350425, -37.24718844347489, -30.10169688620379, -25.86307564110315, -53.96469615629432, -20.47533211197672, 44.27515391864114, 23.61135438243077, -7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292, -52.2406483943043, -26.9419693808104, 26.319002529805097, 13.257774982696834, 6.234767840606058, 7.388445605017237, -4.379078070016426, 7.027064464529339, 13.541095603912535, 26.92219199465491, 15.647924901534202, 53.74333358992925, -35.21873562076284, -23.8471490492113, 24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489, -40.77771997654663, -7.807855264949183, -52.79112230514295, -10.168132531158847, 43.590447711285734, 15.089115597396157, 21.512970950678046, 35.2961586243698, -37.04959945419257, -40.96216434813163, 7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015, -30.699734343847467, -42.831217277101274, 21.7757589487822, 30.412252475690067, 34.34740426592981, 24.706654086829243, -28.013557186229196, -45.48547262949114, -15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277, -3.6468997080748125, -12.460380552848818, 15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3982262936936604, "mean_inference_ms": 1.0337862560639823, "mean_action_processing_ms": 0.17169147395207862, "mean_env_wait_ms": 0.06771673060988574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003683328628540039, "StateBufferConnector_ms": 0.0026073455810546875, "ViewRequirementAgentConnector_ms": 0.07103586196899414}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.4205897792648, "num_env_steps_trained_throughput_per_sec": 488.4205897792648, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2196000, "timers": {"training_iteration_time_ms": 8069.043, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8068.999, "sample_time_ms": 808.06, "learn_time_ms": 7247.946, "learn_throughput": 551.881, "synch_weights_time_ms": 12.278}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "done": false, "training_iteration": 183, "trial_id": "fa423_00000", "date": "2024-08-10_11-23-49", "timestamp": 1723303429, "time_this_iter_s": 8.195765972137451, "time_total_s": 1494.8246479034424, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98fdee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1494.8246479034424, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 24.483333333333334, "ram_util_percent": 81.41666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9868479199510403, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.490760799564382, "policy_loss": -0.010077382830986704, "vf_loss": 4.500838183095215, "vf_explained_var": -0.16287957038828935, "kl": 0.018517993581245226, "entropy": 1.2425676695253483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.323224072592954, "cur_kl_coeff": 1.2234613961936704e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.491196608046691, "policy_loss": -0.004817328208203738, "vf_loss": 6.496013954281807, "vf_explained_var": -0.17197116756190856, "kl": 0.009183702302340061, "entropy": 0.6118958967116972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 329.7, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 32970, "policy_reward_min": {"agent_policy": -73.60214142927238, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 93.48244504150222, "adversary_policy": 53.74333358992925}, "policy_reward_mean": {"agent_policy": 7.232658495516125, "adversary_policy": -3.616329247758064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 106, 400, 400, 177, 35, 280, 176, 262, 400, 110, 263, 337, 112, 225, 191, 400, 400, 400, 400, 400, 400, 149, 400, 400, 400, 253, 400, 400, 400, 220, 391, 400, 400, 400, 75, 400, 193, 76, 362, 84, 400, 313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225, 400, 400, 400, 400, 132, 400, 400, 331, 298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225], "policy_agent_policy_reward": [28.041462074330006, -28.09625953141957, 75.72237495374064, 79.18261777511478, -39.57677751250192, -13.623213445623293, -2.6479863945129267, -40.463287598567454, -69.39125849146346, 59.065884669974146, -35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922, 48.58557524149581, 62.959254836301795, -58.679563308681914, -56.80912957504781, 78.01176380232415, -13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937, 73.53095162094873, -52.18801142447225, -59.054058352759036, 73.49902981572032, 26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879, 16.107280260923634, -24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589, 0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447], "policy_adversary_policy_reward": [-7.1526382265566895, -20.888823847773317, 15.673474688454517, 12.422784842965056, -41.40225678498776, -34.32011816875292, -52.2406483943043, -26.9419693808104, 26.319002529805097, 13.257774982696834, 6.234767840606058, 7.388445605017237, -4.379078070016426, 7.027064464529339, 13.541095603912535, 26.92219199465491, 15.647924901534202, 53.74333358992925, -35.21873562076284, -23.8471490492113, 24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489, -40.77771997654663, -7.807855264949183, -52.79112230514295, -10.168132531158847, 43.590447711285734, 15.089115597396157, 21.512970950678046, 35.2961586243698, -37.04959945419257, -40.96216434813163, 7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015, -30.699734343847467, -42.831217277101274, 21.7757589487822, 30.412252475690067, 34.34740426592981, 24.706654086829243, -28.013557186229196, -45.48547262949114, -15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277, -3.6468997080748125, -12.460380552848818, 15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855, -10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3981676416208972, "mean_inference_ms": 1.0336554315914115, "mean_action_processing_ms": 0.17161803079470878, "mean_env_wait_ms": 0.06769004581497082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690004348754883, "StateBufferConnector_ms": 0.0025635957717895508, "ViewRequirementAgentConnector_ms": 0.07046067714691162}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.4384873943566, "num_env_steps_trained_throughput_per_sec": 504.4384873943566, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 8041.282, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8041.238, "sample_time_ms": 790.949, "learn_time_ms": 7237.024, "learn_throughput": 552.713, "synch_weights_time_ms": 12.554}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 184, "trial_id": "fa423_00000", "date": "2024-08-10_11-23-57", "timestamp": 1723303437, "time_this_iter_s": 7.936024188995361, "time_total_s": 1502.7606720924377, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ba1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1502.7606720924377, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 25.818181818181817, "ram_util_percent": 81.42727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.25966118958892, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.780836358146062, "policy_loss": -0.008005211537053424, "vf_loss": 4.788841573649614, "vf_explained_var": -0.38631518331785053, "kl": 0.019307730230009104, "entropy": 1.1033591872800594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.432549571804702, "cur_kl_coeff": 1.2234613961936704e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.402189660569032, "policy_loss": -0.004356754845988083, "vf_loss": 6.4065464188655215, "vf_explained_var": 0.043952895576755205, "kl": 0.020606225713125863, "entropy": 0.793858754945298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 339.61, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33961, "policy_reward_min": {"agent_policy": -73.60214142927238, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 93.48244504150222, "adversary_policy": 47.920308136114734}, "policy_reward_mean": {"agent_policy": 7.774959086445095, "adversary_policy": -3.887479543222548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [110, 263, 337, 112, 225, 191, 400, 400, 400, 400, 400, 400, 149, 400, 400, 400, 253, 400, 400, 400, 220, 391, 400, 400, 400, 75, 400, 193, 76, 362, 84, 400, 313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225, 400, 400, 400, 400, 132, 400, 400, 331, 298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400], "policy_agent_policy_reward": [-35.78342570431947, -32.52503688224754, -48.82315709296454, -19.822575137354963, -52.09009025435128, -26.836132996631157, 70.98279207991922, 48.58557524149581, 62.959254836301795, -58.679563308681914, -56.80912957504781, 78.01176380232415, -13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937, 73.53095162094873, -52.18801142447225, -59.054058352759036, 73.49902981572032, 26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879, 16.107280260923634, -24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589, 0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219], "policy_adversary_policy_reward": [24.00984007650925, 11.773585627810231, 19.97583050740129, 12.549206374846255, 33.41889578687018, 15.404261306094362, 0.6517302109867629, 19.1708449263682, 18.15100753360864, 33.93908272074263, 11.811112932387847, 15.025020064243309, -23.443373073694314, -47.53941900622489, -40.77771997654663, -7.807855264949183, -52.79112230514295, -10.168132531158847, 43.590447711285734, 15.089115597396157, 21.512970950678046, 35.2961586243698, -37.04959945419257, -40.96216434813163, 7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015, -30.699734343847467, -42.831217277101274, 21.7757589487822, 30.412252475690067, 34.34740426592981, 24.706654086829243, -28.013557186229196, -45.48547262949114, -15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277, -3.6468997080748125, -12.460380552848818, 15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855, -10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39815223379020054, "mean_inference_ms": 1.033470229838171, "mean_action_processing_ms": 0.17159965737190463, "mean_env_wait_ms": 0.06765338026826169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.002595186233520508, "ViewRequirementAgentConnector_ms": 0.07003545761108398}, "num_episodes": 10, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.27869611926354, "num_env_steps_trained_throughput_per_sec": 497.27869611926354, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2220000, "timers": {"training_iteration_time_ms": 8049.807, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8049.765, "sample_time_ms": 803.15, "learn_time_ms": 7233.291, "learn_throughput": 552.999, "synch_weights_time_ms": 12.641}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "done": false, "training_iteration": 185, "trial_id": "fa423_00000", "date": "2024-08-10_11-24-05", "timestamp": 1723303445, "time_this_iter_s": 8.049330949783325, "time_total_s": 1510.810003042221, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a98fdf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1510.810003042221, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 25.624999999999996, "ram_util_percent": 81.44166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.923804053869197, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.342086615764275, "policy_loss": -0.007262071636357596, "vf_loss": 5.349348676267755, "vf_explained_var": -0.04999059665770758, "kl": 0.016922958703192315, "entropy": 1.1042260157052801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7712109270816048, "cur_kl_coeff": 1.8351920942905057e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.203837556143601, "policy_loss": -0.005780680302026061, "vf_loss": 6.209618218739828, "vf_explained_var": 0.38510044272989036, "kl": 0.01991330517507459, "entropy": 0.7486522854616244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": 0.0, "episode_reward_mean": 2.220446049250313e-18, "episode_len_mean": 344.24, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34424, "policy_reward_min": {"agent_policy": -73.60214142927238, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 93.48244504150222, "adversary_policy": 47.920308136114734}, "policy_reward_mean": {"agent_policy": 10.22464980280514, "adversary_policy": -5.1123249014025705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [149, 400, 400, 400, 253, 400, 400, 400, 220, 391, 400, 400, 400, 75, 400, 193, 76, 362, 84, 400, 313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225, 400, 400, 400, 400, 132, 400, 400, 331, 298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400], "policy_agent_policy_reward": [-13.585666055586383, 40.54240458072017, -62.502103355018086, 28.611609208622056, -66.04695895848255, 89.20264971386607, 70.80873776367937, 73.53095162094873, -52.18801142447225, -59.054058352759036, 73.49902981572032, 26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879, 16.107280260923634, -24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589, 0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484], "policy_adversary_policy_reward": [7.328294917190818, 6.257371138395563, -31.565967995695775, -8.976436585024388, 20.058820399135538, 42.443282955882566, -10.142675488739776, -18.46893371988228, 24.999774338414106, 41.04718462006846, -52.25239835655441, -36.950251357311636, -27.650971193069246, -43.15776657061015, -30.699734343847467, -42.831217277101274, 21.7757589487822, 30.412252475690067, 34.34740426592981, 24.706654086829243, -28.013557186229196, -45.48547262949114, -15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277, -3.6468997080748125, -12.460380552848818, 15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855, -10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3981133518461643, "mean_inference_ms": 1.033562071423732, "mean_action_processing_ms": 0.17165322412022221, "mean_env_wait_ms": 0.06764365755891508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036994218826293945, "StateBufferConnector_ms": 0.0026044845581054688, "ViewRequirementAgentConnector_ms": 0.07055103778839111}, "num_episodes": 12, "episode_return_max": 2.220446049250313e-16, "episode_return_min": 0.0, "episode_return_mean": 2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.76704644546163, "num_env_steps_trained_throughput_per_sec": 475.76704644546163, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2232000, "timers": {"training_iteration_time_ms": 8098.68, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8098.639, "sample_time_ms": 796.797, "learn_time_ms": 7288.5, "learn_throughput": 548.81, "synch_weights_time_ms": 12.722}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "done": false, "training_iteration": 186, "trial_id": "fa423_00000", "date": "2024-08-10_11-24-14", "timestamp": 1723303454, "time_this_iter_s": 8.41414499282837, "time_total_s": 1519.2241480350494, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a2e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1519.2241480350494, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 30.541666666666668, "ram_util_percent": 81.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.951993780287485, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.242874929766176, "policy_loss": -0.005964057062501236, "vf_loss": 5.248838982632551, "vf_explained_var": -0.14012586761403967, "kl": 0.009186281527219401, "entropy": 0.9958137968545238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2870434237023196, "cur_kl_coeff": 1.8351920942905057e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.761095710595449, "policy_loss": -0.008867667556235878, "vf_loss": 6.769963368276755, "vf_explained_var": 0.47507041742404305, "kl": 0.07491281936309993, "entropy": 0.8561402256290118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "env_runners": {"episode_reward_max": 2.220446049250313e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 1.1102230246251566e-18, "episode_len_mean": 343.04, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34304, "policy_reward_min": {"agent_policy": -73.60214142927238, "adversary_policy": -64.27074557848398}, "policy_reward_max": {"agent_policy": 93.48244504150222, "adversary_policy": 47.920308136114734}, "policy_reward_mean": {"agent_policy": 8.229117779366218, "adversary_policy": -4.11455888968311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0], "episode_lengths": [400, 400, 75, 400, 193, 76, 362, 84, 400, 313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225, 400, 400, 400, 400, 132, 400, 400, 331, 298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400], "policy_agent_policy_reward": [26.98034802363825, 65.87619957734765, -15.343256006846811, 84.37563744480097, -28.44355465737115, 11.997994266053366, -59.862185265067275, 6.367806716747879, 16.107280260923634, -24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589, 0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582], "policy_adversary_policy_reward": [-15.546319917362489, -11.434028106275761, -16.6119725822389, -49.264226995108736, 11.029698626635618, 4.313557380211199, -20.104891866316976, -64.27074557848398, 22.078252036334728, 6.365302621036426, 16.11374279434334, -28.111737060396713, 19.592643465388406, 40.269541799678834, -10.423368334183156, 4.055561617435277, -3.6468997080748125, -12.460380552848818, 15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855, -10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39811880118588305, "mean_inference_ms": 1.0335000811954858, "mean_action_processing_ms": 0.17163391962201696, "mean_env_wait_ms": 0.0676265534743923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003753066062927246, "StateBufferConnector_ms": 0.0025339126586914062, "ViewRequirementAgentConnector_ms": 0.06913185119628906}, "num_episodes": 11, "episode_return_max": 2.220446049250313e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.97005730804426, "num_env_steps_trained_throughput_per_sec": 494.97005730804426, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2244000, "timers": {"training_iteration_time_ms": 8091.106, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8091.065, "sample_time_ms": 795.006, "learn_time_ms": 7282.898, "learn_throughput": 549.232, "synch_weights_time_ms": 12.536}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "done": false, "training_iteration": 187, "trial_id": "fa423_00000", "date": "2024-08-10_11-24-22", "timestamp": 1723303462, "time_this_iter_s": 8.086529970169067, "time_total_s": 1527.3106780052185, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a2e670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1527.3106780052185, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 24.499999999999996, "ram_util_percent": 81.77499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.756217343971212, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.193134665615344, "policy_loss": -0.006342337073058521, "vf_loss": 5.199476991254817, "vf_explained_var": 0.08044971322256421, "kl": 0.010800894595787026, "entropy": 0.9239299240251067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3271504344418643, "cur_kl_coeff": 2.7527881414357574e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.21813965489467, "policy_loss": -0.007929782093075726, "vf_loss": 7.226069422066212, "vf_explained_var": -0.6602700146536032, "kl": 0.012623580977285309, "entropy": 0.7396208706311882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": -1.1102230246251566e-18, "episode_len_mean": 355.14, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 35514, "policy_reward_min": {"agent_policy": -73.60214142927238, "adversary_policy": -55.1344581821575}, "policy_reward_max": {"agent_policy": 93.48244504150222, "adversary_policy": 47.920308136114734}, "policy_reward_mean": {"agent_policy": 10.608947606671482, "adversary_policy": -5.304473803335741}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [313, 358, 329, 275, 400, 400, 47, 86, 243, 400, 400, 400, 400, 400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225, 400, 400, 400, 400, 132, 400, 400, 331, 298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-24.09412424096949, -67.31622831710828, -41.115476276144705, -35.36185799927124, 39.112445094869315, -16.301857201254105, -13.815585572938318, -31.939496786534747, -56.95454569917644, 55.905395530991164, -62.701514966214226, 75.55922363948241, 82.07925374336409, -73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589, 0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795], "policy_adversary_policy_reward": [15.731044138022108, 8.363080102947382, 38.04849615632899, 29.26773216077931, 11.852540700859969, 29.26293557528475, 13.656417525398147, 21.705440473873082, -27.18002104306495, -11.932424051804361, 18.58519705581528, -2.283339854561177, 6.0974726279921505, 7.718112944946165, 10.951361264035572, 20.988135522499167, 47.920308136114734, 9.034237563061712, -33.28309384701601, -22.622301683975145, 36.5467984376661, 26.15471652854813, -33.2553245307354, -42.30389910874712, -52.31218620934248, -29.767067534021656, 35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855, -10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39791688396103225, "mean_inference_ms": 1.0334619963540306, "mean_action_processing_ms": 0.17166466865423766, "mean_env_wait_ms": 0.06762330633705568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037761926651000977, "StateBufferConnector_ms": 0.002553105354309082, "ViewRequirementAgentConnector_ms": 0.06930863857269287}, "num_episodes": 9, "episode_return_max": 0.0, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": -1.1102230246251566e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.5450820117208, "num_env_steps_trained_throughput_per_sec": 500.5450820117208, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 8067.372, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8067.333, "sample_time_ms": 790.343, "learn_time_ms": 7263.961, "learn_throughput": 550.664, "synch_weights_time_ms": 12.41}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 188, "trial_id": "fa423_00000", "date": "2024-08-10_11-24-30", "timestamp": 1723303470, "time_this_iter_s": 7.995888948440552, "time_total_s": 1535.306566953659, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a2e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1535.306566953659, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 24.09166666666667, "ram_util_percent": 81.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8533616007951204, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.203538238813007, "policy_loss": -0.006882527928981713, "vf_loss": 4.210420773269007, "vf_explained_var": 0.017475625320717142, "kl": 0.012733355585969903, "entropy": 0.9654497556270115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.697248977360626, "cur_kl_coeff": 2.7527881414357574e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.392796312769254, "policy_loss": -0.004442283419969802, "vf_loss": 5.397238588829835, "vf_explained_var": -0.1536854650825262, "kl": 0.006464583587450346, "entropy": 0.7602352077141404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 0.0, "episode_len_mean": 359.09, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 35909, "policy_reward_min": {"agent_policy": -73.60214142927238, "adversary_policy": -55.1344581821575}, "policy_reward_max": {"agent_policy": 93.48244504150222, "adversary_policy": 45.1751657246219}, "policy_reward_mean": {"agent_policy": 15.96978600733462, "adversary_policy": -7.98489300366731}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 142, 400, 325, 400, 400, 400, 400, 400, 252, 225, 400, 400, 400, 400, 132, 400, 400, 331, 298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400], "policy_agent_policy_reward": [-73.60214142927238, 84.90788764877428, -43.16547853324275, 93.48244504150222, -69.07479040473436, 6.4072853792047155, 91.52379983634587, -41.14470908932146, 47.09162509243789, 44.81534208862193, -9.605726487820082, -35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589, 0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501], "policy_adversary_policy_reward": [35.317343811174894, 38.28479761809756, -33.04777084366789, -51.86011680510639, 26.63979530805241, 16.52568322519034, -46.1293796002973, -47.35306544120491, 35.216080730970134, 33.858709673764224, 3.907353331293642, -10.314638710498357, -36.3893416541884, -55.1344581821575, 25.391397854295583, 15.753311235025876, -24.177210621816023, -22.914414470621864, -7.790601576299466, -37.02474051232247, 0.8082415663176814, 8.797484921502395, 18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855, -10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3979268904670042, "mean_inference_ms": 1.0330390666703857, "mean_action_processing_ms": 0.1716108889104541, "mean_env_wait_ms": 0.06760781669080741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003697514533996582, "StateBufferConnector_ms": 0.0025129318237304688, "ViewRequirementAgentConnector_ms": 0.06834638118743896}, "num_episodes": 13, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.762565604029, "num_env_steps_trained_throughput_per_sec": 485.762565604029, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 2268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2268000, "timers": {"training_iteration_time_ms": 8072.276, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8072.237, "sample_time_ms": 784.481, "learn_time_ms": 7274.855, "learn_throughput": 549.839, "synch_weights_time_ms": 12.329}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "done": false, "training_iteration": 189, "trial_id": "fa423_00000", "date": "2024-08-10_11-24-38", "timestamp": 1723303478, "time_this_iter_s": 8.239782810211182, "time_total_s": 1543.5463497638702, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a2ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1543.5463497638702, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 26.100000000000005, "ram_util_percent": 81.70833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8051252520904337, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.904088723974884, "policy_loss": -0.006684945619827698, "vf_loss": 3.9107736564817883, "vf_explained_var": 0.14885800490303644, "kl": 0.013382843861867024, "entropy": 1.0339009963330767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4771991167838374, "cur_kl_coeff": 2.7527881414357574e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.328291699290276, "policy_loss": -0.00601415648998227, "vf_loss": 5.3343058715264, "vf_explained_var": -0.19819682811697323, "kl": 0.009610213118003882, "entropy": 0.7881384498129288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 0.0, "episode_len_mean": 360.47, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36047, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -50.942520513257044}, "policy_reward_max": {"agent_policy": 88.14408950050051, "adversary_policy": 45.1751657246219}, "policy_reward_mean": {"agent_policy": 18.18061318951935, "adversary_policy": -9.090306594759674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [225, 400, 400, 400, 400, 132, 400, 400, 331, 298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400], "policy_agent_policy_reward": [-35.242416263421646, 23.595862546753697, 65.92561973376348, 77.55166174717635, 51.14857012125578, -47.955575516040504, -36.809744088286074, 67.29929831945417, -22.047074778411453, -38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589, 0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524], "policy_adversary_policy_reward": [18.230201332234245, 17.01221493118739, -2.7010477254703886, -20.89481482128331, -31.58867732666785, -34.33694240709563, -38.61196054827011, -38.93970119890625, -23.959949174802233, -27.188620946453543, 34.84678374862475, 13.10879176741577, 16.302585738814834, 20.507158349471226, -47.26203380324308, -20.03726451621109, 6.958338790803066, 15.088735987608384, 13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855, -10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39782581663687167, "mean_inference_ms": 1.0328071633138516, "mean_action_processing_ms": 0.17162680835045854, "mean_env_wait_ms": 0.06757749038665495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681659698486328, "StateBufferConnector_ms": 0.0025178194046020508, "ViewRequirementAgentConnector_ms": 0.06759762763977051}, "num_episodes": 11, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.87160670045756, "num_env_steps_trained_throughput_per_sec": 501.87160670045756, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 8074.912, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8074.873, "sample_time_ms": 780.567, "learn_time_ms": 7281.463, "learn_throughput": 549.34, "synch_weights_time_ms": 12.242}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 190, "trial_id": "fa423_00000", "date": "2024-08-10_11-24-47", "timestamp": 1723303487, "time_this_iter_s": 7.97522497177124, "time_total_s": 1551.5215747356415, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72abf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1551.5215747356415, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 25.881818181818186, "ram_util_percent": 81.6909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.510323426647792, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.337316751984692, "policy_loss": -0.00915568992520175, "vf_loss": 4.346472452935719, "vf_explained_var": 0.15467391115017037, "kl": 0.010804793139829317, "entropy": 1.0740096352403126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1978168570126098, "cur_kl_coeff": 2.7527881414357574e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.322220521668593, "policy_loss": -0.0026970421390918394, "vf_loss": 6.324917575220267, "vf_explained_var": 0.009475314679245153, "kl": 0.0035336618856850834, "entropy": 0.48993554258098204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 0.0, "episode_len_mean": 365.59, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36559, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 45.1751657246219}, "policy_reward_mean": {"agent_policy": 19.510559123934758, "adversary_policy": -9.75527956196738}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [298, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 287, 400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-38.131515722907416, 27.370752845428417, 17.893853904154042, -11.697783154978367, -19.41880208156034, 41.45413454686527, -22.582314205768174, 52.677365912924834, 32.99733839367961, -17.596953793566556, 32.197758640250505, 9.137466141304756, 2.976289771778589, 0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647], "policy_adversary_policy_reward": [13.718394590834954, 24.413121132072447, -33.98791116900348, 6.6171583235750795, -11.840698929276577, -6.053154974877465, 31.289510933992062, -19.59172777901368, -2.762017910345275, 22.180819991905608, -4.2227271931812425, -37.231407353684, 24.67528331517588, -2.0929691094077327, -31.974416509641287, -20.702949403283554, -14.539800355048818, -18.457538038630794, 12.207062112413226, 5.389891681153337, -32.96458703340879, 0.7668283931582831, -8.193646373795922, -0.9438197675088347, -24.580619783526444, 21.604330011747855, -10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3977884713100199, "mean_inference_ms": 1.0327291366340863, "mean_action_processing_ms": 0.17160910072343316, "mean_env_wait_ms": 0.06757331756510783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036705732345581055, "StateBufferConnector_ms": 0.002526521682739258, "ViewRequirementAgentConnector_ms": 0.06856715679168701}, "num_episodes": 9, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.1998270515667, "num_env_steps_trained_throughput_per_sec": 493.1998270515667, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 2292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2292000, "timers": {"training_iteration_time_ms": 8090.88, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8090.841, "sample_time_ms": 779.443, "learn_time_ms": 7298.452, "learn_throughput": 548.061, "synch_weights_time_ms": 12.323}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "done": false, "training_iteration": 191, "trial_id": "fa423_00000", "date": "2024-08-10_11-24-55", "timestamp": 1723303495, "time_this_iter_s": 8.116525173187256, "time_total_s": 1559.6380999088287, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a5e3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1559.6380999088287, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 25.25833333333333, "ram_util_percent": 81.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7196358622697296, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7162428514036554, "policy_loss": -0.006644019146607548, "vf_loss": 3.7228868792296717, "vf_explained_var": 0.136019517441906, "kl": 0.019076368566655642, "entropy": 1.0052497656887802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.510266888141632, "cur_kl_coeff": 1.3763940707178787e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.055068823695183, "policy_loss": -0.011047449378384044, "vf_loss": 6.066116272906462, "vf_explained_var": -0.03273058130095403, "kl": 0.008569155526169329, "entropy": 0.45685021616518495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 0.0, "episode_len_mean": 360.91, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 36091, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 45.1751657246219}, "policy_reward_mean": {"agent_policy": 16.99176657328219, "adversary_policy": -8.495883286641098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 225, 400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400], "policy_agent_policy_reward": [0.1513111355247556, 5.27276869783581, 11.564138921579527, 23.059599500477354, 67.7185193175552, 50.70417667606064, 2.038445615105438, -19.554012502579745, 37.10942613933792, -36.63952540496388, 65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252], "policy_adversary_policy_reward": [-10.710463905720381, 10.559152770195626, -17.15168093082857, 11.878912232992764, -1.828052808114272, -9.736086113465255, -8.3972035288267, -14.662395971650653, -39.24475104034675, -28.473768277208467, -19.913529225409228, -30.790647450651413, 26.303951618098203, -28.34239723320364, 17.235380352510212, 2.31863215006954, -35.59090514789359, -1.5185209914443831, 13.38607892109922, 23.253446483864664, -48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39772420418389065, "mean_inference_ms": 1.032496886846079, "mean_action_processing_ms": 0.17160579383587965, "mean_env_wait_ms": 0.06756605359116147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.0025184154510498047, "ViewRequirementAgentConnector_ms": 0.06795847415924072}, "num_episodes": 13, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.49518489217155, "num_env_steps_trained_throughput_per_sec": 501.49518489217155, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 8093.43, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8093.393, "sample_time_ms": 781.308, "learn_time_ms": 7299.566, "learn_throughput": 547.978, "synch_weights_time_ms": 11.963}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 192, "trial_id": "fa423_00000", "date": "2024-08-10_11-25-03", "timestamp": 1723303503, "time_this_iter_s": 7.982204914093018, "time_total_s": 1567.6203048229218, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a5e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1567.6203048229218, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 25.175, "ram_util_percent": 81.67500000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.135075903884948, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.000996967093655, "policy_loss": -0.005718585584317605, "vf_loss": 4.006715567023666, "vf_explained_var": -0.20956629899443774, "kl": 0.008707112373909196, "entropy": 0.9613712833671973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5910998208448293, "cur_kl_coeff": 1.3763940707178787e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.469304549197356, "policy_loss": -0.00606981472398426, "vf_loss": 5.475374357402325, "vf_explained_var": 0.11518787145614624, "kl": 0.01244956567308814, "entropy": 0.8384446026136477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -1.1102230246251565e-16, "episode_reward_mean": 0.0, "episode_len_mean": 362.66, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36266, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 45.1751657246219}, "policy_reward_mean": {"agent_policy": 15.920035944281546, "adversary_policy": -7.960017972140772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 225, 400, 400, 400, 108, 338, 400, 400, 381, 400, 400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [65.21686624159477, 22.930485677666447, 15.058265660480476, 20.450404888382423, -22.826124928864786, 2.284090563855568, -16.212670295075906, 71.93838607226897, -5.141177747012399, -6.211633178484881, 54.396220770450476, -11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252, 64.98682369812407, -5.5088230603666215, 43.00226168974317, -27.96744308496126, -24.29186840936769, -18.430879124517304, -12.285293718358215, -19.968653210661696, 26.350465853876265, 8.365194562356926], "policy_adversary_policy_reward": [-48.74222368219247, -16.47464255940234, 25.174337869569285, -48.10482354723573, -19.810040922215514, 4.7517752617350375, -23.088110589249542, 2.6377057008671323, 29.03959557611141, -6.2134706472466235, -28.031550558197775, 25.747459994342208, 45.1751657246219, -28.96249542954599, -40.70551441910072, -31.232871653168196, 25.428359816345406, -20.287182069333014, -24.723260613727625, 30.934893792212495, -17.14808320593751, -37.248137564512966, 2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525, -53.2202775057887, -11.766546192335433, -3.5304511803783925, 9.039274240745018, -27.57831237348935, -15.423949316253825, 19.545661452967757, 8.421781631993497, 16.819191986763066, 7.472676422604636, 10.961536008182815, 7.469343116334521, -6.467100883457192, 18.752394601815407, 2.058533300023054, 17.91011991063864, -20.600256037485778, -5.750209816390484, 2.6364010993367373, -11.001595661693663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39768638396216, "mean_inference_ms": 1.032422889063969, "mean_action_processing_ms": 0.17158965874244184, "mean_env_wait_ms": 0.06755807343546097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036907196044921875, "StateBufferConnector_ms": 0.002554655075073242, "ViewRequirementAgentConnector_ms": 0.0683128833770752}, "num_episodes": 10, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -1.1102230246251565e-16, "episode_return_mean": 0.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.7841362288514, "num_env_steps_trained_throughput_per_sec": 496.7841362288514, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 2316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2316000, "timers": {"training_iteration_time_ms": 8079.639, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8079.605, "sample_time_ms": 781.588, "learn_time_ms": 7285.313, "learn_throughput": 549.05, "synch_weights_time_ms": 12.125}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "done": false, "training_iteration": 193, "trial_id": "fa423_00000", "date": "2024-08-10_11-25-11", "timestamp": 1723303511, "time_this_iter_s": 8.057630062103271, "time_total_s": 1575.677934885025, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a5ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1575.677934885025, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 25.88181818181818, "ram_util_percent": 80.85454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0415972984657085, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.84763141296528, "policy_loss": -0.0096156707958678, "vf_loss": 3.857247075454268, "vf_explained_var": 0.01269954310523139, "kl": 0.015663194095135884, "entropy": 0.9849183055774244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4429978963608545, "cur_kl_coeff": 1.3763940707178787e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.543033761282762, "policy_loss": -0.004428985652824243, "vf_loss": 5.5474627633889515, "vf_explained_var": 0.23673630468547344, "kl": 0.010659975385910358, "entropy": 1.0143058987955251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 364.62, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36462, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 42.44085719766786}, "policy_reward_mean": {"agent_policy": 15.617536824377694, "adversary_policy": -7.808768412188847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 227, 400, 400, 400, 80, 400, 400, 194, 400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-11.29214621403219, 18.354295195833238, -34.43535578056313, 27.526521022277713, 18.432636521927662, 23.78137504137198, -5.268528099836554, 53.45059087764028, 79.18129524160955, 4.332986178317404, -13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252, 64.98682369812407, -5.5088230603666215, 43.00226168974317, -27.96744308496126, -24.29186840936769, -18.430879124517304, -12.285293718358215, -19.968653210661696, 26.350465853876265, 8.365194562356926, 35.57991200237555, 46.215327708248914, -23.629930738264413, -14.198397323360025, -30.31409830006, 10.140698192646585, -17.577205614392515, 73.44565904390035, 22.0270867887217, 55.14889591075863, 14.795254064301677], "policy_adversary_policy_reward": [2.7881672439687364, 8.50397897006345, 20.314035282098104, -38.668330477931335, 38.48553560038303, -4.050179819819903, -13.181237322320236, -14.345283699957477, -11.757807210859376, -6.674829311068301, -6.479008028628229, -17.30236701274375, 13.810954883939939, -8.542426784103384, -26.546174298060677, -26.9044165795796, -36.55636119047715, -42.62493405113245, -30.946896845895377, 26.613910667577976, 15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525, -53.2202775057887, -11.766546192335433, -3.5304511803783925, 9.039274240745018, -27.57831237348935, -15.423949316253825, 19.545661452967757, 8.421781631993497, 16.819191986763066, 7.472676422604636, 10.961536008182815, 7.469343116334521, -6.467100883457192, 18.752394601815407, 2.058533300023054, 17.91011991063864, -20.600256037485778, -5.750209816390484, 2.6364010993367373, -11.001595661693663, 3.0429152207182497, -38.6228272230938, -22.0272942307762, -24.18803347747272, 25.32644154540732, -1.6965108071429071, -15.274278277908657, 29.472675601268676, 40.218263093179125, -9.90416479311913, -6.51828421511917, -3.6224139775274153, 24.264669677636704, -6.687464063244189, -31.857873420417935, -41.58778562348254, -8.909581399341096, -13.117505389380604, -41.29950025577373, -13.849395654984903, -5.187904179262578, -9.607349885039099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39758628130133433, "mean_inference_ms": 1.0324386295429695, "mean_action_processing_ms": 0.17160686318165677, "mean_env_wait_ms": 0.06753774624722665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003636598587036133, "StateBufferConnector_ms": 0.002522587776184082, "ViewRequirementAgentConnector_ms": 0.06808865070343018}, "num_episodes": 11, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.0723368207068, "num_env_steps_trained_throughput_per_sec": 468.0723368207068, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 2328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2328000, "timers": {"training_iteration_time_ms": 8141.247, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8141.213, "sample_time_ms": 784.422, "learn_time_ms": 7344.402, "learn_throughput": 544.633, "synch_weights_time_ms": 11.785}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "done": false, "training_iteration": 194, "trial_id": "fa423_00000", "date": "2024-08-10_11-25-20", "timestamp": 1723303520, "time_this_iter_s": 8.551402807235718, "time_total_s": 1584.2293376922607, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a5eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1584.2293376922607, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 29.353846153846156, "ram_util_percent": 81.15384615384617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.857930234248045, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.008980362503617, "policy_loss": -0.008614176734431928, "vf_loss": 4.017594541065277, "vf_explained_var": 0.001053154468536377, "kl": 0.012991326622557735, "entropy": 1.013403164205097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3429712754363816, "cur_kl_coeff": 1.3763940707178787e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.997104096909364, "policy_loss": 0.00011059730580503432, "vf_loss": 5.996993498504162, "vf_explained_var": 0.2839867615451415, "kl": 0.003769733707695222, "entropy": 0.82579235881567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -2.220446049250313e-18, "episode_len_mean": 371.61, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37161, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 42.44085719766786}, "policy_reward_mean": {"agent_policy": 15.810034258924018, "adversary_policy": -7.905017129462007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 152, 339, 400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-13.598809405985097, -14.822125738641306, 17.20446559049484, -19.95601220873757, 58.475339266433735, -41.448943843704946, 61.743013884289724, 40.10381356528838, -26.572107863663636, -37.22564021042679, -32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252, 64.98682369812407, -5.5088230603666215, 43.00226168974317, -27.96744308496126, -24.29186840936769, -18.430879124517304, -12.285293718358215, -19.968653210661696, 26.350465853876265, 8.365194562356926, 35.57991200237555, 46.215327708248914, -23.629930738264413, -14.198397323360025, -30.31409830006, 10.140698192646585, -17.577205614392515, 73.44565904390035, 22.0270867887217, 55.14889591075863, 14.795254064301677, 6.828526408123249, 15.956284496597998, 24.579813051859702, 25.400714198056757, 39.771366255744766, 34.3070891006927, 17.43802102285637, -0.5022723215573066, 1.0903997409225603, 28.443471485881137], "policy_adversary_policy_reward": [15.088337643290995, -1.4895282373059047, 9.727160638873885, 5.094965099767425, -7.367974876842489, -9.836490713652353, 5.128859663109134, 14.827152545628417, -24.466160237012204, -34.00917902942153, 10.127941982828602, 31.321001860876358, -35.06652139243095, -26.676492491858774, -17.021320484611373, -23.082493080677004, 17.042169496030365, 9.529938367633271, 29.652491500875776, 7.573148709551011, 19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525, -53.2202775057887, -11.766546192335433, -3.5304511803783925, 9.039274240745018, -27.57831237348935, -15.423949316253825, 19.545661452967757, 8.421781631993497, 16.819191986763066, 7.472676422604636, 10.961536008182815, 7.469343116334521, -6.467100883457192, 18.752394601815407, 2.058533300023054, 17.91011991063864, -20.600256037485778, -5.750209816390484, 2.6364010993367373, -11.001595661693663, 3.0429152207182497, -38.6228272230938, -22.0272942307762, -24.18803347747272, 25.32644154540732, -1.6965108071429071, -15.274278277908657, 29.472675601268676, 40.218263093179125, -9.90416479311913, -6.51828421511917, -3.6224139775274153, 24.264669677636704, -6.687464063244189, -31.857873420417935, -41.58778562348254, -8.909581399341096, -13.117505389380604, -41.29950025577373, -13.849395654984903, -5.187904179262578, -9.607349885039099, -1.1669194259972144, -5.661606982126035, -14.380634155258544, -1.575650341339454, -21.505981368213128, -3.073831683646585, -3.163443250849731, -22.237270947207026, -18.697701102193793, -21.073665153550973, -10.603308169986114, -23.703780930706586, -9.514322011421452, -7.923699011434916, 5.950320662789618, -5.448048341232305, 7.261658372062374, -8.352058112984938, -4.531054445727035, -23.91241704015411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39758790705387703, "mean_inference_ms": 1.0322530076709193, "mean_action_processing_ms": 0.1714889104725071, "mean_env_wait_ms": 0.06754091652333745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036630630493164062, "StateBufferConnector_ms": 0.002515435218811035, "ViewRequirementAgentConnector_ms": 0.06797909736633301}, "num_episodes": 10, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -2.220446049250313e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.38581552659707, "num_env_steps_trained_throughput_per_sec": 494.38581552659707, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 2340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2340000, "timers": {"training_iteration_time_ms": 8145.954, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8145.92, "sample_time_ms": 768.917, "learn_time_ms": 7364.507, "learn_throughput": 543.146, "synch_weights_time_ms": 11.895}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "done": false, "training_iteration": 195, "trial_id": "fa423_00000", "date": "2024-08-10_11-25-28", "timestamp": 1723303528, "time_this_iter_s": 8.096071004867554, "time_total_s": 1592.3254086971283, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a5ee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1592.3254086971283, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 24.5, "ram_util_percent": 81.82727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.772538392001359, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.214304007171954, "policy_loss": -0.007271661926504402, "vf_loss": 4.221575678845562, "vf_explained_var": -0.03955173218061053, "kl": 0.012155137853612538, "entropy": 1.0418398662218973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5213631821175415, "cur_kl_coeff": 6.881970353589393e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.220739521086216, "policy_loss": -0.0042500912177880915, "vf_loss": 6.224989598989486, "vf_explained_var": 0.22523370559016864, "kl": 0.008611406610814372, "entropy": 0.725902656155328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -4.440892098500626e-18, "episode_len_mean": 370.8, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37080, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 42.44085719766786}, "policy_reward_mean": {"agent_policy": 16.12654446387496, "adversary_policy": -8.063272231937479}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16], "episode_lengths": [400, 251, 151, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10], "policy_agent_policy_reward": [-32.77678220108377, -21.150089654250813, -18.125616288312145, -39.80159223248582, 88.14408950050051, 76.97602244061515, 20.15155399738934, 76.6138511020767, 49.22430768410415, -32.86131361165933, 49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252, 64.98682369812407, -5.5088230603666215, 43.00226168974317, -27.96744308496126, -24.29186840936769, -18.430879124517304, -12.285293718358215, -19.968653210661696, 26.350465853876265, 8.365194562356926, 35.57991200237555, 46.215327708248914, -23.629930738264413, -14.198397323360025, -30.31409830006, 10.140698192646585, -17.577205614392515, 73.44565904390035, 22.0270867887217, 55.14889591075863, 14.795254064301677, 6.828526408123249, 15.956284496597998, 24.579813051859702, 25.400714198056757, 39.771366255744766, 34.3070891006927, 17.43802102285637, -0.5022723215573066, 1.0903997409225603, 28.443471485881137, 28.315778626484512, 14.445425204466854, 15.332912083734119, -10.036446451572122, -11.684294556488172, -2.952558561056854, 5.114922930459137, 10.829657799746148, 21.7469988313416, -15.558382376673666], "policy_adversary_policy_reward": [19.409650862929645, 13.367131338154117, 9.708871417274981, 11.441218236975839, -10.57403192932733, 28.699648217639485, -2.639264965182072, 42.44085719766786, -45.62620958836393, -42.51787991213657, -29.487735139443338, -47.48828730117181, -11.824913134705653, -8.32664086268365, -25.67133058881965, -50.942520513257044, -32.43537610097898, -16.78893158312517, 21.64513364385862, 11.21617996780073, -25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525, -53.2202775057887, -11.766546192335433, -3.5304511803783925, 9.039274240745018, -27.57831237348935, -15.423949316253825, 19.545661452967757, 8.421781631993497, 16.819191986763066, 7.472676422604636, 10.961536008182815, 7.469343116334521, -6.467100883457192, 18.752394601815407, 2.058533300023054, 17.91011991063864, -20.600256037485778, -5.750209816390484, 2.6364010993367373, -11.001595661693663, 3.0429152207182497, -38.6228272230938, -22.0272942307762, -24.18803347747272, 25.32644154540732, -1.6965108071429071, -15.274278277908657, 29.472675601268676, 40.218263093179125, -9.90416479311913, -6.51828421511917, -3.6224139775274153, 24.264669677636704, -6.687464063244189, -31.857873420417935, -41.58778562348254, -8.909581399341096, -13.117505389380604, -41.29950025577373, -13.849395654984903, -5.187904179262578, -9.607349885039099, -1.1669194259972144, -5.661606982126035, -14.380634155258544, -1.575650341339454, -21.505981368213128, -3.073831683646585, -3.163443250849731, -22.237270947207026, -18.697701102193793, -21.073665153550973, -10.603308169986114, -23.703780930706586, -9.514322011421452, -7.923699011434916, 5.950320662789618, -5.448048341232305, 7.261658372062374, -8.352058112984938, -4.531054445727035, -23.91241704015411, -4.056259024257894, -24.259519602226614, -5.212069661587542, -9.233355542879313, -3.4004053621575707, -11.932506721576548, 9.343572985096639, 0.6928734664754828, -1.6859065817532635, 13.370201138241448, -3.9213304882497866, 6.873889049306641, -16.496416244979525, 11.381493314520387, 7.6978021997693205, -18.527459999515457, -8.082890367136986, -13.664108464204627, 7.977543431717116, 7.580838944956551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39753832394161587, "mean_inference_ms": 1.0320530652438287, "mean_action_processing_ms": 0.17144322698524614, "mean_env_wait_ms": 0.06754763655148072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035659074783325195, "StateBufferConnector_ms": 0.002506256103515625, "ViewRequirementAgentConnector_ms": 0.06755554676055908}, "num_episodes": 10, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.503998577625, "num_env_steps_trained_throughput_per_sec": 485.503998577625, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 8129.093, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8129.057, "sample_time_ms": 769.09, "learn_time_ms": 7347.255, "learn_throughput": 544.421, "synch_weights_time_ms": 12.05}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 196, "trial_id": "fa423_00000", "date": "2024-08-10_11-25-37", "timestamp": 1723303537, "time_this_iter_s": 8.245291948318481, "time_total_s": 1600.5707006454468, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a99d8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1600.5707006454468, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 26.591666666666665, "ram_util_percent": 81.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.005241676171621, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.882536152430943, "policy_loss": -0.006391856642982001, "vf_loss": 3.8889280075749393, "vf_explained_var": 0.01995866645580877, "kl": 0.012856500289618648, "entropy": 1.002807173558644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3996181645741066, "cur_kl_coeff": 6.881970353589393e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.200046440958976, "policy_loss": -0.006320623724604957, "vf_loss": 6.206367067495981, "vf_explained_var": -0.03219665301342805, "kl": 0.011414381634604827, "entropy": 1.0036609796186289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -3.3306690738754695e-18, "episode_len_mean": 373.92, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37392, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 42.42617997610138}, "policy_reward_mean": {"agent_policy": 14.91026339950695, "adversary_policy": -7.455131699753476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 314, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [49.458564149143356, 65.72695320240078, -47.39477537381795, 24.942889774893025, 20.68413033684462, 16.9190207342621, 68.42476965034588, 18.334081511269176, 67.11023067940634, 75.93786031466632, -2.651020753804518, 44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252, 64.98682369812407, -5.5088230603666215, 43.00226168974317, -27.96744308496126, -24.29186840936769, -18.430879124517304, -12.285293718358215, -19.968653210661696, 26.350465853876265, 8.365194562356926, 35.57991200237555, 46.215327708248914, -23.629930738264413, -14.198397323360025, -30.31409830006, 10.140698192646585, -17.577205614392515, 73.44565904390035, 22.0270867887217, 55.14889591075863, 14.795254064301677, 6.828526408123249, 15.956284496597998, 24.579813051859702, 25.400714198056757, 39.771366255744766, 34.3070891006927, 17.43802102285637, -0.5022723215573066, 1.0903997409225603, 28.443471485881137, 28.315778626484512, 14.445425204466854, 15.332912083734119, -10.036446451572122, -11.684294556488172, -2.952558561056854, 5.114922930459137, 10.829657799746148, 21.7469988313416, -15.558382376673666, 4.108981922884698, -44.281682533101005, 32.73590880801149, -10.876182632434283, 4.352697071414305, 5.475236996951843, 37.42422492930015, 9.348689861059075, 1.1085426383998387, 5.3699072376073005], "policy_adversary_policy_reward": [-25.34458496996194, -24.11397917918141, -43.140762760000584, -22.586190442400188, 24.13056022492425, 23.26421514889369, -20.76826347322614, -4.174626301666883, -22.004762922077504, 1.3206325852328824, -24.064534512061826, 7.145513777799721, -23.674521189456847, -44.75024846088903, -1.1140799372465082, -17.220001574022668, -33.128554464508525, -33.981676214897796, -38.76863042264798, -37.16922989201833, 6.40932586760851, -3.758305113803992, -34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525, -53.2202775057887, -11.766546192335433, -3.5304511803783925, 9.039274240745018, -27.57831237348935, -15.423949316253825, 19.545661452967757, 8.421781631993497, 16.819191986763066, 7.472676422604636, 10.961536008182815, 7.469343116334521, -6.467100883457192, 18.752394601815407, 2.058533300023054, 17.91011991063864, -20.600256037485778, -5.750209816390484, 2.6364010993367373, -11.001595661693663, 3.0429152207182497, -38.6228272230938, -22.0272942307762, -24.18803347747272, 25.32644154540732, -1.6965108071429071, -15.274278277908657, 29.472675601268676, 40.218263093179125, -9.90416479311913, -6.51828421511917, -3.6224139775274153, 24.264669677636704, -6.687464063244189, -31.857873420417935, -41.58778562348254, -8.909581399341096, -13.117505389380604, -41.29950025577373, -13.849395654984903, -5.187904179262578, -9.607349885039099, -1.1669194259972144, -5.661606982126035, -14.380634155258544, -1.575650341339454, -21.505981368213128, -3.073831683646585, -3.163443250849731, -22.237270947207026, -18.697701102193793, -21.073665153550973, -10.603308169986114, -23.703780930706586, -9.514322011421452, -7.923699011434916, 5.950320662789618, -5.448048341232305, 7.261658372062374, -8.352058112984938, -4.531054445727035, -23.91241704015411, -4.056259024257894, -24.259519602226614, -5.212069661587542, -9.233355542879313, -3.4004053621575707, -11.932506721576548, 9.343572985096639, 0.6928734664754828, -1.6859065817532635, 13.370201138241448, -3.9213304882497866, 6.873889049306641, -16.496416244979525, 11.381493314520387, 7.6978021997693205, -18.527459999515457, -8.082890367136986, -13.664108464204627, 7.977543431717116, 7.580838944956551, -16.406224296160815, 12.297242373276116, 14.098881912488757, 30.18280062061226, -14.084952428903957, -18.65095637910753, -12.268400182962086, 23.14458281539637, 10.425885221424476, -14.77858229283878, 3.8786041041958725, -9.353841101147715, -31.02432412508162, -6.399900804218525, -12.656178688653966, 3.3074888275948915, 13.76207461738791, -14.87061725578775, -5.2969301442687815, -0.07297709333852076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39741947940887784, "mean_inference_ms": 1.0318871311270705, "mean_action_processing_ms": 0.1714505743840924, "mean_env_wait_ms": 0.0675269049542611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035178661346435547, "StateBufferConnector_ms": 0.0025163888931274414, "ViewRequirementAgentConnector_ms": 0.06843018531799316}, "num_episodes": 10, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 478.3015481809124, "num_env_steps_trained_throughput_per_sec": 478.3015481809124, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 2364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2364000, "timers": {"training_iteration_time_ms": 8157.256, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8157.22, "sample_time_ms": 772.681, "learn_time_ms": 7371.824, "learn_throughput": 542.607, "synch_weights_time_ms": 12.066}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "done": false, "training_iteration": 197, "trial_id": "fa423_00000", "date": "2024-08-10_11-25-45", "timestamp": 1723303545, "time_this_iter_s": 8.368342638015747, "time_total_s": 1608.9390432834625, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a561f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1608.9390432834625, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 24.47692307692307, "ram_util_percent": 81.75384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8749792401752776, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.816866772263138, "policy_loss": -0.003256182439093079, "vf_loss": 4.82012295937412, "vf_explained_var": -0.10594309628325164, "kl": 0.012687876735712023, "entropy": 0.8365685817741212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0947353158146145, "cur_kl_coeff": 6.881970353589393e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.781237623592218, "policy_loss": -0.003616312755912077, "vf_loss": 5.7848539253075915, "vf_explained_var": 0.24586988495041925, "kl": 0.0059286284793368315, "entropy": 0.7570033587515355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "env_runners": {"episode_reward_max": 1.1102230246251565e-16, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -3.3306690738754695e-18, "episode_len_mean": 373.95, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37395, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 42.42617997610138}, "policy_reward_mean": {"agent_policy": 10.866547724560592, "adversary_policy": -5.433273862280296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 314, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [44.9482918315831, -44.664313283498764, 53.22679134060488, 56.935017607072304, 38.99172127176501, 50.50445145322714, 70.26045374263288, 13.910231309855487, 57.0760717480816, 39.693221536738164, 48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252, 64.98682369812407, -5.5088230603666215, 43.00226168974317, -27.96744308496126, -24.29186840936769, -18.430879124517304, -12.285293718358215, -19.968653210661696, 26.350465853876265, 8.365194562356926, 35.57991200237555, 46.215327708248914, -23.629930738264413, -14.198397323360025, -30.31409830006, 10.140698192646585, -17.577205614392515, 73.44565904390035, 22.0270867887217, 55.14889591075863, 14.795254064301677, 6.828526408123249, 15.956284496597998, 24.579813051859702, 25.400714198056757, 39.771366255744766, 34.3070891006927, 17.43802102285637, -0.5022723215573066, 1.0903997409225603, 28.443471485881137, 28.315778626484512, 14.445425204466854, 15.332912083734119, -10.036446451572122, -11.684294556488172, -2.952558561056854, 5.114922930459137, 10.829657799746148, 21.7469988313416, -15.558382376673666, 4.108981922884698, -44.281682533101005, 32.73590880801149, -10.876182632434283, 4.352697071414305, 5.475236996951843, 37.42422492930015, 9.348689861059075, 1.1085426383998387, 5.3699072376073005, 23.19927524112323, -4.273969131628497, -13.550017248446554, -23.76353550484058, -12.399562639799854, -41.30871680432419, 2.464089321211265, -1.3886542354802565, -4.3376825728782755, -2.914755757725782, 31.39466606376249], "policy_adversary_policy_reward": [-34.53442600048954, -10.41386583109356, 25.760441987857252, 18.90387129564151, -26.517231753727607, -26.70955958687727, -19.641516617818553, -37.293500989253786, -22.581386377728137, -16.41033489403688, -31.02452338533191, -19.479928067895223, -47.29557886950812, -22.964874873124764, -8.61669242058364, -5.293538889271847, -32.83970315513084, -24.23636859295076, -5.743213762577604, -33.95000777416055, -24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525, -53.2202775057887, -11.766546192335433, -3.5304511803783925, 9.039274240745018, -27.57831237348935, -15.423949316253825, 19.545661452967757, 8.421781631993497, 16.819191986763066, 7.472676422604636, 10.961536008182815, 7.469343116334521, -6.467100883457192, 18.752394601815407, 2.058533300023054, 17.91011991063864, -20.600256037485778, -5.750209816390484, 2.6364010993367373, -11.001595661693663, 3.0429152207182497, -38.6228272230938, -22.0272942307762, -24.18803347747272, 25.32644154540732, -1.6965108071429071, -15.274278277908657, 29.472675601268676, 40.218263093179125, -9.90416479311913, -6.51828421511917, -3.6224139775274153, 24.264669677636704, -6.687464063244189, -31.857873420417935, -41.58778562348254, -8.909581399341096, -13.117505389380604, -41.29950025577373, -13.849395654984903, -5.187904179262578, -9.607349885039099, -1.1669194259972144, -5.661606982126035, -14.380634155258544, -1.575650341339454, -21.505981368213128, -3.073831683646585, -3.163443250849731, -22.237270947207026, -18.697701102193793, -21.073665153550973, -10.603308169986114, -23.703780930706586, -9.514322011421452, -7.923699011434916, 5.950320662789618, -5.448048341232305, 7.261658372062374, -8.352058112984938, -4.531054445727035, -23.91241704015411, -4.056259024257894, -24.259519602226614, -5.212069661587542, -9.233355542879313, -3.4004053621575707, -11.932506721576548, 9.343572985096639, 0.6928734664754828, -1.6859065817532635, 13.370201138241448, -3.9213304882497866, 6.873889049306641, -16.496416244979525, 11.381493314520387, 7.6978021997693205, -18.527459999515457, -8.082890367136986, -13.664108464204627, 7.977543431717116, 7.580838944956551, -16.406224296160815, 12.297242373276116, 14.098881912488757, 30.18280062061226, -14.084952428903957, -18.65095637910753, -12.268400182962086, 23.14458281539637, 10.425885221424476, -14.77858229283878, 3.8786041041958725, -9.353841101147715, -31.02432412508162, -6.399900804218525, -12.656178688653966, 3.3074888275948915, 13.76207461738791, -14.87061725578775, -5.2969301442687815, -0.07297709333852076, -23.101398630402425, -0.09787661072082621, -10.043124457457264, 14.31709358908576, 2.376860025011407, 11.17315722343514, 23.518010464048675, 0.24552504079190385, 9.921016165871478, 2.4785464739283753, 33.12586151458265, 8.182855289741546, -6.069864487075417, 3.605775165864152, 9.556489931431958, -8.16783569595172, -1.0430269034197366, 5.380709476298012, -8.274893377253452, 11.18964913497923, -16.762926728246605, -14.631739335515892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.397400823114167, "mean_inference_ms": 1.0321191646283168, "mean_action_processing_ms": 0.17139346870023794, "mean_env_wait_ms": 0.06755013232700909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516554832458496, "StateBufferConnector_ms": 0.002529740333557129, "ViewRequirementAgentConnector_ms": 0.06922626495361328}, "num_episodes": 11, "episode_return_max": 1.1102230246251565e-16, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -3.3306690738754695e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.439395712072, "num_env_steps_trained_throughput_per_sec": 473.439395712072, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 2376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2376000, "timers": {"training_iteration_time_ms": 8203.009, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8202.973, "sample_time_ms": 773.912, "learn_time_ms": 7416.426, "learn_throughput": 539.343, "synch_weights_time_ms": 12.018}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "done": false, "training_iteration": 198, "trial_id": "fa423_00000", "date": "2024-08-10_11-25-54", "timestamp": 1723303554, "time_this_iter_s": 8.455525159835815, "time_total_s": 1617.3945684432983, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a56670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1617.3945684432983, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 26.15833333333333, "ram_util_percent": 81.49166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8366825865690037, "cur_kl_coeff": 7.638009265065195e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.008670153188958, "policy_loss": -0.009803416577805937, "vf_loss": 4.018473562487849, "vf_explained_var": 0.2031542148539629, "kl": 0.026818206033662948, "entropy": 0.946833840186003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.302143954175214, "cur_kl_coeff": 6.881970353589393e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.848814162611961, "policy_loss": -0.005712346772149128, "vf_loss": 5.8545264894763624, "vf_explained_var": 0.30570510079463326, "kl": 0.010170903025668565, "entropy": 0.929760150425136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -4.440892098500626e-18, "episode_len_mean": 377.65, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37765, "policy_reward_min": {"agent_policy": -82.09388915976417, "adversary_policy": -53.27819534002476}, "policy_reward_max": {"agent_policy": 93.22021488731289, "adversary_policy": 42.42617997610138}, "policy_reward_mean": {"agent_policy": 8.153142744377515, "adversary_policy": -4.076571372188758}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 57, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 314, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [48.139758834762354, -82.09388915976417, 25.002104697309527, 64.2366464610082, 21.85958532223254, 44.12962141488524, 58.72477287172335, 13.54788632825479, 51.94281898605226, -0.3345404403573582, 93.22021488731289, 29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252, 64.98682369812407, -5.5088230603666215, 43.00226168974317, -27.96744308496126, -24.29186840936769, -18.430879124517304, -12.285293718358215, -19.968653210661696, 26.350465853876265, 8.365194562356926, 35.57991200237555, 46.215327708248914, -23.629930738264413, -14.198397323360025, -30.31409830006, 10.140698192646585, -17.577205614392515, 73.44565904390035, 22.0270867887217, 55.14889591075863, 14.795254064301677, 6.828526408123249, 15.956284496597998, 24.579813051859702, 25.400714198056757, 39.771366255744766, 34.3070891006927, 17.43802102285637, -0.5022723215573066, 1.0903997409225603, 28.443471485881137, 28.315778626484512, 14.445425204466854, 15.332912083734119, -10.036446451572122, -11.684294556488172, -2.952558561056854, 5.114922930459137, 10.829657799746148, 21.7469988313416, -15.558382376673666, 4.108981922884698, -44.281682533101005, 32.73590880801149, -10.876182632434283, 4.352697071414305, 5.475236996951843, 37.42422492930015, 9.348689861059075, 1.1085426383998387, 5.3699072376073005, 23.19927524112323, -4.273969131628497, -13.550017248446554, -23.76353550484058, -12.399562639799854, -41.30871680432419, 2.464089321211265, -1.3886542354802565, -4.3376825728782755, -2.914755757725782, 31.39466606376249, 35.750980694240184, 22.17377669812679, 31.301306220427897, 21.210631272080125, 7.4598673622916145, -13.925357042300604, -6.427881637373627, -16.43207481037076, 47.709936168114204, -19.27974438548148], "policy_adversary_policy_reward": [-24.378364402463667, -23.761394432298683, 42.42617997610138, 39.667709183662794, 2.3367513005474976, -27.338855997857024, -35.348973428639276, -28.88767303236892, -4.597524063735079, -17.26206125849746, -8.830277939320005, -35.29934347556524, -24.53936800565704, -34.18540486606632, 0.5453374312698323, -14.093223759524623, -17.927824915618157, -34.01499407043409, -1.759055804309142, 2.0935962446664966, -53.27819534002476, -39.94201954728814, -23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525, -53.2202775057887, -11.766546192335433, -3.5304511803783925, 9.039274240745018, -27.57831237348935, -15.423949316253825, 19.545661452967757, 8.421781631993497, 16.819191986763066, 7.472676422604636, 10.961536008182815, 7.469343116334521, -6.467100883457192, 18.752394601815407, 2.058533300023054, 17.91011991063864, -20.600256037485778, -5.750209816390484, 2.6364010993367373, -11.001595661693663, 3.0429152207182497, -38.6228272230938, -22.0272942307762, -24.18803347747272, 25.32644154540732, -1.6965108071429071, -15.274278277908657, 29.472675601268676, 40.218263093179125, -9.90416479311913, -6.51828421511917, -3.6224139775274153, 24.264669677636704, -6.687464063244189, -31.857873420417935, -41.58778562348254, -8.909581399341096, -13.117505389380604, -41.29950025577373, -13.849395654984903, -5.187904179262578, -9.607349885039099, -1.1669194259972144, -5.661606982126035, -14.380634155258544, -1.575650341339454, -21.505981368213128, -3.073831683646585, -3.163443250849731, -22.237270947207026, -18.697701102193793, -21.073665153550973, -10.603308169986114, -23.703780930706586, -9.514322011421452, -7.923699011434916, 5.950320662789618, -5.448048341232305, 7.261658372062374, -8.352058112984938, -4.531054445727035, -23.91241704015411, -4.056259024257894, -24.259519602226614, -5.212069661587542, -9.233355542879313, -3.4004053621575707, -11.932506721576548, 9.343572985096639, 0.6928734664754828, -1.6859065817532635, 13.370201138241448, -3.9213304882497866, 6.873889049306641, -16.496416244979525, 11.381493314520387, 7.6978021997693205, -18.527459999515457, -8.082890367136986, -13.664108464204627, 7.977543431717116, 7.580838944956551, -16.406224296160815, 12.297242373276116, 14.098881912488757, 30.18280062061226, -14.084952428903957, -18.65095637910753, -12.268400182962086, 23.14458281539637, 10.425885221424476, -14.77858229283878, 3.8786041041958725, -9.353841101147715, -31.02432412508162, -6.399900804218525, -12.656178688653966, 3.3074888275948915, 13.76207461738791, -14.87061725578775, -5.2969301442687815, -0.07297709333852076, -23.101398630402425, -0.09787661072082621, -10.043124457457264, 14.31709358908576, 2.376860025011407, 11.17315722343514, 23.518010464048675, 0.24552504079190385, 9.921016165871478, 2.4785464739283753, 33.12586151458265, 8.182855289741546, -6.069864487075417, 3.605775165864152, 9.556489931431958, -8.16783569595172, -1.0430269034197366, 5.380709476298012, -8.274893377253452, 11.18964913497923, -16.762926728246605, -14.631739335515892, -47.481615445012324, 11.730634750772122, -15.968135171237869, -6.205641526888936, -19.756002957774527, -11.54530326265337, -2.5619073435483095, -18.648723928531815, -14.834915394673814, 7.3750480323821925, 14.648189564575553, -0.722832522274949, 8.220395024753927, -1.7925133873802999, 14.832490664985826, 1.5995841453849344, -28.712988034880457, -18.996948133233765, 0.43012320593371456, 18.849621179547764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39730129868233605, "mean_inference_ms": 1.0319049491097871, "mean_action_processing_ms": 0.17145640230501372, "mean_env_wait_ms": 0.06752879622280504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035730600357055664, "StateBufferConnector_ms": 0.0025647878646850586, "ViewRequirementAgentConnector_ms": 0.07043659687042236}, "num_episodes": 10, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.81811237139163, "num_env_steps_trained_throughput_per_sec": 481.81811237139163, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 2388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2388000, "timers": {"training_iteration_time_ms": 8209.75, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8209.714, "sample_time_ms": 776.909, "learn_time_ms": 7420.25, "learn_throughput": 539.065, "synch_weights_time_ms": 11.939}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "done": false, "training_iteration": 199, "trial_id": "fa423_00000", "date": "2024-08-10_11-26-02", "timestamp": 1723303562, "time_this_iter_s": 8.306906938552856, "time_total_s": 1625.7014753818512, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a569d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1625.7014753818512, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 25.016666666666662, "ram_util_percent": 81.50833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.889695991094781, "cur_kl_coeff": 1.1457013897597787e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.650650942893256, "policy_loss": -0.020544937345637847, "vf_loss": 4.67119588259036, "vf_explained_var": 0.014665977160135905, "kl": 0.05057580286029736, "entropy": 0.9741070491296274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2011190390835207, "cur_kl_coeff": 6.881970353589393e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.920229465266069, "policy_loss": -0.002672948138206266, "vf_loss": 6.922902419169744, "vf_explained_var": 0.3143240073695779, "kl": 0.004394443916905401, "entropy": 0.7219828967936337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 0.0, "episode_reward_min": -2.220446049250313e-16, "episode_reward_mean": -4.440892098500626e-18, "episode_len_mean": 377.26, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37726, "policy_reward_min": {"agent_policy": -54.88709957317687, "adversary_policy": -53.2202775057887}, "policy_reward_max": {"agent_policy": 73.44565904390035, "adversary_policy": 40.218263093179125}, "policy_reward_mean": {"agent_policy": 4.096042688909523, "adversary_policy": -2.048021344454763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.220446049250313e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 70, 400, 400, 400, 47, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 314, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18], "policy_agent_policy_reward": [29.771885579952638, -27.804730580594576, 23.97937757835438, 33.41311005308647, 23.27696970499078, 14.586583251650648, -6.438747340849286, 27.84066372220726, -25.240013148794667, -18.73579351383767, -54.88709957317687, -5.756346549124643, -35.51716699985566, -29.65096365742967, 15.669898645206572, -18.836368287258832, -30.913280121379252, 64.98682369812407, -5.5088230603666215, 43.00226168974317, -27.96744308496126, -24.29186840936769, -18.430879124517304, -12.285293718358215, -19.968653210661696, 26.350465853876265, 8.365194562356926, 35.57991200237555, 46.215327708248914, -23.629930738264413, -14.198397323360025, -30.31409830006, 10.140698192646585, -17.577205614392515, 73.44565904390035, 22.0270867887217, 55.14889591075863, 14.795254064301677, 6.828526408123249, 15.956284496597998, 24.579813051859702, 25.400714198056757, 39.771366255744766, 34.3070891006927, 17.43802102285637, -0.5022723215573066, 1.0903997409225603, 28.443471485881137, 28.315778626484512, 14.445425204466854, 15.332912083734119, -10.036446451572122, -11.684294556488172, -2.952558561056854, 5.114922930459137, 10.829657799746148, 21.7469988313416, -15.558382376673666, 4.108981922884698, -44.281682533101005, 32.73590880801149, -10.876182632434283, 4.352697071414305, 5.475236996951843, 37.42422492930015, 9.348689861059075, 1.1085426383998387, 5.3699072376073005, 23.19927524112323, -4.273969131628497, -13.550017248446554, -23.76353550484058, -12.399562639799854, -41.30871680432419, 2.464089321211265, -1.3886542354802565, -4.3376825728782755, -2.914755757725782, 31.39466606376249, 35.750980694240184, 22.17377669812679, 31.301306220427897, 21.210631272080125, 7.4598673622916145, -13.925357042300604, -6.427881637373627, -16.43207481037076, 47.709936168114204, -19.27974438548148, -16.25968699439518, 19.469900488992366, -36.595065815603334, -8.332158318360396, -33.59808648408205, -10.227124731014797, 11.145345011979, 2.698026749693092, 20.209000507666733, -6.9227349043221444, -8.922440853933063], "policy_adversary_policy_reward": [-23.932174728927116, -5.839710851025522, 15.087601292950016, 12.717129287644546, 11.991785757558155, -35.971163335912536, -8.03565000652634, -25.37746004656013, -30.49259143632667, 7.2156217313358795, 4.971746084761413, -19.55832933641206, 20.072783005542554, -13.634035664693268, -27.456769887895398, -0.38389383431186985, 10.441000143936245, 14.79901300485841, 7.750173761818189, 10.985619752019488, 28.64355697418881, 26.243542598988046, 5.0749326202748755, 0.6814139288497678, 19.690279807791917, 15.826887192063761, 7.047702140721986, 22.60326151670771, -21.700399125741974, 6.030500480535402, 4.0030017051519025, 14.833366582106922, 23.104196041649736, 7.809084079729525, -53.2202775057887, -11.766546192335433, -3.5304511803783925, 9.039274240745018, -27.57831237348935, -15.423949316253825, 19.545661452967757, 8.421781631993497, 16.819191986763066, 7.472676422604636, 10.961536008182815, 7.469343116334521, -6.467100883457192, 18.752394601815407, 2.058533300023054, 17.91011991063864, -20.600256037485778, -5.750209816390484, 2.6364010993367373, -11.001595661693663, 3.0429152207182497, -38.6228272230938, -22.0272942307762, -24.18803347747272, 25.32644154540732, -1.6965108071429071, -15.274278277908657, 29.472675601268676, 40.218263093179125, -9.90416479311913, -6.51828421511917, -3.6224139775274153, 24.264669677636704, -6.687464063244189, -31.857873420417935, -41.58778562348254, -8.909581399341096, -13.117505389380604, -41.29950025577373, -13.849395654984903, -5.187904179262578, -9.607349885039099, -1.1669194259972144, -5.661606982126035, -14.380634155258544, -1.575650341339454, -21.505981368213128, -3.073831683646585, -3.163443250849731, -22.237270947207026, -18.697701102193793, -21.073665153550973, -10.603308169986114, -23.703780930706586, -9.514322011421452, -7.923699011434916, 5.950320662789618, -5.448048341232305, 7.261658372062374, -8.352058112984938, -4.531054445727035, -23.91241704015411, -4.056259024257894, -24.259519602226614, -5.212069661587542, -9.233355542879313, -3.4004053621575707, -11.932506721576548, 9.343572985096639, 0.6928734664754828, -1.6859065817532635, 13.370201138241448, -3.9213304882497866, 6.873889049306641, -16.496416244979525, 11.381493314520387, 7.6978021997693205, -18.527459999515457, -8.082890367136986, -13.664108464204627, 7.977543431717116, 7.580838944956551, -16.406224296160815, 12.297242373276116, 14.098881912488757, 30.18280062061226, -14.084952428903957, -18.65095637910753, -12.268400182962086, 23.14458281539637, 10.425885221424476, -14.77858229283878, 3.8786041041958725, -9.353841101147715, -31.02432412508162, -6.399900804218525, -12.656178688653966, 3.3074888275948915, 13.76207461738791, -14.87061725578775, -5.2969301442687815, -0.07297709333852076, -23.101398630402425, -0.09787661072082621, -10.043124457457264, 14.31709358908576, 2.376860025011407, 11.17315722343514, 23.518010464048675, 0.24552504079190385, 9.921016165871478, 2.4785464739283753, 33.12586151458265, 8.182855289741546, -6.069864487075417, 3.605775165864152, 9.556489931431958, -8.16783569595172, -1.0430269034197366, 5.380709476298012, -8.274893377253452, 11.18964913497923, -16.762926728246605, -14.631739335515892, -47.481615445012324, 11.730634750772122, -15.968135171237869, -6.205641526888936, -19.756002957774527, -11.54530326265337, -2.5619073435483095, -18.648723928531815, -14.834915394673814, 7.3750480323821925, 14.648189564575553, -0.722832522274949, 8.220395024753927, -1.7925133873802999, 14.832490664985826, 1.5995841453849344, -28.712988034880457, -18.996948133233765, 0.43012320593371456, 18.849621179547764, 27.185472426059846, -10.925785431664664, -16.418698019312338, -3.0512024696800424, 23.29459637393726, 13.300469441666074, 16.878747775396796, -8.5465894570364, 26.154293191282562, 7.443793292799473, -0.7184938778490704, 10.945618608863867, -0.5289381399057476, -10.616406872073274, -4.6986805329319665, 2.000653783238869, -32.883615683363445, 12.674615175696687, 10.884434236308849, -3.9616993319867007, 22.638584976154135, -13.716144122221067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39725112948804997, "mean_inference_ms": 1.03169368152767, "mean_action_processing_ms": 0.17141220416096078, "mean_env_wait_ms": 0.06753507367360205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035685300827026367, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06952071189880371}, "num_episodes": 11, "episode_return_max": 0.0, "episode_return_min": -2.220446049250313e-16, "episode_return_mean": -4.440892098500626e-18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.5875078782252, "num_env_steps_trained_throughput_per_sec": 482.5875078782252, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 8241.599, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8241.563, "sample_time_ms": 784.727, "learn_time_ms": 7444.284, "learn_throughput": 537.325, "synch_weights_time_ms": 11.922}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": true, "training_iteration": 200, "trial_id": "fa423_00000", "date": "2024-08-10_11-26-11", "timestamp": 1723303571, "time_this_iter_s": 8.293936729431152, "time_total_s": 1633.9954121112823, "pid": 25251, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a9a56d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1633.9954121112823, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 25.758333333333336, "ram_util_percent": 81.49166666666666}}
